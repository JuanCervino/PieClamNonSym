

/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012832880020141602 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.493119348074457
 first_prior_anomaly_auc= 0.4914703940499219
 first_prior_star_anomaly_auc= 0.4931194746708373


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 21


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 22 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5620282235176046 at iter 20
0.49847297034654614 at iter 10
0.5620258724419693 at iter 20
last anomaly aucs:
0.5620282235176046
0.45311613373207577
0.5620258724419693




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.2632954120635986 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5628742189003332,first_prior_anomaly_auc= 0.4583054218456643, first_prior_star_anomaly_auc= 0.5628761901868273


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5628742189003332 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4585656316628881 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5628761359312358 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 154, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 155 iterations

max values 
max_vanilla_star_anomaly= 0.5628742189003332 at iter 0
max_prior_anomaly= 0.45908266333706127 at iter 5
max_prior_star_anomaly= 0.5628761962152264 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5628742189003332
accuracies_anomaly['prior'][-1]= 0.45838522579248125
accuracies_anomaly['prior_star'][-1]= 0.5628761540164329



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 15.34157133102417 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.493119348074457
accuracies_anomaly["prior"][-1]= 0.4914703940499219
accuracies_anomaly["prior_star"][-1]= 0.4931194746708373


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 18.328857421875 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012438297271728516 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5006768686469716
 first_prior_anomaly_auc= 0.49777151788818913
 first_prior_star_anomaly_auc= 0.5006766998517979


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 20


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 21 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5006768686469716 at iter 0
0.49777151788818913 at iter 0
0.5006766998517979 at iter 0
last anomaly aucs:
0.4719504680207898
0.48492606047979303
0.471950956321114




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.5734801292419434 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5582007869231003,first_prior_anomaly_auc= 0.45407689174779686, first_prior_star_anomaly_auc= 0.5581965067597644


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5582007869231003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4540402451098832 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5581966634981401 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5582007869231003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4519401920117443 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5581945897288618 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5582007869231003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4518361960994811 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5581942159681199 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5582007869231003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45136120045198524 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.558193384049049 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5582007869231003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4502114581539885 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.558192919862321 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5582007869231003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4499633593904855 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.558193022345105 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5582007869231003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4487698629720779 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5581926063855697 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5582007869231003 at iter 0
max_prior_anomaly= 0.4556164423861079 at iter 13
max_prior_star_anomaly= 0.5581976521555867 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5582007869231003
accuracies_anomaly['prior'][-1]= 0.4494579564981078
accuracies_anomaly['prior_star'][-1]= 0.5581928414931331



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 79.02543997764587 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5582007869231003
 first_prior_anomaly_auc= 0.4485897826352206
 first_prior_star_anomaly_auc= 0.5581929379475181


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5006768686469716
accuracies_anomaly["prior"][-1]= 0.49777151788818913
accuracies_anomaly["prior_star"][-1]= 0.5006766998517979


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 81.9384834766388 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012039661407470703 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5190878766965723
 first_prior_anomaly_auc= 0.5168052535327624
 first_prior_star_anomaly_auc= 0.5190877681853892


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 22


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 23 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5587849086504633 at iter 20
0.5168052535327624 at iter 0
0.5587852281556137 at iter 20
last anomaly aucs:
0.5587849086504633
0.4572207561155697
0.5587852281556137




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.9291300773620605 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5623610574583595,first_prior_anomaly_auc= 0.4529656769482219, first_prior_star_anomaly_auc= 0.5623607500100072


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5623610574583595 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4531546612304975 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623607680952044 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5623610574583595 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45333252914489813 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623607861804015 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5623610574583595 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4533693506063846 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623607982371996 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5623610574583595 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45343275127934685 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623607680952043 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5623610574583595 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45345001661426776 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623607319248101 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5623610574583595 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45343001438617153 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623607319248098 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5623610574583595 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45335073491007316 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623607560384062 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5623610574583595 at iter 0
max_prior_anomaly= 0.4543130181107576 at iter 27
max_prior_star_anomaly= 0.5623607982371996 at iter 24
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5623610574583595
accuracies_anomaly['prior'][-1]= 0.45326695221987356
accuracies_anomaly['prior_star'][-1]= 0.5623607078112137



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 79.23111987113953 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5623610574583595
 first_prior_anomaly_auc= 0.45325165817144675
 first_prior_star_anomaly_auc= 0.5623607138396127


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5190878766965723
accuracies_anomaly["prior"][-1]= 0.5168052535327624
accuracies_anomaly["prior_star"][-1]= 0.5190877681853892


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 82.50243949890137 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012188911437988281 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4944712889054791
 first_prior_anomaly_auc= 0.4917154364150992
 first_prior_star_anomaly_auc= 0.4944710115991221


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 21


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 22 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5624192556229289 at iter 20
0.4917154364150992 at iter 0
0.562415716952678 at iter 20
last anomaly aucs:
0.5624192556229289
0.457475600657626
0.562415716952678




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.8129634857177734 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5623877753230138,first_prior_anomaly_auc= 0.45767618357970197, first_prior_star_anomaly_auc= 0.5623877692946146


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5623877753230138 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4579335841629616 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623876969538258 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5623877753230138 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45819266064116115 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623877572378164 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5623877753230138 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45835865260940456 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623877572378164 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5623877753230138 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4584305352398507 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623877753230138 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5623877753230138 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.458405264190972 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.56238779943661 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5623877753230138 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45804696026416925 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623878235502062 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5623877753230138 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.458099298824848 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623878416354035 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5623877753230138 at iter 0
max_prior_anomaly= 0.458432711491913 at iter 39
max_prior_star_anomaly= 0.5623878416354035 at iter 70
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5623877753230138
accuracies_anomaly['prior'][-1]= 0.45784109043611376
accuracies_anomaly['prior_star'][-1]= 0.5623877692946146



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 79.08282828330994 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5623877753230138
 first_prior_anomaly_auc= 0.45780672253304644
 first_prior_star_anomaly_auc= 0.5623877632662155


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.49447128890547903
accuracies_anomaly["prior"][-1]= 0.4917154364150992
accuracies_anomaly["prior_star"][-1]= 0.49447101159912205


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 82.23807978630066 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.011970043182373047 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5048182220659662
 first_prior_anomaly_auc= 0.5010546021039595
 first_prior_star_anomaly_auc= 0.5048178302200269


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 21


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 22 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5422224910888205 at iter 20
0.5010546021039595 at iter 0
0.5422184580898464 at iter 20
last anomaly aucs:
0.5422224910888205
0.455254581703857
0.5422184580898464




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.815068006515503 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5626508787717884,first_prior_anomaly_auc= 0.46204055159369173, first_prior_star_anomaly_auc= 0.5626489074852943


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5626508787717884 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46207290601147133 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626489074852943 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5626508787717884 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46209597066629243 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626489074852943 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5626508787717884 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4620958500983111 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626488894000972 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5626508787717884 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4621226764741485 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626488954284963 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5626508787717884 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4621531198894247 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.562648877343299 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5626508787717884 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46218479309811 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626488652865009 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5626508787717884 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46217264587399487 iter_best_prior_anomaly= 670
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626488592581018 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5626508787717884 at iter 0
max_prior_anomaly= 0.4622053137685258 at iter 79
max_prior_star_anomaly= 0.5626489195420924 at iter 9
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5626508787717884
accuracies_anomaly['prior'][-1]= 0.4622053137685258
accuracies_anomaly['prior_star'][-1]= 0.5626488652865008



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 79.22237849235535 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5626508787717884
 first_prior_anomaly_auc= 0.4622075201625835
 first_prior_star_anomaly_auc= 0.5626488592581018


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.504818222065966
accuracies_anomaly["prior"][-1]= 0.5010546021039595
accuracies_anomaly["prior_star"][-1]= 0.5048178302200269


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 82.37792015075684 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012224912643432617 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5055616080682164
 first_prior_anomaly_auc= 0.5026647814657113
 first_prior_star_anomaly_auc= 0.5055613367902585


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 21


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 22 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5637512303962491 at iter 20
0.5026647814657113 at iter 0
0.5637511761406575 at iter 20
last anomaly aucs:
0.5637512303962491
0.4652981356814189
0.5637511761406575




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.8206496238708496 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5632681446372085,first_prior_anomaly_auc= 0.4626767586889727, first_prior_star_anomaly_auc= 0.5632681144952132


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5632681446372085 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4627084379260571 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5632681144952132 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5632681446372085 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4627249376542969 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5632681084668141 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5632681446372085 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.462747254787634 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5632680843532178 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5632681446372085 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4627635435219065 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5632680783248187 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5632681446372085 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46277418967465456 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.563268090381617 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5632681446372085 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4627866383187229 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5632681265520113 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5632681446372085 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4627988880256221 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5632681265520113 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5632681446372085 at iter 0
max_prior_anomaly= 0.46281453172119474 at iter 79
max_prior_star_anomaly= 0.5632681265520113 at iter 57
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5632681446372085
accuracies_anomaly['prior'][-1]= 0.46281453172119474
accuracies_anomaly['prior_star'][-1]= 0.5632681205236123



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 79.04196357727051 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5632681446372085
 first_prior_anomaly_auc= 0.4628164608088954
 first_prior_star_anomaly_auc= 0.5632681205236123


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5055616080682164
accuracies_anomaly["prior"][-1]= 0.5026647814657113
accuracies_anomaly["prior_star"][-1]= 0.5055613367902585


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 82.20433712005615 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012392759323120117 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5014196879797099
 first_prior_anomaly_auc= 0.4983007088432756
 first_prior_star_anomaly_auc= 0.501419603582123


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 21


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 22 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5641826829173014 at iter 20
0.4983007088432756 at iter 0
0.5641827612864893 at iter 20
last anomaly aucs:
0.5641826829173014
0.4768540220755151
0.5641827612864893




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.819647789001465 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5622181301449372,first_prior_anomaly_auc= 0.45445648195169663, first_prior_star_anomaly_auc= 0.5622182929117119


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 72, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 73 iterations

max values 
max_vanilla_star_anomaly= 0.5622181301449372 at iter 0
max_prior_anomaly= 0.4551904154242136 at iter 4
max_prior_star_anomaly= 0.5622183290821063 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5622181301449372
accuracies_anomaly['prior'][-1]= 0.4549090820966676
accuracies_anomaly['prior_star'][-1]= 0.5622182687981157



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 7.239908218383789 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5014196879797099
accuracies_anomaly["prior"][-1]= 0.4983007088432756
accuracies_anomaly["prior_star"][-1]= 0.501419603582123


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 10.30773138999939 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.011484146118164062 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5013931630238256
 first_prior_anomaly_auc= 0.4977606125142813
 first_prior_star_anomaly_auc= 0.5013929520298585


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 21


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 22 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5609933041365909 at iter 20
0.4977606125142813 at iter 0
0.560991429304482 at iter 20
last anomaly aucs:
0.5609933041365909
0.4557854666390807
0.560991429304482




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.816654682159424 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5605073548879949,first_prior_anomaly_auc= 0.45678150887452684, first_prior_star_anomaly_auc= 0.5605080180118919


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5605073548879949 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45637029971753335 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5605080481538872 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5605073548879949 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.454168656038358 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5605081084378779 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5605073548879949 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4560257706825932 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.560508319431845 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 399, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 400 iterations

max values 
max_vanilla_star_anomaly= 0.5605073548879949 at iter 0
max_prior_anomaly= 0.4574119528203021 at iter 4
max_prior_star_anomaly= 0.5605086027666011 at iter 26
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5605073548879949
accuracies_anomaly['prior'][-1]= 0.4533536044280279
accuracies_anomaly['prior_star'][-1]= 0.560508132551474



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 39.395034074783325 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5013931630238257
accuracies_anomaly["prior"][-1]= 0.4977606125142813
accuracies_anomaly["prior_star"][-1]= 0.5013929520298585


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 42.45933485031128 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.011986732482910156 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4960869420535814
 first_prior_anomaly_auc= 0.4940132812865472
 first_prior_star_anomaly_auc= 0.4960870204227692


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 21


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 22 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5409228164776885 at iter 20
0.4940132812865472 at iter 0
0.5409198263917524 at iter 20
last anomaly aucs:
0.5409228164776885
0.4615621559291234
0.5409198263917524




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.8306162357330322 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.562157629131925,first_prior_anomaly_auc= 0.44922504930024765, first_prior_star_anomaly_auc= 0.5621573096267746


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.562157629131925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4493733599740345 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.562157351825568 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.562157629131925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4494845537947808 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5621573578539671 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.562157629131925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4495727311878984 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5621573819675634 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.562157629131925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44956888506929527 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5621573397687698 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.562157629131925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4495184454543219 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.562157351825568 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.562157629131925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.449410651650648 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5621573457971689 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.562157629131925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4492549260460117 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5621573759391643 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.562157629131925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4491229101348963 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5621573156551737 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.562157629131925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4490395735462275 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5621573156551737 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.562157629131925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4490315497470725 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.562157351825568 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.562157629131925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44938401818358065 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5621573096267746 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.562157629131925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44925015155395254 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5621573277119718 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 1219, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1220 iterations

max values 
max_vanilla_star_anomaly= 0.562157629131925 at iter 0
max_prior_anomaly= 0.4497158333248935 at iter 57
max_prior_star_anomaly= 0.5621574000527605 at iter 69
last values
accuracies_anomaly['vanilla_star'][-1]= 0.562157629131925
accuracies_anomaly['prior'][-1]= 0.4492556615106975
accuracies_anomaly['prior_star'][-1]= 0.5621573578539671



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.87353754043579 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4960869420535814
accuracies_anomaly["prior"][-1]= 0.4940132812865472
accuracies_anomaly["prior_star"][-1]= 0.4960870204227692


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 123.95226216316223 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012173652648925781 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49597849115440945
 first_prior_anomaly_auc= 0.49375375870681676
 first_prior_star_anomaly_auc= 0.4959784971828085


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 21


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 22 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5627076301205824 at iter 20
0.49479348272188484 at iter 10
0.5627052790449473 at iter 20
last anomaly aucs:
0.5627076301205824
0.4618934224861214
0.5627052790449473




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.7955243587493896 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5630252363253002,first_prior_anomaly_auc= 0.46882784170292147, first_prior_star_anomaly_auc= 0.563025230296901


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5630252363253002 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4690908848677056 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.563025230296901 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5630252363253002 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4693391644831805 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630252483820983 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5630252363253002 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4695285345829963 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630251820697085 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5630252363253002 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4696173751000111 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630251338425161 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5630252363253002 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4696666090351716 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630251941265066 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5630252363253002 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4696177187187578 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630252302969011 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5630252363253002 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4695199923415218 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630252423536992 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5630252363253002 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46948136236031596 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630252122117039 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5630252363253002 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46959191717076143 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630252061833049 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5630252363253002 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4692377728393133 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630252785240937 iter_best_prior_star_anomaly= 990
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 1025, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1026 iterations

max values 
max_vanilla_star_anomaly= 0.5630252363253002 at iter 0
max_prior_anomaly= 0.4697412466439902 at iter 66
max_prior_star_anomaly= 0.5630252966092908 at iter 99
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5630252363253002
accuracies_anomaly['prior'][-1]= 0.46941763012540516
accuracies_anomaly['prior_star'][-1]= 0.5630252664672954



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 101.79423451423645 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.49597849115440945
accuracies_anomaly["prior"][-1]= 0.49375375870681676
accuracies_anomaly["prior_star"][-1]= 0.49597849718280856


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 104.83539414405823 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012151002883911133 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5059266336599761
 first_prior_anomaly_auc= 0.5018063856661068
 first_prior_star_anomaly_auc= 0.505926247842436


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 21


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 22 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5618324693431795 at iter 20
0.5018063856661068 at iter 0
0.5618325477123672 at iter 20
last anomaly aucs:
0.5618324693431795
0.4534419204743241
0.5618325477123672




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.8314664363861084 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5623304271627123,first_prior_anomaly_auc= 0.4589505268579646, first_prior_star_anomaly_auc= 0.5623304151059141


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5623304271627123 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4589853348341635 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623304151059141 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5623304271627123 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4590193289764888 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.562330403049116 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5623304271627123 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4590677551061746 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623304151059141 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5623304271627123 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45911945465655246 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623304090775151 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5623304271627123 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.459168417313755 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623304151059141 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5623304271627123 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4592133228583871 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.562330397020717 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5623304271627123 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45924405563681836 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623304090775151 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5623304271627123 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4592824083116673 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623304211343132 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5623304271627123 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4593129240677322 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623304211343132 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5623304271627123 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45932782024182084 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623304331911113 iter_best_prior_star_anomaly= 960
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5623304271627123 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4593643583685513 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623304211343132 iter_best_prior_star_anomaly= 960
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5623304271627123 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4594029160089683 iter_best_prior_anomaly= 1180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623304090775151 iter_best_prior_star_anomaly= 960
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5623304271627123 at iter 0
max_prior_anomaly= 0.45943554773310497 at iter 129
max_prior_star_anomaly= 0.5623304331911114 at iter 96
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5623304271627123
accuracies_anomaly['prior'][-1]= 0.45943554773310497
accuracies_anomaly['prior_star'][-1]= 0.562330397020717



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 128.73806190490723 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5623304271627123
 first_prior_anomaly_auc= 0.45943893569337924
 first_prior_star_anomaly_auc= 0.562330397020717


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.505926627631577
accuracies_anomaly["prior"][-1]= 0.5018063856661068
accuracies_anomaly["prior_star"][-1]= 0.505926247842436


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 131.91032361984253 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012613058090209961 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49587243352966626
 first_prior_anomaly_auc= 0.4938500442966763
 first_prior_star_anomaly_auc= 0.49587221047890084


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 22


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 23 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5632268259900198 at iter 20
0.4938500442966763 at iter 0
0.563226747620832 at iter 20
last anomaly aucs:
0.5632268259900198
0.4647738277295747
0.563226747620832




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.937786102294922 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.563056035416121,first_prior_anomaly_auc= 0.4561068104512184, first_prior_star_anomaly_auc= 0.5630561017285107


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.563056035416121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4561563458063321 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630560896717127 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.563056035416121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4562096127404668 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.563056119813708 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.563056035416121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45623617386674536 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.563056113785309 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.563056035416121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4562881808654755 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630560957001117 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.563056035416121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4563372942326547 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630561017285108 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.563056035416121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4563838756722267 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630561017285108 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.563056035416121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45641157616592853 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630560896717127 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.563056035416121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4564318677571799 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630560957001117 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.563056035416121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45639409983704027 iter_best_prior_anomaly= 810
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630561017285107 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.563056035416121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4564367085616288 iter_best_prior_anomaly= 810
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630561017285108 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.563056035416121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45643694366919235 iter_best_prior_anomaly= 810
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630561077569098 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.563056035416121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45647308392158453 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630560957001118 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.563056035416121 at iter 0
max_prior_anomaly= 0.456476019751929 at iter 122
max_prior_star_anomaly= 0.5630561198137081 at iter 21
last values
accuracies_anomaly['vanilla_star'][-1]= 0.563056035416121
accuracies_anomaly['prior'][-1]= 0.45647425343100306
accuracies_anomaly['prior_star'][-1]= 0.5630560896717127



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 128.98857045173645 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.563056035416121
 first_prior_anomaly_auc= 0.4564801552336873
 first_prior_star_anomaly_auc= 0.5630560896717127


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.49587243352966626
accuracies_anomaly["prior"][-1]= 0.4938500442966763
accuracies_anomaly["prior_star"][-1]= 0.49587220445050173


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 132.2701427936554 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012193918228149414 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49827865093109835
 first_prior_anomaly_auc= 0.49530810906483136
 first_prior_star_anomaly_auc= 0.498278524334718


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4780849247101184; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4908697002535304; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.47808585911197343 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4679755767851657; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4848226071234457; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4679767402661852 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4563049699568705; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4795864783491254; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4563079901848018 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4461610612200805; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47556097267495495; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4461649435090781 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.49827865093109835 at iter 0
0.49530810906483136 at iter 0
0.498278524334718 at iter 0
last anomaly aucs:
0.4412193775412716
0.4731187777879055
0.44121973924521546




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.393707275390625 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4409327090805534,first_prior_anomaly_auc= 0.47291770053710624, first_prior_star_anomaly_auc= 0.440935186752569


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44093270908055343 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4777407694359203 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44393394152645815 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4409327090805534 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.47477119211350366 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45377830514212797 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4409327090805534 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4761470898024084 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4577100089268533 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4409327090805534 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.47464057479097127 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45330870491179487 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44093270908055343 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.47398794030823926 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4565413736261882 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4409327090805534 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4760904349079994 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4571427064328806 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44093270908055343 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.47373720110594597 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45595969340044634 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4409327151089525 at iter 66
max_prior_anomaly= 0.4891044764962366 at iter 4
max_prior_star_anomaly= 0.4588069183354481 at iter 43
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4409327090805534
accuracies_anomaly['prior'][-1]= 0.4768844112351997
accuracies_anomaly['prior_star'][-1]= 0.4549247318206392



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 79.27691841125488 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4409327090805534
 first_prior_anomaly_auc= 0.4718698321549019
 first_prior_star_anomaly_auc= 0.45382518800165317


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4381168378490865; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46739976822011275; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.4481988409558823 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43756571557820306; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46454683439119676; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.44533201166712244 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4368679525000736; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4607435957905377; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.4421864955180059 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43652977739774745; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45855998908136364; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.4407800037038483 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4409327090805534 at iter 0
0.4729986559081446 at iter 10
0.45382518800165317 at iter 0
last anomaly aucs:
0.4359423762212934
0.4571143367868826
0.4391211450196502




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.66798186302185 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43584804383273074,first_prior_anomaly_auc= 0.4566755657893658, first_prior_star_anomaly_auc= 0.43890618436580514


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4358480498611298 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.47096037581522043 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43565775138785806 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43584806191792796 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.47008195970232247 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43983259859205537 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4358480619179279 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4679929807732652 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43886111605439837 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43584806191792796 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.45806265821533343 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44127198737990825 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4358480498611298 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.45601417807119204 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4373890473152163 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43584806191792796 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.46291225207003167 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.436569775825541 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4358480619179279 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.4550423639715864 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43828399329834933 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4358480739747261 at iter 49
max_prior_anomaly= 0.48173222068377475 at iter 15
max_prior_star_anomaly= 0.4464626981956761 at iter 14
last values
accuracies_anomaly['vanilla_star'][-1]= 0.435848067946327
accuracies_anomaly['prior'][-1]= 0.45591481799780953
accuracies_anomaly['prior_star'][-1]= 0.4408386901687421



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.71732997894287 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43584806794632697
 first_prior_anomaly_auc= 0.4550733559711775
 first_prior_star_anomaly_auc= 0.43892889937348056


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4356957001599696; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44792913038173265; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.43739443670398004 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4358590938882161; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4436890498712575; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4360609005753021 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.435753886267741; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4401896727254489; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4353182801797331 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43572060950490443; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4381753072916139; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4349293580140814 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43602079966472457 at iter 130
0.4550733559711775 at iter 0
0.43892889937348056 at iter 0
last anomaly aucs:
0.4357705306775583
0.4363318409428609
0.43458593217617003




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.5071587562561 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43575684621168165,first_prior_anomaly_auc= 0.43617082240384586, first_prior_star_anomaly_auc= 0.4345239240633918


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4357568160696863 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4366351779269927 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4341079645279354 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43575681606968636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4548609995857284 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43607397617287325 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4357568462116817 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.45258156544502365 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43456090226325395 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43575683415488353 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4507951096662244 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4340875161983083 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4357568220980854 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.43689407958161947 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43423845525408744 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4357568220980854 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.4430438785465675 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43580778015537847 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4357568100412873 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.47640099391421054 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336369536522211 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4357568522400808 at iter 42
max_prior_anomaly= 0.5048125011152538 at iter 37
max_prior_star_anomaly= 0.4473451593643463 at iter 37
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4357568160696864
accuracies_anomaly['prior'][-1]= 0.4392128429978216
accuracies_anomaly['prior_star'][-1]= 0.4346482658224978



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.41520810127258 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4357568220980854
 first_prior_anomaly_auc= 0.4427144928500776
 first_prior_star_anomaly_auc= 0.435916677156081


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43710717746015343; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.44074924681182087; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.4368874845130428 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4367281418689677; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.43862496557784136; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.4367331514685904 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43695608769439775; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4378614507511144; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.43674755331395565 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43690392998569105; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.43740886266294166; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.4365546144018936 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4375178078908367 at iter 470
0.44337111210459124 at iter 10
0.436991112692963 at iter 10
last anomaly aucs:
0.43747641087446026
0.4364547419145906
0.43650450634886884




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.76399755477905 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43730249156144696,first_prior_anomaly_auc= 0.4366584174053867, first_prior_star_anomaly_auc= 0.4368394683144934


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4373024433342545 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.44367921152398415 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4394075482308095 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4373024553910526 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.43963158162524674 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366539262480835 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4373025096466442 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4341768631008445 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348823244445794 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43730247950464884 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4354668500746798 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344897792110899 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4373024312774563 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.46543468494863083 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4389852046207438 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43730246744785073 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4720555611016827 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44489411478747004 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4373024795046489 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.45230357185055936 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4379679544773884 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4373025337602404 at iter 2
max_prior_anomaly= 0.522454526580176 at iter 44
max_prior_star_anomaly= 0.44697930185351564 at iter 35
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43730247347624984
accuracies_anomaly['prior'][-1]= 0.45753083284985574
accuracies_anomaly['prior_star'][-1]= 0.4379656938277392



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.96482062339783 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4373024795046489
 first_prior_anomaly_auc= 0.4348499278280064
 first_prior_star_anomaly_auc= 0.43542553142749113


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4366510205597345; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4553937412678639; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.43347535638689594 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43549295907102853; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46680687517211084; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.43409757759634704 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4355067520480883; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47089438895905944; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 300 
last prior star auc 0.43457427928077824 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43564193286871256; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47251333361305103; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 370 
last prior star auc 0.43491950761000986 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4373024795046489 at iter 0
0.47350988223401863 at iter 490
0.43578294917963134 at iter 50
last anomaly aucs:
0.4356043397721458
0.47350988223401863
0.4351788312525712




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 62.10807204246521 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4355411380363527,first_prior_anomaly_auc= 0.47473758981711767, first_prior_star_anomaly_auc= 0.4349326736335669


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43554116817834804 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.45679004508760235 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43487609107994674 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4355413309451228 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4851293802950443 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4382851929497632 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43554122846233867 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4543939131978053 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366656032570717 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4355411139227564 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.46521167638203464 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4395855427415905 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4355412405191368 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.4795374433511339 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43497297348131364 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4355411862635452 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.4451225247996281 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43508140629528835 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4355414093143106 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.49423002634651525 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43525917172690487 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43554142739950785 at iter 43
max_prior_anomaly= 0.556539782128835 at iter 68
max_prior_star_anomaly= 0.48731966647038194 at iter 68
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43554100541157326
accuracies_anomaly['prior'][-1]= 0.4443165941570827
accuracies_anomaly['prior_star'][-1]= 0.43482440961476604



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 79.55458664894104 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43554101143997237
 first_prior_anomaly_auc= 0.4603484583454504
 first_prior_star_anomaly_auc= 0.43527469485449616


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4356839809521881; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.48539384616200765; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.43706855953574575 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4371128079848798; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.48504159474786585; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.43801948523259254 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43676289558957504; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4818792955357535; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.4361907884615478 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4369848009591424; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4787006111349836; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.43493761089240085 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.437497576583576 at iter 270
0.5107754619079932 at iter 10
0.45626523677863573 at iter 10
last anomaly aucs:
0.43682363773854976
0.4782457804823587
0.4344827078989872




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.82094979286194 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43712281512732704,first_prior_anomaly_auc= 0.4392213249553054, first_prior_star_anomaly_auc= 0.4369798456151113


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43712286938291856 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.44174099682713297 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43604823490886746 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43712294172370736 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.442123601230565 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4362659686262822 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.437122911581712 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.44504336589151094 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43630719081908587 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4371229537805056 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.44080684213648397 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43595927382387134 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4371228814397167 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.43451061938665614 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345767509243947 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43712288746811584 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.45736986856643225 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43707293012506754 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43712301406449616 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.4374576022693787 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4341799315559684 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4371231406608765 at iter 63
max_prior_anomaly= 0.5086366703174651 at iter 18
max_prior_star_anomaly= 0.43963889407331214 at iter 68
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43712301406449616
accuracies_anomaly['prior'][-1]= 0.4445725660097641
accuracies_anomaly['prior_star'][-1]= 0.4373530698295988



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 79.07725214958191 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4371229899508999
 first_prior_anomaly_auc= 0.444400816920414
 first_prior_star_anomaly_auc= 0.4376272353906571


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4367572469796515; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.44295242170435867; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 90 
last prior star auc 0.4365174854920548 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4365133379534984; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.46266063874987395; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 90 
last prior star auc 0.436602443720072 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43721424182754054; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4607387007304973; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 90 
last prior star auc 0.43713915208879206 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4375658662881796; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.458298579612726; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 90 
last prior star auc 0.4372727715540586 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4376439762548595 at iter 480
0.48667873913863335 at iter 90
0.4393365758886222 at iter 10
last anomaly aucs:
0.4376300385962222
0.45204056485616967
0.43722986140951686




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.779170751571655 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43723368944292285,first_prior_anomaly_auc= 0.46728839354739465, first_prior_star_anomaly_auc= 0.4370232621451744


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.437233701499721 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44785606015667084 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43631080785852455 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43723376781211076 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4502186801760678 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4367978723609477 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43723379192570694 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.43977046991129576 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43681908026885696 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4372337256133172 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.432391594916661 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4364636096896146 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4372337798689088 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4476363250107668 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43646696147949454 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43723376178371165 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4429546823540078 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4370379412968967 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4372337798689089 iter_best_vanilla_star_anomaly= 620 
last prior auc 0.487622557352983 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4395304672877365 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4372339486640826 at iter 62
max_prior_anomaly= 0.5531334352373911 at iter 36
max_prior_star_anomaly= 0.44644032680674745 at iter 55
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43723362313053316
accuracies_anomaly['prior'][-1]= 0.4910854867980472
accuracies_anomaly['prior_star'][-1]= 0.438334179720562



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 79.68326926231384 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4372336171021341
 first_prior_anomaly_auc= 0.4658669452751578
 first_prior_star_anomaly_auc= 0.44135907363279525


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4371692880557159; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48151826074417453; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 80 
last prior star auc 0.44917591181947214 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4374901254823322; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48003356250895224; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 160 
last prior star auc 0.4503754728073386 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4371880484336049; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.46768052282134864; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 160 
last prior star auc 0.4459718599154384 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43741906271415887; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.47668001233651586; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 160 
last prior star auc 0.44939478490430995 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4386015271622782 at iter 430
0.48820837908888226 at iter 160
0.4546923189515022 at iter 160
last anomaly aucs:
0.4365219163653673
0.4691715810175841
0.44434734502071116




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.73586678504944 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4365762262125401,first_prior_anomaly_auc= 0.4782668195950941, first_prior_star_anomaly_auc= 0.44820566510362336


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4365761056445588 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4895441095548196 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43785020778685896 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4365760755025635 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4771465561685232 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44228043606062933 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43657609358776067 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4659341619247279 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43796876831126214 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4365761297581551 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4768935683733788 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44604607553632253 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43657603933216915 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4700173051223548 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4444543491041075 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4365761900421457 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.47239397131157224 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4396721226089561 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4365760935877607 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.46776724737029174 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4427570412906754 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43657626841133357 at iter 37
max_prior_anomaly= 0.514850014636953 at iter 1
max_prior_star_anomaly= 0.44820566510362336 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43657608755936167
accuracies_anomaly['prior'][-1]= 0.4608266249308543
accuracies_anomaly['prior_star'][-1]= 0.4377871808746387



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 79.0042359828949 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.49827865093109835
accuracies_anomaly["prior"][-1]= 0.49530810906483136
accuracies_anomaly["prior_star"][-1]= 0.498278524334718


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 1124.6831126213074 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.01264333724975586 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5053674514195433
 first_prior_anomaly_auc= 0.5034283023208372
 first_prior_star_anomaly_auc= 0.505367517731933


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.48551675316213644; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5027489620302491; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4855178925295597 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4719486353874741; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4986667050072847; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.47194994355007114 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45869972134328163; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4934572217568298; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.45870755223366655 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44694644105021464; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48854301552095736; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.44695577904036565 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5053674514195433 at iter 0
0.5034283023208372 at iter 0
0.505367517731933 at iter 0
last anomaly aucs:
0.4402687834063733
0.48566336985578623
0.4402774944430218




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.6334810256958 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4398917371868789,first_prior_anomaly_auc= 0.48544349002830456, first_prior_star_anomaly_auc= 0.43990181064171585


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4398917311584799 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.49438023596600755 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44376953502716876 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43989173115847985 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4844148642959143 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4586862297861751 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4398917371868789 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4819950709397889 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4599470513653359 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43989173115847985 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4808883714111132 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45947288763691096 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4398917371868789 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.47860758690901795 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45818857338659547 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.439891743215278 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.47732023434557386 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4581322018269425 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4398917311584798 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.4762394207624816 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45745507395881113 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.439891743215278 at iter 52
max_prior_anomaly= 0.5185393164952914 at iter 3
max_prior_star_anomaly= 0.4599470513653359 at iter 30
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4398917371868789
accuracies_anomaly['prior'][-1]= 0.4758471829773443
accuracies_anomaly['prior_star'][-1]= 0.45697570772199336



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 79.47858142852783 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43989174321527796
 first_prior_anomaly_auc= 0.4762864663887816
 first_prior_star_anomaly_auc= 0.4579727928704777


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4372151822577946; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4830020908899315; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.45638899378303266 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4364050136507069; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47857898215545647; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 60 
last prior star auc 0.4521014938855154 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43533016818268844; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4754480487036772; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 60 
last prior star auc 0.4464927618218112 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4349514520966531; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4712211040747637; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 60 
last prior star auc 0.44264768613164385 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43989174321527796 at iter 0
0.4842700078947914 at iter 60
0.4600005473786351 at iter 10
last anomaly aucs:
0.4349781820181054
0.4708103711612964
0.44093590413205763




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.383147954940796 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43439074467125693,first_prior_anomaly_auc= 0.4642093646115614, first_prior_star_anomaly_auc= 0.4393476500577038


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4343907627564541 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.49630948643344963 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4404362041051951 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43439074467125693 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.48022602517748814 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.434981780972347 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43439074467125693 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4730292741469936 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4414565950444631 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43439075672805505 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.47400583862506196 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43784149072181155 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4343907567280551 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.46871377836422035 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4380319881322524 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43439075672805505 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4882637921330839 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4433039979378053 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43439074467125693 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4747597019848866 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43924322612910704 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43439076275645416 at iter 2
max_prior_anomaly= 0.5069297773495203 at iter 21
max_prior_star_anomaly= 0.4464320136444373 at iter 61
last values
accuracies_anomaly['vanilla_star'][-1]= 0.434390750699656
accuracies_anomaly['prior'][-1]= 0.47747935393888363
accuracies_anomaly['prior_star'][-1]= 0.4426321388904563



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.03179597854614 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43439075672805505
 first_prior_anomaly_auc= 0.4625043645609227
 first_prior_star_anomaly_auc= 0.4395643589472775


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4343375741915073; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4873649096053617; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4403424142725483 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4342997701009733; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4908847109672011; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.4392609797643523 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4345964095337444; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4916750642265636; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 240 
last prior star auc 0.4387414885033607 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43474835533216716; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.49273560430360175; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 400 
last prior star auc 0.4381529660446805 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43476228093400643 at iter 480
0.4948825221760689 at iter 490
0.4406153922389908 at iter 80
last anomaly aucs:
0.4347506521522108
0.4948825221760689
0.43835336811478454




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.72768950462341 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43449858067372427,first_prior_anomaly_auc= 0.4951246588528969, first_prior_star_anomaly_auc= 0.4383984725965858


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43449858670212327 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4641472901863933 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43955193441680546 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43449857464532515 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.47196224751256194 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4375202915912514 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43449858670212327 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4895544663444125 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43555006609536734 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43449858067372427 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4473545636668871 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4381303776333856 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4344985867021233 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4570236877501484 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43572784961218103 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4344985746453252 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.47715448351329315 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43821470287950104 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4344985806737242 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.46078224385694083 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43752644055829726 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43449859273052244 at iter 5
max_prior_anomaly= 0.5164160299471575 at iter 28
max_prior_star_anomaly= 0.44338744303765726 at iter 22
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4344985867021233
accuracies_anomaly['prior'][-1]= 0.46861025266708434
accuracies_anomaly['prior_star'][-1]= 0.4389036222962028



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.21587204933167 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43449858670212327
 first_prior_anomaly_auc= 0.4517134277525308
 first_prior_star_anomaly_auc= 0.43621966449306715


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4344097220715123; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4507665471114565; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 30 
last prior star auc 0.43556989952828984 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4344649783773382; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.44989707111437127; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 30 
last prior star auc 0.4348327468906723 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4343723037985183; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4595191254577364; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 30 
last prior star auc 0.4351795426036607 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43452858401586864; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.45573154863784704; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 30 
last prior star auc 0.4347328080909796 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43475851921299014 at iter 60
0.462770783629183 at iter 30
0.4384529452105334 at iter 10
last anomaly aucs:
0.43437376267109196
0.4528443373318499
0.43498062954812566




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.75648212432861 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4348756027796225,first_prior_anomaly_auc= 0.46823849335356943, first_prior_star_anomaly_auc= 0.4390376336074085


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4348755786660262 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47796994505475954 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43536503644287805 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43487559072282433 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4595959815174107 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43757943621447404 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4348755786660263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4815597783285323 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4346235795283284 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43487557866602616 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44115981093011447 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4339781128120842 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.434875560580829 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46076893315180617 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4383441868630092 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4348755846944253 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4934255425197454 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.434186520596146 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4348755786660262 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44807818857700366 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43595842984800237 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4348756027796225 at iter 0
max_prior_anomaly= 0.5176307282450752 at iter 25
max_prior_star_anomaly= 0.4417337687766546 at iter 13
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4348755786660262
accuracies_anomaly['prior'][-1]= 0.47036680155812405
accuracies_anomaly['prior_star'][-1]= 0.43805072439654513



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.94658637046814 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4348755967512234
 first_prior_anomaly_auc= 0.4614132002166366
 first_prior_star_anomaly_auc= 0.4362887740599435


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4370261376915282; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4497669842909566; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 30 
last prior star auc 0.4353497062240567 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4370993164277732; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.45177827524126857; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 30 
last prior star auc 0.4357139722375344 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4371077079592712; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4452727404475194; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 30 
last prior star auc 0.43593545561916724 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43705985452749646; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4438644160000463; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 30 
last prior star auc 0.4358266490444505 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43756652338367763 at iter 110
0.46517492123293785 at iter 30
0.436302916684149 at iter 490
last anomaly aucs:
0.4375128947455992
0.456069054587877
0.436302916684149




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.91925239562988 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4373021961698928,first_prior_anomaly_auc= 0.46103786606247643, first_prior_star_anomaly_auc= 0.43611562638201046


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4373022021982919 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.47923710850973633 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43566053047982684 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4373021780846956 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4682873053007954 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4367422000955863 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4373021539710994 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4719624886485246 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4383927697310706 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43730219014149374 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4751975506373465 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352501954406977 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43730217205629657 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.44329716776166506 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4363415165233595 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43730217205629657 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.45364950839611307 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366573986059447 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4373022021982919 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.4631316496255882 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4379108956802421 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4373022202834891 at iter 55
max_prior_anomaly= 0.5135348410118259 at iter 29
max_prior_star_anomaly= 0.4444699686860839 at iter 12
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43730218411309474
accuracies_anomaly['prior'][-1]= 0.4686204225763063
accuracies_anomaly['prior_star'][-1]= 0.4386959017496343



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 79.33289766311646 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4373021961698928
 first_prior_anomaly_auc= 0.4715103406334835
 first_prior_star_anomaly_auc= 0.4350381887023943


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4373060543452941; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.46550959986380636; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 40 
last prior star auc 0.4363145514943436 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43730801357499016; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.46602857268247844; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 40 
last prior star auc 0.43770185491427854 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43691397932693166; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47536668340150245; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 300 
last prior star auc 0.4383551103221142 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43694822666201755; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.46541689514299117; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 300 
last prior star auc 0.43755150664160786 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43766935581492133 at iter 10
0.47536668340150245 at iter 300
0.44224383162150915 at iter 20
last anomaly aucs:
0.4371386758452659
0.46842304676253266
0.4382166199104035




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 62.00290489196777 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43577520268683334,first_prior_anomaly_auc= 0.5275315538463838, first_prior_star_anomaly_auc= 0.43809262779844316


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4357754197091997 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4587652862115081 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43562132780070983 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4357753172264156 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5234280648019141 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4367425015155395 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4357753895672044 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4863208571997652 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43615648084247116 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4357753835388053 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.45534611691525373 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4368353147475379 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4357753654536081 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4742072534662089 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43513691579387503 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43577534736841095 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.448498994945308 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435672219545613 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43577540162400247 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4862567572325115 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4389274043305126 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4357755041067866 at iter 11
max_prior_anomaly= 0.5357054360244589 at iter 16
max_prior_star_anomaly= 0.44518165133765353 at iter 56
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43577528708442026
accuracies_anomaly['prior'][-1]= 0.49984601660269334
accuracies_anomaly['prior_star'][-1]= 0.43625606396661903



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.55832004547119 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4357752810560212
 first_prior_anomaly_auc= 0.4960829150830063
 first_prior_star_anomaly_auc= 0.43721647233519434


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43521945663386735; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5347389389728283; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 70 
last prior star auc 0.4355725580522773 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4350420227641994; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.531442507881529; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 70 
last prior star auc 0.43540872425089905 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4350598306550362; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5286674489117292; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 70 
last prior star auc 0.4353465111725526 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4348001935357235; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5277180001726534; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 70 
last prior star auc 0.43566997095276194 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43629906453714673 at iter 20
0.5433344895802739 at iter 70
0.4388433262487587 at iter 70
last anomaly aucs:
0.43445219214292224
0.5292972417904056
0.435340579227873




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.29456663131714 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43427909269218173,first_prior_anomaly_auc= 0.5293952937011911, first_prior_star_anomaly_auc= 0.43510040178074083


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4342788877266136 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4920812758407326 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4367266287408024 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43427916503297054 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4433913614970492 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43551466733606015 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4342788877266135 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.45410752204344407 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4369500773805304 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4342788093574257 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.46156712935835165 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4383220927804375 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4342787551018341 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.45889899007436147 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43564970950350584 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43427892992540695 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4937652006082413 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43455019582651516 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43427896609580136 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4442485033896482 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4350706938301506 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43427916503297054 at iter 20
max_prior_anomaly= 0.5317956876691268 at iter 47
max_prior_star_anomaly= 0.44040790679998587 at iter 76
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43427880332902663
accuracies_anomaly['prior'][-1]= 0.5151684467323424
accuracies_anomaly['prior_star'][-1]= 0.436587228040833



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.66809463500977 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4342789419822052
 first_prior_anomaly_auc= 0.4617733789755484
 first_prior_star_anomaly_auc= 0.4391231163061443


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43668967465453656; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48779454154989654; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.45197113578414283 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43633408350731295; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.493361472694487; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.45305662740490926 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43744502702892996; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4999063307353345; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.45703878286140615 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43564457933590195; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4855058417598296; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.4467520312087808 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43820550354252846 at iter 310
0.5188615103116972 at iter 10
0.463158699052191 at iter 10
last anomaly aucs:
0.43646296465091466
0.4843107237020736
0.4487126293513587




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.2346875667572 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43602312662676346,first_prior_anomaly_auc= 0.5008571358642, first_prior_star_anomaly_auc= 0.45463072076986033


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4360231085415663 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4891665328362074 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44159839504726023 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4360231266267635 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.49845582557960644 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4445743926146806 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4360231145699654 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.48734870526867613 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44513771636527083 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43602310854156623 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.49640494613263736 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44460076083218925 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43602309648476817 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.5021904609989105 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44225684090669054 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43602312059836446 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4827362023207889 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44246854019664156 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43602312662676346 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.49481918781549633 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43863463512994094 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4360231447119607 at iter 33
max_prior_anomaly= 0.5191240229773636 at iter 58
max_prior_star_anomaly= 0.4578959006404089 at iter 12
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4360231085415663
accuracies_anomaly['prior'][-1]= 0.4836153418415746
accuracies_anomaly['prior_star'][-1]= 0.44081952588811585



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.12992811203003 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5053674514195433
accuracies_anomaly["prior"][-1]= 0.5034283023208372
accuracies_anomaly["prior_star"][-1]= 0.505367517731933


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 1117.5303292274475 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012125253677368164 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5029023486160484
 first_prior_anomaly_auc= 0.4999140531145362
 first_prior_star_anomaly_auc= 0.5029019627985083


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4798718265904484; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4907639922759328; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.479872067726411 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46759157982154975; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48175007680180404; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.46759209223547016 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4534515719412265; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4763951222535217; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.45345782339105645 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44534836671378464; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47250158426327415; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4453543348288586 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5029023486160484 at iter 0
0.4999140531145362 at iter 0
0.5029019627985083 at iter 0
last anomaly aucs:
0.4418214216990537
0.46948066909442354
0.44182547881162415




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.91017746925354 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44157643358946796,first_prior_anomaly_auc= 0.4692218518373837, first_prior_star_anomaly_auc= 0.44157991800412727


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4415764396178671 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4795764712066781 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44157937544821146 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44157643358946796 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.49824749616473246 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44158125630871964 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44157643358946796 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5037036615049102 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44158085240598227 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44157643358946796 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5063329658421263 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44158611519836566 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44157643358946796 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.49073437475132853 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44165377192106753 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44157643358946796 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4807973968408295 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4425200408098503 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44157642153266985 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4799084370579676 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4461629541373868 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4415764396178671 at iter 10
max_prior_anomaly= 0.5065417715005264 at iter 39
max_prior_star_anomaly= 0.4493865139407934 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44157643358946796
accuracies_anomaly['prior'][-1]= 0.4770723706896344
accuracies_anomaly['prior_star'][-1]= 0.4493865139407934



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.88966631889343 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4415764215326698
 first_prior_anomaly_auc= 0.47692996181853164
 first_prior_star_anomaly_auc= 0.44968004874804623


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43805597513213046; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4767027333725903; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.44228422189524186 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4364746778302972; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.478318054958744; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 200 
last prior star auc 0.43922647923650565 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43603544264605243; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4823470209339774; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 300 
last prior star auc 0.43767872394706775 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43582893380769605; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48500799847987885; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 400 
last prior star auc 0.43669232715012496 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4415764215326698 at iter 0
0.4871857877839557 at iter 490
0.44968004874804623 at iter 0
last anomaly aucs:
0.43542154062731037
0.4871857877839557
0.43609529862036467




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.19499087333679 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43541661542527466,first_prior_anomaly_auc= 0.48747811691139553, first_prior_star_anomaly_auc= 0.4360563672192056


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4354166154252746 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5025019845489721 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4355458522444212 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43541660939687554 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46882980696101656 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4371645738476474 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43541660939687554 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4637952075674252 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.438000676627511 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43541660939687554 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4627468327996994 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4378956076602143 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43541660939687554 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46389771446511946 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43784785068282467 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43541660336847654 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46336719726223874 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4378086600605059 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4354166154252746 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46369176626787606 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43807326458064766 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43541661542527466 at iter 0
max_prior_anomaly= 0.506477701675268 at iter 3
max_prior_star_anomaly= 0.4383670827226565 at iter 74
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4354166033684765
accuracies_anomaly['prior'][-1]= 0.46327373899154045
accuracies_anomaly['prior_star'][-1]= 0.4382528686739789



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.25829410552979 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4354166093968756
 first_prior_anomaly_auc= 0.4632688921586925
 first_prior_star_anomaly_auc= 0.4382833904584429


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4348259408281284; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4910697406196905; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.43772868731851505 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4356332097752661; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4964069897599202; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 170 
last prior star auc 0.438571174172988 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4356928065284187; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4994908173014088; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 300 
last prior star auc 0.43873350690299917 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4351368916802788; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5009019148124517; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 390 
last prior star auc 0.43840599603861835 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4358280295478364 at iter 260
0.5030584600382249 at iter 490
0.43873350690299917 at iter 300
last anomaly aucs:
0.43506611827526054
0.5030584600382249
0.43812111198402337




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.13222861289978 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43509041875188986,first_prior_anomaly_auc= 0.503744057807042, first_prior_star_anomaly_auc= 0.43811386584834766


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4350903886098946 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5346516477543731 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43539679404915027 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43509038258149546 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5324726708556806 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4354530872396153 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43509039463829363 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5293331951624267 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43555362285081545 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4350904006666927 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5221568864331603 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366868292501781 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4350904006666927 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.47821586756620027 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4401277188682621 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43509038258149557 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.46287291676613523 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43961365316642864 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4350903886098946 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4713284216349115 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43877551881608023 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4350904187518899 at iter 11
max_prior_anomaly= 0.5365516122591595 at iter 3
max_prior_star_anomaly= 0.44271894180858723 at iter 64
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43509040669509175
accuracies_anomaly['prior'][-1]= 0.4674506720218141
accuracies_anomaly['prior_star'][-1]= 0.4392987838548863



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.2126202583313 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4350903886098945
 first_prior_anomaly_auc= 0.4464346480548286
 first_prior_star_anomaly_auc= 0.43514438498031605


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43426539014110793; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.46124676817526145; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 40 
last prior star auc 0.4322807447146614 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43645121530113784; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4616913686346737; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 40 
last prior star auc 0.43340684363152693 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4362588189449916; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.47294388187424374; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 40 
last prior star auc 0.43746911048319304 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43529794036128916; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4658438444499423; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 40 
last prior star auc 0.4358449090652171 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4388450142004968 at iter 370
0.4983818752082812 at iter 40
0.4483842503975127 at iter 60
last anomaly aucs:
0.4352991822114965
0.4601102762984086
0.4326727051934417




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.22502660751343 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4357818278974053,first_prior_anomaly_auc= 0.4623429722611657, first_prior_star_anomaly_auc= 0.4352563202941473


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43578182186900627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4794315123227711 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43561910934985404 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43578182186900627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4767995735751638 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4356222561741657 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43578181584060716 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47560546828845063 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43565962019156806 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43578182186900627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4611444421295392 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4360181109987417 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43578180981220815 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4590978368175069 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4350344691801715 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4357818158406072 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4562136517678401 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43547360791003115 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4357818098122081 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47694471933944177 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43735480600852944 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4357818399542035 at iter 74
max_prior_anomaly= 0.4823118391970366 at iter 3
max_prior_star_anomaly= 0.43735480600852944 at iter 70
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4357818098122081
accuracies_anomaly['prior'][-1]= 0.45445001950789937
accuracies_anomaly['prior_star'][-1]= 0.4351172933549198



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.22075200080872 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43578181584060716
 first_prior_anomaly_auc= 0.47392314707509314
 first_prior_star_anomaly_auc= 0.43665140034887545


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43611810405402607; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4805196805527222; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 60 
last prior star auc 0.4469791089447456 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43585562755875396; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4776163734212226; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 120 
last prior star auc 0.4383234371134289 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4358071773154719; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.47650898665505353; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 120 
last prior star auc 0.43621006125335726 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43561692706939265; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.468824996298563; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 120 
last prior star auc 0.4361900771104581 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4376625678375746 at iter 120
0.4928602474826611 at iter 120
0.454435243901792 at iter 60
last anomaly aucs:
0.4360255199011921
0.47066354950207834
0.4382439466433633




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.85479760169983 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43551375101940226,first_prior_anomaly_auc= 0.4485188645486248, first_prior_star_anomaly_auc= 0.4369493178022482


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.435513817331792 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4963697824808936 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43558998012557404 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43551374499100315 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4915626406124082 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4355829992394572 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4355137992465948 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.48854056799093715 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4355723108879156 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4355138113033929 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.48985237174098717 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4356222200037714 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4355138113033929 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.487590263219194 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43566894612492096 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43551371484900786 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4707036082138626 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357200307785942 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4355137811613976 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4581854989030726 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43845330691447726 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4355138957009798 at iter 54
max_prior_anomaly= 0.5000240955110611 at iter 4
max_prior_star_anomaly= 0.4398921893168088 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4355137992465948
accuracies_anomaly['prior'][-1]= 0.4548559899861057
accuracies_anomaly['prior_star'][-1]= 0.4398921893168088



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.27600598335266 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43551378718979666
 first_prior_anomaly_auc= 0.4539478538658194
 first_prior_star_anomaly_auc= 0.43994829562690285


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43846266901822456; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48176192863436507; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 30 
last prior star auc 0.45840771172099215 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43686147799947816; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.47395597773639886; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 30 
last prior star auc 0.45137446292992733 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4377082028184936; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4755827834227706; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 30 
last prior star auc 0.4529789153125676 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4370964288246213; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4746248587546099; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 30 
last prior star auc 0.4520652571787382 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4394237284538989 at iter 30
0.49852799757320765 at iter 30
0.47730075658819615 at iter 30
last anomaly aucs:
0.4382401427235536
0.4906789014231362
0.4608227305850585




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.935945987701416 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4374156446118893,first_prior_anomaly_auc= 0.47761062835691404, first_prior_star_anomaly_auc= 0.45362855970936367


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43741559638469674 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4850426195757068 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43729815111412046 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43741552404390793 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4847010323995102 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4373082607393518 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4374155843278986 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48479179597582656 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4373339537761651 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43741549390191264 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4842349286406346 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4374023097931584 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4374155722711005 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4833470298560081 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43762547509813027 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43741549390191264 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.483561327385956 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.438422194346905 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43741556021430233 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4752762513871346 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45114177275443346 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4374156446118893 at iter 0
max_prior_anomaly= 0.4861772064784552 at iter 5
max_prior_star_anomaly= 0.45362855970936367 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4374155722711005
accuracies_anomaly['prior'][-1]= 0.4760676113891409
accuracies_anomaly['prior_star'][-1]= 0.4523042289460574



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.00108480453491 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43741554212910516
 first_prior_anomaly_auc= 0.4760638556965236
 first_prior_star_anomaly_auc= 0.4523407429591916


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43688925083396873; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4749625515850108; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 40 
last prior star auc 0.44483662797399015 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4368148121623192; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4780188233143753; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 40 
last prior star auc 0.4440291058340917 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43657763082952217; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4754458965652111; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 40 
last prior star auc 0.44162645121650684 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43729573975449465; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48055877472065606; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 40 
last prior star auc 0.445830035799045 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43792146346380234 at iter 10
0.4868739748707391 at iter 40
0.4529707950590277 at iter 10
last anomaly aucs:
0.43736187732063225
0.4861675791251491
0.4471161887110752




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.037497997283936 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4367564934297684,first_prior_anomaly_auc= 0.4884533008860782, first_prior_star_anomaly_auc= 0.44545311014753175


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4367567767645245 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.487036663276295 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4364215254357447 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43675669236693754 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4848771339929849 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4363758301708352 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.436756824991717 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.4901072102546444 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43638279297175475 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4367567948497217 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.48719266015888923 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43636986808416034 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4367567647077263 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.48355091031237235 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4363325462655514 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43675680087812074 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.47522572134617524 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4374056736398364 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.436756824991717 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.47783297379961315 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43598033705020306 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4367569093893039 at iter 72
max_prior_anomaly= 0.49104840008700185 at iter 32
max_prior_star_anomaly= 0.44545311014753175 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4367568370485151
accuracies_anomaly['prior'][-1]= 0.4843483107702413
accuracies_anomaly['prior_star'][-1]= 0.4388545812698123



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.1295804977417 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.436756451230975
 first_prior_anomaly_auc= 0.48458629990851304
 first_prior_star_anomaly_auc= 0.4393109371074005


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.436545969677635; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4662686295616293; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.4476771433008331 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4364406475175776; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.467658434767176; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.44959036425516236 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43667094441864285; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.46142381019899026; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.44780877942280733 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43666853305901704; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.46735046194416346; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.4504554636345266 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43860637399512614 at iter 20
0.5259006970758406 at iter 10
0.490642948051115 at iter 10
last anomaly aucs:
0.4361939292574604
0.45578716061921787
0.44617013998907173




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.962427377700806 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43846541193979893,first_prior_anomaly_auc= 0.48348656318075695, first_prior_star_anomaly_auc= 0.4522241778348788


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4384653395990102 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4682332305611861 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4381840786122529 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43846541193979893 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.46708056448964297 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4381686097402531 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4384653938546017 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4695277930899114 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43820470176545284 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43846538782620276 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4708121013118278 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43832454633885676 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43846535768420736 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4719742500550996 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43840831697225824 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4384653757694046 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4760191732026569 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4400120399186117 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43846539385460176 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4835893413564091 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44482841729446415 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4384654661953905 at iter 74
max_prior_anomaly= 0.5151913365635907 at iter 68
max_prior_star_anomaly= 0.4522241778348788 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4384653395990102
accuracies_anomaly['prior'][-1]= 0.4890851132784412
accuracies_anomaly['prior_star'][-1]= 0.44709021233950597



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.68154287338257 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5029023486160484
accuracies_anomaly["prior"][-1]= 0.4999140531145362
accuracies_anomaly["prior_star"][-1]= 0.5029019627985083


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 1099.134098291397 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012345552444458008 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5019391671839033
 first_prior_anomaly_auc= 0.5003749242230238
 first_prior_star_anomaly_auc= 0.5019390345591239


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4901245599871523; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5054528195786969; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 90 
last prior star auc 0.49012574758176797 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4777476357824548; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49948754990911587; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 90 
last prior star auc 0.4777512709070908 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.464766479111115; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4953551848331267; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 90 
last prior star auc 0.4647736529060018 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4546584875759518; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49233985196180985; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 90 
last prior star auc 0.45466704187422446 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5019391671839033 at iter 0
0.5058143607557973 at iter 90
0.5019390345591239 at iter 0
last anomaly aucs:
0.44810192841251995
0.4898061339201618
0.44810956036573574




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.74133610725403 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4475229368527609,first_prior_anomaly_auc= 0.4895624600015722, first_prior_star_anomaly_auc= 0.4475319794513578


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44752294288116 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48678210809739386 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44752626452904454 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4475229368527609 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5028038325185349 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4475175655491944 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4475229308243619 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5167132842766331 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44749494096750503 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4475229368527609 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5172905637710579 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4474709057404345 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4475229308243619 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48396777410768843 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4475582813564766 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44752293082436184 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48607146835886245 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4480657399329353 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4475229308243619 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4873030220605647 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4514912209630102 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.44752294288116 at iter 10
max_prior_anomaly= 0.517422374716605 at iter 37
max_prior_star_anomaly= 0.4558896072329214 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4475229308243619
accuracies_anomaly['prior'][-1]= 0.48652985576693536
accuracies_anomaly['prior_star'][-1]= 0.4558896072329214



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.28430318832397 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4475229308243619
 first_prior_anomaly_auc= 0.48634845521068293
 first_prior_star_anomaly_auc= 0.45628121806455596


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44006099051901626; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48861588078045104; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.44588711268138853 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4368995835099654; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.489884002750879; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.44028624767846347 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43597622568204103; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4900515982732736; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 250 
last prior star auc 0.4379650909878327 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43556222537628053; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4895997577065848; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 250 
last prior star auc 0.43656366302888955 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4475229308243619 at iter 0
0.49035321716367203 at iter 250
0.45628121806455596 at iter 0
last anomaly aucs:
0.43522905987357724
0.4895204541168902
0.43572661379037275




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.92344689369202 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43521676796788455,first_prior_anomaly_auc= 0.4894770315584279, first_prior_star_anomaly_auc= 0.4356764695669536


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43521676193948544 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4762148128374999 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44111318126334986 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43521676796788455 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47191568415818713 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4413924408216177 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43521676796788455 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.47042094863852224 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44229755671397275 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43521676796788455 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.46757357299354385 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44249651196830125 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43521676796788455 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.46647887600740573 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44282446290581373 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43521676796788455 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4634800609495259 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44260126745884654 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43521677399628356 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.46271744435425965 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44290823956761427 iter_best_prior_star_anomaly= 650
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43521678002468267 at iter 28
max_prior_anomaly= 0.4894770315584279 at iter 0
max_prior_star_anomaly= 0.44320556623787877 at iter 74
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43521677399628356
accuracies_anomaly['prior'][-1]= 0.46182719449399784
accuracies_anomaly['prior_star'][-1]= 0.4429967244090842



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.89619255065918 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43521677399628367
 first_prior_anomaly_auc= 0.46205512826262984
 first_prior_star_anomaly_auc= 0.44310368629368724


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4352502496962892; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4672243659209296; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 30 
last prior star auc 0.44053223047389484 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.435113573832697; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.460104525205701; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 30 
last prior star auc 0.43853749350741417 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4354001699526264; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.45092988055571226; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 30 
last prior star auc 0.4368570531545648 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43531179362233957; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4465191903233103; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 30 
last prior star auc 0.4359618720638682 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43540835049015714 at iter 310
0.47450861313544757 at iter 30
0.44520548762755485 at iter 10
last anomaly aucs:
0.4353227170814446
0.44674554465138727
0.4360051680259501




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.9738872051239 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43534502215798365,first_prior_anomaly_auc= 0.4467086930479055, first_prior_star_anomaly_auc= 0.43602260818444394


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43534502215798354 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5212865001478164 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357346255327297 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4353449920159883 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4521023137477882 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4375780074838957 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4353450040727864 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4575234299758045 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4517595269201777 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4353449980443874 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4371333527688919 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43514818287172674 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4353450040727864 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.44345606430420936 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43662251828895715 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43534501612958454 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4335814441536344 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4341820656092372 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4353450101011855 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.43694866673514926 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4342010610946897 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43534503421478177 at iter 77
max_prior_anomaly= 0.5283906790822751 at iter 1
max_prior_star_anomaly= 0.4721290894850735 at iter 39
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43534502215798365
accuracies_anomaly['prior'][-1]= 0.4491753994055516
accuracies_anomaly['prior_star'][-1]= 0.4408128705355485



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.27095055580139 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4353450101011854
 first_prior_anomaly_auc= 0.5200789756447856
 first_prior_star_anomaly_auc= 0.44441564075371387


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43756044675742056; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4940881600313284; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4423812248645901 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43749924042171784; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.5111949480569024; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4416299175459689 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4373585134739542; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.512345896034712; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4399186660455004 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43721398260638067; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.5135496708735247; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4386623175384455 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4379960468170294 at iter 140
0.5221700825987127 at iter 420
0.44441564075371387 at iter 0
last anomaly aucs:
0.43723706534639906
0.5142255086642563
0.4387809323184403




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.882652044296265 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4375569623427613,first_prior_anomaly_auc= 0.49259856070766656, first_prior_star_anomaly_auc= 0.4389728825730558


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4375569683711603 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5157866349428194 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4363231841618041 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4375569623427613 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.46842069568689754 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43898764009396585 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4375569623427612 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4692756914694295 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43669778887967753 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4375569683711603 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4613181685337824 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4354713954875745 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4375569502859632 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4666840284559727 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358227546986548 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43755696234276126 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.45349691755899024 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43858370721464335 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4375569563143622 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4520301176405907 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43488110067956937 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43755698042795843 at iter 78
max_prior_anomaly= 0.5253657791416427 at iter 8
max_prior_star_anomaly= 0.4418754542398695 at iter 73
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4375569683711603
accuracies_anomaly['prior'][-1]= 0.4706030243754699
accuracies_anomaly['prior_star'][-1]= 0.4389097833200467



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.04059672355652 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4375569623427612
 first_prior_anomaly_auc= 0.4559745654609386
 first_prior_star_anomaly_auc= 0.4345435706159432


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4483044826210901; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.486627359093406; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.4706038562945408 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4416924320442687; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4775514415348979; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.464623859246045 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4422008491361787; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4918715538656747; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.47219658946939963 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4401893592486975; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48361394928139073; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.46591261642647114 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.47120757031886373 at iter 10
0.5050217649319828 at iter 10
0.4828532376602288 at iter 10
last anomaly aucs:
0.43876402265906417
0.4862071254230128
0.4664127384412682




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.764803409576416 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4370002276323487,first_prior_anomaly_auc= 0.47465698409322515, first_prior_star_anomaly_auc= 0.4589818443911052


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4370002276323487 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.46905352687870233 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4395943140622295 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43700023366074775 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.46942520782302943 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44867764052318787 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43700024571754587 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4737127680045372 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45539161927139327 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4370002396891468 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4742955815693032 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45585375031528524 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43700023366074775 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.474485319401462 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4559404989778246 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4370002396891468 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4746107281872025 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45590995910816345 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43700023968914675 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4746991768582781 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4559150832473683 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43700024571754587 at iter 8
max_prior_anomaly= 0.4768473486377506 at iter 1
max_prior_star_anomaly= 0.4589818443911052 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43700023366074775
accuracies_anomaly['prior'][-1]= 0.4747310670893298
accuracies_anomaly['prior_star'][-1]= 0.4558340193651469



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.0236713886261 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43700023366074775
 first_prior_anomaly_auc= 0.4747541016021556
 first_prior_star_anomaly_auc= 0.4558752053875561


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43784535492561194; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48721208366067537; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 100 
last prior star auc 0.466980324269997 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4372022211998058; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48200725433429836; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 100 
last prior star auc 0.462792708916581 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4364789700504311; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4780542341304806; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 220 
last prior star auc 0.45863245646651896 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43701698055334914; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47775171098022257; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 220 
last prior star auc 0.4593099882373878 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4389967128345581 at iter 10
0.4877079857961273 at iter 220
0.466980324269997 at iter 100
last anomaly aucs:
0.43693308332356734
0.4765703256155357
0.4577894029425339




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.93473839759827 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43691138108693484,first_prior_anomaly_auc= 0.47775482766253896, first_prior_star_anomaly_auc= 0.4599881831321536


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43691138711533395 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4738403892127345 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4419439669952385 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4369113810869348 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4785850467249154 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45751940300522925 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43691137505853583 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47722850019700813 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4583842793338282 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43691138108693484 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47719787592976004 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4584371483936246 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43691138108693484 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4770147994785676 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4583737055218689 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43691138108693484 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4768964680333288 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45833514788145174 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43691139314373295 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4766764314674715 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4582652727078942 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43691139917213206 at iter 59
max_prior_anomaly= 0.4787132828298173 at iter 19
max_prior_star_anomaly= 0.4599881831321536 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43691139314373295
accuracies_anomaly['prior'][-1]= 0.47631217148239297
accuracies_anomaly['prior_star'][-1]= 0.45810492934957436



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.26924729347229 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43691138711533395
 first_prior_anomaly_auc= 0.47625666801220534
 first_prior_star_anomaly_auc= 0.45808454130393794


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43661606790195795; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48331824425047476; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 80 
last prior star auc 0.4582285477007927 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43678983650499464; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4783576494838003; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 180 
last prior star auc 0.45743921324087217 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43608685886167425; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4796649620765472; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 180 
last prior star auc 0.45602279868185436 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43651647272101196; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4846225547004875; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 180 
last prior star auc 0.4575916352828212 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43786766603054994 at iter 120
0.4930155450709639 at iter 180
0.4637812216815954 at iter 450
last anomaly aucs:
0.43597497177503564
0.47302286595878795
0.4512002060265664




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.89427304267883 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4372390788316866,first_prior_anomaly_auc= 0.4758116937920511, first_prior_star_anomaly_auc= 0.45620113078298297


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43723907280328755 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.46445174242435205 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43697659027961644 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43723907280328755 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4724541407626359 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44268514660343117 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43723906074648944 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.47761724151068785 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45573377311710184 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43723907280328755 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4765708922850478 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4553129004364078 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43723907280328755 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.4764452182497484 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45528664675848163 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4372390607464894 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.475702284377428 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45484601298565386 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43723907280328755 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.47525856406427913 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4544487294304996 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4372390848600857 at iter 42
max_prior_anomaly= 0.4837638514525307 at iter 1
max_prior_star_anomaly= 0.45620113078298297 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43723907280328755
accuracies_anomaly['prior'][-1]= 0.478040175903862
accuracies_anomaly['prior_star'][-1]= 0.4542289882561964



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.5801305770874 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43723907280328755
 first_prior_anomaly_auc= 0.476150604359063
 first_prior_star_anomaly_auc= 0.45466364788555114


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44771172822626654; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.49085432783591565; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 100 
last prior star auc 0.47106871820320917 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4462996480861762; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4761748626368989; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 100 
last prior star auc 0.4614292478149465 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4444785712115491; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4888408968039358; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 240 
last prior star auc 0.46776768744342345 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4471423399062174; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4918553193869938; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 240 
last prior star auc 0.47149526963582206 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.45030255329225344 at iter 40
0.4962942707542106 at iter 240
0.47456796272423835 at iter 240
last anomaly aucs:
0.4485425621853477
0.48890787834594235
0.47060000414753855




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.95647430419922 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44686988641049347,first_prior_anomaly_auc= 0.4913041368321197, first_prior_star_anomaly_auc= 0.4707951675388554


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4468698803820944 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48320859972828795 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4534737202793898 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4468698924388925 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49375548885734827 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46981517290171926 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44686989846729164 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49121542893988435 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46976590882456337 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4468698924388925 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49063631681214404 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4696765257516329 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44686989243889247 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49038960458042585 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46957251778257153 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4468698803820944 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.490168030772807 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4694829056304765 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4468698864104935 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49008347644752714 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4694233329909203 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4468699044956907 at iter 1
max_prior_anomaly= 0.4939518338148818 at iter 23
max_prior_star_anomaly= 0.4707951675388554 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4468698924388925
accuracies_anomaly['prior'][-1]= 0.49057809453397827
accuracies_anomaly['prior_star'][-1]= 0.46947069812237074



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.75397634506226 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5019391671839033
accuracies_anomaly["prior"][-1]= 0.5003749242230238
accuracies_anomaly["prior_star"][-1]= 0.5019390285307248


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 1096.3970880508423 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012081623077392578 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49927722509415157
 first_prior_anomaly_auc= 0.4949305323462192
 first_prior_star_anomaly_auc= 0.49927683324821237


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4697406257188866; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48257119298159307; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4697408005424595 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4591529604985534; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4804269818603061; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.45915683073075286 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4510858171543159; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4790813226211093; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4510930030060009 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4444833155616129; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47864578887389025; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.44448879537636266 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.49927722509415157 at iter 0
0.4949305323462192 at iter 0
0.49927683324821237 at iter 0
last anomaly aucs:
0.44154586357781145
0.4786839546683681
0.4415485944425877




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.818708658218384 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.441360918322909,first_prior_anomaly_auc= 0.4786915685363867, first_prior_star_anomaly_auc= 0.44136484281070004


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4413609122945099 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4800496161356612 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4413647945835076 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4413609062661109 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48071662835016227 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4413652708270337 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4413609062661109 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48082070263161325 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44136534919622156 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4413609122945099 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48096686719533316 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4413649814638786 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4413609002377118 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48104409098735046 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4413650779182636 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4413609062661109 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4810429033927348 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4413646378451319 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44136091229450997 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48143889687048924 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44136443890796273 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.441360918322909 at iter 0
max_prior_anomaly= 0.4819822907337719 at iter 79
max_prior_star_anomaly= 0.44136538536661585 at iter 35
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4413609062661109
accuracies_anomaly['prior'][-1]= 0.4819822907337719
accuracies_anomaly['prior_star'][-1]= 0.44136396266443667



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.25045228004456 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.44136091229450997
 first_prior_anomaly_auc= 0.4820612868751143
 first_prior_star_anomaly_auc= 0.44136404706202353


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4395484198601508; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48096882642502914; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4395510602989411 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43811637366235856; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47966336455079506; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.438118567999618 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4370336068779693; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4781992954971717; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4370333235432133 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4362742094478035; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47710918009432274; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4362765062678471 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44136091229450997 at iter 0
0.4820612868751143 at iter 0
0.44136404706202353 at iter 0
last anomaly aucs:
0.43587391772151596
0.47648800179790973
0.43587570212763904




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.08342170715332 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43584662715895056,first_prior_anomaly_auc= 0.47641589008829915, first_prior_star_anomaly_auc= 0.43585059384553504


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4358466211305515 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4756772484361127 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358501839143987 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4358466211305515 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4755304991176835 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358507626407089 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4358466211305515 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4753553198692657 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43585046724915477 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4358466271589506 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4755955395151913 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358500874600136 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4358466211305515 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4755302820953172 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43584987646604634 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4358466271589506 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4764612658480583 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43584970164247355 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4358466271589506 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4781351231891292 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435849189228553 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4358466271589506 at iter 6
max_prior_anomaly= 0.47977714455474 at iter 79
max_prior_star_anomaly= 0.43585088923708915 at iter 19
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4358466211305515
accuracies_anomaly['prior'][-1]= 0.47977714455474
accuracies_anomaly['prior_star'][-1]= 0.43584860447384377



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.78246808052063 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4358466211305515
 first_prior_anomaly_auc= 0.4799408216177426
 first_prior_star_anomaly_auc= 0.43584847787746334


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4356792968861149; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4782985530877701; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4356773858836114 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43551660245215984; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4767740131631299; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.43551456485327594 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43531274610939186; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47523150860927726; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4353131861825235 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43529092933317703; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47409477559646185; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43529085096398923 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4358466211305515 at iter 0
0.4799408216177426 at iter 0
0.43584847787746334 at iter 0
last anomaly aucs:
0.43517594967781825
0.473426388906974
0.435178445435031




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.89225387573242 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4351739241357325,first_prior_anomaly_auc= 0.47336773258407566, first_prior_star_anomaly_auc= 0.43517586528023133


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4351739241357325 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47558064936950184 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351754071219024 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4351739241357326 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47625488963448126 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351749248499773 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4351739241357326 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47594794163930976 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351743883224606 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4351739241357325 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4755371062430583 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351738397381456 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4351739241357325 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47487038942011145 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351731344154551 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4351739241357326 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4748871121991166 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351726521435299 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4351739241357326 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4755676400843204 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351702709258994 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4351739241357326 at iter 1
max_prior_anomaly= 0.47745771801464076 at iter 79
max_prior_star_anomaly= 0.4351759195358229 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4351739241357325
accuracies_anomaly['prior'][-1]= 0.47745771801464076
accuracies_anomaly['prior_star'][-1]= 0.43516945106362664



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.15909481048584 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4351739241357325
 first_prior_anomaly_auc= 0.47761675321036356
 first_prior_star_anomaly_auc= 0.4351695595748098


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43522122295479326; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.47607573767107997; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.43521407930190176 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4352542646100663; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.47462537719692943; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4352447879667368 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4353179064189911; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4734362815098391; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43530756771459533 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4354269963284639; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.47270522358367584; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4354216069397001 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4355443270594579 at iter 490
0.47761675321036356 at iter 0
0.4355380695812288 at iter 490
last anomaly aucs:
0.4355443270594579
0.4726353544385173
0.4355380695812288




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.774534702301025 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4355582647180952,first_prior_anomaly_auc= 0.4726441559011516, first_prior_star_anomaly_auc= 0.4355514104283588


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4355582647180952 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47297913595197344 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4355513079455746 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43555826471809517 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4754513160959702 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4355512235479877 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4355582526612971 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.476312171482393 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43555033737332527 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43555825266129705 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47663504047949407 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43554917389230585 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4355582647180952 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4763311971098408 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435547702962934 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43555825868969605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4765008422879173 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43554779338891997 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4355582586896961 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47687997433348817 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4355481008372723 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4355582707464943 at iter 78
max_prior_anomaly= 0.4773757378157615 at iter 79
max_prior_star_anomaly= 0.43555177816070173 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4355582526612971
accuracies_anomaly['prior'][-1]= 0.4773757378157615
accuracies_anomaly['prior_star'][-1]= 0.43554638274353885



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.17481207847595 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4355582647180952
 first_prior_anomaly_auc= 0.47741008160523246
 first_prior_star_anomaly_auc= 0.43554629834595204


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43567448622366134; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4774942501129722; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 100 
last prior star auc 0.435660452110639 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43574803872064827; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.47754845747736097; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 200 
last prior star auc 0.43573611454729855 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43570682255624377; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.477470522334254; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 200 
last prior star auc 0.43568772458800714 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4356604521106389; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.47751852647600534; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 200 
last prior star auc 0.435634132120323 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43579251022054777 at iter 490
0.47769564686892185 at iter 480
0.4357657863274944 at iter 490
last anomaly aucs:
0.43579251022054777
0.47769517062539574
0.4357657863274944




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.97005820274353 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43582240505150904,first_prior_anomaly_auc= 0.47769491140423603, first_prior_star_anomaly_auc= 0.43579138893832176


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43582241107990816 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4782024724634788 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43578928502704817 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43582240505150904 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4788521470022701 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43578830842639976 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43582240505150904 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4791621333105701 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357840764902564 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43582240505150904 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4791523070200948 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357801037752729 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43582241107990816 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4785043385182388 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357750881472511 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43582240505150904 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4784940600978337 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357733881387149 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43582241107990816 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4787639997511477 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357727852988085 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43582241710830727 at iter 34
max_prior_anomaly= 0.47927062640853546 at iter 37
max_prior_star_anomaly= 0.43579179284105907 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43582241107990816
accuracies_anomaly['prior'][-1]= 0.4790169694610949
accuracies_anomaly['prior_star'][-1]= 0.4357699881216425



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.20040726661682 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43582240505150904
 first_prior_anomaly_auc= 0.47906066932591407
 first_prior_star_anomaly_auc= 0.43576936116813975


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4361147944629395; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4789553833362511; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.43606547010179314 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4362445316392085; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.47887960033161014; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.43620123567712665 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4363645329509882; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4786999540394855; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.43632284657145654 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.436397743401435; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4784934271159319; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.4363616393194371 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43640897430889225 at iter 490
0.4790629118903661 at iter 10
0.4363668357994308 at iter 420
last anomaly aucs:
0.43640897430889225
0.4782635401460029
0.43636277265846124




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.97455024719238 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43640666543205053,first_prior_anomaly_auc= 0.47823715987169635, first_prior_star_anomaly_auc= 0.43636311024880886


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43640667146044965 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.478521814847127 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4363578595132237 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43640666543205053 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.47928320767738325 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4363582031319704 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4364066714604496 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4797115073457248 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43635823327396567 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43640666543205053 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4805649417728991 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43635954143656275 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43640666543205053 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.48143652770965684 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43635937866978797 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43640666543205053 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4823895512893781 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4363569130545705 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43640666543205053 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.483439143793715 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4363577389452423 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43640667146044965 at iter 5
max_prior_anomaly= 0.4843689218666432 at iter 79
max_prior_star_anomaly= 0.43636311024880886 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43640666543205053
accuracies_anomaly['prior'][-1]= 0.4843689218666432
accuracies_anomaly['prior_star'][-1]= 0.4363583779555432



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.42678880691528 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43640666543205053
 first_prior_anomaly_auc= 0.4844178905522447
 first_prior_star_anomaly_auc= 0.43635802227999837


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43641383319853827; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.48434074512941533; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.43635301870877474 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4363887791720259; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.48437038073921673; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.43633371577497004 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43640453740718077; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.48447901851875963; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 290 
last prior star auc 0.43632955015121644 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43643633118384734; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.48439453653426856; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 290 
last prior star auc 0.43631725824552364 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4365235138911194 at iter 490
0.4844939689484398 at iter 290
0.43641470128800364 at iter 490
last anomaly aucs:
0.4365235138911194
0.48446517731450733
0.43641470128800364




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.86871266365051 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4365406104308666,first_prior_anomaly_auc= 0.4844691861998853, first_prior_star_anomaly_auc= 0.43643009179081554


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43654061043086656 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4848111290516267 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4364227672859521 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43654061043086656 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4807185212674685 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43641005339232486 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4365405923456694 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47769270501017835 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4363988164564685 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43654059837406844 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4773743934827701 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43639078662891445 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43654061043086656 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4768086644009532 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43637651740832856 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43654061043086656 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4745811227193964 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4363621577617568 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43654061043086656 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47305242922780066 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4363488771986174 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4365406104308666 at iter 0
max_prior_anomaly= 0.48490112099286287 at iter 7
max_prior_star_anomaly= 0.43643009179081554 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4365406104308666
accuracies_anomaly['prior'][-1]= 0.47088882474672283
accuracies_anomaly['prior_star'][-1]= 0.4363419807100875



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.3290343284607 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43654061043086656
 first_prior_anomaly_auc= 0.4707220249730048
 first_prior_star_anomaly_auc= 0.4363414381541717


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43667884764981657; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4704306905314106; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4364769264231483 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4368809437000577; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4702619194711985; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4366043245805802 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4371048806401099; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4703016104506397; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4368119486727636 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43737099828841697; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4699846975118145; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43705539954058775 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43753964275224866 at iter 490
0.4707220249730048 at iter 0
0.4372257741549511 at iter 490
last anomaly aucs:
0.43753964275224866
0.4696985776354111
0.4372257741549511




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.84039378166199 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43755780631863034,first_prior_anomaly_auc= 0.46967151012361114, first_prior_star_anomaly_auc= 0.43725203988967554


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43755780631863034 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.46674355889673547 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4372168159539411 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4375578123470294 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4632043822603024 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43718806049040304 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4375578123470294 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4631523270343797 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4371632717134495 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4375578063186303 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.46563527992750486 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43713593895209063 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4375578123470294 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.467899347678994 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43710708100576845 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4375578123470294 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.46818860232291104 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.437062235745127 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4375578123470294 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.46794408442845226 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43702566747640126 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43755781234702945 at iter 74
max_prior_anomaly= 0.46967151012361114 at iter 0
max_prior_star_anomaly= 0.43725203988967554 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4375578063186303
accuracies_anomaly['prior'][-1]= 0.4677092662280886
accuracies_anomaly['prior_star'][-1]= 0.4369847828739452



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.86966919898987 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4992772250941515
accuracies_anomaly["prior"][-1]= 0.4949305323462192
accuracies_anomaly["prior_star"][-1]= 0.49927683324821237


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 1096.6243641376495 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.011882781982421875 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5130764958025463
 first_prior_anomaly_auc= 0.5112535018970166
 first_prior_star_anomaly_auc= 0.5130764837457481


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4917810012833256; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.510698443081544; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4917831473933926 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4803098440380821; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5071639685963814; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.48031625222628777 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4673059663306679; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5027378034635805; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4673172514937168 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4537146573048041; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4992042272098785; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.45372778112956763 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5130764958025463 at iter 0
0.5112535018970166 at iter 0
0.5130764837457481 at iter 0
last anomaly aucs:
0.4461582097873229
0.4967257172468639
0.44617539675305606




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.77715611457825 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4456544405910917,first_prior_anomaly_auc= 0.49646744857413894, first_prior_star_anomaly_auc= 0.4456713381936698


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4456544285342936 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49812601186678296 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44566978889511016 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4456544285342936 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49943944931297957 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4456690896008187 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4456544285342936 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.500310540921014 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44566861938569163 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4456544285342936 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.501066321311741 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44566842044852256 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4456544345626927 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.5018807580253666 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44566843853371974 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4456544285342936 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.5028791453080488 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4456683601645318 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4456544345626927 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.5038599658358568 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44566837222133 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.44565444059109177 at iter 35
max_prior_anomaly= 0.5046969487619839 at iter 79
max_prior_star_anomaly= 0.4456713381936698 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4456544285342936
accuracies_anomaly['prior'][-1]= 0.5046969487619839
accuracies_anomaly['prior_star'][-1]= 0.4456686796696823



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.41535425186157 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4456544466194908
 first_prior_anomaly_auc= 0.5047684154328945
 first_prior_star_anomaly_auc= 0.44566866761288415


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4417955116398741; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5034607471646028; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.44180580814547643 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4397413949426072; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5018939783045152; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4397506485351714 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.438661431363783; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4996342690855497; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43867201723254046 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4381082895792129; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49685857713384834; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43811694033187065 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4456544466194908 at iter 0
0.5047684154328945 at iter 0
0.44566866761288415 at iter 0
last anomaly aucs:
0.4375616222952382
0.4948676440871774
0.43757045992826693




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.11813950538635 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43751689760257806,first_prior_anomaly_auc= 0.4946877807726865, first_prior_star_anomaly_auc= 0.43752485508934325


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.437516891574179 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4946330127671847 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4375247706917564 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4375169036309771 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.49453560589509915 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43752496360052645 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43751689157417895 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.49512596701549394 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4375245596977891 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43751689157417895 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.49668599612542735 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4375242341642397 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43751689157417895 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4997571821140775 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43752455366939 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.437516891574179 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.5027941810516325 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4375256206960244 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43751689157417895 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.5040105492160911 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43752539161686 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4375169096593762 at iter 64
max_prior_anomaly= 0.5049274928274108 at iter 79
max_prior_star_anomaly= 0.4375257111220105 at iter 64
last values
accuracies_anomaly['vanilla_star'][-1]= 0.437516891574179
accuracies_anomaly['prior'][-1]= 0.5049274928274108
accuracies_anomaly['prior_star'][-1]= 0.4375252650204797



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.09213519096375 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43751689760257806
 first_prior_anomaly_auc= 0.5050598523572729
 first_prior_star_anomaly_auc= 0.4375253675032638


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4372374511639392; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5029191738778376; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4372424607635618 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43705055873613885; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5012040340599725; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.43705646053882313 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4370309061551883; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5001140512819029; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43703665121949686 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4372705410464047; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4990946670852786; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43727418822783876 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43751689760257806 at iter 0
0.5050598523572729 at iter 0
0.4375253675032638 at iter 0
last anomaly aucs:
0.4373333087374651
0.497757972075491
0.43733568995509564




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.992295026779175 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43732800977468744,first_prior_anomaly_auc= 0.49758636766771847, first_prior_star_anomaly_auc= 0.437331337450971


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43732801580308645 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49931464939554443 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43733025836753847 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43732801580308645 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.49970718860063496 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43732958318684323 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43732802183148556 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5020683015202658 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43732944453366474 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4373280218314855 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5035285063700887 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4373294385052657 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4373280097746874 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5044709440810525 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43732868495538263 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43732802183148545 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5044737774286129 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4373278409795136 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43732801580308645 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5043634516973319 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4373266172145035 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43732802183148556 at iter 11
max_prior_anomaly= 0.5046279537346896 at iter 58
max_prior_star_anomaly= 0.437331337450971 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4373280158030865
accuracies_anomaly['prior'][-1]= 0.5044786664602543
accuracies_anomaly['prior_star'][-1]= 0.43732636402174274



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.1434895992279 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43732801580308645
 first_prior_anomaly_auc= 0.5044974991789322
 first_prior_star_anomaly_auc= 0.437326665441696


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43732286152188626; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5038257787847615; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4373239526621169 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.437381837349935; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5032783700077019; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4373813430212118 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4373923086791103; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.5027463939322476; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4373934962737259 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43740155021487626; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.502076162552646; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4374044137044319 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4374327471800355 at iter 490
0.5044974991789322 at iter 0
0.4374396557253635 at iter 490
last anomaly aucs:
0.4374327471800355
0.5014052559923492
0.4374396557253635




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.932379722595215 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4374373227349255,first_prior_anomaly_auc= 0.5013256992098939, first_prior_star_anomaly_auc= 0.43744324865120604


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4374373227349255 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5010408030985007 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4374435319859621 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4374373227349255 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5013615259855347 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43744386957630965 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43743732273492547 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5007774163149699 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4374440142578872 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4374373227349255 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5007056060253126 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4374457805788131 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4374373227349255 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5001980449660697 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43744629299273363 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4374373227349255 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49993045035999184 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4374489876871155 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4374373227349255 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49937404721152784 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43744995223096583 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4374373227349255 at iter 0
max_prior_anomaly= 0.5013804310450013 at iter 21
max_prior_star_anomaly= 0.43744995223096583 at iter 70
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4374373227349255
accuracies_anomaly['prior'][-1]= 0.4996675820187806
accuracies_anomaly['prior_star'][-1]= 0.4374497472653976



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.95446801185608 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4374373227349255
 first_prior_anomaly_auc= 0.4996184686516015
 first_prior_star_anomaly_auc= 0.43744940364665097


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4374522731646056; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.49881497951067727; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.43746282286296867 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43743311491237846; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.49833607746058756; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.43744084331997923 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43738081855049316; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4981014159985995; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4373865636148017 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4373244771328355; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.49807357082332016; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43732449521803274 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43746663281117754 at iter 60
0.4996184686516015 at iter 0
0.4374781410249918 at iter 60
last anomaly aucs:
0.4372324114223212
0.4980384674555671
0.43723913911567724




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.995627880096436 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4372257078425613,first_prior_anomaly_auc= 0.49805275476135014, first_prior_star_anomaly_auc= 0.43723100680533916


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4372257018141623 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4986460155416951 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43722995183550284 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4372257018141623 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4985451363117483 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43723088020895884 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4372257018141623 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.49833183949604515 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4372313202820905 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4372257078425614 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4988389303401609 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43723329156858465 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4372257198993595 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.49913510558620394 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4372355823602292 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43722571387096043 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4983979589769855 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43723528696867503 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4372257018141623 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.49742616296257713 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.437236311796516 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43722571989935954 at iter 5
max_prior_anomaly= 0.49924720366680986 at iter 48
max_prior_star_anomaly= 0.437236685557258 at iter 75
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43722571387096043
accuracies_anomaly['prior'][-1]= 0.4969736532435922
accuracies_anomaly['prior_star'][-1]= 0.43723648662008885



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.20499873161316 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43722571387096043
 first_prior_anomaly_auc= 0.496978216741684
 first_prior_star_anomaly_auc= 0.4372369568352159


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4371175041077511; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49703980889492694; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 100 
last prior star auc 0.4371258534404555 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4370059063842675; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4971809216602307; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 200 
last prior star auc 0.4370183911987303 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4370014513973588; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4973887989451748; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 300 
last prior star auc 0.43701358053627676 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43706496660990324; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4975893276116592; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 400 
last prior star auc 0.4370764386533232 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43722571387096043 at iter 0
0.49764484916704405 at iter 490
0.4372369568352159 at iter 0
last anomaly aucs:
0.4371489060384786
0.49764484916704405
0.43715837665340895




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.98815870285034 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4371612582281619,first_prior_anomaly_auc= 0.4976530176477766, first_prior_star_anomaly_auc= 0.43716807634750393


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43716125822816193 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.49825891395256083 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43717066253070264 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4371612582281619 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.49867862918063444 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4371708735246699 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4371612582281619 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.49895183019784245 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43717625085663553 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4371612521997628 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5000226185532903 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43717844519389504 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43716125219976276 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5006029122472473 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4371795483909238 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43716125822816193 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.49989501543029025 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4371782462567259 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4371612521997628 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.49922847945931526 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.437177697672411 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.437161264256561 at iter 46
max_prior_anomaly= 0.5008308761578747 at iter 48
max_prior_star_anomaly= 0.43717982569728076 at iter 49
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4371612582281619
accuracies_anomaly['prior'][-1]= 0.4991319165630988
accuracies_anomaly['prior_star'][-1]= 0.4371752863127852



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.02886295318604 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4371612582281619
 first_prior_anomaly_auc= 0.49910879765268606
 first_prior_star_anomaly_auc= 0.43717482212605724


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4371788370398342; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4992511582965963; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.43720564533047446 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.437141949265958; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.499428851387424; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 170 
last prior star auc 0.43717092175186234 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4371610050354011; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4995153046584092; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 300 
last prior star auc 0.43718504629087074 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43714142479523943; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.49967737213886154; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 400 
last prior star auc 0.43716443519446896 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4371921839153632 at iter 70
0.499760214398807 at iter 490
0.43721488083784144 at iter 80
last anomaly aucs:
0.4371881810583843
0.499760214398807
0.43720606129000983




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.95801663398743 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43720179921187124,first_prior_anomaly_auc= 0.49976992012130106, first_prior_star_anomaly_auc= 0.43721592977927853


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4372018052402703 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4994021214659716 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43721221025705576 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4372017992118712 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4986210700263658 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43721040776573544 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43720180524027025 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4976677148846961 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43720768292935824 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43720179921187124 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4962901834996448 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4372043311394784 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43720180524027025 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4946190087961576 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4372026733297356 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43720180524027025 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.491704314018825 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4372041382307083 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4372018052402703 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.48704157039313356 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43720507263256325 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43720181126866936 at iter 65
max_prior_anomaly= 0.4997749116357265 at iter 1
max_prior_star_anomaly= 0.43721592977927853 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4372018052402703
accuracies_anomaly['prior'][-1]= 0.48151680187160084
accuracies_anomaly['prior_star'][-1]= 0.43719904423349876



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.87663698196411 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4372018052402703
 first_prior_anomaly_auc= 0.48087843660945473
 first_prior_star_anomaly_auc= 0.43719890558032026


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43732122782573973; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48073331495877303; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.43727959570179964 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4374489876871155; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4807336465207215; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.43739547358861913 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43767743989806696; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.48071581451628853; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.43762097188402904 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43786731035500515; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4806800841950327; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.4378244604944541 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4380040525309872 at iter 490
0.48088252989241964 at iter 10
0.4379660675884812 at iter 490
last anomaly aucs:
0.4380040525309872
0.4805481707667014
0.4379660675884812




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.920647621154785 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43801141320624504,first_prior_anomaly_auc= 0.4805297238655638, first_prior_star_anomaly_auc= 0.4379774914047086


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43801142526304315 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47579076319049884 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4379664112072279 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43801141320624504 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4719602159420772 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4379510568748104 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4380114192346441 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4697193153281932 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43794238803695557 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43801142526304315 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.467249510373428 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4379267021425895 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43801142526304315 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.465618213529753 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43791407867494825 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43801141320624504 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4648228868411623 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43789999633473337 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4380114252630432 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.46396508182466617 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4378835568904842 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43801143129144227 at iter 37
max_prior_anomaly= 0.4805297238655638 at iter 0
max_prior_star_anomaly= 0.4379774914047086 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43801142526304315
accuracies_anomaly['prior'][-1]= 0.46312121446680743
accuracies_anomaly['prior_star'][-1]= 0.43786386211074024



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.02667689323425 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5130764958025463
accuracies_anomaly["prior"][-1]= 0.5112535018970166
accuracies_anomaly["prior_star"][-1]= 0.5130764837457482


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 1097.6313149929047 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012427091598510742 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5109587071543593
 first_prior_anomaly_auc= 0.507735828560047
 first_prior_star_anomaly_auc= 0.5109585142455892


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.49045347546851514; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49920780807892284; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4904538251156609 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4708670381125034; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4885789447793823; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.47086777960558834 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45574181500145405; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4828604235119138; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4557465231811235 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4452476020234201; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48030815005794497; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.445253473684109 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5109587071543593 at iter 0
0.507735828560047 at iter 0
0.5109585142455892 at iter 0
last anomaly aucs:
0.44054246066710745
0.4793857206034765
0.4405476752322983




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.893391609191895 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44020799303020614,first_prior_anomaly_auc= 0.4792907070058196, first_prior_star_anomaly_auc= 0.44021400937247257


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4402079930302062 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48770726238823947 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44382272962051467 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4402079990586052 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.47939671640337034 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45837462786692573 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4402079930302062 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.47860499469742024 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4568350651718166 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4402079930302062 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4765161544215414 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4580662993683685 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4402079930302062 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4762018939783045 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4574398100523795 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4402079930302062 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.47660587508481955 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45527455378995807 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4402079930302062 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.47067286337863307 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45572922167580815 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4402079930302062 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.47042175041559775 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4511329652634001 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4402079930302062 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.46972085859835383 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4535491476084859 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4402079930302062 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4715517075078647 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45551598514409564 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4402079930302061 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.46950348658488306 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4544257491732653 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4402079930302061 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4709626364648697 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4550575133384358 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4402079990586052 at iter 20
max_prior_anomaly= 0.5209345441252287 at iter 6
max_prior_star_anomaly= 0.4593619590657235 at iter 34
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4402079930302062
accuracies_anomaly['prior'][-1]= 0.46975880134206627
accuracies_anomaly['prior_star'][-1]= 0.45454760723195686



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.18001961708069 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4402079930302062
 first_prior_anomaly_auc= 0.46773382592587764
 first_prior_star_anomaly_auc= 0.45373535279879285


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4365543551807338; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47532939172488897; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 40 
last prior star auc 0.45320312955897674 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43580965498748747; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4749256758679327; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 130 
last prior star auc 0.4505312285539704 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4355976301639869; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4683374254106184; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 130 
last prior star auc 0.4457837497510271 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4354227101367289; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46577363168603714; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 130 
last prior star auc 0.44364234183530504 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4402079930302062 at iter 0
0.47830702298845584 at iter 130
0.4572070837064912 at iter 20
last anomaly aucs:
0.43564652650879976
0.4626704107847577
0.4422666249983723




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.978662729263306 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4354813664596273,first_prior_anomaly_auc= 0.4646076910797538, first_prior_star_anomaly_auc= 0.44286192337760105


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43548137248802643 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.47529954512112016 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4359128913214685 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4354813664596273 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4643907350258184 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43868643716310296 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43548136043122826 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.46486051610812346 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43855266095946066 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4354813724880264 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.47580115615048624 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4385971565729564 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4354813664596273 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4685515240033971 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4413352976268845 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43548137248802643 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4616221445282151 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4425357267042163 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4354813664596273 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.46109518408078254 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.442837176799441 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4354813664596273 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.460027795742407 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43771233830025186 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4354813664596273 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.4733304409074621 iter_best_prior_anomaly= 830
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4365316040026641 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4354813664596273 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.4617242053243785 iter_best_prior_anomaly= 950
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43609835501869043 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4354813664596273 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.46630084532623045 iter_best_prior_anomaly= 950
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44055378802894984 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4354813604312283 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.4695604489276442 iter_best_prior_anomaly= 950
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44140589017993087 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43548137851642543 at iter 76
max_prior_anomaly= 0.4949277713394476 at iter 95
max_prior_star_anomaly= 0.4455609642351963 at iter 13
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4354813604312283
accuracies_anomaly['prior'][-1]= 0.46703493553712316
accuracies_anomaly['prior_star'][-1]= 0.4402447120089085



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 128.04308819770813 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4354813664596273
 first_prior_anomaly_auc= 0.4662036554765112
 first_prior_star_anomaly_auc= 0.4423000464427864


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.434369560876944; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4570609010575741; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4396838237315404 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43443502929078537; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45438135001415475; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4379316695434187 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4342875806780647; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4528842694472537; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4374263510486279 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.434315052092602; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4507124060594574; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4365003949807067 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4354813664596273 at iter 0
0.4662036554765112 at iter 0
0.4423000464427864 at iter 0
last anomaly aucs:
0.4343374174531316
0.44974072458463127
0.436597120643698




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.81493258476257 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4341493977147063,first_prior_anomaly_auc= 0.4493924639706702, first_prior_star_anomaly_auc= 0.4363031819337078


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4341493012603212 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.45962514691208517 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43443140019454846 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43414933140231654 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4545401561307131 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43649763397393515 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43414931331711937 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.459809193935527 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348269656559694 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4341493253739175 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4563859434131059 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4346407725224606 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4341493494875137 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.47357110062651947 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347581092818537 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4341493374307156 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4647961930901042 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43767244838364155 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43414938565790817 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.467231593971408 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43562945408264886 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43414931331711937 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4703184959964196 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43481024287696424 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4341493615443119 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.45097804143583925 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43564019066138293 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4341493374307156 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4660801576932741 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43552859896629836 iter_best_prior_star_anomaly= 970
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4341492711183259 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.5169478733978323 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4359843519639801 iter_best_prior_star_anomaly= 970
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4341493012603212 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4588419373056143 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43449061715855997 iter_best_prior_star_anomaly= 970
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4341494097715044 at iter 13
max_prior_anomaly= 0.5395919690149933 at iter 66
max_prior_star_anomaly= 0.45814651324632183 at iter 97
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43414933140231654
accuracies_anomaly['prior'][-1]= 0.4654620719655812
accuracies_anomaly['prior_star'][-1]= 0.4387861408552321



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 128.46983814239502 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4341493916863072
 first_prior_anomaly_auc= 0.45129550898737847
 first_prior_star_anomaly_auc= 0.437498691837403


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4368466541661784; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4722406269245664; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.44052471306026136 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4361253381329035; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4701341354962265; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 130 
last prior star auc 0.43976008900810654 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4362618572581201; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.46893707629397174; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 130 
last prior star auc 0.43917121690228067 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4362500355675545; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.47226572917827137; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 130 
last prior star auc 0.43957115295302335 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4371181792884464 at iter 110
0.4757495590828925 at iter 130
0.44161960295516944 at iter 130
last anomaly aucs:
0.4364053753546507
0.47340841222096347
0.43959460945378365




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.4033682346344 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43605859169846045,first_prior_anomaly_auc= 0.46760579478654407, first_prior_star_anomaly_auc= 0.43857433908249693


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4360586097836577 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.46733894770195017 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4359658990344434 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4360585675848642 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.44783901787251523 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366904824600112 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4360585615564651 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.49907976488279104 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4365456381156864 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43605862184045574 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4709623591585126 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43600046587467967 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4360585736132632 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.47756200931845816 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44012492771949524 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4360586519824511 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4712235455763849 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43775248743802203 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43605855552806605 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4549398691306904 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43639824375855735 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4360585736132633 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.47769729865026556 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4374361411687089 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4360585977268595 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4602250329030021 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4373722099966289 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4360585856700614 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4752336004637527 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44124437128379335 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4360585615564651 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.46254515270899377 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4369269102429252 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4360586158120567 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.44885832972835066 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43627870663350565 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43605866403924926 at iter 47
max_prior_anomaly= 0.5385925086772776 at iter 28
max_prior_star_anomaly= 0.4535492500912699 at iter 28
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43605850730087353
accuracies_anomaly['prior'][-1]= 0.4791757152936626
accuracies_anomaly['prior_star'][-1]= 0.44208023895609344



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 126.79638671875 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4360585736132633
 first_prior_anomaly_auc= 0.46984712341676155
 first_prior_star_anomaly_auc= 0.43881877860776775


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4367486444541864; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.49141553561843415; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 30 
last prior star auc 0.4558387275448163 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4370281089780223; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5004317780546019; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 30 
last prior star auc 0.4614007576009672 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4374960393418145; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.49646538686165886; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 260 
last prior star auc 0.46090168452760744 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4379822839819649; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 350 
last prior auc 0.500771080467553; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 260 
last prior star auc 0.4627217245175954 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4381884431731756 at iter 350
0.5058741564461189 at iter 260
0.46521129659289356 at iter 30
last anomaly aucs:
0.4374559926868285
0.49273614685951755
0.45601910930162687




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.43376898765564 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4383074015719171,first_prior_anomaly_auc= 0.5004423940653546, first_prior_star_anomaly_auc= 0.462722990481399


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4383074196571143 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.46998287090689794 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43849311243350075 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43830738951511905 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4925638311006555 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44975855056066527 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.438307389515119 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4815888231552255 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4514359706855833 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43830739554351805 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.49122776304437044 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45010745018492715 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43830739554351805 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4781557101719347 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44689916031635113 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43830738348671994 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4882971472651083 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4457186912683221 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43830740157191717 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4808355746921056 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4494749445266718 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.438307395543518 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48611748915732145 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4473415664385038 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43830739554351805 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4864258839682684 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4416268973180376 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43830739554351805 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.49169606114050557 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4512750847713477 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43830739554351805 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4846662123665132 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44466089411285836 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43830738951511905 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.46817129478919656 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44618202799202705 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4383074196571143 at iter 10
max_prior_anomaly= 0.5004423940653546 at iter 0
max_prior_star_anomaly= 0.462722990481399 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4383074076003161
accuracies_anomaly['prior'][-1]= 0.48184779112224196
accuracies_anomaly['prior_star'][-1]= 0.45016162740732063



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 126.21954870223999 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4383074015719171
 first_prior_anomaly_auc= 0.4842923491417248
 first_prior_star_anomaly_auc= 0.44918308561435893


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43789709064638427; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49952145965385414; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 100 
last prior star auc 0.4607244676803058 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4374725346138617; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5020500535562973; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 200 
last prior star auc 0.46051753685401486 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43736633230754096; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49567974781036483; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 200 
last prior star auc 0.4576111974377857 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4381426815958763; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4978508154494847; count_not_improved_prior_anomaly= 32; iter_best_prior_anomaly= 380 
last prior star auc 0.45876617841456957 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4399587307856837 at iter 10
0.5039637206121574 at iter 380
0.4616524432619137 at iter 380
last anomaly aucs:
0.43823242637275084
0.49741218310514634
0.4602531734698356




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.531299352645874 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43731701397479356,first_prior_anomaly_auc= 0.49293992483309773, first_prior_star_anomaly_auc= 0.45495289047266985


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43731705617358696 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4720514316483234 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4386242602551508 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43731700191799544 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48068732430230926 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.446826349312449 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4373169597192019 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48300696183637576 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4465556319956557 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4373170200031926 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.49886502727971144 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44773229109547585 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43731697177600004 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4774316994442781 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.447260659294658 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43731696574760104 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4795217453999698 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44590071274967824 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43731698986119727 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4778582388200928 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44481117004474036 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43731704411678884 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4798018368773086 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44804702175383976 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4373170139747935 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4889019825716572 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44550921645762587 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43731700794639455 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4853617630221859 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44865783120386166 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43731701397479356 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.49201716381668076 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.450566295751329 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4373170200031926 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4830696632150465 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.446118922710619 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43731705617358696 at iter 10
max_prior_anomaly= 0.5018780753877827 at iter 42
max_prior_star_anomaly= 0.45495289047266985 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43731703205999073
accuracies_anomaly['prior'][-1]= 0.4817471108294643
accuracies_anomaly['prior_star'][-1]= 0.4443791327689788



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 126.77845335006714 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4373169898611974
 first_prior_anomaly_auc= 0.48517359257378395
 first_prior_star_anomaly_auc= 0.4478516955957481


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4372131446589107; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4931650433393665; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 60 
last prior star auc 0.45532069515639834 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4372694921049674; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.496638637022376; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 190 
last prior star auc 0.4566113211405345 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43798349569017697; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.49996033916255406; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 220 
last prior star auc 0.4588826289993002 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4378432208723432; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4952266292230744; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 220 
last prior star auc 0.45720941066853016 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43845444025350133 at iter 20
0.5053686570993563 at iter 220
0.4628939257368753 at iter 60
last anomaly aucs:
0.43720814711608624
0.49569812839911276
0.4580862955680656




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.498727798461914 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43701195889692834,first_prior_anomaly_auc= 0.490371230020077, first_prior_star_anomaly_auc= 0.4542800608530715


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4370119166981349 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4851338171967559 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43954580956335587 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4370119468401302 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4858676361296906 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.452455300626616 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.437011922726534 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4897444754545292 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.452319028665761 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43701189258453865 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4905199325398032 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4471820248572596 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4370118865561396 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4952086284234675 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45022167629040294 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4370119347833321 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4935983405505327 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4532434595487188 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43701195889692834 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4898576887889621 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4513846931231399 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4370119106697358 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4925543845993212 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45002296217203697 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43701192875493305 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4886656994703208 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44976966090014125 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43701194081173117 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4920884797776147 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4522566950194331 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43701195889692834 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4905260754784499 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44901562874514295 iter_best_prior_star_anomaly= 1050
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43701192875493305 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.49339679911300544 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45208573565036064 iter_best_prior_star_anomaly= 1050
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4370119769821255 at iter 5
max_prior_anomaly= 0.49880321810410233 at iter 69
max_prior_star_anomaly= 0.4556644766698545 at iter 105
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4370119528685293
accuracies_anomaly['prior'][-1]= 0.49384115240805604
accuracies_anomaly['prior_star'][-1]= 0.45217989924374935



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 126.17833232879639 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43701197698212557
 first_prior_anomaly_auc= 0.496433472517011
 first_prior_star_anomaly_auc= 0.45154879820247606


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43561387067106694; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.489452857678179; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 40 
last prior star auc 0.4463405688590266 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43665738654914665; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5012906621545306; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 200 
last prior star auc 0.4524982770835474 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43644943089501476; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4884479175257136; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 200 
last prior star auc 0.4455117182432377 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43590764058588327; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49652005238437646; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 200 
last prior star auc 0.4492546366828565 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43701197698212557 at iter 0
0.5012906621545306 at iter 200
0.4533928071071449 at iter 40
last anomaly aucs:
0.43633751969477974
0.487558897458861
0.44553527722678216




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.50596261024475 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4365711081017343,first_prior_anomaly_auc= 0.48788120581484906, first_prior_star_anomaly_auc= 0.44490004673214956


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43657118647092213 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48751013373882757 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4429481957966144 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43657116235732585 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4859295839584783 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44433019422537245 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4365711623573259 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5006556667674615 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4410756484507738 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4365712286697156 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.49745070457516904 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4465850264694946 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43657119852772025 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4912568078710636 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4430825989537593 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43657116235732585 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.49194256237825645 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44193119281762067 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43657118647092213 iter_best_vanilla_star_anomaly= 610 
last prior auc 0.48070127401774476 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4426538712690841 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4365711442721287 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.4884127056467773 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4427079038099 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4365711322153305 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.48967023572004886 iter_best_prior_anomaly= 830
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4442233468803517 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43657114427212873 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.4832490683712086 iter_best_prior_anomaly= 830
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44166171132263554 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4365711141301334 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.4888518262914398 iter_best_prior_anomaly= 830
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44509906829886775 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4365711804425231 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.48322399625949897 iter_best_prior_anomaly= 1140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4446003087022593 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43657127086850905 at iter 71
max_prior_anomaly= 0.5131871952945692 at iter 114
max_prior_star_anomaly= 0.454880652166679 at iter 109
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4365711864709221
accuracies_anomaly['prior'][-1]= 0.4828266885907484
accuracies_anomaly['prior_star'][-1]= 0.44491058437371445



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 126.10679268836975 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5109587071543593
accuracies_anomaly["prior"][-1]= 0.507735828560047
accuracies_anomaly["prior_star"][-1]= 0.5109585142455892


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 1495.0422966480255 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.013365983963012695 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4943167930942518
 first_prior_anomaly_auc= 0.4923003177207443
 first_prior_star_anomaly_auc= 0.4943167750090547


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.47883915580228587; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4928720209460343; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 80 
last prior star auc 0.47884130191235286 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46962565209192675; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48789831441139436; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 80 
last prior star auc 0.4696278343723882 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4553178075532464; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48466108822730825; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 80 
last prior star auc 0.455322714670085 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44631468894184234; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48286467956165335; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 80 
last prior star auc 0.44632101876086017 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4943167930942518 at iter 0
0.4932339117702804 at iter 80
0.4943167750090547 at iter 0
last anomaly aucs:
0.4412230307511047
0.4815019840667002
0.4412295293652964




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.35716462135315 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44090133729182135,first_prior_anomaly_auc= 0.4813594666844143, first_prior_star_anomaly_auc= 0.440907281293299


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44090134332022035 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4847604784426861 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44557725296946876 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44090133729182135 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4798318281626549 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4588075874877443 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44090133126342224 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4793237968882851 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4593050811205492 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44090134332022035 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.47768533830652143 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4594224540503366 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44090133729182135 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.47580872781971134 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4591363582875295 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44090133729182135 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.47702929777831793 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45745189699250405 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44090133126342224 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4762537984942506 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45801948884963195 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44090133729182124 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4722014302738485 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4550824829673613 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4409013252350231 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4731183256579756 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45606404498825426 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.44090133729182135 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4720779746894048 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4556345818388932 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.44090133126342224 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4742287869076676 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4562069120176859 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.44090134332022035 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.471277505776412 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45517866607443674 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.44090134934861946 at iter 13
max_prior_anomaly= 0.5020894913429779 at iter 5
max_prior_star_anomaly= 0.4607972425138135 at iter 32
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44090133729182135
accuracies_anomaly['prior'][-1]= 0.47746748402112543
accuracies_anomaly['prior_star'][-1]= 0.4503949867351107



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 126.06299304962158 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4409013252350231
 first_prior_anomaly_auc= 0.4756910775835669
 first_prior_star_anomaly_auc= 0.4510448662394702


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43713428114234787; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4741086529711086; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.44584592665897926 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4362867846882522; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47412146934751986; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.44417469167150136 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43597030579415963; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47433738851681606; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.4429378450354205 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43561875367430924; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47428201164300876; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.4415061303995767 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4409013252350231 at iter 0
0.47624390589138565 at iter 10
0.4510448662394702 at iter 0
last anomaly aucs:
0.4350918233688719
0.4728823922037849
0.44037423819121024




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.44606113433838 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4350304783799907,first_prior_anomaly_auc= 0.4727439982464593, first_prior_star_anomaly_auc= 0.4402597347793775


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43503049646518793 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.47125647269207566 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4445981686205914 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4350304844083898 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.47537494833662003 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44490389285075277 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43503048440838976 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.47728308735053787 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4396580583539384 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4350304783799907 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.471270603259483 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44307783651849825 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43503048440838976 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4752006190924703 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4387176522134594 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43503049646518793 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.46631879789864483 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44221068145505293 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43503049646518793 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4627451569047595 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4431081171669997 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4350304783799907 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4653483522456269 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4456736048717181 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43503047837999076 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.46375758432886316 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4434749392216807 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4350304844083898 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4682214872398083 iter_best_prior_anomaly= 910
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44503420272493277 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4350304844083898 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.46389157755487165 iter_best_prior_anomaly= 910
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4425014070283417 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4350304904367888 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4704391483752982 iter_best_prior_anomaly= 910
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44035924556273665 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4350305145503851 at iter 46
max_prior_anomaly= 0.4917048987735343 at iter 91
max_prior_star_anomaly= 0.4473688871430645 at iter 52
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43503049646518793
accuracies_anomaly['prior'][-1]= 0.4685577332544337
accuracies_anomaly['prior_star'][-1]= 0.44470136878417804



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 126.23486852645874 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43503049646518793
 first_prior_anomaly_auc= 0.4648787218732985
 first_prior_star_anomaly_auc= 0.43978496218264695


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4341984929966882; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4695917966027801; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 100 
last prior star auc 0.43887070120891103 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43460846030347444; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4711906908014829; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 200 
last prior star auc 0.4391805006368401 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43500881231375266; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4716444182570789; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 260 
last prior star auc 0.4392839539931874 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43502058577712577; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4700425821996327; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 260 
last prior star auc 0.4385423041698677 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43509131095495146 at iter 340
0.47170190507055876 at iter 260
0.43978496218264695 at iter 0
last anomaly aucs:
0.4350685718336798
0.4683277317449225
0.43804994070466685




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.42327094078064 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4350628749965638,first_prior_anomaly_auc= 0.4681404655563802, first_prior_star_anomaly_auc= 0.43800108053024833


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.435062893081761 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4529162681894885 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43648384702527443 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43506288705336194 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.45103070553006747 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4367957805064724 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.435062893081761 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.46797425053737146 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351675822599166 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4350628810249628 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.45829050155797946 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43593038573555387 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4350628749965638 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4522247384759918 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4390192289050643 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.435062893081761 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.44981793029145145 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43611154515584377 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4350628810249629 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.455452548300739 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4406974688922552 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43506289308176094 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4474902267594365 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43627655449503955 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43506289308176105 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.45489524692081434 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4378914782068551 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4350628810249629 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4517395427772786 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4381951768949308 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4350628749965638 iter_best_vanilla_star_anomaly= 1040 
last prior auc 0.45367052942365127 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43932958897410634 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43506289308176105 iter_best_vanilla_star_anomaly= 1040 
last prior auc 0.45457808681762746 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43762104422481773 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4350628991101601 at iter 104
max_prior_anomaly= 0.5007762347487532 at iter 25
max_prior_star_anomaly= 0.4473715275818548 at iter 25
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4350628749965639
accuracies_anomaly['prior'][-1]= 0.45627714286678833
accuracies_anomaly['prior_star'][-1]= 0.43903879106002885



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.77357530593872 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43506288102496293
 first_prior_anomaly_auc= 0.45384195297945185
 first_prior_star_anomaly_auc= 0.43842108512147704


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4333693650745424; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4747767623542394; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 100 
last prior star auc 0.4373928331498289 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43307934482394417; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4854741022387544; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 190 
last prior star auc 0.4360539438027817 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43336959415370685; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4938339665563711; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 290 
last prior star auc 0.4362711530494777 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4334318976580393; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4954478835255428; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 400 
last prior star auc 0.43624471249118046 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43506288102496293 at iter 0
0.49707971086833536 at iter 490
0.4434048168837614 at iter 10
last anomaly aucs:
0.4332489538316264
0.49707971086833536
0.4356819915804967




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.39808392524719 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4334315238972972,first_prior_anomaly_auc= 0.49868014230879976, first_prior_star_anomaly_auc= 0.43604473843741004


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4334315178688982 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5254930326174971 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4335771157631061 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4334314575849076 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.534967035508235 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4340814938276428 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43343152389729733 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5096622155379333 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4391523841836028 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43343148772690293 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4911878309289667 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43698041228462337 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43343149978370105 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.49845628976633444 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.437989005646922 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4334314816985039 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.5078575298803628 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43553784050206434 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4334315359540954 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4889862897325754 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.441310979065058 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4334315058121001 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4918941121349744 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43627256369485884 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43343148772690293 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4898908751258127 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4402336559250241 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43343148772690293 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.49283790020732865 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4399907717267119 iter_best_prior_star_anomaly= 940
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43343153595409545 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4963036629999532 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43765250041113685 iter_best_prior_star_anomaly= 940
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4334314816985039 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4845903811346798 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43638455326428166 iter_best_prior_star_anomaly= 940
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43343157212448985 at iter 59
max_prior_anomaly= 0.5397319966684655 at iter 12
max_prior_star_anomaly= 0.44541415463277645 at iter 94
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4334315299256964
accuracies_anomaly['prior'][-1]= 0.49158595845999
accuracies_anomaly['prior_star'][-1]= 0.44036740198667096



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.90755081176758 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4334314575849076
 first_prior_anomaly_auc= 0.4819599856572329
 first_prior_star_anomaly_auc= 0.4396172280070739


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43897434747402847; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.49691423734241164; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 40 
last prior star auc 0.4633805742797631 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43908218347649575; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.48768085197193756; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 40 
last prior star auc 0.4581451869985277 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43862158364596604; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4859615887291122; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 210 
last prior star auc 0.4593446213900138 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43939789073550806; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4868576801080675; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 210 
last prior star auc 0.45845068214952456 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4401296600127609 at iter 410
0.5008659855540267 at iter 210
0.46635308140412507 at iter 350
last anomaly aucs:
0.43943210190019955
0.48772406956483155
0.4606043699141411




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.512322425842285 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4395680061287116,first_prior_anomaly_auc= 0.4910922808037929, first_prior_star_anomaly_auc= 0.4623307526962618


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43956800010031255 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.49517045057219156 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44203046849341626 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4395680061287116 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4818776015556163 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44795210461056784 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4395680061287116 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.49125076138680185 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4581350592880991 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4395679880435145 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48683583921825646 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4601868912221204 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4395679940719135 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4847938275463114 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4592232697168437 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4395680001003126 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4849478772560078 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.459045763506387 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4395679940719135 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48416742262790935 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45929457362097964 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4395680061287116 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4825934618877378 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4418163096166469 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4395679940719135 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48018702143554026 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44482065874486804 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4395680061287116 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4828739391826166 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4574679325340158 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4395680061287117 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48231299062125793 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45563170026414035 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4395680121571107 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48761994705618805 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.458040955978701 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4395680181855097 at iter 21
max_prior_anomaly= 0.49634466817039047 at iter 11
max_prior_star_anomaly= 0.4623307526962618 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43956800010031255
accuracies_anomaly['prior'][-1]= 0.4650958105520133
accuracies_anomaly['prior_star'][-1]= 0.4404557662601597



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 126.24643349647522 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4395679880435145
 first_prior_anomaly_auc= 0.48815893415975453
 first_prior_star_anomaly_auc= 0.4448023082981155


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4362190315111653; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4813077550772382; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.43659750646123807 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4350186566894251; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4837093607533859; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.43492747715357327 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.434970670632871; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48572086872606424; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4346612690792802 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43485460586568053; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4860392887646557; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43404578761998325 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4395679880435145 at iter 0
0.48815893415975453 at iter 0
0.4448023082981155 at iter 0
last anomaly aucs:
0.4347729632571488
0.48614021622179493
0.4340346169965165




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.8193199634552 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4347970406830128,first_prior_anomaly_auc= 0.48625549126870793, first_prior_star_anomaly_auc= 0.4340159711582098


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43479705273981095 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4639194589005455 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4397264867117205 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4347970406830128 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4621818391825684 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4388030505146083 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43479704671141184 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4687639647864331 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4460989747381143 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43479705273981095 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4755078263088016 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.434497157971545 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43479705876821 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.4487869474550269 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4379141932145305 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4347970527398109 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.4512500488300324 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4397269508984485 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4347970406830128 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.4794987350007403 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4372480912882882 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43479704671141184 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.5140077387764472 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45724948143711247 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43479705273981095 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.4714618059926145 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4382846262802511 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43479705876821 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.4711412458723552 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4413334288231745 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43479705876820995 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.47082922196517124 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43677961234018114 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43479705876820995 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.4732487259581417 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4437582679493171 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43479706479660907 at iter 43
max_prior_anomaly= 0.5140077387764472 at iter 80
max_prior_star_anomaly= 0.45724948143711247 at iter 80
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43479703465461367
accuracies_anomaly['prior'][-1]= 0.4701923155755988
accuracies_anomaly['prior_star'][-1]= 0.4382989798984239



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.13562846183777 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43479705876821
 first_prior_anomaly_auc= 0.47279742794736873
 first_prior_star_anomaly_auc= 0.44289783455082876


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46382364352581285; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5127677995716461; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 70 
last prior star auc 0.48576771541519514 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.45676559390099636; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4936253658635393; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 70 
last prior star auc 0.47213862641239357 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.456456608306941; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.48859693352219097; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 70 
last prior star auc 0.4721781365398629 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.45434792254134154; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.49398820917483754; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 70 
last prior star auc 0.47112208762012797 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.46762513991914234 at iter 40
0.514738205919502 at iter 70
0.4891311702472946 at iter 70
last anomaly aucs:
0.4580889721772504
0.4986991860214447
0.4759763414273031




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.88893532752991 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.454558723599832,first_prior_anomaly_auc= 0.4900700391460121, first_prior_star_anomaly_auc= 0.4682397291753777


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.454558729628231 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4868864174864083 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45840347978484886 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.45455871757143296 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.48248402233111926 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4592101579488782 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45455872359983196 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4812887173929923 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4622874265921846 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4545587356566301 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.47981075890792413 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46548113979182254 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4545587356566301 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.48806478262316383 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4694866552946947 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.45455871757143296 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4871673227976208 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4690262001457426 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4545587416850292 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.48580975747027155 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46937479232165225 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4545587296282311 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.48593211588608554 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46912566873030825 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4545587356566301 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.48453433510857624 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4684593558100987 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4545587296282311 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.48550157968169083 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46778564001583783 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4545587356566301 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.48549234417432396 iter_best_prior_anomaly= 1040
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46747270582039513 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4545587296282311 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.4856498963838769 iter_best_prior_anomaly= 1040
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4662382162883485 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4545587597702263 at iter 71
max_prior_anomaly= 0.49391405383794407 at iter 104
max_prior_star_anomaly= 0.4697776883163357 at iter 54
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4545587296282311
accuracies_anomaly['prior'][-1]= 0.4854909757277363
accuracies_anomaly['prior_star'][-1]= 0.4682030825374641



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.21593022346497 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4545587175714329
 first_prior_anomaly_auc= 0.4854166817376643
 first_prior_star_anomaly_auc= 0.46766671778749075


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44208056448964295; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4918819106552677; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 80 
last prior star auc 0.4609925988139004 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43984237062693904; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4933557638005728; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 80 
last prior star auc 0.46054192775663017 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4400734271062865; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49891197645162644; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 80 
last prior star auc 0.46368305523122766 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43940222515443556; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48190686340467587; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 80 
last prior star auc 0.45578038469866927 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4545587175714329 at iter 0
0.4995863674265825 at iter 80
0.4688176838504976 at iter 10
last anomaly aucs:
0.43862824502693254
0.48401717080962364
0.45555137184660477




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.01396059989929 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4385633734245984,first_prior_anomaly_auc= 0.4817088304954042, first_prior_star_anomaly_auc= 0.4543780223378711


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4385633915097956 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4767889937348055 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4389179819427746 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4385633915097956 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.476480092538337 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.439171536407431 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4385633915097957 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.48129517983678954 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4410984237424398 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4385633854813966 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.48035509922985997 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.444578624550824 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4385633854813966 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.48213188545655955 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4467250541229668 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4385633915097956 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.48039391609143683 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44795192978699494 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4385633794529975 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4780946063190161 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4481508006437366 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4385633915097956 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.47885443176551556 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44928984856179277 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4385633915097956 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.47911142844603793 iter_best_prior_anomaly= 830
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4503607695420201 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4385633915097957 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.478771306170814 iter_best_prior_anomaly= 830
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44952957387899506 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43856339753819473 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4777307080378814 iter_best_prior_anomaly= 830
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4504198297676559 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43856339753819473 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4768379925624024 iter_best_prior_anomaly= 1170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4497481997994714 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43856340356659385 at iter 8
max_prior_anomaly= 0.48367008573348014 at iter 117
max_prior_star_anomaly= 0.4543780223378711 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4385633975381947
accuracies_anomaly['prior'][-1]= 0.475715076640243
accuracies_anomaly['prior_star'][-1]= 0.4507508551886913



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.88431406021118 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4943167930942519
accuracies_anomaly["prior"][-1]= 0.4923003177207443
accuracies_anomaly["prior_star"][-1]= 0.4943167750090547


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 1482.5347366333008 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.011856317520141602 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4988442232745396
 first_prior_anomaly_auc= 0.49510532577709676
 first_prior_star_anomaly_auc= 0.49884411476335644


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.47978962334080366; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.488765692525605; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.47978953894321685 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46348730708520147; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48097062891634945; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4634886092193995 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45110909883150335; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47714330083302836; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.45111319814286727 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44421868089947575; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4752587690298473; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4442222436833229 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4988442232745396 at iter 0
0.49510532577709676 at iter 0
0.49884411476335644 at iter 0
last anomaly aucs:
0.4396971947206657
0.47486443939023465
0.4397006911921232




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.79512691497803 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43940086273624696,first_prior_anomaly_auc= 0.47487153481593364, first_prior_star_anomaly_auc= 0.43940517906997717


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43940088082144413 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4814907049320503 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.439404883678423 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43940088082144413 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.48992314514600543 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43940462445726325 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43940087479304507 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.5153326181240683 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4394059748186537 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43940087479304507 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.5203717147033617 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4394031535278915 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4394008868498432 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.48449524094064245 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43942617598391914 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.439400868764646 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.47969148703243136 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43983747556689856 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.439400868764646 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4784137859358896 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44231074685112604 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4394008868498432 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.47482073349701637 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44585417953729867 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4394008868498432 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.4737616703777491 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4486819026013265 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.439400868764646 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.4729798714166593 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4505864366326038 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4394008868498432 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.47231323899129934 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45206885010458064 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43940089287824224 iter_best_vanilla_star_anomaly= 1190 
last prior auc 0.47188575315683146 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4531761464447637 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43940089890664125 at iter 119
max_prior_anomaly= 0.5207873426768697 at iter 38
max_prior_star_anomaly= 0.45387234816753547 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4394008808214441
accuracies_anomaly['prior'][-1]= 0.47119832878309775
accuracies_anomaly['prior_star'][-1]= 0.45387234816753547



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.27748584747314 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.439400868764646
 first_prior_anomaly_auc= 0.4711793574112415
 first_prior_star_anomaly_auc= 0.4539406559573363


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43759765403644724; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47449585101462777; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.45171187242557215 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4369130630102738; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4765283800148443; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.44788683513389554 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4364432457575744; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47893057044570125; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.4440800458061875 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4367343993471967; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4786287104193403; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 370 
last prior star auc 0.44118210997825436 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.439400868764646 at iter 0
0.47904444690403125 at iter 370
0.45441187782701775 at iter 10
last anomaly aucs:
0.43689258453865143
0.475424598231316
0.43971191607118143




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.93887376785278 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4369006746501961,first_prior_anomaly_auc= 0.47520936027111393, first_prior_star_anomaly_auc= 0.4395514159744859


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4369006867069943 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4882467739625246 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43679309786888865 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43690067465019616 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.47596307292096196 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43751172523618065 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43690069273539334 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.47151058176944605 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44224389793389884 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43690066862179705 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4752682818435713 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44412184672530125 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43690068067859517 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4700748100210319 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44365033549246474 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4369006806785952 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4737284177285089 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4450995505707929 iter_best_prior_star_anomaly= 510
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4369006867069942 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.46824765652014766 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4434245176919044 iter_best_prior_star_anomaly= 510
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4369006867069942 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.47779032890463025 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44573039239090645 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43690067465019616 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.47402725149853947 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4444816095246776 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43690066862179705 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4761410855169401 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44524078390407806 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43690066259339794 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.47086572392150733 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44596779074606985 iter_best_prior_star_anomaly= 1060
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.436900668621797 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4697795691768438 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4453250187242075 iter_best_prior_star_anomaly= 1060
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43690070479219145 at iter 19
max_prior_anomaly= 0.49900297513550634 at iter 41
max_prior_star_anomaly= 0.44654965182378364 at iter 106
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43690068067859517
accuracies_anomaly['prior'][-1]= 0.47666913107620423
accuracies_anomaly['prior_star'][-1]= 0.44644136971978554



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.2182047367096 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43690068067859517
 first_prior_anomaly_auc= 0.46610400603997354
 first_prior_star_anomaly_auc= 0.44368436580518433


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4399670258627965; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.48391038977699263; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 40 
last prior star auc 0.46415103985061146 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4405740133078115; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.49050100939513935; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 40 
last prior star auc 0.46616476627414555 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4390771557916759; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4887481739979233; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 40 
last prior star auc 0.46625067096081585 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43780644763804916; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4871035724775129; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 40 
last prior star auc 0.4598053056181304 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44803914263626227 at iter 20
0.5023510635783902 at iter 470
0.4767467828845552 at iter 40
last anomaly aucs:
0.43831486472995906
0.4923481530673218
0.4658281886975717




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.06779670715332 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43972059696583443,first_prior_anomaly_auc= 0.48917100590831336, first_prior_star_anomaly_auc= 0.4616478315366293


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4397206090226325 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4923824184876049 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44393199435356034 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43972060299423343 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4963006909992144 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4480490352391273 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43972060299423343 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.49106411009496415 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4613251373631011 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43972060299423343 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4882926259658098 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4619369535557668 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43972060299423343 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4880666031996813 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46233016191315346 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43972060299423343 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.487130844954881 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4624873765323588 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43972059696583443 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4865432146992624 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4625989802842414 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43972059696583443 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4858990079184228 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4626487748605149 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43972060299423343 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4854502116932615 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46271934329996495 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43972060299423343 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4856149015273069 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4628939679356688 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43972060299423343 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.48548024517740135 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46305452228795585 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43972060902263255 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4857366450464163 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46325892118663975 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43972060902263255 at iter 15
max_prior_anomaly= 0.4963961928971955 at iter 19
max_prior_star_anomaly= 0.4632928128461808 at iter 121
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43972060299423343
accuracies_anomaly['prior'][-1]= 0.4848272429623264
accuracies_anomaly['prior_star'][-1]= 0.4630439364191985



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.37041759490967 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43972059093743543
 first_prior_anomaly_auc= 0.485467989442103
 first_prior_star_anomaly_auc= 0.46334525388964365


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43883516982482434; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4985257248667603; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 70 
last prior star auc 0.47056159721709806 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4368796777362542; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4893926641135191; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 70 
last prior star auc 0.46425827904157135 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4375279958852559; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4937507324504864; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 250 
last prior star auc 0.4656058733968678 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.438049771909493; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4931931597926038; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 250 
last prior star auc 0.4650905176176346 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43972059093743543 at iter 0
0.4989928956522704 at iter 250
0.47056159721709806 at iter 100
last anomaly aucs:
0.4372528838655445
0.48675803669992895
0.4616990005878895




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.125930070877075 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43612363209596827,first_prior_anomaly_auc= 0.4820676890349208, first_prior_star_anomaly_auc= 0.45730488845291506


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43612361401077104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47759672084027205 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43750529896277773 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43612362003917016 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4839783660048449 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4389188862026343 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43612362003917016 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47988933306133197 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4551709979508266 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43612362003917016 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4802658065829153 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45624780867694 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43612362606756927 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47943078288648433 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4560420111896732 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43612362003917016 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47887915423007943 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4563845207109267 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43612363209596827 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47943855349287856 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45643022803263433 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43612362003917016 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4805073524766351 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.457384595945347 iter_best_prior_star_anomaly= 730
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43612361401077104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.481088658941635 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45767664173803085 iter_best_prior_star_anomaly= 860
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43612361401077104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4808416151479683 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45742313550056685 iter_best_prior_star_anomaly= 950
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43612362003917016 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4794948105129493 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4569711261387043 iter_best_prior_star_anomaly= 1060
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43612362003917016 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47921975274882944 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45723278880010265 iter_best_prior_star_anomaly= 1060
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43612363209596827 at iter 0
max_prior_anomaly= 0.48487613327874013 at iter 24
max_prior_star_anomaly= 0.4578066321070605 at iter 106
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43612363209596827
accuracies_anomaly['prior'][-1]= 0.4788503565677479
accuracies_anomaly['prior_star'][-1]= 0.4567949160340464



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.52949929237366 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43612361401077104
 first_prior_anomaly_auc= 0.4779584247841472
 first_prior_star_anomaly_auc= 0.4562500693265892


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4387547630381009; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4911096365646999; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 60 
last prior star auc 0.4668159961398955 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4409213033495232; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4937129524735486; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 190 
last prior star auc 0.46692780485734636 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43921608024811926; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48667660508536453; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 190 
last prior star auc 0.4646160584976554 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43675349731543334; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4747023477961861; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 190 
last prior star auc 0.4542450418829054 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44394987458518587 at iter 10
0.5008283321734693 at iter 190
0.47462904246356075 at iter 190
last anomaly aucs:
0.4393182917542593
0.4855861822341633
0.46341645531099546




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.049092292785645 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43764215567834197,first_prior_anomaly_auc= 0.47196801066206767, first_prior_star_anomaly_auc= 0.453796607361688


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.437642155678342 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.45884096673336483 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4387514413902163 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43764214964994297 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4724785376936503 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44084751574497266 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4376421496499429 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4707926295828492 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4523723558838863 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4376421496499429 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4704767535286631 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4521211163244706 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43764215567834197 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.47109872154535354 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45215664770855735 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4376421496499429 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.47084955575521614 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4520278027353499 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4376421375931448 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4707225675289206 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45149951604012306 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4376421496499429 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4701419844718086 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4518946534852104 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43764214964994286 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.47014819372284505 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45190347906144096 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43764214362154386 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4699869521330645 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4514735276117557 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4376421375931448 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.46959588988574497 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45174382294061444 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4376421496499429 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.46916568524329894 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45145368212203507 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4376421617067411 at iter 34
max_prior_anomaly= 0.47625651730222873 at iter 24
max_prior_star_anomaly= 0.453796607361688 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4376421496499429
accuracies_anomaly['prior'][-1]= 0.4690972026299253
accuracies_anomaly['prior_star'][-1]= 0.4512171277427407



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.23980498313904 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43764214964994297
 first_prior_anomaly_auc= 0.468960436340347
 first_prior_star_anomaly_auc= 0.45150904693904415


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44485204861879724; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.47071756998609615; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.46085216725769096 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4488054124413618; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4737766690346218; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.4667078768026722 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44258770356095123; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4729130646982256; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 230 
last prior star auc 0.4617696534249264 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44185068354811313; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.47838468082520585; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 230 
last prior star auc 0.4650998314941894 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44981882249451294 at iter 250
0.4840604426581092 at iter 230
0.4727616915977138 at iter 230
last anomaly aucs:
0.4431506957495928
0.4683904692939877
0.4582428169213786




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.96091604232788 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4446875155231276,first_prior_anomaly_auc= 0.47889463515887726, first_prior_star_anomaly_auc= 0.46687294642585864


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4446875275799257 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.47582420272011017 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44988835404932387 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4446875215515267 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4812746109391812 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45616798061652686 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4446875155231276 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.47658911613542004 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46544760983622524 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4446875155231276 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4755793834056982 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46504474398353723 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4446875155231276 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.47482586969301943 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4646900631245723 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4446875215515266 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4761901506569267 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46459111901072525 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4446875215515266 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.47646324316295147 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4645360134148758 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4446875094947285 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4760097568433181 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46433969859933766 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4446875155231276 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4760108781255441 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4642986994572994 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4446875215515267 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.47589403569487426 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4642245983759975 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4446875275799257 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.47574321720707646 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4641676360332362 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4446875275799257 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.47553843851925154 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46410988397019753 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.44468752757992575 at iter 29
max_prior_anomaly= 0.4821898364567675 at iter 21
max_prior_star_anomaly= 0.46687294642585864 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44468752155152663
accuracies_anomaly['prior'][-1]= 0.4753582315860139
accuracies_anomaly['prior_star'][-1]= 0.46402256260974695



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 128.41896224021912 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4446875215515267
 first_prior_anomaly_auc= 0.4753983626385869
 first_prior_star_anomaly_auc= 0.46400432670257663


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4373959679173425; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.468424565919097; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4551316385333339 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4361101767092561; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4816362666558638; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 200 
last prior star auc 0.46450466573974003 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4363235880645415; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47597033714183473; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 200 
last prior star auc 0.4583022448793572 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43696511220779743; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4769477817661666; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 340 
last prior star auc 0.4588083229524301 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4446875215515267 at iter 0
0.4853496097696717 at iter 340
0.46450466573974003 at iter 200
last anomaly aucs:
0.4372344731348013
0.47639236124675005
0.45869498905001593




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.81529140472412 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4372587675830315,first_prior_anomaly_auc= 0.47984191970268897, first_prior_star_anomaly_auc= 0.4599198693139537


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43725878566822873 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4661377530179371 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4369153899723128 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4372587796398297 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.47628781675017196 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43700148153935414 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4372587856682288 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.48284570818979716 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4577959136135237 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4372588037534259 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.48661418101305076 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45510632528566175 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43725880375342596 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.48447435856628274 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4553660588593594 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43725884595221937 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.48594630070908446 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4543597924590997 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43725880375342596 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.48316513497103236 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4542793736155782 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4372587796398297 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4850688491400368 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4550084602552472 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4372587916966278 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.48838735622871066 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4553925657300464 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43725879772502685 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.48735891134829246 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45630459619612845 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4372587977250269 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.487488051713054 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45761096835862125 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.437258809781825 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.48452599783267 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4548624222879077 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43725885800901754 at iter 47
max_prior_anomaly= 0.49094302969975195 at iter 23
max_prior_star_anomaly= 0.4600303638404085 at iter 25
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4372588037534259
accuracies_anomaly['prior'][-1]= 0.4867279489601976
accuracies_anomaly['prior_star'][-1]= 0.4566100310631347



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 128.75489139556885 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4372587736114306
 first_prior_anomaly_auc= 0.4883850051530755
 first_prior_star_anomaly_auc= 0.45683435382072696


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4447830716767004; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4715631192672939; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.46121749426940384 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44918057780034815; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4797852768650782; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4700708493628464 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4453432184609835; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48492864666299174; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4704977986697976 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44497121198310696; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48523358117287574; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.47028468873446544 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4510499059810882 at iter 10
0.4883850051530755 at iter 0
0.4745062560314133 at iter 390
last anomaly aucs:
0.44418725485515204
0.4730913244585654
0.46170707864263605




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.94446897506714 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4424355166265657,first_prior_anomaly_auc= 0.47270480159574135, first_prior_star_anomaly_auc= 0.4597263577039805


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4424355105981667 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4779433537864856 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4457694745020422 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4424355045697676 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.474441167406713 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45476392427559137 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4424355045697676 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47014231603375706 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4587359399648616 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44243550456976766 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4694937507203937 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45848077591765496 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4424355045697676 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4692427221549453 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45820104614426005 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4424355045697676 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46907083441241676 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45798638088196925 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44243552265496483 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.46892599609649105 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45786375118819744 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44243548648457043 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4699602101548141 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4578972811437947 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4424354925129695 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4702497179914918 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45785214651999817 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.44243549854136854 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.47006086030559646 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45774673393395476 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4424354925129695 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4701742424352031 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45768765562312186 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.44243550456976766 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.47004357688547826 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4576222535216702 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.44243552265496483 at iter 70
max_prior_anomaly= 0.47864031508753957 at iter 12
max_prior_star_anomaly= 0.4597263577039805 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4424355045697676
accuracies_anomaly['prior'][-1]= 0.4698615132053287
accuracies_anomaly['prior_star'][-1]= 0.4575680762992767



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 128.37774682044983 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4988442232745396
accuracies_anomaly["prior"][-1]= 0.49510532577709676
accuracies_anomaly["prior_star"][-1]= 0.4988441147633564


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 1497.106070280075 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012188196182250977 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5081936734122041
 first_prior_anomaly_auc= 0.506214109926169
 first_prior_star_anomaly_auc= 0.5081935407874246


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.49334089776847956; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.505851103848096; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 70 
last prior star auc 0.4933417236591514 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4791584017315491; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4974662397595585; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 70 
last prior star auc 0.47916065635279925 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.463922129481331; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.491781417242861; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 70 
last prior star auc 0.4639284472435507 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.45061692827507244; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4877841968171018; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 70 
last prior star auc 0.4506266942815571 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5081936734122041 at iter 0
0.5071677604593929 at iter 70
0.5081935407874246 at iter 0
last anomaly aucs:
0.4432711311061051
0.48600287120590646
0.443279426183218




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.583024740219116 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4428089156646262,first_prior_anomaly_auc= 0.48589852564649755, first_prior_star_anomaly_auc= 0.44281813911519496


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4428089216930252 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4807000201107393 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4428151128588646 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4428089156646262 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.48856744259396706 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.442806938349733 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44280891566462616 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4986611829937415 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44279214465842853 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4428089096362271 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5028983698726658 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44275563667369333 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4428089096362271 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.47325992672360373 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4428387502115968 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4428089096362271 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.4818322378526553 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44323934938623666 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4428089096362271 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.48447508800256955 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44647284399130177 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44280890963622704 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.48257816783931085 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4525829218348132 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4428089156646261 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.48056254247007135 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4562093414625089 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4428089156646262 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.47957011124566495 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45827072238064853 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.44280890360782804 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.47857645625624845 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4595086541285611 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4428089216930252 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.4780653082995623 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46040621040848917 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.44280892772142433 at iter 48
max_prior_anomaly= 0.5035040853254782 at iter 38
max_prior_star_anomaly= 0.46089370895564497 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4428089096362271
accuracies_anomaly['prior'][-1]= 0.477736633954162
accuracies_anomaly['prior_star'][-1]= 0.46088637842238245



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 128.52015686035156 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4428089096362271
 first_prior_anomaly_auc= 0.4777053586198149
 first_prior_star_anomaly_auc= 0.4609607568100413


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4381790087286396; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48361142338218266; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 90 
last prior star auc 0.4593529827795164 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43659654794578684; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48556012749340616; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 200 
last prior star auc 0.4528377422632732 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43651013084519596; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4849676323197424; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 250 
last prior star auc 0.4469041096319831 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4369021636647651; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48463735442019096; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 250 
last prior star auc 0.4428477445830012 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4428089096362271 at iter 0
0.48593637193582506 at iter 250
0.46190121720611194 at iter 40
last anomaly aucs:
0.4373749046910108
0.48371543135124395
0.44096293547346327




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.628304958343506 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43742326450830693,first_prior_anomaly_auc= 0.4834496452648855, first_prior_star_anomaly_auc= 0.44068871565681333


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43742326450830693 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.46723894258986776 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44240099198512284 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4374232645083069 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.47106533024293484 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4434304014093915 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43742325245150876 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4704624903364763 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4435657751387858 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4374232524515088 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4676608280416047 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44269029485623235 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4374232584799079 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.46079903897673474 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44412000806358654 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43742325245150876 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4688832306335269 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44421736670847967 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43742325245150876 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4683205700068338 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4438972587181502 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43742326450830693 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4682042399900845 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4453786895610795 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43742326450830693 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4701334301735359 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4451001232687041 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4374232584799078 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.46848477154055496 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4450497077673269 iter_best_prior_star_anomaly= 980
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43742325245150876 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4683164586386717 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4438449081006733 iter_best_prior_star_anomaly= 980
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43742325245150876 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4737031165376348 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44730123644876174 iter_best_prior_star_anomaly= 980
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.437423270536706 at iter 2
max_prior_anomaly= 0.492349575769501 at iter 2
max_prior_star_anomaly= 0.45055771131106104 at iter 98
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4374232645083069
accuracies_anomaly['prior'][-1]= 0.4735454136181052
accuracies_anomaly['prior_star'][-1]= 0.44837047550565



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 127.93484330177307 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4374232645083069
 first_prior_anomaly_auc= 0.4723804013852779
 first_prior_star_anomaly_auc= 0.4481669386680325


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4405782331871567; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4735262674226761; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 50 
last prior star auc 0.4627768361418439 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4398993148845031; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.47082297654374033; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 120 
last prior star auc 0.45958721019677173 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44073514035800976; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4778953375879363; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 120 
last prior star auc 0.4620868195565124 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44087822440980773; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.47263850729122814; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 350 
last prior star auc 0.4566082587138097 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.443767413030698 at iter 120
0.4898618423559176 at iter 350
0.4717244452546613 at iter 120
last anomaly aucs:
0.4419970169070069
0.4826152786639524
0.46378232487862425




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.54374098777771 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4409152026096699,first_prior_anomaly_auc= 0.48661997430455184, first_prior_star_anomaly_auc= 0.46642138919392584


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4409152026096699 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4828477156466857 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4539551602854857 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4409152026096699 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4859589422619228 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4643630285037176 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4409152026096698 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4852124697193515 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46357243410839255 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44091520863806893 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.48449050261897764 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4629380596464271 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4409152026096699 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.483709830968513 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46248316870981165 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4409152026096698 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4828780505507786 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46205700309473896 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4409152026096699 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.48209836755776053 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46172802130098645 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4409152026096699 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4814281120645627 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4615036623729998 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4409152026096698 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4808124738668901 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46131366531968115 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4409152026096698 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4803191820282331 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46112624239276323 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4409152026096698 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4799024689428937 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608664123646805 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4409152026096699 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.48006029243040454 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610422788505916 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.44091520863806893 at iter 11
max_prior_anomaly= 0.48661997430455184 at iter 0
max_prior_star_anomaly= 0.46642138919392584 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4409152026096698
accuracies_anomaly['prior'][-1]= 0.47924941247222713
accuracies_anomaly['prior_star'][-1]= 0.4603698109349371



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.56301379203796 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4409152086380689
 first_prior_anomaly_auc= 0.47938961494927224
 first_prior_star_anomaly_auc= 0.4603297039959605


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5501665827513517; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4829837705851742; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5450882774645422 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5463147130554387; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.47329581378323515; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.5394628708490252 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.53933124075545; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4796658361944115; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.5327914887686103 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5436018792207835; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4876451035654846; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.536870225206521 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5501665827513517 at iter 100
0.5017700464765454 at iter 10
0.5450882774645422 at iter 100
last anomaly aucs:
0.5390992679594449
0.4827940568666118
0.5307362628459156




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.31190085411072 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5387164465336464,first_prior_anomaly_auc= 0.4821556433772731, first_prior_star_anomaly_auc= 0.5302157768990783


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5387164465336464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48124709129745136 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5340918506172356 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5387164465336464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4794652834143309 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5306713611015862 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5387164465336464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4780966499462991 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5306317123209384 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5387164465336464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47702124383716765 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5306705291825153 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5387164465336464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4761632881106949 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5307348220585391 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5387164465336464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47534169568737983 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5308102976148277 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5387164465336464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4746115902482687 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5308978540828417 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5387164465336464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4740612938680572 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5309969911054588 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5387164465336464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47347998740305725 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5310931862693324 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5387164465336464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47300277330470564 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5311856860245794 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5387164465336464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47254354794916276 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5312837017649705 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5387164465336464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47212562918401035 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5313615042832981 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5387164465336464 at iter 0
max_prior_anomaly= 0.4821556433772731 at iter 0
max_prior_star_anomaly= 0.5353168152787604 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5387164465336464
accuracies_anomaly['prior'][-1]= 0.4717644255972576
accuracies_anomaly['prior_star'][-1]= 0.5314180024393313



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.24158954620361 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5387164465336464
 first_prior_anomaly_auc= 0.4718083424844431
 first_prior_star_anomaly_auc= 0.5314407053902086


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5420791417874637; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4772767937019145; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.5330306715298968 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5462140146774638; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4774574708502791; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.536025881605136 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5502816407758984; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4776974795022375; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 210 
last prior star auc 0.5398158275858577 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5522131940917832; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.468620494917095; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 210 
last prior star auc 0.5386871063153991 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.554391375241799 at iter 470
0.4852448844211218 at iter 210
0.5431794270995347 at iter 480
last anomaly aucs:
0.5543641570200225
0.47428427229265807
0.5422732622657425




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.29968333244324 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5537903197414636,first_prior_anomaly_auc= 0.4801258331850347, first_prior_star_anomaly_auc= 0.542834849837402


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5537903197414636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4803178316668427 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5522684624544072 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5537903197414636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4795935376044299 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5464699081609573 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5537903197414636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4878632050152422 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5469348966660059 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5537903197414636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4760120416065636 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5459520385393141 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5537903197414636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47670097910846243 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5457533304493473 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5537903197414636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47763344584737344 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5457782096522867 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5537903197414636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4767203965818495 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5458017987778265 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5537903197414636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48084279068578584 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5464522328949 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5537903197414636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47698799721632645 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5455616936714831 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5537903197414636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4806086898649108 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5491609734465901 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5537903197414636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47690630035220316 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5474489683962385 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5537903197414636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4775111899143437 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5454342352300606 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5537903197414636 at iter 0
max_prior_anomaly= 0.4878632050152422 at iter 30
max_prior_star_anomaly= 0.5531254958358232 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5537903197414636
accuracies_anomaly['prior'][-1]= 0.4783910709282143
accuracies_anomaly['prior_star'][-1]= 0.5461796347175985



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.41420483589172 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5537903197414636
 first_prior_anomaly_auc= 0.4796050880170377
 first_prior_star_anomaly_auc= 0.544642284444946


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5391385490077496; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4805714765574851; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 90 
last prior star auc 0.5270188987899315 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5367632994923124; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4746461751737023; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 150 
last prior star auc 0.5222831391947698 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5352637352249967; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48005702503811154; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 150 
last prior star auc 0.5248366062717534 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5363717308594713; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4827853578867616; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 320 
last prior star auc 0.525263875083855 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5537903197414636 at iter 0
0.4894280025888357 at iter 450
0.544642284444946 at iter 0
last anomaly aucs:
0.5348119248003033
0.4795228365402005
0.5223858088592388




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.34062886238098 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5380284554904007,first_prior_anomaly_auc= 0.487603700520709, first_prior_star_anomaly_auc= 0.529097352134222


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5380284675471987 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.48432839896813096 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5364299229956417 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5380284675471987 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.489259930822915 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5329297621579547 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5380284554904006 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.48677037080441504 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5295518090261049 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5380284675471988 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.48624574937581955 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5293176418928401 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5380284675471987 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4857502330579078 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5290623934480465 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5380284675471987 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4851049773356309 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5288060237210269 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5380284554904007 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4845754065914033 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5285648937868426 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5380284735755978 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4841287383911119 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5283883882906305 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5380284675471988 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4836896599452428 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5282074157507117 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5380284675471988 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4832608780049761 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5280370471647474 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5380284554904007 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4823321066746917 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5277822870202781 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5380284675471987 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4831815382448871 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5278570271118808 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5380284735755978 at iter 5
max_prior_anomaly= 0.48990457767688655 at iter 21
max_prior_star_anomaly= 0.5368500602116498 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5380284675471988
accuracies_anomaly['prior'][-1]= 0.4826831644658187
accuracies_anomaly['prior_star'][-1]= 0.5275942612534537



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.5345106124878 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5380284675471988
 first_prior_anomaly_auc= 0.48247967585539364
 first_prior_star_anomaly_auc= 0.5276916801823374


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5425803911128859; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4872389522353063; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 40 
last prior star auc 0.5302010314349663 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5392278175410979; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4898725729062526; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 200 
last prior star auc 0.5286281919770207 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5324032297268557; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.47619305634527587; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 200 
last prior star auc 0.5131922410645864 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5321034494981719; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4850561412748087; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 200 
last prior star auc 0.5138617008091075 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5429169084054692 at iter 120
0.4898725729062526 at iter 200
0.5302010314349663 at iter 100
last anomaly aucs:
0.5234032519113643
0.4775610809450022
0.4952970831229422




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.30034422874451 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5233288132397147,first_prior_anomaly_auc= 0.4829831255464744, first_prior_star_anomaly_auc= 0.4977250630449974


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5233288252965128 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.47609958601777946 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5194374093027361 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5233288132397147 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4773685218220812 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4963910325875962 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.52332884338171 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.47479787983616256 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4921810518736505 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5233288072113156 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.47292379524856054 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48874662469936375 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5233288132397147 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.47196549681965777 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48728030705288927 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5233288313249119 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.47154850039956225 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4870513243428201 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5233288132397147 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.47092409690964976 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48445227654050915 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5233288252965129 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4712973753797288 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49105090790101275 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5233288494101092 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.47040387621237134 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4855661498640717 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5233288011829166 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4696011647349264 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.484337357169141 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5233288252965129 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4728981504389398 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4935770120746422 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5233288252965128 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4690104298537896 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48434840119622724 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5233288614669073 at iter 78
max_prior_anomaly= 0.4829831255464744 at iter 0
max_prior_star_anomaly= 0.5212146597161637 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5233288252965129
accuracies_anomaly['prior'][-1]= 0.46795923982370063
accuracies_anomaly['prior_star'][-1]= 0.4819897116930204



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.17851519584656 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5233288252965128
 first_prior_anomaly_auc= 0.46791788500611764
 first_prior_star_anomaly_auc= 0.48410994787122763


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4957578216066504; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4840364737434285; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 90 
last prior star auc 0.48979892395488056 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.48857836002467303; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4871307002733035; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 180 
last prior star auc 0.48792595462110544 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4794952867564753; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48740033850666425; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 230 
last prior star auc 0.4838541026149266 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.48072693691256274; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48771133155760804; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 230 
last prior star auc 0.4834611353935026 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5233288252965128 at iter 0
0.5016816882314559 at iter 470
0.5002058999700509 at iter 90
last anomaly aucs:
0.48388744569015285
0.4999114488461403
0.4929752874220106




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.3314733505249 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4759856251618625,first_prior_anomaly_auc= 0.48791403647615483, first_prior_star_anomaly_auc= 0.4817761014005658


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.47598563119026155 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.48716395895094283 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47772363069737966 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4759856251618625 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4864346010333158 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48103197390523067 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4759856191334635 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.48563550659530974 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4807645902931201 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4759856251618625 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4849137685741004 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48056090877392493 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4759856432470597 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.48451051087547303 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4805125790986241 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4759856131050644 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.48487220276255005 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4807126254931833 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4759856372186606 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.4842334335976666 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.480447882319863 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.47598563119026155 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.48411604861108104 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4804036760695224 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4759856251618625 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.48416932760201375 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48034330768128963 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4759856372186606 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.48433319757378634 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4804010115171359 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.47598561913346343 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.4847097072657641 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48055247504363363 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.47598561310506443 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.4846208064647587 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4804386166705007 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4759856553038578 at iter 57
max_prior_anomaly= 0.48911412193473996 at iter 13
max_prior_star_anomaly= 0.4817761014005658 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4759856372186606
accuracies_anomaly['prior'][-1]= 0.4823381471305544
accuracies_anomaly['prior_star'][-1]= 0.47964453786051636



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.47406148910522 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.47598561310506443
 first_prior_anomaly_auc= 0.4817071726856615
 first_prior_star_anomaly_auc= 0.4794608887114128


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4543201677920482; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4815743851394658; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.47080504205652324 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.45653344628141823; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4894003503223265; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 200 
last prior star auc 0.47684196527738587 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44788261525455036; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4837295980890458; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 200 
last prior star auc 0.4683841394749699 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.45284299902725744; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48528109098590366; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 200 
last prior star auc 0.4717549670391253 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.47598561310506443 at iter 0
0.49350759505941355 at iter 460
0.48123910969708983 at iter 10
last anomaly aucs:
0.4461036346905912
0.4767398502256309
0.46538526413309933




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.333473205566406 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4504840261892946,first_prior_anomaly_auc= 0.4870680832922196, first_prior_star_anomaly_auc= 0.47162285467362486


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4504840925016843 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48411285355957673 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4549948300449622 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.45048409250168436 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4841577651326079 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4691365921894133 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45048408647328525 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.48163537445280225 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46833608710602603 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4504840744164872 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.480456002573403 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4679040618870626 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.450484062359689 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.47971572119667094 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4676517613294115 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4504840141324965 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.47845975247875716 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46719476648152247 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4504840744164872 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.47887767124390945 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46494801229214683 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.45048404427449185 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4772968562140014 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46689337667028846 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.45048408044488625 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.47789980463164317 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.467299726937636 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.45048403221769373 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4776892447091153 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4672429755888419 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4504840925016843 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.47662775817342407 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4665741427978234 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.450484062359689 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4776329756322464 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46722165314135056 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4504841166152806 at iter 19
max_prior_anomaly= 0.4870680832922196 at iter 0
max_prior_star_anomaly= 0.47162285467362486 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.45048407441648713
accuracies_anomaly['prior'][-1]= 0.47674840452390355
accuracies_anomaly['prior_star'][-1]= 0.4671269047932525



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.56661415100098 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4504840864732853
 first_prior_anomaly_auc= 0.4757075531982104
 first_prior_star_anomaly_auc= 0.4665967613511138


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46773342805153945; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4819464880717273; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 40 
last prior star auc 0.4756731430963497 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4605300096116795; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4867282744937471; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 150 
last prior star auc 0.4737228233741769 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45905324474962605; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4821542025898967; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 230 
last prior star auc 0.4707364750455627 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.45654342931026914; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4804031214568084; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 230 
last prior star auc 0.46745563942264334 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4713107101984597 at iter 110
0.4960045278099694 at iter 430
0.48218444103960467 at iter 230
last anomaly aucs:
0.45953749398968613
0.48182182680747077
0.46976188185398826




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.349716901779175 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.45848559863690663,first_prior_anomaly_auc= 0.48282628468801103, first_prior_star_anomaly_auc= 0.47241341289855554


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45848561672210375 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4848385160685772 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46505317771382854 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.45848562275050286 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4822390402499326 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47214526367976367 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4584856046653057 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4817093067389303 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4723026109237485 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.45848559260850763 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4811369825885367 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4722533287613955 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.45848560466530563 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.48133414137994396 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47230597477042646 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4584855865801085 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4814552519171515 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47234090934300577 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.45848560466530563 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4817076549575866 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4723937844312012 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4584855865801085 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4817759989177818 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47236520379123603 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.45848562275050286 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4815929345233875 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4722632695914529 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4584855926085075 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.48182963358425934 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47231545141375597 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.45848561672210386 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4813862327762611 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4721045237588853 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4584855865801085 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4813287519911802 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47208876552373047 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4584856227505029 at iter 32
max_prior_anomaly= 0.4861614181013051 at iter 1
max_prior_star_anomaly= 0.47241341289855554 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.45848561069370475
accuracies_anomaly['prior'][-1]= 0.4821404819536257
accuracies_anomaly['prior_star'][-1]= 0.4722683274182682



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.61467361450195 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.45848556246651223
 first_prior_anomaly_auc= 0.4818143636494288
 first_prior_star_anomaly_auc= 0.4721837550077911


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44901914330179754; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4711721956731527; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 70 
last prior star auc 0.46127280483082145 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.45320912781604605; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4802339223802628; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 70 
last prior star auc 0.4669727224587766 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4498302945379329; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47255709979025995; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 270 
last prior star auc 0.4626617359185038 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4518615877163411; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48602378975066063; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 270 
last prior star auc 0.4700723504342135 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.45848556246651223 at iter 0
0.49435677946524725 at iter 270
0.4765679142559099 at iter 270
last anomaly aucs:
0.4513115324720921
0.4771890322683322
0.4630064096350215




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.31608200073242 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4534386410252329,first_prior_anomaly_auc= 0.4857282655717165, first_prior_star_anomaly_auc= 0.47149524552222577


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4534386289684348 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.482931010036561 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45760430697765486 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.45343867719562736 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4851630609606181 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46955698259818207 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45343865308203113 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.48492000193873314 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4697230830776087 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4534386349968339 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.48468286883312856 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4695922366759118 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.45343865911043013 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.48471994951577485 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46822075780352146 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.45343865911043013 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4850176137763869 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4699456515710731 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4534386289684348 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4850916666304963 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4700181370414257 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.45343865911043013 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4851011191602295 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4701165024289625 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.45343865911043013 iter_best_vanilla_star_anomaly= 860 
last prior auc 0.4849180728510325 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4702170983241533 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4534386410252329 iter_best_vanilla_star_anomaly= 860 
last prior auc 0.484573320765327 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.469931641571647 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.453438647053632 iter_best_vanilla_star_anomaly= 860 
last prior auc 0.4848076446369674 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4703725104520383 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.453438641025233 iter_best_vanilla_star_anomaly= 860 
last prior auc 0.4848483483874515 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4704854947073067 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4534386952808246 at iter 86
max_prior_anomaly= 0.48616310002464413 at iter 12
max_prior_star_anomaly= 0.47149524552222577 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.45343867116722825
accuracies_anomaly['prior'][-1]= 0.48523980850910936
accuracies_anomaly['prior_star'][-1]= 0.47063042947761746



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.70121598243713 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.45343865911043013
 first_prior_anomaly_auc= 0.48498468063229705
 first_prior_star_anomaly_auc= 0.4705604940200693


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44947962859274493; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4822511633604515; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.46829586562746717 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4524134876507039; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4825235987709783; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 130 
last prior star auc 0.4681979945686536 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4486609056873846; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4861119189165858; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 230 
last prior star auc 0.4700684199180234 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4470519681758402; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.47321496692338; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 230 
last prior star auc 0.459366389939036 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.454935353859791 at iter 50
0.49330932101417924 at iter 230
0.47502134656108774 at iter 230
last anomaly aucs:
0.44969989423776685
0.48006721303253064
0.4649607985265628




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.305957317352295 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4492240063872094,first_prior_anomaly_auc= 0.4828099959537385, first_prior_star_anomaly_auc= 0.46707600099155105


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44922399433041127 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4823624837775781 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45937498040770297 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44922400035881027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48035156055960904 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4643292393269606 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4492240124156085 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.479874497171234 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4640715312953486 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4492240063872094 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.479858160209769 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4637815472151449 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4492240003588103 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4800113538867982 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4636396628147608 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44922400638720933 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4799630302398965 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46354911626081075 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44922400035881027 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.479871513113697 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4635779380367385 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44922398830201216 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.47968598913248445 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46371506603026064 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44922400035881027 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.47992998255622443 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46353986266824665 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.44922398830201216 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4795468355968766 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46367495306288486 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4492240124156084 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.47956944209336877 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46357680469771434 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.44922400035881027 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.47967662702873715 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4636223974798398 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4492240124156085 at iter 27
max_prior_anomaly= 0.48283299429616994 at iter 11
max_prior_star_anomaly= 0.46707600099155105 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44922400035881027
accuracies_anomaly['prior'][-1]= 0.4792123981019706
accuracies_anomaly['prior_star'][-1]= 0.4626971768766045



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.26899218559265 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4492240003588104
 first_prior_anomaly_auc= 0.4798412867207872
 first_prior_star_anomaly_auc= 0.4632020673550616


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5496743579393293; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.48669435269221073; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 100 
last prior star auc 0.5368568723025928 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5452487835896368; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.47760103717400226; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 190 
last prior star auc 0.5269171936693129 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.541538731981718; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4812480980400951; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 190 
last prior star auc 0.5260013833970174 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5374914276165301; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4784201458969028; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 190 
last prior star auc 0.5226480864173417 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5525656082726997 at iter 160
0.4914124068793197 at iter 190
0.5368568723025928 at iter 100
last anomaly aucs:
0.5320848096882643
0.4803654801330492
0.5187462473215824




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.30514168739319 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5302949538923926,first_prior_anomaly_auc= 0.47719679684632743, first_prior_star_anomaly_auc= 0.5149497424426783


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5302949418355944 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4720391457710298 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5206602218257947 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5302949538923927 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4738312983869451 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5146238291040497 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5302949599207917 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.47241454623757967 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5136601955419747 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5302949418355944 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4713799403333174 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5131959605868093 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5302949418355944 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4707213497923096 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5129672792966932 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5302949418355944 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4700089497612513 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5124904027886892 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5302949538923926 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.47035074190301607 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5129338277102837 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5302949418355944 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.46958683523034994 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5120892550297345 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5302949538923926 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.46933276232337395 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5121644713648633 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5302949418355944 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.46945698351449877 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5124262726794402 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5302949538923926 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.46911063390304114 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5120637790152875 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5302949418355944 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.46973462143341826 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5147582081475983 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5302949659491907 at iter 123
max_prior_anomaly= 0.47719679684632743 at iter 0
max_prior_star_anomaly= 0.5263549731157515 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5302949538923927
accuracies_anomaly['prior'][-1]= 0.46914137873827055
accuracies_anomaly['prior_star'][-1]= 0.5125779050011117



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.53727650642395 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5302949418355944
 first_prior_anomaly_auc= 0.4688073089757075
 first_prior_star_anomaly_auc= 0.511628667256003


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5216285816527362; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4758579918968671; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 40 
last prior star auc 0.5024285948187598 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.48470175580739794; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4779878313147842; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 170 
last prior star auc 0.4787981446034495 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4581339319774741; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.47346696003267874; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 290 
last prior star auc 0.4686136888545511 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.45919250076801804; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4843975748473971; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 290 
last prior star auc 0.47518439667058754 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5410378986158314 at iter 40
0.4893801009298685 at iter 290
0.5244997272752263 at iter 40
last anomaly aucs:
0.45410298265894844
0.4849615074662928
0.47489016256904326




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.34242010116577 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.45214107032537443,first_prior_anomaly_auc= 0.47925375894795275, first_prior_star_anomaly_auc= 0.46946082360470287


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45214107032537443 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48058555286930094 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4683392037883424 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4521410703253744 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.480246545847904 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4691057026726064 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4521410703253744 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48060654978324285 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46937341784666553 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.45214107032537443 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4819751531092794 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46967944349678015 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.45214107032537443 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4802095555912437 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46896512643481925 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4521410703253744 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48154639528260895 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4696642459027383 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.45214107032537443 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48077354849413 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4693041394846153 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.45214107032537443 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4809029420516523 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4694235379564885 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4521410703253744 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48083617150361296 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46933521588179317 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.45214107032537443 iter_best_vanilla_star_anomaly= 970 
last prior auc 0.47960565468654975 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46871614752505286 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.45214107032537443 iter_best_vanilla_star_anomaly= 970 
last prior auc 0.48056290417401526 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46931817359763756 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4521410703253744 iter_best_vanilla_star_anomaly= 970 
last prior auc 0.47987432837606026 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4691799484354857 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4521410823821726 at iter 97
max_prior_anomaly= 0.48397254859974753 at iter 4
max_prior_star_anomaly= 0.4698136959439484 at iter 56
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4521410703253744
accuracies_anomaly['prior'][-1]= 0.47927202499711846
accuracies_anomaly['prior_star'][-1]= 0.4687447402218161



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.6151647567749 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.45214107032537443
 first_prior_anomaly_auc= 0.47987740285958314
 first_prior_star_anomaly_auc= 0.46896794772558154


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43979958707877775; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47536733446860147; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 50 
last prior star auc 0.4586214184678318 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.442471759361742; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4846344306466447; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 50 
last prior star auc 0.46421976359994777 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4411315980224922; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47403320152841616; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 280 
last prior star auc 0.45533108208798667 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44201766417380306; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4856696092488181; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 280 
last prior star auc 0.4637436346134277 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.45214107032537443 at iter 0
0.49467362006328375 at iter 280
0.47291467428077577 at iter 50
last anomaly aucs:
0.4408005123174661
0.4875600729966786
0.4620814000257533




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.308650970458984 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44032750001326254,first_prior_anomaly_auc= 0.5001431563925867, first_prior_star_anomaly_auc= 0.46762067287543546


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4403275120700606 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4970602270825587 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46249062583945455 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4403275000132625 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4948452606414506 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46235928510903446 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4403275000132625 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.493256837771923 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4617758928179583 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44032749398486337 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4921653599508854 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46085988360849356 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4403275000132625 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.49182867989152745 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46110423270777845 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4403275000132625 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4915290021456278 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46090468667034157 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4403275000132625 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4913793772808448 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610195517861182 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4403274939848634 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4920608576531008 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46133600053821544 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4403274939848635 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4938579897266435 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4578130523520643 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4403275000132625 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4911954387685861 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612715026966234 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4403275000132625 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4911099319562541 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461320175990671 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4403275060416616 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.49153930467962914 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4616624986315534 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4403275180984597 at iter 4
max_prior_anomaly= 0.5001431563925867 at iter 0
max_prior_star_anomaly= 0.46762067287543546 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4403275000132625
accuracies_anomaly['prior'][-1]= 0.4910044168874266
accuracies_anomaly['prior_star'][-1]= 0.46137684897027714



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.02462816238403 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5081936734122041
accuracies_anomaly["prior"][-1]= 0.506214109926169
accuracies_anomaly["prior_star"][-1]= 0.5081935407874247


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 2784.086243867874 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012022018432617188 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5022057610757364
 first_prior_anomaly_auc= 0.49971639999440565
 first_prior_star_anomaly_auc= 0.5022054717125815


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4818157562096127; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4940699361809561; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.48181692571903123 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4661927923013968; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4884573760838458; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.46619595721090573 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45436110665009577; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4855495536814469; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4543666829192305 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44733843167099024; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48255410247024505; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.44734263346513825 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5022057610757364 at iter 0
0.49971639999440565 at iter 0
0.5022054717125815 at iter 0
last anomaly aucs:
0.4429920222578139
0.47950991165260604
0.4429970198006384




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.184704542160034 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4425736272491354,first_prior_anomaly_auc= 0.4792339255150302, first_prior_star_anomaly_auc= 0.44257925777386176


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44257362724913546 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4811117597668505 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44257860670676274 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4425736272491354 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4825437336238539 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44257868507595055 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4425736272491354 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4833208304336734 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4425785825931665 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44257362724913546 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4838883318648153 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44257829925841047 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4425736212207364 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48407020263619477 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44257848613878137 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44257362724913535 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48434618274537156 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4425783595424011 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4425736212207364 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48476297419989883 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44257824500281884 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4425736212207364 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48511463483093237 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.442578160605232 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4425736272491354 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48578686161062423 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4425776421629124 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4425736272491354 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4855184772842689 iter_best_prior_anomaly= 920
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4425770875501985 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4425736272491354 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48592417648451736 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4425765389658836 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4425736272491354 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4866891562122171 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4425761290347472 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.44257362724913546 at iter 10
max_prior_anomaly= 0.487602115051755 at iter 129
max_prior_star_anomaly= 0.44257925777386176 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4425736212207364
accuracies_anomaly['prior'][-1]= 0.487602115051755
accuracies_anomaly['prior_star'][-1]= 0.4425759964099678



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 126.29379224777222 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4425736151923373
 first_prior_anomaly_auc= 0.48773191854041364
 first_prior_star_anomaly_auc= 0.44257609286435273


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4393411755571085; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4872243876231662; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.43934213407255973 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43778258120615243; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48619763069448607; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.4377835457500028 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43712988643942974; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4854661266667921; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.43712975984304947 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43655979882508916; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4856169873533833; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.43656088996531983 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4425736151923373 at iter 0
0.487774792514561 at iter 10
0.44257609286435273 at iter 0
last anomaly aucs:
0.4360023708487841
0.4856153295436405
0.4360018162360702




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.77869415283203 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4359351722844112,first_prior_anomaly_auc= 0.4855629548125675, first_prior_star_anomaly_auc= 0.43593573895392324


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4359351722844112 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4853206312553683 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43593603434547745 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43593516625601214 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4846063202218065 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43593552795995605 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43593516625601214 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4852375659446574 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4359353109375897 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43593517228441125 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.48557709140837385 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43593527476719524 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43593517228441125 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4864150931339429 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43593537724997944 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43593517228441114 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.48723549796264226 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4359349974608383 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43593517228441114 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4872602445408024 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4359349552620449 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4359351662560121 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.48725237145162403 iter_best_prior_anomaly= 780
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4359335928438563 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43593516625601214 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.48640829309979794 iter_best_prior_anomaly= 780
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435933846036617 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4359351722844112 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4866134274631677 iter_best_prior_anomaly= 780
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43593462370009634 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43593517228441125 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.48630629258762514 iter_best_prior_anomaly= 780
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43593449710371596 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43593516625601214 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4867185687712531 iter_best_prior_anomaly= 780
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43593410525777676 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43593518434120937 at iter 7
max_prior_anomaly= 0.48736000851692224 at iter 78
max_prior_star_anomaly= 0.4359362815098391 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4359351783128102
accuracies_anomaly['prior'][-1]= 0.48668206681491705
accuracies_anomaly['prior_star'][-1]= 0.43593403894538707



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 127.43860340118408 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43593516625601214
 first_prior_anomaly_auc= 0.48677594104515076
 first_prior_star_anomaly_auc= 0.4359341956837627


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43549594915696455; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48675801258633267; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 60 
last prior star auc 0.4355000243547322 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4351494247219341; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48657358577374993; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 60 
last prior star auc 0.43514999139144617 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43492862254939546; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4864748285402738; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 60 
last prior star auc 0.4349312931301811 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43479008993889134; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48624983663038535; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 60 
last prior star auc 0.43479106653953975 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43593516625601214 at iter 0
0.4867830003004554 at iter 60
0.4359341956837627 at iter 0
last anomaly aucs:
0.43483512207990377
0.4858337143281542
0.4348365146400877




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.77701663970947 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43484549695469393,first_prior_anomaly_auc= 0.48580669504354673, first_prior_star_anomaly_auc= 0.43484379694615777


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4348454909262949 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4869528142737057 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348429167998943 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43484549695469393 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.48860748924895314 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348426756639317 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4348454969546939 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.48950739660451625 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348412891321468 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43484549695469393 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4905570915916372 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.434840463241475 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4348454909262949 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4904382115620836 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348410721097805 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43484549695469393 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4901197312395016 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348406440934469 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43484549695469393 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4899266416174628 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348384919549809 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4348454969546939 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.49069628732603854 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348401497647236 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43484549695469393 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4923318462478521 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348411926777618 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43484549695469393 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4942079503491407 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348420547388281 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43484549695469393 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4944152911065681 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348406561502451 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43484549695469393 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.49444486643237895 iter_best_prior_anomaly= 1160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348399749411508 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4348455150398911 at iter 69
max_prior_anomaly= 0.4948392382707851 at iter 116
max_prior_star_anomaly= 0.43484379694615777 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4348454909262949
accuracies_anomaly['prior'][-1]= 0.4943578042930882
accuracies_anomaly['prior_star'][-1]= 0.4348393540160471



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 127.36541867256165 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4348454909262948
 first_prior_anomaly_auc= 0.49437894588860776
 first_prior_star_anomaly_auc= 0.43483908876648825


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4350127609151399; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4944729226016255; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 90 
last prior star auc 0.4350094392672553 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43507388888165477; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.49428590960584395; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 90 
last prior star auc 0.43507149560722613 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43515757511746933; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.49371856491307775; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 90 
last prior star auc 0.4351618854228006 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4352672859520458; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4929813278778733; count_not_improved_prior_anomaly= 32; iter_best_prior_anomaly= 90 
last prior star auc 0.4352755026599708 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4353355756566494 at iter 490
0.494478287876793 at iter 90
0.43534610124141615 at iter 490
last anomaly aucs:
0.4353355756566494
0.4929516259556821
0.43534610124141615




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.232959032058716 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4353431412974755,first_prior_anomaly_auc= 0.4929818161781976, first_prior_star_anomaly_auc= 0.4353541853245618


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4353431412974754 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4937488636467763 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43535399241579165 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4353431412974755 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4941909261501824 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4353545349717075 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4353431292406773 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4940593563405978 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4353526902815938 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4353431412974754 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4940524297100725 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43535261794080493 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4353431352690763 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.49384012155181606 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4353533594338899 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4353431292406773 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4941115683048962 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4353536789390403 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4353431473258745 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4941320166345233 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4353512916930108 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4353431352690764 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.49359856360129806 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4353523888616405 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43534312924067736 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4934334156089238 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43535523426599904 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43534312321227825 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4922010601301459 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435356542428596 iter_best_prior_star_anomaly= 950
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4353431352690764 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4913665970748279 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43535593356029045 iter_best_prior_star_anomaly= 1010
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43534313526907636 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.49097665610973423 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4353544686593178 iter_best_prior_star_anomaly= 1010
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4353431533542736 at iter 9
max_prior_anomaly= 0.49450496957105283 at iter 129
max_prior_star_anomaly= 0.4353574406600566 at iter 101
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43534313526907636
accuracies_anomaly['prior'][-1]= 0.49450496957105283
accuracies_anomaly['prior_star'][-1]= 0.4353544385173225



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 128.2534577846527 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43534315938267265
 first_prior_anomaly_auc= 0.4944786917795304
 first_prior_star_anomaly_auc= 0.4353553186635859


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4354559205871757; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4946834644389562; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.4354651621229417 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43556767504903504; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4944954025017374; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 130 
last prior star auc 0.4355801236931034 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4355656073081558; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.49397989601252745; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 130 
last prior star auc 0.4355717381900045 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4355658062453249; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4934980460752952; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 130 
last prior star auc 0.435565155178226 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4355925241099792 at iter 250
0.4946846339483747 at iter 130
0.4355954237699293 at iter 250
last anomaly aucs:
0.4355425848521282
0.49286798794706005
0.4355480164396854




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.981438875198364 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4355409029287892,first_prior_anomaly_auc= 0.4928682893670132, first_prior_star_anomaly_auc= 0.43554617777797067


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4355409089571882 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.49282626539713403 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43554197598382266 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4355409089571882 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.49943872590509175 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4355454121712895 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4355409089571882 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5051972034015603 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4355441884062794 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4355409089571882 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4992943758894902 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4355464490559286 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4355409089571882 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4943170342302144 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43554716643541724 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4355409089571882 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4901700442580946 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4355481309792676 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4355409089571882 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4878645553766327 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43555279093174454 iter_best_prior_star_anomaly= 670
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4355409089571882 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.48581406174720365 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435550777446457 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4355409029287891 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.48334356352654595 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43555148879754657 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4355409089571882 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.4810476236292023 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43555007815216545 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4355409089571883 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.4779552719314364 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43554474301899326 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43554090292878916 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.47561540309010913 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43553977561816404 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43554091498558734 at iter 75
max_prior_anomaly= 0.5063667369336862 at iter 26
max_prior_star_anomaly= 0.4355545632810695 at iter 71
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4355409089571882
accuracies_anomaly['prior'][-1]= 0.4737994804966823
accuracies_anomaly['prior_star'][-1]= 0.4355372738325523



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 127.96444034576416 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43554090292878916
 first_prior_anomaly_auc= 0.4736651979075186
 first_prior_star_anomaly_auc= 0.4355386000803465


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43556294275576934; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4732119225818524; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.43554765473574153 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.435573649192508; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.47244462192051295; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.43553870256313054 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43554427280386626; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.47181801203654267; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43546704901184896 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4356301835189356; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.47149866965289444; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4354821863219001 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4356668361852484 at iter 490
0.4736651979075186 at iter 0
0.43555395441276396 at iter 130
last anomaly aucs:
0.4356668361852484
0.4710232881878584
0.43545305709762006




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.83311581611633 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43565485172790797,first_prior_anomaly_auc= 0.4709554264995884, first_prior_star_anomaly_auc= 0.4354464017450527


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43565484569950885 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46867755371424136 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43543505629801316 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.435654851727908 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4669727104019785 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43542451262804915 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.435654851727908 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.46600705129781783 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435421040270188 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43565485172790797 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4652207069238333 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4354161210965513 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43565485172790797 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4644543708063441 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4354115636268585 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43565485172790797 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4638272304232563 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4353995610843209 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43565485172790797 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.46319194567303223 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43538776350735153 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4356548456995089 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4625543520459663 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4353816507107 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43565485172790797 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4621333105700985 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4353842368938987 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4356548517279079 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4617585671990466 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4353868954178862 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4356548517279079 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4616916338842326 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4353888064203897 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43565485172790797 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.46144320958718005 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4353896021690662 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4356548577563071 at iter 14
max_prior_anomaly= 0.4771969776982994 at iter 2
max_prior_star_anomaly= 0.4354488372182749 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4356548456995089
accuracies_anomaly['prior'][-1]= 0.4610317532658249
accuracies_anomaly['prior_star'][-1]= 0.4353929298453498



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 127.84792613983154 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43565483967110985
 first_prior_anomaly_auc= 0.4610130290583303
 first_prior_star_anomaly_auc= 0.4353934784296647


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43564350628086845; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4611413013336265; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 100 
last prior star auc 0.43525551851707167 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43570430268543475; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.46153293025045833; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 200 
last prior star auc 0.4352271127006794 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4357780722047881; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.46220216091581506; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 300 
last prior star auc 0.4352569351908519 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4358441193449397; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.462621436070757; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 400 
last prior star auc 0.43533303167224413 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4358863301951899 at iter 460
0.46287365223082116 at iter 490
0.4353934784296647 at iter 0
last anomaly aucs:
0.43587910817311054
0.46287365223082116
0.4353816265971037




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.556381940841675 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4358755453892634,first_prior_anomaly_auc= 0.4628929491362269, first_prior_star_anomaly_auc= 0.4353841766099081


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43587553333246526 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4549174796565646 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43536265522524753 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43587555141766243 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.45560501254148145 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4353692502938241 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4358755393608643 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.45585654749245125 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4353519909873022 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4358755453892634 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4561012160968865 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43531547697416806 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4358755514176625 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.45621125849341143 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352959509895979 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4358755333324652 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.4563499900410848 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43526929340893433 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4358755453892634 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.45646489132725576 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352450291026993 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4358755453892634 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.4567250107184936 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352315676875881 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43587555141766243 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.45712075100348726 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43524068262697374 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4358755453892634 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.4574964227479951 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352415507164391 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4358755393608643 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.45804303577637817 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352362396968632 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4358755453892633 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.45829830833476803 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352249183634199 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43587556347446055 at iter 49
max_prior_anomaly= 0.4902835710692789 at iter 2
max_prior_star_anomaly= 0.43539103692804354 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4358755453892634
accuracies_anomaly['prior'][-1]= 0.4584483672442838
accuracies_anomaly['prior_star'][-1]= 0.4351982487259582



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.95790791511536 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4358755453892634
 first_prior_anomaly_auc= 0.4584478970291568
 first_prior_star_anomaly_auc= 0.4351942398405802


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4359525521589144; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4607478518402773; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4352232665820761 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43612978709141326; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4621316889307501; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.43529114032714433 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4363936802604653; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4637715461010968; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.4354327534495705 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43656749709069465; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4644014655761534; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.43549945768522014 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43663836092169883 at iter 490
0.46498433942491 at iter 490
0.43551255136798844 at iter 490
last anomaly aucs:
0.43663836092169883
0.46498433942491
0.43551255136798844




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.11913466453552 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43663949426072296,first_prior_anomaly_auc= 0.46505143550649886, first_prior_star_anomaly_auc= 0.43551043539991674


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43663949426072296 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.46886072661981876 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43547343911485736 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43663949426072296 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4663184060527056 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43546710929583954 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43663946411872767 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.45102540656728973 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43532033586381413 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4366394882323239 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.44782781710705327 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352599132199898 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4366394882323239 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.447769926390836 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435213633200371 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43663948823232385 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.4481600542363007 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43520309555880604 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43663948823232396 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.4486621415091928 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351768358524807 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43663948823232385 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.4492323255779185 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43514522895618507 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43663949426072296 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.449802955748175 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43508362474614415 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4366394822039249 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.45023777211590543 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4350322989565082 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4366394761755258 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.4506994510298676 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349826430334133 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43663946411872767 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.4508450308388782 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349253973558959 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43663950631752113 at iter 53
max_prior_anomaly= 0.4788090560057564 at iter 14
max_prior_star_anomaly= 0.43551043539991674 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.436639500289122
accuracies_anomaly['prior'][-1]= 0.4509620782351162
accuracies_anomaly['prior_star'][-1]= 0.4348706293503942



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.38267827033997 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4366394701471267
 first_prior_anomaly_auc= 0.45098702977884453
 first_prior_star_anomaly_auc= 0.43486748252608254


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43677506089888735; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.45710382928731297; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4351373679238049 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4369219729840913; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4631603026063422; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.4352080689880343 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4370873138852357; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.46774652776270675; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.4352163520083491 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4372725424748941; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4709294199860238; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.4352918516782339 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4374044016476339 at iter 490
0.4729597968477742 at iter 490
0.4353446303120444 at iter 490
last anomaly aucs:
0.4374044016476339
0.4729597968477742
0.4353446303120444




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.09162759780884 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43741570489587994,first_prior_anomaly_auc= 0.47316525674469345, first_prior_star_anomaly_auc= 0.43535367291064125


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43741572298107706 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.48805659605723417 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357209953224446 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.437415710924279 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.480369380507244 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357137069879755 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.437415716952678 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4793795957500269 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43552496987006145 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4374157531230724 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.47441811480869 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4353027630805409 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4374157410662743 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4590741632943802 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43506943389474606 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4374156868106827 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.45218937588707897 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349578000008681 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4374156566686874 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4498465832722054 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43497757314979996 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43741569886748083 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4495058099298824 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4350309546235169 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.437415716952678 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.44975902077579233 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4350741239892183 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4374157229810771 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.45026333252793926 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43509805070510565 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43741569283908177 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4506463287773105 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4350800016783063 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43741570489587994 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.451133706756485 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43507103744889725 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4374157531230724 at iter 40
max_prior_anomaly= 0.48806286559226125 at iter 9
max_prior_star_anomaly= 0.435744180545247 at iter 14
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4374156626970864
accuracies_anomaly['prior'][-1]= 0.4514374114729598
accuracies_anomaly['prior_star'][-1]= 0.43505608701921705



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.09076952934265 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4374157290094762
 first_prior_anomaly_auc= 0.4514916972065363
 first_prior_star_anomaly_auc= 0.43504981145579086


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43786179436986106; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.46424825984232604; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4351312852691488 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4380412477532157; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.470245546339339; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.4351424016370238 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4382908536164848; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4725346982593359; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.4352285896584501 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.438529258714292; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4734839540896418; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 390 
last prior star auc 0.43524554151661987 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4387162596532754 at iter 490
0.47372149109798367 at iter 490
0.43525712809962197 at iter 450
last anomaly aucs:
0.4387162596532754
0.47372149109798367
0.4352438294512854




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.088725566864014 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43873467038401864,first_prior_anomaly_auc= 0.47380066809129795, first_prior_star_anomaly_auc= 0.43524206313035957


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43873447747524863 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4950135132593432 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4360302642512559 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4387345859864318 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4922832633797906 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43588286989412683 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4387347427248074 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48414279058933146 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4356365917071413 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43873477286680274 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4784420109003101 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43536017152483286 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4387344955604458 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.473529800064528 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351082869267173 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.438734706554413 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.46433818547117245 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349376470627952 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4387346402420233 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4578321262067046 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43486605982390325 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4387346040716289 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4562225315996622 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.434810309189354 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4387346884692158 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4556999598267486 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347484457581532 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43873465229882147 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4561696263694714 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43473156624077236 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43873448350364763 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4565663975107052 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43468030073512715 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4387346824408168 iter_best_vanilla_star_anomaly= 1190 
last prior auc 0.4569049282885761 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43465267861061313 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4387348271223943 at iter 119
max_prior_anomaly= 0.49527295746988564 at iter 12
max_prior_star_anomaly= 0.43605703637150184 at iter 7
last values
accuracies_anomaly['vanilla_star'][-1]= 0.438734803008798
accuracies_anomaly['prior'][-1]= 0.4573243360682975
accuracies_anomaly['prior_star'][-1]= 0.43467337410460194



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.77934765815735 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4387347909519999
 first_prior_anomaly_auc= 0.457361724199296
 first_prior_star_anomaly_auc= 0.4346700645135154


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4387109245201033; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.461374136190698; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.43421429343063656 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4387996143271414; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4604094175167915; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 60 
last prior star auc 0.43413075187639955 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43862307266053513; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4594418835805218; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 60 
last prior star auc 0.4338558146802609 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43855570530098825; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.458747821939418; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 60 
last prior star auc 0.43365833638370327 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4387996143271414 at iter 200
0.4619980634370845 at iter 60
0.4346700645135154 at iter 0
last anomaly aucs:
0.438537849182959
0.4589711258975684
0.4336571729026838




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.03059959411621 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43855750176390956,first_prior_anomaly_auc= 0.45902686447531943, first_prior_star_anomaly_auc= 0.433696683030153


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43855773687147304 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4830831366869559 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347439787144463 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43855753190590485 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.47832250994565273 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43435309129069954 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43855733899713484 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.46895862179222864 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4339762560651723 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43855764041708806 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.46371545184780083 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4337481595297656 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43855747765031333 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.46043553856993835 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43368753794877213 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4385575620479002 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.45536378615291206 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336844936072445 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.438557543962703 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.45039517361548165 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43366882579807564 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4385574957355105 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.4482674622224344 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4335902516446678 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43855768864428063 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.44702118717021644 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43350970620476587 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4385576886442805 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.4465433280331649 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4334304809842592 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4385574173663227 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.44624038892337137 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43330893640231893 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4385575741046983 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.44646794893126135 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.433211776694595 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4385580563766235 at iter 51
max_prior_anomaly= 0.49353034020908415 at iter 2
max_prior_star_anomaly= 0.4350830641050311 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43855774289987215
accuracies_anomaly['prior'][-1]= 0.44856517471023893
accuracies_anomaly['prior_star'][-1]= 0.43407197498551975



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.00287795066833 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43855764041708806
 first_prior_anomaly_auc= 0.4485266592686153
 first_prior_star_anomaly_auc= 0.4340484461439707


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43803363388519706; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44993407945622876; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.43322883706394777 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43811551160129236; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45047644849167046; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.43341266103662424 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43830948136959436; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45547898283063715; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 300 
last prior star auc 0.4338436132005542 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43844432459987104; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4582425396150216; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 400 
last prior star auc 0.43412252311167643 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43855764041708806 at iter 0
0.46140120370249804 at iter 490
0.434191102179435 at iter 460
last anomaly aucs:
0.4384306763043888
0.46140120370249804
0.4341534729124739




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.12569570541382 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4384263599706586,first_prior_anomaly_auc= 0.46176124380823136, first_prior_star_anomaly_auc= 0.4341328196172787


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4384255099663904 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49818798983756596 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43510191490890604 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43842554613678486 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48879525579461774 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43492175620286094 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4384251362056485 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4829697726425463 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348039251147445 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43842540748360637 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.466791587152083 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43468474969363674 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4384258957839306 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46191080236062465 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43435320583028175 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43842543762560165 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45366895601149543 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43422789952732527 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.438425552165184 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4495449462966098 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4339365711141301 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4384255280515877 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4472675075559953 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43380234278055807 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43842547379599606 iter_best_vanilla_star_anomaly= 820 
last prior auc 0.4461806474886413 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344896526147096 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43842596812471935 iter_best_vanilla_star_anomaly= 820 
last prior auc 0.4453284850536696 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4343879052952975 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43842560039237644 iter_best_vanilla_star_anomaly= 820 
last prior auc 0.444961693140984 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.434241318743643 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43842570287516053 iter_best_vanilla_star_anomaly= 820 
last prior auc 0.44519100741300177 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4341027379059464 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43842666139061176 at iter 82
max_prior_anomaly= 0.5139103801315541 at iter 3
max_prior_star_anomaly= 0.4354522372353472 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4384245454225401
accuracies_anomaly['prior'][-1]= 0.44477822484385243
accuracies_anomaly['prior_star'][-1]= 0.4339972047519217



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.55867552757263 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4384258957839306
 first_prior_anomaly_auc= 0.44470173651652095
 first_prior_star_anomaly_auc= 0.4339989831296458


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43825330271871155; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4656497480852599; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.4350742445571997 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43806756171513256; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4834965944368004; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 200 
last prior star auc 0.43491498028231235 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.438145442602648; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4968678910104031; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 300 
last prior star auc 0.4353982348365266 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4383626217073487; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5040319319475732; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 400 
last prior star auc 0.4358730074332572 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43854684355436335 at iter 470
0.5075155930570205 at iter 490
0.4361929285432157 at iter 480
last anomaly aucs:
0.4385004067963688
0.5075155930570205
0.43613968572267725




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.080564975738525 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43848561310506434,first_prior_anomaly_auc= 0.5078314027988169, first_prior_star_anomaly_auc= 0.4361922292489242


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4384863666549475 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.550543146698921 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43670428749386914 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4384862219733699 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5439396745339686 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4367580487567271 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4384861014053886 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.529352256960269 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43630679294474756 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43848568544585315 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.5016790538210646 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43570734702696234 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4384860712633933 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4911619630685805 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43587800497608176 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43848609537698957 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4839500325292413 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4369404982544167 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4384860350929989 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48630011950698304 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43834139571424224 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43848610140538863 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4909617358220494 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44158676023706556 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4384860531781961 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.49664532251693866 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4425865943355233 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4384864088537409 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4986404513293584 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4427034066241978 iter_best_prior_star_anomaly= 980
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4384861315473839 iter_best_vanilla_star_anomaly= 1040 
last prior auc 0.49804276570410017 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4422884297177889 iter_best_prior_star_anomaly= 980
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4384865535353185 iter_best_vanilla_star_anomaly= 1040 
last prior auc 0.4984518769782192 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4422659618744752 iter_best_prior_star_anomaly= 980
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4384866077909101 at iter 104
max_prior_anomaly= 0.5525768874073496 at iter 5
max_prior_star_anomaly= 0.4428431087441206 at iter 98
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4384857397014447
accuracies_anomaly['prior'][-1]= 0.4979616897650805
accuracies_anomaly['prior_star'][-1]= 0.4417930641098538



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.64500498771667 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.438486318427755
 first_prior_anomaly_auc= 0.4982299052962621
 first_prior_star_anomaly_auc= 0.44188886139938915


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43388487759215133; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4493739447287437; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4353257795081694 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4344359034086498; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4727115594310928; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.44258022231771205 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43367636732530546; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.46232944453366476; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4376533926141984 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43394592116107933; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.46754710832165036; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4404281561924439 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44437138024778167 at iter 10
0.4982299052962621 at iter 0
0.4613196515199523 at iter 90
last anomaly aucs:
0.43372717467262173
0.46260770337768786
0.43823631469014757




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.4830424785614 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43421222568975737,first_prior_anomaly_auc= 0.4876098736013511, first_prior_star_anomaly_auc= 0.45105805034822444


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43421221363295925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4939061264931742 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43625180791687945 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43421222568975737 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4933891249609962 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43665126772409607 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43421222568975737 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49272548864997134 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43795741683582357 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43421222568975737 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48987860130531724 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44272333048310625 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4342122196613583 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48941722983970726 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44310349338491706 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43421222568975737 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48920999759346306 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4431779199997685 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43421221966135826 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4886610033474495 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4431896211223529 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43421222568975737 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4877434448394251 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4431130182554392 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43421222568975737 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.486863328717991 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4430601491956428 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43421222568975737 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.486213117651683 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4430371267396151 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43421221966135837 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4857445241639937 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44302219439513213 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43421222568975737 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4851055560619411 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44300161344072564 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4342122317181565 at iter 78
max_prior_anomaly= 0.49503470308205516 at iter 13
max_prior_star_anomaly= 0.45105805034822444 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43421221966135837
accuracies_anomaly['prior'][-1]= 0.48467338013300093
accuracies_anomaly['prior_star'][-1]= 0.4430079131177482



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 128.2641577720642 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43421222568975737
 first_prior_anomaly_auc= 0.4846160560862958
 first_prior_star_anomaly_auc= 0.44300265635376385


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4341097127636641; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4490146220024992; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.43364906470594194 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43472863041042786; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4425359376981836; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.433944582856487 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43474276700623427; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.43992074584317764; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.43364657497712833 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43486262966483546; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.440518702746394; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.4331175467888164 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4354215345989113 at iter 490
0.48771941564075366 at iter 10
0.44300265635376385 at iter 0
last anomaly aucs:
0.4354215345989113
0.4416035252148642
0.43341283586019713




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.36756753921509 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43577854844831415,first_prior_anomaly_auc= 0.5028812793613177, first_prior_star_anomaly_auc= 0.4358240749180499


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4357783615679432 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5284615549700775 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43416042365659535 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4357784640507273 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5212675046623638 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43424232548628683 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43577849419272263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4995867291305264 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43431054285010173 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4357784519939292 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4997054403649062 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4340663746027888 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43577849419272263 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5019307877092036 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4411005819093049 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43577850624952075 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5041034287604792 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44933271650754103 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43577845802232823 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5051658496980255 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44929337517524554 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4357784881643235 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5060905217169459 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4495960430070812 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4357784158235347 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5064761764903046 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.449993652095785 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4357783856815395 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5057683580425354 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45213080999016647 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4357784097951357 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5054191027427287 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45946693760703416 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4357784278803329 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5059075899473311 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46177938326101664 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43577857256191044 at iter 46
max_prior_anomaly= 0.5320035287836764 at iter 12
max_prior_star_anomaly= 0.46242132336380803 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43577820482956753
accuracies_anomaly['prior'][-1]= 0.5059468468820396
accuracies_anomaly['prior_star'][-1]= 0.46242132336380803



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 127.93715333938599 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5022057610757364
accuracies_anomaly["prior"][-1]= 0.49971639999440565
accuracies_anomaly["prior_star"][-1]= 0.5022054717125815


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 2788.808541059494 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012084245681762695 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.505832253044221
 first_prior_anomaly_auc= 0.5034664560585169
 first_prior_star_anomaly_auc= 0.505832078220648


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4894319994174155; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5007926741930023; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4894331749552331 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4724713397851671; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49216360568675765; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4724737933435864 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4573263073547916; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4880941891538009; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4573363205256378 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44698602954687183; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4868935008553093; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.44699649484764786 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.505832253044221 at iter 0
0.5034664560585169 at iter 0
0.505832078220648 at iter 0
last anomaly aucs:
0.4430445778408589
0.4866929661604258
0.44305462718209965




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.09402871131897 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4427896911000092,first_prior_anomaly_auc= 0.4866896806829356, first_prior_star_anomaly_auc= 0.44280019257117975


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4427896911000092 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.48725847821987645 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44279925816932475 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4427896911000092 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.487751926796909 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44279912554454526 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4427896911000092 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4883147803323722 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44279890852217896 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4427896911000092 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48831647431250935 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44279858901702857 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4427896911000092 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4883286456502207 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44279810071670433 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4427896911000092 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48861566375808474 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44279760638798094 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4427896911000092 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48885823447964544 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4427968709232951 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4427896911000092 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4891185528080524 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44279582801025696 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4427896911000092 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48978721680389714 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.442795273397543 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4427896911000092 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4883929988102352 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44279438119448145 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4427896911000092 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48887808599776517 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4427932659406545 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4427896911000092 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48975835885757496 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44279284395272 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4427896971284083 at iter 21
max_prior_anomaly= 0.4899637343569073 at iter 129
max_prior_star_anomaly= 0.44280019257117975 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4427896911000092
accuracies_anomaly['prior'][-1]= 0.4899637343569073
accuracies_anomaly['prior_star'][-1]= 0.44279164430130613



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.88846635818481 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4427896911000092
 first_prior_anomaly_auc= 0.4899693829668308
 first_prior_star_anomaly_auc= 0.44279184323847526


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44078449486115157; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48997790109470907; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 70 
last prior star auc 0.44078591153493163 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4398047413599779; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4890918289149991; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 70 
last prior star auc 0.4398041083780761 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43908936932818077; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4888409992867198; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 70 
last prior star auc 0.4390911356491067 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4387079766329607; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4880881185559428; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 70 
last prior star auc 0.43870757875862243 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4427896911000092 at iter 0
0.49022609028419795 at iter 70
0.44279184323847526 at iter 0
last anomaly aucs:
0.43847574461579564
0.4871964761354972
0.43847567227500694




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.338767766952515 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43845441613990516,first_prior_anomaly_auc= 0.4870759925517924, first_prior_star_anomaly_auc= 0.43845579664329093


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4384544101115061 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4893705700309474 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4384545427362855 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43845441011150604 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4919070731929633 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43845495266742185 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43845441011150604 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49289076323872605 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4384541991175388 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.438454404083107 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49421270072760365 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43845258953498856 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43845441011150604 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4957609021185723 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4384520288938756 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43845441011150604 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49751167580330835 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4384520952062653 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43845441011150604 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49863769032258687 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4384526920177727 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4384544101115061 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5001141296510907 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4384530235797212 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4384544101115061 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5015336428072278 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43845366861842117 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43845441011150615 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5030904346668634 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4384536806752193 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43845441011150604 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5044682493866707 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43845383138519595 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.438454404083107 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5053598857787172 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4384531320909044 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43845441613990516 at iter 0
max_prior_anomaly= 0.5059331925581583 at iter 129
max_prior_star_anomaly= 0.43845579664329093 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43845441011150604
accuracies_anomaly['prior'][-1]= 0.5059331925581583
accuracies_anomaly['prior_star'][-1]= 0.438452625705383



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 126.72435903549194 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4384544221683042
 first_prior_anomaly_auc= 0.5060318593656485
 first_prior_star_anomaly_auc= 0.4384523423706269


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43811946623107867; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5058756695742842; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.43811167151108815 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4378652667277223; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5058373470414306; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.4378608117408136 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4376161310795802; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5059812027283088; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.43760795657044854 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43733476761003875; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5059466117744761; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.4373232352826282 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4384544221683042 at iter 0
0.5060423005528283 at iter 10
0.4384523423706269 at iter 0
last anomaly aucs:
0.43707580567142135
0.505620758719838
0.4370707418162072




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.39621138572693 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43704996192463147,first_prior_anomaly_auc= 0.5056042650199974, first_prior_star_anomaly_auc= 0.4370441867183276


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4370499619246315 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5065670003506116 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43704551899452093 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4370499498678334 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5066993297384783 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43704445196788644 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43704995589623247 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5060226600286759 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.437042914726125 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4370499498678334 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5050907418740798 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43704214911944383 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4370499438394343 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5048086429398526 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43704138351276256 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43704995589623247 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5048882961766928 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4370409132976356 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43704996192463147 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5057285947223054 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43704129308677664 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43704995589623247 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5058069217113516 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43704110017800657 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4370499558962324 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5059233300972887 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43704032854292635 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43704995589623247 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5058666450608844 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4370402803157338 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43704995589623247 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5059058417116024 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43704078670125523 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43704995589623247 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5060131894137455 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4370387430739723 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4370499619246315 at iter 6
max_prior_anomaly= 0.5068098001513369 at iter 16
max_prior_star_anomaly= 0.43704567573289665 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4370499558962324
accuracies_anomaly['prior'][-1]= 0.5064967031891197
accuracies_anomaly['prior_star'][-1]= 0.43703777250172293



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 126.07488012313843 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43704996192463147
 first_prior_anomaly_auc= 0.5065034670528701
 first_prior_star_anomaly_auc= 0.43703777250172293


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4367294922303581; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5063124512001096; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.43670841694722834 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4364835576621193; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5060579985039925; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4364671061610721 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43623502485388366; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5060368086812805; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43621987548703434 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4360203415063957; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5061428542492256; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43601459644208707 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43704996192463147 at iter 0
0.5065034670528701 at iter 0
0.43703777250172293 at iter 0
last anomaly aucs:
0.4358914543343948
0.5062844312012573
0.43587352587557676




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.37905311584473 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4358885968732382,first_prior_anomaly_auc= 0.5063153388032615, first_prior_star_anomaly_auc= 0.43586689463660566


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4358886029016373 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5066963517093406 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358627109276549 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4358885908448391 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5066815278760407 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43586190915057926 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43588858481644005 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5062959514718698 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358584247359199 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43588859687323817 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5057031006226612 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43585562755875396 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4358885968732382 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5055181855097541 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358505516467416 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43588859084483916 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.505284259512452 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43584677786892717 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4358885968732382 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.504844536027883 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43584478849723585 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4358885968732382 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5046413066386177 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43584393849296776 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4358886029016373 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5043950224232331 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358442519697191 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43588859687323817 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5046142752972121 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435846753755331 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4358886029016373 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5036673404005462 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435849189228553 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4358886029016373 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5022250700379403 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358524144220525 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43588860893003634 at iter 45
max_prior_anomaly= 0.5067189039502411 at iter 24
max_prior_star_anomaly= 0.43586689463660566 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4358886029016373
accuracies_anomaly['prior'][-1]= 0.5011392890540187
accuracies_anomaly['prior_star'][-1]= 0.4358586417582863



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 126.8550705909729 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4358885848164401
 first_prior_anomaly_auc= 0.5010071164045278
 first_prior_star_anomaly_auc= 0.43585900346223017


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4358998820362871; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5009599984374389; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.43587169927066016 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43597218665466775; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5006547022236112; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4359333275942975 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4360262071386855; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5004562774684003; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4359885959569215 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43604734873420503; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.500458676771228; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43599960381361347 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43607720739477185 at iter 470
0.5010071164045278 at iter 0
0.43602764792606186 at iter 470
last anomaly aucs:
0.4360751818526862
0.50061230449299
0.4360261287694977




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.36158633232117 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4360738435480938,first_prior_anomaly_auc= 0.5006151318121512, first_prior_star_anomaly_auc= 0.43602179435057026


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43607384354809386 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.49844076663874315 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43602669543900974 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43607383751969475 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4960541777046653 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43603316993960506 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43607383751969475 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.493835172236184 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4360401447973228 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43607384354809386 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4939619193265169 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43604758384176856 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43607384354809386 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4941431330023983 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43605390160398816 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43607383751969486 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4936393879197635 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43606335413372144 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43607384354809386 iter_best_vanilla_star_anomaly= 680 
last prior auc 0.49215004178886235 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43607354212814065 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43607383751969475 iter_best_vanilla_star_anomaly= 680 
last prior auc 0.4913964497069957 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43608759432636013 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4360738435480938 iter_best_vanilla_star_anomaly= 680 
last prior auc 0.4913866053313232 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43610265929562253 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43607384354809386 iter_best_vanilla_star_anomaly= 680 
last prior auc 0.49083691179101807 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43611361892512196 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43607384354809386 iter_best_vanilla_star_anomaly= 680 
last prior auc 0.49024330739192645 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43613076972046066 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4360738375196948 iter_best_vanilla_star_anomaly= 680 
last prior auc 0.48976278973088744 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4361445988679149 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.436073855604892 at iter 68
max_prior_anomaly= 0.5006151318121512 at iter 0
max_prior_star_anomaly= 0.43616279860469087 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43607383751969475
accuracies_anomaly['prior'][-1]= 0.48961392444438656
accuracies_anomaly['prior_star'][-1]= 0.43616279860469087



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 126.77890586853027 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4360738435480938
 first_prior_anomaly_auc= 0.48956737314680987
 first_prior_star_anomaly_auc= 0.43616552344106807


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4360335858991405; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4893972396684091; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4361216186106807 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43600109885658145; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48900455578174107; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4360764659016869 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4359553071372869; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48896344812851966; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43602802168680393 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43596214937022515; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48937978142471805; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43601248650241453 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43607456092758257 at iter 10
0.4896725687104869 at iter 490
0.43616552344106807 at iter 0
last anomaly aucs:
0.43596923273912613
0.4896725687104869
0.43600854392942623




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.39017963409424 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43597332602209093,first_prior_anomaly_auc= 0.48967976661896995, first_prior_star_anomaly_auc= 0.43601167266854074


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4359733260220909 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48934094044954496 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4360365578998794 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4359733199936919 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48887585549011126 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4360627332086179 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43597332602209093 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4884547235882574 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4360867804924865 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4359733260220909 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48821030214818384 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43611917108066045 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43597332602209093 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4876452241334659 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4361390828827708 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43597332602209093 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4873146146719659 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43616519790751856 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43597332602209093 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4871682150006824 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4361951831644658 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43597332602209093 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48714872518650665 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43623201065435135 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43597332602209093 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48665559611462444 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43627118921987207 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.435973326022091 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48611169586582037 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43629850389603375 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43597332602209093 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4856908714123188 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43632534232866926 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43597332602209093 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4855903418295179 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43635849249512537 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.435973326022091 at iter 1
max_prior_anomaly= 0.48967976661896995 at iter 0
max_prior_star_anomaly= 0.4363899848518389 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.435973326022091
accuracies_anomaly['prior'][-1]= 0.4851315444903085
accuracies_anomaly['prior_star'][-1]= 0.4363899848518389



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 126.19205927848816 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43597332602209093
 first_prior_anomaly_auc= 0.4850855417770466
 first_prior_star_anomaly_auc= 0.4363951753034334


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4360136318982367; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4853623839472897; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.43641837861143307 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43605992397465376; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.48527653954461; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 120 
last prior star auc 0.43642633609819825 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4360248869192903; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4848267365768049; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 120 
last prior star auc 0.43635388679824016 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43603281426406026; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48463210368460574; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 120 
last prior star auc 0.43628416233465905 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43606220873789925 at iter 210
0.4853962394364363 at iter 120
0.4364339680514141 at iter 160
last anomaly aucs:
0.43602849793033
0.48440951710594404
0.43624627987493725




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.279930114746094 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43603293483204153,first_prior_anomaly_auc= 0.4843846198178073, first_prior_star_anomaly_auc= 0.43624078800338945


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43603292880364247 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.48455208271542244 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43645101033556966 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43603294086044064 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4843973457682326 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43653476891217297 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43603293483204153 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4842248672425958 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366141508710555 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43603294086044064 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4838668707641454 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366870462725444 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43603293483204153 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4834161273660863 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4367776229684898 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43603292880364247 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4831008360666095 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4368521641229233 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43603293483204153 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.48282426517432436 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43694565253561696 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4360329468888397 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4824889294479578 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4370314728247004 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43603292880364247 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.48231335835360084 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43717872852865103 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43603293483204153 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.48204918184979256 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4373488378934555 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4360329288036425 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4816481848008144 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4375056425815244 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43603293483204153 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.48113021872478623 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.437641034396116 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43603295291723876 at iter 17
max_prior_anomaly= 0.4850318649117756 at iter 2
max_prior_star_anomaly= 0.4377763357847215 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43603293483204153
accuracies_anomaly['prior'][-1]= 0.48062630484697755
accuracies_anomaly['prior_star'][-1]= 0.4377763357847215



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 126.15962266921997 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43603294086044064
 first_prior_anomaly_auc= 0.48056597262913914
 first_prior_star_anomaly_auc= 0.4377900262789972


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43603074652318113; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4806495322685734; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 100 
last prior star auc 0.43724467318601856 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4360352316520852; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.48036217054196273; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 100 
last prior star auc 0.4369123576875833 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43605020016696255; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.47980705144249947; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 100 
last prior star auc 0.4365926114011977 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4360766949808514; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.47934241258459653; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 100 
last prior star auc 0.43634721938887466 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4360848634615839 at iter 490
0.4806495322685734 at iter 100
0.4377900262789972 at iter 0
last anomaly aucs:
0.4360848634615839
0.47882076315673977
0.436172335532011




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.422938108444214 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.436088697523389,first_prior_anomaly_auc= 0.47874860321993673, first_prior_star_anomaly_auc= 0.4361595251839988


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43608869752338897 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4788887032141977 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43750871103664823 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.436088703551788 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.47852781913259534 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4377052127325576 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.436088697523389 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.47800577785879944 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4379533416380558 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.436088703551788 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.47748915008736353 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4381976907373407 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.436088697523389 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4769630095022037 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4383826420206422 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43608869752338897 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.47645999988425475 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4385642475424628 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.436088703551788 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4758361510070561 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4387241990548435 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.436088703551788 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.47510628067550864 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4388744810151245 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.436088697523389 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.47434998787086113 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4390193977002381 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.436088697523389 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4734952151390944 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4391238879412246 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.436088697523389 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.47268534795195993 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4392187327437076 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43608870958018714 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4718689339234413 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43930286508105304 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43608870958018714 at iter 4
max_prior_anomaly= 0.4790290322876231 at iter 7
max_prior_star_anomaly= 0.43936329978167543 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.436088703551788
accuracies_anomaly['prior'][-1]= 0.47096360100872003
accuracies_anomaly['prior_star'][-1]= 0.43936329978167543



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 128.2133092880249 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4360887095801871
 first_prior_anomaly_auc= 0.47087515836604343
 first_prior_star_anomaly_auc= 0.4393682792393029


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4359989828885098; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47439262673744487; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4374303478772078 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4358994238779582; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4749942850776868; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 200 
last prior star auc 0.4365766662856718 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.436047999801304; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4759064722821445; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 300 
last prior star auc 0.4363850415646059 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.436321677062038; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.47647287051625764; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 400 
last prior star auc 0.4365241951002137 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43653279159727976 at iter 490
0.4768913860929175 at iter 490
0.4393682792393029 at iter 0
last anomaly aucs:
0.43653279159727976
0.4768913860929175
0.4366269491622695




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.71847438812256 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43654067674325625,first_prior_anomaly_auc= 0.47697864716937727, first_prior_star_anomaly_auc= 0.43663321869729665


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43654067674325625 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47495539587532115 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4382142447211721 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4365406827716553 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4758289410417749 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4384689867804442 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4365406888000544 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4757722439485724 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4386954556481035 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43654068880005437 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.47569937266067974 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4388974612723587 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4365406888000544 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4755499768750612 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43908648775342785 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43654067674325625 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.4753887533704779 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4392537155434795 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43654067674325625 iter_best_vanilla_star_anomaly= 680 
last prior auc 0.4752045375518623 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43942868982632904 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4365406948284534 iter_best_vanilla_star_anomaly= 680 
last prior auc 0.4749113523917553 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43965195158568593 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43654067674325625 iter_best_vanilla_star_anomaly= 680 
last prior auc 0.47453005012252114 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43991787029682394 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43654067674325625 iter_best_vanilla_star_anomaly= 680 
last prior auc 0.4742459437314054 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44014255475836006 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43654067674325625 iter_best_vanilla_star_anomaly= 680 
last prior auc 0.47382204479438095 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.440435637435683 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43654068277165536 iter_best_vanilla_star_anomaly= 680 
last prior auc 0.47334559027431145 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44077625403963017 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4365407068852516 at iter 68
max_prior_anomaly= 0.47697864716937727 at iter 0
max_prior_star_anomaly= 0.4410797899609311 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43654068880005437
accuracies_anomaly['prior'][-1]= 0.47300109740976576
accuracies_anomaly['prior_star'][-1]= 0.4410797899609311



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 128.72936415672302 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43654067674325625
 first_prior_anomaly_auc= 0.47288950571468114
 first_prior_star_anomaly_auc= 0.44111295218418545


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43763739927148004; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.45481259154123976; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.43703148488149857 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4383177764467072; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4541657202080135; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.436800976986466 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43868034245164866; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4538112021158234; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4369251258368021 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43902999562579365; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.44935787904523655; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4368951285230567 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43918686662625234 at iter 490
0.47288950571468114 at iter 0
0.44111295218418545 at iter 0
last anomaly aucs:
0.43918686662625234
0.4426545404213803
0.4367459618166025




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.7590057849884 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43919165920350867,first_prior_anomaly_auc= 0.4420903847517192, first_prior_star_anomaly_auc= 0.4367166818823459


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4391915928911189 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.46425570491517076 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4362484742121967 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4391916170047152 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.45506692366937557 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4368466119673849 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43919164111831144 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.456002693970974 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43752162386744464 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43919161097631615 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4476176972576572 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43744039119004935 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.439191604947917 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4438889093854457 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4374018214928342 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4391916350899123 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.44128836654016673 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4372549395496255 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4391916471467105 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4403179510291442 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4371869030377826 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4391916893455039 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4403878623730962 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4372550118904143 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4391916109763161 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.44058517187448004 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4372530767743146 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43919161097631615 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4406965947743907 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43731002103187866 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4391916109763161 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4406843149254962 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4374416209834585 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4391916170047152 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.44055211816240897 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43745879589239356 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4391917134591002 at iter 54
max_prior_anomaly= 0.5037164959665188 at iter 1
max_prior_star_anomaly= 0.43793259791687467 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4391916290615133
accuracies_anomaly['prior'][-1]= 0.4406017560003067
accuracies_anomaly['prior_star'][-1]= 0.43756007299667854



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 128.566486120224 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4391916230331142
 first_prior_anomaly_auc= 0.44064892219458807
 first_prior_star_anomaly_auc= 0.4375647932331461


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4378098536835206; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4811994368028457; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.4590980417830751 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4387413317649851; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4961770907331932; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.46430795907826256 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4377978270273868; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5048628744178376; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 300 
last prior star auc 0.4620744372248337 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43730458341592243; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4914936274999168; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 300 
last prior star auc 0.45601957951675387 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.446284504747726 at iter 40
0.5048628744178376 at iter 300
0.47746358364693064 at iter 20
last anomaly aucs:
0.43828685075950596
0.5013483961323721
0.4604683812880422




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 62.61207318305969 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4381506149690454,first_prior_anomaly_auc= 0.49475690842475994, first_prior_star_anomaly_auc= 0.4533616041135866


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4381506631962379 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4711941209605507 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4385932441419635 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4381506029122473 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4739886154889345 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44016709034255297 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4381506270258435 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4781208419117452 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44283040690729136 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4381506089406463 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4806687930035847 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4439699129836765 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43815064511104074 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4810454232635437 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.444086725272351 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4381506209974444 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4839370413292572 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4440389924085576 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43815066922463697 iter_best_vanilla_star_anomaly= 610 
last prior auc 0.48790386053853374 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4440027014461888 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4381506451110407 iter_best_vanilla_star_anomaly= 720 
last prior auc 0.4899102925991997 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.443988992866716 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4381506270258435 iter_best_vanilla_star_anomaly= 720 
last prior auc 0.49005622205535615 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4440103092858083 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4381506330542426 iter_best_vanilla_star_anomaly= 910 
last prior auc 0.48825420697857125 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4440143724267779 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.438150675253036 iter_best_vanilla_star_anomaly= 1050 
last prior auc 0.4868643957446255 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44398100523795536 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43815065113943974 iter_best_vanilla_star_anomaly= 1050 
last prior auc 0.4850386046619298 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44394182667243465 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4381506812814351 at iter 105
max_prior_anomaly= 0.5057336284355243 at iter 1
max_prior_star_anomaly= 0.46206617228971625 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43815064511104074
accuracies_anomaly['prior'][-1]= 0.48357323950250763
accuracies_anomaly['prior_star'][-1]= 0.4439593331433182



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 128.73573923110962 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4381506390826416
 first_prior_anomaly_auc= 0.48344980803166016
 first_prior_star_anomaly_auc= 0.44395753668039695


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43838105655168824; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5164314626487628; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 80 
last prior star auc 0.4388714788723904 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4388745171855189; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5286554584259898; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 190 
last prior star auc 0.4378890005348396 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4391558746266613; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5322573243842955; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 300 
last prior star auc 0.43809808349959656 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43932530881077053; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5320387587478099; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 330 
last prior star auc 0.4383355300819525 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4398118729560713 at iter 30
0.5360513937899773 at iter 440
0.4593886709019787 at iter 30
last anomaly aucs:
0.43917659423424615
0.5329566548461817
0.4388336988954526




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.79446506500244 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43891942875855006,first_prior_anomaly_auc= 0.5308367622867213, first_prior_star_anomaly_auc= 0.4385970962889658


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4389193323041651 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48946498681709694 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4374330184579934 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4389193925881557 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5024852557415678 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4375457555489002 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4389192961337707 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5143500493605315 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43781565903181985 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43891951918453603 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5192795496448308 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4382572211781035 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4389194408153482 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5186158108510219 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4382737811903339 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4389193745029585 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5177296723589222 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43926759291812617 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43891932627576596 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5166456275539313 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4405914775799016 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43891951315613703 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5167887236625274 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4407758380800948 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4389193684745594 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5163449852641814 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4407103877514506 iter_best_prior_star_anomaly= 820
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43891933833256414 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.516237516994057 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44062988451034213 iter_best_prior_star_anomaly= 820
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4389192901053716 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5156528044835856 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4404425158390157 iter_best_prior_star_anomaly= 820
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43891927804857345 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5155238630559932 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44022315445385357 iter_best_prior_star_anomaly= 820
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43891957946852667 at iter 17
max_prior_anomaly= 0.551189246397067 at iter 1
max_prior_star_anomaly= 0.4417565681819169 at iter 127
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43891930216216973
accuracies_anomaly['prior'][-1]= 0.515083187084372
accuracies_anomaly['prior_star'][-1]= 0.44141055013240776



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 128.5375463962555 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43891947698574263
 first_prior_anomaly_auc= 0.5146877542477305
 first_prior_star_anomaly_auc= 0.44127687038315055


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.47628837136288604; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5174264258007764; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 100 
last prior star auc 0.5014678548882359 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4661655620228221; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5155066399198658; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 140 
last prior star auc 0.49361913249890643 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45966094957412973; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5091104120579556; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 140 
last prior star auc 0.4870645084515744 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4548988458750559; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5162219818096676; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 140 
last prior star auc 0.48957527637798354 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4764111035394419 at iter 110
0.5270572996919729 at iter 140
0.5051403917687757 at iter 140
last anomaly aucs:
0.4524958355819262
0.5176894930791568
0.4846409232324372




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.65763306617737 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.45110836336681753,first_prior_anomaly_auc= 0.5145681447818902, first_prior_star_anomaly_auc= 0.4823477081714709


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45110842365080817 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5070822355618636 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4814735119379181 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4511084357076063 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5072509101676907 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4819953904449392 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4511084236508081 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.508353739464167 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4822878220551632 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.45110837542361565 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.51047052136971 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48222557883482137 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.45110841762240905 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5109669962030732 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4823446698583423 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.45110840556561094 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5112733534151362 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4824668835925786 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4511084417360053 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5113335710933924 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48262256699842154 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4511084477644044 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5113445186660938 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48277864225020367 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4511083633668175 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5112328847722157 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4829379004966919 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4511083935088128 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5113895025799137 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4830581972000257 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4511083995372119 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5115076170027861 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48315594166245884 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.45110836939521654 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5114234304098492 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4832058869487089 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4511085261335922 at iter 4
max_prior_anomaly= 0.5178511144580782 at iter 1
max_prior_star_anomaly= 0.48321682246461206 at iter 126
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4511084236508081
accuracies_anomaly['prior'][-1]= 0.5111663794737352
accuracies_anomaly['prior_star'][-1]= 0.48321489337691137



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 128.20826315879822 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.45110844173600534
 first_prior_anomaly_auc= 0.5111556489234003
 first_prior_star_anomaly_auc= 0.4832166657262364


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4484209814330131; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5025846278717485; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.48141985315784425 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4476087149430509; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.503657719075639; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 120 
last prior star auc 0.47582279207472905 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44562116382825523; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4990115897177696; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 120 
last prior star auc 0.46510868118401616 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4445063983016312; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.50124142821937; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 120 
last prior star auc 0.4594671847713959 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.45110844173600534 at iter 0
0.5130791422697356 at iter 120
0.4835057696601767 at iter 20
last anomaly aucs:
0.4439338450720731
0.49466806790774526
0.45453533341146135




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.75409913063049 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4441326255028287,first_prior_anomaly_auc= 0.5006874243737337, first_prior_star_anomaly_auc= 0.4557085080966222


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4441316730157766 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.463558574818943 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45118493006333676 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4441320708901148 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.46167394656137706 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4516721392473375 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44413195032213354 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4730742761460107 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4519252054116697 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44413219748649524 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5114652132437658 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45234135785589624 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4441319744357297 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4890172696753683 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4545963287531969 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4441325350768428 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.48249654331597636 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4545949844202055 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4441318297541522 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4799658033034662 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4514869829984679 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4441320407481195 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.48095828878346425 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45095519380338445 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44413192018013814 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.48215092916920466 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4516637477158396 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.44413242053726054 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4819865045847181 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4515236115511842 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4441316850725747 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4817468274947082 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4515348123166463 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4441317935837578 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.48185400037327847 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45160784637131374 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.44413280635480074 at iter 16
max_prior_anomaly= 0.5148004491398439 at iter 1
max_prior_star_anomaly= 0.4557085080966222 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44413197443572977
accuracies_anomaly['prior'][-1]= 0.4824210557028896
accuracies_anomaly['prior_star'][-1]= 0.4517625471481091



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 128.46093654632568 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.44413257727563626
 first_prior_anomaly_auc= 0.48259921900884434
 first_prior_star_anomaly_auc= 0.4518268581093301


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4474955739494068; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.49743700805249436; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 50 
last prior star auc 0.47678318838650624 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44821403854992403; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4935279348778574; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 50 
last prior star auc 0.47681222115640126 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44949263787792637; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.49431517748330256; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 50 
last prior star auc 0.4763785803264884 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4473279965122094; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.49661770039242464; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 50 
last prior star auc 0.4769636726261008 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4527381591391253 at iter 30
0.5025690082897721 at iter 50
0.4832467052387752 at iter 10
last anomaly aucs:
0.4479559205871757
0.49276974915590355
0.47583618717745046




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 61.71677613258362 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44862451224223165,first_prior_anomaly_auc= 0.495544976920877, first_prior_star_anomaly_auc= 0.47978765205430957


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44862450621383265 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5001447177479444 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47114582142724515 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4486245303274289 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4998951359982715 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47369852892594666 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44862451827063077 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.49926965945332547 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47661383859998385 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4486245303274289 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.49755847426524663 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47817624289914873 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44862451224223165 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.49721211862539 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.478464406402835 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44862451224223165 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4969033138833066 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4784652142083097 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4486245122422317 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.49659414140888025 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4784039596454144 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44862450621383265 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.49641045608938233 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4783567211103443 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44862451827063077 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.49612328727154176 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47828442252036274 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4486245303274288 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4947585782913009 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4778008605177961 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4486245182706307 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.49320205168122405 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47738066904619636 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.44862453032742894 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.49234135906157594 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4767849848494275 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.448624548412626 at iter 28
max_prior_anomaly= 0.5084525328680374 at iter 1
max_prior_star_anomaly= 0.47978765205430957 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4486245182706307
accuracies_anomaly['prior'][-1]= 0.4916894841571262
accuracies_anomaly['prior_star'][-1]= 0.47654725493231553



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 128.7252812385559 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.505832253044221
accuracies_anomaly["prior"][-1]= 0.5034664560585169
accuracies_anomaly["prior_star"][-1]= 0.505832078220648


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 2828.816078901291 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012100458145141602 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5050126560209962
 first_prior_anomaly_auc= 0.5036591839766117
 first_prior_star_anomaly_auc= 0.5050125475098131


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 20


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 21 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5131978354189183 at iter 10
0.5036591839766117 at iter 0
0.5131963946315419 at iter 10
last anomaly aucs:
0.5131978354189183
0.4972106356392201
0.5131963946315419




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.5826950073242188 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5632948504450646,first_prior_anomaly_auc= 0.4573334088088896, first_prior_star_anomaly_auc= 0.563294790161074


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5632948504450646 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45711628395978043 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5632947539906796 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 142, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 143 iterations

max values 
max_vanilla_star_anomaly= 0.5632948504450646 at iter 0
max_prior_anomaly= 0.4582897660932936 at iter 4
max_prior_star_anomaly= 0.5632949468994497 at iter 14
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5632948504450646
accuracies_anomaly['prior'][-1]= 0.4573025373772799
accuracies_anomaly['prior_star'][-1]= 0.5632949468994497



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 14.222319841384888 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5050126560209962
accuracies_anomaly["prior"][-1]= 0.5036591839766117
accuracies_anomaly["prior_star"][-1]= 0.5050125475098131


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 17.061354637145996 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.01197052001953125 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5122805723024482
 first_prior_anomaly_auc= 0.5090669473007
 first_prior_star_anomaly_auc= 0.512280270882495


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 20


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 21 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5122805723024482 at iter 0
0.5090669473007 at iter 0
0.512280270882495 at iter 0
last anomaly aucs:
0.47903483160752325
0.4873227288971068
0.4790347532383354




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.572638750076294 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5611939413142585,first_prior_anomaly_auc= 0.45392279381090794, first_prior_star_anomaly_auc= 0.5611920423685532


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5611939413142585 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45432215113534047 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5611919941413606 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5611939413142585 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45134899897227854 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5611912164778813 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5611939413142585 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4515369282847179 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5611915842102242 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5611939413142585 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4512844709886912 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5611918856301775 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5611939413142585 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44946451539629007 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5611911139950972 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5611939413142585 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.449836847407716 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5611912888186701 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5611939413142585 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4505500130454556 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5611918012325906 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5611939413142585 at iter 0
max_prior_anomaly= 0.4553439828619849 at iter 4
max_prior_star_anomaly= 0.5611922654193187 at iter 38
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5611939413142585
accuracies_anomaly['prior'][-1]= 0.4505091163862014
accuracies_anomaly['prior_star'][-1]= 0.5611911260518954



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 79.12914848327637 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5611939413142585
 first_prior_anomaly_auc= 0.4501388340304574
 first_prior_star_anomaly_auc= 0.5611913129322663


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5122805723024482
accuracies_anomaly["prior"][-1]= 0.5090669473007
accuracies_anomaly["prior_star"][-1]= 0.512280270882495


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 82.05322670936584 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.011222600936889648 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49981875618212324
 first_prior_anomaly_auc= 0.4959190752532289
 first_prior_star_anomaly_auc= 0.4998186657561373


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 21


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 22 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5574145510602989 at iter 20
0.4959190752532289 at iter 0
0.5574133453804859 at iter 20
last anomaly aucs:
0.5574145510602989
0.46338165939159465
0.5574133453804859




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.852355480194092 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5626354098997888,first_prior_anomaly_auc= 0.45994360312107097, first_prior_star_anomaly_auc= 0.5626353978429905


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5626354098997888 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4600844446084169 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626354159281878 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5626354098997888 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46024351597453417 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626353797577934 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5626354098997888 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.460324525601164 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626353978429905 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5626354098997888 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46034992324642315 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626353978429905 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5626354098997888 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4602923821773516 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626353616725962 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5626354098997888 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4603524190036358 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626354219565868 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5626354098997888 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4600507398292468 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626354882689766 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 770, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 771 iterations

max values 
max_vanilla_star_anomaly= 0.5626354098997888 at iter 0
max_prior_anomaly= 0.46036937086180546 at iter 39
max_prior_star_anomaly= 0.5626355123825728 at iter 75
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5626354098997888
accuracies_anomaly['prior'][-1]= 0.4599809671384733
accuracies_anomaly['prior_star'][-1]= 0.5626354882689766



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.13422107696533 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.49981875618212324
accuracies_anomaly["prior"][-1]= 0.4959190752532289
accuracies_anomaly["prior_star"][-1]= 0.4998186657561373


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 79.24147415161133 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.011989355087280273 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49641494724668545
 first_prior_anomaly_auc= 0.4938123426889264
 first_prior_star_anomaly_auc= 0.49641451320195285


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 22


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 23 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5624798108915328 at iter 20
0.4938123426889264 at iter 0
0.5624788222340861 at iter 20
last anomaly aucs:
0.5624798108915328
0.463902712007944
0.5624788222340861




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.960556983947754 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5623848997766598,first_prior_anomaly_auc= 0.4553112124846698, first_prior_star_anomaly_auc= 0.5623848093506739


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5623848997766598 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4556200413403494 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623848756630636 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5623848997766598 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4558124919520872 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623848334642702 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5623848997766598 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45594689510923214 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623848515494674 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5623848997766598 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4560604641192099 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623848455210683 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5623848997766598 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45609006355861703 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5623848153790729 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 599, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 600 iterations

max values 
max_vanilla_star_anomaly= 0.5623848997766598 at iter 0
max_prior_anomaly= 0.45664375995590106 at iter 42
max_prior_star_anomaly= 0.5623848756630636 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5623848997766598
accuracies_anomaly['prior'][-1]= 0.4560900454734198
accuracies_anomaly['prior_star'][-1]= 0.5623848394926692



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 59.44696497917175 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.49641494724668545
accuracies_anomaly["prior"][-1]= 0.4938123426889264
accuracies_anomaly["prior_star"][-1]= 0.49641451320195285


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 62.665406942367554 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012134790420532227 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49480304376280126
 first_prior_anomaly_auc= 0.4907737160836241
 first_prior_star_anomaly_auc= 0.4948028930528247


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 21


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 22 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5305855649260991 at iter 20
0.4907737160836241 at iter 0
0.53058369009399 at iter 20
last anomaly aucs:
0.5305855649260991
0.4588167024271299
0.53058369009399




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.833144187927246 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5634675821634623,first_prior_anomaly_auc= 0.4690944476515528, first_prior_star_anomaly_auc= 0.5634676967030444


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5634675821634623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4690784603372335 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5634677027314434 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5634675821634623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46907574152925535 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5634676906746454 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5634675821634623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.469078598990412 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5634676725894482 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5634675821634623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4690854050529559 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5634676665610491 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5634675821634623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4690884614512816 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5634676725894481 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5634675821634623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4690816433319396 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5634676846462463 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5634675821634623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46907933445509786 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5634676786178473 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5634675821634623 at iter 0
max_prior_anomaly= 0.4690944476515528 at iter 0
max_prior_star_anomaly= 0.5634677087598425 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5634675821634623
accuracies_anomaly['prior'][-1]= 0.46908272241537213
accuracies_anomaly['prior_star'][-1]= 0.5634676725894482



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.76609325408936 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5634675821634623
 first_prior_anomaly_auc= 0.46908384369759815
 first_prior_star_anomaly_auc= 0.5634676786178472


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.49480304376280126
accuracies_anomaly["prior"][-1]= 0.4907737160836241
accuracies_anomaly["prior_star"][-1]= 0.4948028930528247


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 81.94737434387207 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.01189875602722168 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5085998367991806
 first_prior_anomaly_auc= 0.505151158489505
 first_prior_star_anomaly_auc= 0.5085997584299926


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 21


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 22 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5624938028057617 at iter 20
0.505151158489505 at iter 0
0.562493193937456 at iter 20
last anomaly aucs:
0.5624938028057617
0.4589564949730386
0.562493193937456




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.80546236038208 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5627734602383677,first_prior_anomaly_auc= 0.4636936893271776, first_prior_star_anomaly_auc= 0.5627727669724754


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5627734602383677 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4637311136285706 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5627728031428696 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5627734602383677 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4637724021337639 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5627728091712687 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5627734602383677 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.463808530329358 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5627727850576725 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5627734602383677 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4638422652505234 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5627727850576725 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5627734602383677 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46386022385133685 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5627728091712687 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5627734602383677 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46388234807590384 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5627728091712687 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5627734602383677 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4639179578291783 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5627728091712687 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5627734602383677 at iter 0
max_prior_anomaly= 0.46393310116762854 at iter 79
max_prior_star_anomaly= 0.5627728212280669 at iter 18
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5627734602383677
accuracies_anomaly['prior'][-1]= 0.46393310116762854
accuracies_anomaly['prior_star'][-1]= 0.5627728212280669



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.9063549041748 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5627734602383677
 first_prior_anomaly_auc= 0.46393562103843755
 first_prior_star_anomaly_auc= 0.5627728212280669


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5085998367991805
accuracies_anomaly["prior"][-1]= 0.505151158489505
accuracies_anomaly["prior_star"][-1]= 0.5085997584299926


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 82.05539608001709 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.011853933334350586 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.498861157047512
 first_prior_anomaly_auc= 0.49733406108166844
 first_prior_star_anomaly_auc= 0.4988611751327092


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 21


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 22 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5499847903491599 at iter 20
0.49733406108166844 at iter 0
0.5499792080516261 at iter 20
last anomaly aucs:
0.5499847903491599
0.47105881354354606
0.5499792080516261




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.8192343711853027 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5625489445720054,first_prior_anomaly_auc= 0.45921607180836055, first_prior_star_anomaly_auc= 0.5625482754197093


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5625489445720054 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4587563099253009 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5625483236469018 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 156, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 157 iterations

max values 
max_vanilla_star_anomaly= 0.5625489445720054 at iter 0
max_prior_anomaly= 0.4597901984500745 at iter 4
max_prior_star_anomaly= 0.5625483537888971 at iter 9
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5625489445720054
accuracies_anomaly['prior'][-1]= 0.45754052048715255
accuracies_anomaly['prior_star'][-1]= 0.562548245277714



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 16.001891613006592 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.498861157047512
accuracies_anomaly["prior"][-1]= 0.49733406108166844
accuracies_anomaly["prior_star"][-1]= 0.4988611751327092


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 19.07072687149048 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.011288642883300781 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5057067719176916
 first_prior_anomaly_auc= 0.5026063120231837
 first_prior_star_anomaly_auc= 0.5057066332645132


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 21


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 22 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5633314126853913 at iter 20
0.5026063120231837 at iter 0
0.563331280060612 at iter 20
last anomaly aucs:
0.5633314126853913
0.4666136348400955
0.563331280060612




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.7755203247070312 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5632671077525695,first_prior_anomaly_auc= 0.46878324360664164, first_prior_star_anomaly_auc= 0.5632670112981844


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5632671077525695 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4689025817945242 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5632669570425928 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 102, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 103 iterations

max values 
max_vanilla_star_anomaly= 0.5632671077525695 at iter 0
max_prior_anomaly= 0.4695296860072177 at iter 5
max_prior_star_anomaly= 0.5632670293833816 at iter 7
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5632671077525695
accuracies_anomaly['prior'][-1]= 0.4689025817945242
accuracies_anomaly['prior_star'][-1]= 0.5632669570425928



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 10.052292823791504 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5057067719176916
accuracies_anomaly["prior"][-1]= 0.5026063120231837
accuracies_anomaly["prior_star"][-1]= 0.5057066332645132


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 13.075410604476929 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.011116981506347656 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49628001961882195
 first_prior_anomaly_auc= 0.49394468413359127
 first_prior_star_anomaly_auc= 0.4962798508236481


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 20


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 21 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.49628001961882195 at iter 0
0.49394468413359127 at iter 0
0.4962798508236481 at iter 0
last anomaly aucs:
0.47537922247155684
0.48928250114901284
0.47537928275554747




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.516890525817871 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5530666164621593,first_prior_anomaly_auc= 0.46777994317872185, first_prior_star_anomaly_auc= 0.5530687505154281


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5530666164621593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46786068755579285 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5530685756918553 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5530666164621593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46813616127944807 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5530681115051272 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5530666164621593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46834106053525437 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5530678522839675 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5530666164621593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46834247118063543 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5530676111480048 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5530666164621593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4681933225593785 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5530673941256385 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5530666164621593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4683428811117718 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5530672735576573 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5530666164621593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4681885239537231 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5530670022796994 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5530666164621593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4674007990763528 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5530663753261966 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5530666164621593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4675717644738245 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.553064633118867 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5530666164621593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46784480272425766 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5530626015483822 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5530666164621593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4677275503624515 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5530603047283387 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5530666164621593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4665803098500665 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5530589603953473 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5530666164621593 at iter 0
max_prior_anomaly= 0.4683579822514286 at iter 37
max_prior_star_anomaly= 0.5530687505154281 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5530666164621593
accuracies_anomaly['prior'][-1]= 0.466728861659816
accuracies_anomaly['prior_star'][-1]= 0.553061371754973



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 126.4612672328949 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5530666164621593
 first_prior_anomaly_auc= 0.4660358369033512
 first_prior_star_anomaly_auc= 0.5530612150165974


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4962800196188219
accuracies_anomaly["prior"][-1]= 0.49394468413359127
accuracies_anomaly["prior_star"][-1]= 0.4962798508236481


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 129.3188931941986 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.011795997619628906 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49417499309145463
 first_prior_anomaly_auc= 0.4908729555890252
 first_prior_star_anomaly_auc= 0.49417475798389116


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 20


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 21 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.49417499309145463 at iter 0
0.4908729555890252 at iter 0
0.49417475798389116 at iter 0
last anomaly aucs:
0.4755871781256888
0.490460552809017
0.4755881245843419




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.5296177864074707 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5620847156452389,first_prior_anomaly_auc= 0.46124339227178535, first_prior_star_anomaly_auc= 0.5620831301762849


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5620847156452389 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.461592924877949 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5620831663466792 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5620847156452389 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4619322031773038 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5620831904602754 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5620847156452389 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.462106478165862 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5620831784034774 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5620847156452389 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46202673450303566 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5620832145738718 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5620847156452389 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46175380476378564 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5620831964886746 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5620847156452389 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4614280180215373 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.562083244715867 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5620847156452389 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46108215068200487 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5620832447158671 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5620847156452389 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46118861220948537 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.562083244715867 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5620847156452389 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4610426706965309 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5620833471986513 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5620847156452389 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4611430797113506 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5620832869146606 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5620847156452389 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46087913831510585 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5620833833690456 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5620847156452389 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4596510388860676 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5620833110282568 iter_best_prior_star_anomaly= 1160
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5620847156452389 at iter 0
max_prior_anomaly= 0.46225403528976583 at iter 22
max_prior_star_anomaly= 0.5620834315962381 at iter 116
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5620847156452389
accuracies_anomaly['prior'][-1]= 0.4595640129171712
accuracies_anomaly['prior_star'][-1]= 0.5620832929430596



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 126.45910334587097 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5620847156452389
 first_prior_anomaly_auc= 0.45890694153272765
 first_prior_star_anomaly_auc= 0.5620832929430596


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.49417499309145463
accuracies_anomaly["prior"][-1]= 0.4908729555890252
accuracies_anomaly["prior_star"][-1]= 0.49417475798389116


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 129.32808351516724 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.011887550354003906 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4963783608927625
 first_prior_anomaly_auc= 0.49342385456800736
 first_prior_star_anomaly_auc= 0.4963780052172177


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 21


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 22 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5638413489338655 at iter 20
0.49342385456800736 at iter 0
0.5638396670105266 at iter 20
last anomaly aucs:
0.5638413489338655
0.4657242530692991
0.5638396670105266




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.7721338272094727 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.56341268756158,first_prior_anomaly_auc= 0.4641956258900931, first_prior_star_anomaly_auc= 0.5634132180606977


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.56341268756158 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4642222894991558 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5634132542310922 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.56341268756158 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4642322725280067 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5634132723162893 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.56341268756158 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4642360523342202 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5634132602594912 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.56341268756158 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4642389580225693 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5634132602594912 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.56341268756158 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4642526364600469 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5634132542310922 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.56341268756158 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4642464452942076 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5634132602594912 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.56341268756158 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4642583091835667 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.563413236145895 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.56341268756158 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46427653906233796 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5634132482026931 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.56341268756158 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4643004898918216 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.563413242174294 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.56341268756158 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4643217882257168 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5634132482026931 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.56341268756158 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46435511924414485 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5634132301174959 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.56341268756158 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46437969099873205 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.563413242174294 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.56341268756158 at iter 0
max_prior_anomaly= 0.4645439769300402 at iter 36
max_prior_star_anomaly= 0.5634132843730875 at iter 23
last values
accuracies_anomaly['vanilla_star'][-1]= 0.56341268756158
accuracies_anomaly['prior'][-1]= 0.46439263999992286
accuracies_anomaly['prior_star'][-1]= 0.563413236145895



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 126.38907265663147 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.56341268756158
 first_prior_anomaly_auc= 0.464397601372353
 first_prior_star_anomaly_auc= 0.563413236145895


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4963783608927625
accuracies_anomaly["prior"][-1]= 0.49342385456800736
accuracies_anomaly["prior_star"][-1]= 0.4963780052172177


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 129.4999659061432 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.01219797134399414 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49025570178040323
 first_prior_anomaly_auc= 0.48662802221730306
 first_prior_star_anomaly_auc= 0.49025540036045


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 21


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 22 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5626848427721183 at iter 20
0.48662802221730306 at iter 0
0.5626837094330941 at iter 20
last anomaly aucs:
0.5626848427721183
0.4728229943878016
0.5626837094330941




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 2.781658172607422 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5628386935446457,first_prior_anomaly_auc= 0.4610502001669625, first_prior_star_anomaly_auc= 0.5628366378605646


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5628386935446457 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4611164824146777 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5628366378605646 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5628386935446457 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4611744997272752 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5628366378605646 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5628386935446457 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4612326858350466 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5628366438889636 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5628386935446457 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4612682292759315 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5628366438889636 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5628386935446457 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4613121160211216 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5628366559457618 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5628386935446457 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46134705059370085 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5628366559457618 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5628386935446457 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.461376927339465 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5628366378605646 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5628386935446457 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4614182640718508 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5628366378605645 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5628386935446457 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4614551156753326 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5628366438889636 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5628386935446457 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4614820626191513 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5628366619741608 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5628386935446457 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4615080450191197 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5628366680025599 iter_best_prior_star_anomaly= 1020
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5628386935446457 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4615298316533391 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5628366559457618 iter_best_prior_star_anomaly= 1020
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5628386935446457 at iter 0
max_prior_anomaly= 0.46155782753859503 at iter 129
max_prior_star_anomaly= 0.5628366680025599 at iter 102
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5628386935446457
accuracies_anomaly['prior'][-1]= 0.46155782753859503
accuracies_anomaly['prior_star'][-1]= 0.5628366559457618



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.84337139129639 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5628386935446457
 first_prior_anomaly_auc= 0.4615601243586387
 first_prior_star_anomaly_auc= 0.5628366559457618


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4902557017804033
accuracies_anomaly["prior"][-1]= 0.48662802221730306
accuracies_anomaly["prior_star"][-1]= 0.49025539433205095


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 128.96331405639648 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.011894702911376953 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5044188285711393
 first_prior_anomaly_auc= 0.5017511173034827
 first_prior_star_anomaly_auc= 0.5044186838895617


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.48291575215852856; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4993478598459913; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.48291711457671715 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.47254719513059684; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4936170828432245; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.47255182494107845 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46089555364575874; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48868915597108104; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4609034086497399 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.450051054511678; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4850345837197537; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4500599464002982 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44396510834962205; count_not_improved_vanilla_star_anomaly= 50 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48253877225142383; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.4439746271917451 ; count_not_improved_prior_star_anomaly= 50 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4405417010888253; count_not_improved_vanilla_star_anomaly= 60 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48063819284993287; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.44055156354969505 ; count_not_improved_prior_star_anomaly= 60 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4382497519916625; count_not_improved_vanilla_star_anomaly= 70 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4790368812632052; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.43826010878125543 ; count_not_improved_prior_star_anomaly= 70 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43699655030891926; count_not_improved_vanilla_star_anomaly= 80 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47763159512886066; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.4370051226923891 ; count_not_improved_prior_star_anomaly= 80 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43615376806289213; count_not_improved_vanilla_star_anomaly= 90 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4762741383126945; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.43616165320886857 ; count_not_improved_prior_star_anomaly= 90 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5044188285711393 at iter 0
0.5017511173034827 at iter 0
0.5044186838895617 at iter 0
last anomaly aucs:
0.43555675158992996
0.4749199428604223
0.4355655349673671




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 120.01645946502686 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4355099591563906,first_prior_anomaly_auc= 0.4748014727620051, first_prior_star_anomaly_auc= 0.43551689181531494


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4355099591563907 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.48250978770872127 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4409673723751748 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4355099591563907 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4701806988506013 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44884326475908826 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43550996518478974 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4630747174248222 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45102648565072223 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43550996518478974 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4612879240556754 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45033402153537055 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4355099591563906 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.45698795140049353 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4475832630422002 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4355099591563907 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.45612674033852596 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44689000920657107 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4355099591563906 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4565248075855587 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4458407181221874 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43550996518478974 at iter 17
max_prior_anomaly= 0.4897553205444464 at iter 5
max_prior_star_anomaly= 0.45171979977034205 at iter 29
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43550996518478974
accuracies_anomaly['prior'][-1]= 0.4586499508806044
accuracies_anomaly['prior_star'][-1]= 0.4433967267722167



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.46189713478088 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4355099591563907
 first_prior_anomaly_auc= 0.4527552375936753
 first_prior_star_anomaly_auc= 0.4424605947666745


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4340700217842229; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48426996569599795; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.45015811285066587 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43386594841908854; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4882717857902435; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.4464695344002153 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4335857424021676; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4914151256872978; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 290 
last prior star auc 0.44348027435485277 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4334758808576145; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49197321678749995; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 390 
last prior star auc 0.4412350996060321 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.433459959855685; count_not_improved_vanilla_star_anomaly= 50 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49274213305978876; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 490 
last prior star auc 0.4394538583924237 ; count_not_improved_prior_star_anomaly= 44 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4332978019492466; count_not_improved_vanilla_star_anomaly= 60 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4925189014424271; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 490 
last prior star auc 0.43867703286056214 ; count_not_improved_prior_star_anomaly= 54 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4328822342597295; count_not_improved_vanilla_star_anomaly= 70 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49457279508892854; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 670 
last prior star auc 0.43763646486962504 ; count_not_improved_prior_star_anomaly= 64 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43309703817519873; count_not_improved_vanilla_star_anomaly= 80 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49236259108308145; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 740 
last prior star auc 0.43675398561575757 ; count_not_improved_prior_star_anomaly= 74 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4329373760259733; count_not_improved_vanilla_star_anomaly= 90 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49304062321107256; count_not_improved_prior_anomaly= 46; iter_best_prior_anomaly= 740 
last prior star auc 0.4364149544807644 ; count_not_improved_prior_star_anomaly= 84 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4355099591563907 at iter 0
0.49484470000033753 at iter 740
0.45100138942541634 at iter 60
last anomaly aucs:
0.43273631083197217
0.4937917858481162
0.43601940107614157




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 120.24953413009644 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43262138543220485,first_prior_anomaly_auc= 0.4936023373791125, first_prior_star_anomaly_auc= 0.4359765150451961


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43262131309141616 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5378391878733689 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4331498047522111 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4326213432334114 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49533336805691197 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43365499665062146 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4326213130914161 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5392811869580167 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4333181719096859 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4326213251482142 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4812538129624083 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347852009072499 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4326213130914161 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.533338813148083 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43278608732304835 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43262130706301705 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5163662655128793 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344723993365867 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43262130706301705 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.44019209011347377 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4361411687088471 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4326213914606039 at iter 27
max_prior_anomaly= 0.5425089726691678 at iter 9
max_prior_star_anomaly= 0.4406038237411859 at iter 72
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4326213191198151
accuracies_anomaly['prior'][-1]= 0.47073048281689245
accuracies_anomaly['prior_star'][-1]= 0.4326692509207777



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.98938083648682 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4326212889778199
 first_prior_anomaly_auc= 0.49919418992543596
 first_prior_star_anomaly_auc= 0.43268229034795436


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4326787155073091; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49623863465924356; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.4326885056273899 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.435551995183068; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.48765179508844625; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.4356561538621059 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43614681731877064; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4867271592399201; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.4361687064357742 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4358044946778882; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.48415608320926884; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.43596257135815975 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4354828313606; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4792071895651788; count_not_improved_prior_anomaly= 49; iter_best_prior_anomaly= 10 
last prior star auc 0.435567198805509 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4353606417399599; count_not_improved_vanilla_star_anomaly= 43 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.47591766701920746; count_not_improved_prior_anomaly= 59; iter_best_prior_anomaly= 10 
last prior star auc 0.435371655625051 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4351852816395702; count_not_improved_vanilla_star_anomaly= 53 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.47550127946741744; count_not_improved_prior_anomaly= 69; iter_best_prior_anomaly= 10 
last prior star auc 0.4352027579684585 ; count_not_improved_prior_star_anomaly= 47 ; iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4352238995639779; count_not_improved_vanilla_star_anomaly= 63 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.47545472816984075; count_not_improved_prior_anomaly= 79; iter_best_prior_anomaly= 10 
last prior star auc 0.4352462830097048 ; count_not_improved_prior_star_anomaly= 57 ; iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43522014989975977; count_not_improved_vanilla_star_anomaly= 73 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.47551984090813737; count_not_improved_prior_anomaly= 89; iter_best_prior_anomaly= 10 
last prior star auc 0.4350706697165544 ; count_not_improved_prior_star_anomaly= 67 ; iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4361625936391227 at iter 270
0.5018314758630136 at iter 10
0.43620027113327636 at iter 330
last anomaly aucs:
0.43505429055629585
0.47534810990398446
0.4349655766356614




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 120.1884446144104 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43499212570514184,first_prior_anomaly_auc= 0.47495422033750356, first_prior_star_anomaly_auc= 0.4348423561587813


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43499208953474744 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4564246155931052 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4327686230509583 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43499208953474744 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.46618532914335487 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43105421266937993 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43499210761994467 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.45764355185556527 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4276623158504938 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43499210761994467 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4585113097589171 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4297979425315129 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4349921136483437 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4607759321231202 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42866820246161236 iter_best_prior_star_anomaly= 410
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4349920533643531 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.4648238694702098 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4311118984200289 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43499214981873807 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.46338656650843324 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4296794724330957 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43499226435832034 at iter 55
max_prior_anomaly= 0.5114717721419481 at iter 2
max_prior_star_anomaly= 0.4417094321296308 at iter 76
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4349921257051418
accuracies_anomaly['prior'][-1]= 0.4567750524591287
accuracies_anomaly['prior_star'][-1]= 0.4300041620067142



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.75698161125183 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4349921679039353
 first_prior_anomaly_auc= 0.45737954414693094
 first_prior_star_anomaly_auc= 0.4331082630542571


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43475258726831056; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4781805170340855; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 50 
last prior star auc 0.4579757708996156 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43440258444701974; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.48134166482197654; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 180 
last prior star auc 0.45856227384460907 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4345815013028576; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.496422374234333; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 300 
last prior star auc 0.4696433273579842 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4346741517680812; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4957511361120877; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 300 
last prior star auc 0.46945951544210596 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4351362225279827; count_not_improved_vanilla_star_anomaly= 48 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.488071148612576; count_not_improved_prior_anomaly= 44; iter_best_prior_anomaly= 440 
last prior star auc 0.4644789727029267 ; count_not_improved_prior_star_anomaly= 46 ; iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4352095700594015; count_not_improved_vanilla_star_anomaly= 58 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4727819711321671; count_not_improved_prior_anomaly= 54; iter_best_prior_anomaly= 440 
last prior star auc 0.4502132003613181 ; count_not_improved_prior_star_anomaly= 56 ; iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4351871685284775; count_not_improved_vanilla_star_anomaly= 68 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4951487664207562; count_not_improved_prior_anomaly= 64; iter_best_prior_anomaly= 440 
last prior star auc 0.46790420656864007 ; count_not_improved_prior_star_anomaly= 66 ; iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4354091582956317; count_not_improved_vanilla_star_anomaly= 78 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4809261031608585; count_not_improved_prior_anomaly= 74; iter_best_prior_anomaly= 440 
last prior star auc 0.4566860009481466 ; count_not_improved_prior_star_anomaly= 76 ; iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4366069107637789; count_not_improved_vanilla_star_anomaly= 88 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.48364119764516256; count_not_improved_prior_anomaly= 84; iter_best_prior_anomaly= 440 
last prior star auc 0.46134324064549204 ; count_not_improved_prior_star_anomaly= 86 ; iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4376733948422946 at iter 20
0.4999982819062666 at iter 440
0.4721260692571421 at iter 440
last anomaly aucs:
0.4351619939339837
0.4847046072401555
0.46004580859881194




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 120.86366295814514 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43642839178227927,first_prior_anomaly_auc= 0.48813061274094904, first_prior_star_anomaly_auc= 0.46316259942638577


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43642842192427467 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4818046277849395 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4361676514659379 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4364285364638568 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.48222602493635214 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4374003385066643 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4364285304354578 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4753321708168577 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4390610539377744 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.436428458094669 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4688719334136798 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43606736301909943 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.436428458094669 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4803995044173697 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44009810737205685 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4364284882366643 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4716620452959438 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4402225696991443 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43642840986747644 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.48330152147146954 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4373366183285516 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43642856660585216 at iter 35
max_prior_anomaly= 0.519601225018917 at iter 77
max_prior_star_anomaly= 0.46316259942638577 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.436428464123068
accuracies_anomaly['prior'][-1]= 0.5000956887783522
accuracies_anomaly['prior_star'][-1]= 0.43678263256811245



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.53836059570312 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43642848220826524
 first_prior_anomaly_auc= 0.4964024744890208
 first_prior_star_anomaly_auc= 0.43685019283642923


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4349028752569907; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48416949639718754; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4347403194762141 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4349415052381965; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49241435091745; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.43523514855663253 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4351501119594274; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49403965553245477; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43595117165552866 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4353845021434576; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.491462750039908; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.436215173335764 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43553790078605503; count_not_improved_vanilla_star_anomaly= 50 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49072488002280185; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.43641225978638243 ; count_not_improved_prior_star_anomaly= 50 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4356718096144766; count_not_improved_vanilla_star_anomaly= 60 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4906980898173588; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.43653007278930167 ; count_not_improved_prior_star_anomaly= 60 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43580142019436524; count_not_improved_vanilla_star_anomaly= 70 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49116228257373096; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.4367278645626107 ; count_not_improved_prior_star_anomaly= 70 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43582279689744824; count_not_improved_vanilla_star_anomaly= 80 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49188778231595665; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.4366393435507463 ; count_not_improved_prior_star_anomaly= 80 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43581259081783197; count_not_improved_vanilla_star_anomaly= 90 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49251286701496344; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.43661144411987546 ; count_not_improved_prior_star_anomaly= 90 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43642848220826524 at iter 0
0.4964024744890208 at iter 0
0.43685019283642923 at iter 0
last anomaly aucs:
0.435897536989051
0.4929699764024347
0.4366624624611591




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 121.69804334640503 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43589966501392075,first_prior_anomaly_auc= 0.49298101440112196, first_prior_star_anomaly_auc= 0.43666995576119627


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4358997373547096 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.44794888544546735 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43829225823346685 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4358997494115076 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.43774172674569173 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345937449813578 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4358997313263105 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4382359288726074 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43348016704934944 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4358997373547096 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4460123225299599 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4330895629603587 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4358997554399067 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4491114802902698 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4356900274364498 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4358998157238974 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4447185798635074 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347235906688099 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43589974941150766 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4399226206752868 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43415984493028514 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4358998579226908 at iter 71
max_prior_anomaly= 0.4969370849748664 at iter 1
max_prior_star_anomaly= 0.44235093818768967 at iter 9
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43589976749670484
accuracies_anomaly['prior'][-1]= 0.4525945325314116
accuracies_anomaly['prior_star'][-1]= 0.431368219919856



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.69136452674866 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43589974338310866
 first_prior_anomaly_auc= 0.4397471761773102
 first_prior_star_anomaly_auc= 0.43429076367277075


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43544032511879555; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4658292195538117; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 100 
last prior star auc 0.43703425191666917 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4356279891816762; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48456341610566384; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 200 
last prior star auc 0.43862409145997694 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43569668278901713; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.47829515909909676; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 260 
last prior star auc 0.4378857994549363 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43643281059879363; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4741024618052692; count_not_improved_prior_anomaly= 31; iter_best_prior_anomaly= 260 
last prior star auc 0.4371616922728946 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4363820153082755; count_not_improved_vanilla_star_anomaly= 42 ;iter_best_vanilla_star_anomaly= 460 
last prior auc 0.46149251586312934; count_not_improved_prior_anomaly= 41; iter_best_prior_anomaly= 260 
last prior star auc 0.4378296388892505 ; count_not_improved_prior_star_anomaly= 49 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43690471367756933; count_not_improved_vanilla_star_anomaly= 50 ;iter_best_vanilla_star_anomaly= 550 
last prior auc 0.47107660937758467; count_not_improved_prior_anomaly= 51; iter_best_prior_anomaly= 260 
last prior star auc 0.43692710918009436 ; count_not_improved_prior_star_anomaly= 59 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43680891035963504; count_not_improved_vanilla_star_anomaly= 60 ;iter_best_vanilla_star_anomaly= 550 
last prior auc 0.46940254707094564; count_not_improved_prior_anomaly= 61; iter_best_prior_anomaly= 260 
last prior star auc 0.4367893482046704 ; count_not_improved_prior_star_anomaly= 69 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.436846153809056; count_not_improved_vanilla_star_anomaly= 70 ;iter_best_vanilla_star_anomaly= 550 
last prior auc 0.4663777676982945; count_not_improved_prior_anomaly= 71; iter_best_prior_anomaly= 260 
last prior star auc 0.4360257248667603 ; count_not_improved_prior_star_anomaly= 79 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4366452574102287; count_not_improved_vanilla_star_anomaly= 80 ;iter_best_vanilla_star_anomaly= 550 
last prior auc 0.4653218152329446; count_not_improved_prior_anomaly= 81; iter_best_prior_anomaly= 260 
last prior star auc 0.4361218838602395 ; count_not_improved_prior_star_anomaly= 89 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4371413584828497 at iter 950
0.48958078030632957 at iter 260
0.44013146853248025 at iter 10
last anomaly aucs:
0.43648816938740376
0.4661472356896658
0.4358859443776498




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 121.74577713012695 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43736643479032505,first_prior_anomaly_auc= 0.4636014970202829, first_prior_star_anomaly_auc= 0.4363416913469324


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4373666337274942 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4966393001462731 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4359052593682527 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4373666578410904 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4834050531970047 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43483287348705263 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43736662167069607 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4942241004302348 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43646846857926064 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4373666698978885 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.48004419057650305 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4386361482581062 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.437366712096682 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4499474685305512 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43463651044432194 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4373665131595129 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4894770255300289 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43712437045428576 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43736652521631103 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.44528988521445906 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.438265112352479 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4373668085510671 at iter 37
max_prior_anomaly= 0.5222632937050492 at iter 3
max_prior_star_anomaly= 0.4427052452859125 at iter 25
last values
accuracies_anomaly['vanilla_star'][-1]= 0.437366706068283
accuracies_anomaly['prior'][-1]= 0.45288237652994734
accuracies_anomaly['prior_star'][-1]= 0.4357879286372587



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.36203265190125 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4373665734435035
 first_prior_anomaly_auc= 0.47753538187978983
 first_prior_star_anomaly_auc= 0.43749435741847553


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4375848798588293; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5029656106358321; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.43797671374122926 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.436815071383479; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5110555533853319; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 170 
last prior star auc 0.4389871939924351 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43679545497292294; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5095275772732248; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 170 
last prior star auc 0.4393135835745898 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4359563259367288; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5124354418744174; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 400 
last prior star auc 0.43973382327338206 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4353784134604024; count_not_improved_vanilla_star_anomaly= 49 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5141255457509672; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 480 
last prior star auc 0.44024891380305653 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43481525247658687; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5193758111210942; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 600 
last prior star auc 0.4404411112220337 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4344388090969989; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5213537228257856; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 690 
last prior star auc 0.44062910684686274 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4343668119269705; count_not_improved_vanilla_star_anomaly= 79 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5202395119118755; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 720 
last prior star auc 0.4407637149695759 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43447532311013304; count_not_improved_vanilla_star_anomaly= 89 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.518912450283793; count_not_improved_prior_anomaly= 43; iter_best_prior_anomaly= 720 
last prior star auc 0.44076239475018075 ; count_not_improved_prior_star_anomaly= 43 ; iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4381993545754826 at iter 10
0.5216790634665032 at iter 720
0.44084646680353545 at iter 990
last anomaly aucs:
0.434697373161278
0.5165030619444528
0.44084646680353545




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 121.54757976531982 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43470517390966756,first_prior_anomaly_auc= 0.5163260259491231, first_prior_star_anomaly_auc= 0.44086197787432857


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4347055356136114 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4833772863909132 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4317903585643536 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43470542710242827 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4715712395208339 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43889445912962455 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43470538490363486 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4588911652123757 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42864296155472886 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43470530050604794 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.46082361675972106 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4265745274096837 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4347053607900385 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4555764319015162 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4198568231108565 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4347053547616395 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.44368548105901134 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42546910590160975 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43470545121602455 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.45964444984589 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42770985580551707 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43470563206799645 at iter 71
max_prior_anomaly= 0.5209238196032928 at iter 1
max_prior_star_anomaly= 0.44086197787432857 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4347054331308273
accuracies_anomaly['prior'][-1]= 0.4593290681204272
accuracies_anomaly['prior_star'][-1]= 0.4260957700411715



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.66530203819275 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43470548135801984
 first_prior_anomaly_auc= 0.44963863967487155
 first_prior_star_anomaly_auc= 0.4286026255365878


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43959882330472977; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4773991521177283; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.45093426923023133 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43965521897797893; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4826074116031731; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.4525598873219874 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4395695976260647; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4711231968455558; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.44664818600649425 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44034478946177974; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.4828295581087032; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.45491759419614675 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4395769583013226; count_not_improved_vanilla_star_anomaly= 42 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.47277539414878766; count_not_improved_prior_anomaly= 49; iter_best_prior_anomaly= 10 
last prior star auc 0.448427407706416 ; count_not_improved_prior_star_anomaly= 49 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4392877699697953; count_not_improved_vanilla_star_anomaly= 52 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.4655226031205887; count_not_improved_prior_anomaly= 59; iter_best_prior_anomaly= 10 
last prior star auc 0.4440520559493306 ; count_not_improved_prior_star_anomaly= 59 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44004736633713026; count_not_improved_vanilla_star_anomaly= 61 ;iter_best_vanilla_star_anomaly= 640 
last prior auc 0.4776141971691602; count_not_improved_prior_anomaly= 69; iter_best_prior_anomaly= 10 
last prior star auc 0.4518356776571616 ; count_not_improved_prior_star_anomaly= 69 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4406735723183631; count_not_improved_vanilla_star_anomaly= 70 ;iter_best_vanilla_star_anomaly= 720 
last prior auc 0.47927487040147687; count_not_improved_prior_anomaly= 79; iter_best_prior_anomaly= 10 
last prior star auc 0.4530817658290086 ; count_not_improved_prior_star_anomaly= 79 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.440169616241761; count_not_improved_vanilla_star_anomaly= 79 ;iter_best_vanilla_star_anomaly= 810 
last prior auc 0.4677579515789342; count_not_improved_prior_anomaly= 89; iter_best_prior_anomaly= 10 
last prior star auc 0.4452938277874473 ; count_not_improved_prior_star_anomaly= 89 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4414148905797343 at iter 810
0.4924989293563261 at iter 10
0.4592952910004683 at iter 10
last anomaly aucs:
0.44129165804605597
0.4741573986059448
0.45030849126533207




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 121.89978265762329 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43954385636205884,first_prior_anomaly_auc= 0.4640665458093223, first_prior_star_anomaly_auc= 0.4437960298410577


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4395439709016411 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.46680551878232124 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4414126058164888 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4395440251572327 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.471777995523552 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43748511588270955 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43954392267444864 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.47850014878088887 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4376246492074584 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.439543952816444 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4633360666094692 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351905504603527 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4395438262200636 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.45695772500758375 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4381185137440265 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43954398898683833 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.46793941844757625 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43868326019679593 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43954401310043456 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4692041343725329 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43640385619808647 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4395441336684158 at iter 17
max_prior_anomaly= 0.48439762307458956 at iter 32
max_prior_star_anomaly= 0.449862142570191 at iter 18
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4395440251572327
accuracies_anomaly['prior'][-1]= 0.46463733874635343
accuracies_anomaly['prior_star'][-1]= 0.43682387284611335



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.208988904953 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43954386841885706
 first_prior_anomaly_auc= 0.4647135738809242
 first_prior_star_anomaly_auc= 0.4367690083862265


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4373310300026188; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4942743893352315; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 70 
last prior star auc 0.43540591501693493 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43823762285274453; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4710156924050371; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 70 
last prior star auc 0.43609517202398435 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4384799343531456; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4627028978273167; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 70 
last prior star auc 0.4365996103725117 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43874023459635536; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4624267549513653; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 70 
last prior star auc 0.4369510178107845 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4387492470529568; count_not_improved_vanilla_star_anomaly= 50 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.462671375328608; count_not_improved_prior_anomaly= 43; iter_best_prior_anomaly= 70 
last prior star auc 0.43706828222938876 ; count_not_improved_prior_star_anomaly= 42 ; iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43860524065610207; count_not_improved_vanilla_star_anomaly= 60 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4634574303394374; count_not_improved_prior_anomaly= 53; iter_best_prior_anomaly= 70 
last prior star auc 0.4371740806329723 ; count_not_improved_prior_star_anomaly= 49 ; iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.438948636352018; count_not_improved_vanilla_star_anomaly= 70 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4634835755061806; count_not_improved_prior_anomaly= 63; iter_best_prior_anomaly= 70 
last prior star auc 0.43745692106028444 ; count_not_improved_prior_star_anomaly= 58 ; iter_best_prior_star_anomaly= 650
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4388327946355929; count_not_improved_vanilla_star_anomaly= 80 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4635889820638248; count_not_improved_prior_anomaly= 73; iter_best_prior_anomaly= 70 
last prior star auc 0.43751982137612433 ; count_not_improved_prior_star_anomaly= 66 ; iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4388375269288586; count_not_improved_vanilla_star_anomaly= 90 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4642708060548275; count_not_improved_prior_anomaly= 83; iter_best_prior_anomaly= 70 
last prior star auc 0.43759300614076846 ; count_not_improved_prior_star_anomaly= 75 ; iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43954386841885706 at iter 0
0.49909643340620463 at iter 70
0.43777615493274963 at iter 930
last anomaly aucs:
0.4390016440649929
0.4641109027696394
0.43761287574408525




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 121.76189661026001 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43893173874943997,first_prior_anomaly_auc= 0.46416183671333616, first_prior_star_anomaly_auc= 0.4376327513758012


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43893156995426613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4379156701723013 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4361456719229484 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43893164229505494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45399364558511396 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4325740926415432 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4389316362666559 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47934507713698304 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43777062689080737 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43893155186906896 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4530694136393253 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4328991921462982 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4389317327210409 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.4715669231871037 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4330926977278723 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4389317086074446 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.45929738888334276 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4284630319278483 iter_best_prior_star_anomaly= 510
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4389314855566792 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.4679965315003142 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4302569870350838 iter_best_prior_star_anomaly= 510
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4389318231470269 at iter 44
max_prior_anomaly= 0.4890591851340643 at iter 47
max_prior_star_anomaly= 0.4675926528765832 at iter 51
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4389314192442895
accuracies_anomaly['prior'][-1]= 0.448896067506495
accuracies_anomaly['prior_star'][-1]= 0.430555778606321



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.73048424720764 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4389318171186278
 first_prior_anomaly_auc= 0.45990630541605837
 first_prior_star_anomaly_auc= 0.43070297402628094


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43835536954327403; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4867837176799441; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.4510471329175185 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.438014306837796; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4980887443037657; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.45611889136294387 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43898344432821695; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 240 
last prior auc 0.4908192485817588; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.4523691970027765 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43999187492374076; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4854077235366543; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.4477854073196339 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4402703025629377; count_not_improved_vanilla_star_anomaly= 45 ;iter_best_vanilla_star_anomaly= 500 
last prior auc 0.48933879433947797; count_not_improved_prior_anomaly= 49; iter_best_prior_anomaly= 10 
last prior star auc 0.4494395759093599 ; count_not_improved_prior_star_anomaly= 49 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44004499717629786; count_not_improved_vanilla_star_anomaly= 54 ;iter_best_vanilla_star_anomaly= 550 
last prior auc 0.48293474161558203; count_not_improved_prior_anomaly= 59; iter_best_prior_anomaly= 10 
last prior star auc 0.44817294898189985 ; count_not_improved_prior_star_anomaly= 59 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43984995435296226; count_not_improved_vanilla_star_anomaly= 64 ;iter_best_vanilla_star_anomaly= 550 
last prior auc 0.48671761025580185; count_not_improved_prior_anomaly= 69; iter_best_prior_anomaly= 10 
last prior star auc 0.449938395789959 ; count_not_improved_prior_star_anomaly= 69 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4402062930216699; count_not_improved_vanilla_star_anomaly= 74 ;iter_best_vanilla_star_anomaly= 550 
last prior auc 0.4805107705789047; count_not_improved_prior_anomaly= 79; iter_best_prior_anomaly= 10 
last prior star auc 0.4467000905224404 ; count_not_improved_prior_star_anomaly= 79 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44035280120413656; count_not_improved_vanilla_star_anomaly= 83 ;iter_best_vanilla_star_anomaly= 840 
last prior auc 0.4918225550380778; count_not_improved_prior_anomaly= 89; iter_best_prior_anomaly= 10 
last prior star auc 0.45236047390933 ; count_not_improved_prior_star_anomaly= 89 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44095773296507046 at iter 950
0.5085716721187508 at iter 10
0.4679166552127085 at iter 10
last anomaly aucs:
0.4403447593197844
0.49103273227783295
0.45058423023854616




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 121.91139626502991 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44032991740128735,first_prior_anomaly_auc= 0.48393544380350506, first_prior_star_anomaly_auc= 0.44781047340294444


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44032976669131074 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48828030994652083 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4382192422639966 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44032961598133413 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4925084783404444 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4407271647860473 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4403295918677379 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47900123533953626 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43789291296583244 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4403296762653248 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47748087912384696 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43675900727217837 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44032990534448924 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47903083477894337 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4363917391159666 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44032983903209955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48493957615049577 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43708583692746483 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4403296521517285 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.4994068537592373 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4361827224635993 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4403299475432827 at iter 65
max_prior_anomaly= 0.5086248365701014 at iter 72
max_prior_star_anomaly= 0.44781047340294444 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4403297968333061
accuracies_anomaly['prior'][-1]= 0.4738465381797803
accuracies_anomaly['prior_star'][-1]= 0.43719307009002567



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.33009624481201 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4403297486061135
 first_prior_anomaly_auc= 0.4731459960096821
 first_prior_star_anomaly_auc= 0.4371800849184406


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4402707848348628; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.47792410510827243; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 40 
last prior star auc 0.436326807229642 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4411142000627918; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.47131791413534196; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 40 
last prior star auc 0.43700894469739604 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44171007113993166; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.46951471146394125; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 40 
last prior star auc 0.43753328881963466 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4423292480078552; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.47046819320199135; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 40 
last prior star auc 0.4378913154400804 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44222532443638085; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 420 
last prior auc 0.4710835842353024; count_not_improved_prior_anomaly= 47; iter_best_prior_anomaly= 40 
last prior star auc 0.43808259654239967 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44184607785122787; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 420 
last prior auc 0.47059715271478103; count_not_improved_prior_anomaly= 57; iter_best_prior_anomaly= 40 
last prior star auc 0.4381803048344384 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4418471026790688; count_not_improved_vanilla_star_anomaly= 41 ;iter_best_vanilla_star_anomaly= 420 
last prior auc 0.4704311064909461; count_not_improved_prior_anomaly= 67; iter_best_prior_anomaly= 40 
last prior star auc 0.4382433679170531 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4416837873200101; count_not_improved_vanilla_star_anomaly= 51 ;iter_best_vanilla_star_anomaly= 420 
last prior auc 0.47070888306304404; count_not_improved_prior_anomaly= 77; iter_best_prior_anomaly= 40 
last prior star auc 0.4382378760455053 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 750
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.441741093281518; count_not_improved_vanilla_star_anomaly= 61 ;iter_best_vanilla_star_anomaly= 420 
last prior auc 0.4717235229096044; count_not_improved_prior_anomaly= 87; iter_best_prior_anomaly= 40 
last prior star auc 0.4380227224828902 ; count_not_improved_prior_star_anomaly= 49 ; iter_best_prior_star_anomaly= 750
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44241491758696205 at iter 420
0.48328308059873093 at iter 40
0.4382741489226768 at iter 750
last anomaly aucs:
0.44167760218256985
0.4714855277429337
0.4378382233295186




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 121.74251127243042 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4416736776947787,first_prior_anomaly_auc= 0.47145672405220307, first_prior_star_anomaly_auc= 0.4378522996413344


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4416740454271217 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.44190888774108167 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4362956826052715 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4416734365588162 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42989601252749554 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42969754557349127 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.441673418473619 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.43089791436683245 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4278136889510055 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4416737138651732 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.43025740902301834 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42370669137828015 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4416738766319479 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.42720782278821656 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4234089186064849 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4416735571267975 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.44014423668169905 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4350634296092778 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44167405748391986 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4599848433990718 iter_best_prior_anomaly= 670
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43849812806152244 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.44167422627909375 at iter 74
max_prior_anomaly= 0.4734504000204483 at iter 67
max_prior_star_anomaly= 0.44006411925813077 at iter 68
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44167352095640305
accuracies_anomaly['prior'][-1]= 0.42909852767203965
accuracies_anomaly['prior_star'][-1]= 0.42759238039294556



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.92540621757507 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4416739007455442
 first_prior_anomaly_auc= 0.42664348023818444
 first_prior_star_anomaly_auc= 0.4239521075041994


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4418067304905332; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.48848189961124056; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 100 
last prior star auc 0.4681502255344658 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43882100911542166; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.47440573850541035; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 100 
last prior star auc 0.4562799038735599 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44052688931232364; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4798270416137976; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 100 
last prior star auc 0.46015133572443756 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4402972555351555; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.47117048963621744; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 100 
last prior star auc 0.45352345457167265 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43930604204736007; count_not_improved_vanilla_star_anomaly= 48 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4720313570794384; count_not_improved_prior_anomaly= 47; iter_best_prior_anomaly= 100 
last prior star auc 0.45478984639156916 ; count_not_improved_prior_star_anomaly= 47 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4409008610482952; count_not_improved_vanilla_star_anomaly= 58 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4781130049929612; count_not_improved_prior_anomaly= 57; iter_best_prior_anomaly= 100 
last prior star auc 0.4573856026879908 ; count_not_improved_prior_star_anomaly= 57 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4405037462883147; count_not_improved_vanilla_star_anomaly= 68 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4768914704905043; count_not_improved_prior_anomaly= 67; iter_best_prior_anomaly= 100 
last prior star auc 0.45792988272593593 ; count_not_improved_prior_star_anomaly= 67 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44039367374979443; count_not_improved_vanilla_star_anomaly= 78 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.46915636533834515; count_not_improved_prior_anomaly= 77; iter_best_prior_anomaly= 100 
last prior star auc 0.45310045989450787 ; count_not_improved_prior_star_anomaly= 77 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4409484190885157; count_not_improved_vanilla_star_anomaly= 88 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4754672009275054; count_not_improved_prior_anomaly= 87; iter_best_prior_anomaly= 100 
last prior star auc 0.4562884461150344 ; count_not_improved_prior_star_anomaly= 87 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44202254114864636 at iter 40
0.48848189961124056 at iter 100
0.4681502255344658 at iter 100
last anomaly aucs:
0.4396937404480017
0.46847218424330817
0.4533546895398595




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 121.67410230636597 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44089377767939425,first_prior_anomaly_auc= 0.48962752451267627, first_prior_star_anomaly_auc= 0.46526454544183093


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44089383796338494 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.47836229135108 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4546993842352059 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4408937656225962 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4772164433988789 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4566536043315735 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4408937897361924 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.47693606858678406 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45506941942658835 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4408937897361924 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.47398654171965626 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4529494906967334 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4408938259065868 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.47327645056543965 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45390544407840006 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44089380179299054 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.47243338498465653 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4531604545219986 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44089380179299054 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.46878625780617394 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4483393991084721 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.44089401278695783 at iter 77
max_prior_anomaly= 0.48962752451267627 at iter 0
max_prior_star_anomaly= 0.46526454544183093 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4408938620769812
accuracies_anomaly['prior'][-1]= 0.47108795482462423
accuracies_anomaly['prior_star'][-1]= 0.4549440528396412



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.88979482650757 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.44089394647456814
 first_prior_anomaly_auc= 0.46807262195330734
 first_prior_star_anomaly_auc= 0.4503383981530914


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4416862891056219; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4719140022348481; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 20 
last prior star auc 0.452903994368993 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4420056194324721; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4758004327425984; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 140 
last prior star auc 0.45606963934258615 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44062902847767493; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.47541425349852107; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 140 
last prior star auc 0.4554809360319341 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4393253932083574; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4681337800618176; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 140 
last prior star auc 0.4482522465431954 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4393747477114992; count_not_improved_vanilla_star_anomaly= 48 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4701216386249656; count_not_improved_prior_anomaly= 47; iter_best_prior_anomaly= 440 
last prior star auc 0.4506652278083779 ; count_not_improved_prior_star_anomaly= 48 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43941245534764817; count_not_improved_vanilla_star_anomaly= 58 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.474727546504276; count_not_improved_prior_anomaly= 57; iter_best_prior_anomaly= 440 
last prior star auc 0.45199316958272384 ; count_not_improved_prior_star_anomaly= 58 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4408338131938989; count_not_improved_vanilla_star_anomaly= 68 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4718472015448134; count_not_improved_prior_anomaly= 65; iter_best_prior_anomaly= 650 
last prior star auc 0.450537365464218 ; count_not_improved_prior_star_anomaly= 67 ; iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4395644132028691; count_not_improved_vanilla_star_anomaly= 78 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4717808409279105; count_not_improved_prior_anomaly= 75; iter_best_prior_anomaly= 650 
last prior star auc 0.45109410620302975 ; count_not_improved_prior_star_anomaly= 77 ; iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44051066086204177; count_not_improved_vanilla_star_anomaly= 87 ;iter_best_vanilla_star_anomaly= 870 
last prior auc 0.47508944938532033; count_not_improved_prior_anomaly= 83; iter_best_prior_anomaly= 860 
last prior star auc 0.4529413764715925 ; count_not_improved_prior_star_anomaly= 86 ; iter_best_prior_star_anomaly= 860
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4424433113465563 at iter 870
0.48662342254881674 at iter 860
0.4588979893601168 at iter 860
last anomaly aucs:
0.43906051741025764
0.47792082565918137
0.4542123197327828




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 121.10099744796753 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43987595483812786,first_prior_anomaly_auc= 0.47533847049388017, first_prior_star_anomaly_auc= 0.4523390429506554


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4398759126393344 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.47852536557417613 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45357510589485794 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4398758885257381 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4846973309624845 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45014200496836543 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43987599703692126 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4778844623560238 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4516312486164824 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43987592469613246 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4774511229460642 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.448676627752145 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43987590661093534 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.47874482944212227 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4511649037216442 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4398759608665269 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4770922402929513 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4504131382446942 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.439875966894926 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.47916276629247184 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45283355855432234 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43987599703692126 at iter 30
max_prior_anomaly= 0.49048582988629474 at iter 1
max_prior_star_anomaly= 0.4535770048405633 at iter 9
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4398759367529307
accuracies_anomaly['prior'][-1]= 0.47923981526091636
accuracies_anomaly['prior_star'][-1]= 0.45187768354184354



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.66117453575134 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4398759668949259
 first_prior_anomaly_auc= 0.4798951444380303
 first_prior_star_anomaly_auc= 0.4529280476812607


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4382317692772528; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.48022005706241416; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 50 
last prior star auc 0.4514903227315496 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4399400608337807; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4807389334267012; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 130 
last prior star auc 0.4531372572423981 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4379317961397991; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.47021643520025613; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 130 
last prior star auc 0.44642922852406947 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4405186786327977; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.48313730185255116; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 390 
last prior star auc 0.4550512016046151 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4398123190576021; count_not_improved_vanilla_star_anomaly= 49 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.48671287796253615; count_not_improved_prior_anomaly= 44; iter_best_prior_anomaly= 390 
last prior star auc 0.45517540471054274 ; count_not_improved_prior_star_anomaly= 45 ; iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4392781124744939; count_not_improved_vanilla_star_anomaly= 58 ;iter_best_vanilla_star_anomaly= 590 
last prior auc 0.46936532773512085; count_not_improved_prior_anomaly= 53; iter_best_prior_anomaly= 520 
last prior star auc 0.4469150150058909 ; count_not_improved_prior_star_anomaly= 54 ; iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4397423715432557; count_not_improved_vanilla_star_anomaly= 68 ;iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4812967291353492; count_not_improved_prior_anomaly= 63; iter_best_prior_anomaly= 520 
last prior star auc 0.45576833995733823 ; count_not_improved_prior_star_anomaly= 64 ; iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4406101595886028; count_not_improved_vanilla_star_anomaly= 78 ;iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4787549089253583; count_not_improved_prior_anomaly= 73; iter_best_prior_anomaly= 520 
last prior star auc 0.4535336003672983 ; count_not_improved_prior_star_anomaly= 74 ; iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4392088401408427; count_not_improved_vanilla_star_anomaly= 87 ;iter_best_vanilla_star_anomaly= 880 
last prior auc 0.4811646107414496; count_not_improved_prior_anomaly= 83; iter_best_prior_anomaly= 520 
last prior star auc 0.4547762885220729 ; count_not_improved_prior_star_anomaly= 84 ; iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44104779724709536 at iter 880
0.4948623029256062 at iter 970
0.4610812524505442 at iter 970
last anomaly aucs:
0.43867524242604
0.47386366486152287
0.4497186063884633




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 121.23849201202393 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43994426262792863,first_prior_anomaly_auc= 0.48539277310697415, first_prior_star_anomaly_auc= 0.4561221044996453


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4399442505711305 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4822623098703219 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4530872275585611 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4399442626279287 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4807764963812727 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4523287163030577 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4399442626279287 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4774081826595271 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4504445040050272 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43994426262792863 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4823080413056259 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4506747526789 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4399442505711305 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.48176827051018095 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45128582135008166 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4399442505711305 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.47983178596386145 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45065649265813335 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43994426865632774 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4825939381312638 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45175639215266417 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43994428071312586 at iter 16
max_prior_anomaly= 0.4887012248260084 at iter 4
max_prior_star_anomaly= 0.4561221044996453 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43994424454273146
accuracies_anomaly['prior'][-1]= 0.4780164059263503
accuracies_anomaly['prior_star'][-1]= 0.4471825071291847



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.335120677948 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4399442385143324
 first_prior_anomaly_auc= 0.4698283389252763
 first_prior_star_anomaly_auc= 0.44541318406052705


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43861645347836214; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47859500564017016; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 60 
last prior star auc 0.4470152913959312 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43862874538405483; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48938006475947415; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 200 
last prior star auc 0.4519248979633175 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43839433711482745; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47911860224092473; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 200 
last prior star auc 0.44639249146016985 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4384039162409411; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.47302255248203656; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 200 
last prior star auc 0.44322911919302405 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43905895002650086; count_not_improved_vanilla_star_anomaly= 49 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.47864697646850596; count_not_improved_prior_anomaly= 46; iter_best_prior_anomaly= 200 
last prior star auc 0.4466551970346064 ; count_not_improved_prior_star_anomaly= 45 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4390797540316727; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.4824634293199146; count_not_improved_prior_anomaly= 56; iter_best_prior_anomaly= 200 
last prior star auc 0.44992498260204034 ; count_not_improved_prior_star_anomaly= 55 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4388900342847112; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.4784401662101963; count_not_improved_prior_anomaly= 66; iter_best_prior_anomaly= 200 
last prior star auc 0.44796433020387083 ; count_not_improved_prior_star_anomaly= 65 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4387583318503472; count_not_improved_vanilla_star_anomaly= 79 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.4667007452065788; count_not_improved_prior_anomaly= 76; iter_best_prior_anomaly= 200 
last prior star auc 0.44154934799247075 ; count_not_improved_prior_star_anomaly= 75 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4388924094739426; count_not_improved_vanilla_star_anomaly= 89 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.4759660208081046; count_not_improved_prior_anomaly= 86; iter_best_prior_anomaly= 200 
last prior star auc 0.44664954239628385 ; count_not_improved_prior_star_anomaly= 85 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43997002197713164 at iter 390
0.48938006475947415 at iter 200
0.4519248979633175 at iter 200
last anomaly aucs:
0.43866952750372673
0.48056122225067627
0.4469690294615096




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 121.19172739982605 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4398989109817658,first_prior_anomaly_auc= 0.4841929468695488, first_prior_star_anomaly_auc= 0.4513107970074063


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43989893509536204 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.48496589614081176 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44697635999477214 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43989895920895833 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.49586617605143724 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43945941657636123 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4398989833225545 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.485577193891158 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4506508681618061 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4398989833225546 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4842584996809771 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44562255036004017 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43989896523735733 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4804509809169822 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44369721835199005 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43989894715216016 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.49010960352907307 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45124412894215093 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4398989531805592 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.48982567196153015 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44778643817587394 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4398989833225546 at iter 40
max_prior_anomaly= 0.5078082356612117 at iter 19
max_prior_star_anomaly= 0.4544671281044447 at iter 72
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43989895318055927
accuracies_anomaly['prior'][-1]= 0.48742737587646895
accuracies_anomaly['prior_star'][-1]= 0.44870792720008834



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.60756802558899 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5044188345995383
accuracies_anomaly["prior"][-1]= 0.5017511173034827
accuracies_anomaly["prior_star"][-1]= 0.5044186838895617


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 2993.2717990875244 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012027263641357422 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5052965333329476
 first_prior_anomaly_auc= 0.5013193633624771
 first_prior_star_anomaly_auc= 0.5052963343957784


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4784637131369426; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48881575837983643; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.47846427377805556 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46852782033827517; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4822618758255892; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4685291345292713 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45756972205222135; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4787623660550012; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.45757408058474514 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4472167363790735; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4763887864061048; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.44722007611215525 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44107527469003177; count_not_improved_vanilla_star_anomaly= 50 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47501648767144167; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.4410794282569873 ; count_not_improved_prior_star_anomaly= 50 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4380404459761401; count_not_improved_vanilla_star_anomaly= 60 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47414340669171584; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.438043146698921 ; count_not_improved_prior_star_anomaly= 60 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43674913878290966; count_not_improved_vanilla_star_anomaly= 70 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47357521802308056; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.43675244837399607 ; count_not_improved_prior_star_anomaly= 70 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4363142500743904; count_not_improved_vanilla_star_anomaly= 80 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47308862976418353; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.43631749938148623 ; count_not_improved_prior_star_anomaly= 80 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43627365483508956; count_not_improved_vanilla_star_anomaly= 90 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4721282575660025; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.43628021976167086 ; count_not_improved_prior_star_anomaly= 90 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5052965333329476 at iter 0
0.5013193633624771 at iter 0
0.5052963343957784 at iter 0
last anomaly aucs:
0.4361431701373366
0.47136162002856014
0.43614778789102004




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 120.64347314834595 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43613480271943494,first_prior_anomaly_auc= 0.4712822260128796, first_prior_star_anomaly_auc= 0.43613645450077865


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4361347966910359 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4673289526163011 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4397120607527589 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.436134808747834 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4647387123050235 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4487376954346693 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43613480271943494 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4601499311074555 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4475775541482861 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43613480271943494 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.46011883059668135 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4475031215050356 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43613479066263683 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4610836939521654 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4473873762429956 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4361347966910359 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4600164502953674 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4448312265284282 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43613479669103583 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4640606078362436 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44816368936093665 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43613480874783406 at iter 9
max_prior_anomaly= 0.48631473837471473 at iter 6
max_prior_star_anomaly= 0.4498187260401279 at iter 21
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43613480874783395
accuracies_anomaly['prior'][-1]= 0.45731396119350726
accuracies_anomaly['prior_star'][-1]= 0.44454035627356203



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.0327000617981 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4361348027194349
 first_prior_anomaly_auc= 0.4584463417021981
 first_prior_star_anomaly_auc= 0.4438978495012585


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4362861275927542; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.46465373599180904; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 80 
last prior star auc 0.44297221293848765 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4366711554126101; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4618572701769311; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 80 
last prior star auc 0.44145227871073284 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4361417715487536; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4582920629133372; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 80 
last prior star auc 0.43985664587592394 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43552592838551274; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.45451439678151007; count_not_improved_prior_anomaly= 32; iter_best_prior_anomaly= 80 
last prior star auc 0.43811475202301015 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4354866051384144; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4521793627162326; count_not_improved_prior_anomaly= 42; iter_best_prior_anomaly= 80 
last prior star auc 0.43751517950884466 ; count_not_improved_prior_star_anomaly= 49 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43552759825205367; count_not_improved_vanilla_star_anomaly= 47 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.45014287908622974; count_not_improved_prior_anomaly= 52; iter_best_prior_anomaly= 80 
last prior star auc 0.4369077761042942 ; count_not_improved_prior_star_anomaly= 59 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4356268437858539; count_not_improved_vanilla_star_anomaly= 57 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4483038375823901; count_not_improved_prior_anomaly= 62; iter_best_prior_anomaly= 80 
last prior star auc 0.4365211869290805 ; count_not_improved_prior_star_anomaly= 69 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43561994126892495; count_not_improved_vanilla_star_anomaly= 67 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.44737707973739327; count_not_improved_prior_anomaly= 72; iter_best_prior_anomaly= 80 
last prior star auc 0.43620023496288196 ; count_not_improved_prior_star_anomaly= 79 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4357257336441094; count_not_improved_vanilla_star_anomaly= 77 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.44608135372764857; count_not_improved_prior_anomaly= 82; iter_best_prior_anomaly= 80 
last prior star auc 0.4358590336042255 ; count_not_improved_prior_star_anomaly= 89 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4366712699521924 at iter 210
0.46510294817650577 at iter 80
0.4445926104366538 at iter 10
last anomaly aucs:
0.43583505866114564
0.4448859402783384
0.43575219228760376




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 121.64010167121887 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4358494785917081,first_prior_anomaly_auc= 0.44470606490704934, first_prior_star_anomaly_auc= 0.43574230571313793


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43584952681890066 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4640423839858714 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43492007427952184 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4358494785917081 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.46882474913420136 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43591005797390814 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.435849472563309 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.46737056665504395 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4363957058025511 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4358494725633091 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4437318756182123 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43581510466024187 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4358495027053044 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.45210102969878746 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357408106701699 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4358494846201072 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.457179154133625 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4376877605172656 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4358495027053043 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.475332852025952 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4447497949138638 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43584954490409783 at iter 53
max_prior_anomaly= 0.5042878977718555 at iter 13
max_prior_star_anomaly= 0.4447497949138638 at iter 70
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43584944242131374
accuracies_anomaly['prior'][-1]= 0.45265919313977837
accuracies_anomaly['prior_star'][-1]= 0.4380376246853779



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.83410215377808 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43584950873370343
 first_prior_anomaly_auc= 0.4890897310321246
 first_prior_star_anomaly_auc= 0.43453247233326536


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4381347602795055; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4747087921547861; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.43698616940573004 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4372764609342861; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.478070149104011; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.43655351120486474 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4364538557399281; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.47385654532222754; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.4361075061284705 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4363412874441951; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.46685645272601795; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.4358295065056071 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43642176657170734; count_not_improved_vanilla_star_anomaly= 43 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4622886081584013; count_not_improved_prior_anomaly= 49; iter_best_prior_anomaly= 10 
last prior star auc 0.4359410861438935 ; count_not_improved_prior_star_anomaly= 43 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43607199885798004; count_not_improved_vanilla_star_anomaly= 53 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4609556386992354; count_not_improved_prior_anomaly= 59; iter_best_prior_anomaly= 10 
last prior star auc 0.43559515852037045 ; count_not_improved_prior_star_anomaly= 52 ; iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4359312839670146; count_not_improved_vanilla_star_anomaly= 63 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4631626597103764; count_not_improved_prior_anomaly= 69; iter_best_prior_anomaly= 10 
last prior star auc 0.4352376081434508 ; count_not_improved_prior_star_anomaly= 62 ; iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4360118113217193; count_not_improved_vanilla_star_anomaly= 73 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4613708507132078; count_not_improved_prior_anomaly= 79; iter_best_prior_anomaly= 10 
last prior star auc 0.4354010983260823 ; count_not_improved_prior_star_anomaly= 72 ; iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.435579804187953; count_not_improved_vanilla_star_anomaly= 83 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4604808540457068; count_not_improved_prior_anomaly= 89; iter_best_prior_anomaly= 10 
last prior star auc 0.4346767017808855 ; count_not_improved_prior_star_anomaly= 82 ; iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43825542471518225 at iter 70
0.4905522929859818 at iter 10
0.43740449207361976 at iter 540
last anomaly aucs:
0.43656700879037036
0.4612943985562707
0.4358635307899277




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 121.5928966999054 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43576419483014145,first_prior_anomaly_auc= 0.4598202319342143, first_prior_star_anomaly_auc= 0.4348140226831777


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4357642189437377 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4517432683279005 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349613205859218 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4357642008585405 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4587164441222868 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4374400897700962 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4357641767449442 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5154973139865128 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44178657152406126 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43576420688693956 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4639538087184154 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366038543654531 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4357641827733433 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4929041824550438 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4362267599187661 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43576415263134805 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4517582127291816 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4387229029490446 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43576419483014145 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5159963991166707 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47561331726403283 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43576426114253114 at iter 25
max_prior_anomaly= 0.5159963991166707 at iter 70
max_prior_star_anomaly= 0.47561331726403283 at iter 70
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43576423702893485
accuracies_anomaly['prior'][-1]= 0.48313100217552873
accuracies_anomaly['prior_star'][-1]= 0.43560405643738975



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.22106051445007 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4357641948301414
 first_prior_anomaly_auc= 0.46953975946205456
 first_prior_star_anomaly_auc= 0.43564020271818105


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.447332813203062; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.48304661061702353; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.4476811883566053 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.450645358205061; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4732970556334425; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 60 
last prior star auc 0.45010377888989683 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44259449153829794; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4645776153968206; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 60 
last prior star auc 0.4420858815376179 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4453919218970263; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4667858782581688; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 60 
last prior star auc 0.4452079351575751 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4433427364301943; count_not_improved_vanilla_star_anomaly= 46 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.46278100779399656; count_not_improved_prior_anomaly= 44; iter_best_prior_anomaly= 60 
last prior star auc 0.44317520119179044 ; count_not_improved_prior_star_anomaly= 46 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44866505322594097; count_not_improved_vanilla_star_anomaly= 56 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.46241267261115043; count_not_improved_prior_anomaly= 54; iter_best_prior_anomaly= 60 
last prior star auc 0.44885239778367114 ; count_not_improved_prior_star_anomaly= 56 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.453345032044558; count_not_improved_vanilla_star_anomaly= 66 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4633896952475478; count_not_improved_prior_anomaly= 64; iter_best_prior_anomaly= 60 
last prior star auc 0.45362779410268245 ; count_not_improved_prior_star_anomaly= 66 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4555451324535729; count_not_improved_vanilla_star_anomaly= 76 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.46405128190289074; count_not_improved_prior_anomaly= 74; iter_best_prior_anomaly= 60 
last prior star auc 0.4559906190876476 ; count_not_improved_prior_star_anomaly= 76 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44960926328622985; count_not_improved_vanilla_star_anomaly= 86 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4566745831603183; count_not_improved_prior_anomaly= 84; iter_best_prior_anomaly= 60 
last prior star auc 0.4498325431307839 ; count_not_improved_prior_star_anomaly= 86 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4647189210708944 at iter 60
0.49922689399036135 at iter 60
0.4650891853414413 at iter 60
last anomaly aucs:
0.4489470677625813
0.45828605259946975
0.449236659996846




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 122.18313646316528 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4459658918003645,first_prior_anomaly_auc= 0.45263670118286836, first_prior_star_anomaly_auc= 0.44613535009807


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44596591591396073 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4551321871176488 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44403164379009796 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44596586768676827 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.45108652850540554 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4446172243900345 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4459658797435664 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.44676639085535264 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43993304377726944 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44596582548797475 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.437128041749316 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43887380583442925 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4459658797435664 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4493351278671669 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44321439784250827 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4459658013743786 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4452278107892911 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4442645931867516 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44596595208435513 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4422764452604485 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44411248462155395 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.44596601236834577 at iter 2
max_prior_anomaly= 0.46756604352311215 at iter 68
max_prior_star_anomaly= 0.4480525437673829 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44596592194235984
accuracies_anomaly['prior'][-1]= 0.44291525059572645
accuracies_anomaly['prior_star'][-1]= 0.44106795621356737



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.74502968788147 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4459658375447729
 first_prior_anomaly_auc= 0.44453523816275614
 first_prior_star_anomaly_auc= 0.44162909165529707


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43691347294141025; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4954274894515073; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 50 
last prior star auc 0.44137187795240845 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4361313243331747; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5020697181940459; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 180 
last prior star auc 0.44046426027444174 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43604632993476306; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.503934289967924; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 260 
last prior star auc 0.4394061677274238 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4359124090495433; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5015327928029596; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 260 
last prior star auc 0.4400466971848341 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4354450152132679; count_not_improved_vanilla_star_anomaly= 50 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49823975570033363; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 260 
last prior star auc 0.4397245395388227 ; count_not_improved_prior_star_anomaly= 49 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.435400037327847; count_not_improved_vanilla_star_anomaly= 60 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.501326265879406; count_not_improved_prior_anomaly= 49; iter_best_prior_anomaly= 260 
last prior star auc 0.4382425118843859 ; count_not_improved_prior_star_anomaly= 59 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43553469367775255; count_not_improved_vanilla_star_anomaly= 70 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5054571178272299; count_not_improved_prior_anomaly= 59; iter_best_prior_anomaly= 260 
last prior star auc 0.439700956441682 ; count_not_improved_prior_star_anomaly= 69 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4353903195485549; count_not_improved_vanilla_star_anomaly= 80 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5066346570733136; count_not_improved_prior_anomaly= 69; iter_best_prior_anomaly= 260 
last prior star auc 0.43915993173923173 ; count_not_improved_prior_star_anomaly= 79 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4353024737173858; count_not_improved_vanilla_star_anomaly= 90 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5087299296509942; count_not_improved_prior_anomaly= 78; iter_best_prior_anomaly= 890 
last prior star auc 0.4408030683586695 ; count_not_improved_prior_star_anomaly= 89 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4459658375447729 at iter 0
0.5135303257409264 at iter 890
0.45236330122849133 at iter 10
last anomaly aucs:
0.4351639471352806
0.5073737629122279
0.4394249461905099




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 122.32915115356445 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43474495531509477,first_prior_anomaly_auc= 0.5124652884781862, first_prior_star_anomaly_auc= 0.4387830000593195


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4347449191447004 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.46890987012899327 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351639953624732 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4347449673718929 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.47590463362042984 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4424394712563521 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43474495531509477 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.44994875257955197 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44039823121948724 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43474494928669577 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4674565919096955 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44078227038189666 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4347449432582966 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4677578792381454 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44209277802614777 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4347449372298976 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.4743878884157801 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4401857120672634 iter_best_prior_star_anomaly= 510
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43474492517309943 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.4418882043038911 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366786607694455 iter_best_prior_star_anomaly= 510
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43474497942869106 at iter 56
max_prior_anomaly= 0.5124652884781862 at iter 0
max_prior_star_anomaly= 0.44390783253010946 at iter 51
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4347449010595032
accuracies_anomaly['prior'][-1]= 0.47917053087046707
accuracies_anomaly['prior_star'][-1]= 0.4355967681029207



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 79.12070679664612 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4347449131163013
 first_prior_anomaly_auc= 0.4661180100110006
 first_prior_star_anomaly_auc= 0.4365956436859272


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4347432794201548; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4860110577718362; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 70 
last prior star auc 0.43570503212172157 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43465390840402235; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48591334947979736; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 70 
last prior star auc 0.43385421715450884 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43464790411855403; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.487487774406697; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 70 
last prior star auc 0.43400656082726996 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4347373896742687; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.49014487569199994; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 400 
last prior star auc 0.4340617387639082 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43497621073161136; count_not_improved_vanilla_star_anomaly= 41 ;iter_best_vanilla_star_anomaly= 500 
last prior auc 0.49181597202629923; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 500 
last prior star auc 0.4343316301900296 ; count_not_improved_prior_star_anomaly= 50 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4349317392317119; count_not_improved_vanilla_star_anomaly= 51 ;iter_best_vanilla_star_anomaly= 500 
last prior auc 0.4930450540843851; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 600 
last prior star auc 0.43429498355211593 ; count_not_improved_prior_star_anomaly= 60 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43495687162741214; count_not_improved_vanilla_star_anomaly= 61 ;iter_best_vanilla_star_anomaly= 500 
last prior auc 0.49447378466269176; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 700 
last prior star auc 0.43419385715780756 ; count_not_improved_prior_star_anomaly= 70 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4349408541710975; count_not_improved_vanilla_star_anomaly= 71 ;iter_best_vanilla_star_anomaly= 500 
last prior auc 0.4955226115603474; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 800 
last prior star auc 0.43443081543983925 ; count_not_improved_prior_star_anomaly= 80 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43480381057516226; count_not_improved_vanilla_star_anomaly= 81 ;iter_best_vanilla_star_anomaly= 500 
last prior auc 0.49613692953862487; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 900 
last prior star auc 0.43449226291150456 ; count_not_improved_prior_star_anomaly= 90 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43497621073161136 at iter 500
0.4967473350859095 at iter 950
0.4365956436859272 at iter 0
last anomaly aucs:
0.4349284236122264
0.4966591396075946
0.43447814440089527




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 122.13583493232727 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4348703882144316,first_prior_anomaly_auc= 0.4967675724215693, first_prior_star_anomaly_auc= 0.43452488257884303


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43487037012923435 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4667580210260913 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4377256550337855 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43487035807243624 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4361890040554246 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43430524991572295 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4348703460156382 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.440781836337164 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43160308031901323 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43487029778844566 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4511732229123534 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358088471820128 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43487033998723906 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4512943334495609 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349234079842046 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43487031587364283 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.44560350664739506 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4341160968382735 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4348703460156381 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4691373819096907 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4342040089818323 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4348704364416241 at iter 58
max_prior_anomaly= 0.5475445366066094 at iter 55
max_prior_star_anomaly= 0.4557159893398614 at iter 55
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43487035204403723
accuracies_anomaly['prior'][-1]= 0.4481964778234489
accuracies_anomaly['prior_star'][-1]= 0.4327651024659046



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.54734826087952 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4348703460156381
 first_prior_anomaly_auc= 0.4458319226879523
 first_prior_star_anomaly_auc= 0.43198352052718114


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.436096914231314; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.47600809300517627; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 100 
last prior star auc 0.44428513797076374 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43637790394011344; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.47121769200089314; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 100 
last prior star auc 0.4444232847637278 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4362906247784563; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4722511585377322; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 100 
last prior star auc 0.44447918610825365 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4378998275395596; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.4778883506734204; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 390 
last prior star auc 0.448094181919722 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43781149943646525; count_not_improved_vanilla_star_anomaly= 44 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.4750789238005535; count_not_improved_prior_anomaly= 43; iter_best_prior_anomaly= 390 
last prior star auc 0.44687042896640927 ; count_not_improved_prior_star_anomaly= 41 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4376313949860117; count_not_improved_vanilla_star_anomaly= 54 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.4701298251908953; count_not_improved_prior_anomaly= 53; iter_best_prior_anomaly= 390 
last prior star auc 0.4448716650293535 ; count_not_improved_prior_star_anomaly= 51 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43749859538301794; count_not_improved_vanilla_star_anomaly= 64 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.46619714480552144; count_not_improved_prior_anomaly= 63; iter_best_prior_anomaly= 390 
last prior star auc 0.44223021346802227 ; count_not_improved_prior_star_anomaly= 61 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4373756160421004; count_not_improved_vanilla_star_anomaly= 74 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.4624283283635211; count_not_improved_prior_anomaly= 73; iter_best_prior_anomaly= 390 
last prior star auc 0.43993151859230617 ; count_not_improved_prior_star_anomaly= 71 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4379217347417603; count_not_improved_vanilla_star_anomaly= 82 ;iter_best_vanilla_star_anomaly= 890 
last prior auc 0.4644735411153696; count_not_improved_prior_anomaly= 83; iter_best_prior_anomaly= 390 
last prior star auc 0.44126280009973384 ; count_not_improved_prior_star_anomaly= 81 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43828891247198604 at iter 950
0.4787708781544804 at iter 390
0.44885073997392844 at iter 360
last anomaly aucs:
0.437968563345694
0.46316475156485176
0.4401982270237215




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 121.93724632263184 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4381032377807968,first_prior_anomaly_auc= 0.46763362187662616, first_prior_star_anomaly_auc= 0.4408135216026474


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43810338246237435 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4298503835749757 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4371701018895896 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4381032860079893 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.440544938339123 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4367798595045428 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43810324380919585 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.44343131169765027 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344433665666917 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43810332217838377 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4462115068634529 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357439514660825 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43810324983759497 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.44360790761984825 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43562507143652895 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43810334026358094 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.4465451787516777 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349077522318339 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43810364771193316 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.44408155893435264 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4372141152311602 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4381036537403323 at iter 52
max_prior_anomaly= 0.46763362187662616 at iter 0
max_prior_star_anomaly= 0.44917404904416114 at iter 47
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43810327395119114
accuracies_anomaly['prior'][-1]= 0.4459437555189994
accuracies_anomaly['prior_star'][-1]= 0.43639377671485047



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 79.13773703575134 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4381034608315622
 first_prior_anomaly_auc= 0.4497369628636149
 first_prior_star_anomaly_auc= 0.4448666554297308


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43768565660599207; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4715500436697228; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 30 
last prior star auc 0.44920461302741865 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43708854970704397; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.477741679724179; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 30 
last prior star auc 0.4404888320290289 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4370501548334016; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.49298467966775317; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 30 
last prior star auc 0.44450414368038105 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4369577334473424; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4788088570685872; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 30 
last prior star auc 0.43791745457842435 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.437092010008107; count_not_improved_vanilla_star_anomaly= 48 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.475661128497014; count_not_improved_prior_anomaly= 48; iter_best_prior_anomaly= 30 
last prior star auc 0.4378150561919134 ; count_not_improved_prior_star_anomaly= 48 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4377113858131996; count_not_improved_vanilla_star_anomaly= 58 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4899933458531125; count_not_improved_prior_anomaly= 58; iter_best_prior_anomaly= 30 
last prior star auc 0.44382339274441174 ; count_not_improved_prior_star_anomaly= 58 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43756818119342045; count_not_improved_vanilla_star_anomaly= 68 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48155718008853554; count_not_improved_prior_anomaly= 68; iter_best_prior_anomaly= 30 
last prior star auc 0.4417028129474579 ; count_not_improved_prior_star_anomaly= 68 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4380458655068991; count_not_improved_vanilla_star_anomaly= 78 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.47888763015916425; count_not_improved_prior_anomaly= 78; iter_best_prior_anomaly= 30 
last prior star auc 0.43957341963107166 ; count_not_improved_prior_star_anomaly= 78 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43824328351946623; count_not_improved_vanilla_star_anomaly= 88 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48861087118082835; count_not_improved_prior_anomaly= 88; iter_best_prior_anomaly= 30 
last prior star auc 0.44534592521216354 ; count_not_improved_prior_star_anomaly= 88 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4431554581848539 at iter 30
0.4965634749428387 at iter 30
0.47390392853887525 at iter 30
last anomaly aucs:
0.43769111230714547
0.4858769741198417
0.44446120339384404




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 122.39838433265686 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4369621402070586,first_prior_anomaly_auc= 0.48677268570965593, first_prior_star_anomaly_auc= 0.4386955038752961


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4369623753146222 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.48717707674730737 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43566608866376433 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43696247176900715 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.48774077425863954 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43580791880855685 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4369623029738333 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.47410288379320364 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349491010210179 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43696254410979596 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.46121936307311384 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43426117026176275 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43696254410979596 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.45619138286169547 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4341137457626383 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4369623512010259 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.46035533072038404 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43521485093698203 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43696221254784745 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.45397625365381267 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43556366013525794 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43696271290496974 at iter 48
max_prior_anomaly= 0.5090009725013371 at iter 2
max_prior_star_anomaly= 0.4386955038752961 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.436962369286223
accuracies_anomaly['prior'][-1]= 0.4507507285923109
accuracies_anomaly['prior_star'][-1]= 0.43561828345918213



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.31901955604553 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4369623451726268
 first_prior_anomaly_auc= 0.45176491630894144
 first_prior_star_anomaly_auc= 0.435717950980917


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4967936271623265; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5226991529858178; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 40 
last prior star auc 0.5017704081804892 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.49250398718314137; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5201054584018762; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 40 
last prior star auc 0.4991402719242023 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4848033283032372; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5141294039263686; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 40 
last prior star auc 0.49967939165254815 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4780209814812404; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5128924126087101; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 40 
last prior star auc 0.4950880182433824 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4758220144112497; count_not_improved_vanilla_star_anomaly= 48 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5131570231572511; count_not_improved_prior_anomaly= 46; iter_best_prior_anomaly= 40 
last prior star auc 0.4966542927747467 ; count_not_improved_prior_star_anomaly= 46 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.468639906362083; count_not_improved_vanilla_star_anomaly= 58 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5117108705056477; count_not_improved_prior_anomaly= 56; iter_best_prior_anomaly= 40 
last prior star auc 0.4939881247772506 ; count_not_improved_prior_star_anomaly= 56 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.45658225220024506; count_not_improved_vanilla_star_anomaly= 68 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.508533241074714; count_not_improved_prior_anomaly= 66; iter_best_prior_anomaly= 40 
last prior star auc 0.49676517311874163 ; count_not_improved_prior_star_anomaly= 66 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.45248239828041126; count_not_improved_vanilla_star_anomaly= 78 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5080365190769894; count_not_improved_prior_anomaly= 76; iter_best_prior_anomaly= 40 
last prior star auc 0.49473992039619596 ; count_not_improved_prior_star_anomaly= 76 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4491552283822815; count_not_improved_vanilla_star_anomaly= 88 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5058250852777332; count_not_improved_prior_anomaly= 86; iter_best_prior_anomaly= 40 
last prior star auc 0.4976709702201909 ; count_not_improved_prior_star_anomaly= 86 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5043840808789309 at iter 20
0.5384118857845045 at iter 40
0.5172209659038572 at iter 40
last anomaly aucs:
0.44932204624119665
0.4991906512551851
0.49455223824811834




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 122.4283881187439 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4503808923380977,first_prior_anomaly_auc= 0.5064937010463855, first_prior_star_anomaly_auc= 0.4949740573874654


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45038081999730895 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5058748376552132 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4700277101391403 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4503809405652902 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4979497053077401 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47310168727655744 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45038107921846865 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5154326413213479 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.482181396698077 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4503809887924827 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5224625081805376 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49145092834934234 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4503809827640836 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5311753533485828 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49710947910291636 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.45038083808250606 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5330740217475702 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5001095902665951 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4503807777985155 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.533718511863166 iter_best_prior_anomaly= 670
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5023589065255732 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.45038107921846865 at iter 30
max_prior_anomaly= 0.5345792285964103 at iter 75
max_prior_star_anomaly= 0.5040493901912642 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4503808923380977
accuracies_anomaly['prior'][-1]= 0.5341688332732903
accuracies_anomaly['prior_star'][-1]= 0.5040493901912642



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.06142711639404 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.45038081396890983
 first_prior_anomaly_auc= 0.5343713151410718
 first_prior_star_anomaly_auc= 0.5036948238718816


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4419117210886421; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5111019780865282; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.48844892426835734 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44206877294107266; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5116307169116849; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4896061900083867 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4411574477976811; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49880822167532585; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.48602932382100184 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44225582813564757; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5003585390343662; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.48553127557548303 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4417431610223972; count_not_improved_vanilla_star_anomaly= 50 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4976853720655562; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.48318029639467985 ; count_not_improved_prior_star_anomaly= 50 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44258742022619524; count_not_improved_vanilla_star_anomaly= 60 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5083837006075179; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.4897964221692688 ; count_not_improved_prior_star_anomaly= 60 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.442245965674778; count_not_improved_vanilla_star_anomaly= 70 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5011917481826789; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.48535815803954535 ; count_not_improved_prior_star_anomaly= 70 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4424000575832679; count_not_improved_vanilla_star_anomaly= 80 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5038460040636232; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.48669859668515214 ; count_not_improved_prior_star_anomaly= 80 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4423751904371265; count_not_improved_vanilla_star_anomaly= 90 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5111101465672607; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.4910336787364861 ; count_not_improved_prior_star_anomaly= 90 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.45038081396890983 at iter 0
0.5343713151410718 at iter 0
0.5036948238718816 at iter 0
last anomaly aucs:
0.4416662868775256
0.5056912307049031
0.4869679334985597




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 122.2860918045044 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44147200966087125,first_prior_anomaly_auc= 0.505582478385778, first_prior_star_anomaly_auc= 0.4868587652198991


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44147213625725157 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4915781034560089 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47157295158616824 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4414721603708478 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5122550480608087 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.485487684221847 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44147197349047684 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5130245068890134 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.485921530017328 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4414720699448619 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5135400616054158 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48592473109723133 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4414720759732609 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5126245768666697 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48600349815940924 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44147211214365534 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5117724264884962 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4856601627474839 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4414721663992469 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5114215616061392 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4863602708728495 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.44147220256964126 at iter 16
max_prior_anomaly= 0.5137063730788095 at iter 38
max_prior_star_anomaly= 0.4868587652198991 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44147205788806365
accuracies_anomaly['prior'][-1]= 0.5118596212525663
accuracies_anomaly['prior_star'][-1]= 0.48628000273930455



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.11176466941833 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.44147196746207773
 first_prior_anomaly_auc= 0.511946309631115
 first_prior_star_anomaly_auc= 0.4865084127514626


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44124135105586204; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5051801550890057; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.48600835102065615 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4424761239226648; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5004096779436311; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.48417144357008546 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44288083446546667; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5009742616296258; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4853415558285215 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44204491253757505; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5054398283787127; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4875173437041088 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44204907816132866; count_not_improved_vanilla_star_anomaly= 46 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5016133382428616; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.4855524231994016 ; count_not_improved_prior_star_anomaly= 46 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44282017671407886; count_not_improved_vanilla_star_anomaly= 56 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.49344785965308247; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.4789478056386269 ; count_not_improved_prior_star_anomaly= 56 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44211174336960507; count_not_improved_vanilla_star_anomaly= 65 ;iter_best_vanilla_star_anomaly= 640 
last prior auc 0.49110009963737966; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.4762078801785756 ; count_not_improved_prior_star_anomaly= 66 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4427631480589278; count_not_improved_vanilla_star_anomaly= 75 ;iter_best_vanilla_star_anomaly= 640 
last prior auc 0.48872273415387085; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.47432146148648746 ; count_not_improved_prior_star_anomaly= 76 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44334372508764086; count_not_improved_vanilla_star_anomaly= 84 ;iter_best_vanilla_star_anomaly= 880 
last prior auc 0.4958490011425022; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.48021344993703946 ; count_not_improved_prior_star_anomaly= 86 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44441224676504043 at iter 880
0.511946309631115 at iter 0
0.4911063691724069 at iter 290
last anomaly aucs:
0.4414447793822965
0.47943561163413495
0.4689025878229232




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 122.34839797019958 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44341501693497865,first_prior_anomaly_auc= 0.4795858694808198, first_prior_star_anomaly_auc= 0.46792384106439344


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4434149204805936 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4739288921394017 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4497191308591819 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4434149867929833 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4766331596189859 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4534083603767316 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44341494459418984 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4751208091172543 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610224755596645 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4434150229633777 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.48475817559424345 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4680236653245039 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4434149084237955 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.48893819516483816 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46958459869429703 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44341498076458424 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4890646830340113 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4701447153365848 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44341501090657964 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.48931098533459305 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4707361917108066 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4434150711905703 at iter 46
max_prior_anomaly= 0.48983355107910753 at iter 77
max_prior_star_anomaly= 0.47122242429415884 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4434148481398048
accuracies_anomaly['prior'][-1]= 0.4896780786672319
accuracies_anomaly['prior_star'][-1]= 0.47122242429415884



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.90984892845154 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4434148963669973
 first_prior_anomaly_auc= 0.4897350892371857
 first_prior_star_anomaly_auc= 0.47124233006787014


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4432966432909464; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48719484243935074; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.4646824070577603 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4492059875024053; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4869818349868026; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.46670101045613765 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 253


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 254 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5625756805218568 at iter 250
0.5068867526653964 at iter 10
0.5618982150633778 at iter 250
last anomaly aucs:
0.5625756805218568
0.48970265042181915
0.5618982150633778




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 31.12584638595581 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 11:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 11 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5052965333329476
accuracies_anomaly["prior"][-1]= 0.5013193633624771
accuracies_anomaly["prior_star"][-1]= 0.5052963343957784


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 2236.3638558387756 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.012061357498168945 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5072417349443145
 first_prior_anomaly_auc= 0.503587433970945
 first_prior_star_anomaly_auc= 0.50724150586515


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.47983096610158865; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49492317167096134; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.47983149057230723 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4689544923388693; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.490887869848311; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.46895909803575464 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45949718811354034; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48718200194934314; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.45950444027761506 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4514228408324206; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48482295074219234; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4514305873252186 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4453285091672659; count_not_improved_vanilla_star_anomaly= 50 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4825365055733755; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.44533659927881053 ; count_not_improved_prior_star_anomaly= 50 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44089697875929756; count_not_improved_vanilla_star_anomaly= 60 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4808011284198505; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.4409044479457386 ; count_not_improved_prior_star_anomaly= 60 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4384668768407717; count_not_improved_vanilla_star_anomaly= 70 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4791588659182771; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.43847189246879337 ; count_not_improved_prior_star_anomaly= 70 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43688825614812304; count_not_improved_vanilla_star_anomaly= 80 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47788250312632774; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.43689324163414944 ; count_not_improved_prior_star_anomaly= 80 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4361323250474194; count_not_improved_vanilla_star_anomaly= 90 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47668521484490856; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.4361357552064871 ; count_not_improved_prior_star_anomaly= 90 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5072417349443145 at iter 0
0.503587433970945 at iter 0
0.50724150586515 at iter 0
last anomaly aucs:
0.435731020550089
0.4758381222935502
0.43573469184511937




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 122.17295908927917 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4357253719401655,first_prior_anomaly_auc= 0.47578439117268756, first_prior_star_anomaly_auc= 0.43572812089013896


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43572538399696364 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4753784749500728 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357264449951989 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43572537194016553 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.49038269000669876 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43572089886805954 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4357253839969636 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5171570467885753 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357130559208766 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4357253719401655 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5112272120486959 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43568662741937736 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43572537796856453 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4815335125938079 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43576499057881796 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4357253719401655 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4769742042392667 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4362272904178838 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4357253779685646 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.47413719744067934 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4393367929109885 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43572538399696364 at iter 4
max_prior_anomaly= 0.5171570467885753 at iter 30
max_prior_star_anomaly= 0.442401004041921 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4357253659117664
accuracies_anomaly['prior'][-1]= 0.47020502344082693
accuracies_anomaly['prior_star'][-1]= 0.442401004041921



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.17590165138245 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43572537796856453
 first_prior_anomaly_auc= 0.46987865797226835
 first_prior_star_anomaly_auc= 0.4426986562457349


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43567329862904564; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4791753294761224; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.44069824655573453 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4357353489406174; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4857947226430045; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.4396254628001962 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4357589621797534; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.48995698254995496; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.4388425666704766 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4357767700705901; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4943990023722956; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.4382051900657771 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43584282323914086; count_not_improved_vanilla_star_anomaly= 44 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4977260758160402; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 500 
last prior star auc 0.4378466691166081 ; count_not_improved_prior_star_anomaly= 50 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4358469225505047; count_not_improved_vanilla_star_anomaly= 54 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4990100765896044; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 600 
last prior star auc 0.4373939122332614 ; count_not_improved_prior_star_anomaly= 60 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4357117477582795; count_not_improved_vanilla_star_anomaly= 64 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5003237431149654; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 700 
last prior star auc 0.43711980092779473 ; count_not_improved_prior_star_anomaly= 70 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43565323008855955; count_not_improved_vanilla_star_anomaly= 74 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5015476648634519; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 800 
last prior star auc 0.43705983644229934 ; count_not_improved_prior_star_anomaly= 80 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43558381910172994; count_not_improved_vanilla_star_anomaly= 84 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5019630215590019; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 900 
last prior star auc 0.4369821002363614 ; count_not_improved_prior_star_anomaly= 90 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4358845518174658 at iter 250
0.5027402329084036 at iter 990
0.4426986562457349 at iter 0
last anomaly aucs:
0.43551047157031114
0.5027402329084036
0.4369625923369885




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 122.13598084449768 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4355061431797828,first_prior_anomaly_auc= 0.5029039702553968, first_prior_star_anomaly_auc= 0.4369657934168918


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43550614317978276 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5232048150993552 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43619452606896775 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43550613715138364 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.511195858345161 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43687870113560573 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43550614317978276 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4829285444213436 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4388913545041063 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43550613715138375 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48463710725582937 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4393456546576135 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43550613715138375 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4843523256840183 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44058840309637864 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43550613715138364 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48424811274938884 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4423094326601299 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43550613715138364 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4862057871184204 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4445194437572069 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43550614920818187 at iter 3
max_prior_anomaly= 0.5244074987979372 at iter 6
max_prior_star_anomaly= 0.446642567538566 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4355061492081818
accuracies_anomaly['prior'][-1]= 0.4872670144329519
accuracies_anomaly['prior_star'][-1]= 0.446642567538566



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.98803520202637 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4355061371513837
 first_prior_anomaly_auc= 0.48401227574958317
 first_prior_star_anomaly_auc= 0.4446456603484222


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43520567571360574; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4771250227270645; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4387503261363894 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43528540129123483; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4569275468418664; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.433421329874479 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4358362040569679; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4467534961097535; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4314870276086209 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43622410139477863; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4415726718684516; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43146563282034067 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4367604842299492; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 480 
last prior auc 0.43945212221349306; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.4318251544837544 ; count_not_improved_prior_star_anomaly= 50 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.437077728730723; count_not_improved_vanilla_star_anomaly= 47 ;iter_best_vanilla_star_anomaly= 600 
last prior auc 0.4361861887930614; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.43119084030577964 ; count_not_improved_prior_star_anomaly= 60 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4370509204400828; count_not_improved_vanilla_star_anomaly= 54 ;iter_best_vanilla_star_anomaly= 670 
last prior auc 0.42974838306280294; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.43063252012641307 ; count_not_improved_prior_star_anomaly= 70 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4372345876743835; count_not_improved_vanilla_star_anomaly= 62 ;iter_best_vanilla_star_anomaly= 730 
last prior auc 0.42734402240828273; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.4303251019161146 ; count_not_improved_prior_star_anomaly= 80 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4369589692691507; count_not_improved_vanilla_star_anomaly= 70 ;iter_best_vanilla_star_anomaly= 860 
last prior auc 0.4308362920715943; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.43266549522816045 ; count_not_improved_prior_star_anomaly= 90 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.437428406732709 at iter 860
0.48401227574958317 at iter 0
0.4446456603484222 at iter 0
last anomaly aucs:
0.43689475476231465
0.4290000959721131
0.4324581183003387




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 122.39930486679077 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43644215461734376,first_prior_anomaly_auc= 0.42744674029994423, first_prior_star_anomaly_auc= 0.4322580176501879


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4364421003617522 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44471404047901175 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4356808642698716 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4364420702197569 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44720856186994185 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357622536856426 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43644210639015124 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44490459817344336 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357792055438122 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43644208227655495 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.43941826069594736 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357876573593008 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4364421847593391 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.43891434078973957 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349376169207998 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.436442088304954 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4322161504186844 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4340481326672193 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4364422510717288 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.43421628883072694 iter_best_prior_anomaly= 610
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43483011248028114 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43644235958291194 at iter 47
max_prior_anomaly= 0.496085694174975 at iter 75
max_prior_star_anomaly= 0.4612775672660824 at iter 61
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43644218475933905
accuracies_anomaly['prior'][-1]= 0.44138177055527344
accuracies_anomaly['prior_star'][-1]= 0.43474846384335036



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.7927577495575 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43644218475933905
 first_prior_anomaly_auc= 0.4487158666016564
 first_prior_star_anomaly_auc= 0.4352205296889008


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43646952354909696; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.44446586937472; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 90 
last prior star auc 0.43858380969742744 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43623068440655716; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4460937360593271; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 90 
last prior star auc 0.4379632161557237 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4360380951416409; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4518071994999805; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 210 
last prior star auc 0.4386223613094455 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4359331286571283; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.45642206558030096; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 330 
last prior star auc 0.43906643126974 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43585254704683196; count_not_improved_vanilla_star_anomaly= 48 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.45638321857672876; count_not_improved_prior_anomaly= 43; iter_best_prior_anomaly= 450 
last prior star auc 0.4387009475196514 ; count_not_improved_prior_star_anomaly= 48 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4359743870203263; count_not_improved_vanilla_star_anomaly= 58 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4583480968826425; count_not_improved_prior_anomaly= 52; iter_best_prior_anomaly= 570 
last prior star auc 0.4383768065303477 ; count_not_improved_prior_star_anomaly= 58 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43608418225248957; count_not_improved_vanilla_star_anomaly= 68 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4591167539337715; count_not_improved_prior_anomaly= 62; iter_best_prior_anomaly= 570 
last prior star auc 0.43887362498245736 ; count_not_improved_prior_star_anomaly= 68 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4361409034592883; count_not_improved_vanilla_star_anomaly= 78 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4603561746962531; count_not_improved_prior_anomaly= 72; iter_best_prior_anomaly= 570 
last prior star auc 0.43866288420795757 ; count_not_improved_prior_star_anomaly= 78 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43632636715651024; count_not_improved_vanilla_star_anomaly= 88 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4610755676702263; count_not_improved_prior_anomaly= 81; iter_best_prior_anomaly= 890 
last prior star auc 0.4390506006937964 ; count_not_improved_prior_star_anomaly= 88 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4380783826914535 at iter 20
0.49121719526081026 at iter 970
0.45218943014267055 at iter 30
last anomaly aucs:
0.43610739158888834
0.48918129035711755
0.44812854379439016




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 122.24509906768799 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43619157818182525,first_prior_anomaly_auc= 0.50696129381983, first_prior_star_anomaly_auc= 0.46506626536819773


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43619127676187197 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4995533197429105 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4356076553916313 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4361913611594589 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5105809435553762 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43566583547100357 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4361911742790878 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5115979284491727 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4356999742949064 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43619105973950567 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5042253410747622 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43566516029030844 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4361910235691112 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5011545891308448 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43570548425165145 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4361907402343552 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.5076142658929096 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45380713897485386 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4361913008754682 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.5090006529961867 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4510406885589185 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4361916746362102 at iter 55
max_prior_anomaly= 0.5120210979499102 at iter 24
max_prior_star_anomaly= 0.46506626536819773 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4361910295975103
accuracies_anomaly['prior'][-1]= 0.508503647663706
accuracies_anomaly['prior_star'][-1]= 0.4527627670641069



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.85922002792358 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43619045689959923
 first_prior_anomaly_auc= 0.5049349620138518
 first_prior_star_anomaly_auc= 0.46028551583081706


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4402559067459714; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.47942533924212893; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4619912212041462 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44089431420691105; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4718659317807071; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.45463116687139116 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43992726857096554; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4818203920484934; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4609442751669987 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44024850387192016; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.48436479241328384; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.46189257851025234 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44042959095142126; count_not_improved_vanilla_star_anomaly= 48 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4789345733026802; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.45882312870053277 ; count_not_improved_prior_star_anomaly= 48 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4401818659486602; count_not_improved_vanilla_star_anomaly= 58 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4751492390472428; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.4572373944969879 ; count_not_improved_prior_star_anomaly= 58 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43981737688441724; count_not_improved_vanilla_star_anomaly= 68 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.48066637561555986; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.4617142102387294 ; count_not_improved_prior_star_anomaly= 68 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44139509331720617; count_not_improved_vanilla_star_anomaly= 78 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.48228591708105883; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.46140611684773564 ; count_not_improved_prior_star_anomaly= 78 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4417231768794981; count_not_improved_vanilla_star_anomaly= 88 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.49005082060979427; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.4657862491252793 ; count_not_improved_prior_star_anomaly= 88 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44993155355702075 at iter 20
0.5049349620138518 at iter 0
0.47283456288560655 at iter 60
last anomaly aucs:
0.44047588302783813
0.47843033389132195
0.45795544916636893




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 122.4341447353363 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43913944121081117,first_prior_anomaly_auc= 0.49269382749808416, first_prior_star_anomaly_auc= 0.462312384164312


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43913935681322425 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.47472509294585674 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4393597430262274 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4391393387280271 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4748676645837342 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43934308053121296 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4391392724156374 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.47553954774467944 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43929502213387006 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43913933872802713 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.47621417382719905 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43937287287939 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4391393146144308 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.47738074138698516 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4396973454306423 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4391393869552196 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.48838560799298203 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45055034460740406 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4391393809268205 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.489312564775148 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45382029294161275 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43913952560839814 at iter 47
max_prior_anomaly= 0.49269382749808416 at iter 0
max_prior_star_anomaly= 0.462312384164312 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.439139332699628
accuracies_anomaly['prior'][-1]= 0.4892959444789269
accuracies_anomaly['prior_star'][-1]= 0.4539726667563692



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.59778571128845 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43913944121081117
 first_prior_anomaly_auc= 0.4890922087041402
 first_prior_star_anomaly_auc= 0.45359902658234624


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44388962676493443; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4789557631253921; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 30 
last prior star auc 0.4592525375943022 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44302223056552653; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4789684046782306; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 30 
last prior star auc 0.46069198063774675 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44616175448597284; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4904584669829406; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 30 
last prior star auc 0.46796989200484773 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44696480958216445; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 310 
last prior auc 0.49508880796365984; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 30 
last prior star auc 0.4697949114524632 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4412978552402944; count_not_improved_vanilla_star_anomaly= 44 ;iter_best_vanilla_star_anomaly= 310 
last prior auc 0.47981922278021083; count_not_improved_prior_anomaly= 49; iter_best_prior_anomaly= 30 
last prior star auc 0.4575952101234665 ; count_not_improved_prior_star_anomaly= 47 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4435022840398376; count_not_improved_vanilla_star_anomaly= 54 ;iter_best_vanilla_star_anomaly= 310 
last prior auc 0.48530256414337175; count_not_improved_prior_anomaly= 59; iter_best_prior_anomaly= 30 
last prior star auc 0.46474443928413484 ; count_not_improved_prior_star_anomaly= 57 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4454884667080456; count_not_improved_vanilla_star_anomaly= 64 ;iter_best_vanilla_star_anomaly= 310 
last prior auc 0.49054540855425; count_not_improved_prior_anomaly= 69; iter_best_prior_anomaly= 30 
last prior star auc 0.4687792347212637 ; count_not_improved_prior_star_anomaly= 67 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4440126483046454; count_not_improved_vanilla_star_anomaly= 74 ;iter_best_vanilla_star_anomaly= 310 
last prior auc 0.48959375342111644; count_not_improved_prior_anomaly= 79; iter_best_prior_anomaly= 30 
last prior star auc 0.469001875555517 ; count_not_improved_prior_star_anomaly= 77 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4468927822701408; count_not_improved_vanilla_star_anomaly= 84 ;iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4927570834894689; count_not_improved_prior_anomaly= 89; iter_best_prior_anomaly= 30 
last prior star auc 0.47128373311264565 ; count_not_improved_prior_star_anomaly= 87 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4483435707606248 at iter 310
0.49864799285658823 at iter 930
0.4739879945638308 at iter 30
last anomaly aucs:
0.44594909668057053
0.4886957329544605
0.46751321666210915




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 122.4299783706665 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4438826398504186,first_prior_anomaly_auc= 0.48105415841378835, first_prior_star_anomaly_auc= 0.4615089854493738


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44388221183408494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.485718137861288 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4451707158217504 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44388183807334297 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4870560566360858 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44533483898628373 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4438814462274037 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.48623724933313844 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4456080038330973 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44388150048299535 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.48487986485776113 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4460613575279513 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4438813316878215 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4843849574081549 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44710616951182985 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4438804937403516 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.4814227347325971 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4562175461136358 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4438814462274038 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.4814553483715365 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4591464859979581 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4438830256679587 at iter 53
max_prior_anomaly= 0.4870715013944893 at iter 21
max_prior_star_anomaly= 0.4615089854493738 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4438812352334365
accuracies_anomaly['prior'][-1]= 0.48271733343171686
accuracies_anomaly['prior_star'][-1]= 0.45932676527198446



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.90430521965027 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4438813859434131
 first_prior_anomaly_auc= 0.48276682658803705
 first_prior_star_anomaly_auc= 0.45919865576346297


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44512764893883294; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48619931261782506; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 40 
last prior star auc 0.465335481613624 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4416732436500461; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48284128937328286; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 130 
last prior star auc 0.46264348795453536 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4423180351855951; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.49308997168581525; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 240 
last prior star auc 0.4637044017923154 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44160382663481745; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4809935187475977; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 240 
last prior star auc 0.458788145900761 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44343762343147086; count_not_improved_vanilla_star_anomaly= 47 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.49477958123364196; count_not_improved_prior_anomaly= 45; iter_best_prior_anomaly= 240 
last prior star auc 0.46654026319508046 ; count_not_improved_prior_star_anomaly= 46 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44472924410145265; count_not_improved_vanilla_star_anomaly= 57 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4849931625897809; count_not_improved_prior_anomaly= 55; iter_best_prior_anomaly= 240 
last prior star auc 0.4610653796758072 ; count_not_improved_prior_star_anomaly= 56 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44085021646775363; count_not_improved_vanilla_star_anomaly= 66 ;iter_best_vanilla_star_anomaly= 610 
last prior auc 0.47295252659850234; count_not_improved_prior_anomaly= 64; iter_best_prior_anomaly= 610 
last prior star auc 0.45224597652589626 ; count_not_improved_prior_star_anomaly= 65 ; iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4399020517776784; count_not_improved_vanilla_star_anomaly= 76 ;iter_best_vanilla_star_anomaly= 610 
last prior auc 0.48001442837032116; count_not_improved_prior_anomaly= 74; iter_best_prior_anomaly= 610 
last prior star auc 0.45601211635871186 ; count_not_improved_prior_star_anomaly= 75 ; iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44291592577642164; count_not_improved_vanilla_star_anomaly= 86 ;iter_best_vanilla_star_anomaly= 610 
last prior auc 0.48839243816912215; count_not_improved_prior_anomaly= 84; iter_best_prior_anomaly= 610 
last prior star auc 0.4641271432767194 ; count_not_improved_prior_star_anomaly= 85 ; iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44557919411396757 at iter 610
0.5021677821616295 at iter 610
0.47224703511277205 at iter 610
last anomaly aucs:
0.4439957929008609
0.48478955943977364
0.463234958300358




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 122.02534055709839 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4435973639498842,first_prior_anomaly_auc= 0.4867305893989879, first_prior_star_anomaly_auc= 0.46035975556529746


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4435983043801383 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4921937778240759 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4440366533897206 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44359826218134485 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4916800798545854 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44416690297990996 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44359811749976735 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.49022859809820885 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44433792866137223 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4435984731753121 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4893289318786083 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44473026290089457 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4435982621813449 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.48837100118204846 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44567505771589266 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.443598183812157 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.48269176699128397 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4529241834774603 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44359812955656547 iter_best_vanilla_star_anomaly= 620 
last prior auc 0.48458194740438837 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45784962062079004 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.44359991999108767 at iter 62
max_prior_anomaly= 0.49227889279046877 at iter 12
max_prior_star_anomaly= 0.46035975556529746 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44359790047740105
accuracies_anomaly['prior'][-1]= 0.48491223736073796
accuracies_anomaly['prior_star'][-1]= 0.45798135319714944



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.94671607017517 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4435971830979123
 first_prior_anomaly_auc= 0.48533725155158935
 first_prior_star_anomaly_auc= 0.45793214940398425


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.441849827515446; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47513729678869593; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.4579709059815704 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44035693065749576; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48058165852350526; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.45844218813524257 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4414547925531428; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48576433348331993; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.46560508367659037 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44072820167068644; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4751897498889569; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.45791175532994877 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44130591520984375; count_not_improved_vanilla_star_anomaly= 50 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4797523618061855; count_not_improved_prior_anomaly= 48; iter_best_prior_anomaly= 20 
last prior star auc 0.4600984787214393 ; count_not_improved_prior_star_anomaly= 46 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4409861026110684; count_not_improved_vanilla_star_anomaly= 60 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4837666667148939; count_not_improved_prior_anomaly= 58; iter_best_prior_anomaly= 20 
last prior star auc 0.46172045566016034 ; count_not_improved_prior_star_anomaly= 56 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.440098674041569; count_not_improved_vanilla_star_anomaly= 70 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4874892875348622; count_not_improved_prior_anomaly= 68; iter_best_prior_anomaly= 20 
last prior star auc 0.4635161770883218 ; count_not_improved_prior_star_anomaly= 66 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.441518193226105; count_not_improved_vanilla_star_anomaly= 80 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47945997842315413; count_not_improved_prior_anomaly= 78; iter_best_prior_anomaly= 20 
last prior star auc 0.460456511370284 ; count_not_improved_prior_star_anomaly= 76 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4414033160535302; count_not_improved_vanilla_star_anomaly= 90 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47781343575824475; count_not_improved_prior_anomaly= 87; iter_best_prior_anomaly= 860 
last prior star auc 0.45930963256184293 ; count_not_improved_prior_star_anomaly= 85 ; iter_best_prior_star_anomaly= 860
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4435971830979123 at iter 0
0.49982632785134834 at iter 860
0.4739238765113799 at iter 860
last anomaly aucs:
0.4409858855887021
0.4890785724654561
0.4651627860656208




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 121.12488079071045 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44032675249177844,first_prior_anomaly_auc= 0.475512432005687, first_prior_star_anomaly_auc= 0.4561892608652248


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44032637270263736 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4772251604639263 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4398097811015959 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44032661383859995 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.476149477048438 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4398508586128219 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4403265595830084 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47536903447713763 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43989064001824923 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4403262702198533 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4749422057381678 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.440024657357854 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44032669823618686 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4739493525258269 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4406640775898364 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4403264932706187 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4745454165117368 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4490373189249773 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44032602908389074 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4810916249139748 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45074987858804283 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.44032675249177844 at iter 0
max_prior_anomaly= 0.4866963601490991 at iter 1
max_prior_star_anomaly= 0.4561892608652248 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4403263184470458
accuracies_anomaly['prior'][-1]= 0.4820392832185285
accuracies_anomaly['prior_star'][-1]= 0.4514764574137011



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.77985763549805 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4403264571002243
 first_prior_anomaly_auc= 0.4770985761403681
 first_prior_star_anomaly_auc= 0.4532449545916869


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4395271215262556; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4893143853516654; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 50 
last prior star auc 0.46442241426290287 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4393410489607281; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.48474866278051953; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 50 
last prior star auc 0.459080119352656 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44062433838320264; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4876424028427036; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 50 
last prior star auc 0.4614140200789093 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4415464603893189; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.49081712055688903; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 50 
last prior star auc 0.46586064559813534 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4400242293415204; count_not_improved_vanilla_star_anomaly= 45 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4910759438423279; count_not_improved_prior_anomaly= 48; iter_best_prior_anomaly= 50 
last prior star auc 0.46331830694582493 ; count_not_improved_prior_star_anomaly= 48 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4398305067375799; count_not_improved_vanilla_star_anomaly= 54 ;iter_best_vanilla_star_anomaly= 510 
last prior auc 0.4843507824138578; count_not_improved_prior_anomaly= 58; iter_best_prior_anomaly= 50 
last prior star auc 0.46137868160359274 ; count_not_improved_prior_star_anomaly= 58 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44003282583858644; count_not_improved_vanilla_star_anomaly= 64 ;iter_best_vanilla_star_anomaly= 510 
last prior auc 0.48654811578770196; count_not_improved_prior_anomaly= 68; iter_best_prior_anomaly= 50 
last prior star auc 0.46211965624621715 ; count_not_improved_prior_star_anomaly= 68 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4398385908207255; count_not_improved_vanilla_star_anomaly= 74 ;iter_best_vanilla_star_anomaly= 510 
last prior auc 0.48119869530976084; count_not_improved_prior_anomaly= 78; iter_best_prior_anomaly= 50 
last prior star auc 0.45739497082013714 ; count_not_improved_prior_star_anomaly= 78 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4410583469454584; count_not_improved_vanilla_star_anomaly= 83 ;iter_best_vanilla_star_anomaly= 890 
last prior auc 0.48284466527675896; count_not_improved_prior_anomaly= 88; iter_best_prior_anomaly= 50 
last prior star auc 0.461468221414899 ; count_not_improved_prior_star_anomaly= 88 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4419190817638999 at iter 890
0.5003834302941038 at iter 50
0.471268734455773 at iter 50
last anomaly aucs:
0.44076080928122674
0.4927345372769673
0.4658818113072511




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 120.82088303565979 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44116631557270514,first_prior_anomaly_auc= 0.4876851200784753, first_prior_star_anomaly_auc= 0.462397330335531


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44116415740584003 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.49416371998520386 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44029157678323666 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44116484464333344 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4906768758810506 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4401764162759058 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4411664361406864 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4886918808074583 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4401259224053409 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4411642779738213 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.48680605892687745 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44036779383261015 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4411649169841222 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.48504391568150573 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44140634833825976 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4411651942904791 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4850607047729006 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4545870932458299 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44116614677753135 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4894249944177025 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.459580886406153 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.44116723188936297 at iter 14
max_prior_anomaly= 0.4942656300713907 at iter 9
max_prior_star_anomaly= 0.462397330335531 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4411647059901549
accuracies_anomaly['prior'][-1]= 0.4882053407757537
accuracies_anomaly['prior_star'][-1]= 0.45853503753763525



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.38107085227966 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.44116636379989765
 first_prior_anomaly_auc= 0.49006306428829444
 first_prior_star_anomaly_auc= 0.45920013272123383


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4415604161331534; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.49878854498077907; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 100 
last prior star auc 0.46663846581584256 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.440347610752542; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.48453717448453576; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 100 
last prior star auc 0.4562589793004067 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43986556187814047; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4822116532329822; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 100 
last prior star auc 0.4538852248279375 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44064569700108847; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.47601649056507317; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 100 
last prior star auc 0.45170178088553803 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44037124810527417; count_not_improved_vanilla_star_anomaly= 47 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4832679071182854; count_not_improved_prior_anomaly= 47; iter_best_prior_anomaly= 100 
last prior star auc 0.45638067459232345 ; count_not_improved_prior_star_anomaly= 47 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4398924063391751; count_not_improved_vanilla_star_anomaly= 57 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.47572562031020693; count_not_improved_prior_anomaly= 57; iter_best_prior_anomaly= 100 
last prior star auc 0.45213077381977207 ; count_not_improved_prior_star_anomaly= 57 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4405513284421314; count_not_improved_vanilla_star_anomaly= 67 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4857220804342762; count_not_improved_prior_anomaly= 67; iter_best_prior_anomaly= 100 
last prior star auc 0.45632722680621685 ; count_not_improved_prior_star_anomaly= 67 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44115592864111686; count_not_improved_vanilla_star_anomaly= 77 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4866557287394039; count_not_improved_prior_anomaly= 77; iter_best_prior_anomaly= 100 
last prior star auc 0.4579746315321924 ; count_not_improved_prior_star_anomaly= 77 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44062013658905463; count_not_improved_vanilla_star_anomaly= 87 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4803509155209092; count_not_improved_prior_anomaly= 87; iter_best_prior_anomaly= 100 
last prior star auc 0.45487391844492386 ; count_not_improved_prior_star_anomaly= 87 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4418274802401136 at iter 140
0.49878854498077907 at iter 100
0.46663846581584256 at iter 100
last anomaly aucs:
0.44000609591713413
0.47204940610623775
0.45108051819153816




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 120.74360060691833 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44104443942881644,first_prior_anomaly_auc= 0.486119406188224, first_prior_star_anomaly_auc= 0.45878645192062384


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44104459013879305 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.48454872489714346 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43961405104076695 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44104565716542743 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4784343427766999 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43954435671918124 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4410443610596286 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4755379924177208 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4394433810348494 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44104500006992947 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.47404197284905514 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4394009893326273 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4410436738221352 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.47578926211913175 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43936621752682276 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44104433091763323 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4811296098564807 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45017276788879196 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.441044216378051 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.48586403114705 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4566729253505755 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.44104585610259667 at iter 77
max_prior_anomaly= 0.48684967439410975 at iter 77
max_prior_star_anomaly= 0.4628378073699831 at iter 71
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44104401744088195
accuracies_anomaly['prior'][-1]= 0.48557986447194357
accuracies_anomaly['prior_star'][-1]= 0.4541450789696164



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.91099715232849 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4410447649623659
 first_prior_anomaly_auc= 0.48600180417927197
 first_prior_star_anomaly_auc= 0.4549794877693428


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44097184544728063; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.487098544792693; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 40 
last prior star auc 0.4592389736964069 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44023243818841307; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.47289375573602166; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 130 
last prior star auc 0.4495229185264278 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4405770154505457; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.48164225285613493; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 290 
last prior star auc 0.4533066673129111 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44087191870438613; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4787580376644728; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 310 
last prior star auc 0.4523257021035255 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4407632085840544; count_not_improved_vanilla_star_anomaly= 44 ;iter_best_vanilla_star_anomaly= 490 
last prior auc 0.48521172822626657; count_not_improved_prior_anomaly= 44; iter_best_prior_anomaly= 490 
last prior star auc 0.4538515441623636 ; count_not_improved_prior_star_anomaly= 47 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4409554421734259; count_not_improved_vanilla_star_anomaly= 54 ;iter_best_vanilla_star_anomaly= 490 
last prior auc 0.48783552863513674; count_not_improved_prior_anomaly= 54; iter_best_prior_anomaly= 490 
last prior star auc 0.45931156164954356 ; count_not_improved_prior_star_anomaly= 57 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4406732166428184; count_not_improved_vanilla_star_anomaly= 64 ;iter_best_vanilla_star_anomaly= 490 
last prior auc 0.48891854258388756; count_not_improved_prior_anomaly= 64; iter_best_prior_anomaly= 490 
last prior star auc 0.45723449483703793 ; count_not_improved_prior_star_anomaly= 67 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44039403545373823; count_not_improved_vanilla_star_anomaly= 74 ;iter_best_vanilla_star_anomaly= 490 
last prior auc 0.48410307549629394; count_not_improved_prior_anomaly= 74; iter_best_prior_anomaly= 490 
last prior star auc 0.45382274650003207 ; count_not_improved_prior_star_anomaly= 77 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44067199890620723; count_not_improved_vanilla_star_anomaly= 84 ;iter_best_vanilla_star_anomaly= 490 
last prior auc 0.4837926310296651; count_not_improved_prior_anomaly= 84; iter_best_prior_anomaly= 490 
last prior star auc 0.4563435155404894 ; count_not_improved_prior_star_anomaly= 87 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44169250438505747 at iter 980
0.4952671099227931 at iter 490
0.4609853466498258 at iter 130
last anomaly aucs:
0.4411210965513217
0.4869489862402997
0.4554521082276073




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 120.70500469207764 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44167279754851535,first_prior_anomaly_auc= 0.4882262110933153, first_prior_star_anomaly_auc= 0.4560069801627089


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4416730266276798 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4829234745377303 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4400675373604004 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44167222485060426 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4785461334089536 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4399381860016715 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4416727794633182 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4737380149398197 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4397676546489326 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44167249612856213 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.46692280731452185 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4395887257362966 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44167250818536025 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4770638887321505 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.441312100347284 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44167270712252943 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.48522977122466693 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4507412640057796 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44167278549171723 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4860751215686955 iter_best_prior_anomaly= 650
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44889451217953635 iter_best_prior_star_anomaly= 650
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4416731049968677 at iter 32
max_prior_anomaly= 0.49694748999165184 at iter 65
max_prior_star_anomaly= 0.4593752094868675 at iter 65
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44167229116299395
accuracies_anomaly['prior'][-1]= 0.48236182668208005
accuracies_anomaly['prior_star'][-1]= 0.44287810962908947



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.42168045043945 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.44167250818536025
 first_prior_anomaly_auc= 0.48512899447750424
 first_prior_star_anomaly_auc= 0.44601065266341905


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43965403741176234; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.480879395124906; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 50 
last prior star auc 0.44579986366172675 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44043155620951624; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4798339260455294; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 50 
last prior star auc 0.4458024498449254 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44103182801797336; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48936843597767854; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 260 
last prior star auc 0.447623562889947 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4407819327915491; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48518746994843076; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 260 
last prior star auc 0.4464510935274767 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44059926627149304; count_not_improved_vanilla_star_anomaly= 50 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4853714144890884; count_not_improved_prior_anomaly= 47; iter_best_prior_anomaly= 260 
last prior star auc 0.447031134028673 ; count_not_improved_prior_star_anomaly= 48 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4408589998451907; count_not_improved_vanilla_star_anomaly= 60 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4789454967617852; count_not_improved_prior_anomaly= 57; iter_best_prior_anomaly= 260 
last prior star auc 0.44503692153291097 ; count_not_improved_prior_star_anomaly= 58 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4408795627144; count_not_improved_vanilla_star_anomaly= 70 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4780111009351735; count_not_improved_prior_anomaly= 65; iter_best_prior_anomaly= 640 
last prior star auc 0.4454749691225399 ; count_not_improved_prior_star_anomaly= 68 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44096169965165494; count_not_improved_vanilla_star_anomaly= 80 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48409350239857935; count_not_improved_prior_anomaly= 75; iter_best_prior_anomaly= 640 
last prior star auc 0.4460545032382149 ; count_not_improved_prior_star_anomaly= 78 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44083066636958723; count_not_improved_vanilla_star_anomaly= 90 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4768372932681108; count_not_improved_prior_anomaly= 85; iter_best_prior_anomaly= 640 
last prior star auc 0.44561751061842214 ; count_not_improved_prior_star_anomaly= 88 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44167250818536025 at iter 0
0.49242538891613735 at iter 640
0.45184186279460187 at iter 30
last anomaly aucs:
0.4409355424281138
0.47671538095382776
0.4455492510558138




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 120.79926204681396 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44194188116916217,first_prior_anomaly_auc= 0.47699258482801465, first_prior_star_anomaly_auc= 0.446061140505585


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4419407056313446 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5001026033520792 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4392871671298888 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4419410191080959 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4917642664475223 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4392326462887487 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44194226698670236 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.48295840308191046 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43920144329519045 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4419411336476781 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4791624769293168 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4389745403827985 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4419422187595098 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4739408102843523 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4419843210985769 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44194233932749105 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4852405620589925 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4447904866075497 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.441940934710509 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.47537426712752573 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4418216025510256 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4419428336562144 at iter 27
max_prior_anomaly= 0.5024408867244525 at iter 6
max_prior_star_anomaly= 0.4547195854004714 at iter 69
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44194276734382465
accuracies_anomaly['prior'][-1]= 0.482256438209633
accuracies_anomaly['prior_star'][-1]= 0.444026242344536



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.62495636940002 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4419420801063313
 first_prior_anomaly_auc= 0.4863179032842236
 first_prior_star_anomaly_auc= 0.4430055017581223


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4419406453473539; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5074444941184528; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 100 
last prior star auc 0.44529645014104047 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4412406095627771; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4922786998816987; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 100 
last prior star auc 0.43880468421075475 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44127765407502895; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.49571724445254667; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 100 
last prior star auc 0.44122341054024583 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4407718291947168; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4938123426889264; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 100 
last prior star auc 0.44066217261573204 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4410896524218008; count_not_improved_vanilla_star_anomaly= 48 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4939680622651637; count_not_improved_prior_anomaly= 44; iter_best_prior_anomaly= 100 
last prior star auc 0.44104231743234573 ; count_not_improved_prior_star_anomaly= 49 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4409739855289486; count_not_improved_vanilla_star_anomaly= 58 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.494645172048098; count_not_improved_prior_anomaly= 54; iter_best_prior_anomaly= 100 
last prior star auc 0.4404524626974723 ; count_not_improved_prior_star_anomaly= 59 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4411129039569929; count_not_improved_vanilla_star_anomaly= 68 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4981219547542125; count_not_improved_prior_anomaly= 64; iter_best_prior_anomaly= 100 
last prior star auc 0.4414031412299574 ; count_not_improved_prior_star_anomaly= 69 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4412242967149083; count_not_improved_vanilla_star_anomaly= 78 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4927334280515394; count_not_improved_prior_anomaly= 74; iter_best_prior_anomaly= 100 
last prior star auc 0.44060172585831137 ; count_not_improved_prior_star_anomaly= 79 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.441256753615472; count_not_improved_vanilla_star_anomaly= 88 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4966717691036349; count_not_improved_prior_anomaly= 84; iter_best_prior_anomaly= 100 
last prior star auc 0.44073028749676274 ; count_not_improved_prior_star_anomaly= 89 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4421758373084597 at iter 70
0.5074444941184528 at iter 100
0.4582910621990925 at iter 10
last anomaly aucs:
0.4412594663950511
0.4974883338421302
0.4408946578256578




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 120.74463415145874 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4412590504355157,first_prior_anomaly_auc= 0.48154932508455434, first_prior_star_anomaly_auc= 0.43820787270336087


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44125992455338 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5161111617496632 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43937600161850454 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4412588695835437 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5130838082506117 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4392448236548592 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4412594061110605 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5078036721631198 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43920738729666814 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4412592554010839 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5006518929896471 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4387390289165424 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44125921923068945 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4732222371726519 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4374320539141431 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4412591348331026 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4606126529344559 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43608288011829166 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4412599546953754 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.493724002529034 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366928757344399 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4412604731376949 at iter 1
max_prior_anomaly= 0.5179195488442595 at iter 7
max_prior_star_anomaly= 0.43940764468519455 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44125882738475025
accuracies_anomaly['prior'][-1]= 0.47907227399411334
accuracies_anomaly['prior_star'][-1]= 0.4379228560239863



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.07781887054443 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4412598039853987
 first_prior_anomaly_auc= 0.5139313047047074
 first_prior_star_anomaly_auc= 0.43960112615317243


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4409135508283261; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5336987447426332; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.4369606572208887 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44060291948132624; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5379969329916919; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 60 
last prior star auc 0.43705460982031036 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4404895916073111; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5342709121546511; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 60 
last prior star auc 0.43740935096326583 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.440546994023204; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5300026428501499; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 60 
last prior star auc 0.4366472286967228 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4407920303599822; count_not_improved_vanilla_star_anomaly= 49 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5348318667444089; count_not_improved_prior_anomaly= 44; iter_best_prior_anomaly= 60 
last prior star auc 0.43647248952143675 ; count_not_improved_prior_star_anomaly= 50 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44061613976047487; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5333214332735798; count_not_improved_prior_anomaly= 54; iter_best_prior_anomaly= 60 
last prior star auc 0.43662816689888057 ; count_not_improved_prior_star_anomaly= 60 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44083491639092776; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5296841323855725; count_not_improved_prior_anomaly= 64; iter_best_prior_anomaly= 60 
last prior star auc 0.4369565398243276 ; count_not_improved_prior_star_anomaly= 70 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4415732325095647; count_not_improved_vanilla_star_anomaly= 79 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5328655054523252; count_not_improved_prior_anomaly= 74; iter_best_prior_anomaly= 60 
last prior star auc 0.4369869591260075 ; count_not_improved_prior_star_anomaly= 80 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4416945841827348; count_not_improved_vanilla_star_anomaly= 88 ;iter_best_vanilla_star_anomaly= 830 
last prior auc 0.5337992924106314; count_not_improved_prior_anomaly= 84; iter_best_prior_anomaly= 60 
last prior star auc 0.4368836142808433 ; count_not_improved_prior_star_anomaly= 90 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4419633965254237 at iter 960
0.5444593587037302 at iter 60
0.43960112615317243 at iter 0
last anomaly aucs:
0.44152475212428727
0.5332033610495007
0.4367867379078755




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 120.46658778190613 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.441323301112746,first_prior_anomaly_auc= 0.5298916238529765, first_prior_star_anomaly_auc= 0.43701444259734296


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4413226922444405 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5314559331262457 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43647793919419114 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4413234578511217 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5248061327144821 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43598279060862233 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44132330111274604 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5127806581468508 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43532076990854685 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44132408480462443 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5188696004232418 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4350239013966113 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44132393409464776 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.43352712827806256 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43586355490352396 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4413251216892635 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.5163484937924369 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43597354304445723 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4413233674251357 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.4631357067381586 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43607539887505253 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4413251216892635 at iter 60
max_prior_anomaly= 0.5399148138984982 at iter 73
max_prior_star_anomaly= 0.44618999150719135 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4413244525369673
accuracies_anomaly['prior'][-1]= 0.44475371940165487
accuracies_anomaly['prior_star'][-1]= 0.44618999150719135



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.55664563179016 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.44132266210244514
 first_prior_anomaly_auc= 0.4203809863811231
 first_prior_star_anomaly_auc= 0.43727586412277875


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44047699828166514; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5650374797626644; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 40 
last prior star auc 0.4357550798907558 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43869358081599447; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5422505171160719; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 40 
last prior star auc 0.43538344114522215 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43875996554649366; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5447465757487633; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 40 
last prior star auc 0.4345753041086192 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4390452535038261; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5456023069959811; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 40 
last prior star auc 0.43434069087382365 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43906548481108687; count_not_improved_vanilla_star_anomaly= 49 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5512143667359691; count_not_improved_prior_anomaly= 46; iter_best_prior_anomaly= 40 
last prior star auc 0.43428229980048416 ; count_not_improved_prior_star_anomaly= 48 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43924226158525675; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5473799854257424; count_not_improved_prior_anomaly= 56; iter_best_prior_anomaly= 40 
last prior star auc 0.43425956670761157 ; count_not_improved_prior_star_anomaly= 58 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4392035291212668; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.548435527959956; count_not_improved_prior_anomaly= 66; iter_best_prior_anomaly= 40 
last prior star auc 0.4338807601955902 ; count_not_improved_prior_star_anomaly= 68 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4397919792391582; count_not_improved_vanilla_star_anomaly= 79 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5476639350784824; count_not_improved_prior_anomaly= 76; iter_best_prior_anomaly= 40 
last prior star auc 0.4342318059299191 ; count_not_improved_prior_star_anomaly= 78 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43976617166276266; count_not_improved_vanilla_star_anomaly= 89 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5476674255215409; count_not_improved_prior_anomaly= 86; iter_best_prior_anomaly= 40 
last prior star auc 0.4340617568491053 ; count_not_improved_prior_star_anomaly= 88 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44232294833083274 at iter 10
0.5695221083095935 at iter 40
0.4401719130618046 at iter 40
last anomaly aucs:
0.4405462344449219
0.5475259872226876
0.4342680305798982




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 120.45761966705322 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4403489128867399,first_prior_anomaly_auc= 0.5473096098950624, first_prior_star_anomaly_auc= 0.4341121783788815


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4403497809762052 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5189132942596619 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43411651279780894 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4403509082868302 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5283532246388868 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345222059696583 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44035069729286297 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5188899100996904 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43800091173507455 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4403510951672013 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.5053868206657378 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4385578996382478 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4403519029726759 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4996626266747496 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4396161549520405 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.440350890201633 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.49472032207083705 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4387866351839554 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44035137247355827 iter_best_vanilla_star_anomaly= 610 
last prior auc 0.4834948100306773 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4369432652895874 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.440352192335831 at iter 61
max_prior_anomaly= 0.5473096098950624 at iter 0
max_prior_star_anomaly= 0.43991149827901266 at iter 49
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44035070934966114
accuracies_anomaly['prior'][-1]= 0.4778534824132309
accuracies_anomaly['prior_star'][-1]= 0.43621300311210076



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.12757229804993 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5072417349443145
accuracies_anomaly["prior"][-1]= 0.503587433970945
accuracies_anomaly["prior_star"][-1]= 0.50724150586515


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam ellipticGGAD 
took 2993.140057325363 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.011993408203125 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5037688526123947
 first_prior_anomaly_auc= 0.5009810616637707
 first_prior_star_anomaly_auc= 0.5037688948111881


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4825910384713138; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49074168719939393; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.48259158705562866 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4668539690256034; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4807110761946237; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.46685522896100784 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45502654545244103; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47700129586466294; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4550311029221339 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4456075637599655; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47569578576323635; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.44561235030882285 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4401770191158123; count_not_improved_vanilla_star_anomaly= 50 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4756045218297975; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.44018305957167503 ; count_not_improved_prior_star_anomaly= 50 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43755915668002077; count_not_improved_vanilla_star_anomaly= 60 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4753259615658212; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.4375648655739349 ; count_not_improved_prior_star_anomaly= 60 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4362123339598045; count_not_improved_vanilla_star_anomaly= 70 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4749001636830914; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.43621442581427994 ; count_not_improved_prior_star_anomaly= 70 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4354227101367289; count_not_improved_vanilla_star_anomaly= 80 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47416434935006624; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.4354254892286977 ; count_not_improved_prior_star_anomaly= 80 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43496208016420396; count_not_improved_vanilla_star_anomaly= 90 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4730330660100052; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.4349638525135289 ; count_not_improved_prior_star_anomaly= 90 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5037688526123947 at iter 0
0.5009810616637707 at iter 0
0.5037688948111881 at iter 0
last anomaly aucs:
0.43480995351380913
0.47193272644234274
0.43480948932708113




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 120.37895441055298 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4347740724825767,first_prior_anomaly_auc= 0.4718145758490759, first_prior_star_anomaly_auc= 0.4347772916476772


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4347740785109758 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4782740657307698 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347766948361698 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4347740785109758 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4774138975818404 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43477596539988295 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4347740724825767 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.48493569386149826 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43477122707821825 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4347740724825767 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4870954100251794 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347527741486815 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4347740785109758 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.47129793602084186 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43477328276229926 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43477407248257677 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.46938362392628186 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347674352152066 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4347740845393748 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4652122912787391 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4362707250331441 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4347740845393748 at iter 28
max_prior_anomaly= 0.48845013597656933 at iter 36
max_prior_star_anomaly= 0.4397036993632564 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4347740785109758
accuracies_anomaly['prior'][-1]= 0.46283122435820456
accuracies_anomaly['prior_star'][-1]= 0.4397036993632564



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.69636797904968 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4347740724825767
 first_prior_anomaly_auc= 0.4625667946616356
 first_prior_star_anomaly_auc= 0.4400811856558826


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43420602246711987; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.461183536297473; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4380451903262039 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4343127673293565; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.463331569423767; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 200 
last prior star auc 0.4367627750215937 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4345397606677344; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4659659798149909; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 300 
last prior star auc 0.4362623214448481 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4345147548684145; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46812913216613883; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 400 
last prior star auc 0.43567309366347745 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4344862586260362; count_not_improved_vanilla_star_anomaly= 50 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47081040130329166; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 500 
last prior star auc 0.4354592844338538 ; count_not_improved_prior_star_anomaly= 50 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43432950819355887; count_not_improved_vanilla_star_anomaly= 60 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47310043336955193; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 600 
last prior star auc 0.4353539924157917 ; count_not_improved_prior_star_anomaly= 60 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43409320097862625; count_not_improved_vanilla_star_anomaly= 70 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47231114110842487; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 600 
last prior star auc 0.4351837383694097 ; count_not_improved_prior_star_anomaly= 70 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4341051432371731; count_not_improved_vanilla_star_anomaly= 80 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4730736311073108; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 600 
last prior star auc 0.43509497019318366 ; count_not_improved_prior_star_anomaly= 80 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.434078624309688; count_not_improved_vanilla_star_anomaly= 90 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4735345564713899; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 900 
last prior star auc 0.4348649264848791 ; count_not_improved_prior_star_anomaly= 90 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4347740724825767 at iter 0
0.4738478162003821 at iter 980
0.4400811856558826 at iter 0
last anomaly aucs:
0.43404608301153735
0.4738183433573553
0.43470867038112504




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 120.9314637184143 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4340488259331118,first_prior_anomaly_auc= 0.47379997482540553, first_prior_star_anomaly_auc= 0.43469616748146506


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4340488199047127 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4714924302598626 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43889574317862534 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4340488259331118 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4705199650931581 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43962566173736534 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4340488138763136 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4708813615886809 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4402793451615346 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4340488138763136 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4680223451051087 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4408148357936436 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4340488199047127 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.46558332718436624 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44062608661893143 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43404883196151084 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.46881412709504955 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44161264015424984 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4340488138763136 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.46320740851663283 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44025044501641897 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4340488319615109 at iter 5
max_prior_anomaly= 0.4751332999601161 at iter 1
max_prior_star_anomaly= 0.4422629356181448 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43404881387631367
accuracies_anomaly['prior'][-1]= 0.46540768374922054
accuracies_anomaly['prior_star'][-1]= 0.4422629356181448



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.17475175857544 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4340488199047127
 first_prior_anomaly_auc= 0.465591139989554
 first_prior_star_anomaly_auc= 0.44239865296628583


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4340675019134138; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.47027837700064473; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 50 
last prior star auc 0.442424333946301 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43421597535397555; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.47628279509375127; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 50 
last prior star auc 0.4453074338841362 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43490290539898596; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.46031448831672145; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 50 
last prior star auc 0.43537388613270483 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4353046077706546; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.4612692058765798; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 50 
last prior star auc 0.43562495086854763 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4354907767905671; count_not_improved_vanilla_star_anomaly= 41 ;iter_best_vanilla_star_anomaly= 490 
last prior auc 0.462269920121301; count_not_improved_prior_anomaly= 47; iter_best_prior_anomaly= 50 
last prior star auc 0.43569946790938496 ; count_not_improved_prior_star_anomaly= 49 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43550318926424114; count_not_improved_vanilla_star_anomaly= 49 ;iter_best_vanilla_star_anomaly= 570 
last prior auc 0.46197922469000763; count_not_improved_prior_anomaly= 57; iter_best_prior_anomaly= 50 
last prior star auc 0.43558626060335115 ; count_not_improved_prior_star_anomaly= 59 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43550968185003375; count_not_improved_vanilla_star_anomaly= 58 ;iter_best_vanilla_star_anomaly= 670 
last prior auc 0.4570656876064314; count_not_improved_prior_anomaly= 67; iter_best_prior_anomaly= 50 
last prior star auc 0.4337059426511163 ; count_not_improved_prior_star_anomaly= 69 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4354473180617105; count_not_improved_vanilla_star_anomaly= 68 ;iter_best_vanilla_star_anomaly= 670 
last prior auc 0.4611244640150392; count_not_improved_prior_anomaly= 77; iter_best_prior_anomaly= 50 
last prior star auc 0.43554421854827474 ; count_not_improved_prior_star_anomaly= 79 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4352873846345271; count_not_improved_vanilla_star_anomaly= 78 ;iter_best_vanilla_star_anomaly= 670 
last prior auc 0.45404610471377405; count_not_improved_prior_anomaly= 87; iter_best_prior_anomaly= 50 
last prior star auc 0.43435370015900504 ; count_not_improved_prior_star_anomaly= 89 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4357833289687724 at iter 670
0.48339450952704077 at iter 50
0.459505838866198 at iter 10
last anomaly aucs:
0.43547889481601076
0.45792954513558826
0.4349582099320045




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 120.77133464813232 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4354829579569804,first_prior_anomaly_auc= 0.46283358146223885, first_prior_star_anomaly_auc= 0.43541068950899414


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4354828554741963 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4756862789779115 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4356411974040267 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4354828554741963 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45907980587590463 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43817446331574483 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43548285547419624 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45731649914951344 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4398824655091176 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43548287355939347 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4587808756514891 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44257776273089366 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43548286150259535 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45357671547740824 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4417179984847016 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4354829037013888 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45216291121518537 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.439786915383944 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43548286150259535 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4483984291921125 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43740059169942497 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4354829579569804 at iter 0
max_prior_anomaly= 0.4777213037353407 at iter 12
max_prior_star_anomaly= 0.4432605512657468 at iter 34
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4354828434173981
accuracies_anomaly['prior'][-1]= 0.450369432351476
accuracies_anomaly['prior_star'][-1]= 0.43730317277054126



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.61271405220032 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4354829278149851
 first_prior_anomaly_auc= 0.44958859793423644
 first_prior_star_anomaly_auc= 0.43845339131206423


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4391854258388759; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.46390851735624317; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 30 
last prior star auc 0.457682441057931 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44033839333037217; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4681618241742661; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 30 
last prior star auc 0.46202923628864745 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44026517842373275; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4774840138913605; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 30 
last prior star auc 0.4684869116222229 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44111111955086973; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4765096437505516; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 30 
last prior star auc 0.465534394669159 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43862840176530815; count_not_improved_vanilla_star_anomaly= 49 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.467950872405799; count_not_improved_prior_anomaly= 47; iter_best_prior_anomaly= 30 
last prior star auc 0.4580778196389809 ; count_not_improved_prior_star_anomaly= 47 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44060221415863565; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47983958671225097; count_not_improved_prior_anomaly= 55; iter_best_prior_anomaly= 560 
last prior star auc 0.4672252942943856 ; count_not_improved_prior_star_anomaly= 56 ; iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43909166614822437; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4767548428541045; count_not_improved_prior_anomaly= 64; iter_best_prior_anomaly= 680 
last prior star auc 0.46511370886883596 ; count_not_improved_prior_star_anomaly= 66 ; iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4385013231130267; count_not_improved_vanilla_star_anomaly= 79 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47232207059592896; count_not_improved_prior_anomaly= 73; iter_best_prior_anomaly= 770 
last prior star auc 0.460683317828291 ; count_not_improved_prior_star_anomaly= 76 ; iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4384235145663001; count_not_improved_vanilla_star_anomaly= 89 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4722295648122829; count_not_improved_prior_anomaly= 83; iter_best_prior_anomaly= 770 
last prior star auc 0.458577290586679 ; count_not_improved_prior_star_anomaly= 86 ; iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4498792632235345 at iter 10
0.4904308207448304 at iter 770
0.47311293024081286 at iter 560
last anomaly aucs:
0.4390330640809175
0.4719824004506349
0.4591189000438385




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 120.77922177314758 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.439351677028279,first_prior_anomaly_auc= 0.47715141505816927, first_prior_star_anomaly_auc= 0.46357373021419146


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43935168305667804 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.47418315192674865 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44539647333832 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4393516890850771 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4755218664502231 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45955509691495466 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43935167702827904 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4742566019409516 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46083309340305056 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43935167702827893 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.47407162051565477 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608592144561974 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43935167702827904 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4739703916385623 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46084886972340255 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43935170114187516 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4738406725474905 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46066928371526855 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43935168908507705 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.47386095811034284 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46039542560256264 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4393517131986734 at iter 23
max_prior_anomaly= 0.4821691108207834 at iter 1
max_prior_star_anomaly= 0.46357373021419146 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43935168908507716
accuracies_anomaly['prior'][-1]= 0.4736847359488869
accuracies_anomaly['prior_star'][-1]= 0.4601207898263773



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.11155843734741 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43935168305667804
 first_prior_anomaly_auc= 0.4736247232361989
 first_prior_star_anomaly_auc= 0.4600873623535642


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.437506257478229; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47539179771200557; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.4544052164460514 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4376207729468599; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47927614239367955; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 200 
last prior star auc 0.4554291882543637 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4370096198780913; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47263472145661556; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 200 
last prior star auc 0.45359926771830883 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43821109186846124; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4800434129130237; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 320 
last prior star auc 0.4565988664680671 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4377868613694883; count_not_improved_vanilla_star_anomaly= 50 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47593898343829977; count_not_improved_prior_anomaly= 45; iter_best_prior_anomaly= 320 
last prior star auc 0.45754540951879386 ; count_not_improved_prior_star_anomaly= 48 ; iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4388172534228044; count_not_improved_vanilla_star_anomaly= 60 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47626727799455904; count_not_improved_prior_anomaly= 55; iter_best_prior_anomaly= 320 
last prior star auc 0.45651193695355574 ; count_not_improved_prior_star_anomaly= 58 ; iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43823081076180154; count_not_improved_vanilla_star_anomaly= 70 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47378592262718594; count_not_improved_prior_anomaly= 65; iter_best_prior_anomaly= 320 
last prior star auc 0.4547460139019705 ; count_not_improved_prior_star_anomaly= 68 ; iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43897895919931285; count_not_improved_vanilla_star_anomaly= 80 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47437508409616697; count_not_improved_prior_anomaly= 75; iter_best_prior_anomaly= 320 
last prior star auc 0.45478439069041565 ; count_not_improved_prior_star_anomaly= 78 ; iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4385481637737585; count_not_improved_vanilla_star_anomaly= 90 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47774872692268555; count_not_improved_prior_anomaly= 85; iter_best_prior_anomaly= 320 
last prior star auc 0.4551443041997686 ; count_not_improved_prior_star_anomaly= 88 ; iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43935168305667804 at iter 0
0.49461436090047883 at iter 320
0.4681420389685361 at iter 320
last anomaly aucs:
0.43859447996377177
0.47097783405891147
0.454216636066513




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 122.5586347579956 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4387599836316909,first_prior_anomaly_auc= 0.47717873576272996, first_prior_star_anomaly_auc= 0.4555392065372924


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4387599354044983 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4689329649258097 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43844892426835735 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43875990526250297 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4699826719697288 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4387931217413489 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4387599715748927 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4751586855485771 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4512264114773002 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43875991731930114 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47462938005390837 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45425906996752863 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4387600439156815 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47521162092076324 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4544269849950736 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43875985100691145 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47477013111526833 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4548976522520411 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4387600137736862 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.475175197333615 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45409762341217996 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43876017654046096 at iter 69
max_prior_anomaly= 0.47717873576272996 at iter 0
max_prior_star_anomaly= 0.4555392065372924 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4387599896600899
accuracies_anomaly['prior'][-1]= 0.4748125650162839
accuracies_anomaly['prior_star'][-1]= 0.4546261934421628



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.92301321029663 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4387598449785124
 first_prior_anomaly_auc= 0.4747644644201476
 first_prior_star_anomaly_auc= 0.45464173465495133


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44401184049917075; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4688890661238214; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 30 
last prior star auc 0.45871577496999066 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4430430405990975; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4707795720704753; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 30 
last prior star auc 0.4619132318054477 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44446684597536845; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4686414315470464; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 230 
last prior star auc 0.46017600996180885 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4437055917982907; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4715644274298909; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 230 
last prior star auc 0.46209786358359867 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44396077995909367; count_not_improved_vanilla_star_anomaly= 45 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.47080856264157694; count_not_improved_prior_anomaly= 45; iter_best_prior_anomaly= 230 
last prior star auc 0.46047259513898836 ; count_not_improved_prior_star_anomaly= 44 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43869819254127884; count_not_improved_vanilla_star_anomaly= 55 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4569362759637119; count_not_improved_prior_anomaly= 55; iter_best_prior_anomaly= 230 
last prior star auc 0.449654729471975 ; count_not_improved_prior_star_anomaly= 54 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4451346659953442; count_not_improved_vanilla_star_anomaly= 65 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4689473306007806; count_not_improved_prior_anomaly= 65; iter_best_prior_anomaly= 230 
last prior star auc 0.4579137989572316 ; count_not_improved_prior_star_anomaly= 64 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.448277228228919; count_not_improved_vanilla_star_anomaly= 75 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.47350789889072636; count_not_improved_prior_anomaly= 75; iter_best_prior_anomaly= 230 
last prior star auc 0.46403920701956436 ; count_not_improved_prior_star_anomaly= 74 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.446491905789144; count_not_improved_vanilla_star_anomaly= 85 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.48039876895268374; count_not_improved_prior_anomaly= 85; iter_best_prior_anomaly= 230 
last prior star auc 0.4664177902396843 ; count_not_improved_prior_star_anomaly= 84 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.45020679217311255 at iter 220
0.4873390899721681 at iter 230
0.47551476499612494 at iter 230
last anomaly aucs:
0.44624059991733855
0.4781749226797536
0.467548109035895




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 123.13963747024536 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4469194820495978,first_prior_anomaly_auc= 0.47659459595016973, first_prior_star_anomaly_auc= 0.4660624703704186


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44691947602119875 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.47142553914384194 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45596959203171034 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4469195061631941 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4746618791532655 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4645361520680544 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44691950616319404 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.47482035370787534 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4646578895587646 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44691948807799686 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4746104327956484 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46455475570756766 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4469195061631941 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.47481003308867675 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4644699964167196 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4469194579360016 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.47519044315484926 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46444879453720944 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44691953630518944 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4754656516289458 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4644433448644551 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4469195724755837 at iter 19
max_prior_anomaly= 0.476931294094725 at iter 1
max_prior_star_anomaly= 0.4660624703704186 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4469195182199922
accuracies_anomaly['prior'][-1]= 0.4755512066684703
accuracies_anomaly['prior_star'][-1]= 0.46444125903837874



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 78.59357357025146 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.44691947602119875
 first_prior_anomaly_auc= 0.4755804142619383
 first_prior_star_anomaly_auc= 0.4644445565726671


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44095178293519377; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49562418405618663; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 100 
last prior star auc 0.4682331883623926 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4387096404711025; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48394669882455865; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 100 
last prior star auc 0.4583317900631728 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43869876523919005; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48544803544119924; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 100 
last prior star auc 0.45797853793478627 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43899876851863906; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48231004273411526; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 100 
last prior star auc 0.45637355505302823 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43801574159677337; count_not_improved_vanilla_star_anomaly= 49 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47645019770737573; count_not_improved_prior_anomaly= 45; iter_best_prior_anomaly= 100 
last prior star auc 0.4518204258075282 ; count_not_improved_prior_star_anomaly= 48 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4367312223808897; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47573602532699244; count_not_improved_prior_anomaly= 54; iter_best_prior_anomaly= 590 
last prior star auc 0.45196453468716713 ; count_not_improved_prior_star_anomaly= 58 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4364701625593978; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48116948168789386; count_not_improved_prior_anomaly= 64; iter_best_prior_anomaly= 590 
last prior star auc 0.45505324523189805 ; count_not_improved_prior_star_anomaly= 68 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4360533108208799; count_not_improved_vanilla_star_anomaly= 79 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49063564163144874; count_not_improved_prior_anomaly= 74; iter_best_prior_anomaly= 590 
last prior star auc 0.45879218492813423 ; count_not_improved_prior_star_anomaly= 78 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43574880432732954; count_not_improved_vanilla_star_anomaly= 89 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48218016690466786; count_not_improved_prior_anomaly= 84; iter_best_prior_anomaly= 590 
last prior star auc 0.45390422634178895 ; count_not_improved_prior_star_anomaly= 88 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44693602397663107 at iter 10
0.49723814925255083 at iter 590
0.4682331883623926 at iter 100
last anomaly aucs:
0.4360502242805588
0.4874800821694906
0.45635361310892253




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 121.71649146080017 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43607844924497924,first_prior_anomaly_auc= 0.4772243225164563, first_prior_star_anomaly_auc= 0.44908032552390403


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43607845527337824 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.475813646993348 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4355916861625092 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43607847938697447 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.475506469919012 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4355752708318564 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43607852158576793 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4753002383870126 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44742484274318206 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43607845527337824 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.47769660538437314 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4493763078611771 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43607847938697447 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4770356697961292 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.445606020489805 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4360785456993642 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.47644415122311395 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4468080953200814 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43607846733017636 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.4760652361999095 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44366537634813086 iter_best_prior_star_anomaly= 660
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4360785456993642 at iter 60
max_prior_anomaly= 0.48034081795247596 at iter 66
max_prior_star_anomaly= 0.45027932587065755 at iter 66
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4360784432165801
accuracies_anomaly['prior'][-1]= 0.47994470390674016
accuracies_anomaly['prior_star'][-1]= 0.4496700054352046



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.6320629119873 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4360784854153736
 first_prior_anomaly_auc= 0.4789439655484227
 first_prior_star_anomaly_auc= 0.4495555623073625


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43683492892999776; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4967591447196771; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 100 
last prior star auc 0.4689955638216964 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4365226036028606; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.49570170323975804; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 160 
last prior star auc 0.4665412699377242 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43520178136781; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4830136413025393; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 160 
last prior star auc 0.45744090722100933 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4371844072805699; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.49422523979765803; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 160 
last prior star auc 0.4648861669461432 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43844200366623115; count_not_improved_vanilla_star_anomaly= 48 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.49349104107558217; count_not_improved_prior_anomaly= 43; iter_best_prior_anomaly= 160 
last prior star auc 0.4664158792371808 ; count_not_improved_prior_star_anomaly= 46 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4379706009445778; count_not_improved_vanilla_star_anomaly= 58 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48593091623467155; count_not_improved_prior_anomaly= 53; iter_best_prior_anomaly= 160 
last prior star auc 0.4641326351482673 ; count_not_improved_prior_star_anomaly= 56 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4368206657378109; count_not_improved_vanilla_star_anomaly= 68 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.49036403211159385; count_not_improved_prior_anomaly= 62; iter_best_prior_anomaly= 660 
last prior star auc 0.46363436385198303 ; count_not_improved_prior_star_anomaly= 66 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43726726159731355; count_not_improved_vanilla_star_anomaly= 78 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.49312031261830735; count_not_improved_prior_anomaly= 72; iter_best_prior_anomaly= 660 
last prior star auc 0.46650477400978724 ; count_not_improved_prior_star_anomaly= 76 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43684324209230785; count_not_improved_vanilla_star_anomaly= 88 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.49131444539452007; count_not_improved_prior_anomaly= 82; iter_best_prior_anomaly= 660 
last prior star auc 0.4658605973709429 ; count_not_improved_prior_star_anomaly= 86 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4412386021058886 at iter 30
0.4996599982927574 at iter 660
0.4706912138253857 at iter 60
last anomaly aucs:
0.436349015851796
0.492030721686177
0.46314455642798547




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 117.37755846977234 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43722113228767134,first_prior_anomaly_auc= 0.4852942570094607, first_prior_star_anomaly_auc= 0.4607725260776487


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43722113831607046 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.49527972736203524 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44129731871277766 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43722115037286857 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4937031683818668 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44344522524269125 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43722111420247417 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4866586705981474 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45881860137283526 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4372211262592723 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4893913619793211 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609694738750887 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43722112023087323 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4904317672034836 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46182385476091614 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43722113228767134 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4904278306588944 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46238792000459117 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4372211262592723 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.49201436663951476 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46390631699058466 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43722115640126763 at iter 74
max_prior_anomaly= 0.49834218422884 at iter 1
max_prior_star_anomaly= 0.46390631699058466 at iter 70
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43722112625927223
accuracies_anomaly['prior'][-1]= 0.4906044687798858
accuracies_anomaly['prior_star'][-1]= 0.46293914475825876



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.67215704917908 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43722113831607035
 first_prior_anomaly_auc= 0.49052790208336644
 first_prior_star_anomaly_auc= 0.4630820178160895


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4402582337080104; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.48536347508752026; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 40 
last prior star auc 0.46502086549484234 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43699769570474156; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4818642787936836; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 40 
last prior star auc 0.4613292788732585 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44269793886624625; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.49059430489906286; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 40 
last prior star auc 0.4674844973689656 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4406379444798914; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.48722376066966355; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 40 
last prior star auc 0.46376039959122634 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4390993764706279; count_not_improved_vanilla_star_anomaly= 45 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4874217453517426; count_not_improved_prior_anomaly= 48; iter_best_prior_anomaly= 460 
last prior star auc 0.465958799991705 ; count_not_improved_prior_star_anomaly= 46 ; iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43667978205167157; count_not_improved_vanilla_star_anomaly= 55 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4800326039935009; count_not_improved_prior_anomaly= 58; iter_best_prior_anomaly= 460 
last prior star auc 0.4611020986545096 ; count_not_improved_prior_star_anomaly= 56 ; iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43803165054190485; count_not_improved_vanilla_star_anomaly= 65 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.483861324637006; count_not_improved_prior_anomaly= 68; iter_best_prior_anomaly= 460 
last prior star auc 0.462680888142332 ; count_not_improved_prior_star_anomaly= 65 ; iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4374934531586159; count_not_improved_vanilla_star_anomaly= 75 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4871802717988116; count_not_improved_prior_anomaly= 78; iter_best_prior_anomaly= 460 
last prior star auc 0.4653882481906363 ; count_not_improved_prior_star_anomaly= 75 ; iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43769157046547436; count_not_improved_vanilla_star_anomaly= 85 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.48076131084402884; count_not_improved_prior_anomaly= 88; iter_best_prior_anomaly= 460 
last prior star auc 0.459744135452822 ; count_not_improved_prior_star_anomaly= 85 ; iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4429821959673386 at iter 280
0.4956726523846659 at iter 460
0.4722504592434408 at iter 680
last anomaly aucs:
0.43900945687018056
0.48511591285153405
0.46493432782627026




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 117.32174515724182 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43760059589519074,first_prior_anomaly_auc= 0.48717491255204315, first_prior_star_anomaly_auc= 0.46582522875363086


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4376006019235898 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4818948005781476 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.443017239051101 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4376005898667916 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48207947455509215 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44680390558273164 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43760059589519074 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48745918170993374 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4638080540858319 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4376005898667916 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4879492543834901 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4645610794981864 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43760060192358974 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48815039191828 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4648521245766255 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4376006019235898 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.4881283460629008 iter_best_prior_anomaly= 520
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4650311740572428 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43760059589519074 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.4879156159167097 iter_best_prior_anomaly= 520
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46519123408080665 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43760060192358985 at iter 56
max_prior_anomaly= 0.48819284993289186 at iter 52
max_prior_star_anomaly= 0.46582522875363086 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4376006019235898
accuracies_anomaly['prior'][-1]= 0.48771987379908266
accuracies_anomaly['prior_star'][-1]= 0.4653052190503198



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.53691625595093 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43760059589519074
 first_prior_anomaly_auc= 0.4876609703118226
 first_prior_star_anomaly_auc= 0.4649832362278812


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4347127033800992; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47822135943774813; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 60 
last prior star auc 0.4553428615797589 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43491631858690466; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4787286130486386; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 60 
last prior star auc 0.45652669447446587 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4357331546033579; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4654131575355712; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 60 
last prior star auc 0.44975883389542126 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43465634387724444; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47560105550033543; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 60 
last prior star auc 0.4547161371562064 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43537953474262836; count_not_improved_vanilla_star_anomaly= 49 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4823330651901429; count_not_improved_prior_anomaly= 48; iter_best_prior_anomaly= 60 
last prior star auc 0.4576154414307272 ; count_not_improved_prior_star_anomaly= 50 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4344782348268813; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47353065609719514; count_not_improved_prior_anomaly= 58; iter_best_prior_anomaly= 60 
last prior star auc 0.45159752575211515 ; count_not_improved_prior_star_anomaly= 60 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4354906501941868; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47721811929381885; count_not_improved_prior_anomaly= 68; iter_best_prior_anomaly= 60 
last prior star auc 0.454145139253607 ; count_not_improved_prior_star_anomaly= 70 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4351299771065517; count_not_improved_vanilla_star_anomaly= 79 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.459980099049008; count_not_improved_prior_anomaly= 78; iter_best_prior_anomaly= 60 
last prior star auc 0.443875592651912 ; count_not_improved_prior_star_anomaly= 80 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43703961116343765; count_not_improved_vanilla_star_anomaly= 89 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48180732850772046; count_not_improved_prior_anomaly= 88; iter_best_prior_anomaly= 60 
last prior star auc 0.4596492002243529 ; count_not_improved_prior_star_anomaly= 90 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4402003671053894 at iter 10
0.492483418285533 at iter 60
0.4649832362278812 at iter 0
last anomaly aucs:
0.4363469481109168
0.4718692232865963
0.4542232914190803




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 117.41664266586304 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43589794089178835,first_prior_anomaly_auc= 0.484656120826479, first_prior_star_anomaly_auc= 0.4585211903049839


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4358979228065911 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.47904153518728304 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43881326865102277 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43589795897698547 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.47658746435407634 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4401866283839213 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43589792883499023 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4801668805542655 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45396133336612776 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43589794692018735 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4785171488662511 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4535752746900318 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43589793486338924 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4767055606917516 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4528183730170787 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43589793486338924 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4755218724786221 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45238182047041764 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43589792280659106 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.47584040705679564 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45226218086258196 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4358979891189808 at iter 13
max_prior_anomaly= 0.484656120826479 at iter 0
max_prior_star_anomaly= 0.4585211903049839 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43589793486338924
accuracies_anomaly['prior'][-1]= 0.47278198921736436
accuracies_anomaly['prior_star'][-1]= 0.4518987467681752



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.76163029670715 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4358979288349902
 first_prior_anomaly_auc= 0.4728436597397949
 first_prior_star_anomaly_auc= 0.4519056914838977


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4338337205976892; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47902267232660994; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 20 
last prior star auc 0.4536844188550961 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43431039214012507; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4827347494766144; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 180 
last prior star auc 0.4589657545940018 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4349938136568799; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4810098376238655; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 220 
last prior star auc 0.45574813879207277 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 220
                                       
