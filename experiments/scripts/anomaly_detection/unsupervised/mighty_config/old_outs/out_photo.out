

/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0031769275665283203 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4637823103935145
 first_prior_anomaly_auc= 0.4126078689483692
 first_prior_star_anomaly_auc= 0.46030112572204246


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46117367450745206; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4120775084834625; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.46039510702133557 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4611433951367768; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4118275203228011; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.45958626016454374 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.459110067293544; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4118309778287952; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4547702686335475 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4610225919728026; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.41163211884768236; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4611027432481194 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5454885204514623 at iter 40
0.4126078689483692 at iter 0
0.5194764455832561 at iter 40
last anomaly aucs:
0.46126283625293524
0.4115991153813755
0.4611536628818501




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 54.58014106750488 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4612838956076263,first_prior_anomaly_auc= 0.41163201407477346, first_prior_star_anomaly_auc= 0.46115858720856884


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4612838956076263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43833401854815757 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611893904437887 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4612838956076263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4242983253517332 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611683310890976 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4612838956076263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4249027602632398 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46116256857910753 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4612838956076263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42487279521129134 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611636163081966 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4612838956076263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42513556566683974 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611653974476481 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4612838956076263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.425085903308016 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46116476881019464 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4612838956076263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42539309747694265 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461166654722555 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4612838956076263 at iter 0
max_prior_anomaly= 0.44189357335549495 at iter 9
max_prior_star_anomaly= 0.4611910668103313 at iter 9
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4612838956076263
accuracies_anomaly['prior'][-1]= 0.42368802315732745
accuracies_anomaly['prior_star'][-1]= 0.46115890152729566



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.1722400188446 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4612838956076263
 first_prior_anomaly_auc= 0.42371819775509373
 first_prior_star_anomaly_auc= 0.4611652926747392


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 65


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 66 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4612838956076263 at iter 0
0.42371819775509373 at iter 0
0.4611652926747392 at iter 0
last anomaly aucs:
0.46119798182231936
0.4151892638781147
0.4610870273117828




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 9.203607320785522 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4637823103935145
accuracies_anomaly["prior"][-1]= 0.4126078689483692
accuracies_anomaly["prior_star"][-1]= 0.46030112572204246


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 140.55548977851868 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003305673599243164 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.45837456147298977
 first_prior_anomaly_auc= 0.41207206029219906
 first_prior_star_anomaly_auc= 0.4550567177665098


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5487726272812729; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4126372053628642; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 100 
last prior star auc 0.5189928138357236 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4612694369461966; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41249303784020286; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 140 
last prior star auc 0.46119263840396496 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4610725686503531; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4121144933203079; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 140 
last prior star auc 0.46111646849918675 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46100017057029574; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4120119206424842; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 140 
last prior star auc 0.4610981332401273 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5487726272812729 at iter 100
0.4131709185608561 at iter 140
0.5198736396809371 at iter 30
last anomaly aucs:
0.4611681215432798
0.41207310802128816
0.46113323216461244




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.40157151222229 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4611862472565214,first_prior_anomaly_auc= 0.41208211849145454, first_prior_star_anomaly_auc= 0.46113752785387785


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4611862472565214 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43891058386589404 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611581681169333 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4611862472565214 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4154966675928592 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611239073757194 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4611862472565214 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4182151054874601 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611263171526244 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4611862472565214 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42120029520814817 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46112925079407385 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4611862472565214 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42268786096886446 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46113312739170365 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4611862472565214 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4209475829518552 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611295651128006 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4611862472565214 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42086565053708686 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46113040329607186 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4611862472565214 at iter 0
max_prior_anomaly= 0.44966562773850194 at iter 6
max_prior_star_anomaly= 0.4611657117663749 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4611862472565214
accuracies_anomaly['prior'][-1]= 0.4210322394622551
accuracies_anomaly['prior_star'][-1]= 0.46113375602915707



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.77480912208557 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4611862472565214
 first_prior_anomaly_auc= 0.41901735165099063
 first_prior_star_anomaly_auc= 0.46112600283389765


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46130086881886984; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41851266054876696; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.46117765587799076 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 168


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 169 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4614190526601213 at iter 30
0.4269942370709183 at iter 10
0.4612085638861194 at iter 30
last anomaly aucs:
0.4613098792890362
0.414855247844507
0.4611741983719966




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 23.05744433403015 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4583745614729897
accuracies_anomaly["prior"][-1]= 0.41207206029219906
accuracies_anomaly["prior_star"][-1]= 0.4550567177665098


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 165.44056701660156 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003431081771850586 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.47477948445861534
 first_prior_anomaly_auc= 0.4127337012119711
 first_prior_star_anomaly_auc= 0.4716878454624739


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4613466545800639; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41202260747919317; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4610393556382284 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4611429760451412; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41178487774887446; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4611439190013214 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4610412415505888; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4112395347579934; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4611011716544857 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46111615418046004; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.411114226358936; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.461130298523163 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5487677029545541 at iter 20
0.4127337012119711 at iter 0
0.5293498254273792 at iter 20
last anomaly aucs:
0.46122941369499265
0.4082625173242005
0.46121526935228974




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.12398386001587 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4612261657348164,first_prior_anomaly_auc= 0.40437041330398016, first_prior_star_anomaly_auc= 0.4612143263961095


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4612261657348164 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40423672307220987 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46121338343992935 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4612261657348164 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4044699475674455 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46121380253156496 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4612261657348164 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40445988936819005 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612114975275689 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 330, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 331 iterations

max values 
max_vanilla_star_anomaly= 0.4612261657348164 at iter 0
max_prior_anomaly= 0.4047237075528275 at iter 26
max_prior_star_anomaly= 0.4612146407148362 at iter 21
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4612261657348164
accuracies_anomaly['prior'][-1]= 0.4038823810942734
accuracies_anomaly['prior_star'][-1]= 0.4612126500295669



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 30.350661993026733 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4747795892315242
accuracies_anomaly["prior"][-1]= 0.4127337012119711
accuracies_anomaly["prior_star"][-1]= 0.4716878454624739


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 98.72693061828613 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0033693313598632812 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46616212224651554
 first_prior_anomaly_auc= 0.41238658856474947
 first_prior_star_anomaly_auc= 0.462692253049206


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4612868292490758; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4115725030625121; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.46116068266674703 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46132549045246385; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41087083889153614; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.46116382585401444 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46107854070616106; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41052068782995604; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4611107059891967 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.460989274187769; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4100932143615998; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4610723591045353 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5510320550619354 at iter 60
0.41238658856474947 at iter 0
0.521104197496095 at iter 30
last anomaly aucs:
0.46116560699346587
0.40721091163746226
0.46112694579007785




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.1555163860321 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46122763255554117,first_prior_anomaly_auc= 0.40664293769825655, first_prior_star_anomaly_auc= 0.4611722076867273


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46122763255554117 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4076607017354166 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611729410970897 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46122763255554117 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41036342369368095 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611761890572659 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46122763255554117 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4189455822083866 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46116476881019464 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 378, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 379 iterations

max values 
max_vanilla_star_anomaly= 0.46122763255554117 at iter 0
max_prior_anomaly= 0.427230814299239 at iter 37
max_prior_star_anomaly= 0.4611761890572659 at iter 20
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46122763255554117
accuracies_anomaly['prior'][-1]= 0.427230814299239
accuracies_anomaly['prior_star'][-1]= 0.4611693788181867



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 36.2814781665802 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.46616212224651554
accuracies_anomaly["prior"][-1]= 0.41238658856474947
accuracies_anomaly["prior_star"][-1]= 0.46269214827629707


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 105.69984006881714 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0035567283630371094 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4685519922987721
 first_prior_anomaly_auc= 0.4125078108203593
 first_prior_star_anomaly_auc= 0.46502083094974966


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4613486452653332; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41220983666741684; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.45430245759526056 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613812296400045; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4119337600524367; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4611158398617333 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46119871523268174; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41163641453694777; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4611473765073154 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46099084578140265; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41144845193836166; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.46107036841926596 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.548593884698671 at iter 90
0.4125078108203593 at iter 0
0.5205694365690141 at iter 90
last anomaly aucs:
0.4610051996699234
0.41155259620981904
0.4610871320846917




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 67.96291017532349 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46101441968590756,first_prior_anomaly_auc= 0.411584447174128, first_prior_star_anomaly_auc= 0.4610896466345056


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46101441968590756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41171006989191206 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610898561803234 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46101441968590756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4118444935340447 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610892275428699 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46101441968590756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41199348061051594 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610892275428699 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46101441968590756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4121684513683971 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610888084512343 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46101441968590756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.412362386022791 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610890179970521 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46101441968590756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41256061636645036 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610885989054164 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46101441968590756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4127625137619215 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610883893595986 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.46101441968590756 at iter 0
max_prior_anomaly= 0.41296535411357294 at iter 79
max_prior_star_anomaly= 0.46108996095323235 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46101441968590756
accuracies_anomaly['prior'][-1]= 0.41296535411357294
accuracies_anomaly['prior_star'][-1]= 0.4610874464034185



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.0000011920929 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46101441968590756
 first_prior_anomaly_auc= 0.41299301416152545
 first_prior_star_anomaly_auc= 0.4610874464034185


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4612249084599095; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41313110485547; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 100 
last prior star auc 0.4611389946746026 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613309386437272; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41325410825053127; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 200 
last prior star auc 0.46117734155926393 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4613846871459985; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4132228859236759; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 290 
last prior star auc 0.4612037443323095 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46142334834938664; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.4144986008625744; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 390 
last prior star auc 0.46122857551172136 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4614307872259193 at iter 470
0.4145618836995566 at iter 390
0.4612347571133471 at iter 380
last anomaly aucs:
0.4614258628992005
0.4138164244526558
0.46123161392607975




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.16141939163208 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4614285869948322,first_prior_anomaly_auc= 0.4137957841896004, first_prior_star_anomaly_auc= 0.46123245210935104


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4614285869948322 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4140650505655013 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123349983844014 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4614285869948322 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41437056836788533 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123465234043826 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4614285869948322 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4146984027998674 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123465234043826 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4614285869948322 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41507600436358216 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612362239340718 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4614285869948322 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4154731984612632 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123716689025207 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4614285869948322 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41591596877432047 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612377955277055 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4614285869948322 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4164292512550747 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461238424165159 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4614285869948322 at iter 0
max_prior_anomaly= 0.4169229412018626 at iter 79
max_prior_star_anomaly= 0.46123915757552136 at iter 76
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4614285869948322
accuracies_anomaly['prior'][-1]= 0.4169229412018626
accuracies_anomaly['prior_star'][-1]= 0.46123915757552136



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.88837742805481 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4614285869948322
 first_prior_anomaly_auc= 0.41697082242123484
 first_prior_star_anomaly_auc= 0.4612394718942481


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4614236626681134; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4163164108321777; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.46124167212533523 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 158


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 159 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4614285869948322 at iter 0
0.4171235813224269 at iter 120
0.4612615789780282 at iter 150
last anomaly aucs:
0.4613873064687213
0.41540918221391865
0.4612615789780282




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 21.650620460510254 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4656394102039594,first_prior_anomaly_auc= 0.5721902106061196, first_prior_star_anomaly_auc= 0.4656588979650168


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4656394102039594 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5721981733471969 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4656588979650168 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4656394102039594 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.572209907912995 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.465658688419199 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4656394102039594 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5722210138413395 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4656586884191989 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4656394102039594 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5722296052198701 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4656588979650168 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4656394102039594 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.572244902064571 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4656591075108346 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4656394102039594 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5722572652678225 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46565963137537913 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4656394102039594 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5722702571085275 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46565963137537913 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4656394102039594 at iter 0
max_prior_anomaly= 0.5722845062241394 at iter 79
max_prior_star_anomaly= 0.46565963137537913 at iter 55
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4656394102039594
accuracies_anomaly['prior'][-1]= 0.5722845062241394
accuracies_anomaly['prior_star'][-1]= 0.46565963137537913



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.6832664012909 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4656394102039594
 first_prior_anomaly_auc= 0.5722853444074107
 first_prior_star_anomaly_auc= 0.46565963137537913


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 3:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 3 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4685519922987722
accuracies_anomaly["prior"][-1]= 0.4125078108203593
accuracies_anomaly["prior_star"][-1]= 0.46502083094974966


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 379.6857466697693 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003893613815307617 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.47427238357948676
 first_prior_anomaly_auc= 0.41347266453851933
 first_prior_star_anomaly_auc= 0.47105596004883254


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4611856186190679; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41271578504454737; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4608648039719828 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4612277373284501; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4123858551543871; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.46108838935959867 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4610460611043986; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4123149238950544; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4609850832714125 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46096465255417496; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41196550624383677; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4610458515585809 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.549260135626435 at iter 20
0.41347266453851933 at iter 0
0.529929429159474 at iter 20
last anomaly aucs:
0.46115188174239863
0.4115014670302705
0.4611151064513709




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.05440902709961 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46118404702543425,first_prior_anomaly_auc= 0.4133012560595412, first_prior_star_anomaly_auc= 0.4611235930569927


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46118404702543425 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41342876468968565 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611238026028105 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46118404702543425 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.413584771551054 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46112306919244817 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46118404702543425 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.413743397735145 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611227548737214 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46118404702543425 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4138977282299707 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46112275487372134 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46118404702543425 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41406966057349337 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611229644195392 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46118404702543425 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4142678909171527 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611230691924481 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46118404702543425 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41447387445607137 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611229644195392 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.46118404702543425 at iter 0
max_prior_anomaly= 0.41467922935753665 at iter 79
max_prior_star_anomaly= 0.4611238026028105 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46118404702543425
accuracies_anomaly['prior'][-1]= 0.41467922935753665
accuracies_anomaly['prior_star'][-1]= 0.4611224405549947



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.15340638160706 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46118404702543425
 first_prior_anomaly_auc= 0.4147016507600436
 first_prior_star_anomaly_auc= 0.4611221262362679


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46131145088266984; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41516474701742956; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4611740935990877 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46134246366370746; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41516621383815433; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 110 
last prior star auc 0.4611935813601451 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46137001893875096; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4151018832720831; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 110 
last prior star auc 0.4612129643482936 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4613971551221589; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.41497709873757027; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 110 
last prior star auc 0.4612235464120936 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.46139966967197277 at iter 460
0.4152156666511603 at iter 110
0.4612266895993609 at iter 470
last anomaly aucs:
0.4613930689787114
0.41500360628352473
0.46122281300173124




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.19343781471252 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4613903448830798,first_prior_anomaly_auc= 0.4150216272238574, first_prior_star_anomaly_auc= 0.4612240702766382


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4613903448830798 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41531142908990476 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46122459414118283 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613903448830798 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41561694689228884 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46122501323281845 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4613903448830798 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4159639547666016 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612248036870006 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4613903448830798 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4163532908961143 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461225432324454 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4613903448830798 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4167878889222765 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46122511800572735 iter_best_prior_star_anomaly= 410
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4613903448830798 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4172866079686922 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46122627050772536 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4613903448830798 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4177949661227276 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612267943722699 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4613903448830798 at iter 0
max_prior_anomaly= 0.41831914498600864 at iter 79
max_prior_star_anomaly= 0.46122784210135903 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4613903448830798
accuracies_anomaly['prior'][-1]= 0.41831914498600864
accuracies_anomaly['prior_star'][-1]= 0.46122784210135903



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.15825986862183 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4613903448830798
 first_prior_anomaly_auc= 0.41837813213372543
 first_prior_star_anomaly_auc= 0.46122836596590355


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46140637513814303; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4181267819252483; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 30 
last prior star auc 0.46123643347988963 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46140103171978863; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4195994699328992; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 200 
last prior star auc 0.4612436628106045 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4614353972339114; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.42258874579703476; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 300 
last prior star auc 0.4612718467231016 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46130663132885996; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4542499663678963; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 400 
last prior star auc 0.461292486986157 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 403


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 404 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4614663052420401 at iter 360
0.4542499663678963 at iter 400
0.4614048035445094 at iter 390
last anomaly aucs:
0.46130663132885996
0.4542499663678963
0.461292486986157




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 55.13560914993286 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4608348389200344,first_prior_anomaly_auc= 0.5169799167097283, first_prior_star_anomaly_auc= 0.4608303336849512


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4608348389200344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5170295790685521 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608303336849512 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4608348389200344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5171163310371303 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46082960027458886 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4608348389200344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5172179607587738 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46082980982040667 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4608348389200344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5173381352852945 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608289716371353 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4608348389200344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5174520234372807 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608291811829532 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4608348389200344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.517580789342332 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46082939072877105 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4608348389200344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.517697192044132 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46082991459331557 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4608348389200344 at iter 0
max_prior_anomaly= 0.5178199858933755 at iter 79
max_prior_star_anomaly= 0.4608303336849512 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4608348389200344
accuracies_anomaly['prior'][-1]= 0.5178199858933755
accuracies_anomaly['prior_star'][-1]= 0.4608301241391334



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.55128741264343 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4608348389200344
 first_prior_anomaly_auc= 0.5178363304671656
 first_prior_star_anomaly_auc= 0.4608301241391334


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 3:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 3 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.47427227880657785
accuracies_anomaly["prior"][-1]= 0.41347266453851933
accuracies_anomaly["prior_star"][-1]= 0.47105596004883254


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 413.5860390663147 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003473520278930664 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46357276457569274
 first_prior_anomaly_auc= 0.4126057734901909
 first_prior_star_anomaly_auc= 0.46030762164239497


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4611583776627511; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4126648654108167; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 50 
last prior star auc 0.46083829642602847 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46126671285056486; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4141481354822676; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 170 
last prior star auc 0.46080655023462846 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46100656171773924; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4135631883318184; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 170 
last prior star auc 0.46108398889742436 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46106051976582835; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4136443873362242; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 170 
last prior star auc 0.461117306682458 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.544817869061524 at iter 40
0.4142561563513547 at iter 170
0.518899565946793 at iter 30
last anomaly aucs:
0.46131375588666584
0.41378446871543806
0.46117294109708973




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 67.90636873245239 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46134214934498075,first_prior_anomaly_auc= 0.4137921171377885, first_prior_star_anomaly_auc= 0.4611788083799887


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46134214934498075 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43240062394362716 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46121118320884213 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46134214934498075 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42171682564907864 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46118006565489567 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46134214934498075 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4250815028458418 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46117985610907786 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46134214934498075 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4270918854220232 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611800656548956 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46134214934498075 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4272179272314429 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46117786542380845 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46134214934498075 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4270432707922886 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46117576996563026 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46134214934498075 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42934670319469365 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46117964656325994 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46134214934498075 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4219684901762825 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611710551847293 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46134214934498075 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43087795925842576 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46118425657125206 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46134214934498075 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42884787937536906 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461177341559264 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.46134214934498075 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42797197785687435 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611791226987154 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.46134214934498075 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42697453976404304 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611790179258065 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.46134214934498075 at iter 0
max_prior_anomaly= 0.45155237828216854 at iter 6
max_prior_star_anomaly= 0.461224279822456 at iter 7
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46134214934498075
accuracies_anomaly['prior'][-1]= 0.4278301153382091
accuracies_anomaly['prior_star'][-1]= 0.4611790179258065



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.33454036712646 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46134214934498075
 first_prior_anomaly_auc= 0.4281307088138743
 first_prior_star_anomaly_auc= 0.4611806942923491


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 37


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 38 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4613969455763411 at iter 30
0.4281307088138743 at iter 0
0.46121505980647187 at iter 30
last anomaly aucs:
0.4613969455763411
0.41863922622273125
0.46121505980647187




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 5.225383281707764 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.46357265980278384
accuracies_anomaly["prior"][-1]= 0.4126057734901909
accuracies_anomaly["prior_star"][-1]= 0.46030762164239497


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 193.67187213897705 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0037474632263183594 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46750876844474676
 first_prior_anomaly_auc= 0.412760837395379
 first_prior_star_anomaly_auc= 0.4642552553043381


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.461199658188862; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41244756639773555; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4583504637039403 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613108222452164; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4105909904518353; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4611554440213016 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 270


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 271 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5465906266802956 at iter 30
0.412760837395379 at iter 0
0.5220272468235997 at iter 30
last anomaly aucs:
0.46111269667446597
0.41142121098204487
0.4610918468655927




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 36.89271664619446 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4613943262536183,first_prior_anomaly_auc= 0.4059427403480053, first_prior_star_anomaly_auc= 0.46135367436496094


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 58, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 59 iterations

max values 
max_vanilla_star_anomaly= 0.4613943262536183 at iter 0
max_prior_anomaly= 0.43895416939600096 at iter 5
max_prior_star_anomaly= 0.4613645707474876 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4613943262536183
accuracies_anomaly['prior'][-1]= 0.43895416939600096
accuracies_anomaly['prior_star'][-1]= 0.4613645707474876



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 5.436583757400513 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.46750876844474676
accuracies_anomaly["prior"][-1]= 0.412760837395379
accuracies_anomaly["prior_star"][-1]= 0.4642552553043381


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 42.58288264274597 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0035271644592285156 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46785032812779614
 first_prior_anomaly_auc= 0.4129390561134364
 first_prior_star_anomaly_auc= 0.4646460582545755


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4610479470167591; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4123820833296663; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4591567960109182 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4611938956788719; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.41169655418666257; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.461145595367864 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46139715512215895; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4107349484286788; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4612458630416917 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 377


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 378 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5613120585655416 at iter 70
0.41573093981718384 at iter 340
0.5342632557636625 at iter 70
last anomaly aucs:
0.46128295265144614
0.4116457393258408
0.46127079899401247




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 52.08140683174133 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46129929722523616,first_prior_anomaly_auc= 0.41026472761348687, first_prior_star_anomaly_auc= 0.4612893437988897


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46129929722523616 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.411570302831425 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46128881993434506 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46129929722523616 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4147111850947545 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612895533447075 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 298, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 299 iterations

max values 
max_vanilla_star_anomaly= 0.46129929722523616 at iter 0
max_prior_anomaly= 0.421085254554164 at iter 29
max_prior_star_anomaly= 0.4612895533447075 at iter 20
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46129929722523616
accuracies_anomaly['prior'][-1]= 0.421085254554164
accuracies_anomaly['prior_star'][-1]= 0.4612874578865293



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 28.205973386764526 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.46785043290070505
accuracies_anomaly["prior"][-1]= 0.4129390561134364
accuracies_anomaly["prior_star"][-1]= 0.4646462678003933


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 80.5458517074585 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0037698745727539062 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46903185222158383
 first_prior_anomaly_auc= 0.4127620946702859
 first_prior_star_anomaly_auc= 0.46564789680958113


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46106114840328183; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4123044466041634; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.46045556098977714 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4612612646593015; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.41208358531217926; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4603920686069771 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4608241520833255; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.41209196714489216; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4596743741809378 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46097072938289174; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.412088614411807; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4608767480835987 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5465652716363391 at iter 70
0.4127620946702859 at iter 0
0.5180578203966031 at iter 30
last anomaly aucs:
0.46111301099319274
0.41210726398959313
0.46096412868963044




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.83183860778809 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4611225453279036,first_prior_anomaly_auc= 0.41212884720882875, first_prior_star_anomaly_auc= 0.4609635000521769


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4611225453279036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4132493934696303 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609578423150957 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4611225453279036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4160639081217025 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46094987957401856 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4611225453279036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.423482773028771 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46094327888075715 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4611225453279036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43224315026153415 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609427550162125 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4611225453279036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44076977913451715 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46094149774130555 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4611225453279036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4430278448673638 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609259913507868 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4611225453279036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4372830414988728 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609054558606403 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4611225453279036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43188000735924914 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46089937903192346 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4611225453279036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4270265071268628 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608845012788581 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4611225453279036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42254641754183475 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46088125331868185 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4611225453279036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41781696843359895 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608674232947057 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4611225453279036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4150450963554534 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608549553185452 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4611225453279036 at iter 0
max_prior_anomaly= 0.4437438629268605 at iter 57
max_prior_star_anomaly= 0.4609635000521769 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4611225453279036
accuracies_anomaly['prior'][-1]= 0.4147121280509347
accuracies_anomaly['prior_star'][-1]= 0.4608480403065572



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.99532198905945 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4611225453279036
 first_prior_anomaly_auc= 0.414792907963705
 first_prior_star_anomaly_auc= 0.46084751644201266


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46121809822083026; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42171452064508264; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 50 
last prior star auc 0.4608926735657532 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613302052333649; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4229327152569891; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 140 
last prior star auc 0.4611848852087055 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4614031271779669; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4236505144559373; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 260 
last prior star auc 0.4612156884439253 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4614221958473886; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.42222727926129233; count_not_improved_prior_anomaly= 31; iter_best_prior_anomaly= 260 
last prior star auc 0.46122627050772536 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4614318349550084 at iter 480
0.4260416417831008 at iter 260
0.4612297280137194 at iter 460
last anomaly aucs:
0.4614317301820995
0.42038725743499994
0.46122731823681445




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.16343259811401 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4614278535844698,first_prior_anomaly_auc= 0.4220510512285043, first_prior_star_anomaly_auc= 0.46122763255554117


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4614278535844698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4226874418772288 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46122826119299465 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4614278535844698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42324881512317314 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612276325555411 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4614278535844698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42316436815859093 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612297280137194 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4614278535844698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4233883726378424 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46122930892208375 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4614278535844698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42387766212245603 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46122972801371936 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4614278535844698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42472213176827756 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123004233244613 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4614278535844698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4254500939393901 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123088051571737 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4614278535844698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42622604210278386 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612311948344441 iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4614278535844698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4269678342978727 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123213779062433 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4614278535844698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4276333518152745 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612308805157174 iter_best_prior_star_anomaly= 940
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4614278535844698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4280618730127198 iter_best_prior_anomaly= 1070
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123067096989956 iter_best_prior_star_anomaly= 940
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4614278535844698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4285587061467751 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612300423324461 iter_best_prior_star_anomaly= 940
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4614278535844698 at iter 0
max_prior_anomaly= 0.4286460867528068 at iter 125
max_prior_star_anomaly= 0.46123234733644214 at iter 94
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4614278535844698
accuracies_anomaly['prior'][-1]= 0.42861151169286615
accuracies_anomaly['prior_star'][-1]= 0.46123056619699065



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.51143503189087 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4614278535844698
 first_prior_anomaly_auc= 0.42861318805940873
 first_prior_star_anomaly_auc= 0.46123088051571737


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46139652648470547; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44574251093724393; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 40 
last prior star auc 0.46122595618899853 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4614130806043134; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45195124874639214; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 120 
last prior star auc 0.46123810984643226 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4613965264847054; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4509321226614163; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 120 
last prior star auc 0.46123653825279853 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46140218422178664; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45181294850662984; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 120 
last prior star auc 0.4612416721253352 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4614278535844698 at iter 0
0.4578546782989741 at iter 470
0.46124481531260253 at iter 470
last anomaly aucs:
0.4613945357994361
0.44818455789813816
0.4612357000695273




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.07745504379272 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4613989362616104,first_prior_anomaly_auc= 0.4484334983297103, first_prior_star_anomaly_auc= 0.4612364334798897


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4613989362616104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4309332793543307 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612379003006144 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613989362616104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43063279065157434 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123884325679465 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4613989362616104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43033754059426355 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123926234843027 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4613989362616104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4303844788574556 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123873848388575 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4613989362616104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4303620574549487 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123905280261246 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4613989362616104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43055463006152683 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612380050735233 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4613989362616104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4309676448684534 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612389480297035 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4613989362616104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4310283083827128 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612382146193412 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4613989362616104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43098556103587715 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123884325679465 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4613989362616104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43202972784608273 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123915757552136 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4613989362616104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43231963448503913 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612392623484303 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4613989362616104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4334528582678189 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461238424165159 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4613989362616104 at iter 0
max_prior_anomaly= 0.4484334983297103 at iter 0
max_prior_star_anomaly= 0.46123989098588375 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4613989362616104
accuracies_anomaly['prior'][-1]= 0.4338164202617395
accuracies_anomaly['prior_star'][-1]= 0.4612390528026124



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.04934668540955 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4613989362616104
 first_prior_anomaly_auc= 0.4346659190071887
 first_prior_star_anomaly_auc= 0.46123852893806794


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46136446597457875; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3975423628302599; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.46120122978249567 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46136959984711534; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4012653633754981; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4612145359419273 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4613955835285253; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4048649414340394; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4612318234718976 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4613839537356361; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40329795780836863; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.46123077574280846 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4613989362616104 at iter 0
0.4346659190071887 at iter 0
0.46123852893806794 at iter 0
last anomaly aucs:
0.461392335568349
0.4089121093594478
0.4612329759738956




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.1425359249115 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4613862587396322,first_prior_anomaly_auc= 0.41051534441160165, first_prior_star_anomaly_auc= 0.46123025187826394


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4613862587396322 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4213111449457758 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123433802171143 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613862587396322 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4176742677316624 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612327664280778 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4613862587396322 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41744691051932575 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123287120098677 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4613862587396322 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4167575047786924 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123150915317085 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4613862587396322 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41644622446631824 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612304614240818 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4613862587396322 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4167589715994171 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123025187826394 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4613862587396322 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41686468746450817 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612297280137193 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4613862587396322 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41745487326040304 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612288898304481 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4613862587396322 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4178783653582207 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612281564200857 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4613862587396322 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4182616246590165 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46122648005354316 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4613862587396322 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.418812311068252 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46122648005354316 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4613862587396322 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41919242718178057 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612256418702719 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4613862587396322 at iter 0
max_prior_anomaly= 0.4221507950377874 at iter 8
max_prior_star_anomaly= 0.4612350714320738 at iter 9
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4613862587396322
accuracies_anomaly['prior'][-1]= 0.4193266412780953
accuracies_anomaly['prior_star'][-1]= 0.4612253275515451



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.43711304664612 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4613862587396322
 first_prior_anomaly_auc= 0.4196015653910774
 first_prior_star_anomaly_auc= 0.461225432324454


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 78


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 79 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4614162237915807 at iter 60
0.4196015653910774 at iter 0
0.461241986444062 at iter 60
last anomaly aucs:
0.4614116137835886
0.41532504956806315
0.461236014388254




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 10.635528326034546 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 4:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 4 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4690318522215838
accuracies_anomaly["prior"][-1]= 0.4127620946702859
accuracies_anomaly["prior_star"][-1]= 0.4656478968095811


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 785.0666463375092 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003174304962158203 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.47319007943043767
 first_prior_anomaly_auc= 0.4122753197354861
 first_prior_star_anomaly_auc= 0.4697324686634706


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4616658976335153; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41232309618194946; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 60 
last prior star auc 0.4580168667619681 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.461210240252662; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41303963810599076; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 130 
last prior star auc 0.46118058951944024 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46117650337599264; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41264097718758497; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 130 
last prior star auc 0.46117136950345605 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.461224279822456; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4119796505865397; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 130 
last prior star auc 0.4611695883640046 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5528235670314021 at iter 60
0.41347685545487584 at iter 130
0.5271477084278908 at iter 60
last anomaly aucs:
0.46117346496163425
0.4113709199857677
0.4611447571845927




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.02707886695862 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46117880837998876,first_prior_anomaly_auc= 0.4113627476988726, first_prior_star_anomaly_auc= 0.46114611923240856


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46117880837998876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4114371364641993 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46114622400531746 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46117880837998876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41150628658408045 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46114601445949965 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46117880837998876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4115799419390448 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611453858220461 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46117880837998876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41165338774819127 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46114538582204617 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46117880837998876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4117474738203933 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611457001407729 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46117880837998876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41183663556587635 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611455953678639 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46117880837998876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41194549461823476 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611451762762283 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46117880837998876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41204901025223867 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611446524116838 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46117880837998876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4121838529860069 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611448619575016 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46117880837998876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41232477254849204 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46114517627622836 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.46117880837998876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4124934569318385 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46114475718459264 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.46117880837998876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41267240906025826 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611446524116838 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.46117880837998876 at iter 0
max_prior_anomaly= 0.4128568093799414 at iter 129
max_prior_star_anomaly= 0.46114632877822637 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46117880837998876
accuracies_anomaly['prior'][-1]= 0.4128568093799414
accuracies_anomaly['prior_star'][-1]= 0.461144442865866



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.24057030677795 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46117880837998876
 first_prior_anomaly_auc= 0.4128825835155334
 first_prior_star_anomaly_auc= 0.46114475718459264


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4612003915992243; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4125382997368523; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4611427664993234 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46121317389411154; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41234729872390785; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.46114046149532734 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4612310900615352; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.41212591356737927; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.46114381422841244 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4612107641172065; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4118524562751219; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4611418235431432 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4612529875994976 at iter 260
0.4128825835155334 at iter 0
0.46114727173440656 at iter 50
last anomaly aucs:
0.4612109736630243
0.41171415603535966
0.4611410901327808




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.09774827957153 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46120447774267187,first_prior_anomaly_auc= 0.4116973923699338, first_prior_star_anomaly_auc= 0.46113972808496495


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46120447774267187 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41192401617190805 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46113962331205605 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46120447774267187 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4122151800857713 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46114014717660057 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46120447774267187 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.412489370788391 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46114046149532734 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46120447774267187 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41280840429602456 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46114150922441643 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46120447774267187 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41316389877595905 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611418235431432 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46120447774267187 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4135684269772638 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46114224263477877 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46120447774267187 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4140067968281469 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611429760451412 iter_best_prior_star_anomaly= 660
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46120447774267187 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4144962958585784 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461143185590959 iter_best_prior_star_anomaly= 750
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46120447774267187 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4150312663314772 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46114370945550354 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46120447774267187 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41562155690028096 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611445476387748 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.46120447774267187 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4163024760352926 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611448619575016 iter_best_prior_star_anomaly= 1030
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.46120447774267187 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41701828454897144 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46114570014077294 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.46120447774267187 at iter 0
max_prior_anomaly= 0.41770800460833163 at iter 129
max_prior_star_anomaly= 0.46114590968659075 at iter 125
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46120447774267187
accuracies_anomaly['prior'][-1]= 0.41770800460833163
accuracies_anomaly['prior_star'][-1]= 0.46114580491368184



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.40764379501343 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46120447774267187
 first_prior_anomaly_auc= 0.4177764213178504
 first_prior_star_anomaly_auc= 0.46114580491368173


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4612098211610264; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4176575040662366; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 30 
last prior star auc 0.4611469574156798 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4612123357108402; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.41749248673470196; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 30 
last prior star auc 0.4611476908260422 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46125340669113324; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.41833203205380465; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 300 
last prior star auc 0.46117755110508174 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46120531592594316; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4183301461414443; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 300 
last prior star auc 0.4611513578778541 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4612573880616718 at iter 290
0.41833203205380465 at iter 300
0.4611775511050818 at iter 290
last anomaly aucs:
0.46116937881818676
0.4147854690871723
0.461125583742262




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.04861617088318 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46129395380688176,first_prior_anomaly_auc= 0.4351803539899409, first_prior_star_anomaly_auc= 0.461269017854561


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46129395380688176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4358914477227189 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46126922740037873 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46129395380688176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.436540096801786 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46126912262746983 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46129395380688176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43718141177722936 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612691226274699 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46129395380688176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4379078023547082 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612692274003788 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46129395380688176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43865609047014953 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612694369461966 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46129395380688176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43943748682480666 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612691226274699 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46129395380688176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4403102451560341 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612691226274699 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46129395380688176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44118750872234463 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612691226274699 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46129395380688176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44209201324497205 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46126964649201435 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46129395380688176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44306933493929246 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612693321732877 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.46129395380688176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44405692437868616 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612697512649233 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.46129395380688176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44500396670233133 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612698560378322 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.46129395380688176 at iter 0
max_prior_anomaly= 0.4459667249623132 at iter 129
max_prior_star_anomaly= 0.46127006558365 at iter 109
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46129395380688176
accuracies_anomaly['prior'][-1]= 0.4459667249623132
accuracies_anomaly['prior_star'][-1]= 0.46127006558365



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.27936482429504 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46129395380688176
 first_prior_anomaly_auc= 0.4460494955603528
 first_prior_star_anomaly_auc= 0.4612699608107412


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 2


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 3 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.46129395380688176 at iter 0
0.4460494955603528 at iter 0
0.4612699608107412 at iter 0
last anomaly aucs:
0.46129395380688176
0.4460494955603528
0.4612699608107412




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 0.5218708515167236 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4613502168589669,first_prior_anomaly_auc= 0.49566198247945514, first_prior_star_anomaly_auc= 0.4613352343329926


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 1, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 2 iterations

max values 
max_vanilla_star_anomaly= 0.4613502168589669 at iter 0
max_prior_anomaly= 0.49566198247945514 at iter 0
max_prior_star_anomaly= 0.4613352343329926 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4613502168589669
accuracies_anomaly['prior'][-1]= 0.49566198247945514
accuracies_anomaly['prior_star'][-1]= 0.4613352343329926



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 0.27854299545288086 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 4:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 4 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.47319007943043767
accuracies_anomaly["prior"][-1]= 0.4122753197354861
accuracies_anomaly["prior_star"][-1]= 0.4697324686634706


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 581.1515786647797 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0035257339477539062 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4611552344754837
 first_prior_anomaly_auc= 0.41210569239595946
 first_prior_star_anomaly_auc= 0.4578293232550177


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5508617990849554; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41212738038810404; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 40 
last prior star auc 0.5214859899761662 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613625800622183; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4117158324019021; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 40 
last prior star auc 0.4610059330802858 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46110127642739474; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41098326022279746; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 40 
last prior star auc 0.46113606103315313 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46099356987703427; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4109258446687144; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 40 
last prior star auc 0.46108713208469165 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5529273969841328 at iter 90
0.4121482301969772 at iter 40
0.5233675018743873 at iter 90
last anomaly aucs:
0.46101295286518285
0.4109853556809757
0.46109519959867784




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.13776898384094 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4610185058293551,first_prior_anomaly_auc= 0.4109958329718668, first_prior_star_anomaly_auc= 0.461096247327767


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4610185058293551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41102181665327675 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610958282361314 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4610185058293551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4111030156576826 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610954091444957 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4610185058293551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41115927870976776 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46109478050704217 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4610185058293551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4112288479212845 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46109446618831545 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4610185058293551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41130470350733594 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46109320891340855 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4610185058293551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.411396379802633 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610925802759551 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4610185058293551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4114895229186547 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610920564114105 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4610185058293551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4116065542579081 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610921611843194 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4610185058293551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41171583240190224 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46109142777395706 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4610185058293551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4118423980758665 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46109132300104816 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4610185058293551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4119749358056387 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610910086823214 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4610185058293551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41210904512904467 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610906943635947 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4610185058293551 at iter 0
max_prior_anomaly= 0.412249545599894 at iter 129
max_prior_star_anomaly= 0.4610963521006758 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4610185058293551
accuracies_anomaly['prior'][-1]= 0.412249545599894
accuracies_anomaly['prior_star'][-1]= 0.4610900657261412



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.58064699172974 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4610185058293551
 first_prior_anomaly_auc= 0.412260127663694
 first_prior_star_anomaly_auc= 0.4610900657261412


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4610907991365036; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4121419438224426; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 30 
last prior star auc 0.46111877350318276 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4611594253918402; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.41194842825968425; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 30 
last prior star auc 0.4611365848976976 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46120772570284807; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41166994186779926; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 30 
last prior star auc 0.46114611923240856 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46124282462733324; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.41219715914543864; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 330 
last prior star auc 0.4611617303958362 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.46126126465930156 at iter 490
0.41238480742529793 at iter 330
0.46116738813291747 at iter 490
last anomaly aucs:
0.46126126465930156
0.41205760163076943
0.46116738813291747




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.07788300514221 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46126524602984015,first_prior_anomaly_auc= 0.41205183912077925, first_prior_star_anomaly_auc= 0.4611686454078244


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46126524602984015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4122109891694149 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611682263161887 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46126524602984015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4123819785567574 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46116833108909766 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46126524602984015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41257654184860487 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611682263161887 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46126524602984015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4128153193080127 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611688549536422 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46126524602984015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41307735635319864 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611691692723689 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46126524602984015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4133500802350937 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46116916927236895 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46126524602984015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41365884599765396 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46116937881818676 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46126524602984015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4139803940551014 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611692740452778 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46126524602984015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41433222148322396 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611692740452778 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46126524602984015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41472103374819214 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46116927404527785 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.46126524602984015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41509423484973257 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611695883640045 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.46126524602984015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4155708468123681 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46116927404527785 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.46126524602984015 at iter 0
max_prior_anomaly= 0.4160081689341619 at iter 129
max_prior_star_anomaly= 0.4611701122285491 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46126524602984015
accuracies_anomaly['prior'][-1]= 0.4160081689341619
accuracies_anomaly['prior_star'][-1]= 0.4611701122285491



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.8093683719635 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46126524602984015
 first_prior_anomaly_auc= 0.4160473540020946
 first_prior_star_anomaly_auc= 0.4611700074556402


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46127593286654905; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4157562948611403; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4611727315512718 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613058979184976; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.41605185923717775; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 200 
last prior star auc 0.4611814277027114 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4613153274802995; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.41638639913533015; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 300 
last prior star auc 0.46118498998161445 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.461319518396656; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4165944781324271; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 400 
last prior star auc 0.46118582816488574 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4613256999982817 at iter 470
0.4169175977835081 at iter 490
0.4611898095354244 at iter 490
last anomaly aucs:
0.46132538567955494
0.4169175977835081
0.4611898095354244




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.17043805122375 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46132727159191544,first_prior_anomaly_auc= 0.4168445710659973, first_prior_star_anomaly_auc= 0.4611899143083333


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46132727159191544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4174557114436743 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611895999896065 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46132727159191544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4181397737659533 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611899143083332 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46132727159191544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4188778989092302 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611908572645135 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46132727159191544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4196610764033389 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119169544778477 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46132727159191544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4204574552839702 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611918002206936 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46132727159191544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4212952194636214 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119400045178083 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46132727159191544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4220491653161439 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119504818086987 iter_best_prior_star_anomaly= 670
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46132727159191544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42273825673805054 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611955720454144 iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46132727159191544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42341865200851764 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611958863641412 iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46132727159191544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42396567136594115 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119693409323026 iter_best_prior_star_anomaly= 980
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.46132727159191544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42443065353568754 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611963054557767 iter_best_prior_star_anomaly= 980
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.46132727159191544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4248709092989309 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461197353184866 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.46132727159191544 at iter 0
max_prior_anomaly= 0.4253003734525565 at iter 129
max_prior_star_anomaly= 0.4611981913681372 at iter 125
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46132727159191544
accuracies_anomaly['prior'][-1]= 0.4253003734525565
accuracies_anomaly['prior_star'][-1]= 0.4611981913681372



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.88712859153748 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46132727159191544
 first_prior_anomaly_auc= 0.4253406062495783
 first_prior_star_anomaly_auc= 0.4611978770494105


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4613165847552064; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4263119558880908; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.4611951529537788 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613284240939134; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4278045507484348; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 200 
last prior star auc 0.4611999725075887 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46135063595060255; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.42816601728417725; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 230 
last prior star auc 0.46121547889810754 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 332


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 333 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.46137892463600844 at iter 270
0.431830764092061 at iter 330
0.46132203294646984 at iter 330
last anomaly aucs:
0.46136090369567573
0.431830764092061
0.46132203294646984




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 46.15045881271362 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4613595416478599,first_prior_anomaly_auc= 0.4483612050225619, first_prior_star_anomaly_auc= 0.46135807482713515


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 1, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 2 iterations

max values 
max_vanilla_star_anomaly= 0.4613595416478599 at iter 0
max_prior_anomaly= 0.4483612050225619 at iter 0
max_prior_star_anomaly= 0.46135807482713515 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4613595416478599
accuracies_anomaly['prior'][-1]= 0.4483612050225619
accuracies_anomaly['prior_star'][-1]= 0.46135807482713515



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 0.28888654708862305 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 4:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 4 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4611551297025748
accuracies_anomaly["prior"][-1]= 0.41210569239595946
accuracies_anomaly["prior_star"][-1]= 0.4578293232550177


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 628.3776071071625 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003238677978515625 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.45988811091511594
 first_prior_anomaly_auc= 0.41227364336894357
 first_prior_star_anomaly_auc= 0.4564737713595291


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4764871781009533; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41215765975877916; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.46345793346752645 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5290815020076585; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41214037222880895; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5111625057153621 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5420749143062378; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4121371242686327; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5194287739097017 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5449159365042644; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.41213272380645843; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5186401482243297 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5453155403788504 at iter 360
0.41227364336894357 at iter 0
0.519947714127537 at iter 330
last anomaly aucs:
0.5431737725748949
0.4121261231131971
0.5169772973870056




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.89109539985657 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5432441799696829,first_prior_anomaly_auc= 0.4121240276550189, first_prior_star_anomaly_auc= 0.5169876699049878


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.543244075196774 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42857840345365034 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5081672577954187 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.543244075196774 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4310820568849841 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5073846041658547 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5432438656509562 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4309330698085128 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5074592024769993 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5432438656509562 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4301810098683507 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5076090277367418 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5432438656509562 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4296313711882044 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5078495863356011 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5432439704238651 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.42952261690875493 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5081601332376129 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.543244075196774 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.429648344399448 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5085316579726107 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5432443895155007 at iter 56
max_prior_anomaly= 0.4414998367638079 at iter 6
max_prior_star_anomaly= 0.5169876699049878 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.543244075196774
accuracies_anomaly['prior'][-1]= 0.42957123153848953
accuracies_anomaly['prior_star'][-1]= 0.5089073736239651



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.08701229095459 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5432438656509562
 first_prior_anomaly_auc= 0.42959291953063417
 first_prior_star_anomaly_auc= 0.5089205750104877


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5491613347733322; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42806522574580497; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.5134702338070326 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5603628160108092; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.421641179608845; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.5225280613281936 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5681773034219252; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41489045154190096; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.5286664965154626 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.571102667811625; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4167189483482132; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.5308533166702499 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.571102667811625 at iter 400
0.42964939212853703 at iter 20
0.5308730139771252 at iter 410
last anomaly aucs:
0.5698085128407582
0.4258203613994811
0.5301884277903016




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.93484282493591 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.56955726740519,first_prior_anomaly_auc= 0.42680899856796395, first_prior_star_anomaly_auc= 0.5300421648094621


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.56955726740519 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4218283040241597 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.529326565841601 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5695574769510078 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42513388930029716 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5291491853068149 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5695574769510078 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4274062041487557 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5292517579846386 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.56955726740519 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4284912323934365 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5293925727742148 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5695573721780989 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4290176114878046 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5295323398347018 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5695574769510078 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4289568432006363 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5297288938118186 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5695574769510078 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.43078492091531284 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5301837130094007 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5695574769510078 at iter 1
max_prior_anomaly= 0.4312634187903088 at iter 76
max_prior_star_anomaly= 0.534782195981498 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5695574769510078
accuracies_anomaly['prior'][-1]= 0.4308345832741366
accuracies_anomaly['prior_star'][-1]= 0.5303753426597986



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.38014197349548 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5695574769510078
 first_prior_anomaly_auc= 0.4315231508314987
 first_prior_star_anomaly_auc= 0.5304922692261431


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5644617417532196; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43069879758418816; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.524683030518672 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5620442116530106; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43070152167981984; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.5224837423877242 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.562120067239062; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4305542109698912; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.5224153256782056 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5640881215600435; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.429264037369563; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.5236088986565179 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5695574769510078 at iter 0
0.4317863403786828 at iter 10
0.5304922692261431 at iter 0
last anomaly aucs:
0.5666141963938841
0.42850652923813753
0.5251861500272619




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.98324227333069 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5668912159650444,first_prior_anomaly_auc= 0.42774839246925855, first_prior_star_anomaly_auc= 0.525229526011551


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5668912159650444 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.416748494308526 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5268645072551048 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5668912159650444 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41797810916750383 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5251924364017966 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5668912159650444 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41654041531142905 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5248311794118719 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5668912159650444 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41718193983269025 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5247722970370641 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5668910064192266 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4183777130420898 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5248984436193926 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5668912159650444 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4134579963312718 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.525315335023949 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5668912159650444 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41892326557878856 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5252502710475153 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5668912159650444 at iter 0
max_prior_anomaly= 0.42774839246925855 at iter 0
max_prior_star_anomaly= 0.5340514049418448 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5668910064192265
accuracies_anomaly['prior'][-1]= 0.4179192267926959
accuracies_anomaly['prior_star'][-1]= 0.5249219127509888



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.86314916610718 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5668912159650444
 first_prior_anomaly_auc= 0.4189438010689351
 first_prior_star_anomaly_auc= 0.5257952997196697


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5698397351676137; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4133005226491788; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5259075115051132 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.573295774340947; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41295760091831357; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.528051269994338 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.576871045084621; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4119536669051298; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5301048190089908 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5802550004966236; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4124513382224564; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5323019069088513 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5829483976659948 at iter 490
0.4189438010689351 at iter 0
0.5338528602794587 at iter 490
last anomaly aucs:
0.5829483976659948
0.41232854437321276
0.5338528602794587




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.89240956306458 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5831765930616026,first_prior_anomaly_auc= 0.411952304857314, first_prior_star_anomaly_auc= 0.5339389836105835


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5831764882886938 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41068381924913033 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.535783510671959 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5831764882886937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4117181374058982 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5344373883382723 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5831764882886937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41188849815578726 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5346891576383851 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5831764882886937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41470227939749704 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5370686551726594 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5831764882886937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41249366647765634 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5348112180772663 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5831764882886937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41247292144169195 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5356229985755075 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5831764882886938 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4121818623007376 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5355161302084184 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5831766978345116 at iter 76
max_prior_anomaly= 0.42707784585222913 at iter 5
max_prior_star_anomaly= 0.5488305666999006 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5831764882886937
accuracies_anomaly['prior'][-1]= 0.40867113166895275
accuracies_anomaly['prior_star'][-1]= 0.5357524978909214



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.44941663742065 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5831764882886937
 first_prior_anomaly_auc= 0.4104443083793601
 first_prior_star_anomaly_auc= 0.5352873061753571


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5867959731999282; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4088303864904973; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 60 
last prior star auc 0.5383087473225283 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.58853310802967; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.41330754243407586; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 60 
last prior star auc 0.5399511674426147 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5897551792392062; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41196875420401297; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 280 
last prior star auc 0.5405313998121631 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5901872627155546; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.41275287465430177; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 340 
last prior star auc 0.5407906079888085 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5904885896015821 at iter 490
0.41490889157386934 at iter 340
0.5417754733325706 at iter 340
last anomaly aucs:
0.5904885896015821
0.41192328276154566
0.5400892581365593




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.01723384857178 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.590364119385796,first_prior_anomaly_auc= 0.4141120936016023, first_prior_star_anomaly_auc= 0.5406780818846383


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5903641193857961 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41894956357892527 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5424822713760832 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5903641193857961 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.42311784898703453 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5425007114080516 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5903645384774316 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.42422404135931535 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5428196401427762 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.590364119385796 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4235321210688681 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5426777776241108 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.590364224158705 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4238489543454145 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5427685109632276 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.590364224158705 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4240664629043134 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5429368810278474 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5903644337045229 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4225365688883972 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5432012230770294 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5903645384774318 at iter 5
max_prior_anomaly= 0.42478352869289926 at iter 44
max_prior_star_anomaly= 0.5539641249178057 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5903641193857961
accuracies_anomaly['prior'][-1]= 0.4242249843154956
accuracies_anomaly['prior_star'][-1]= 0.5437594531357065



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.58986353874207 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.590364119385796
 first_prior_anomaly_auc= 0.4221307834121854
 first_prior_star_anomaly_auc= 0.5434428294049779


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5892781481849351; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4183842089624422; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5421991749762061 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5881889290238979; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4207235784726038; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 120 
last prior star auc 0.5414048915537529 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5859888027096789; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41952298570939434; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 220 
last prior star auc 0.539251598729817 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5835714821552876; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4213934964521797; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 340 
last prior star auc 0.5378433460611464 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.590364119385796 at iter 0
0.4255444943303188 at iter 340
0.5434914440347125 at iter 60
last anomaly aucs:
0.5804360480832216
0.4209614129758314
0.5348665381731712




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.05850434303284 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.580154628049887,first_prior_anomaly_auc= 0.41987282245224766, first_prior_star_anomaly_auc= 0.5347348386266703


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.580154628049887 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41916392895055676 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5356330567747629 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5801544185040691 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42004171638141197 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5360879807452539 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.580154628049887 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4233993737932781 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5355888426072025 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.580154628049887 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4237774992215373 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.535876234696345 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.580154628049887 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4232890479201949 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5362962692881686 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.580154628049887 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4245495707873014 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5363203670572181 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.580154628049887 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.42477074639801216 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5369296215225348 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.580154732822796 at iter 33
max_prior_anomaly= 0.42629812586411453 at iter 74
max_prior_star_anomaly= 0.5444054828920508 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.580154628049887
accuracies_anomaly['prior'][-1]= 0.4258099888814989
accuracies_anomaly['prior_star'][-1]= 0.5366336380548616



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.57463002204895 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.580154628049887
 first_prior_anomaly_auc= 0.42568897617170687
 first_prior_star_anomaly_auc= 0.5367314959517844


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5769716270771753; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4223723897401338; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5332308235192549 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5731130503878065; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4238130172376581; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5312287180028775 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5687700037676338; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4191769207912618; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5268369519800613 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.565440320722447; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4231802936407454; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 320 
last prior star auc 0.5248060339137334 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.580154628049887 at iter 0
0.43039160341526156 at iter 320
0.5367314959517844 at iter 0
last anomaly aucs:
0.5613921050679493
0.42477808050163596
0.5223803315266293




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.09552073478699 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5612672157605276,first_prior_anomaly_auc= 0.42887071986951164, first_prior_star_anomaly_auc= 0.5232009129492191


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5612672157605276 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.427436378746522 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5247161387578878 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5612674253063455 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4313198913882117 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5244030773060622 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5612674253063455 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.43216561830894007 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.524389247282086 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5612672157605276 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.43283805083833 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.524547873466177 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5612674253063455 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.43225572301060344 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.524550178470173 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5612672157605276 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4311198799051009 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5244715987884899 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5612674253063455 iter_best_vanilla_star_anomaly= 610 
last prior auc 0.4299190775960736 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5242310401896306 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5612674253063457 at iter 61
max_prior_anomaly= 0.4329727887991893 at iter 58
max_prior_star_anomaly= 0.5305744111867292 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5612674253063455
accuracies_anomaly['prior'][-1]= 0.43079036910657625
accuracies_anomaly['prior_star'][-1]= 0.5245839153468423



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.09147524833679 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5612672157605276
 first_prior_anomaly_auc= 0.4322358161579104
 first_prior_star_anomaly_auc= 0.5247567906465452


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.556049734442585; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4259448316152672; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.518629251841803 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5518393303250936; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4237541348628502; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5149703723168182 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5473332570586557; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42156783857260743; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5111199679143443 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5430432255303919; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4268921882576391; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5094465350132202 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5612672157605276 at iter 0
0.4322358161579104 at iter 0
0.5247567906465452 at iter 0
last anomaly aucs:
0.5405370575492443
0.4298239437947826
0.5085156277175473




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.06468963623047 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5396541362458525,first_prior_anomaly_auc= 0.42630147859719975, first_prior_star_anomaly_auc= 0.5065962927992094


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5396539267000348 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.43017451394799827 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5095437642726895 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5396541362458526 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.43188168372579167 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5088952199665313 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5396540314729437 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.43699481122645906 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5095565465675767 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5396543457916704 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4368190022853067 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5093887003675015 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5396542410187615 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4372125293311758 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5095695384082816 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5396539267000349 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4373889669097818 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5096697013092004 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5396543457916704 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.438099746323833 iter_best_prior_anomaly= 650
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5098538920830656 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5396546601103971 at iter 58
max_prior_anomaly= 0.4401178820952738 at iter 79
max_prior_star_anomaly= 0.5112159398989067 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5396540314729437
accuracies_anomaly['prior'][-1]= 0.4401178820952738
accuracies_anomaly['prior_star'][-1]= 0.5103957775679525



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.66503429412842 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.45988811091511594
accuracies_anomaly["prior"][-1]= 0.41227364336894357
accuracies_anomaly["prior_star"][-1]= 0.45647377135952905


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 1157.8570108413696 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0036764144897460938 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4600601480315476
 first_prior_anomaly_auc= 0.41229009271564254
 first_prior_star_anomaly_auc= 0.45681774081948345


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4754924641037537; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41230937093088216; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 100 
last prior star auc 0.46272483742387727 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5273726558633225; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4123441555366405; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 200 
last prior star auc 0.509366907602448 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5410001538066302; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41237673991131185; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 290 
last prior star auc 0.5181435246360923 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5440580559261023; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4123842835607534; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 340 
last prior star auc 0.5181326282535654 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5447229448060507 at iter 370
0.4123886840229276 at iter 340
0.5196001823886798 at iter 340
last anomaly aucs:
0.542508359830402
0.4123843883336623
0.5164893699502078




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.03578352928162 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5425078359658575,first_prior_anomaly_auc= 0.4123840740149356, first_prior_star_anomaly_auc= 0.516466739001883


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5425078359658575 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4162315447759599 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.507601588860209 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5425079407387664 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.42747409699372996 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5066912170546827 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5425078359658575 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.42640185104393624 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5066992845686688 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5425078359658575 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.42591004700950874 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5068680737249243 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5425078359658575 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.42622436573624134 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5071602853678765 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5425078359658575 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4265592199531204 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5075352676088685 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5425078359658575 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4271098015894469 iter_best_prior_anomaly= 650
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.507877770248098 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5425079407387664 at iter 4
max_prior_anomaly= 0.42835712307003065 at iter 65
max_prior_star_anomaly= 0.516466739001883 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5425077311929485
accuracies_anomaly['prior'][-1]= 0.42741647189382903
accuracies_anomaly['prior_star'][-1]= 0.5082240447120484



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.52135944366455 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5425079407387664
 first_prior_anomaly_auc= 0.4273865068418805
 first_prior_star_anomaly_auc= 0.5082755929832327


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5451724205852782; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42480270213522997; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.510261144380002 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5518553605801569; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4190840919939667; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.5153190565576735 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5553162193073002; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41631965879235394; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.5177564935105756 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.554691248905647; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 330 
last prior auc 0.41944409170898445; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.5164850742609424 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5554485474912546 at iter 330
0.4273879736626053 at iter 20
0.5177813246899874 at iter 310
last anomaly aucs:
0.5524662914120161
0.42542683435361195
0.5140232252202641




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.07525396347046 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5522037305022856,first_prior_anomaly_auc= 0.4260140865080573, first_prior_star_anomaly_auc= 0.5137967061911988


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5522037305022856 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4193370137960776 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5117838090652036 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5522037305022856 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41855980835777684 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5115778255262848 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5522039400481034 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41807554797279095 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5113395719314215 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5522039400481034 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4193204596764697 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5117027148337066 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5522037305022856 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4198202264519744 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5120210149309777 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5522037305022856 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.419748980873915 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5120522372578331 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5522039400481034 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4201963611949644 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5123664512116568 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5522039400481034 at iter 2
max_prior_anomaly= 0.4260140865080573 at iter 0
max_prior_star_anomaly= 0.5137967061911988 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5522037305022856
accuracies_anomaly['prior'][-1]= 0.4199671180702674
accuracies_anomaly['prior_star'][-1]= 0.512645880559722



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.89588236808777 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5522037305022856
 first_prior_anomaly_auc= 0.4178710312545969
 first_prior_star_anomaly_auc= 0.5123621555223915


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5475115805496218; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4140632694260498; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.506483976240857 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.544797752663013; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.412769114455183; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.5039343275025114 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5456332118386682; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4107206993130669; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.5038346884661371 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5479621040579385; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40896533399717455; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.5051715907838397 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5522037305022856 at iter 0
0.41971377717652103 at iter 10
0.5123621555223915 at iter 0
last anomaly aucs:
0.550639890063882
0.4068165464083219
0.506639144918954




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.09430837631226 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5509173287266781,first_prior_anomaly_auc= 0.4063080834813774, first_prior_star_anomaly_auc= 0.5068869328485281


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5509173287266781 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4245928419986815 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5161159593028495 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5509176430454048 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4131576124014244 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5123707469009221 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5509173287266781 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41247836963295537 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5109158702877861 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5509173287266781 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4118602094703813 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5104348578629763 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5509173287266781 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41113727639889647 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5103243224440753 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5509173287266781 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41131916216876574 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.51036235501001 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5509175382724959 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4085303168793766 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5105080941263049 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5509176430454048 at iter 20
max_prior_anomaly= 0.4354540208280161 at iter 5
max_prior_star_anomaly= 0.5195010672168502 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5509173287266781
accuracies_anomaly['prior'][-1]= 0.4097563694594514
accuracies_anomaly['prior_star'][-1]= 0.5102468952643903



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.48663091659546 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5509175382724959
 first_prior_anomaly_auc= 0.4094106188600456
 first_prior_star_anomaly_auc= 0.5102308650093269


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5539611912763561; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4125309656332286; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 40 
last prior star auc 0.5130989186178525 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5566859155454917; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41241760134578703; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 40 
last prior star auc 0.5148224329694361 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5592467749850909; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4120566586745892; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 40 
last prior star auc 0.5163406971924632 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5613819420957851; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4114344123685676; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 40 
last prior star auc 0.5175835134379637 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5628684601274122 at iter 490
0.4136403011927767 at iter 40
0.5182097411145239 at iter 490
last anomaly aucs:
0.5628684601274122
0.4105381849057442
0.5182097411145239




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.10892581939697 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.563010846510622,first_prior_anomaly_auc= 0.4101935868083364, first_prior_star_anomaly_auc= 0.518276691003318


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.563010846510622 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42213120250382113 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5275644950595382 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.563010846510622 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42528287637676837 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5253148111594044 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.563010846510622 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.4186538944299788 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5219792608313185 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.563010846510622 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.4134810463712322 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5203546521057469 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.563010846510622 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.4082945778343272 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5205675506566537 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.563010846510622 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.415186644555392 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5216400061522652 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.563010846510622 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.41200291017231794 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5208324165703804 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5630110560564399 at iter 75
max_prior_anomaly= 0.42546664805899803 at iter 21
max_prior_star_anomaly= 0.5316711739972081 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.563010846510622
accuracies_anomaly['prior'][-1]= 0.41295843910158486
accuracies_anomaly['prior_star'][-1]= 0.5204117533411033



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.90632271766663 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.563010846510622
 first_prior_anomaly_auc= 0.4150794618695762
 first_prior_star_anomaly_auc= 0.5210516014958219


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5644699140401146; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4125695220637078; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5209642208897902 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5657600876404429; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4135793233597906; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5218878988547483 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5667070251911791; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41264935902029787; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5220773282740592 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5674204239279531; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.412499952852191; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5222782827133501 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5677985493562124 at iter 490
0.4150794618695762 at iter 0
0.5225563500135995 at iter 460
last anomaly aucs:
0.5677985493562124
0.4122603372095119
0.5224138588574807




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.10289692878723 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5678134271092777,first_prior_anomaly_auc= 0.4125045628601831, first_prior_star_anomaly_auc= 0.5224601684832193


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5678134271092777 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4127174614110899 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5232184100250072 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5678134271092777 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4113656813403221 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5237228915814129 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5678134271092777 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.41442693619287935 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5234980489188903 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5678134271092777 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.41320182656898474 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5237906796534783 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5678134271092777 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.41463773928560804 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5238085958209021 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5678134271092777 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.4137832114405311 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5242557665961335 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5678134271092777 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.4157703344309343 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5241987701336861 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5678137414280044 at iter 56
max_prior_anomaly= 0.42512089745959225 at iter 5
max_prior_star_anomaly= 0.5311479380901072 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5678134271092777
accuracies_anomaly['prior'][-1]= 0.41591031103723924
accuracies_anomaly['prior_star'][-1]= 0.5252171628082996



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.69246125221252 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5678134271092777
 first_prior_anomaly_auc= 0.41439780932420217
 first_prior_star_anomaly_auc= 0.5245522739283512


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5688033215526673; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4230277442853712; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 100 
last prior star auc 0.527328546468671 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5680606911743074; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4183860948748026; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 100 
last prior star auc 0.5254444152477271 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5672445102138918; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4199136838867229; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 100 
last prior star auc 0.525147384050965 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5660463272275873; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.42039878245498014; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 100 
last prior star auc 0.5242088283329415 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5688263715926278 at iter 90
0.4230277442853712 at iter 100
0.5273386046679265 at iter 90
last anomaly aucs:
0.5650884932943243
0.41393659897917656
0.5212883882699604




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.12603831291199 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.565195780753049,first_prior_anomaly_auc= 0.41281898635982456, first_prior_star_anomaly_auc= 0.5216024974508751


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.565195780753049 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4117910593505002 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5234511106556983 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.565195780753049 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4190151514199034 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5236316343777516 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.565195780753049 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4202229735138277 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5239454292399396 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.565195780753049 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4210191428486413 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5242488515841455 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.565195780753049 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4215096896081619 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5245038688444345 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.565195780753049 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4220305157383577 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5247442178974759 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.565195780753049 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4221378031970825 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5248902713324977 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.565195780753049 at iter 0
max_prior_anomaly= 0.42794159371329027 at iter 5
max_prior_star_anomaly= 0.5317761564519368 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.565195780753049
accuracies_anomaly['prior'][-1]= 0.4225598284741754
accuracies_anomaly['prior_star'][-1]= 0.5251417263138837



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.68299126625061 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.565195780753049
 first_prior_anomaly_auc= 0.422439234856019
 first_prior_star_anomaly_auc= 0.5251444504095154


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5646375506943719; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41768809775563853; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5237716109840564 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5633731512296358; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4197550577026319; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5232740444396389 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5618945959390859; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41784630484809393; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 240 
last prior star auc 0.5214038480155802 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5604986017007576; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4171074462944546; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 240 
last prior star auc 0.5196096119504818 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.565195780753049 at iter 0
0.42497547266202396 at iter 240
0.5251444504095154 at iter 0
last anomaly aucs:
0.5597009655452194
0.42437156161506184
0.5202783774280598




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.98118257522583 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5589846331669959,first_prior_anomaly_auc= 0.4146044215005743, first_prior_star_anomaly_auc= 0.5175136299077202


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5589844236211781 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.416802557129524 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5199294836413866 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5589846331669959 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4209796434619819 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5197660379034857 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5589844236211781 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.42206236670266667 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5199625918806023 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5589846331669959 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.42244091122256155 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5203283541056103 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5589846331669959 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.42181824582490435 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5202444310055726 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5589846331669959 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4218431817772252 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5204277835961667 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5589848427128137 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4222836470862864 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5204177253969112 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5589848427128137 at iter 6
max_prior_anomaly= 0.4232037627723415 at iter 59
max_prior_star_anomaly= 0.5267210731428059 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5589846331669959
accuracies_anomaly['prior'][-1]= 0.4228370575911535
accuracies_anomaly['prior_star'][-1]= 0.5206475971590616



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.00192332267761 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5589846331669959
 first_prior_anomaly_auc= 0.42256925803597734
 first_prior_star_anomaly_auc= 0.5205820093180834


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.557257975628145; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41517690067486324; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 40 
last prior star auc 0.5171382285750926 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5562900834956266; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42059785098191077; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 150 
last prior star auc 0.5172366103365599 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5548731346755161; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4199822053691506; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 150 
last prior star auc 0.5155983811328299 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5538935079771997; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4179936155580226; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 150 
last prior star auc 0.5149202908663588 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5589846331669959 at iter 0
0.4294331408445451 at iter 150
0.5207712291915765 at iter 40
last anomaly aucs:
0.5521927293468499
0.41949626861762207
0.5133715377268386




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.88091111183167 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.552003404700448,first_prior_anomaly_auc= 0.4207780603852374, first_prior_star_anomaly_auc= 0.5136797796248543


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5520031951546301 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42151859530541924 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5165524432413721 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5520031951546301 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.42577740450682766 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5159604763060257 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5520031951546301 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.42587882468265337 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5158137942335506 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5520031951546301 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4266895574518055 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5158437592854991 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5520029856088123 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4266964724637936 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5159204530548218 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5520031951546301 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4251804084718536 iter_best_prior_anomaly= 520
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5156740271730634 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5520030903817212 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.42706380628243507 iter_best_prior_anomaly= 520
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5159818499794435 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5520034047004481 at iter 16
max_prior_anomaly= 0.43025120771732106 at iter 79
max_prior_star_anomaly= 0.5214736267729148 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5520031951546301
accuracies_anomaly['prior'][-1]= 0.43025120771732106
accuracies_anomaly['prior_star'][-1]= 0.5169813835304531



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.40607714653015 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.46006014803154754
accuracies_anomaly["prior"][-1]= 0.41229009271564254
accuracies_anomaly["prior_star"][-1]= 0.4568176360465745


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 1161.2199788093567 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0037374496459960938 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4679807703993901
 first_prior_anomaly_auc= 0.41245804368862665
 first_prior_star_anomaly_auc= 0.4648086658092052


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.48903603894702397; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41232623936921686; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4760497512062505 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5400968017860008; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41228726384710196; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5216576080009623 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5473625934731507; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4122609658469653; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.523568770632405 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5447386607423873; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 330 
last prior auc 0.41225247924134356; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5185428141919515 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5481423134612653 at iter 330
0.41245804368862665 at iter 0
0.5236904119796506 at iter 290
last anomaly aucs:
0.5410585123168936
0.4122325723886505
0.5154491845105408




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.08363771438599 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5409737510335848,first_prior_anomaly_auc= 0.41223341057192175, first_prior_star_anomaly_auc= 0.5153840157611982


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5409737510335848 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41392769328191914 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5144808732863866 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5409737510335847 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.41827388308935914 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5134765201815672 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5409739605794025 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.43317101914284867 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5121806888441578 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5409739605794026 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4509918432194955 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.510268373710717 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5409735414877669 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.45229773275616036 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5082110528713435 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5409739605794025 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4455454330955826 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5073391327233874 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5409737510335847 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4396454610489947 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5067947326886866 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5409739605794026 at iter 13
max_prior_anomaly= 0.45399872093232807 at iter 46
max_prior_star_anomaly= 0.5153840157611982 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5409738558064937
accuracies_anomaly['prior'][-1]= 0.43255202079700333
accuracies_anomaly['prior_star'][-1]= 0.5063119391244253



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.18164944648743 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5409737510335847
 first_prior_anomaly_auc= 0.43184784207621346
 first_prior_star_anomaly_auc= 0.5062469799209006


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5423900712162416; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4354397717124042; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5082139865127929 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5486391465953205; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.434927641733648; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 140 
last prior star auc 0.5140932135234165 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5546883152641975; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.43322193877657933; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 140 
last prior star auc 0.5182734430431417 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5585933063522138; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4323324167799262; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 140 
last prior star auc 0.52012540898105 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5592157622040532 at iter 460
0.43560604631884575 at iter 140
0.5201432203755648 at iter 410
last anomaly aucs:
0.5589924911351642
0.43222848205428666
0.5193027321002819




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.04194235801697 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5588417229192415,first_prior_anomaly_auc= 0.43227206758439357, first_prior_star_anomaly_auc= 0.519122732242773


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5588417229192415 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43680747726532654 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5185521389808446 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5588417229192414 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4355131127486418 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5181648983095102 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5588415133734237 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4361279201781307 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5181095782136051 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5588417229192415 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4376106663850371 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5181474012337219 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5588416181463325 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43923716102296917 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5182445257202823 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5588417229192415 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4408211178598834 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5184312310439614 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5588417229192415 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44204371293396416 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5186093449891099 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5588417229192415 at iter 0
max_prior_anomaly= 0.44296581930528856 at iter 79
max_prior_star_anomaly= 0.5199931855700044 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5588416181463325
accuracies_anomaly['prior'][-1]= 0.44296581930528856
accuracies_anomaly['prior_star'][-1]= 0.5187494263683237



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.44519424438477 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5588416181463325
 first_prior_anomaly_auc= 0.44298509752052817
 first_prior_star_anomaly_auc= 0.5187450259061495


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5558539138758306; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4376294207357322; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5144201049992183 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.554543100012447; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4382248451770725; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5131223877494485 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5554923425671794; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43846634673211204; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.513655472309987 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5577780683479785; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4388193266622327; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5152916060555388 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5608948528422586 at iter 490
0.44298509752052817 at iter 0
0.5187450259061495 at iter 0
last anomaly aucs:
0.5608948528422586
0.4386055899280545
0.517425620664235




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.03678178787231 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5612267734176881,first_prior_anomaly_auc= 0.43870575282897334, first_prior_star_anomaly_auc= 0.5176835715659736


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5612265638718703 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43432121613687197 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5174794739394153 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5612267734176881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42954692422362223 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5154093708051546 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5612267734176881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4277915589077299 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.514924691328533 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5612267734176881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4266706983282016 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5145957043945529 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5612265638718703 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42595405163125133 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5143608035327749 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5612267734176881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42525427337263577 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5141558677229452 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5612265638718703 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4248880920559923 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5139918981204997 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5612267734176881 at iter 0
max_prior_anomaly= 0.43870575282897334 at iter 0
max_prior_star_anomaly= 0.5200028246776243 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5612267734176881
accuracies_anomaly['prior'][-1]= 0.4244891168188598
accuracies_anomaly['prior_star'][-1]= 0.51386585631108



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.41858005523682 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5612265638718703
 first_prior_anomaly_auc= 0.42444196900984993
 first_prior_star_anomaly_auc= 0.5138499308289255


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5640478887630217; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4082023776744857; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5130658103786367 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5677279324156065; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.40870046808344784; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5155302787420377 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5717717476079297; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4078912021350204; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5178470173038745 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5754899285993581; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4081256839051629; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5203186102250815 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5781563991311393 at iter 490
0.42444196900984993 at iter 0
0.5216853728218236 at iter 490
last anomaly aucs:
0.5781563991311393
0.40690507951635146
0.5216853728218236




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.06882429122925 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5784047109252579,first_prior_anomaly_auc= 0.4068753240102208, first_prior_star_anomaly_auc= 0.5218210537388632


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5784047109252579 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4214670470342351 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5281420033334548 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5784048156981669 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.413945609449343 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5233002376668665 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5784047109252579 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4142924077778379 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5229697839121618 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5784045013794401 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41426432863824975 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5228524382541816 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5784045013794401 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4139500099115172 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5227373976001974 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5784045013794401 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4136884967308757 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5226407969781817 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5784048156981669 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41346899748670746 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5225567691052351 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5784048156981669 at iter 14
max_prior_anomaly= 0.42156752425388067 at iter 9
max_prior_star_anomaly= 0.5305708489078262 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5784045013794401
accuracies_anomaly['prior'][-1]= 0.4130866811420918
accuracies_anomaly['prior_star'][-1]= 0.5224660357661183



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.44250202178955 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5784045013794401
 first_prior_anomaly_auc= 0.41309726320589174
 first_prior_star_anomaly_auc= 0.5224584921166768


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5818838001385517; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4074077799333058; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5247884320650363 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.58356645305566; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.40560694317494606; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5251859404814441 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5846114580491368; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.40526475485444324; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5254730182518599 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5846751599777545; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.40505562812825713; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5253171161634005 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5847964870062733 at iter 360
0.41309726320589174 at iter 0
0.5263315274674754 at iter 270
last anomaly aucs:
0.5840450557035647
0.40501916715595615
0.5245082693066087




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.0961320400238 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5840385597832123,first_prior_anomaly_auc= 0.40370908670293487, first_prior_star_anomaly_auc= 0.5241832637431673


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5840385597832123 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41843387132126597 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5294971361373078 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5840384550103034 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.410098767325772 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5250394679547867 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5840386645561212 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4115762748872329 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5246346254347551 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5840391884206657 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.41194570416405263 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5245589793945216 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5840386645561211 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.41217180410148224 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5246010981039038 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5840389788748479 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.41199892880177924 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5245544741594383 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5840386645561212 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4120552966267733 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5245285952509374 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5840391884206657 at iter 40
max_prior_anomaly= 0.419120238647541 at iter 8
max_prior_star_anomaly= 0.5320311737122257 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5840387693290301
accuracies_anomaly['prior'][-1]= 0.41206566914475545
accuracies_anomaly['prior_star'][-1]= 0.5245426348207314



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.52113246917725 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5840387693290301
 first_prior_anomaly_auc= 0.4121502208822466
 first_prior_star_anomaly_auc= 0.5245829723906621


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5840241011217826; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.408847150155923; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 70 
last prior star auc 0.5236344632462921 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5824116460536446; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41604274399410257; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 190 
last prior star auc 0.5235432060426308 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5790925450722577; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4054038932774768; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 190 
last prior star auc 0.5178419882042468 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5764574016402408; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4070614006964465; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 190 
last prior star auc 0.5167194512581759 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5854574992885919 at iter 10
0.4202011807487743 at iter 190
0.527061794642584 at iter 30
last anomaly aucs:
0.5731350526986778
0.4030291105241034
0.5126944951894566




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.0898163318634 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5725232836835472,first_prior_anomaly_auc= 0.41087848731388665, first_prior_star_anomaly_auc= 0.5141504195316818


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5725229693648206 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4167122428820429 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5181328377993834 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5725231789106384 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40987937285451276 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5146483003948262 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5725231789106384 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4096979061762791 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.514211397364668 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5725231789106384 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4097382437462098 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5141363799618878 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5725232836835472 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4099102808626414 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5141642495556581 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5725231789106384 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4100616777160176 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5141956814283313 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5725232836835472 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.41037893008419973 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5142232367033749 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5725233884564562 at iter 27
max_prior_anomaly= 0.418187026347872 at iter 7
max_prior_star_anomaly= 0.5204181444885468 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5725231789106384
accuracies_anomaly['prior'][-1]= 0.4105733886031382
accuracies_anomaly['prior_star'][-1]= 0.5142468106078799



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.14431071281433 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5725231789106384
 first_prior_anomaly_auc= 0.41056039676243333
 first_prior_star_anomaly_auc= 0.5142715370143829


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.570784262941445; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4173938954274169; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5128756475489635 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.565993731227314; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.424792015298521; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 170 
last prior star auc 0.510459793815297 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5592564140927107; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.416833150818926; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 170 
last prior star auc 0.5046035120717249 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5546692465947758; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41652260391691426; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 170 
last prior star auc 0.5015292653784629 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5749157730585266 at iter 10
0.43303209026563283 at iter 170
0.5183605093304466 at iter 10
last anomaly aucs:
0.5491185874264966
0.42508045511675263
0.49955639150367137




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.05924201011658 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5476385653152218,first_prior_anomaly_auc= 0.41397829859692314, first_prior_star_anomaly_auc= 0.4962842287854766


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5476385653152218 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4161674237557064 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.498005542905973 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5476385653152218 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4093523651226912 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49533634827856016 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5476385653152218 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.40859695244944394 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4949300389378039 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5476385653152219 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4086241934057607 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4948592124513801 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5476385653152218 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.40876836092842206 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4949044743480296 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5476385653152218 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4090397227625012 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49489399705713855 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5476385653152218 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4091941580302358 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4949560226192138 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5476385653152219 at iter 6
max_prior_anomaly= 0.41751312699775744 at iter 7
max_prior_star_anomaly= 0.4994457513118616 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5476385653152218
accuracies_anomaly['prior'][-1]= 0.4093842160870001
accuracies_anomaly['prior_star'][-1]= 0.49499667450787116



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.98388576507568 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5476385653152219
 first_prior_anomaly_auc= 0.40934901238960597
 first_prior_star_anomaly_auc= 0.49507001554410873


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5477383091245049; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4248164273862973; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 50 
last prior star auc 0.4979971610732602 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5408415276225392; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4189164553397094; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 150 
last prior star auc 0.4920163043409931 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5342770857876388; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4203591782954118; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 150 
last prior star auc 0.48851479372519235 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5303405580540402; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4310448625023207; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 370 
last prior star auc 0.48950866953912076 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5535577108041404 at iter 10
0.4337709488192722 at iter 370
0.5023959468809734 at iter 10
last anomaly aucs:
0.5245562552988898
0.421375685057665
0.4836681037318853




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.0545163154602 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5247596195150859,first_prior_anomaly_auc= 0.42435081657909746, first_prior_star_anomaly_auc= 0.4846340051791344


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5247597242879948 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4182146863958245 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48268879135229553 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5247596195150859 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.415736597554265 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4818849735951315 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5247597242879948 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.41498003237901976 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4817250901361335 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5247597242879948 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4146679138833743 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4816330995221098 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5247597242879948 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4146251665365387 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48161780267740883 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5247596195150859 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.41474251219451885 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4816274417850286 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.524759514742177 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4151471451687326 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48178690615239095 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5247600386067215 at iter 28
max_prior_anomaly= 0.42435081657909746 at iter 0
max_prior_star_anomaly= 0.4846340051791344 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.524759305196359
accuracies_anomaly['prior'][-1]= 0.41523808805366724
accuracies_anomaly['prior_star'][-1]= 0.48181247074216516



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.90389251708984 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4679807703993901
accuracies_anomaly["prior"][-1]= 0.41245804368862665
accuracies_anomaly["prior_star"][-1]= 0.4648087705821141


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 1163.7944116592407 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003545045852661133 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4704441910337021
 first_prior_anomaly_auc= 0.4121693943245772
 first_prior_star_anomaly_auc= 0.467189944482931


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4864622924396288; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4120664025551179; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4740066794824889 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5380051154325046; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41198866105670606; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5183839784620426 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.542780978939388; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4119712687538268; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5193010557337394 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5431035747259245; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.41198101263435555; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.516751197449576 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5438541678453619 at iter 360
0.4121693943245772 at iter 0
0.5198493323660698 at iter 250
last anomaly aucs:
0.5419459388553685
0.4119728403474605
0.5162356099648256




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.39173793792725 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.542139244872309,first_prior_anomaly_auc= 0.4119718973912803, first_prior_star_anomaly_auc= 0.5163704526985939


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.542139244872309 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4133396029442025 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5155094289331645 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.542139244872309 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4162395075170371 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5145705588964145 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.542139244872309 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4238901300986164 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5133471256390624 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.542139244872309 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43298431381916946 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5113974065771403 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.542139244872309 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42090158764484326 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5090215760946779 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.542139244872309 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41702614251713976 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5076551278166626 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.542139244872309 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41917545397053696 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5070637895187697 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.542139244872309 at iter 0
max_prior_anomaly= 0.43329171753391393 at iter 38
max_prior_star_anomaly= 0.5163704526985939 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.542139244872309
accuracies_anomaly['prior'][-1]= 0.42005931823010895
accuracies_anomaly['prior_star'][-1]= 0.5067999713341321



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.12291097640991 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.542139244872309
 first_prior_anomaly_auc= 0.420166186597198
 first_prior_star_anomaly_auc= 0.5067723112861796


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5463963777071748; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4178098438757929; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5108783615863959 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5490695537051263; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4156997174903284; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5127322134366645 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5453258081239237; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.41510607418843953; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.508589911709965 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5417308400733746; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.41647535133499547; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5041974122767865 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5491577724944292 at iter 190
0.420166186597198 at iter 0
0.5128788955091397 at iter 180
last anomaly aucs:
0.5402160333563415
0.41815685175010575
0.5022130133820151




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.41680526733398 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5401430066388306,first_prior_anomaly_auc= 0.4183102392887512, first_prior_star_anomaly_auc= 0.5020983918196665


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5401427970930128 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4224820869757635 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5014345506688074 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5401430066388306 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4201865125415268 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5007684045139522 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5401432161846484 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41894495357093314 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5003266819299841 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5401430066388306 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.41883441815203215 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5001041442714573 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5401433209575573 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.41898560545959057 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4999436321750059 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5401429018659217 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4194219846252042 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49985310838170693 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5401432161846484 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4196231486103131 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4997447731938932 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5401434257304663 at iter 32
max_prior_anomaly= 0.4256860425302573 at iter 1
max_prior_star_anomaly= 0.5024043287136862 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5401431114117395
accuracies_anomaly['prior'][-1]= 0.4198185500854318
accuracies_anomaly['prior_star'][-1]= 0.49963287572717635



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.17580318450928 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5401432161846484
 first_prior_anomaly_auc= 0.4198751274562436
 first_prior_star_anomaly_auc= 0.4996280561733665


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5402371974839415; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42267424049070595; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4991896863224835 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5413616203423728; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4233513878009969; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.49984682200717234 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5438782656144114; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.423815427014563; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 300 
last prior star auc 0.5015329324302747 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.547183431798913; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4240012941549709; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 400 
last prior star auc 0.5038617198766361 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5504512988278426 at iter 490
0.4240012941549709 at iter 400
0.5061183187887581 at iter 490
last anomaly aucs:
0.5504512988278426
0.4239883023142659
0.5061183187887581




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.27062058448792 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5507701227896583,first_prior_anomaly_auc= 0.4240392219479966, first_prior_star_anomaly_auc= 0.5063256643754928


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5507702275625672 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4189432772043906 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.504699903147923 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5507702275625672 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4181949890889493 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5043774121342953 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5507702275625672 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.41768034456037917 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5041089839416658 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5507703323354761 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.41726083383310014 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5038967140282123 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5507699132438405 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.41693530440511406 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5037282391906838 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5507702275625672 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.41674315089017155 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5035898341780125 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5507702275625672 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4165370625783439 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5034665164642245 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.550770437108385 at iter 26
max_prior_anomaly= 0.4240392219479966 at iter 0
max_prior_star_anomaly= 0.5080696094443139 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5507701227896583
accuracies_anomaly['prior'][-1]= 0.4162548043617381
accuracies_anomaly['prior_star'][-1]= 0.5033699158422087



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.83312249183655 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5507702275625672
 first_prior_anomaly_auc= 0.41623238295923115
 first_prior_star_anomaly_auc= 0.5033576574118661


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5545627973193223; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4175118697228505; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 20 
last prior star auc 0.5058180396318196 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5568626674428244; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41895354494946385; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 140 
last prior star auc 0.5077601102713912 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5590657273984929; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4170890062624863; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 140 
last prior star auc 0.50874623289006 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5593634920056175; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.4151567842763524; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 140 
last prior star auc 0.5081673625683276 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5597140621588332 at iter 420
0.4196071183552497 at iter 140
0.508836966229177 at iter 370
last anomaly aucs:
0.5589379044496217
0.4122434687711772
0.50737831779132




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.4117169380188 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5590942256297166,first_prior_anomaly_auc= 0.4158688209653105, first_prior_star_anomaly_auc= 0.508407816394278


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5590942256297166 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41590098624834615 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5086645100211096 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5590941208568077 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4151624420134336 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5080534744163415 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5590942256297166 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4147133853258417 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5078923336824367 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5590940160838987 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4143446894593844 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5077538238968565 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5590942256297166 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.413991290437628 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5076390975615991 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5590942256297167 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41379526032505587 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5075694235771735 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5590940160838987 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.413701069479945 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.507499435274021 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5590942256297167 at iter 3
max_prior_anomaly= 0.41792844680868 at iter 3
max_prior_star_anomaly= 0.5128306999710408 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5590940160838989
accuracies_anomaly['prior'][-1]= 0.4134093817015371
accuracies_anomaly['prior_star'][-1]= 0.5074468392737477



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.4660587310791 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5590940160838987
 first_prior_anomaly_auc= 0.4134533863232797
 first_prior_star_anomaly_auc= 0.5074344760704963


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5584322703912179; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41402921823065375; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5074769090986051 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5556926683690169; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41318411994737886; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.5057256299261603 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5525789222890953; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4132130372702383; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.5036238853734085 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5489109275210352; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41279017380987404; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.5014192538241065 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5600860059854668 at iter 10
0.41879596649446194 at iter 10
0.5100100037173427 at iter 10
last anomaly aucs:
0.5450282530626169
0.40922160853237044
0.49844139820704214




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.35655045509338 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5447139343358844,first_prior_anomaly_auc= 0.41171939468080515, first_prior_star_anomaly_auc= 0.4988736912292083


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5447137247900665 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41245133822245633 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4994518281405784 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5447140391087932 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41200091948704864 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49866393586556884 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5447140391087932 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41170011646556554 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4985312933628876 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5447137247900665 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41150408635299335 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4984545995935649 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5447139343358843 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4113874741053756 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49840661360128374 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5447138295629754 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4113901982010072 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49838356356132335 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5447139343358843 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4113733297626726 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4983795821907847 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.544714248654611 at iter 16
max_prior_anomaly= 0.4207709358274314 at iter 3
max_prior_star_anomaly= 0.5030612548525573 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5447137247900665
accuracies_anomaly['prior'][-1]= 0.4114800933568527
accuracies_anomaly['prior_star'][-1]= 0.4983888022067689



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.5240068435669 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5447140391087932
 first_prior_anomaly_auc= 0.41144258465546263
 first_prior_star_anomaly_auc= 0.49837371490788573


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5445446213150844; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4148050616211387; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.4991290228082241 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5398294213224604; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41509329189355243; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.49620365841852415 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5350668639750088; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41407123216712705; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.4932410996461609 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5304447023254976; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41845461635723036; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 320 
last prior star auc 0.49179795759882283 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5501026145869873 at iter 10
0.42168623195967664 at iter 320
0.50409222027624 at iter 10
last anomaly aucs:
0.5263344611089248
0.41132775354729634
0.48757319959281054




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.39635992050171 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5257577910182796,first_prior_anomaly_auc= 0.4219223900963618, first_prior_star_anomaly_auc= 0.4906471319673461


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5257576862453706 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41605091628099755 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4887588098300458 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5257575814724617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4218662318171855 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48987139334977003 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5257575814724617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4228510971609475 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.490053698211275 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5257573719266438 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.42282783757516934 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4899715562506889 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5257577910182796 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4226057190082783 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4898901477004652 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5257576862453706 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4224868017566645 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4898611256046968 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5257575814724617 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4223907249991932 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48982361690330667 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5257578957911885 at iter 33
max_prior_anomaly= 0.4250718637382219 at iter 3
max_prior_star_anomaly= 0.49100629349909247 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5257575814724618
accuracies_anomaly['prior'][-1]= 0.42227736071175165
accuracies_anomaly['prior_star'][-1]= 0.4898076914211523



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.33905243873596 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.525757371926644
 first_prior_anomaly_auc= 0.42219511397825665
 first_prior_star_anomaly_auc= 0.48979847140516813


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5177738858134547; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4203866287975465; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 40 
last prior star auc 0.4842970555040771 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5143339816680937; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42153179669194213; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 120 
last prior star auc 0.4827673710339787 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5104767670265407; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42724506341485086; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 210 
last prior star auc 0.48112882751152186 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5070323576460964; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4238414106959729; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 310 
last prior star auc 0.47842118122653876 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.525757371926644 at iter 0
0.4300318132460617 at iter 310
0.4906892506767282 at iter 10
last anomaly aucs:
0.504567051099424
0.4252434817630179
0.4770508563508937




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.30659985542297 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5041783436073648,first_prior_anomaly_auc= 0.41332514428277284, first_prior_star_anomaly_auc= 0.47381882165681166


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5041783436073648 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4147942700115208 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4745429072302946 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5041783436073648 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41329790332645605 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4741697061287542 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5041782388344558 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41334368908765007 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47414979927606105 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5041783436073648 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41341420125534706 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4741703347662076 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5041783436073648 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4133821407452204 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.474185212519273 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5041783436073648 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4136677516949113 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47423864670281746 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5041783436073648 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.41338109301613124 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47420040459106505 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5041784483802737 at iter 58
max_prior_anomaly= 0.4288057606659869 at iter 3
max_prior_star_anomaly= 0.4771458853792759 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5041783436073648
accuracies_anomaly['prior'][-1]= 0.413736273177339
accuracies_anomaly['prior_star'][-1]= 0.4742608585595066



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.14036631584167 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5041783436073648
 first_prior_anomaly_auc= 0.41354977739947774
 first_prior_star_anomaly_auc= 0.47424011352354223


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5038690539802599; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42574576308833656; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.4762672597651494 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5031140603986484; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4246867185250656; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.47616269640205644 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5014633632187578; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42916764629336496; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 290 
last prior star auc 0.4752013001898904 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5013591141743916; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.43411858533103836; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 400 
last prior star auc 0.47628129933494345 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5080140798025911 at iter 20
0.43411858533103836 at iter 400
0.4802922158338688 at iter 20
last anomaly aucs:
0.4986291512598104
0.4245262064286142
0.47198644825286984




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.36088013648987 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.49891392402623014,first_prior_anomaly_auc= 0.42763125635709626, first_prior_star_anomaly_auc= 0.47313853115925353


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.49891392402623014 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4255154722345505 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4724424199524499 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.49891392402623014 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4264282538169819 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4726752253560498 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.49891392402623014 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.426761850758954 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4727802078107785 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.49891392402623014 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42694939426590445 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4728388806397685 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.49891392402623014 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4271513964342845 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4729115930385527 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.49891392402623014 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4272771239249776 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4729463776443111 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.49891392402623014 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4274328164676191 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4729790667918913 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.49891392402623014 at iter 0
max_prior_anomaly= 0.43132848276674235 at iter 3
max_prior_star_anomaly= 0.47343619099346923 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.49891392402623014
accuracies_anomaly['prior'][-1]= 0.4277498592899833
accuracies_anomaly['prior_star'][-1]= 0.47303145324634666



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.40852499008179 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4704440862607932
accuracies_anomaly["prior"][-1]= 0.4121693943245772
accuracies_anomaly["prior_star"][-1]= 0.467189944482931


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 1140.1367921829224 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.00366973876953125 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4682556945123722
 first_prior_anomaly_auc= 0.41272961506852357
 first_prior_star_anomaly_auc= 0.4650958483525298


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.49237284655001673; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4126747140642544; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.47916884070452653 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5373502847518119; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41266203654227607; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5189410560187216 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5457333747395869; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41265742653428406; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.522609888970053 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5436374974697342; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 330 
last prior auc 0.41264160582503845; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5180408471853597 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.546307844599145 at iter 330
0.41272961506852357 at iter 0
0.5231925311165062 at iter 260
last anomaly aucs:
0.5425697567550237
0.4126242135221593
0.5163577751766157




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.0666880607605 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5425528883166891,first_prior_anomaly_auc= 0.4126227467014345, first_prior_star_anomaly_auc= 0.5163630138220613


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5425530978625069 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4127069841201988 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5162611745546 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5425530978625069 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4128073565669354 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5161722223549347 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5425530978625068 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4129152726631136 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5160875658445345 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.542552993089598 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4130380665123571 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5159856218041643 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5425530978625069 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.413178043118662 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5159162621384653 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5425530978625069 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.41332451564531936 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5158204996997209 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.542552993089598 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4134881709290381 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5157357384164121 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5425533074083249 at iter 58
max_prior_anomaly= 0.41363904391786976 at iter 79
max_prior_star_anomaly= 0.5163630138220613 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.542552993089598
accuracies_anomaly['prior'][-1]= 0.41363904391786976
accuracies_anomaly['prior_star'][-1]= 0.5156411284796654



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.44906783103943 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5425530978625069
 first_prior_anomaly_auc= 0.41364952120876086
 first_prior_star_anomaly_auc= 0.515634632559313


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5430910019768552; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4136346434556955; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5162129790165009 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.537567583764893; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41361536524045595; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.5119518648110966 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5318135603804179; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4136143175113668; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.5066809493096094 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5296288356838088; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41362353752735104; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.5031618368451117 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5431563802720156 at iter 90
0.41365067371075886 at iter 10
0.5162129790165009 at iter 100
last anomaly aucs:
0.5286438655671378
0.4136371580055094
0.5013458080149599




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.11295080184937 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5286386269216923,first_prior_anomaly_auc= 0.41363799618878067, first_prior_star_anomaly_auc= 0.5012697428830906


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5286388364675101 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41382155832519246 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5011702086196252 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5286388364675101 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41401287365686373 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5010948768981185 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5286386269216923 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4142531179369963 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5010238408658768 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5286386269216923 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41447586514134077 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.500938974809659 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5286384173758745 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41475215130213866 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5008441553270947 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5286386269216923 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4150172267616831 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5007491262987125 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5286386269216923 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4153336409465939 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5006604884177741 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5286388364675101 at iter 5
max_prior_anomaly= 0.4156236523584591 at iter 79
max_prior_star_anomaly= 0.5012697428830906 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5286386269216923
accuracies_anomaly['prior'][-1]= 0.4156236523584591
accuracies_anomaly['prior_star'][-1]= 0.5005892428397147



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.13716626167297 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5286384173758745
 first_prior_anomaly_auc= 0.415654455593679
 first_prior_star_anomaly_auc= 0.5005837946484513


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5294003259694743; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4156618944702116; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.5005153779389325 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5303910585961352; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4156658758407502; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 190 
last prior star auc 0.5010208024515185 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5313843057726101; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4156671331156572; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 300 
last prior star auc 0.5017058077299775 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5325108240892196; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4156640947012987; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 320 
last prior star auc 0.502595015407904 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5338658521201636 at iter 490
0.41567006675710666 at iter 320
0.503736097158852 at iter 490
last anomaly aucs:
0.5338658521201636
0.41566168492439376
0.503736097158852




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.09282040596008 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5340216494357141,first_prior_anomaly_auc= 0.41566105628694033, first_prior_star_anomaly_auc= 0.5038697873906224


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5340215446628052 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4160556310618986 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5037600901549927 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5340216494357141 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4164780754306272 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5036609749831631 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5340216494357141 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4169630692259755 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5035490775164462 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5340216494357141 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.41743119458298916 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.503431731858466 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5340216494357141 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.41797915689659293 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5033143862004859 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5340216494357141 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4185766767961115 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5031969357695969 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.534021754208623 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.41926147252875284 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5030706844143593 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5340220685273497 at iter 29
max_prior_anomaly= 0.4199092834245486 at iter 79
max_prior_star_anomaly= 0.5038697873906224 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5340216494357141
accuracies_anomaly['prior'][-1]= 0.4199092834245486
accuracies_anomaly['prior_star'][-1]= 0.5029585774018246



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.05239176750183 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5340216494357141
 first_prior_anomaly_auc= 0.41997151853244163
 first_prior_star_anomaly_auc= 0.5029462141985732


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5360205069919153; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41995412622956246; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5047162477217132 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.538506558574552; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4199283520939704; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5068024858839459 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5412524469712877; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41988591906586153; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5090573036566164 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.544224225759635; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.41985082014137637; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5113891295173364 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5468940490245013 at iter 490
0.41997151853244163 at iter 0
0.5134402687550841 at iter 490
last anomaly aucs:
0.5468940490245013
0.4198072346112695
0.5134402687550841




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.07520937919617 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5471406844520774,first_prior_anomaly_auc= 0.41980157687418823, first_prior_star_anomaly_auc= 0.5136458332023672


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5471406844520775 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4206204819302355 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5135245061738484 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5471406844520775 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.42148475365584115 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5134079986991396 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5471406844520774 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.42246741876851596 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5133007112404149 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5471408939978953 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4234906309969394 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5131906996860585 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5471406844520774 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.42456141012600834 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5130691631117218 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5471406844520774 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4256962055024217 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5129578942824585 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5471406844520774 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.42689742690308463 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5128434822659278 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5471408939978953 at iter 11
max_prior_anomaly= 0.4280430138891159 at iter 79
max_prior_star_anomaly= 0.5136458332023672 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5471406844520774
accuracies_anomaly['prior'][-1]= 0.4280430138891159
accuracies_anomaly['prior_star'][-1]= 0.5127431098191914



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.36680722236633 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5471405796791686
 first_prior_anomaly_auc= 0.4281507204394762
 first_prior_star_anomaly_auc= 0.5127290702493972


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5500171198933159; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.428048776399106; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5150095573847508 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5525272692450023; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4279369837052981; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5169398934585244 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5546436820050015; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.42782320032622095; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5185068770841951 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5565946583418304; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.42770847399096357; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5198882031152758 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5580735279511071 at iter 490
0.4281507204394762 at iter 0
0.5209007285069902 at iter 490
last anomaly aucs:
0.5580735279511071
0.4275954240222488
0.5209007285069902




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.07894015312195 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5582076372745131,first_prior_anomaly_auc= 0.4275929094724349, first_prior_star_anomaly_auc= 0.5210013104995447


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5582076372745131 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42879056859419484 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5208516947856199 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5582076372745131 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42990000892665187 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5207146518207646 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5582076372745131 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4308863410911386 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5205757229435488 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5582078468203309 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.43192432629971844 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5204292504168915 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5582077420474219 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.43304193891907045 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5202817301611449 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.558207532501604 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4340886202790899 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5201200655626955 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5582078468203309 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4350513785390717 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5199755837213074 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5582078468203309 at iter 2
max_prior_anomaly= 0.43570736172176255 at iter 79
max_prior_star_anomaly= 0.5210013104995447 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.558207637274513
accuracies_anomaly['prior'][-1]= 0.43570736172176255
accuracies_anomaly['prior_star'][-1]= 0.5198400075771767



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.75251698493958 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5582074277286952
 first_prior_anomaly_auc= 0.43576331045512096
 first_prior_star_anomaly_auc= 0.5198277491468343


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5593655874637957; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.43557974831870916; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5204529290943052 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5600229326943025; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.43538109888341414; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5205495297163211 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5601384972128312; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4352133574562479; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5201174462399728 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5594713033288867; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4350530549056143; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5190460384734503 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5601947602649162 at iter 260
0.43576331045512096 at iter 0
0.5205600070072122 at iter 190
last anomaly aucs:
0.5581261239513804
0.43494524358234504
0.5175907427686786




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.08772945404053 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5579429809066041,first_prior_anomaly_auc= 0.43493623311217866, first_prior_star_anomaly_auc= 0.5174149338275262


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5579430856795131 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4358039623437784 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5172863774682925 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5579427713607863 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4362941947845722 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5171670411250431 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5579427713607863 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.43665702336813045 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5170123963114907 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5579427713607863 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4369790952901225 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5168483219361363 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5579429809066041 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.43711980530678973 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5166842475607819 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5579426665878775 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4372622964629085 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5165256213766909 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5579427713607863 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.43725580054255603 iter_best_prior_anomaly= 670
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5163730720213167 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.557943190452422 at iter 34
max_prior_anomaly= 0.4372838796821441 at iter 67
max_prior_star_anomaly= 0.5174149338275262 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5579431904524219
accuracies_anomaly['prior'][-1]= 0.4372494093951125
accuracies_anomaly['prior_star'][-1]= 0.5162379149688217



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.5534200668335 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5579429809066041
 first_prior_anomaly_auc= 0.4372483616660233
 first_prior_star_anomaly_auc= 0.5162221990324851


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5555024007664348; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43716904857397787; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5140102333795591 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5524853600814379; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43718340246249865; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5114342866410769 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5490289018164689; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43729456651885307; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 300 
last prior star auc 0.5086362213357037 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.545257286641496; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4374254278820827; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 400 
last prior star auc 0.5056869687227721 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5579429809066041 at iter 0
0.4376134952535777 at iter 490
0.5162221990324851 at iter 0
last anomaly aucs:
0.5417138668621311
0.4376134952535777
0.5029357369076821




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.06888270378113 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5413578485176519,first_prior_anomaly_auc= 0.4376341355166331, first_prior_star_anomaly_auc= 0.5026476114081773


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5413578485176519 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4384153223254724 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5025929199497258 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5413578485176519 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.43857185305138524 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5024919188655357 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.541357743744743 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.43863796475690797 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5023821168569972 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5413578485176519 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.43874504266981484 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5022877164660685 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5413578485176519 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.43878506592101885 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5021960401707715 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5413578485176519 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4388814569972168 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5021065641065616 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5413576389718342 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4389466257465594 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5020300798830566 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5413580580634698 at iter 28
max_prior_anomaly= 0.4390056128942761 at iter 79
max_prior_star_anomaly= 0.502651383232898 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5413580580634698
accuracies_anomaly['prior'][-1]= 0.4390056128942761
accuracies_anomaly['prior_star'][-1]= 0.501946261555928



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.38939547538757 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5413576389718341
 first_prior_anomaly_auc= 0.43900016470301273
 first_prior_star_anomaly_auc= 0.5019377749503062


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.537178457181198; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4395665670485849; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.49886604280685787 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.533068635056261; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44021615908383216; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.49583360050425107 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5290296394177476; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4408924682108517; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.4929020545129254 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5252184200832064; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44158816032601983; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.4901771206979719 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5413576389718341 at iter 0
0.4422642599072215 at iter 490
0.5019377749503062 at iter 0
last anomaly aucs:
0.5220536495966452
0.4422642599072215
0.48778326927517685




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.09997653961182 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5217684577385899,first_prior_anomaly_auc= 0.4423376009434591, first_prior_star_anomaly_auc= 0.487539777034868


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5217682481927721 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4430412557997044 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48753768157668975 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.521768352965681 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4430368553375301 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4874950390027631 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5217683529656809 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4430680776643856 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48744474800648585 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5217684577385899 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4431055863657756 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48738335108186415 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5217684577385899 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.443104014772142 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48734950943228583 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5217686672844077 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.44308337450908647 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4873073907229037 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5217684577385899 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.4430084618792153 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48725835700153347 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5217686672844077 at iter 60
max_prior_anomaly= 0.4431376468759024 at iter 4
max_prior_star_anomaly= 0.48758682007096893 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5217684577385899
accuracies_anomaly['prior'][-1]= 0.4429589042933004
accuracies_anomaly['prior_star'][-1]= 0.48723153513685225



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.40727519989014 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4682554849665544
accuracies_anomaly["prior"][-1]= 0.41272961506852357
accuracies_anomaly["prior_star"][-1]= 0.4650957435796209


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 1163.0123164653778 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0035190582275390625 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4634647437066056
 first_prior_anomaly_auc= 0.4123504419111752
 first_prior_star_anomaly_auc= 0.46021185920365043


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4812660800221951; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41230371319380094; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4686704904587502 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5346362473193851; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41231974344886435; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5156753892208793 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5438513389768213; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4123182766281396; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5200310085901212 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5434342380264472; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4123142952576009; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5173302773171262 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5451195102662783 at iter 330
0.4123504419111752 at iter 0
0.5200310085901212 at iter 300
last anomaly aucs:
0.5426272770820159
0.41230738024561286
0.5165381941257602




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.09685969352722 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5427196867876751,first_prior_anomaly_auc= 0.41230800888306635, first_prior_star_anomaly_auc= 0.5166567970586473


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5427196867876751 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4123926653934663 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5165759123729681 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5427196867876751 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4124936664776564 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5165046667949087 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5427196867876751 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41259864893238496 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.516414981184881 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5427196867876751 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41272238573780873 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5163293817183009 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5427196867876751 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4128547139217631 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5162628509211424 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5427196867876751 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4129873564244443 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5161628975660415 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5427196867876751 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41312900939729175 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5160781362827327 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5427196867876752 at iter 5
max_prior_anomaly= 0.4132782060195808 at iter 79
max_prior_star_anomaly= 0.5166567970586473 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5427196867876751
accuracies_anomaly['prior'][-1]= 0.4132782060195808
accuracies_anomaly['prior_star'][-1]= 0.5159935845452415



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.58514046669006 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5427196867876751
 first_prior_anomaly_auc= 0.4132964365057312
 first_prior_star_anomaly_auc= 0.515982373843988


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5474556318162636; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4132828160275729; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5205434528876043 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5565616548755236; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4132620709916085; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5288173695042941 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5622809984271491; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4132394400432838; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5333611610179401 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5613187640317119; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4132336775332937; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5319722913374177 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5625475407074183 at iter 330
0.4132964365057312 at iter 0
0.5334581807315915 at iter 310
last anomaly aucs:
0.5587231199863544
0.4132369254934699
0.5293872293558604




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.04649710655212 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5585934111251227,first_prior_anomaly_auc= 0.4132393352703748, first_prior_star_anomaly_auc= 0.5292620257297118


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5585935158980316 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4134177635342501 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5291494996255416 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5585934111251227 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.41361557478627375 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5290380212504604 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5585932015793049 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.41382176787101027 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5289131319430387 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5585933063522138 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.41405855464514885 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5287853089941675 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5585933063522139 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4143070759850853 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5286730972087239 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5585936206709405 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.414580114185707 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5285271485466112 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5585936206709405 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.41489652837061786 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5284002685539202 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5585937254438496 at iter 17
max_prior_anomaly= 0.4151891591052058 at iter 79
max_prior_star_anomaly= 0.5292620257297118 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5585932015793048
accuracies_anomaly['prior'][-1]= 0.4151891591052058
accuracies_anomaly['prior_star'][-1]= 0.5282895235892013



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.26213097572327 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5585935158980316
 first_prior_anomaly_auc= 0.41521650483443157
 first_prior_star_anomaly_auc= 0.5282773699317678


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5579189879104636; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4152263534878692; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.5275587325495481 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5582321541351981; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4152372498703959; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 190 
last prior star auc 0.5275379875135838 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5589955295495226; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4152485653445583; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 290 
last prior star auc 0.5279073120174945 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5603282409508686; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.41525485171909293; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 370 
last prior star auc 0.5287933765081536 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5622172964985312 at iter 490
0.4152556899023642 at iter 410
0.5302531774480086 at iter 490
last anomaly aucs:
0.5622172964985312
0.41524688897801576
0.5302531774480086




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.0602011680603 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5624350146032481,first_prior_anomaly_auc= 0.4152474128425603, first_prior_star_anomaly_auc= 0.5304224904688084


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5624350146032481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41560374550576606 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5303160411933551 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5624350146032481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4160121503047005 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5301898946110264 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5624350146032481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4164779706577182 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5300676246263274 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5624350146032481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41699963497118536 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5299468214623532 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5624352241490658 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4175308336193634 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5298219321549315 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.562435014603248 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4181866072562364 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5296927471582444 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.562435014603248 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.41887349844705596 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5295530848706662 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5624352241490659 at iter 46
max_prior_anomaly= 0.41956678078531906 at iter 79
max_prior_star_anomaly= 0.5304224904688084 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5624350146032481
accuracies_anomaly['prior'][-1]= 0.41956678078531906
accuracies_anomaly['prior_star'][-1]= 0.5294152037225396



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.53280138969421 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5624352241490659
 first_prior_anomaly_auc= 0.41963792159046953
 first_prior_star_anomaly_auc= 0.529400535515292


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5653000297974153; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4196145572317824; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.531527844657818 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5684414359252894; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4195983174309012; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5339595191007299 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5716070445951218; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41956667601241016; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5362929165550835 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.574280639684709; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.41952990072138246; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5381576647878789 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5763970524447082 at iter 490
0.41963792159046953 at iter 0
0.5396033213850309 at iter 490
last anomaly aucs:
0.5763970524447082
0.41949050610763194
0.5396033213850309




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.02723288536072 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5765926634656446,first_prior_anomaly_auc= 0.419484534051824, first_prior_star_anomaly_auc= 0.5397399452582505


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5765924539198269 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4203027056975088 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5396152654966466 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5765924539198269 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.42121873524011644 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5394719361572566 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5765925586927358 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.42220737240859924 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5393407604753002 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.576592349146918 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4232807708603909 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5391996313669973 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5765925586927358 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4243368817822123 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5390467676928963 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5765925586927358 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.42543092049705944 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.538888455827532 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5765925586927358 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4266495342006016 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5387391544323341 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5765928730114627 at iter 75
max_prior_anomaly= 0.42780549370461496 at iter 79
max_prior_star_anomaly= 0.5397399452582505 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5765925586927358
accuracies_anomaly['prior'][-1]= 0.42780549370461496
accuracies_anomaly['prior_star'][-1]= 0.5386000160093005



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.0602924823761 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5765925586927358
 first_prior_anomaly_auc= 0.42791435275697337
 first_prior_star_anomaly_auc= 0.5385845096187816


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5786976559785727; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4278095798480625; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5399350324146426 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5806543948253917; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4276949582857141; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5410308522689412 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.582361774149003; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.42756388737666656; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5419967537161903 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5838853817903846; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.42743847420470027; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5428223642384078 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5849421213496595 at iter 490
0.42791435275697337 at iter 0
0.5433233882888195 at iter 490
last anomaly aucs:
0.5849421213496595
0.42731526126382113
0.5433233882888195




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.10783362388611 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5850181864815287,first_prior_anomaly_auc= 0.4273033171522052, first_prior_star_anomaly_auc= 0.5433615256276632


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5850181864815287 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4286041775892424 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5431931555630433 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5850181864815287 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.42985055611364587 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.543047835538384 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5850181864815287 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4310794375622613 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.542891514358289 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5850182912544377 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.43233409314646876 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5427228299749426 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5850181864815287 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.43356098390981485 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5425660897032119 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5850181864815287 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.434756023708852 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5423927953118733 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5850181864815287 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4359588167031486 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5422096522670972 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5850182912544377 at iter 35
max_prior_anomaly= 0.4368911908195463 at iter 79
max_prior_star_anomaly= 0.5433615256276632 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5850181864815287
accuracies_anomaly['prior'][-1]= 0.4368911908195463
accuracies_anomaly['prior_star'][-1]= 0.5420332146884913



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.34338593482971 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5850181864815287
 first_prior_anomaly_auc= 0.4370003641906313
 first_prior_star_anomaly_auc= 0.5420208514852398


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5853756716467325; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4367366507789028; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.542061608146806 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.585055485637101; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4365331817897979; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5414892337454262 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5841024712576479; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4363595730797326; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5404012718592959 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5826331359830821; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.43616951502296836; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5389124488236726 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5853785005152732 at iter 80
0.4370003641906313 at iter 0
0.5421524462588319 at iter 50
last anomaly aucs:
0.5806963039889561
0.43604598776336245
0.5371597028305031




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.06093549728394 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5804668513184413,first_prior_anomaly_auc= 0.4360317386477506, first_prior_star_anomaly_auc= 0.5369427181361486


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5804662226809878 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43710608005572243 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5368027415298438 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5804664322268056 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43787993276093795 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5366112166523547 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5804666417726235 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4385907121749892 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5364297499741211 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5804664322268056 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43904175954785046 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5362690283318519 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5804668513184413 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4392653449354662 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.536077293908545 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5804664322268057 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.43946661369348394 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5359211822742678 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5804664322268056 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.43951407582122054 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5357808913492361 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5804668513184414 at iter 57
max_prior_anomaly= 0.4395201526499374 at iter 68
max_prior_star_anomaly= 0.5369427181361486 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5804662226809878
accuracies_anomaly['prior'][-1]= 0.43945414571732355
accuracies_anomaly['prior_star'][-1]= 0.5356300183604046



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.32402801513672 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5804668513184413
 first_prior_anomaly_auc= 0.4394381154622602
 first_prior_star_anomaly_auc= 0.535614197651159


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5774460388087237; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43925371514257705; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5330483091119322 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5739227354278695; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4391557524727454; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5300448889050937 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5700366034634571; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4391426558591316; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5267753455096218 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5659853493946012; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4391882320745078; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5233612154998527 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5804668513184413 at iter 0
0.4394381154622602 at iter 0
0.535614197651159 at iter 0
last anomaly aucs:
0.5622237924188838
0.4392811656447117
0.5202219048301568




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.06993675231934 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5618233503610265,first_prior_anomaly_auc= 0.4392992913579533, first_prior_star_anomaly_auc= 0.5199011949559807


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5618230360422998 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4401347505336084 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.519815071624856 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5618231408152087 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44024172367360637 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.519702231201959 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5618231408152087 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.44035613569013704 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5196063639903056 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5618230360422998 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.44049433115699044 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5195087156392006 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5618231408152087 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4407127826720696 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5194242686746184 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5618231408152087 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4409553319561982 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5193297635107809 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5618233503610265 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.44129919664324363 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5192473072314681 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5618233503610266 at iter 28
max_prior_anomaly= 0.4417224791952435 at iter 79
max_prior_star_anomaly= 0.5199011949559807 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5618231408152087
accuracies_anomaly['prior'][-1]= 0.4417224791952435
accuracies_anomaly['prior_star'][-1]= 0.5191811955259453



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.88368439674377 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5618231408152087
 first_prior_anomaly_auc= 0.44178817180913055
 first_prior_star_anomaly_auc= 0.5191797287052206


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5574157636289648; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44227316560447894; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.515615773435709 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5530474667377446; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4428657611772787; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5121415037762251 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5487188787790016; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44351671526034186; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5087072573679453 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5443689171468409; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44421366465041684; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.5052990994139841 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5618231408152087 at iter 0
0.4449249679290126 at iter 490
0.5191797287052206 at iter 0
last anomaly aucs:
0.5404283032697949
0.4449249679290126
0.5022702193902804




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.92346858978271 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5400442057857276,first_prior_anomaly_auc= 0.4449993566943392, first_prior_star_anomaly_auc= 0.5019736072851537


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5400443105586366 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4466446056829664 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5020474721859359 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5400443105586366 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4473907983402295 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5020386712615873 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5400442057857276 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.44812242756315396 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5020378330783161 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5400442057857276 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.44887846887385463 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5020323848870527 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5400442057857276 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.449670237746494 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5020478912775714 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5400444153315456 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4503468611922402 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5020606735724586 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5400442057857276 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4509453240479391 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5020717795008032 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5400444153315456 at iter 33
max_prior_anomaly= 0.4514528440187032 at iter 79
max_prior_star_anomaly= 0.5020904290785894 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5400444153315455
accuracies_anomaly['prior'][-1]= 0.4514528440187032
accuracies_anomaly['prior_star'][-1]= 0.5020904290785894



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.38295364379883 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4634647437066056
accuracies_anomaly["prior"][-1]= 0.4123504419111752
accuracies_anomaly["prior_star"][-1]= 0.4602118592036505


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 1163.021374464035 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003924369812011719 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4688904087945541
 first_prior_anomaly_auc= 0.41268906795277505
 first_prior_star_anomaly_auc= 0.4656509352239395


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4872582522286245; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4126343764943236; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.47517866924156565 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5356665841056145; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4125829329960484; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5161840616936415 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5436385451988234; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41255150112337513; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.520093558016741 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5438453669210134; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4125401856492128; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5176299278366112 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5450794870150744 at iter 350
0.41268906795277505 at iter 0
0.5201646988218915 at iter 290
last anomaly aucs:
0.541254332883648
0.4125326419997712
0.5154585092994338




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.14258527755737 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5411257765244144,first_prior_anomaly_auc= 0.4125330610914068, first_prior_star_anomaly_auc= 0.5153976362393566


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5411256717515055 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4193826947843627 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5067813217563459 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5411257765244144 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4307042457754515 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5061103560476808 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5411257765244144 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4308077614094555 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5062672010923204 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5411258812973233 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.43091337250163764 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5065361531494945 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5411256717515055 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.4311771906862751 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5068645114460212 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.541125147886961 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.4309353748125089 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5071669908340468 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5411258812973233 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.4310916959926039 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5075197612183497 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5411259860702322 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.43092950752960985 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5082306454053098 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5411256717515055 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.4311893443437087 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5082106337797079 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5411253574327788 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.4312719053959305 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5085955694470463 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5411256717515055 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.43135677145214835 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5089280138870205 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5411260908431411 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.43074280220593075 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.509243485115751 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5411260908431411 at iter 44
max_prior_anomaly= 0.44420172053880097 at iter 5
max_prior_star_anomaly= 0.5153976362393566 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5411256717515055
accuracies_anomaly['prior'][-1]= 0.4312885642884473
accuracies_anomaly['prior_star'][-1]= 0.509612495300935



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.3343391418457 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5411256717515055
 first_prior_anomaly_auc= 0.4313812883128334
 first_prior_star_anomaly_auc= 0.5096510517314142


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5403143103448999; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4296860626466559; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5086650338856542 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5389231356603815; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42751013887439526; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.5080362916592802 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5372071649582396; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42707816017095585; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.506540344065851 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5361845813672697; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43160078755700176; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 400 
last prior star auc 0.5053751645458534 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5411256717515055 at iter 0
0.4356107610997467 at iter 460
0.5096510517314142 at iter 0
last anomaly aucs:
0.5366974447563884
0.43517260079468156
0.5053312646970198




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.1555106639862 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5368140570040061,first_prior_anomaly_auc= 0.4343921473962046, first_prior_star_anomaly_auc= 0.5052971087287148


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5368140570040061 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42165773372845294 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5044714982064974 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5368140570040061 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4206511803925464 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5038518712231985 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5368140570040061 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.42087487055307105 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5037983322667451 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5368140570040061 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4201305638081683 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5037887979320342 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5368140570040061 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41969366077801007 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5037813590555016 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5368140570040061 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4181285630646998 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.504084047989345 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5368140570040061 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4190741385676202 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5039362134148717 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5368140570040061 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41867945901975306 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5040180410567312 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5368140570040061 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41842423221364616 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5041670281332025 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5368140570040061 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.418862811610347 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5043476566281647 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5368140570040061 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41785133394772167 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.504501253712628 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5368140570040061 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41799047237075526 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5045199032904142 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5368142665498239 at iter 14
max_prior_anomaly= 0.4343921473962046 at iter 0
max_prior_star_anomaly= 0.5084724612790761 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5368140570040061
accuracies_anomaly['prior'][-1]= 0.41738907587360696
accuracies_anomaly['prior_star'][-1]= 0.5046215330120577



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.42817544937134 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5368140570040061
 first_prior_anomaly_auc= 0.41815643265847013
 first_prior_star_anomaly_auc= 0.5046667949087071


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5380849523890947; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4149000906495208; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5041087743958479 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5405909108244245; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41520497981445137; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5057296112966989 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5437114671434253; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4153011613448315; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5078814372999099 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5474109985570675; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.41638849459350835; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 340 
last prior star auc 0.5111639725360869 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5511205881699651 at iter 490
0.4182192964038166 at iter 340
0.5135188484367672 at iter 490
last anomaly aucs:
0.5511205881699651
0.4157144904704848
0.5135188484367672




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.1057059764862 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5514981897336798,first_prior_anomaly_auc= 0.41395870606295676, first_prior_star_anomaly_auc= 0.513228837024902


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.551497980187862 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4396427369533631 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5217441504237226 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5514982945065887 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.42467959396725974 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5183560040953634 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.551497980187862 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4203369664387227 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5167837818242472 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.551497980187862 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.42051591856714243 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5163670999655088 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5514980849607709 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.41882456949859453 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5159380549035189 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5514982945065887 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.41852481420620063 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5157935730621308 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5514981897336798 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.41775976242533364 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5155883229335744 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.551497980187862 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4181646049453651 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5155334219293051 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5514981897336798 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4157615335065858 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5155918852124775 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5514981897336798 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.41870041360153526 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5158181946957249 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5514981897336798 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.42059240279064736 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5167049925967463 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.551497980187862 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4219462783195934 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5171972157228095 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5514983992794976 at iter 32
max_prior_anomaly= 0.44605347693089137 at iter 7
max_prior_star_anomaly= 0.5251222385528262 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5514981897336798
accuracies_anomaly['prior'][-1]= 0.4185053264451432
accuracies_anomaly['prior_star'][-1]= 0.5158932120985049



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.7652895450592 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.551497980187862
 first_prior_anomaly_auc= 0.4162441175250292
 first_prior_star_anomaly_auc= 0.5155659015310675


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5564107818866919; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4213511681969797; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 40 
last prior star auc 0.5198077375212322 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.560596983462225; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4203755228692019; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 40 
last prior star auc 0.5226642661097777 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5644808104226413; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.42154824603864105; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 40 
last prior star auc 0.5255979075592816 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5678232757627154; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4217120060952687; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 40 
last prior star auc 0.5279946926235262 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5698338678847146 at iter 490
0.4220166857143815 at iter 40
0.5291247732190387 at iter 460
last anomaly aucs:
0.5698338678847146
0.42104397402805316
0.5290352971548288




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.20060110092163 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5699334021481799,first_prior_anomaly_auc= 0.4208757087363423, first_prior_star_anomaly_auc= 0.5288936441819813


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5699336116939977 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4199448014406694 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5363893076312816 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5699336116939977 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41879669990482427 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5324948986070652 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5699334021481799 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.42614620514619383 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5323920116105146 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5699336116939977 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.42683686816173416 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5322215460877167 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5699336116939977 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4247210840391884 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5319452599269188 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5699336116939977 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.42909681980694125 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5321887521672276 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5699336116939977 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.42965085894926186 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5321432807247604 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5699336116939977 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.42868129045020076 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5321910571712236 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5699334021481799 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4308222200708851 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5324142234672038 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5699336116939977 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4306780525482239 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.532397459801778 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5699338212398155 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.43277665391370823 iter_best_prior_anomaly= 1060
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.53298984582876 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5699336116939977 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4306333145161189 iter_best_prior_anomaly= 1060
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5326776225602057 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5699338212398155 at iter 21
max_prior_anomaly= 0.433721705552084 at iter 106
max_prior_star_anomaly= 0.5436096278759639 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5699336116939977
accuracies_anomaly['prior'][-1]= 0.42985988090253896
accuracies_anomaly['prior_star'][-1]= 0.5326461906875324



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.27327227592468 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5699336116939977
 first_prior_anomaly_auc= 0.42993940354040233
 first_prior_star_anomaly_auc= 0.532739438576463


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5701196883802234; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41626570074426483; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5300553661959848 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5686900620381348; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4185924975053571; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5292622352755297 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5644923354426216; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.42026152994430693; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5269674990245642 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.558948172194695; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4236188730374463; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5238102721874446 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5701758466593996 at iter 90
0.42993940354040233 at iter 0
0.532739438576463 at iter 0
last anomaly aucs:
0.553974183117061
0.4227674883796367
0.5201414392361133




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.10061478614807 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.553567664230487,first_prior_anomaly_auc= 0.42548414513478616, first_prior_star_anomaly_auc= 0.5208261301958457


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5535678737763048 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4315518586085403 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5266845073975961 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.553567664230487 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.430932860262695 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5234089919463161 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5535678737763048 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4274087186985696 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5217856404956512 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5535678737763048 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4258291623238295 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5209139298935129 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5535678737763048 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.42603252654002555 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5207582373508715 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5535677690033959 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4241695594466817 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5205176787520122 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.553567664230487 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.42481537965720817 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5206861535895408 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.553567664230487 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.42572627532727914 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5206167939238417 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5535678737763048 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.42640750878101746 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5207959555980795 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.553567664230487 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.42550688085601984 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5207437786894418 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.553567664230487 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.42464313299495876 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5206668753743012 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5535678737763048 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.42322786054139094 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.521038400109299 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5535680833221226 at iter 17
max_prior_anomaly= 0.43513634936819845 at iter 11
max_prior_star_anomaly= 0.533263617439744 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.553567664230487
accuracies_anomaly['prior'][-1]= 0.4259022938142494
accuracies_anomaly['prior_star'][-1]= 0.5210307516869486



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.76237154006958 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5535674546846692
 first_prior_anomaly_auc= 0.4257157980363881
 first_prior_star_anomaly_auc= 0.5209334176545705


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5504691102223574; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4220324016507181; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 40 
last prior star auc 0.5198483894098896 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5455727578702265; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4148910801793545; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 40 
last prior star auc 0.513856426749278 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5413310266529707; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.415474560509079; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 40 
last prior star auc 0.5107391183904534 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5368324970359744; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4135152023395372; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 40 
last prior star auc 0.5069878291598092 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5561429823315158 at iter 10
0.4332397501710942 at iter 40
0.5264642747430653 at iter 40
last anomaly aucs:
0.5330348981795916
0.4158742691565739
0.5044268649473014




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.07186007499695 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5324229196186434,first_prior_anomaly_auc= 0.4179908914623909, first_prior_star_anomaly_auc= 0.5042118709382163


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5324228148457344 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41413964887664584 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5105062082139447 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5324228148457345 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41510984601316037 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5067563858040252 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5324229196186434 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41678348846010227 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5055961306107464 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5324229196186434 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4164752465620865 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5051104034050357 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5324228148457344 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41532965957605533 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.504728191833329 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5324228148457344 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4154419761344077 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5047191813631625 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5324228148457344 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4152140950575266 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.50463766804003 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5324229196186434 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41609135862383717 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5047929414910358 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5324228148457345 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4158011376661541 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5047885410288615 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5324227100728256 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4158346649970056 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5047789019212419 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5324228148457344 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41530514271537017 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5046840824386775 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5324227100728256 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4164924293191479 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5050003918506794 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5324230243915523 at iter 8
max_prior_anomaly= 0.42065945745235034 at iter 1
max_prior_star_anomaly= 0.5182876921587536 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5324228148457345
accuracies_anomaly['prior'][-1]= 0.41874001776110353
accuracies_anomaly['prior_star'][-1]= 0.5054999490803662



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.59786081314087 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5324229196186434
 first_prior_anomaly_auc= 0.41682141625312796
 first_prior_star_anomaly_auc= 0.5050555024007665


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5277589535784768; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4395896170885452; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 70 
last prior star auc 0.5053503333664415 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5223587483073936; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4416578343104455; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 140 
last prior star auc 0.501941546775027 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5167014303178432; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4425676822514273; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 140 
last prior star auc 0.4985218638010857 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5113741469913621; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44416903139122077; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 310 
last prior star auc 0.49511863017384344 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5334259106756469 at iter 10
0.44838467415415784 at iter 310
0.510402273488305 at iter 20
last anomaly aucs:
0.5066329633173282
0.4433690902316864
0.4914264328638249




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.12615895271301 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5063410659931026,first_prior_anomaly_auc= 0.4434023032438112, first_prior_star_anomaly_auc= 0.4918289703798605


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5063410659931026 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4340670370598543 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49174242795710016 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5063408564472848 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42758788037280715 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4895154797781999 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5063408564472848 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42565702043448905 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4887564000531408 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5063408564472848 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4253547505922812 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4885042116613924 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5063409612201937 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42530005913382984 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48834569025021024 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5063410659931027 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4264337020082452 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48843621404350923 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5063409612201937 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42513242247957245 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48816003265562025 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5063410659931026 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42465727733766173 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4880005682882579 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5063409612201937 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4241783603710302 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4878643635066738 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5063409612201937 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4249494889806141 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48801670331623015 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5063410659931026 iter_best_vanilla_star_anomaly= 1070 
last prior auc 0.4244916313686736 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48785493394487184 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5063410659931026 iter_best_vanilla_star_anomaly= 1070 
last prior auc 0.42453636940077855 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48790040538733914 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5063411707660115 at iter 107
max_prior_anomaly= 0.4434023032438112 at iter 0
max_prior_star_anomaly= 0.4940981420410517 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5063408564472848
accuracies_anomaly['prior'][-1]= 0.4252057635158101
accuracies_anomaly['prior_star'][-1]= 0.4881236764562282



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.4248034954071 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5063408564472848
 first_prior_anomaly_auc= 0.42462092113826966
 first_prior_star_anomaly_auc= 0.4879833855311965


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.505930356190172; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44716312680916614; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 50 
last prior star auc 0.49236687449420874 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5001972873874792; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4497075369020662; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 170 
last prior star auc 0.4889523253928041 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4954178616016928; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4487999939650804; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 170 
last prior star auc 0.4853233061468589 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.49191425552771384; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.45049867713725206; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 170 
last prior star auc 0.4830146350990083 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.510564566724208 at iter 10
0.4603825342722663 at iter 170
0.49597336756473814 at iter 50
last anomaly aucs:
0.4888276456312002
0.4501494690318522
0.48018702383332224




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.13944053649902 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.48897705179930706,first_prior_anomaly_auc= 0.45542824250150765, first_prior_star_anomaly_auc= 0.4813403640146129


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.48897684225348925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4197311694794002 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4766806936637117 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.48897705179930706 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4326977599132983 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4782734514249744 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.48897726134512487 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.434828945653454 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.478329190612515 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.48897726134512487 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4358923906788991 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4782837191700477 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.48897726134512487 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.43753732534879947 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47835496474810707 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.48897705179930706 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.43830300576712 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47841426621455063 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.48897705179930706 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.438756672462704 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47839687391167135 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.48897726134512487 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.43902258610551975 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47832196128180016 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.48897684225348925 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.43911415762790784 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47833652471613874 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.48897705179930706 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.43985270186282044 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47841300893964367 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.48897705179930706 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4402467527732341 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4784704244937268 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.48897705179930706 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4407303845207666 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4785212393545486 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.48897726134512487 at iter 14
max_prior_anomaly= 0.45542824250150765 at iter 0
max_prior_star_anomaly= 0.4823149616133017 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.48897705179930706
accuracies_anomaly['prior'][-1]= 0.4407737605050557
accuracies_anomaly['prior_star'][-1]= 0.4784816351949803



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.67638373374939 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.46889051356746303
accuracies_anomaly["prior"][-1]= 0.41268906795277505
accuracies_anomaly["prior_star"][-1]= 0.4656509352239395


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 1557.5309479236603 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0037851333618164062 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.45918403696723503
 first_prior_anomaly_auc= 0.41242514499522864
 first_prior_star_anomaly_auc= 0.4558501630056917


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4784708435853625; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41251797379252364; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.46624772171309575 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5316443521325268; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4126124789563613; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 200 
last prior star auc 0.5127137734046963 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5442962047480567; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4126417105979474; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 290 
last prior star auc 0.5198861076570975 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5443831662624528; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4126516640242939; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 390 
last prior star auc 0.5182675757602427 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5461463895465135 at iter 340
0.4126526069804741 at iter 390
0.5200736511640479 at iter 320
last anomaly aucs:
0.5416294198975489
0.4126441203748523
0.5160041666090416




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.06062650680542 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5414133781593746,first_prior_anomaly_auc= 0.41264118673340283, first_prior_star_anomaly_auc= 0.515828462440798


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5414133781593746 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42200956115657556 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5062147098649561 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5414133781593746 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4296357716503787 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5062336737614689 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5414134829322836 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4301030588241211 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5063762696904966 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5414132733864658 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4299940949988538 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.506566118201443 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5414133781593747 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4304634776307744 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5068836848883519 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5414133781593746 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4306385531615644 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5073969673691061 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5414133781593746 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4300017434212043 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5077525666219496 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5414133781593746 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4313636864641364 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5080139750296822 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5414133781593746 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4316659563063443 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.50840666389228 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5414133781593746 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.43198457072234214 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5087783981730958 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5414133781593746 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4320684938223797 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5091445794897392 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5414131686135568 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4322505891380668 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5095070937545707 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5414135877051925 at iter 16
max_prior_anomaly= 0.453989291370526 at iter 5
max_prior_star_anomaly= 0.515828462440798 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5414133781593747
accuracies_anomaly['prior'][-1]= 0.43230873810251236
accuracies_anomaly['prior_star'][-1]= 0.5098264415809309



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.69030165672302 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5414131686135568
 first_prior_anomaly_auc= 0.43365087906566036
 first_prior_star_anomaly_auc= 0.510056732434717


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5375411809918474; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.432215071121946; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5067157339153678 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5284095933428132; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4303091471359487; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.49914421488001615 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5245503880159909; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4421938525124334; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 300 
last prior star auc 0.49744731284729604 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5262617487101406; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4486034399879637; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 380 
last prior star auc 0.5000660069326138 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5414131686135568 at iter 0
0.4523348223659148 at iter 470
0.510056732434717 at iter 0
last anomaly aucs:
0.5277690117777323
0.4515696658121388
0.5022094511031121




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.20176076889038 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5278956822246055,first_prior_anomaly_auc= 0.452234659464996, first_prior_star_anomaly_auc= 0.5025872622126446


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5278955774516966 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4203451387256178 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49466789711970893 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5278955774516965 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41935451087186565 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49460042336637033 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5278959965433322 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4177750592700346 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4944833920271169 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5278955774516966 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4157051656815918 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49432644220956845 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5278955774516966 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41931637353302215 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49543902572929277 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5278955774516966 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41393397965645384 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4943466633809883 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5278957869975144 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.414781173397907 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4947753941242514 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5278956822246055 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4147762490711882 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49510060923351074 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5278956822246055 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4095013521991624 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49527620862884525 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5278954726787876 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4197892136709368 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4966555439746567 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5278955774516966 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4139730599514776 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4956929952604927 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5278956822246055 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41243268864467025 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49537878130666907 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5278959965433322 at iter 1
max_prior_anomaly= 0.452234659464996 at iter 0
max_prior_star_anomaly= 0.5025872622126446 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5278955774516966
accuracies_anomaly['prior'][-1]= 0.41274218781759286
accuracies_anomaly['prior_star'][-1]= 0.49572463667898375



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.81477403640747 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5278956822246055
 first_prior_anomaly_auc= 0.4134864945624956
 first_prior_star_anomaly_auc= 0.49603151652918365


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5295113852529196; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41407165125876266; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 100 
last prior star auc 0.4966620398950091 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5320146195926178; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4097735522165128; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 100 
last prior star auc 0.49715227233580306 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5352550361194126; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.40823716228024404; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 100 
last prior star auc 0.49914693897564777 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.538983694401732; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4058996786824429; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 100 
last prior star auc 0.501451523880051 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.542496625264604 at iter 490
0.41407165125876266 at iter 100
0.5035719180105888 at iter 490
last anomaly aucs:
0.542496625264604
0.40367639755535467
0.5035719180105888




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.09832692146301 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5428246692424038,first_prior_anomaly_auc= 0.40258822612340656, first_prior_star_anomaly_auc= 0.5034585537231473


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5428246692424039 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41103061757762516 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5101858126584953 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5428248787882217 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4074274772401809 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5079405292205357 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5428246692424039 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.40765336763179283 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5072957567390983 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5428246692424039 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.40700587105472374 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5069101924343064 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5428246692424039 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4065955803434288 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5067352216764252 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5428248787882216 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.40611781587879536 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5065751286716094 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5428246692424038 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.405585779047346 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5066338015005996 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5428246692424039 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4060109475117063 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5067010657081202 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5428246692424039 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4061918903253953 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5068512052865896 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5428248787882217 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.40572386974129054 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5070688186183974 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5428248787882217 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.40643842098006255 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5071901456469161 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5428245644694949 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.40606679147215574 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5073280267950427 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5428248787882217 at iter 3
max_prior_anomaly= 0.41618355878367874 at iter 5
max_prior_star_anomaly= 0.5145521188644461 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5428246692424039
accuracies_anomaly['prior'][-1]= 0.4050997375229086
accuracies_anomaly['prior_star'][-1]= 0.507138597375732



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.5259621143341 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5428248787882217
 first_prior_anomaly_auc= 0.4036765023282636
 first_prior_star_anomaly_auc= 0.507540506254314


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5478351192923386; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.40690759406616533; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 80 
last prior star auc 0.5113322378277978 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5519250345645828; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4057867334866371; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 110 
last prior star auc 0.5140840982803414 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5555547872208902; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.40324619999136674; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 110 
last prior star auc 0.5159219198755465 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5588327124490751; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.40227914604211956; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 110 
last prior star auc 0.5179353408660864 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5614392528769594 at iter 490
0.40806533470963025 at iter 110
0.5195426620616878 at iter 480
last anomaly aucs:
0.5614392528769594
0.40068911237648847
0.519340240801672




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.19035911560059 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5616900792208919,first_prior_anomaly_auc= 0.4009686464974626, first_prior_star_anomaly_auc= 0.5200426383830103


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5616900792208919 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4083640422729351 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.521178376715604 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5616900792208919 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.410851036811752 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5222587949522927 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5616900792208919 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41130784669460335 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5229873857608588 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5616900792208919 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4093753103897427 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5216175847497584 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5616900792208919 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41117541373773997 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5221734050315303 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5616900792208919 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4124348888757574 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5225081544755005 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5616900792208919 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41283187342762057 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5221764434458889 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5616900792208919 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4147777158919129 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5225452440852549 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5616900792208919 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4125722461593395 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5223811697099006 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5616898696750741 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4131772049353908 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5231080841519241 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5616900792208919 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4137923266836063 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5234400047273536 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5616900792208919 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41360321158302227 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5234622165840428 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5616900792208919 at iter 0
max_prior_anomaly= 0.4315397049511067 at iter 2
max_prior_star_anomaly= 0.5320716160550654 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5616898696750741
accuracies_anomaly['prior'][-1]= 0.413710499041747
accuracies_anomaly['prior_star'][-1]= 0.5229253601987836



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.29059863090515 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.561689974447983
 first_prior_anomaly_auc= 0.414761161772305
 first_prior_star_anomaly_auc= 0.5237300161392189


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5657628117360746; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41462851926962396; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 70 
last prior star auc 0.5276958802873125 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5681495386010638; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4135110114231807; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 70 
last prior star auc 0.5290578233302445 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5696004338436611; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4131017684409749; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 70 
last prior star auc 0.5293971827822069 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5706630406858351; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.41265072106811373; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 70 
last prior star auc 0.5300348307058383 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5709981044485319 at iter 460
0.42127133124038973 at iter 70
0.5313906969200537 at iter 440
last anomaly aucs:
0.5709670916674945
0.4115971246961062
0.5298462394697987




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.28075218200684 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5709407936673577,first_prior_anomaly_auc= 0.40992945430497213, first_prior_star_anomaly_auc= 0.5295484748626741


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5709408984402666 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4146576461383011 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5311880661142201 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5709412127589935 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4158552004871521 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5308404296024538 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5709408984402666 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4166890880691736 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5309101035868796 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5709411079860844 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4166001358695083 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5309966460096399 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5709408984402666 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4175097742646723 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5312791137720636 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5709410032131756 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4192978287281449 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5317621168821426 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5709410032131756 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41880853924353123 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5316850040211842 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5709406888944488 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.42218390327700317 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5325484375635186 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5709407936673577 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4186870026691947 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5319479840225505 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5709406888944488 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4197156630888813 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5323040023670296 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5709408984402666 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4214951261738233 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5326602302573265 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5709406888944488 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.42080215815428695 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5327964350389105 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5709412127589935 at iter 20
max_prior_anomaly= 0.43212077550392625 at iter 3
max_prior_star_anomaly= 0.5410998976159135 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5709408984402666
accuracies_anomaly['prior'][-1]= 0.42358607911695717
accuracies_anomaly['prior_star'][-1]= 0.533814827713524



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.92337584495544 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5709408984402666
 first_prior_anomaly_auc= 0.42095847933438185
 first_prior_star_anomaly_auc= 0.5328155037083323


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.571610292555298; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.42926445646119865; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 70 
last prior star auc 0.536107887597947 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5709114572528626; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4212407375509878; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 70 
last prior star auc 0.5337083784380706 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.56981699944638; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4231589199673276; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 70 
last prior star auc 0.5329217434379679 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5679875596838876; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4226759168572486; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 70 
last prior star auc 0.5315167387294735 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5721170791156999 at iter 50
0.4333784695024921 at iter 70
0.5381605984293283 at iter 70
last anomaly aucs:
0.5654964790016231
0.4250986856029031
0.5304991842381312




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.09595274925232 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5657324275924903,first_prior_anomaly_auc= 0.4203415764467148, first_prior_star_anomaly_auc= 0.5287186734241003


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5657323228195814 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.42684545954026487 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5309289627104836 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5657322180466726 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.42922045183945606 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5307177405261192 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5657324275924904 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.42964373439145587 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5306022807804995 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5657323228195814 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.4297709287028737 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5305623623022044 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5657323228195814 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.4306338383806635 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5308593934989667 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5657323228195814 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.4306868534725723 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5307037009563251 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5657324275924904 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.43226620030149454 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5312275655008795 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5657322180466725 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.43163358147749076 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5312856096924161 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5657322180466726 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.43198268480998175 iter_best_prior_anomaly= 820
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5310968089105587 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5657324275924904 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.43245751563316576 iter_best_prior_anomaly= 960
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.531608938889315 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5657324275924904 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.43059528195018426 iter_best_prior_anomaly= 960
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5312376237001349 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5657323228195814 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.43281290534019135 iter_best_prior_anomaly= 1150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5313507784417586 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5657325323653992 at iter 24
max_prior_anomaly= 0.4351646380536044 at iter 121
max_prior_star_anomaly= 0.5389815989435538 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5657324275924903
accuracies_anomaly['prior'][-1]= 0.433599540340294
accuracies_anomaly['prior_star'][-1]= 0.531846354300907



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.58152914047241 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5657322180466725
 first_prior_anomaly_auc= 0.4336308674400584
 first_prior_star_anomaly_auc= 0.5316861565231823


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5613989153070287; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.415114875112788; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5246235195064106 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5568357408052343; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4162227438516114; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5219524389666373 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5535554058001444; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41429974188146157; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5187287861052683 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5503326958949555; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4118178812151813; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5163575656307979 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5657322180466725 at iter 0
0.4336308674400584 at iter 0
0.5316861565231823 at iter 0
last anomaly aucs:
0.5470744679736458
0.418968632248347
0.5161649930242197




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.15576910972595 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5471021280215983,first_prior_anomaly_auc= 0.4254651812382733, first_prior_star_anomaly_auc= 0.5178602186903972


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5471021280215984 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.42409747568535106 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5176418719482272 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5471020232486894 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4256514674703168 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5164874840378474 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5471020232486894 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.42650494758630453 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.516316285104687 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5471019184757805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4261334228513067 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5160147486728416 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5471021280215983 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.42603451722529484 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5159041084810316 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5471021280215983 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.42541007068818615 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5156537012287348 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5471019184757805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.42642311994444526 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5161417334384415 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5471020232486894 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4260944473291919 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5157461109343942 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5471021280215984 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.42703446986794 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5160438755415188 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5471020232486894 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4267926539941738 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5160134913979346 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5471019184757805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4276815473533735 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.516094166537796 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5471021280215983 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.42769956829370614 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5161248650001069 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5471021280215984 at iter 3
max_prior_anomaly= 0.4455071909838302 at iter 4
max_prior_star_anomaly= 0.5251547181545887 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5471020232486894
accuracies_anomaly['prior'][-1]= 0.4287426873748226
accuracies_anomaly['prior_star'][-1]= 0.5163623851846078



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.14413714408875 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5471021280215983
 first_prior_anomaly_auc= 0.42656236314038776
 first_prior_star_anomaly_auc= 0.5158808488952535


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5438116300443441; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42631069861318394; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 30 
last prior star auc 0.5126829701694765 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5398954282550743; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4271648073666251; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 170 
last prior star auc 0.5106497470991525 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5364178058625053; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4343413325353829; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 170 
last prior star auc 0.5098136592860438 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5327425817637303; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4368741128353938; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 170 
last prior star auc 0.508639364522971 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5473267611383033 at iter 10
0.4406000470220815 at iter 440
0.5162926064272731 at iter 30
last anomaly aucs:
0.529351082702286
0.44018074584062034
0.5072921944601954




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.10245656967163 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5293083353554504,first_prior_anomaly_auc= 0.43977506513731746, first_prior_star_anomaly_auc= 0.5074024155603695


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5293083353554504 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4310667600402831 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5057532899741126 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5293083353554504 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4336389349540445 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5051187852377486 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5293084401283593 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.43505661718451727 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5048302406466081 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5293083353554504 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.43596950353985753 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5046231046056914 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5293083353554504 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.44017341173699653 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.505673033925887 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5293085449012682 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4382613061493734 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.504659879896719 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5293083353554504 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4375123893964787 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5045569929001686 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5293083353554504 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4391349026638721 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5048245829095269 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5293083353554504 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4400484176566659 iter_best_prior_anomaly= 870
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.50518405876 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5293083353554504 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4418539691959266 iter_best_prior_anomaly= 920
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5054773181320416 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5293083353554504 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4410428173351388 iter_best_prior_anomaly= 1090
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5052723823222119 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5293083353554504 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.44159371329019204 iter_best_prior_anomaly= 1090
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.504964454742923 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5293087544470861 at iter 69
max_prior_anomaly= 0.4497943936435533 at iter 126
max_prior_star_anomaly= 0.5113772901786294 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5293084401283593
accuracies_anomaly['prior'][-1]= 0.4410815833114358
accuracies_anomaly['prior_star'][-1]= 0.5048484711327587



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.28347063064575 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.45918403696723503
accuracies_anomaly["prior"][-1]= 0.41242514499522864
accuracies_anomaly["prior_star"][-1]= 0.4558499534598739


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 1553.6997468471527 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.00337982177734375 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4676442398159685
 first_prior_anomaly_auc= 0.4123759017280406
 first_prior_star_anomaly_auc= 0.4642810294399301


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4911496228384825; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41219925460361684; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.47891707140441375 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5383241489401382; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41210747353541094; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5194329648260582 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5444484397847043; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4120754130252842; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5216404252439009 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5444868914422745; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4120576016307694; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5184445372033931 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5460158425020106 at iter 340
0.4123759017280406 at iter 0
0.5217697150134969 at iter 280
last anomaly aucs:
0.542618895249303
0.41204094273825254
0.5164881126753007




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.15719890594482 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5425914447471683,first_prior_anomaly_auc= 0.41204209524025054, first_prior_star_anomaly_auc= 0.5164567855755364


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5425914447471683 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4128792307824483 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5155318503356714 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5425913399742595 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.41506867025995836 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5144639000751432 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5425914447471683 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4220270582323637 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5131569628093892 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5425914447471683 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.431239635339986 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.511227255373069 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5425913399742595 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4256613161237544 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5089350336719174 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5425913399742595 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4243223183478737 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5080378632529139 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5425914447471683 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4255020613022099 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.50764863189631 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5425912352013504 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4259442029778137 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5072806694402151 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5425913399742595 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4253968693016634 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.506947072498243 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5425913399742595 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4253290812295981 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5066561181301975 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5425911304284416 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4257954254471603 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5064724512208769 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5425912352013504 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.42643590223933237 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5063970147264609 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5425916542929861 at iter 54
max_prior_anomaly= 0.43154232427382944 at iter 41
max_prior_star_anomaly= 0.5164567855755364 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5425912352013504
accuracies_anomaly['prior'][-1]= 0.4269318971901163
accuracies_anomaly['prior_star'][-1]= 0.5063518576027204



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.80935525894165 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5425914447471683
 first_prior_anomaly_auc= 0.42696406247315194
 first_prior_star_anomaly_auc= 0.5063551055628966


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5424945298064258; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.42631279407136213; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5065109028784471 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5403442753968484; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4267157506790332; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5047932558097625 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5388565000903143; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.42821505100554746; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 300 
last prior star auc 0.503390660878173 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5392558944190824; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.42965106849507967; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 400 
last prior star auc 0.5031002303746721 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5426797683093801 at iter 50
0.43001714503881416 at iter 490
0.5065118458346273 at iter 90
last anomaly aucs:
0.5415619461442103
0.43001714503881416
0.5043568766441489




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.11072778701782 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5418683021298656,first_prior_anomaly_auc= 0.42999577136539635, first_prior_star_anomaly_auc= 0.50456935610342


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5418683021298656 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43199420982996195 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5043853748753726 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5418683021298656 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42941553899584806 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5039513007137549 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5418683021298656 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42789308385646446 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5036301717479432 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5418683021298656 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4266166355072035 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5033405794277136 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5418683021298656 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42555612412320787 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5030742466932623 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5418680925840478 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42473302815080427 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5028242585326008 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5418683021298656 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4238328193174422 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5025790899257496 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5418683021298656 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.4229240191055495 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5023370645061654 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5418683021298656 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.42207640627246074 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.502127204369617 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5418683021298656 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.4212002952081481 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5019132580896211 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5418683021298656 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.4205825541372098 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5017559939533459 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5418683021298656 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.4199830435524219 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5015981011796173 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5418684069027745 at iter 123
max_prior_anomaly= 0.43808046810859336 at iter 2
max_prior_star_anomaly= 0.5057960373209484 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5418683021298656
accuracies_anomaly['prior'][-1]= 0.4196193767855923
accuracies_anomaly['prior_star'][-1]= 0.5014881943981697



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.47938895225525 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5418683021298656
 first_prior_anomaly_auc= 0.41956353282514286
 first_prior_star_anomaly_auc= 0.5014798125654569


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5458500917601137; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42121391568630656; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 80 
last prior star auc 0.5039581109528342 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5490718587091223; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.42057962049576025; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 140 
last prior star auc 0.5061485981594334 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5510851749267534; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4212141252321244; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 260 
last prior star auc 0.5078068389887654 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5523397257380519; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4225302825138625; count_not_improved_prior_anomaly= 32; iter_best_prior_anomaly= 260 
last prior star auc 0.508905068619969 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5532743000855366 at iter 490
0.4228349621329753 at iter 490
0.5097084672854975 at iter 490
last anomaly aucs:
0.5532743000855366
0.4228349621329753
0.5097084672854975




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.09547066688538 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5533814827713525,first_prior_anomaly_auc= 0.42149785026945497, first_prior_star_anomaly_auc= 0.5097006093173291


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5533815875442614 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42658122226399176 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5111480470539325 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5533813779984436 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4221771978108329 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5093417621043094 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5533812732255347 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42153996897883717 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5090538461506224 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5533815875442614 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42134572000571635 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5089527402935234 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5533812732255347 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4210156853426472 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5088111920935848 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5533815875442614 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4209366865693284 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5087464424358779 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5533815875442614 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4207275598431424 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.508669958212373 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5533814827713525 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4205536368143503 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.508587816251787 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5533815875442614 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4204027638255188 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5084953017732187 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5533814827713525 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4200947314733209 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5084252086971572 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5533813779984436 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42009305510677825 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.508372612696884 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5533814827713525 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4197529622444537 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5083036721228207 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5533815875442614 at iter 1
max_prior_anomaly= 0.4284078331579435 at iter 6
max_prior_star_anomaly= 0.5147338998614064 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5533813779984436
accuracies_anomaly['prior'][-1]= 0.41975023814882195
accuracies_anomaly['prior_star'][-1]= 0.508268049333791



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.94818830490112 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5533813779984436
 first_prior_anomaly_auc= 0.4197012044274517
 first_prior_star_anomaly_auc= 0.5082753834374147


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5547844967945776; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4132174377324125; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5081062799624326 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5564076386994246; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4136868203643331; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5092445328448402 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5582803496732971; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4130825949986442; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5102340081965943 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5603498241701043; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4133194865456916; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5113821097324394 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5620083793181629 at iter 490
0.4197012044274517 at iter 0
0.5123751473630964 at iter 490
last anomaly aucs:
0.5620083793181629
0.4137482172889549
0.5123751473630964




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.1197817325592 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5621058181234502,first_prior_anomaly_auc= 0.41210433034814364, first_prior_star_anomaly_auc= 0.5120266726680589


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5621056085776324 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.423141946756084 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5165672162215285 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5621059228963591 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4161700430784292 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5130803738129753 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5621057133505412 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4170095883975318 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5127619689427952 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5621058181234502 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4173886567819713 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5126909329105537 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5621059228963591 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4171918932590367 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5126462996513577 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5621055038047233 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4173641399212862 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5126119341372349 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5621057133505412 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4172914275225021 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5125937036510844 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5621055038047233 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.41695311579962896 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5125484417544349 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5621051894859966 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4166661428021221 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5125242392124765 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5621053990318146 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4166425688976172 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5125055896346904 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5621053990318146 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4166265386425538 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5124870448298131 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5621058181234502 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4163214399318054 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5124570797778647 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.562106027669268 at iter 27
max_prior_anomaly= 0.4237339136914303 at iter 7
max_prior_star_anomaly= 0.5198238725492045 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5621056085776324
accuracies_anomaly['prior'][-1]= 0.4162377263775856
accuracies_anomaly['prior_star'][-1]= 0.5124290006382766



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.01300859451294 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5621058181234502
 first_prior_anomaly_auc= 0.41603331443230057
 first_prior_star_anomaly_auc= 0.5124192567577478


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5638655839015169; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.40898325016459824; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5126609678586053 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5653242323393737; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.40505311357844326; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5129736102187952 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5668063499088265; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.40450934218119594; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.513545041663995 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5687268373291625; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.40740086492131766; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5152105118240419 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.569796987820778 at iter 480
0.41603331443230057 at iter 0
0.5160681828563861 at iter 350
last anomaly aucs:
0.569572459476982
0.3999580070181085
0.5140429225271392




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.13541150093079 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5701980585160887,first_prior_anomaly_auc= 0.406301587561025, first_prior_star_anomaly_auc= 0.5156943531173922


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5701980585160887 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.419431728505733 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5206207752943804 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5701978489702709 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4126592076737355 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5172817674603005 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5701980585160887 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41392381668428946 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5171668315792253 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5701980585160887 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4145551782333863 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5171768897784808 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5701980585160887 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4144688453564437 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5171523729177956 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5701980585160887 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41460609786711694 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5171831761530155 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5701978489702709 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4148213014220198 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.517225923499851 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5701980585160887 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41462684290308127 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5172364007907421 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5701980585160887 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41459876376349314 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5172982168069995 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5701981632889976 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41447031217716845 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5173050270460787 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5701980585160887 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4143018373396398 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.517336354145843 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5701980585160887 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41451683134872486 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5174570525369083 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5701982680619065 at iter 14
max_prior_anomaly= 0.42269100415613176 at iter 4
max_prior_star_anomaly= 0.5242553475044979 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5701980585160887
accuracies_anomaly['prior'][-1]= 0.4143877511249467
accuracies_anomaly['prior_star'][-1]= 0.5174777975728727



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.25581812858582 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5701980585160887
 first_prior_anomaly_auc= 0.4144566916990101
 first_prior_star_anomaly_auc= 0.5174981235172014


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5703765915528728; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4005386584792925; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5152719087486637 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5706012246695777; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4015545366040921; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.515420686279317 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.57049613744194; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.39905570272656826; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5145530618206262 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5699148573433027; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4012202062517576; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5143054834368699 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5711929820591062 at iter 250
0.4144566916990101 at iter 0
0.5174981235172014 at iter 0
last anomaly aucs:
0.5685030423957289
0.40416788727105546
0.5132554493437654




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.08493208885193 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5682740088168499,first_prior_anomaly_auc= 0.40131837846740703, first_prior_star_anomaly_auc= 0.512494378933437


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5682735897252142 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41786820238605626 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.517583199119237 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5682735897252141 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4097058689173564 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5146095344185292 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5682735897252142 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4112518979612449 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5146292317254044 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5682735897252141 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4126707326937157 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5148297670730598 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5682733801793963 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4132925599081016 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5149284631532538 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5682734849523053 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41367445716108164 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5150208728589133 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.568273694498123 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41472155761273677 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5152172172902123 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5682736944981231 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41512556194949696 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5153332009003765 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5682733801793963 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41519607411719395 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5153641089085051 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5682734849523053 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4159067487583363 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5155212682718715 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5682735897252142 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4163457472466727 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5156241552684219 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5682735897252142 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4161305436917699 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5156090679695388 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5682740088168499 at iter 0
max_prior_anomaly= 0.4213431006829937 at iter 3
max_prior_star_anomaly= 0.5211511357592872 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.568273799271032
accuracies_anomaly['prior'][-1]= 0.416866049512324
accuracies_anomaly['prior_star'][-1]= 0.5157645509663624



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.85461854934692 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.568273799271032
 first_prior_anomaly_auc= 0.41691759778350823
 first_prior_star_anomaly_auc= 0.5157685323369011


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5665649531266961; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4239030171664125; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 100 
last prior star auc 0.515476006375222 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5638873766665702; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41837540803809375; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 100 
last prior star auc 0.5120541231701935 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5607561335108606; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41929929554886963; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 100 
last prior star auc 0.5093562207657392 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5570605834677569; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42122795525610063; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 360 
last prior star auc 0.5075166180310824 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5693081174277999 at iter 10
0.42488641568944974 at iter 360
0.5173614996439817 at iter 10
last anomaly aucs:
0.5537958596260948
0.4245544951140201
0.5049649786074675




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.09551239013672 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.553292740117505,first_prior_anomaly_auc= 0.4210622045142036, first_prior_star_anomaly_auc= 0.504297994269341


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5532925305716871 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4218322853946984 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5060217181667424 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5532925305716871 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41409061515527545 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5033779833561948 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5532925305716871 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41315331671215905 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.502933431903686 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5532925305716871 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41356989379798864 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5028869127321296 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5532925305716871 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41418700623147353 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5029304982622366 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5532925305716871 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4142072274028934 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.502902838214284 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5532925305716871 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41491538749422185 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5030692175936344 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5532925305716871 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4150775759572158 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5030350616253296 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5532925305716871 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4154987630510374 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5031552361518503 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5532925305716871 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41566430424711653 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5031792291479908 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5532925305716871 iter_best_vanilla_star_anomaly= 1020 
last prior auc 0.4156458642151482 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.50318027687708 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5532925305716871 iter_best_vanilla_star_anomaly= 1140 
last prior auc 0.41583173135555607 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.503213280343387 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5532928448904139 at iter 114
max_prior_anomaly= 0.42601963947222954 at iter 4
max_prior_star_anomaly= 0.50872412580628 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5532925305716871
accuracies_anomaly['prior'][-1]= 0.4158281690766531
accuracies_anomaly['prior_star'][-1]= 0.5032145376182939



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.08423781394958 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5532925305716871
 first_prior_anomaly_auc= 0.41567499108382544
 first_prior_star_anomaly_auc= 0.5031993455465018


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5500506472241675; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4194346621471825; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 90 
last prior star auc 0.5007342485456473 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5453784041241969; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4187022995138956; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 90 
last prior star auc 0.4973852872852208 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.541371888087446; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4211212964348294; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 90 
last prior star auc 0.4952041248675147 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5373609715885208; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41775085672807616; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 90 
last prior star auc 0.4917382370407437 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5548155095756152 at iter 10
0.42531326052035257 at iter 90
0.5050218702970061 at iter 10
last anomaly aucs:
0.5334361784207202
0.4189309140011391
0.4894376335068792




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.21707510948181 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5335887277760945,first_prior_anomaly_auc= 0.4231425753935375, first_prior_star_anomaly_auc= 0.49058343003872823


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5335887277760945 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4234348918093988 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4919136268902604 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5335887277760945 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42370625364347786 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49168092625956944 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5335887277760945 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42423577592511336 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49165033257016744 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5335887277760945 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.424842620613525 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4917153965466011 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5335887277760945 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4259557279977939 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4919182368982525 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5335887277760945 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42651500578556006 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4919997502213852 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5335887277760945 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.42693556424192824 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4920900644688663 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5335887277760945 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4274018036865815 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.492183312357797 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5335889373219123 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.42776913750522294 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49227195023873555 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5335887277760945 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.42803756569785256 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4923379571713493 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5335887277760945 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4281819427663317 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49238091406400286 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5335887277760945 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4285119774294009 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4924843249250978 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5335891468677301 at iter 69
max_prior_anomaly= 0.42884955574191164 at iter 129
max_prior_star_anomaly= 0.4935427408509153 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5335889373219123
accuracies_anomaly['prior'][-1]= 0.42884955574191164
accuracies_anomaly['prior_star'][-1]= 0.49253451114846614



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.61957001686096 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5335887277760945
 first_prior_anomaly_auc= 0.4289352599814007
 first_prior_star_anomaly_auc= 0.49261853902141267


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5332217082761797; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4015742339109673; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4822244378200026 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5303791144845194; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4065697014349279; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4808923550561101 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5273150307634216; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4101348092064374; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.479683066141461 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5248637637865432; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4059979556710014; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.47742950564369746 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5376161983946275 at iter 20
0.4289352599814007 at iter 0
0.49261853902141267 at iter 0
last anomaly aucs:
0.5232607382802072
0.41104937192832025
0.4765455366112166




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.09543061256409 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.522022112951063,first_prior_anomaly_auc= 0.40543469651269654, first_prior_star_anomaly_auc= 0.47491359378202125


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.522022217723972 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41958155376547546 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4802069306860153 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.522022217723972 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4213687700456768 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47967688453983526 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5220220081781541 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4222419474685398 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47964744335243137 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.522022217723972 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4232400141988246 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47979412542490657 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.522022217723972 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4241400134863688 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4800663254422569 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.522022322496881 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.4247912818881587 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4802134266063678 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.522022217723972 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.42540797523000795 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48038609236025287 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.522022322496881 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.42589265470662957 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4804286301612707 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.522022217723972 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.4258823869615563 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.480437640631437 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.522022217723972 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.42697349203495394 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48076495119887447 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5220220081781541 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.42646408615182935 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4806258127758409 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.522022217723972 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.4268882068871005 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48077794303957944 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.522022322496881 at iter 60
max_prior_anomaly= 0.43067910027731293 at iter 4
max_prior_star_anomaly= 0.48304721947367957 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.522022217723972
accuracies_anomaly['prior'][-1]= 0.4270127818757955
accuracies_anomaly['prior_star'][-1]= 0.4808358824582071



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.70034599304199 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.522022217723972
 first_prior_anomaly_auc= 0.427401175049128
 first_prior_star_anomaly_auc= 0.480881877765219


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5156782180894199; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4287141891435988; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 20 
last prior star auc 0.4775477942578578 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5134302105558286; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42720441152619343; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 170 
last prior star auc 0.4752315795605657 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5116295833432867; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42584278280198795; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 170 
last prior star auc 0.4734356671289247 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5108316328690217; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4284618959789415; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 170 
last prior star auc 0.4728956675563982 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5234441956437101 at iter 10
0.43329444162954567 at iter 170
0.48252513606857683 at iter 20
last anomaly aucs:
0.5084833576616028
0.4276635264130408
0.47120379462330575




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.07315683364868 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5082102146880721,first_prior_anomaly_auc= 0.4271180786492509, first_prior_star_anomaly_auc= 0.4709711987655237


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.50821042423389 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.42444228332857664 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47050684523323083 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.50821042423389 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.42107540590072645 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4695188367022014 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5082106337797079 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.421583554508944 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46948551891716783 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5082106337797079 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4227325990009693 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4696663569579479 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5082108433255256 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.42386267959648183 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4699345756047597 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.50821042423389 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4247967300794221 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4701722005621696 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.50821042423389 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4260799886677622 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47088947589657326 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5082106337797078 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4266045866226788 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47105627436755926 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5082106337797079 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4269936084334648 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4711702672924543 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.50821042423389 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.42714909143028856 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47122935921308 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.50821042423389 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4272890680365934 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47126246745229583 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.508210529006799 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.42726748481735777 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47122579693417704 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5082108433255257 at iter 17
max_prior_anomaly= 0.43174726008365905 at iter 4
max_prior_star_anomaly= 0.47195899775073524 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5082102146880721
accuracies_anomaly['prior'][-1]= 0.4271861810400429
accuracies_anomaly['prior_star'][-1]= 0.47126288654393145



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.79153633117676 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5082106337797079
 first_prior_anomaly_auc= 0.42718345694441123
 first_prior_star_anomaly_auc= 0.47127671656790776


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5108645315624196; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.429513187346953; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 90 
last prior star auc 0.4714227700029295 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5097019713651448; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4359210984559407; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 90 
last prior star auc 0.47150973151732545 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5087841606830859; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.43244724788809247; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 90 
last prior star auc 0.46896458801406304 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5073151397272467; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4308980756569366; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 90 
last prior star auc 0.4663228438887848 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5127420620901022 at iter 20
0.4382727263964448 at iter 90
0.47455066042555405 at iter 90
last anomaly aucs:
0.5055618698695326
0.4311945829891543
0.46473762977696365




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.08784914016724 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.506369983315962,first_prior_anomaly_auc= 0.43208096179854016, first_prior_star_anomaly_auc= 0.4658230771132801


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.506369983315962 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.42707114038605887 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46451488257261914 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5063699833159621 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4325675271875221 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4645974436248409 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.506369983315962 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4337487369625831 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.464496232994833 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.506369983315962 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4344532300020996 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46443148333712614 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5063699833159621 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4352595623090776 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46455762991945476 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.506369983315962 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.43628204112713853 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46488095911635363 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5063699833159621 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4368346134487344 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4650096202484961 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.506369983315962 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.43717229653415407 iter_best_prior_anomaly= 770
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46532226260868614 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5063699833159621 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4373011672121145 iter_best_prior_anomaly= 880
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46527134297495554 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.506369983315962 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4377420516128113 iter_best_prior_anomaly= 990
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4656424486183177 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5063701928617799 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4383872431858843 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.465917058412573 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5063699833159621 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4382696879820863 iter_best_prior_anomaly= 1170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46582852530454344 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5063701928617799 at iter 5
max_prior_anomaly= 0.4387211544465832 at iter 129
max_prior_star_anomaly= 0.4665548111091135 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5063699833159621
accuracies_anomaly['prior'][-1]= 0.4387211544465832
accuracies_anomaly['prior_star'][-1]= 0.466037023393276



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.3530592918396 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5063701928617799
 first_prior_anomaly_auc= 0.43850647475622484
 first_prior_star_anomaly_auc= 0.4658848931295374


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5124822252760033; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4403332951959945; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 100 
last prior star auc 0.46732698744778645 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.450820853832153; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.43944021092043833; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 160 
last prior star auc 0.4264605238729264 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4493603194819357; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4353938811783013; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 160 
last prior star auc 0.4220837403760844 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44867971466565076; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4414994176721723; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 390 
last prior star auc 0.42013077335398613 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5128378245288467 at iter 80
0.449046210301021 at iter 490
0.4678908752435446 at iter 80
last anomaly aucs:
0.44908015672350804
0.449046210301021
0.4193671883938439




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.09931445121765 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4480196453395124,first_prior_anomaly_auc= 0.4419849353320651, first_prior_star_anomaly_auc= 0.41753575794608216


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44801985488533025 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4319514624831263 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41578395490909276 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44801985488533025 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4385209334176546 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4154394615845938 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44801985488533025 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.43911436717372565 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41525401353582164 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4480196453395124 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.439948359528656 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4152587283167226 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44801985488533025 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.44045923223250527 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4152345257747642 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44801985488533025 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.44090849846591507 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.415338146181677 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44801964533951244 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.44090221209138036 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4153108004524513 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44801985488533025 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4411116531362932 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4153763882934295 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44801964533951244 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.44116162981384366 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4153644441818137 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.44801985488533025 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4408248896846042 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41534474687493844 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4480196453395124 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.44095543672910714 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41536695873162754 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.44801985488533025 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.44106890578945757 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4153401368669463 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.44802006443114806 at iter 18
max_prior_anomaly= 0.4419849353320651 at iter 0
max_prior_star_anomaly= 0.41966830573405367 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44801985488533025
accuracies_anomaly['prior'][-1]= 0.4416392895055683
accuracies_anomaly['prior_star'][-1]= 0.4153916851381305



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.706778049469 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.44801985488533025
 first_prior_anomaly_auc= 0.44121422581411696
 first_prior_star_anomaly_auc= 0.41537366419779786


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4486363386813617; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.45102851373761427; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.4163114865054589 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.45394392470096767; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.45228704591945146; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 180 
last prior star auc 0.43443772361158084 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4489858611054883; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4522716443018415; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 290 
last prior star auc 0.4183735221257333 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44996423052889784; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4559505354524283; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 290 
last prior star auc 0.4110815372113559 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.45483679943070593 at iter 190
0.4602816379609851 at iter 290
0.43699103940173833 at iter 190
last anomaly aucs:
0.4509769654664301
0.45009980667302846
0.40958978053428313




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.09125518798828 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.45116712829610334,first_prior_anomaly_auc= 0.4525079072114355, first_prior_star_anomaly_auc= 0.4103259149922908


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45116733784192115 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4435889037945814 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4046732070107325 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4511671282961033 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.45468823144587034 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40710833895963855 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45116681397737657 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.45587635623291944 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4075047996469572 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.45116712829610334 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4572897427741268 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4078733907405056 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.45116723306901224 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4580937700771086 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40806617289290154 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4511669187502855 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.45874744825580344 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4084607476678598 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4511676521606479 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.45911195320590437 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40827330893381825 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.45116639488574095 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4595113475346725 iter_best_prior_anomaly= 790
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4083827966236301 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4511668139773766 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.45977705163167043 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40868936215510326 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4511668139773766 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4599583087640862 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40872624221903997 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.45116702352319443 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.46005501415901084 iter_best_prior_anomaly= 1070
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.408699210808541 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.45116639488574095 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.46043313958727017 iter_best_prior_anomaly= 1190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40891546209253293 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4511676521606479 at iter 70
max_prior_anomaly= 0.4606852232061097 at iter 127
max_prior_star_anomaly= 0.4103259149922908 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.45116702352319443
accuracies_anomaly['prior'][-1]= 0.46040275544368603
accuracies_anomaly['prior_star'][-1]= 0.4087830291356696



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.59062194824219 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4511664996586499
 first_prior_anomaly_auc= 0.4605850603051909
 first_prior_star_anomaly_auc= 0.4090801651053408


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4612711133127392; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4289451086348383; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4610224871998937 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4612562355596738; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.42733705402887456; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4609968178372105 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4612660842131115; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4384459160148744; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.46102405879352737 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46127278967928176; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4350910874715489; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.46103453608441847 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4612888199343451 at iter 440
0.4605850603051909 at iter 0
0.4610571670327432 at iter 440
last anomaly aucs:
0.4612702751294679
0.4413286378306476
0.4610299260764264




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.13750433921814 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46126901785456087,first_prior_anomaly_auc= 0.4418762858255246, first_prior_star_anomaly_auc= 0.4610313928971511


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46126901785456087 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4413403723964456 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610330692636937 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46126901785456087 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4453894262342144 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610286688015195 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46126901785456087 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.447799203139164 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46102845925570163 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46126901785456087 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44905312531300906 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46102877357442834 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46126901785456087 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4497306917149355 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46102856402861053 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46126901785456087 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45027970175762844 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46102887834733725 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46126901785456087 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45071251864433914 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610290878931551 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46126901785456087 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45078554536185 iter_best_prior_anomaly= 790
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610295069847907 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46126901785456087 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45119740766677857 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46102908789315505 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46126901785456087 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45141407804240624 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46102971653060854 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.46126901785456087 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45151581253695866 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46103024039515317 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.46126901785456087 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.451770410705612 iter_best_prior_anomaly= 1160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610311833513333 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.46126901785456087 at iter 0
max_prior_anomaly= 0.4520732044123644 at iter 126
max_prior_star_anomaly= 0.46105842430765015 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46126901785456087
accuracies_anomaly['prior'][-1]= 0.4517135190160735
accuracies_anomaly['prior_star'][-1]= 0.4610309738055155



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.9418568611145 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46126901785456087
 first_prior_anomaly_auc= 0.45161817566896456
 first_prior_star_anomaly_auc= 0.4610307642596977


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4612468059978718; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4294864702551807; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.46099241737503627 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4612581214720342; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43174987940638176; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.46100184693683827 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4612610551134837; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43055085823680606; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4610089714946442 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4612690178545609; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 350 
last prior auc 0.43185737641092437; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4610114860444581 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.46127111331273923 at iter 410
0.45161817566896456 at iter 0
0.4610307642596977 at iter 0
last anomaly aucs:
0.4612698560378322
0.4301620459718379
0.4610181915106284




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.07711696624756 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46126042647603027,first_prior_anomaly_auc= 0.43732013110862733, first_prior_star_anomaly_auc= 0.46101117172573136


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46126042647603027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4273184044510885 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46101504832336104 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46126042647603027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.430615503121604 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46100478057828775 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46126042647603027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43317772460901893 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610051996699234 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46126042647603027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43502172780584997 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610056187615591 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46126042647603027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4359382812130021 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610056187615591 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46126042647603027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4367016566273265 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610058283073769 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46126042647603027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43716056196835607 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610054092157413 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46126042647603027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43766252897494795 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610056187615591 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46126042647603027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4378744845696746 iter_best_prior_anomaly= 880
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610061426261036 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46126042647603027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4383187217034566 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610058283073769 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.46126042647603027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43840274957640313 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610062473990125 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.46126042647603027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4385219811467437 iter_best_prior_anomaly= 1130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610058283073769 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.46126042647603027 at iter 0
max_prior_anomaly= 0.4386916084862703 at iter 129
max_prior_star_anomaly= 0.46106387249891345 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46126042647603027
accuracies_anomaly['prior'][-1]= 0.4386916084862703
accuracies_anomaly['prior_star'][-1]= 0.46100645694483033



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.6249361038208 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4676442398159685
accuracies_anomaly["prior"][-1]= 0.4123759017280406
accuracies_anomaly["prior_star"][-1]= 0.4642810294399301


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 2905.756382226944 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0036191940307617188 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4650021813719636
 first_prior_anomaly_auc= 0.4122168564523139
 first_prior_star_anomaly_auc= 0.4615812411231153


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.48004673290829064; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41219925460361684; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4668638911904005 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5334495893530609; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41220857939250993; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5144517464177095 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5418486048229904; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4122063791614228; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 250 
last prior star auc 0.5188235008149237 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5442465423892331; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4122114082610505; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 250 
last prior star auc 0.5184220110279774 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5448398713723952 at iter 360
0.41221937100212774 at iter 250
0.5192468881398324 at iter 340
last anomaly aucs:
0.5430378821120374
0.4122047027948802
0.5173501841698194




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.89096903800964 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5431319681842394,first_prior_anomaly_auc= 0.41220616961560497, first_prior_star_anomaly_auc= 0.5174919419155757


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5431319681842394 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4132413259556442 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5165861801180414 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5431319681842394 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4156176803026512 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5155232589571408 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5431318634113305 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4230642052576722 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5141617350058443 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5431319681842394 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4267070545275936 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.512134588764237 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5431319681842394 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.41329025490410554 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5098467675252597 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5431319681842394 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4176009266954248 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5089726471462164 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5431319681842394 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.4197852323003982 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5084288757489692 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5431318634113305 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.4195489693908042 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5079160123598505 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5431318634113305 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.4205293294994831 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5075702617604447 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5431319681842394 iter_best_vanilla_star_anomaly= 940 
last prior auc 0.42347722006459876 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5074409719908488 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5431318634113305 iter_best_vanilla_star_anomaly= 940 
last prior auc 0.42573518102453656 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5074141501261675 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5431319681842395 iter_best_vanilla_star_anomaly= 940 
last prior auc 0.42677065168330247 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5073500291059141 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5431322825029661 at iter 94
max_prior_anomaly= 0.42800508609609017 at iter 37
max_prior_star_anomaly= 0.5174919419155757 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5431319681842394
accuracies_anomaly['prior'][-1]= 0.4268698716280411
accuracies_anomaly['prior_star'][-1]= 0.507290099002017



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.370356798172 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5431319681842394
 first_prior_anomaly_auc= 0.42688317778747276
 first_prior_star_anomaly_auc= 0.5072829744442111


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5501233596229517; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42288588176670594; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.512695333372728 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5623761322284401; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4180087028569058; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5223569671679422 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5699861029213621; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41393471306681623; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5279934353486193 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5749346321821305; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.41265522630319684; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5314633045459288 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5772633148555831 at iter 490
0.42688317778747276 at iter 0
0.5332100784832906 at iter 490
last anomaly aucs:
0.5772633148555831
0.4134081244266302
0.5332100784832906




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.03237581253052 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5775099502831593,first_prior_anomaly_auc= 0.4134670068014382, first_prior_star_anomaly_auc= 0.5333998222213282


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5775099502831593 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41703965822238925 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5314509413426773 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5775099502831593 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4171582611552763 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5308805576265667 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5775099502831593 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4178942908403751 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5305907557605193 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5775099502831593 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41867631583248577 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5303792192574283 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5775099502831592 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41947803813147155 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5302144114717116 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5775099502831593 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.420128677895808 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.530110371973163 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5775099502831593 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4206877461377563 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5300195338611373 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5775099502831593 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4212266979811936 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5299664139963196 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5775099502831593 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4216742878480608 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5299386491754581 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5775097407373414 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.42205377532413596 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5298975781951651 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5775099502831593 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.422315707596413 iter_best_prior_anomaly= 1090
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5298401626410819 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5775099502831592 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.42254034071311797 iter_best_prior_anomaly= 1180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5298273803461948 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5775101598289771 at iter 9
max_prior_anomaly= 0.4228238562046307 at iter 128
max_prior_star_anomaly= 0.5333998222213282 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5775101598289771
accuracies_anomaly['prior'][-1]= 0.4227997584355812
accuracies_anomaly['prior_star'][-1]= 0.5298181603302107



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.41458702087402 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5775101598289771
 first_prior_anomaly_auc= 0.4227771274872565
 first_prior_star_anomaly_auc= 0.5298298948960087


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5800773056431108; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4196692486902339; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5302741320297908 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5831599341690858; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4190509837547509; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.5323540838174889 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5863043787113185; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41773817920609796; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.534470706123306 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5896160408161726; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.417470170105104; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.5369575958892139 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5926992979796011 at iter 490
0.423220735983585 at iter 10
0.5392150329846073 at iter 490
last anomaly aucs:
0.5926992979796011
0.41696390740924677
0.5392150329846073




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.00898885726929 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.593018017168508,first_prior_anomaly_auc= 0.41662779591746074, first_prior_star_anomaly_auc= 0.5394136824199022


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.593018017168508 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4175412061373456 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5390488631510746 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.593018017168508 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41757640983473965 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5386233803679876 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.593018017168508 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41759275440852966 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5384321698092253 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.593018017168508 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4177548380986148 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5383357787330274 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5930180171685079 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41778867974819306 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5382444167564571 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.593018017168508 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41794877275300873 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5382318440073878 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.593018017168508 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4182021136467552 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5381775716405719 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.593018017168508 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41831065838038684 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5381459302220808 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.593018017168508 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4184933823335274 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5380893528512689 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.593018017168508 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4185030214411472 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5380727987316611 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.593018017168508 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41873163592839063 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5380642073531304 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.593018017168508 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4187356172989293 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5380053249783225 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.593018017168508 at iter 0
max_prior_anomaly= 0.4207225307435147 at iter 5
max_prior_star_anomaly= 0.5462240262720165 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.593018017168508
accuracies_anomaly['prior'][-1]= 0.418968632248347
accuracies_anomaly['prior_star'][-1]= 0.5381021351461561



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.69567513465881 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.593018017168508
 first_prior_anomaly_auc= 0.4188961293953807
 first_prior_star_anomaly_auc= 0.5380560350662353


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5982642062634921; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.416716852890035; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 60 
last prior star auc 0.5430681614827126 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6013640175465286; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4175093551730366; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 60 
last prior star auc 0.5451743064976386 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6035703254623733; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4152999040699246; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 60 
last prior star auc 0.5460605805341155 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6067934544591979; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4191540802971192; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 340 
last prior star auc 0.5489385875689877 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6084305311609299 at iter 460
0.42030427729114256 at iter 450
0.5494126849818093 at iter 410
last anomaly aucs:
0.6082804963553696
0.4159861666232907
0.548636212953871




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.0318112373352 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.609475326608589,first_prior_anomaly_auc= 0.4211977806583343, first_prior_star_anomaly_auc= 0.550544965808409


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6094753266085889 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4210408308407858 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5509511703762562 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6094751170627711 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4201987709718693 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.549954884785423 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6094753266085889 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4199524498630198 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5497809617566309 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.609475326608589 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4198156164439823 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.549711602090932 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6094751170627711 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4197614488500754 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5496463285686806 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6094751170627711 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.419754848156814 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5496250596681718 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6094753266085889 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.419736093806119 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5496109153254687 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6094751170627711 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4197198540052378 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5495991807596707 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.609475326608589 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.41953838732700416 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5495636627435498 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.609475326608589 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4194380148802676 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5495391458828647 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6094753266085889 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4194979449841646 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5496101819151064 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6094753266085889 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4194533117249686 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5495617768311895 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6094755361544069 at iter 12
max_prior_anomaly= 0.4221658823366706 at iter 4
max_prior_star_anomaly= 0.5583469852433643 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6094753266085889
accuracies_anomaly['prior'][-1]= 0.41956898101640616
accuracies_anomaly['prior_star'][-1]= 0.5496288314928923



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.47530722618103 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6094751170627711
 first_prior_anomaly_auc= 0.4192619963932974
 first_prior_star_anomaly_auc= 0.549567015476635


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6136117610523893; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41405247781643195; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 40 
last prior star auc 0.5539772215314195 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6166128762552319; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.41583466499700555; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 40 
last prior star auc 0.5561621557738463 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6218360153102557; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.41644318605195985; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 40 
last prior star auc 0.5591010358687958 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6255977818317909; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.4149841185224673; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 40 
last prior star auc 0.5610760052017654 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6307507230378444 at iter 490
0.42050313627225533 at iter 40
0.5654717525951202 at iter 490
last anomaly aucs:
0.6307507230378444
0.4191996565124954
0.5654717525951202




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.96684575080872 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6304443670521891,first_prior_anomaly_auc= 0.41259236255785037, first_prior_star_anomaly_auc= 0.5630686811563408


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6304443670521891 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4233787335302226 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5663813909902842 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6304443670521891 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.41980912052362984 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5639238376388712 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6304443670521891 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.41999184447677035 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5636474467051644 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6304443670521891 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.42033277552236625 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5635875166012674 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6304443670521891 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.42027871270136824 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5635188903459308 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.630444471825098 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4203051154744138 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.563494059166519 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6304445765980069 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.42032900369764553 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5635062128239526 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6304443670521891 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.420468351666497 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5634999264494179 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6304443670521891 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.42084385777203337 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.56354686471261 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6304443670521891 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4211157434706571 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5636459798844398 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6304443670521891 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4206389219622038 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5634584363774893 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6304445765980069 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4205683050215979 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5635156423857546 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6304445765980069 at iter 4
max_prior_anomaly= 0.42797187308396545 at iter 4
max_prior_star_anomaly= 0.5743276827208099 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6304443670521891
accuracies_anomaly['prior'][-1]= 0.42122963162264315
accuracies_anomaly['prior_star'][-1]= 0.5636141289201307



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.3346037864685 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6304443670521891
 first_prior_anomaly_auc= 0.4207764887916038
 first_prior_star_anomaly_auc= 0.563555036999505


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6301730052181099; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4157355498251759; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.5640666431137167 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6323432712532894; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4221021804080528; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.5662078870531277 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.633362711656992; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4152715106116097; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.5653715896942013 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.634057146497253; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.4112751575470231; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.5638400193117425 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6351578906782706 at iter 460
0.4254094420507327 at iter 20
0.5666169204895157 at iter 290
last anomaly aucs:
0.6351237347099655
0.4165244898292746
0.5652055246335776




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.86921501159668 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6347784032021955,first_prior_anomaly_auc= 0.41528020676304944, first_prior_star_anomaly_auc= 0.5651622534221975


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6347788222938311 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4262357859833127 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.56904838538661 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6347786127480133 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4196438936462774 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.56540155474615 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6347787175209221 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4196171765545052 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5650662814376352 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6347786127480132 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41979424277056454 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5649248380106056 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6347786127480133 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4202181539600178 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5649474689589302 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6347788222938311 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4204375484312771 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5648764329266888 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6347787175209221 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4206435319701958 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5648500301536432 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6347786127480133 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4207388753173047 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5647983771095502 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6347786127480133 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4210808540919898 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5648381908149362 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.634778822293831 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.42144315881100347 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5648508683369146 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6347788222938311 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4214951261738233 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5648110546315284 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6347786127480133 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4216499805331935 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5647884236832036 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6347788222938311 at iter 9
max_prior_anomaly= 0.43268822557858744 at iter 5
max_prior_star_anomaly= 0.5764715459829438 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6347786127480133
accuracies_anomaly['prior'][-1]= 0.42186958455027074
accuracies_anomaly['prior_star'][-1]= 0.564811473723164



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 121.89375329017639 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6347785079751043
 first_prior_anomaly_auc= 0.4225346829760368
 first_prior_star_anomaly_auc= 0.5649893781224946


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6345416164280568; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42382213248073336; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 80 
last prior star auc 0.5673413203817255 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.633532967633972; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4230074183410425; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 110 
last prior star auc 0.5650023699631995 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6332763787800494; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4215850213296688; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 110 
last prior star auc 0.5639473067704673 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6304473006936386; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4223409578674606; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 110 
last prior star auc 0.5614683797456366 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6353269941532527 at iter 10
0.43122674827219 at iter 420
0.5701490247947185 at iter 10
last anomaly aucs:
0.6289146825820906
0.41906418514127375
0.5583101051794278




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.01978254318237 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6280670697490018,first_prior_anomaly_auc= 0.4166338727461776, first_prior_star_anomaly_auc= 0.5573746926486717


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6280670697490018 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4260054951295265 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5605801150238903 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6280670697490018 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41601676031269264 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.556472807448767 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6280670697490018 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4157227675302888 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5561479066582345 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6280670697490018 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41567142880492247 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5560256366735356 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6280670697490018 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4157500084866056 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5559581629201971 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6280672792948196 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41590528193761156 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5559321792387871 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6280670697490018 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4160766904165897 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5559329126491495 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6280670697490018 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.416146783492651 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5559187683064465 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6280670697490018 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41684415197436164 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5559623538365535 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6280670697490018 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4169863288117537 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5559820511434287 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6280670697490018 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4174452341527832 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5560597926418405 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6280670697490018 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4178693548880543 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5561490591602326 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6280672792948196 at iter 6
max_prior_anomaly= 0.43199861029213626 at iter 5
max_prior_star_anomaly= 0.568991912788707 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6280670697490018
accuracies_anomaly['prior'][-1]= 0.41779161338964244
accuracies_anomaly['prior_star'][-1]= 0.5561229707059138



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.30896997451782 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6280670697490018
 first_prior_anomaly_auc= 0.4179097972308939
 first_prior_star_anomaly_auc= 0.5560976156619573


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6264221350791015; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4137729436954578; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5568696872277215 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6236907053437956; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4189835100014123; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.5548427505319321 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6208666563570124; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4119105004666585; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.5506107631952049 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6172815369599008; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4111911296740766; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.5468542353191153 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6285620169706967 at iter 10
0.42315567200715143 at iter 10
0.560853153224512 at iter 10
last anomaly aucs:
0.6128617965704055
0.41879659513191536
0.5445596038410587




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.96254372596741 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6126832635336215,first_prior_anomaly_auc= 0.41620503723000546, first_prior_star_anomaly_auc= 0.5434371716678967


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6126830539878036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4243363579176678 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5473577739193408 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6126830539878035 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41392486441337856 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5432401985991443 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6126830539878036 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4128721062246423 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5428020382940791 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6126831587607126 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41277686765044236 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5426052747711445 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6126832635336215 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4132242479714917 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5426641571459525 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6126832635336215 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4133098474380718 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5426593375921425 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6126832635336215 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41307526089502045 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5425805483646415 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6126831587607124 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41310260662424625 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5425672422052099 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6126830539878036 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4134433281240243 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5426358684605465 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6126832635336215 iter_best_vanilla_star_anomaly= 990 
last prior auc 0.4137392068187885 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5427154958713187 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6126830539878036 iter_best_vanilla_star_anomaly= 990 
last prior auc 0.4137582754882103 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5427281733932969 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6126830539878036 iter_best_vanilla_star_anomaly= 990 
last prior auc 0.41326730963705405 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5425935402053466 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6126836826252571 at iter 99
max_prior_anomaly= 0.4299243162415191 at iter 7
max_prior_star_anomaly= 0.5556645892294287 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6126830539878036
accuracies_anomaly['prior'][-1]= 0.4135707319812599
accuracies_anomaly['prior_star'][-1]= 0.5426665669228573



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.10814023017883 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6126834730794393
 first_prior_anomaly_auc= 0.4137035840297589
 first_prior_star_anomaly_auc= 0.5427324690825623


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.607034327376784; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43087754016679003; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5416434594673429 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6020054372948809; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4332714963624941; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.5384317507175896 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5952014845902102; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4273679620370033; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.5311716167675211 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5883160185624068; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4324300651310311; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 390 
last prior star auc 0.52685727792439 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6126834730794393 at iter 0
0.436317978234895 at iter 390
0.5474204281188695 at iter 10
last anomaly aucs:
0.5825809590744446
0.42868170954183643
0.5217099944554177




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.00691676139832 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5818102495564963,first_prior_anomaly_auc= 0.4264571711398412, first_prior_star_anomaly_auc= 0.5204451758990458


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5818102495564963 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4320561306191283 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5235985261385357 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5818102495564963 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42834140713369395 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5213774452425346 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5818102495564963 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42828441067124645 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5212461647876693 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5818102495564963 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4288336302597572 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5214820086056277 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5818102495564963 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42833616848824846 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5212984464692159 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5818102495564963 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4286373906013672 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5213506233778534 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5818102495564963 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.427968834669607 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.521128923902598 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5818102495564963 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4289310690650443 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5214701692669207 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5818102495564963 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42828891590632967 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.521279377799794 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5818102495564963 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4286408481073612 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5214126489399287 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5818102495564963 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42839494609014744 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5212823114412436 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5818102495564963 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4288382402677493 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5215352332433544 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5818104591023141 at iter 1
max_prior_anomaly= 0.43357690939196936 at iter 7
max_prior_star_anomaly= 0.5269334478291682 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5818102495564963
accuracies_anomaly['prior'][-1]= 0.4289790550573255
accuracies_anomaly['prior_star'][-1]= 0.5216977360250751



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.34838438034058 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5818102495564963
 first_prior_anomaly_auc= 0.42835314169949207
 first_prior_star_anomaly_auc= 0.5213718922783623


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5764192643013973; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41918299761997857; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5154917223115586 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5712979645138349; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4163790650317064; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5106679775853029 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5670450225953255; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4246496289153112; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5096596431099449 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5608435141168922; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4189290280887787; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5034736410220304 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5818102495564963 at iter 0
0.42835314169949207 at iter 0
0.5213718922783623 at iter 0
last anomaly aucs:
0.556175671479096
0.42105403222730864
0.5003017459776633




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.06125235557556 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5563854268427355,first_prior_anomaly_auc= 0.4270237830312311, first_prior_star_anomaly_auc= 0.5017578798657063


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5563855316156443 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.431294850662982 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5038059806890957 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5563857411614622 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4307622899669882 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.502299974896411 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5563857411614621 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.42932229110691744 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5018590904957142 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5563852172969177 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4291434437514066 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5018626527746171 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5563855316156443 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4291422912494085 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5018622336829814 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5563856363885533 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4290911620698601 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5018574141291716 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5563852172969176 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.42908592342441454 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5018435841051954 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5563858459343711 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.429320405194557 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5019230019701498 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5563855316156443 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4301866676054319 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5024003473431476 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5563857411614621 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4296187984391351 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5022355395574308 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5563856363885533 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.43032098647465566 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5025072157102367 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5563856363885533 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.42956976471776487 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5022497886730427 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5563860554801889 at iter 35
max_prior_anomaly= 0.43201453577429066 at iter 8
max_prior_star_anomaly= 0.5051072602177684 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5563852172969177
accuracies_anomaly['prior'][-1]= 0.4296104166064223
accuracies_anomaly['prior_star'][-1]= 0.5021817910551596



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.45484328269958 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5563857411614621
 first_prior_anomaly_auc= 0.430056120560929
 first_prior_star_anomaly_auc= 0.5024327221720011


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5501059673200724; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4229311436633554; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.49556234344308087 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5447089052362566; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4226701543472585; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.49309839894422436 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5386020066945698; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4246368466204241; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.48855575993257655 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5307776706300162; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4238468588872363; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4827216900456936 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5563857411614621 at iter 0
0.4301875057887032 at iter 440
0.5024327221720011 at iter 0
last anomaly aucs:
0.5284188133587973
0.42664764828824114
0.48213831448887795




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.02190494537354 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5268030055575742,first_prior_anomaly_auc= 0.4279292305100387, first_prior_star_anomaly_auc= 0.48152539297174946


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5268024816930297 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.42846587734948016 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48108492766268823 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5268029007846653 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4313159100176731 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48101263435553965 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5268027960117564 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.43234823748917167 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48110462496956347 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5268027960117564 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4327255247341597 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48135283199077333 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5268026912388475 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4329769797155457 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.481410771409401 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5268026912388475 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.4333803554148525 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48151596340994746 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5268027960117564 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.43342561731150203 iter_best_prior_anomaly= 670
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48154865255752766 iter_best_prior_star_anomaly= 670
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5268031103304831 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.43377765428544246 iter_best_prior_anomaly= 780
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48168653370565434 iter_best_prior_star_anomaly= 780
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5268026912388474 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.43388137946526417 iter_best_prior_anomaly= 880
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48162555587266825 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5268029007846653 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.4341567226698819 iter_best_prior_anomaly= 920
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48195150439228995 iter_best_prior_star_anomaly= 920
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5268027960117564 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.434198946152173 iter_best_prior_anomaly= 1090
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4819076045434562 iter_best_prior_star_anomaly= 920
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5268029007846653 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.4343943476272917 iter_best_prior_anomaly= 1170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48190194680637505 iter_best_prior_star_anomaly= 1170
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5268035294221187 at iter 55
max_prior_anomaly= 0.4347323450314382 at iter 117
max_prior_star_anomaly= 0.4823436693903432 at iter 117
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5268024816930297
accuracies_anomaly['prior'][-1]= 0.434557374273557
accuracies_anomaly['prior_star'][-1]= 0.4821550781543037



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.74980115890503 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5268027960117564
 first_prior_anomaly_auc= 0.4346093416363769
 first_prior_star_anomaly_auc= 0.48201573018545224


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5260680236015646; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4401518285177609; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 100 
last prior star auc 0.48302595057317066 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5216090981441365; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4365849396067999; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 170 
last prior star auc 0.4777510537011449 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5178366447858923; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4374941589103282; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 260 
last prior star auc 0.47562164910044075 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.511239199484685; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.44290861329702325; count_not_improved_prior_anomaly= 31; iter_best_prior_anomaly= 340 
last prior star auc 0.4724017680637924 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5327911963934651 at iter 20
0.44793666519565506 at iter 340
0.4856968215671261 at iter 20
last anomaly aucs:
0.5067589003538391
0.4399464736162956
0.4691556937999164




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.05234384536743 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5072009372565339,first_prior_anomaly_auc= 0.43297257925337146, first_prior_star_anomaly_auc= 0.4664756027899768


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.507200832483625 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4375523078747737 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46436683845232807 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5072010420294428 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.43112669014418015 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4619739299857132 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5072004133919894 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4309096006769168 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461381753504549 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5072010420294428 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.43139951879898397 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46171765545051724 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.507200832483625 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4316847106570393 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46137756258819257 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.507200832483625 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.43168848248176006 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612635696632976 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.507200832483625 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.43189509465813236 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46133209114572526 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5072012515752607 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.43271777153890034 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46186999526007355 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.507200832483625 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4329263744005418 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461871881172434 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5072012515752607 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.43280033259112205 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46173232365776473 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5072006229378072 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.43281374352346264 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46177569964205384 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.507200832483625 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4332910888964605 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4621573873492161 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5072014611210786 at iter 11
max_prior_anomaly= 0.4385408402703476 at iter 12
max_prior_star_anomaly= 0.4664756027899768 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.507200832483625
accuracies_anomaly['prior'][-1]= 0.43277728255116166
accuracies_anomaly['prior_star'][-1]= 0.46167742265349543



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.35570359230042 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5072009372565339
 first_prior_anomaly_auc= 0.4334870142361238
 first_prior_star_anomaly_auc= 0.4621788657955428


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5004460182732335; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4256787084266336; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4531130755333046 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.49684633544178336; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4245422366836776; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4470207404259564 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.491183150169334; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42452830188679247; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4416589868124435 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.48462143243006506; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4281866575472327; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43486414935084805 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5104811674887149 at iter 10
0.4334870142361238 at iter 0
0.4622105072140339 at iter 10
last anomaly aucs:
0.47458334957313425
0.4257612694788554
0.4247981969001468




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.02255487442017 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.47413471197717794,first_prior_anomaly_auc= 0.4205018789973484, first_prior_star_anomaly_auc= 0.4226149390242625


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4741351310688136 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4256497911037742 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42086565053708686 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4741349215229958 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.42744224602942105 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.421446092452453 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4741353406146314 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.428337844854791 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42204015484597757 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.47413492152299574 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.428918496315975 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42254096935057145 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.47413513106881355 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.42944026540235103 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42281715073846043 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.47413492152299574 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4303421506022556 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.423274903577492 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.47413492152299574 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4310602641199306 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42372217912563237 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.47413513106881355 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.43097717920316436 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4235484656426582 iter_best_prior_star_anomaly= 720
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4741347119771779 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4314382847752809 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4240061137087807 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.47413513106881355 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4311277378732692 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42345427479754727 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.47413471197717794 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4320851527148966 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4243405488340242 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.47413534061463136 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4324686215615103 iter_best_prior_anomaly= 1170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42462364523390134 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4741357597062671 at iter 32
max_prior_anomaly= 0.4326114270363558 at iter 126
max_prior_star_anomaly= 0.4247655077525666 at iter 126
last values
accuracies_anomaly['vanilla_star'][-1]= 0.47413471197717794
accuracies_anomaly['prior'][-1]= 0.43224734117789054
accuracies_anomaly['prior_star'][-1]= 0.42420203904844406



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.60209465026855 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.47413555016044917
 first_prior_anomaly_auc= 0.43214592100206484
 first_prior_star_anomaly_auc= 0.4240825979322857


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4793542887532988; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4202286312509089; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.42241545140569625 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4786506338970535; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4245754496958024; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.42305907138513554 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46408321818790643; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42003102954470306; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4178460953022761 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43590265842397236; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4177195296283118; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4084121330381252 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4868465994695138 at iter 20
0.43214592100206484 at iter 0
0.42679474945235196 at iter 20
last anomaly aucs:
0.42765493503451013
0.4168436281098171
0.397756099564438




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.0439338684082 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.425398545668206,first_prior_anomaly_auc= 0.42027054041447326, first_prior_star_anomaly_auc= 0.398612932413511


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.425398545668206 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4298467842889251 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39957139498422745 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42539812657657033 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4367601199104988 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4060137763802469 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4253979170307526 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4390139947269891 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4078601893539828 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4253983361223882 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4397495005475432 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4087549499960814 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4253972883932991 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.44013716031051336 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40905271460320614 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.42539791703075247 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.44066312031324584 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40986805738035037 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4253977074849347 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.44125613497768124 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4108778586764332 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.425398545668206 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.44130454006159814 iter_best_prior_anomaly= 770
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40951298199205155 iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.42539770748493466 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4414458787157188 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40944477482835057 iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.42539917430565943 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4422254939309245 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4108531322699302 iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4253979170307525 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.44195538937175227 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40977480949141976 iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4253970788474813 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.44268502790940745 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41123911566635785 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4253991743056595 at iter 4
max_prior_anomaly= 0.44268502790940745 at iter 120
max_prior_star_anomaly= 0.4112417349890806 at iter 122
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4253981265765704
accuracies_anomaly['prior'][-1]= 0.44254169857001746
accuracies_anomaly['prior_star'][-1]= 0.4101832142903542



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.98144507408142 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.42539749793911685
 first_prior_anomaly_auc= 0.44307457358473806
 first_prior_star_anomaly_auc= 0.41114021004034595


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4200280959032535; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4158830700809224; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.3794702933180448 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4245125859504558; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4160200082728689; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.37905664987366483 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43203800490588673; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4184958968833412; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.38371191976239183 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43639006199622565; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4216715637524292; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.3878466778396497 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43743443835224904 at iter 490
0.44307457358473806 at iter 0
0.41114021004034595 at iter 0
last anomaly aucs:
0.43743443835224904
0.4219211328214548
0.389464581099051




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.06819272041321 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4379224705619558,first_prior_anomaly_auc= 0.4196180147377765, first_prior_star_anomaly_auc= 0.3897097497059024


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43792163237868453 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4207890615406731 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38486693631022506 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4379216323786845 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4233915158251097 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38627634148089385 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43792226101613796 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4252543781455447 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3869039312052698 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43792184192450234 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4265119673712016 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38803883135459216 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4379212132870488 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4274598478781181 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38885752686482156 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43792205147032015 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.42773801995127636 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38839422106161775 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43792247056195577 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4281571115869198 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3885817645685682 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43792184192450234 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.42876772810005226 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38951529118696393 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43792163237868453 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4286488108484385 iter_best_prior_anomaly= 880
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3884380161375425 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43792226101613796 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4291397766995947 iter_best_prior_anomaly= 920
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3888565839086413 iter_best_prior_star_anomaly= 920
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43792205147032015 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4290580538306442 iter_best_prior_anomaly= 1020
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38890048375747505 iter_best_prior_star_anomaly= 1020
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43792205147032015 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4303471797018834 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3907794811058823 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4379227848806825 at iter 47
max_prior_anomaly= 0.4310848857535246 at iter 125
max_prior_star_anomaly= 0.39209375247526 at iter 125
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4379216323786845
accuracies_anomaly['prior'][-1]= 0.4294092526213134
accuracies_anomaly['prior_star'][-1]= 0.38861665394723555



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.91725373268127 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4650021813719636
accuracies_anomaly["prior"][-1]= 0.4122168564523139
accuracies_anomaly["prior_star"][-1]= 0.46158124112311527


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 2879.3654396533966 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0036046504974365234 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.47110907991365036
 first_prior_anomaly_auc= 0.41239329403091973
 first_prior_star_anomaly_auc= 0.46796840719613864


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4947748702597069; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41227133836494745; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.48136938611038116 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5394191306111655; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4122149705399535; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5207264911594716 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5447578341847179; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41219233959162876; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5223384223630649 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5457393467953948; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4121876248107278; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5193721965388898 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5462660402084897 at iter 360
0.41239329403091973 at iter 0
0.5224215072798313 at iter 280
last anomaly aucs:
0.5433059959859403
0.41217809047601683
0.5169738398810115




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.09216499328613 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5432418749656869,first_prior_anomaly_auc= 0.41217662365529206, first_prior_star_anomaly_auc= 0.5169265872990927


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5432416654198691 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4122191614563099 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5168277864459898 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5432416654198691 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41229868409417325 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.516743968118861 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.54324156064696 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41236699603078314 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5166412906681285 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5432416654198691 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41244463275628607 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5165517098310096 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5432416654198691 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4125274033543257 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5164679962767899 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5432416654198691 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41262431829506807 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5163929788740097 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5432416654198691 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41271955686926814 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5162959591603583 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5432416654198691 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4128246440969057 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5162003014945227 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5432416654198691 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4129436661214284 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5160996147290593 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5432417701927779 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4130638406479492 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5160080432066712 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5432416654198691 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4132151327284164 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5158986602897684 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5432416654198691 iter_best_vanilla_star_anomaly= 1130 
last prior auc 0.41337396845832536 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5158012214844813 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5432419797385958 at iter 113
max_prior_anomaly= 0.4135333280527787 at iter 129
max_prior_star_anomaly= 0.5169265872990927 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5432416654198691
accuracies_anomaly['prior'][-1]= 0.4135333280527787
accuracies_anomaly['prior_star'][-1]= 0.5157207558904378



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.41638684272766 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5432416654198691
 first_prior_anomaly_auc= 0.4135554351365589
 first_prior_star_anomaly_auc= 0.5157146790617209


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5449624556758208; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41353888101695097; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5173385543769302 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5492960727341916; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41353730942331735; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5218026137068948 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5558971850872109; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4135373094233173; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5271065326746889 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5614091830521019; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4135340614631411; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5310722920498736 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5644263285100077 at iter 490
0.4135554351365589 at iter 0
0.5333563414641301 at iter 490
last anomaly aucs:
0.5644263285100077
0.41353741419622625
0.5333563414641301




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.06922340393066 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5646656298339601,first_prior_anomaly_auc= 0.41353919533567773, first_prior_star_anomaly_auc= 0.5335392749630885


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5646656298339601 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4137238052011787 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.533414176109849 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5646656298339601 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4139112439352202 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5333015452327698 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.564665734606869 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4141239329403092 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5331958293676787 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5646656298339601 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4143852365751329 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5330710448331659 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5646658393797779 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41464172065614663 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5329351543703086 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.564665734606869 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41494472390871684 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5327811381942096 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5646656298339601 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41528240699413643 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5326524770620671 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5646656298339601 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41566891425510866 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5325242350215601 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.564665734606869 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41606956585878374 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5323796484072632 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5646658393797779 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41649431523150826 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5322606263827404 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.564665734606869 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41696359309052 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5321256788760633 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.564665734606869 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41747980921272376 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.53198842636539 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5646658393797779 at iter 2
max_prior_anomaly= 0.4179558973108147 at iter 129
max_prior_star_anomaly= 0.5335392749630885 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5646656298339601
accuracies_anomaly['prior'][-1]= 0.4179558973108147
accuracies_anomaly['prior_star'][-1]= 0.5318805102692119



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.51278138160706 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5646656298339601
 first_prior_anomaly_auc= 0.418000111478375
 first_prior_star_anomaly_auc= 0.5318655277432376


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5670588526193018; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41802012310397707; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 80 
last prior star auc 0.533780671745219 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5692523782402593; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4180297622115969; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 190 
last prior star auc 0.5356684700179749 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5716622599181178; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41802169469761075; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 190 
last prior star auc 0.5377576418216572 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.574362991191113; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.41802399970160675; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 190 
last prior star auc 0.5401087458976168 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5770087166869298 at iter 490
0.41802997175741463 at iter 190
0.5423393611283288 at iter 490
last anomaly aucs:
0.5770087166869298
0.41801257945453546
0.5423393611283288




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.17235064506531 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5772671914532128,first_prior_anomaly_auc= 0.41801226513580875, first_prior_star_anomaly_auc= 0.5425459733047009


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5772670866803039 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4186636383105075 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5423917475827842 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5772672962261217 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41925728161239634 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5422421318688595 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5772670866803039 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4198585733366358 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5420847629596754 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5772670866803039 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.42048867761082565 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.541943005213919 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5772672962261217 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.42115503331149867 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5417899319940003 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5772672962261217 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.42177927030278956 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5416097225906736 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5772672962261217 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.4223276517080289 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.54142825591244 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5772670866803039 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.4229154277270188 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.54122143419025 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5772671914532128 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.4234690477777037 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5410395484203807 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5772671914532128 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.4239830636688203 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.540864158570864 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5772671914532128 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.42437721935214295 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5406780818846383 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5772671914532128 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.4246825276087093 iter_best_prior_anomaly= 1190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5404867665529671 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5772674009990306 at iter 43
max_prior_anomaly= 0.4247187790351924 at iter 125
max_prior_star_anomaly= 0.5425459733047009 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5772671914532128
accuracies_anomaly['prior'][-1]= 0.42471071152120626
accuracies_anomaly['prior_star'][-1]= 0.5403300262812365



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.0878496170044 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5772671914532128
 first_prior_anomaly_auc= 0.42470400605503594
 first_prior_star_anomaly_auc= 0.5403147294365355


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5802468282097285; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4246597918874755; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5428123060391523 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5834237523537235; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4245902226759588; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5453150165143059 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5868487787460192; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.42449435546430536; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5480031750382317 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5903684150750614; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4244021553044638; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5507666652836642 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5934191926367276 at iter 490
0.42470400605503594 at iter 0
0.5531913199416791 at iter 490
last anomaly aucs:
0.5934191926367276
0.4242755896304995
0.5531913199416791




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.16013741493225 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5937308920407374,first_prior_anomaly_auc= 0.42426207392525006, first_prior_star_anomaly_auc= 0.5534195153372871


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5937306824949196 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42406960609158073 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5532141604358218 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5937302634032839 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42373538051215515 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5529991664267367 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5937306824949196 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4232756369878543 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5527726473976715 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5937306824949196 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4227336467300584 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5525666638587527 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5937302634032839 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.422195952161528 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5523319725427924 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5937304729491018 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4215488746760946 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.552096338270652 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5937306824949196 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4209667563941858 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5518716003810381 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5937305777220107 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42029778137079 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5516232885869194 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5937304729491018 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4196800402998517 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5514066182112918 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5937304729491018 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41905915604164595 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5511786323615018 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5937306824949196 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41839531489078685 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5509731726871275 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5937305777220107 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4177446751264504 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5507526257138702 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5937308920407374 at iter 0
max_prior_anomaly= 0.42426207392525006 at iter 0
max_prior_star_anomaly= 0.5534195153372871 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5937306824949196
accuracies_anomaly['prior'][-1]= 0.4171675859441695
accuracies_anomaly['prior_star'][-1]= 0.5505719972189079



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.30318856239319 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5937306824949196
 first_prior_anomaly_auc= 0.4171200190435239
 first_prior_star_anomaly_auc= 0.5505543953702109


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5971770825606331; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4165962592718786; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5531320184752356 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6005191288090714; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4160534308308115; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5556300141694882 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6035499995180447; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.415438099536778; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5578569623483884 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6059084376976279; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4148360744021763; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5595105931697284 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6076327902324826 at iter 490
0.4171200190435239 at iter 0
0.5605884968566032 at iter 490
last anomaly aucs:
0.6076327902324826
0.41428654049493885
0.5605884968566032




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.3727719783783 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6077845014045856,first_prior_anomaly_auc= 0.4142397070046557, first_prior_star_anomaly_auc= 0.5606776586020863


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6077847109504034 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.413739835456242 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5604881244098666 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6077845014045856 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41311790346894717 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5602624435640726 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6077845014045856 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41259047664549 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.560042210909542 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6077847109504034 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4121395340455376 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5598360178248054 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6077847109504034 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41181117574901105 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.559621547680265 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6077847109504035 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4115382423212983 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5594349471294947 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6077847109504035 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4113981609420845 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5592543186345325 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6077847109504035 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41134284084617956 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5590824910639186 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6077847109504035 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4113955416193617 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5588882420907979 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6077845014045856 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41152179297459923 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5587252154445326 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6077845014045856 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4118032130079339 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5585722469975227 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6077847109504034 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.412188462993999 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5584029339767228 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6077847109504035 at iter 1
max_prior_anomaly= 0.4142397070046557 at iter 0
max_prior_star_anomaly= 0.5606776586020863 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6077847109504035
accuracies_anomaly['prior'][-1]= 0.4125573684062741
accuracies_anomaly['prior_star'][-1]= 0.5582493368922594



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.16697645187378 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6077845014045857
 first_prior_anomaly_auc= 0.41259613438257114
 first_prior_star_anomaly_auc= 0.5582342495933763


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6091777715472821; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41183034919134176; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.559011455031677 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6101414727634442; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4110888713149797; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5593951334241085 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6107581661052934; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41030412222723733; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5593090100929838 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6108074093724815; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4096743322717742; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5587550757235722 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6108690158429212 at iter 370
0.41259613438257114 at iter 0
0.5594154593684373 at iter 250
last anomaly aucs:
0.6102965366686323
0.4091377902052417
0.5577466364753052




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.22678923606873 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6101915542139036,first_prior_anomaly_auc= 0.4090937855834992, first_prior_star_anomaly_auc= 0.5576309671838676


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6101917637597214 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4108116421980015 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5575371954303925 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6101917637597214 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4119209777575496 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5574136681707865 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6101917637597214 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4130372283290858 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5572768347517489 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6101914494409946 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41412854294830126 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5571321433645431 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6101915542139036 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4152885885957622 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5570027488220383 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6101914494409946 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4163954096054965 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5568707349568105 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6101915542139036 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41753429112535745 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5567475220159313 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6101917637597214 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4185864206766402 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.556628080899773 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6101917637597214 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41951827092849325 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5565065443254363 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6101915542139035 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4204060117856949 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5563944373129018 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6101915542139036 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4212655687303996 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5562890357665374 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6101917637597214 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4220657194357518 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5561899205947077 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6101917637597214 at iter 9
max_prior_anomaly= 0.42279588183795147 at iter 129
max_prior_star_anomaly= 0.5576655422438083 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6101915542139035
accuracies_anomaly['prior'][-1]= 0.42279588183795147
accuracies_anomaly['prior_star'][-1]= 0.5560918531519672



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.91464757919312 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6101915542139036
 first_prior_anomaly_auc= 0.42287142310527626
 first_prior_star_anomaly_auc= 0.5560828426818009


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.608731438955322; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42290285497794944; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 40 
last prior star auc 0.5542639849831085 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6063214525045545; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42258853625121695; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 40 
last prior star auc 0.5517477588027055 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6027981491237003; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4221269068145557; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 40 
last prior star auc 0.5484526508174592 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5985615517789812; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42170393858128263; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 40 
last prior star auc 0.5447320600491259 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6101915542139036 at iter 0
0.42296844281892765 at iter 40
0.5560828426818009 at iter 0
last anomaly aucs:
0.5944563396620361
0.42151262324961136
0.5411070221737193




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.13203692436218 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5940173411736996,first_prior_anomaly_auc= 0.42151063256434207, first_prior_star_anomaly_auc= 0.5407217721876542


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5940172364007907 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4236846704242423 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5407193624107492 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5940173411736996 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.42502785911647945 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5406313531672641 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5940175507195175 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4262737137763383 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5405686989677354 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5940174459466085 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4272561693431954 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5405320284496166 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5940176554924264 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.42802132589697134 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.540479851540979 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5940173411736996 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.42854078997935136 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5404467433017632 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5940171316278818 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.4289484613679235 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5403851368313236 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5940171316278818 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.4292797533058996 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5403224826317949 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5940173411736996 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.42936116185612333 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5402242056432365 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5940173411736996 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.42949181367353517 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5401584082564406 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5940171316278818 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.42951716871749157 iter_best_prior_anomaly= 1060
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.540104974072896 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5940172364007907 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.42947400227902033 iter_best_prior_anomaly= 1060
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5400377098653752 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5940177602653354 at iter 44
max_prior_anomaly= 0.429578984733749 at iter 106
max_prior_star_anomaly= 0.5408635299334106 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5940175507195175
accuracies_anomaly['prior'][-1]= 0.4294537811076006
accuracies_anomaly['prior_star'][-1]= 0.5399952768372662



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.12557911872864 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5940177602653354
 first_prior_anomaly_auc= 0.4294048521591391
 first_prior_star_anomaly_auc= 0.5399607017773257


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5891709654991193; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4302627327373012; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 40 
last prior star auc 0.5357374105920383 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5849025171900912; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43011531725446367; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 40 
last prior star auc 0.5318997884844515 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5807340222361641; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4300199739073547; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 40 
last prior star auc 0.528227707572944 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5765313713139318; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4301250611349924; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 40 
last prior star auc 0.5246032983349909 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5940177602653354 at iter 0
0.43040543343923776 at iter 40
0.5399607017773257 at iter 0
last anomaly aucs:
0.5726853673736323
0.4302977268888774
0.5213881320792435




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.14709496498108 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5722499311641989,first_prior_anomaly_auc= 0.4303213007933824, first_prior_star_anomaly_auc= 0.5210782138146852


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5722503502558345 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4303418362835289 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5211205420698852 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5722501407100167 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4303647815505804 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5209124630727883 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5722505598016523 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4303704392876616 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.52082571110421 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5722502454829256 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4305076917983348 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5207907169526338 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5722504550287434 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.43078932137748716 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5207949078689902 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5722503502558345 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4310301942950732 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5207758391995685 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5722503502558345 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4313553046314236 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5208215201878537 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5722500359371078 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.43158056638558195 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.52083053065802 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5722501407100167 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4318206011198967 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5208353502118298 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5722502454829256 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4319831039016174 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5208475038692635 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5722501407100167 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.43208745771889256 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5208475038692635 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5722501407100167 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.43220543201432626 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5208382838532793 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5722505598016523 at iter 30
max_prior_anomaly= 0.4322576089229639 at iter 129
max_prior_star_anomaly= 0.5212353731780515 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5722501407100167
accuracies_anomaly['prior'][-1]= 0.4322576089229639
accuracies_anomaly['prior_star'][-1]= 0.520817643590224



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.10123467445374 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5722505598016523
 first_prior_anomaly_auc= 0.4322733248593005
 first_prior_star_anomaly_auc= 0.5208179579089507


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.567598014008557; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42929337378405796; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5162442013433564 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5630623947818063; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4291058302771076; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5125611192764131 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5586246334519782; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42895893865881457; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5087164773839294 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5541906439468709; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4293099279036659; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5051028597555941 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5722505598016523 at iter 0
0.4322733248593005 at iter 0
0.5208179579089507 at iter 0
last anomaly aucs:
0.5502256179820487
0.4297860160017568
0.5019370415399438




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.2035322189331 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5498176322747498,first_prior_anomaly_auc= 0.43006921717454283, first_prior_star_anomaly_auc= 0.5017461452999084


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5498177370476587 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4297564700414439 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5021281473257972 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5498177370476587 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4290201260376185 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.501815714511425 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5498177370476587 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.42873870600428393 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5015885668449063 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5498178418205676 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.4286209412546681 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5014592770753104 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5498178418205676 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.4285750507205652 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5013762969314529 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5498178418205676 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.42843863639316326 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5012436544287718 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5498175275018409 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4293747823342817 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5015570301993242 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5498177370476587 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.429480288653555 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5015671931714885 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5498176322747498 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4296215225347668 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5015904527572668 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5498175275018409 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.42897853119278084 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5013230722937262 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5498177370476587 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.42909430525712733 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5013658196405618 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5498176322747498 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4292102888672917 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5013877171785242 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5498180513663855 at iter 69
max_prior_anomaly= 0.43006921717454283 at iter 0
max_prior_star_anomaly= 0.5022860400995259 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5498178418205676
accuracies_anomaly['prior'][-1]= 0.42923532959252136
accuracies_anomaly['prior_star'][-1]= 0.5013846787641658



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.92147946357727 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5498178418205676
 first_prior_anomaly_auc= 0.42930385107494906
 first_prior_star_anomaly_auc= 0.5014089860790332


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5452319315975396; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4245736685563508; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4964574184039063 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5407703868173888; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4245913751779568; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.49303406837815306 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5365613447477131; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4251627018502476; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.48972764491874443 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5326449334126255; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4246410375367805; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.48606017401522894 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5498178418205676 at iter 0
0.42930385107494906 at iter 0
0.5014089860790332 at iter 0
last anomaly aucs:
0.5294437019537633
0.4245578478471053
0.48301379691573704




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.12622714042664 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5291228873066783,first_prior_anomaly_auc= 0.4248775099921923, first_prior_star_anomaly_auc= 0.4829850891386954


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5291226777608604 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4269223628554054 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4839571721875704 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5291228873066783 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.42590533222860777 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48364411073574476 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5291228873066783 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.42548823127823365 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48342911672665967 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5291226777608604 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4252105830696199 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48322103772956265 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5291226777608604 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.42500135157052493 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48307875611926177 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5291226777608604 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4247648791151132 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4829296642698816 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5291226777608605 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4245704205961746 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48279115448430143 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5291228873066782 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.425242224488111 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48302155011099646 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5291226777608604 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4244859736315924 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48267118950359855 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5291227825337694 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.42444699810947767 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4826261371527669 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5291226777608604 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.42439398301756875 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48256620704886993 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5291226777608604 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4243338433678539 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4825257647060303 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.529123306398314 at iter 69
max_prior_anomaly= 0.4275717453448349 at iter 4
max_prior_star_anomaly= 0.4840567064510356 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5291226777608604
accuracies_anomaly['prior'][-1]= 0.4242656362041529
accuracies_anomaly['prior_star'][-1]= 0.48249831420389566



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.53585195541382 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5291226777608604
 first_prior_anomaly_auc= 0.424250234586543
 first_prior_star_anomaly_auc= 0.48249370419590354


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5263587684237921; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.423990607318262; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.47927015610744333 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5233888755478051; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4239459740590659; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.47585717859967236 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5204300886001627; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4237939485682363; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.47207948659598276 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5175016857961044; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4238700137001056; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.4683133196122732 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5291226777608604 at iter 0
0.42482795240627746 at iter 10
0.48249370419590354 at iter 0
last anomaly aucs:
0.5151686026604775
0.42348308734749773
0.4639221822269104




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.13660836219788 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5149758205080815,first_prior_anomaly_auc= 0.4234026217534542, first_prior_star_anomaly_auc= 0.46315702567313455


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5149761348268083 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4255012231189386 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46411339278567276 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5149756109622637 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4243319574554935 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4637422871423106 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5149759252809905 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4237786517235353 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4634657914356948 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5149756109622637 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.42342975793686216 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46316100704367313 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5149756109622637 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4231739024933019 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46289530294667525 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5149762395997172 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.42303465929735934 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46271425536007726 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5149758205080815 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.42271541624390796 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46248144995647733 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5149756109622637 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4223892581784685 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46224529181979224 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5149760300538994 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.422154776408326 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46211788796255665 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5149758205080815 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4219054168851182 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46196890088608544 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5149758205080815 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.42191149371383496 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46194375538794685 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5149756109622637 iter_best_vanilla_star_anomaly= 1140 
last prior auc 0.42185135406412017 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4618555365986439 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.514976449145535 at iter 114
max_prior_anomaly= 0.42672413251174607 at iter 4
max_prior_star_anomaly= 0.4643262913365796 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5149756109622637
accuracies_anomaly['prior'][-1]= 0.4217440666053955
accuracies_anomaly['prior_star'][-1]= 0.4617868055703984



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.24967765808105 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5149762395997172
 first_prior_anomaly_auc= 0.4217270933941519
 first_prior_star_anomaly_auc= 0.46177727123568746


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5114351248243482; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41522530575878003; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.45407321447056365 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.506452125276548; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41603823875901935; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.44801314941916 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5005775082739166; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4160217894123204; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4411352270407981 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4933626362204975; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41587217369839563; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4315168644569641 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5149762395997172 at iter 0
0.4217270933941519 at iter 0
0.46177727123568746 at iter 0
last anomaly aucs:
0.485598230259841
0.41599088140419166
0.42117871198891255




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.12827134132385 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.48460445921882156,first_prior_anomaly_auc= 0.41537722647670083, first_prior_star_anomaly_auc= 0.4198047200614556


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.48460466876463937 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4209921114381423 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42180347284474795 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.48460424967300375 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4204593411963306 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4216124718318034 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.48460414490009485 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4202483285577841 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4213698177747659 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.48460445921882156 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.41989964431692883 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4210540322273086 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.48460445921882156 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4196230438374042 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42076066808235824 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.48460445921882156 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4193342897004459 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4204819721446553 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.48460456399173046 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4190256287107945 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42026551131484546 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4846040401271859 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4187542668767154 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42011484787183173 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.48460435444591266 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4185044882618719 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4198690506275269 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.48460445921882156 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.41838462805407783 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4197579913440813 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4846038305813681 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4181724629135335 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41953461550228344 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.48460404012718594 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4181834640689691 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41966432436351503 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4846048783104573 at iter 35
max_prior_anomaly= 0.4211796549450927 at iter 4
max_prior_star_anomaly= 0.42495347035115266 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.48460424967300375
accuracies_anomaly['prior'][-1]= 0.41803678199649386
accuracies_anomaly['prior_star'][-1]= 0.4195363966417349



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.04305696487427 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.48460445921882156
 first_prior_anomaly_auc= 0.41801897060197907
 first_prior_star_anomaly_auc= 0.4195239286655744


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4718278220687788; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4175468638744267; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.4087149267448776 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46046079963522263; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4178234643539514; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.40346161309208745 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4455455378684916; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41786285896770187; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.40219344180263045 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3917461159634938; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.417953173215183; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.3993553532460533 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.48460445921882156 at iter 0
0.4184725325246541 at iter 480
0.4195239286655744 at iter 0
last anomaly aucs:
0.39835498151177245
0.41778532701510784
0.37825723257867505




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 68.11527013778687 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.3992009179783187,first_prior_anomaly_auc= 0.4183431379821492, first_prior_star_anomaly_auc= 0.3780388858365048


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3992015466157722 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4223548926643457 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3783805502924631 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3992015466157722 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42116048150276203 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3782582803077641 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3992009179783187 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42038851470990685 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3779715168560751 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3991998702492296 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4198267223723269 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3776654751891465 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.39919987024922965 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41929667622614686 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3772597944858437 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.3992007084325009 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4188544297776341 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37699555720957056 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.3992015466157722 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4184623695524897 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37670303124789145 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.39920154661577223 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.41812646760652156 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3766856389450122 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.399200603659592 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.41789963425872956 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3765169545616658 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.39920091797831875 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.41760427942850986 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37629441690313914 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.3992004988866831 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.417333860550611 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37607565106933327 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.39920112752413656 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.4170963403661101 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3758732298093175 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.39920154661577223 at iter 80
max_prior_anomaly= 0.4225321684262229 at iter 9
max_prior_star_anomaly= 0.3784851136555561 at iter 9
last values
accuracies_anomaly['vanilla_star'][-1]= 0.39920112752413656
accuracies_anomaly['prior'][-1]= 0.4168920331937339
accuracies_anomaly['prior_star'][-1]= 0.37564796805515915



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 121.90592050552368 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.39920102275122765
 first_prior_anomaly_auc= 0.4168725454326765
 first_prior_star_anomaly_auc= 0.3756833812983711


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4110928526855182; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41586431573022736; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 30 
last prior star auc 0.3767581417979785 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4232970106612721; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41674472248380523; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 30 
last prior star auc 0.38183889446979247 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4297419066071053; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4165309857496271; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 280 
last prior star auc 0.38408512086393226 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4331395872701754; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.41606055538861736; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 360 
last prior star auc 0.3841626528165263 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43496965567012125 at iter 490
0.41777484972421675 at iter 360
0.38546204643283866 at iter 380
last anomaly aucs:
0.43496965567012125
0.41641217327092217
0.38444072011677566




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.09940338134766 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43511979524859046,first_prior_anomaly_auc= 0.41625773800318755, first_prior_star_anomaly_auc= 0.38450746045975187


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4351195857027727 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4184505302137828 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38482691305902106 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4351193761569549 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41798292872131365 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3847413135924409 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4351194809298638 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4176365494844544 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3847047478472311 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4351197952485905 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4174693319218327 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38467247779128644 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43511979524859046 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4173387848773298 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3846232345240984 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4351200047944084 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4172565381438348 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38457336261945685 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43511958570277265 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.417256223825108 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3845920121972429 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43511937615695484 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.417135211115316 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38449792612504097 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4351195857027727 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4170307525251319 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.384426261455346 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43511979524859046 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4169186455125973 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38434370040312427 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43511916661113703 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.41687380270758345 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3843286131042411 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43511958570277265 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4168338842292884 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3843193930882569 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4351202143402262 at iter 26
max_prior_anomaly= 0.4184826954968185 at iter 11
max_prior_star_anomaly= 0.3865967370363431 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4351197952485905
accuracies_anomaly['prior'][-1]= 0.4167202056231201
accuracies_anomaly['prior_star'][-1]= 0.3842703593668867



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.72063708305359 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43511958570277265
 first_prior_anomaly_auc= 0.41672827313710625
 first_prior_star_anomaly_auc= 0.384264072992352


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4362329026328594; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.40974505398528904; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.38404321170036787 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.437255905315465; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41000677671174834; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.3858595548492464 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4381787450971517; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4114218396194983; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.3890213916943581 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4387808750046624; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.41182772986861904; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.3902439867684389 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43921767326191175 at iter 490
0.41672827313710625 at iter 0
0.3920139155186699 at iter 490
last anomaly aucs:
0.43921767326191175
0.4120858903161753
0.3920139155186699




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.13000750541687 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4392790701865335,first_prior_anomaly_auc= 0.4120194642919258, first_prior_star_anomaly_auc= 0.3921045440848778


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4392799083698048 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.41705987939380906 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3929233443680161 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.439279698823987 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.41727298749053376 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39297457832047344 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4392801179156226 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4171212763184308 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39298264583445963 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43927927973235137 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41706469894761905 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3929491185036082 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4392794892781691 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41694546737727844 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39290720934004386 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.439279698823987 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.416834303320924 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39288394975426566 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.439279698823987 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4167014512724251 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3928742058737369 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4392794892781691 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4166179472640231 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39286571926811514 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4392799083698048 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4165406248572469 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39284371695724385 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4392801179156226 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4165162127694707 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3928273723834538 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4392793845052603 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4164988204665915 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39281668554674487 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4392794892781692 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.416487609765338 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39280578916421804 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4392801179156226 at iter 30
max_prior_anomaly= 0.4173110200564684 at iter 16
max_prior_star_anomaly= 0.3931073255960636 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.439279698823987
accuracies_anomaly['prior'][-1]= 0.41652428028345684
accuracies_anomaly['prior_star'][-1]= 0.3928147996343844



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.55725264549255 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.47110907991365036
accuracies_anomaly["prior"][-1]= 0.41239329403091973
accuracies_anomaly["prior_star"][-1]= 0.46796840719613864


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 2850.174191236496 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003437519073486328 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.47259748385763795
 first_prior_anomaly_auc= 0.4123300111939376
 first_prior_star_anomaly_auc= 0.46935958188065696


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5046294957531349; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4121114549059496; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.49150050731042494 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5445950170842706; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4120186261086546; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5255520170251786 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5471268544281012; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4119834224112605; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5237901557889337 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5438934576862036; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 320 
last prior auc 0.41195240963022284; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.518055620165516 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5472728030902141 at iter 320
0.4123300111939376 at iter 0
0.5256265105634143 at iter 210
last anomaly aucs:
0.5414481627651331
0.41193753187715754
0.5154977991402754




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.11954188346863 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5414033199601193,first_prior_anomaly_auc= 0.41193753187715754, first_prior_star_anomaly_auc= 0.5154753777377685


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5414033199601193 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.411955762363308 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5153911403190041 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5414033199601191 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41196854465819516 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5153083697209646 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5414033199601191 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.411999243120506 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5152177411547567 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5414033199601191 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4120273222600941 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5151199880307429 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5414033199601193 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4120764607543733 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.515029464237444 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5414033199601193 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4121125026350386 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5149377879421468 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5414033199601193 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.412152106794607 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5148486261966638 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5414033199601191 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.41219726391834755 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.514756740355549 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5414033199601193 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.41225310787879704 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5146539581319074 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5414033199601191 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.41229857932126435 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5145571479640738 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5414033199601191 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.41235829987934347 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5144515368718916 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5414033199601193 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.41243866070047813 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5143432016840779 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5414034247330282 at iter 34
max_prior_anomaly= 0.41248130327440485 at iter 129
max_prior_star_anomaly= 0.5154753777377685 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5414033199601191
accuracies_anomaly['prior'][-1]= 0.41248130327440485
accuracies_anomaly['prior_star'][-1]= 0.5142715370143829



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.16915702819824 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5414033199601193
 first_prior_anomaly_auc= 0.41248423691585445
 first_prior_star_anomaly_auc= 0.5142622122254897


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5428895236730197; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4124558434575395; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5160983574541524 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5454733283796702; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41243625092357317; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5188746299944722 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5466115812620778; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4124416991148366; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.519274548187785 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5464675185123253; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4124519668599098; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5178164236144726 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5466233158278757 at iter 310
0.41248423691585445 at iter 0
0.5195323943166146 at iter 260
last anomaly aucs:
0.5461761450526442
0.41246485392770593
0.5164766924282295




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.12380766868591 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5461090903909412,first_prior_anomaly_auc= 0.41246558733806826, first_prior_star_anomaly_auc= 0.5163669951925999


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5461090903909412 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4125315942706821 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5162678800207702 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5461090903909414 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4125993823427474 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5161610116536811 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5461090903909412 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4126825720324226 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5160468091829683 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5461090903909414 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.412764294901373 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5159336544413446 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5461090903909412 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4128844694278938 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5158300340344317 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5461090903909414 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.41297164048810764 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.515714469515903 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5461091951638501 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.4131019779867927 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5156153543440734 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5461090903909412 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.41322435274440067 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5155187537220576 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5461090903909412 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.41335678570126394 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5154092660322458 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5461090903909412 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.4135204409849827 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5152932824220815 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5461090903909412 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.4136574839498381 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5151735269871963 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5461090903909412 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.41383538834916866 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5150535620064933 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5461092999367592 at iter 52
max_prior_anomaly= 0.4140116163819567 at iter 129
max_prior_star_anomaly= 0.5163669951925999 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5461090903909414
accuracies_anomaly['prior'][-1]= 0.4140116163819567
accuracies_anomaly['prior_star'][-1]= 0.5149542372888459



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.16989922523499 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5461090903909412
 first_prior_anomaly_auc= 0.41402502731429736
 first_prior_star_anomaly_auc= 0.5149330731612459


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.545459498355694; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4140873671950993; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5136060194969811 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5439723516866133; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41416165118751713; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5118799905955836 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5427359265885564; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4142111040005231; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5106036470192317 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5435750528160235; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41421613310015076; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 360 
last prior star auc 0.5111883846238632 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5461090903909412 at iter 0
0.41421780946669334 at iter 450
0.5149330731612459 at iter 0
last anomaly aucs:
0.5444844816653696
0.4142103705901607
0.5117848567942926




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.05057644844055 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5445542604227042,first_prior_anomaly_auc= 0.41421309468579237, first_prior_star_anomaly_auc= 0.5118429009858293


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5445542604227042 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41445962534045955 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5117090012082413 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5445542604227042 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4147142235091129 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5115549850321421 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.544554469968522 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41499145262609105 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5114133320592948 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5445542604227042 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41527926380686914 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5112938909431364 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5445542604227042 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4155752472745423 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5111455325041186 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5445543651956131 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41567111448619576 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.51101456636798 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5445542604227042 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4157200434346571 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.510884228869295 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5445542604227042 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41577882103655606 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5107497004542534 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5445541556497953 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4158291120328333 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.510613914764305 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5445542604227042 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41589972897343924 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5104607367714773 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5445540508768865 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41596804091004913 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5103186647069942 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5445542604227043 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.415997482097453 iter_best_prior_anomaly= 1190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5101788976465071 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5445544699685221 at iter 16
max_prior_anomaly= 0.41600418756362334 at iter 119
max_prior_star_anomaly= 0.5118429009858293 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5445542604227042
accuracies_anomaly['prior'][-1]= 0.41593859972264513
accuracies_anomaly['prior_star'][-1]= 0.5100436358211031



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.14965844154358 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5445541556497953
 first_prior_anomaly_auc= 0.4159427906390016
 first_prior_star_anomaly_auc= 0.5100286532951289


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5451250632304505; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41592036923649467; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.51036235501001 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5451287302822624; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.41590046238380163; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5102003760928338 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5444446679599835; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.41588642281400756; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5094475827423094 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5431822591805167; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.415915235363958; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5082569434054465 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5452081481472169 at iter 150
0.4159427906390016 at iter 0
0.5103651838785506 at iter 90
last anomaly aucs:
0.5417146002724933
0.41593901881428086
0.5069157453984786




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.0646653175354 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5415787098096361,first_prior_anomaly_auc= 0.4159404856350055, first_prior_star_anomaly_auc= 0.5067796453898035


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5415789193554538 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4159722318264055 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5066486792536649 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5415788145825449 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41583958932372445 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5065000064959203 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5415789193554538 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4155457013142294 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5063608680728868 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5415787098096361 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4153569005323721 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5062204723749462 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5415789193554539 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4152877504124909 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5060844771391799 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5415787098096361 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4151344676467544 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5059595878317582 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5415789193554538 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4150214176780396 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5058274691936215 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5415789193554538 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4148991476933406 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5056967126033008 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5415789193554538 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41477803021063964 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.505559041000992 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5415788145825449 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4145294040977942 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5054152925699663 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.541578709809636 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4143225823756042 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5052836977963743 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5415789193554538 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41405478282042807 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5051634184969447 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5415791289012717 at iter 8
max_prior_anomaly= 0.41599077663128275 at iter 6
max_prior_star_anomaly= 0.5067796453898035 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5415789193554538
accuracies_anomaly['prior'][-1]= 0.41386105771185183
accuracies_anomaly['prior_star'][-1]= 0.5050479587513248



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.17200493812561 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5415789193554538
 first_prior_anomaly_auc= 0.41384617995878653
 first_prior_star_anomaly_auc= 0.5050376910062516


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5398681872987574; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4140165407086756; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5034813942172898 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5379166870973839; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41423844972974877; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5016783572278429 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5358329634849648; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4145261561376179; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.4997946450985348 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5338765389568726; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4148295784818238; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.4980139247386859 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5415789193554538 at iter 0
0.4150983209931801 at iter 490
0.5050376910062516 at iter 0
last anomaly aucs:
0.5321424425414889
0.4150983209931801
0.49634866412445683




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.04086184501648 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5319758536163208,first_prior_anomaly_auc= 0.4151343628738454, first_prior_star_anomaly_auc= 0.49616971199603704


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5319758536163207 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41592309333212635 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49607353046565694 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5319758536163208 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.41600345415326095 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4960010276126906 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5319760631621386 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4161328486957659 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49592328611427877 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5319758536163208 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4163472140673975 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49585036416967687 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5319758536163208 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.41660568883368054 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49576256447200945 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5319758536163208 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4168489715281716 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4956765459137936 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5319758536163207 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4170527548360031 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49559597554684126 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5319758536163208 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.41740395362667226 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49553122588913434 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5319758536163208 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4177274923693891 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4954539034823581 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5319760631621386 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4180631847695394 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49535562649379977 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5319758536163208 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4184143835602086 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4952830188679245 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5319758536163208 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.41884552408037673 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4952034962300612 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5319760631621386 at iter 15
max_prior_anomaly= 0.4191628812214677 at iter 129
max_prior_star_anomaly= 0.49616971199603704 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5319758536163208
accuracies_anomaly['prior'][-1]= 0.4191628812214677
accuracies_anomaly['prior_star'][-1]= 0.4951504811381523



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.96841502189636 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5319759583892296
 first_prior_anomaly_auc= 0.4191999708312222
 first_prior_star_anomaly_auc= 0.4951459759030692


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5300660530326938; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41992101799034665; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.49327567470610145 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5281413746960013; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42067265883887306; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.49146603702339325 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5263120397064179; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42147741955221735; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.48978925138918394 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5247119478415313; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42221847833694376; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.4882325355085866 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5319759583892296 at iter 0
0.4229055790735812 at iter 490
0.4951459759030692 at iter 0
last anomaly aucs:
0.523404381938324
0.4229055790735812
0.48699998700815933




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.06970381736755 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5232931131090606,first_prior_anomaly_auc= 0.4229900260381633, first_prior_star_anomaly_auc= 0.4868807554378187


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5232929035632428 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4239830636688204 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4868468090153316 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5232931131090606 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.42424290048291935 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4867835261783495 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5232933226548784 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.42461337748882805 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4867091374130228 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5232932178819696 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4250320500328359 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48665538891075155 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5232933226548784 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4255181963301822 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4866232236277159 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5232933226548785 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4260057046753444 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48659304902994954 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5232931131090606 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.42641054719537586 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.486574923316708 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5232933226548785 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.42681277039268467 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48656434125290793 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5232930083361517 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.42719498196439143 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4865440153085793 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5232931131090606 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4275920712891636 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48653699552368224 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5232931131090607 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.427959405107805 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4865306043762387 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5232933226548785 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4281756563917971 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48652243208934365 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5232933226548785 at iter 16
max_prior_anomaly= 0.4283277866555355 at iter 129
max_prior_star_anomaly= 0.48689489978052175 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5232931131090607
accuracies_anomaly['prior'][-1]= 0.4283277866555355
accuracies_anomaly['prior_star'][-1]= 0.48653689075077333



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.02785301208496 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5232931131090606
 first_prior_anomaly_auc= 0.42834046417751376
 first_prior_star_anomaly_auc= 0.4865421293962188


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5221261524496116; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4289993810016542; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.48516991860821346 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5211178179742535; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42960874023987966; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.48408688104880193 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5204129058431013; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43001714503881416; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.48320825543467555 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5198739539996639; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43025215067350125; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.48250376239515896 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5232931131090606 at iter 0
0.4304669351367684 at iter 490
0.4865421293962188 at iter 0
last anomaly aucs:
0.5195715793845472
0.4304669351367684
0.4820014810698403




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.04146528244019 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5195625689143808,first_prior_anomaly_auc= 0.4304789840212932, first_prior_star_anomaly_auc= 0.4819731923844344


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.519562359368563 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43064106771137833 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48201195836073146 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.519562359368563 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4307739197598772 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4820245311098007 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.519562359368563 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43081656233380394 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4820425520501334 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5195621498227452 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4308937799676713 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4820903284965967 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.519562359368563 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4309521384779346 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4821274181063512 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.519562359368563 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4309764457928019 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4821650315806502 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.519562359368563 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4309499382468476 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4821990827760462 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.519562359368563 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4309691116891782 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4822269523698165 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.519562359368563 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4309584248524693 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48226550880029573 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5195621498227452 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4310035819762098 iter_best_prior_anomaly= 950
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48229589294387987 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.519562359368563 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4309854562629683 iter_best_prior_anomaly= 1010
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4823279534540066 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.519562359368563 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4309542339361128 iter_best_prior_anomaly= 1010
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48235875668922634 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5195625689143808 at iter 0
max_prior_anomaly= 0.4310097635778356 at iter 101
max_prior_star_anomaly= 0.48239029333480854 at iter 127
last values
accuracies_anomaly['vanilla_star'][-1]= 0.519562359368563
accuracies_anomaly['prior'][-1]= 0.4308755494815208
accuracies_anomaly['prior_star'][-1]= 0.482389769470264



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.74050307273865 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.519562359368563
 first_prior_anomaly_auc= 0.43085574740173666
 first_prior_star_anomaly_auc= 0.48239270311171345


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5194896469697788; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43044199918444764; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.4816863241598365 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5195625689143809; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.42992808806623994; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.4812158937988268 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5197651997202144; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.42965243054289554; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.480851284075817 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5200292274506698; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4293942700953392; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.4804919129982528 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5203445939064915 at iter 490
0.4308873888202276 at iter 20
0.48239270311171345 at iter 0
last anomaly aucs:
0.5203445939064915
0.42922946230962233
0.4801566396897381




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.1230936050415 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5203797976038855,first_prior_anomaly_auc= 0.4292180420625511, first_prior_star_anomaly_auc= 0.4801273032752431


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5203797976038854 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.43060366378289716 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48066625511868044 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5203802166955211 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.43120893687767514 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48081188946206654 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5203799023767944 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.43146070617778787 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48087684866559127 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5203802166955211 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4314334652214711 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48093866468184865 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5203796928309765 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4311180987656494 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4809074423549933 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5203800071497033 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4308438032901208 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4809157194147972 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5203797976038854 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.43043738917645563 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48091079508807844 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5203797976038855 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4292526171224917 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4805885136202686 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5203793785122498 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.42883991663429183 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48063503279182507 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5203797976038855 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.42925335053285407 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48089937484100714 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5203800071497033 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.42781031325842495 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4804667675001142 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5203797976038855 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4274644578861102 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4805547767435993 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5203802166955211 at iter 9
max_prior_anomaly= 0.4314926619150057 at iter 31
max_prior_star_anomaly= 0.4809671629130724 at iter 42
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5203795880580677
accuracies_anomaly['prior'][-1]= 0.42689239780345695
accuracies_anomaly['prior_star'][-1]= 0.4803990842009578



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.12989711761475 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5203796928309766
 first_prior_anomaly_auc= 0.4268517459147995
 first_prior_star_anomaly_auc= 0.4803982460176865


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.520822253598216; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4258864731050038; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.47974257715372237 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5213342788040634; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.42628136219868884; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.479703077767063 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5218976427352771; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4254551230390179; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4788816581612019 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5225425199896234; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4251236215552239; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4781475143884636 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5230902727574092 at iter 490
0.4268517459147995 at iter 0
0.4805644158512191 at iter 10
last anomaly aucs:
0.5230902727574092
0.42501706750686163
0.47753836469605593




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.04419302940369 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5231367919289656,first_prior_anomaly_auc= 0.4245308164366063, first_prior_star_anomaly_auc= 0.47732651387423813


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5231370014747835 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42500061816016255 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47742395267952525 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5231370014747835 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42523321401794467 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4774609375163708 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5231370014747835 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42512110700541006 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4774233240420718 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5231370014747834 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.42496897674167144 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47739943581884015 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5231372110206013 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4248086741910379 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47736004120508957 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5231370014747835 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4246254263733528 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47731907499770554 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5231370014747835 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4242519109530856 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47716453495706196 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5231370014747835 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4239351824494481 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4770256060798461 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5231370014747835 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.423079711648191 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4766890754964245 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5231370014747834 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.42353463561868193 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4770859552753788 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5231368967018746 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4225803639643219 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47664769019740477 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5231372110206013 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4227668597421832 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4768925444855294 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5231374205664192 at iter 33
max_prior_anomaly= 0.4252934584405684 at iter 12
max_prior_star_anomaly= 0.4775383646960559 at iter 11
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5231370014747835
accuracies_anomaly['prior'][-1]= 0.4227938911526822
accuracies_anomaly['prior_star'][-1]= 0.47702204380094315



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.48193836212158 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5231370014747834
 first_prior_anomaly_auc= 0.4219836822480746
 first_prior_star_anomaly_auc= 0.47658817918514335


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5243490144850642; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4220357543838033; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 70 
last prior star auc 0.47668425594261465 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5250346484009769; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.420302496151691; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 70 
last prior star auc 0.4747143157092728 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5257341123408658; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4195297959484735; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 70 
last prior star auc 0.47274280388229734 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5263834948302951; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.41980953961526557; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 70 
last prior star auc 0.4715141319794997 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5268390474382395 at iter 480
0.4225388738923932 at iter 70
0.47755764291129543 at iter 20
last anomaly aucs:
0.5268373710716969
0.42045336914052267
0.47075683339389207




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.02874159812927 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5268805375101683,first_prior_anomaly_auc= 0.4222227740262091, first_prior_star_anomaly_auc= 0.4711497318023078


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5268803279643504 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4215497128593658 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4702013274308468 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5268803279643504 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42169272788002915 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4700215371191556 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5268804327372593 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4215237291779559 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4699046105528112 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5268803279643504 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.42134551045989854 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46987778868813007 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5268803279643505 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.42125027188569864 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4696808156193777 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5268805375101683 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.42120176202887294 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46964938374670434 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5268805375101683 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4213560925236986 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.469817858584233 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5268805375101682 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.42103140127898386 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4694790229968153 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5268805375101683 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4205991082568177 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4694459147575995 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5268805375101682 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.42033843325944753 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46945220113213415 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5268803279643504 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4198626594800833 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46928456447787675 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5268803279643504 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.41945980764532104 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46920451797546886 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.526880747055986 at iter 34
max_prior_anomaly= 0.4222227740262091 at iter 0
max_prior_star_anomaly= 0.4711497318023078 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5268805375101683
accuracies_anomaly['prior'][-1]= 0.4190205996111668
accuracies_anomaly['prior_star'][-1]= 0.4688742737665819



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.89478516578674 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5268803279643504
 first_prior_anomaly_auc= 0.41898832955522225
 first_prior_star_anomaly_auc= 0.4688661014796869


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5270410496066197; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4155232799117225; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.46609663917844635 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5272723881894947; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.41446926444807936; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.462063406049923 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5273388142137443; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4148722210557505; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.45932673766917165 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.526571666974699; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.41467420025790896; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4544602455960803 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5273689888115106 at iter 180
0.41898832955522225 at iter 0
0.4688661014796869 at iter 0
last anomaly aucs:
0.5255006782998123
0.41361683206118066
0.4485464435255162




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.07754635810852 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5254992114790875,first_prior_anomaly_auc= 0.4145079256514675, first_prior_star_anomaly_auc= 0.4490476771217457


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5254990019332697 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41612216185905704 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4493971995458723 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5254994210249053 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41574937984915217 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44912877135324275 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5254992114790875 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41539692378357607 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44897286926478336 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5254990019332697 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4150790427779405 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4486629510002251 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5254994210249053 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41481208140603565 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4487098892634171 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5254992114790875 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41463993951669514 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44850306754122704 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5254990019332697 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41454742503812686 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44834968000258163 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5254994210249053 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41443762302958825 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.448083556813948 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5254992114790875 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4142838163993071 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4478997851317184 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5254992114790875 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41414698298026953 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4480512867580035 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5254994210249053 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41402293185611916 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44785138004780156 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5254992114790875 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41388264093108745 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44768688658081157 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5254996305707231 at iter 8
max_prior_anomaly= 0.41618481605858565 at iter 7
max_prior_star_anomaly= 0.4498730780981454 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5254996305707231
accuracies_anomaly['prior'][-1]= 0.41400742546560027
accuracies_anomaly['prior_star'][-1]= 0.4476954779593423



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.97725868225098 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5254992114790875
 first_prior_anomaly_auc= 0.41399338589580625
 first_prior_star_anomaly_auc= 0.4476774570190095


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5255583033997133; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4173582726383872; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 80 
last prior star auc 0.445501533246749 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.523062403163639; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4160533260579026; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 180 
last prior star auc 0.43847085196719515 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5210979111215605; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4178090056925217; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 180 
last prior star auc 0.43499930640334306 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5168600565019343; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41726460565782086; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 380 
last prior star auc 0.42968962492555884 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.527771735873364 at iter 30
0.4197935093602022 at iter 480
0.4506022975441649 at iter 10
last anomaly aucs:
0.4982865438476719
0.4169603451303438
0.42386006027375905




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.06871509552002 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.49514440430943546,first_prior_anomaly_auc= 0.4168786222613933, first_prior_star_anomaly_auc= 0.4234849732598582


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4951446138552532 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.41725538564183673 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4229032740695851 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.49514440430943546 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.41731741120391197 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42300909470758513 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.49514524249270675 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4169866431304804 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42297661510582274 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4951454520385246 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4167277492725617 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4227215978455337 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.49514503294688894 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.41642977511961926 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4224649042187021 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4951446138552533 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.416219600664344 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4222670929666784 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.49514503294688894 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.41605301173917575 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4222559870383339 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.49514503294688894 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4158516382082491 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4220437171248805 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.49514461385525327 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.41558142887616806 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4217625066373638 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4951446138552533 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.41536915896271465 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4214984789069084 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.49514503294688894 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.41517480521668504 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4215408071621084 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.49514587113016023 iter_best_vanilla_star_anomaly= 1200 
last prior auc 0.41517208112105336 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42145258837280547 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.49514587113016023 at iter 120
max_prior_anomaly= 0.4174856764956228 at iter 2
max_prior_star_anomaly= 0.4248656706534854 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4951444043094355
accuracies_anomaly['prior'][-1]= 0.4150788332321227
accuracies_anomaly['prior_star'][-1]= 0.42130569675451246



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.3248610496521 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4951446138552533
 first_prior_anomaly_auc= 0.41504090543909694
 first_prior_star_anomaly_auc= 0.42124880506497386


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45210096923322574; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42122334524810856; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 60 
last prior star auc 0.41775787651297325 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44285203592621136; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4215261389548609; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 190 
last prior star auc 0.40372668855163185 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4478394359361857; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4222284317632904; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 250 
last prior star auc 0.3995327337808394 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.45130322830477854; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4224102127602507; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 390 
last prior star auc 0.40166308133772377 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4951446138552533 at iter 0
0.42376964125336897 at iter 450
0.42668704290199166 at iter 20
last anomaly aucs:
0.4520054163402991
0.42289950224486433
0.4020885641208107




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.09583759307861 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4518340078613209,first_prior_anomaly_auc= 0.42072085437697204, first_prior_star_anomaly_auc= 0.4004611265266984


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4518344269529565 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41868658357755895 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39769533127726975 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4518341126342298 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4194468158046161 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3979744463066083 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45183358876968527 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41953597755009925 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39805281644247353 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4518342174071387 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4194942779323528 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3982518849694042 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4518344269529565 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41951387046631905 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39830238551149927 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.45183421740713875 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4195373395979151 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3982238058298161 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.45183442695295656 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.41963394021993083 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3981091842674676 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.45183484604459223 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.4197280262921328 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.398126367024529 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4518348460445922 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.41972718810886156 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39802473730288546 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.451833903088412 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.41972593083395465 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3979331657804974 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4518342174071387 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.4197132533119764 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3978711402184222 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4518340078613209 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.4197177585470596 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3977889982578361 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.45183484604459223 at iter 63
max_prior_anomaly= 0.42097922437034624 at iter 1
max_prior_star_anomaly= 0.4027152108890065 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4518343221800476
accuracies_anomaly['prior'][-1]= 0.4196903080449249
accuracies_anomaly['prior_star'][-1]= 0.39771460949250936



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.28504800796509 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.45183442695295656
 first_prior_anomaly_auc= 0.41969407986964574
 first_prior_star_anomaly_auc= 0.3977089517554282


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4506930308832817; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42206530034411616; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 100 
last prior star auc 0.39947060344585517 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44987119218578503; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4216914706051222; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 190 
last prior star auc 0.39897209394525746 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44919006350495555; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4209482115893087; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 190 
last prior star auc 0.3988977051799307 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44883477857083887; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42194470672595974; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 190 
last prior star auc 0.4000864586044332 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.45183442695295656 at iter 0
0.42270672009246846 at iter 190
0.40106220870512 at iter 440
last anomaly aucs:
0.4481612983123599
0.421547093536643
0.40048627202483705




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.07373666763306 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4481590980812728,first_prior_anomaly_auc= 0.42364108489413543, first_prior_star_anomaly_auc= 0.40087372224198936


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44815878376254603 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4197181776386953 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39878413134667134 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44815878376254603 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.42000756041310705 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39868061571266744 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4481589933083639 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4196873744034755 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39861240854896646 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4481583646709104 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41922846906244593 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39839772885860814 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4481586789896371 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41881000606425595 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39795904468899834 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44815899330836384 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4185051168993254 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3980509305301132 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44815878376254603 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4182134291209176 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3979508724021033 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44815888853545494 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4179760137093256 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39772424860012917 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44815899330836384 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4177620674293296 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3975232941608381 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.448158888535455 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41757578119728617 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3974451335707907 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4481586789896371 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4173048384548427 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39718529675669173 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4481585742167282 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4170942449079319 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39706040744927007 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.44815941239999957 at iter 8
max_prior_anomaly= 0.4255675443702792 at iter 1
max_prior_star_anomaly= 0.403780541826812 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44815878376254603
accuracies_anomaly['prior'][-1]= 0.4168917188750072
accuracies_anomaly['prior_star'][-1]= 0.3969573109069017



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.81686544418335 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4481586789896371
 first_prior_anomaly_auc= 0.4168812415841161
 first_prior_star_anomaly_auc= 0.3969514436240028


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44808146135576976; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4209253710951661; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 30 
last prior star auc 0.40133116076229414 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4477694476330333; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42092568541389286; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 150 
last prior star auc 0.40206289475812756 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4474781789462612; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4214236710499461; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 150 
last prior star auc 0.4026737208170778 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4469911944656435; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4199496209944793; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 150 
last prior star auc 0.40179781929858305 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44875452252261316 at iter 10
0.4227337515029674 at iter 150
0.4032394945251965 at iter 440
last anomaly aucs:
0.44691177660068904
0.4211732637976492
0.40320973901906565




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 69.12629508972168 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4468229291739327,first_prior_anomaly_auc= 0.4241136107133233, first_prior_star_anomaly_auc= 0.40309176472363206


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4468229291739326 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.419405744824323 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4015601943411733 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44682313871975055 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.42054336906927714 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4016069230585475 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44682334826556835 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.42072347369969487 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.401489996492203 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44682313871975055 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4207248357475107 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40137767993385054 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4468229291739326 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4205926123364652 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40129029932781896 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4468229291739327 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4205134040173286 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40125320971806444 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44682313871975043 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4204723330370356 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4011723250323853 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44682292917393274 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4204307381921979 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40108871625107445 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44682334826556835 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4203818092437366 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4010160038522903 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.44682334826556824 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4205069080969761 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40107761032272987 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4468229291739326 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.42050229808898404 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4009956779079616 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4468229291739326 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.42051319447151075 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4009692751349161 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.44682355781138616 at iter 12
max_prior_anomaly= 0.42620435411063934 at iter 1
max_prior_star_anomaly= 0.40499967939489867 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44682313871975043
accuracies_anomaly['prior'][-1]= 0.4204019256422475
accuracies_anomaly['prior_star'][-1]= 0.4009007536524884



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.20182418823242 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.47259748385763795
accuracies_anomaly["prior"][-1]= 0.4123300111939376
accuracies_anomaly["prior_star"][-1]= 0.46935968665356587


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 2898.963112592697 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0036957263946533203 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4632568742553265
 first_prior_anomaly_auc= 0.4121944350498069
 first_prior_star_anomaly_auc= 0.4597535825000744


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46126241716129956; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41186628629909816; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 40 
last prior star auc 0.46113763262678675 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613140702053926; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41132481990584685; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 40 
last prior star auc 0.4611833136150719 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46127708536854706; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4099974519228553; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 40 
last prior star auc 0.4611359562602442 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4610250017497076; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.40986931465525733; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 40 
last prior star auc 0.46106785386945215 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4610247922038897; count_not_improved_vanilla_star_anomaly= 45 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4098364159618593; count_not_improved_prior_anomaly= 46; iter_best_prior_anomaly= 40 
last prior star auc 0.4610540238454759 ; count_not_improved_prior_star_anomaly= 46 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4610325453991492; count_not_improved_vanilla_star_anomaly= 55 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.40953948953800595; count_not_improved_prior_anomaly= 56; iter_best_prior_anomaly= 40 
last prior star auc 0.46105276657056893 ; count_not_improved_prior_star_anomaly= 56 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4610411367776798; count_not_improved_vanilla_star_anomaly= 65 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4094405839119941; count_not_improved_prior_anomaly= 66; iter_best_prior_anomaly= 40 
last prior star auc 0.4610584243076502 ; count_not_improved_prior_star_anomaly= 66 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4610585290805591; count_not_improved_vanilla_star_anomaly= 75 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.40905103823666356; count_not_improved_prior_anomaly= 76; iter_best_prior_anomaly= 40 
last prior star auc 0.46108671299305604 ; count_not_improved_prior_star_anomaly= 76 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46108315071415307; count_not_improved_vanilla_star_anomaly= 85 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4088681047377052; count_not_improved_prior_anomaly= 86; iter_best_prior_anomaly= 40 
last prior star auc 0.4610984475588541 ; count_not_improved_prior_star_anomaly= 86 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5482758989201266 at iter 60
0.4122216760061238 at iter 40
0.5223531953432214 at iter 60
last anomaly aucs:
0.46108933231577887
0.4082611552763847
0.46110148597321254




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 137.85618543624878 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4610959330090402,first_prior_anomaly_auc= 0.40827529961908765, first_prior_star_anomaly_auc= 0.4611032671126639


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4610959330090402 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3762700048153629 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46108157912051945 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4610959330090402 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3940391758479167 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610865034472382 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4610959330090402 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4000370057914273 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46108776072214513 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4610959330090402 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4049550461357027 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610912182281392 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4610959330090402 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40897266810079824 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46109132300104816 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4610959330090402 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41227867246857125 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46109499005286003 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4610959330090402 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4121977877828921 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610923707301373 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4610959330090402 at iter 0
max_prior_anomaly= 0.41577892580946496 at iter 77
max_prior_star_anomaly= 0.4611046291604798 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4610959330090402
accuracies_anomaly['prior'][-1]= 0.4150844909692039
accuracies_anomaly['prior_star'][-1]= 0.46109949528794314



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.71898365020752 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4610959330090402
 first_prior_anomaly_auc= 0.41416479437478443
 first_prior_star_anomaly_auc= 0.4610957234632225


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 23


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 24 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.46113333693752134 at iter 10
0.41416479437478443 at iter 0
0.4611094487142897 at iter 20
last anomaly aucs:
0.46112317396535707
0.4010241761391854
0.4611094487142897




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 3.39382004737854 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4632568742553266
accuracies_anomaly["prior"][-1]= 0.4121944350498069
accuracies_anomaly["prior_star"][-1]= 0.4597535825000744


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 217.18403720855713 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003245115280151367 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46321831782484735
 first_prior_anomaly_auc= 0.41246516824643253
 first_prior_star_anomaly_auc= 0.4599411260070248


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46126660807765596; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4118017461872091; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.46114831946349566 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46119599113705007; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41120956970604494; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4611543962922125 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4610258399329789; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41034477411589476; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4610920564114105 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46105915771801254; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4101530396925879; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.461090275271959 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46113480375824617; count_not_improved_vanilla_star_anomaly= 46 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41037620598856805; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.4611296698857095 ; count_not_improved_prior_star_anomaly= 47 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4611864568023392; count_not_improved_vanilla_star_anomaly= 56 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4101704319954671; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.4611440237742303 ; count_not_improved_prior_star_anomaly= 57 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4612403100775194; count_not_improved_vanilla_star_anomaly= 66 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.40991373836863554; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.46115324379021444 ; count_not_improved_prior_star_anomaly= 67 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4611087153039274; count_not_improved_vanilla_star_anomaly= 76 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41480097547769107; count_not_improved_prior_anomaly= 78; iter_best_prior_anomaly= 790 
last prior star auc 0.4611135348577372 ; count_not_improved_prior_star_anomaly= 77 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 850


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 851 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5441427124365024 at iter 60
0.41794426751792557 at iter 840
0.5180997295601675 at iter 30
last anomaly aucs:
0.4612045825155807
0.41794426751792557
0.46115953016474914




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 117.39444589614868 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.461032754944967,first_prior_anomaly_auc= 0.3909485845808644, first_prior_star_anomaly_auc= 0.4610285640286106


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 37, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 38 iterations

max values 
max_vanilla_star_anomaly= 0.461032754944967 at iter 0
max_prior_anomaly= 0.3936531924514891 at iter 3
max_prior_star_anomaly= 0.4610288783473373 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.461032754944967
accuracies_anomaly['prior'][-1]= 0.3936531924514891
accuracies_anomaly['prior_star'][-1]= 0.4610288783473373



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 3.671722412109375 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.46321831782484735
accuracies_anomaly["prior"][-1]= 0.41246516824643253
accuracies_anomaly["prior_star"][-1]= 0.4599412307799337


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 121.32616448402405 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0037086009979248047 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46391861994800754
 first_prior_anomaly_auc= 0.41272259528362654
 first_prior_star_anomaly_auc= 0.46051475768331174


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4611663404038283; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.412045133654609; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4608031975015433 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46106973978181254; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.41196854465819516; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4609945128332145 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4610248969767986; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4114243541693122; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4610989714233986 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.461078540706161; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.411349336766532; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4611119632641036 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4612399957587926; count_not_improved_vanilla_star_anomaly= 46 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.41117457555446874; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.4611601588022025 ; count_not_improved_prior_star_anomaly= 47 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46135168367969165; count_not_improved_vanilla_star_anomaly= 56 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.41131088510896174; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.46118582816488574 ; count_not_improved_prior_star_anomaly= 57 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4613837441898183; count_not_improved_vanilla_star_anomaly= 66 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4112972646308033; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.461201963192858 ; count_not_improved_prior_star_anomaly= 67 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46140113649269754; count_not_improved_vanilla_star_anomaly= 76 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.41148449381902696; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.461210135479753 ; count_not_improved_prior_star_anomaly= 77 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4614035462696025; count_not_improved_vanilla_star_anomaly= 86 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4117365774378665; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.4612185173124659 ; count_not_improved_prior_star_anomaly= 87 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5533968843889623 at iter 70
0.41272259528362654 at iter 0
0.5185405091879555 at iter 30
last anomaly aucs:
0.46140637513814303
0.4117240046887972
0.46122574664318083




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 136.91474533081055 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4614068990026876,first_prior_anomaly_auc= 0.4117476833662111, first_prior_star_anomaly_auc= 0.4612258514160896


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4614068990026876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.413435470155856 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612298327866283 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4614068990026876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41800933149435926 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612341284758937 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4614068990026876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43153216130166516 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46124093871497285 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4614068990026876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.455407916557179 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46125089214131937 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4614068990026876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46928037356152036 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612597978385768 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4614068990026876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46471342723500525 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46126618898602034 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4614068990026876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45317677746192236 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612588548823966 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4614068990026876 at iter 0
max_prior_anomaly= 0.46939813831113614 at iter 51
max_prior_star_anomaly= 0.46126618898602034 at iter 60
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4614068990026876
accuracies_anomaly['prior'][-1]= 0.4419199761285404
accuracies_anomaly['prior_star'][-1]= 0.46124984441223027



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.23234677314758 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4614068990026876
 first_prior_anomaly_auc= 0.44112600702481397
 first_prior_star_anomaly_auc= 0.46124932054768575


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.461427644038652; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4484295169591717; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.46126346489038866 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4614294251781035; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4513807602573725; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.46126514125693124 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46142219584738864; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.45393575241407264; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.4612616837509372 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 348


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 349 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.46143298745700645 at iter 340
0.45400595026304286 at iter 310
0.46126744626092725 at iter 330
last anomaly aucs:
0.46143298745700645
0.45309096844952446
0.46126744626092725




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 47.6784245967865 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4639186199480075
accuracies_anomaly["prior"][-1]= 0.41272259528362654
accuracies_anomaly["prior_star"][-1]= 0.46051465291040283


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 259.04433155059814 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003589630126953125 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.45829975361602737
 first_prior_anomaly_auc= 0.4119664492000169
 first_prior_star_anomaly_auc= 0.45494021029180093


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4612211366351887; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.41194214188514966; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 30 
last prior star auc 0.4607038727838958 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613537791378698; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4131443062419927; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 200 
last prior star auc 0.46126524602984015 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46104721360639667; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.41329989401172534; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 280 
last prior star auc 0.461143185590959 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4610270972078858; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4130741083930225; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 280 
last prior star auc 0.4611002286983056 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4611218119175412; count_not_improved_vanilla_star_anomaly= 44 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.41280232746730766; count_not_improved_prior_anomaly= 45; iter_best_prior_anomaly= 280 
last prior star auc 0.46113082238770753 ; count_not_improved_prior_star_anomaly= 44 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46129594449215106; count_not_improved_vanilla_star_anomaly= 54 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4129105578822126; count_not_improved_prior_anomaly= 55; iter_best_prior_anomaly= 280 
last prior star auc 0.46117115995763824 ; count_not_improved_prior_star_anomaly= 54 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4613683425722085; count_not_improved_vanilla_star_anomaly= 64 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.41422765812013096; count_not_improved_prior_anomaly= 62; iter_best_prior_anomaly= 660 
last prior star auc 0.4612044777426718 ; count_not_improved_prior_star_anomaly= 64 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46141821447685005; count_not_improved_vanilla_star_anomaly= 74 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4144131061689031; count_not_improved_prior_anomaly= 64; iter_best_prior_anomaly= 800 
last prior star auc 0.46123150915317085 ; count_not_improved_prior_star_anomaly= 74 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4614408454251748; count_not_improved_vanilla_star_anomaly= 84 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.41449399085458233; count_not_improved_prior_anomaly= 66; iter_best_prior_anomaly= 900 
last prior star auc 0.4612512064600461 ; count_not_improved_prior_star_anomaly= 84 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5603387182417597 at iter 70
0.4145111736116437 at iter 980
0.5330082858607283 at iter 70
last anomaly aucs:
0.4614484938475253
0.4145053063287447
0.46126189329675504




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 137.8768060207367 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4614498558953411,first_prior_anomaly_auc= 0.4145093924721922, first_prior_star_anomaly_auc= 0.4612627314800263


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4614498558953411 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4157567139527759 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612670271692917 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4614498558953411 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4192127531261092 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612699608107411 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4614498558953411 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4276706509708467 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612763519581847 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4614498558953411 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44188749652677806 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46128274310562833 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4614498558953411 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44730844683382553 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46128546720125996 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4614498558953411 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4436898001058625 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46128316219726395 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4614498558953411 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4450346651646423 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46128337174308176 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4614498558953411 at iter 0
max_prior_anomaly= 0.4474497854879463 at iter 49
max_prior_star_anomaly= 0.46128546720125996 at iter 50
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4614498558953411
accuracies_anomaly['prior'][-1]= 0.44010803344183613
accuracies_anomaly['prior_star'][-1]= 0.46127603763945796



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.061448097229 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4614498558953411
 first_prior_anomaly_auc= 0.43926785948528
 first_prior_star_anomaly_auc= 0.46127394218127976


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4614700770667609; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.44131260757558427; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.4612870387948936 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4614553040866044; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4412890336710793; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 120 
last prior star auc 0.4612782378705451 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4614597045487787; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4403791857300975; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 120 
last prior star auc 0.46127635195818467 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4614521608993371; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4397183829935967; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 120 
last prior star auc 0.4612682844441986 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 479


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 480 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4614736393456638 at iter 140
0.4426095914149917 at iter 120
0.46128923902598074 at iter 120
last anomaly aucs:
0.4614168524290342
0.43940249267323045
0.4612582262449431




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 66.23157596588135 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4582997536160275
accuracies_anomaly["prior"][-1]= 0.4119664492000169
accuracies_anomaly["prior_star"][-1]= 0.45494041983761874


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 280.38304257392883 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003200054168701172 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46458591860486076
 first_prior_anomaly_auc= 0.4123392312099217
 first_prior_star_anomaly_auc= 0.46124953009350356


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46113511807697294; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41183013964552395; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.460751858776177 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613369106995352; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4113673577068646; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.46116298767074315 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4610790645707056; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4110063102627579; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4611122775828303 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46096978642671155; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41097865021480545; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.46105936726383034 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46108178866633726; count_not_improved_vanilla_star_anomaly= 47 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41084894135357375; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.4610986571046719 ; count_not_improved_prior_star_anomaly= 47 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4612438723564224; count_not_improved_vanilla_star_anomaly= 57 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41107671765754594; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.4611470621885888 ; count_not_improved_prior_star_anomaly= 57 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46135461732114114; count_not_improved_vanilla_star_anomaly= 67 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4108971368916728; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.46117241723254515 ; count_not_improved_prior_star_anomaly= 67 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46137934372764405; count_not_improved_vanilla_star_anomaly= 77 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41084716021412226; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.46118006565489567 ; count_not_improved_prior_star_anomaly= 77 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4613983076241569; count_not_improved_vanilla_star_anomaly= 87 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4110218166532767; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.46118813316888174 ; count_not_improved_prior_star_anomaly= 87 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5452929094305257 at iter 30
0.4123392312099217 at iter 0
0.5206964213346141 at iter 30
last anomaly aucs:
0.46141088037322625
0.4115423284647458
0.46120615410921445




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 136.5707232952118 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46141318537722226,first_prior_anomaly_auc= 0.41153321322167047, first_prior_star_anomaly_auc= 0.46120730661121245


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46141318537722226 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41158884763630216 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46120720183830355 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46141318537722226 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41168565780413585 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46120720183830355 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46141318537722226 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.411793573900314 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612080400215748 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46141318537722226 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4119014899964922 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46120866865902826 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46141318537722226 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4120183117899278 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46120824956739265 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46141318537722226 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41215839316914166 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46120919252357284 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46141318537722226 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41228265383910984 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612099259339352 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.46141318537722226 at iter 0
max_prior_anomaly= 0.41241456293142864 at iter 79
max_prior_star_anomaly= 0.461210240252662 at iter 74
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46141318537722226
accuracies_anomaly['prior'][-1]= 0.41241456293142864
accuracies_anomaly['prior_star'][-1]= 0.46121024025266194



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.12313318252563 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46141318537722226
 first_prior_anomaly_auc= 0.41242724045340684
 first_prior_star_anomaly_auc= 0.46121044979847975


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46142387221393116; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4124712450751494; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 60 
last prior star auc 0.46122438459536497 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46142041470793715; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.41230717069979506; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 60 
last prior star auc 0.46122595618899864 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46144859862043414; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.412499952852191; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 240 
last prior star auc 0.46126786535256303 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4614625334173193; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.416053954695356; count_not_improved_prior_anomaly= 31; iter_best_prior_anomaly= 400 
last prior star auc 0.46128892470725397 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 460


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 461 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4614625334173193 at iter 400
0.4168522194883477 at iter 410
0.46128892470725397 at iter 400
last anomaly aucs:
0.46125183509749956
0.41551301216664926
0.4611989247784996




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 62.957250356674194 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4611778654238085,first_prior_anomaly_auc= 0.44784907504380556, first_prior_star_anomaly_auc= 0.4611680167703709


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4611778654238085 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4479138247015124 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611678072245531 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4611778654238085 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4479905184708352 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46116812154327985 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4611778654238085 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4480825090848589 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611683310890976 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4611778654238085 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44816674650362326 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46116833108909766 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4611778654238085 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4482673284961777 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611684358620065 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4611778654238085 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4483792259628945 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611683310890976 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4611778654238085 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44848913274434193 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611684358620065 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4611778654238085 at iter 0
max_prior_anomaly= 0.4485950581552508 at iter 79
max_prior_star_anomaly= 0.4611686454078243 at iter 77
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4611778654238085
accuracies_anomaly['prior'][-1]= 0.4485950581552508
accuracies_anomaly['prior_star'][-1]= 0.4611686454078243



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.92999863624573 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4611778654238085
 first_prior_anomaly_auc= 0.4486063736294132
 first_prior_star_anomaly_auc= 0.4611684358620065


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 2:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4645860233777696
accuracies_anomaly["prior"][-1]= 0.4123392312099217
accuracies_anomaly["prior_star"][-1]= 0.4612495300935035


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 347.92480993270874 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003624439239501953 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4715932355257274
 first_prior_anomaly_auc= 0.41197472625982084
 first_prior_star_anomaly_auc= 0.46868274888909284


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46127383740837086; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4115141445522488; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4607418005769215 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46136593279530347; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41116546031139345; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4611906477186956 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4611354323956996; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4116122119949893; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.46117514132817683 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46103432653860066; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4123725489949554; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 400 
last prior star auc 0.4611210785071788 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46104909951875706; count_not_improved_vanilla_star_anomaly= 44 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4122212569144882; count_not_improved_prior_anomaly= 49; iter_best_prior_anomaly= 400 
last prior star auc 0.4611099725788343 ; count_not_improved_prior_star_anomaly= 45 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46115051969458276; count_not_improved_vanilla_star_anomaly= 54 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41178707797996156; count_not_improved_prior_anomaly= 59; iter_best_prior_anomaly= 400 
last prior star auc 0.46112610760680656 ; count_not_improved_prior_star_anomaly= 55 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4613252809066461; count_not_improved_vanilla_star_anomaly= 64 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41175428405947245; count_not_improved_prior_anomaly= 69; iter_best_prior_anomaly= 400 
last prior star auc 0.46118237065889167 ; count_not_improved_prior_star_anomaly= 65 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4613523123171451; count_not_improved_vanilla_star_anomaly= 74 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41300359622532545; count_not_improved_prior_anomaly= 77; iter_best_prior_anomaly= 780 
last prior star auc 0.46120206796576696 ; count_not_improved_prior_star_anomaly= 75 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46139191647671346; count_not_improved_vanilla_star_anomaly= 84 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41296032501394525; count_not_improved_prior_anomaly= 87; iter_best_prior_anomaly= 780 
last prior star auc 0.4612200889060996 ; count_not_improved_prior_star_anomaly= 85 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5489578657842273 at iter 80
0.4130656217874007 at iter 980
0.5223895515426135 at iter 80
last anomaly aucs:
0.46140249854051335
0.4130339803689096
0.4612307757428085




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 136.61206817626953 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4614058512735985,first_prior_anomaly_auc= 0.41304194310998676, first_prior_star_anomaly_auc= 0.46123276642807776


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4614058512735985 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41304875334906604 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123234733644214 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4614058512735985 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4130834331819155 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123213779062433 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4614058512735985 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4131417916921789 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123234733644214 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4614058512735985 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41317867175611556 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123245210935104 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4614058512735985 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4132348300352917 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612322425635332 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4614058512735985 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4133045040197174 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612319282448065 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4614058512735985 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4133901034862976 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123182347189756 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4614058512735985 at iter 0
max_prior_anomaly= 0.4134674258930738 at iter 79
max_prior_star_anomaly= 0.4612329759738956 at iter 44
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4614058512735985
accuracies_anomaly['prior'][-1]= 0.4134674258930738
accuracies_anomaly['prior_star'][-1]= 0.4612316139260797



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.04428553581238 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4614058512735985
 first_prior_anomaly_auc= 0.41347182635524804
 first_prior_star_anomaly_auc= 0.46123161392607975


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.461417061974852; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41358204745542226; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 80 
last prior star auc 0.4612435580376956 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4614230340306599; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41364281574259054; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 200 
last prior star auc 0.4612490062289589 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4614292156322856; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4136042593121114; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 280 
last prior star auc 0.4612522541891352 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4614300538155569; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.41310512117406006; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 280 
last prior star auc 0.46125340669113324 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4614166428832164; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.41340676237881446; count_not_improved_prior_anomaly= 32; iter_best_prior_anomaly= 280 
last prior star auc 0.46125141600586395 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46141297583140445; count_not_improved_vanilla_star_anomaly= 42 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.41307243202647986; count_not_improved_prior_anomaly= 42; iter_best_prior_anomaly= 280 
last prior star auc 0.461256026013856 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4614039653612382; count_not_improved_vanilla_star_anomaly= 52 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.41279059290150966; count_not_improved_prior_anomaly= 52; iter_best_prior_anomaly= 280 
last prior star auc 0.4612546639660401 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4614020794488778; count_not_improved_vanilla_star_anomaly= 62 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4126218037452543; count_not_improved_prior_anomaly= 62; iter_best_prior_anomaly= 280 
last prior star auc 0.4612546639660402 ; count_not_improved_prior_star_anomaly= 44 ; iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46141381401467574; count_not_improved_vanilla_star_anomaly= 72 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4125500343026504; count_not_improved_prior_anomaly= 72; iter_best_prior_anomaly= 280 
last prior star auc 0.46125235896204414 ; count_not_improved_prior_star_anomaly= 54 ; iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.46144451247698665 at iter 370
0.41368682036433313 at iter 280
0.4612585405636699 at iter 640
last anomaly aucs:
0.46139065920180644
0.4122722813211277
0.46124502485842034




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 137.39204049110413 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46138877328944605,first_prior_anomaly_auc= 0.4121924443645376, first_prior_star_anomaly_auc= 0.4612441866751491


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46138877328944605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4122899879427336 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612447105396936 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46138877328944605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41237307285949987 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612445009938758 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46138877328944605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4124781600871375 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612440819022402 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46138877328944605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4125847141354999 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612445009938758 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46138877328944605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41268613431132556 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612440819022401 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46138877328944605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4127958315469553 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612443962209669 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46138877328944605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4129091958343968 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612441866751491 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.46138877328944605 at iter 0
max_prior_anomaly= 0.4130131305600363 at iter 79
max_prior_star_anomaly= 0.4612447105396936 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46138877328944605
accuracies_anomaly['prior'][-1]= 0.4130131305600363
accuracies_anomaly['prior_star'][-1]= 0.46124387235642234



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.38845682144165 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46138877328944605
 first_prior_anomaly_auc= 0.41302465558001655
 first_prior_star_anomaly_auc= 0.46124387235642234


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46135231231714513; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41265627403228594; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 20 
last prior star auc 0.4612346523404382 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 146


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 147 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.46138877328944605 at iter 0
0.4145215461296259 at iter 20
0.4612447105396937 at iter 10
last anomaly aucs:
0.46123999575879265
0.4096038201040772
0.4612249084599095




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 20.379915475845337 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4612733135438263,first_prior_anomaly_auc= 0.3902484920035221, first_prior_star_anomaly_auc= 0.46125550214931144


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4612733135438263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.39019631509488445 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46125560692222034 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4612733135438263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3901583873018587 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46125560692222034 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4612733135438263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3900924851421538 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46125581646803815 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4612733135438263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3900538239387657 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612559212409471 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4612733135438263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3900083524962984 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612559212409471 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4612733135438263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.38994224079077566 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612559212409471 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4612733135438263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3898479451727559 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46125581646803815 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4612733135438263 at iter 0
max_prior_anomaly= 0.3902484920035221 at iter 0
max_prior_star_anomaly= 0.4612559212409471 at iter 37
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4612733135438263
accuracies_anomaly['prior'][-1]= 0.3897759661843341
accuracies_anomaly['prior_star'][-1]= 0.4612552926034936



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.02254986763 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4612733135438263
 first_prior_anomaly_auc= 0.3897728229970668
 first_prior_star_anomaly_auc= 0.4612552926034936


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 3:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 3 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4715933402986363
accuracies_anomaly["prior"][-1]= 0.41197472625982084
accuracies_anomaly["prior_star"][-1]= 0.46868274888909284


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 523.1976118087769 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003782510757446289 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46258737536738614
 first_prior_anomaly_auc= 0.41256449296408004
 first_prior_star_anomaly_auc= 0.4592206027124449


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5283006295175459; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41251462105943854; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 60 
last prior star auc 0.5010276126905977 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5447849703681259; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4128975660415077; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 110 
last prior star auc 0.5043640012019548 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46117105518472934; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4123822928754841; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 110 
last prior star auc 0.46115628220457283 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46121537412519864; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41183820715951003; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 110 
last prior star auc 0.46116015880220257 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4612248036870006; count_not_improved_vanilla_star_anomaly= 44 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41136442406541524; count_not_improved_prior_anomaly= 47; iter_best_prior_anomaly= 110 
last prior star auc 0.4611574347065709 ; count_not_improved_prior_star_anomaly= 46 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46123989098588375; count_not_improved_vanilla_star_anomaly= 54 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41140811436843094; count_not_improved_prior_anomaly= 57; iter_best_prior_anomaly= 110 
last prior star auc 0.46115251037985205 ; count_not_improved_prior_star_anomaly= 56 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4612943728985174; count_not_improved_vanilla_star_anomaly= 64 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4114642726476072; count_not_improved_prior_anomaly= 67; iter_best_prior_anomaly= 110 
last prior star auc 0.46116351153528773 ; count_not_improved_prior_star_anomaly= 66 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4613449782135213; count_not_improved_vanilla_star_anomaly= 74 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41139302706954783; count_not_improved_prior_anomaly= 77; iter_best_prior_anomaly= 110 
last prior star auc 0.4611803799736224 ; count_not_improved_prior_star_anomaly= 76 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46135660800641043; count_not_improved_vanilla_star_anomaly= 84 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4112931784873558; count_not_improved_prior_anomaly= 87; iter_best_prior_anomaly= 110 
last prior star auc 0.46119798182231936 ; count_not_improved_prior_star_anomaly= 86 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5447849703681259 at iter 200
0.41302999899837095 at iter 110
0.5188177383049336 at iter 50
last anomaly aucs:
0.4613589130104065
0.4113864263762864
0.4612038491052184




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 138.18470001220703 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4613599607394956,first_prior_anomaly_auc= 0.4114026661771676, first_prior_star_anomaly_auc= 0.46120447774267187


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4613599607394956 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44856006400367454 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46124209121697085 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613599607394956 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4246743553218142 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46120709706539464 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4613599607394956 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4270513383062746 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46120720183830355 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4613599607394956 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42897863596568986 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612118118462956 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4613599607394956 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42708696109530436 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612097163881175 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4613599607394956 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42515065296572296 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461206677973759 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4613599607394956 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4259963798864513 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46121003070684413 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4613599607394956 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4265948427421501 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46120961161520846 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4613599607394956 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42674906846406685 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46121160230047786 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4613599607394956 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4279909417533872 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46121055457138865 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4613599607394956 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.423708453874565 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46120856388611936 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4613599607394956 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4257972065866118 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612083543403016 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4613599607394956 at iter 0
max_prior_anomaly= 0.45548220054959676 at iter 9
max_prior_star_anomaly= 0.46125351146404203 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4613599607394956
accuracies_anomaly['prior'][-1]= 0.4253088600581783
accuracies_anomaly['prior_star'][-1]= 0.4612119166192045



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.4577305316925 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4613599607394956
 first_prior_anomaly_auc= 0.4271369377728549
 first_prior_star_anomaly_auc= 0.461212545256658


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 4


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 5 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4613599607394956 at iter 0
0.4271369377728549 at iter 0
0.461212545256658 at iter 0
last anomaly aucs:
0.4613599607394956
0.4271369377728549
0.461212545256658




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 0.7751636505126953 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4625873753673862
accuracies_anomaly["prior"][-1]= 0.41256449296408004
accuracies_anomaly["prior_star"][-1]= 0.45922070748535376


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 264.639333486557 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0033566951751708984 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4649866749814447
 first_prior_anomaly_auc= 0.4128862505673453
 first_prior_star_anomaly_auc= 0.46182358086142605


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4614741632102084; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.41293832270307407; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 70 
last prior star auc 0.45571814914046405 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46130799337667583; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.41890618759463616; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 190 
last prior star auc 0.46121170707338666 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 300


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 301 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5546933443638251 at iter 70
0.42108179704816995 at iter 230
0.528702433623219 at iter 70
last anomaly aucs:
0.46144524588734903
0.4186528467008897
0.4614295299510124




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 41.60843324661255 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46145163703479253,first_prior_anomaly_auc= 0.4597015103643457, first_prior_star_anomaly_auc= 0.4614535229471529


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 29, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 30 iterations

max values 
max_vanilla_star_anomaly= 0.46145163703479253 at iter 0
max_prior_anomaly= 0.4671189084506895 at iter 2
max_prior_star_anomaly= 0.4614537324929707 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46145163703479253
accuracies_anomaly['prior'][-1]= 0.4671189084506895
accuracies_anomaly['prior_star'][-1]= 0.4614537324929707



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 3.1294496059417725 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.46498667498144475
accuracies_anomaly["prior"][-1]= 0.4128862505673453
accuracies_anomaly["prior_star"][-1]= 0.46182358086142605


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 45.00585055351257 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0033872127532958984 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4658947417829751
 first_prior_anomaly_auc= 0.4126034684861949
 first_prior_star_anomaly_auc= 0.46264227637165556


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4610460611043986; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4119721069370981; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4606443617716345 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.461210240252662; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41131874307713; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.46113637535187985 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4610520331602066; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4114452039781854; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.46111720190954913 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4611897047625155; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41144007010564876; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.461157329933662 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4612675510338362; count_not_improved_vanilla_star_anomaly= 47 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41147097811377753; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.46116613085801045 ; count_not_improved_prior_star_anomaly= 47 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4612824287869015; count_not_improved_vanilla_star_anomaly= 57 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4112262285985617; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.461217260037559 ; count_not_improved_prior_star_anomaly= 57 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 669


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 670 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5447015711326328 at iter 30
0.4135336423715054 at iter 620
0.5197149087239372 at iter 30
last anomaly aucs:
0.46135377913786985
0.4072768137971672
0.46133355796645004




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 90.3314254283905 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46135797005422624,first_prior_anomaly_auc= 0.4328636154281042, first_prior_star_anomaly_auc= 0.46135524595859456


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46135797005422624 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43371101871537515 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46135587459604804 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46135797005422624 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4357226585664636 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46135556027732133 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 296, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 297 iterations

max values 
max_vanilla_star_anomaly= 0.46135797005422624 at iter 0
max_prior_anomaly= 0.4384820626684487 at iter 29
max_prior_star_anomaly= 0.4613562936876837 at iter 21
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46135797005422624
accuracies_anomaly['prior'][-1]= 0.4384820626684487
accuracies_anomaly['prior_star'][-1]= 0.46135545550441237



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 26.68564248085022 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4658947417829751
accuracies_anomaly["prior"][-1]= 0.4126034684861949
accuracies_anomaly["prior_star"][-1]= 0.4626423811445644


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 117.29151678085327 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003283977508544922 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4674505147073923
 first_prior_anomaly_auc= 0.4121476015595238
 first_prior_star_anomaly_auc= 0.4641677699253975


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5579100822132061; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4117592083861913; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5289041214728725 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46126692239638273; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41100547207948657; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.46116780722455303 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46132129953610745; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4109366362783322; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 270 
last prior star auc 0.4612692274003788 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 386


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 387 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5579100822132061 at iter 100
0.420994730760865 at iter 340
0.5289041214728725 at iter 100
last anomaly aucs:
0.46140805150468567
0.4130277987672839
0.4613941167078005




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 52.61513018608093 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4615861654498341,first_prior_anomaly_auc= 0.4192812746085369, first_prior_star_anomaly_auc= 0.46159538546581824


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4615861654498341 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4197420658619269 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4615947568283648 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4615861654498341 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4210318203706195 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4615943377367291 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4615861654498341 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42324703398372165 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4615941281909113 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4615861654498341 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4317421262111224 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46159559501163605 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4615861654498341 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45067710540112726 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4615984238801767 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 542, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 543 iterations

max values 
max_vanilla_star_anomaly= 0.4615861654498341 at iter 0
max_prior_anomaly= 0.460382848590993 at iter 54
max_prior_star_anomaly= 0.4616013575216261 at iter 54
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4615861654498341
accuracies_anomaly['prior'][-1]= 0.460382848590993
accuracies_anomaly['prior_star'][-1]= 0.4616013575216261



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 51.11664295196533 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4674506194803012
accuracies_anomaly["prior"][-1]= 0.4121476015595238
accuracies_anomaly["prior_star"][-1]= 0.4641678746983064


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 103.9903929233551 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0033826828002929688 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46996066405907855
 first_prior_anomaly_auc= 0.4128019083756721
 first_prior_star_anomaly_auc= 0.4665533442883887


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.461178494061262; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41229585522563267; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4603677612921098 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46146682910658465; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41279457427204835; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 180 
last prior star auc 0.4612818001494481 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4611095534871987; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41282768251126417; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 180 
last prior star auc 0.46113794694551347 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46101546741499677; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.412791431084781; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 180 
last prior star auc 0.4610872368576006 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4611089248497452; count_not_improved_vanilla_star_anomaly= 47 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4127560178415691; count_not_improved_prior_anomaly= 49; iter_best_prior_anomaly= 180 
last prior star auc 0.46111657327209565 ; count_not_improved_prior_star_anomaly= 47 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4612104497984798; count_not_improved_vanilla_star_anomaly= 57 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41281070930002056; count_not_improved_prior_anomaly= 59; iter_best_prior_anomaly= 180 
last prior star auc 0.4611452810491372 ; count_not_improved_prior_star_anomaly= 57 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46128494333671544; count_not_improved_vanilla_star_anomaly= 67 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41295676273504234; count_not_improved_prior_anomaly= 69; iter_best_prior_anomaly= 180 
last prior star auc 0.46116749290582637 ; count_not_improved_prior_star_anomaly= 67 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4613231854484679; count_not_improved_vanilla_star_anomaly= 77 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41305378244869373; count_not_improved_prior_anomaly= 79; iter_best_prior_anomaly= 180 
last prior star auc 0.46118446611706987 ; count_not_improved_prior_star_anomaly= 77 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4613457116238837; count_not_improved_vanilla_star_anomaly= 87 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4128233868219988; count_not_improved_prior_anomaly= 89; iter_best_prior_anomaly= 180 
last prior star auc 0.4611935813601452 ; count_not_improved_prior_star_anomaly= 87 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.545124539365906 at iter 30
0.413209789310062 at iter 960
0.5207402164105388 at iter 30
last anomaly aucs:
0.46135262663587184
0.41281070930002056
0.4611982961410462




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 137.75312089920044 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46135356959205204,first_prior_anomaly_auc= 0.4128394170770622, first_prior_star_anomaly_auc= 0.4612002868263154


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46135356959205204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4128357500252503 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46120081069085994 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46135356959205204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4128584857464839 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612003915992243 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46135356959205204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4128742016828205 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611998677346798 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46135356959205204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.412894841945876 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611998677346798 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46135356959205204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4129201969898324 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46120091546376896 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46135356959205204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4129601154681275 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612009154637689 iter_best_prior_star_anomaly= 510
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46135356959205204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4130139687433076 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46120070591795104 iter_best_prior_star_anomaly= 650
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46135356959205204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4130908720584482 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46120070591795104 iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46135356959205204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41317280447321647 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46120102023667775 iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46135356959205204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41325494643380256 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612010202366778 iter_best_prior_star_anomaly= 970
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.46135356959205204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4133701966336045 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612023822844937 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.46135356959205204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4134705690803411 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612022775115847 iter_best_prior_star_anomaly= 1170
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.46135356959205204 at iter 0
max_prior_anomaly= 0.41359577270648956 at iter 129
max_prior_star_anomaly= 0.46120301092194715 at iter 127
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46135356959205204
accuracies_anomaly['prior'][-1]= 0.41359577270648956
accuracies_anomaly['prior_star'][-1]= 0.4612025918303115



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.29473209381104 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46135356959205204
 first_prior_anomaly_auc= 0.41360572613283614
 first_prior_star_anomaly_auc= 0.46120269660322044


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4613667709785748; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4140855860556478; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 60 
last prior star auc 0.4612119166192045 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46133104341663617; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41333897430674904; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 60 
last prior star auc 0.4611962006828679 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 286


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 287 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4613976789867035 at iter 140
0.41418952078128735 at iter 60
0.4612246989140917 at iter 140
last anomaly aucs:
0.4612016488741313
0.4134572629209094
0.46114192831605205




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 39.623013496398926 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46106900637145015,first_prior_anomaly_auc= 0.3955190931862824, first_prior_star_anomaly_auc= 0.4610677490965432


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46106900637145015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.39559253899542896 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610674347778165 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46106900637145015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.39564932591205865 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610674347778165 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46106900637145015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.39571837125903087 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46106722523199867 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46106900637145015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.395792340932722 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610674347778165 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46106900637145015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.39586547242314174 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46106722523199867 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46106900637145015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.39596458759497144 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46106722523199867 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46106900637145015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3960531207030011 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46106733000490757 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46106900637145015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3961788481936941 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46106733000490757 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46106900637145015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.396326997086894 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46106722523199867 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46106900637145015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3964507338923178 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46106701568618086 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.46106900637145015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.39659081527153156 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610675395507254 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.46106900637145015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.39675384191779683 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46106722523199867 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.46106900637145015 at iter 0
max_prior_anomaly= 0.39689989535281855 at iter 129
max_prior_star_anomaly= 0.4610677490965432 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46106900637145015
accuracies_anomaly['prior'][-1]= 0.39689989535281855
accuracies_anomaly['prior_star'][-1]= 0.4610669109132719



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.0177071094513 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46106900637145015
 first_prior_anomaly_auc= 0.39690869627716713
 first_prior_star_anomaly_auc= 0.4610669109132719


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 2:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4699606640590785
accuracies_anomaly["prior"][-1]= 0.4128019083756721
accuracies_anomaly["prior_star"][-1]= 0.4665532395154798


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 422.03703141212463 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003582000732421875 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4641395860129005
 first_prior_anomaly_auc= 0.4119776599012704
 first_prior_star_anomaly_auc= 0.460669507269773


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46127614241236686; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.41135708996179143; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4610653393196383 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4611814277027115; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4103473934386175; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.46113302261879463 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.461267760579654; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4102049022824988; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4611678072245531 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46112107850717876; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.40967485613631877; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4611356419415174 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46111259190155707; count_not_improved_vanilla_star_anomaly= 46 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4097107932440753; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.46113092716061643 ; count_not_improved_prior_star_anomaly= 47 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4610977141484917; count_not_improved_vanilla_star_anomaly= 56 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4094647864539525; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.46112673624426 ; count_not_improved_prior_star_anomaly= 57 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.461096247327767; count_not_improved_vanilla_star_anomaly= 66 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.40938044426227926; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.4611222310091768 ; count_not_improved_prior_star_anomaly= 67 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4610941518695888; count_not_improved_vanilla_star_anomaly= 76 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.40923281923362387; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.461124431240264 ; count_not_improved_prior_star_anomaly= 77 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4611011716544858; count_not_improved_vanilla_star_anomaly= 86 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4092952638873348; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.46112537419644417 ; count_not_improved_prior_star_anomaly= 87 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.547933396280897 at iter 70
0.4119776599012704 at iter 0
0.5188006603207811 at iter 30
last anomaly aucs:
0.46109802846721837
0.4092840531860813
0.4611250598777174




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 137.79702639579773 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46110305756684616,first_prior_anomaly_auc= 0.40929033956061595, first_prior_star_anomaly_auc= 0.4611258980609887


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46110305756684616 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40930238844514066 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611256885151709 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46110305756684616 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40932522893928325 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611256885151709 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46110305756684616 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4093617946844932 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611254789693531 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46110305756684616 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40941208568077037 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611252694235353 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46110305756684616 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.409459547808507 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611254789693531 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46110305756684616 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4095348795300139 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46112505987771746 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46110305756684616 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4096021437375347 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611248503318996 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46110305756684616 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4096825045586693 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611244312402639 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46110305756684616 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4097727140332415 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461124326467355 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46110305756684616 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4098719339779801 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46112411692153726 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.46110305756684616 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4099912703212295 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611236978299016 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.46110305756684616 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41009751005086514 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611235930569927 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.46110305756684616 at iter 0
max_prior_anomaly= 0.41020563569286117 at iter 129
max_prior_star_anomaly= 0.4611261076068065 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46110305756684616
accuracies_anomaly['prior'][-1]= 0.41020563569286117
accuracies_anomaly['prior_star'][-1]= 0.4611238026028105



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.33990836143494 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46110305756684616
 first_prior_anomaly_auc= 0.41021003615503543
 first_prior_star_anomaly_auc= 0.46112369782990154


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4611050482521154; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41141848688641325; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 60 
last prior star auc 0.46112841261080256 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46108922754286996; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4109999191153143; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 60 
last prior star auc 0.46112254532790353 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4610982380130363; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4104658915985957; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 60 
last prior star auc 0.46112254532790353 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4611036862042996; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4104231442517601; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 60 
last prior star auc 0.46112275487372134 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4610968759652205; count_not_improved_vanilla_star_anomaly= 49 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4107730857675223; count_not_improved_prior_anomaly= 47; iter_best_prior_anomaly= 60 
last prior star auc 0.4611194021406363 ; count_not_improved_prior_star_anomaly= 47 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4610900657261412; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41093820787196583; count_not_improved_prior_anomaly= 57; iter_best_prior_anomaly= 60 
last prior star auc 0.46111772577409366 ; count_not_improved_prior_star_anomaly= 57 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4610742450168957; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4111516302874172; count_not_improved_prior_anomaly= 67; iter_best_prior_anomaly= 60 
last prior star auc 0.4611129062202838 ; count_not_improved_prior_star_anomaly= 67 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46108870367832533; count_not_improved_vanilla_star_anomaly= 79 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4107832487396867; count_not_improved_prior_anomaly= 77; iter_best_prior_anomaly= 60 
last prior star auc 0.46109781892140056 ; count_not_improved_prior_star_anomaly= 77 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4613483309466065; count_not_improved_vanilla_star_anomaly= 86 ;iter_best_vanilla_star_anomaly= 900 
last prior auc 0.4161447928073817; count_not_improved_prior_anomaly= 86; iter_best_prior_anomaly= 900 
last prior star auc 0.46128148583072137 ; count_not_improved_prior_star_anomaly= 85 ; iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 932


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 933 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4613660375682124 at iter 920
0.4161447928073817 at iter 900
0.46132108999028965 at iter 930
last anomaly aucs:
0.46132999568754707
0.4094059040791447
0.46132108999028965




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 127.43229579925537 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4614423122458995,first_prior_anomaly_auc= 0.47873235676600395, first_prior_star_anomaly_auc= 0.4614424170188084


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4614423122458995 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47871318332367324 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4614421027000817 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4614423122458995 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47875844522032274 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4614422074729906 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4614423122458995 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4788933927269999 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4614424170188084 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4614423122458995 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4790655346163405 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46144178838135497 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4614423122458995 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4792573738125562 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4614422074729906 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4614423122458995 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4795047426504947 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4614424170188084 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4614423122458995 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47977379948057786 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4614419979271728 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4614423122458995 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4800088051152649 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4614422074729906 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4614423122458995 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.480310655865837 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46144252179171735 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4614423122458995 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48064320507872005 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46144283611044407 iter_best_prior_star_anomaly= 960
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4614423122458995 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4809501897018289 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4614423122458995 iter_best_prior_star_anomaly= 1080
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4614423122458995 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48129049210997127 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46144262656462626 iter_best_prior_star_anomaly= 1080
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4614423122458995 at iter 0
max_prior_anomaly= 0.4815969528685356 at iter 129
max_prior_star_anomaly= 0.46144294088335297 at iter 108
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4614423122458995
accuracies_anomaly['prior'][-1]= 0.4815969528685356
accuracies_anomaly['prior_star'][-1]= 0.46144294088335297



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.39811301231384 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4614423122458995
 first_prior_anomaly_auc= 0.4816237747332167
 first_prior_star_anomaly_auc= 0.4614422074729906


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 2:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4641395860129005
accuracies_anomaly["prior"][-1]= 0.4119776599012704
accuracies_anomaly["prior_star"][-1]= 0.4606694024968641


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 508.31358551979065 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0035734176635742188 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46073698102311167
 first_prior_anomaly_auc= 0.41238847447710986
 first_prior_star_anomaly_auc= 0.4575783921381762


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4827336341573094; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4123784162778544; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4704540396871397 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5295183002649078; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41239800881182076; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 170 
last prior star auc 0.5109152416503325 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5419649027518814; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41240838132980284; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 300 
last prior star auc 0.5187222901849158 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5448748655239715; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.41241236270034154; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 340 
last prior star auc 0.5183999039441971 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5431077656422809; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4124078574652583; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 340 
last prior star auc 0.5170534672917838 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5468915344746875; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 600 
last prior auc 0.4123937131225554; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 340 
last prior star auc 0.5206922304182576 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5545762082516629; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4123880553854742; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 340 
last prior star auc 0.5280011885438787 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5582377070993703; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 800 
last prior auc 0.4123870076563851; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 340 
last prior star auc 0.5309907787267409 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.55704298161906; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 810 
last prior auc 0.4123838644691178; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 340 
last prior star auc 0.5290298489635654 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5582920842390952 at iter 810
0.4124215827163257 at iter 340
0.5309907787267409 at iter 800
last anomaly aucs:
0.5553884078415398
0.4123836549232999
0.5268605258845662




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 136.1502730846405 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.555312971347124,first_prior_anomaly_auc= 0.4123841787878445, first_prior_star_anomaly_auc= 0.5267153106328158


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5553133904387596 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4335146742840762 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.516629975193966 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.555312971347124 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4304625346745942 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5152238179834735 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5553129713471239 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4327280392839736 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5153711286934022 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.555312971347124 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4315574115727126 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5152478109796141 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5553130761200329 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4336095985395495 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5156838758265011 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5553129713471239 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4327858739296923 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5157331190936891 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.555312971347124 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.43256532695643507 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5159283110229901 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5553133904387596 at iter 5
max_prior_anomaly= 0.45641457466599444 at iter 6
max_prior_star_anomaly= 0.5267153106328158 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.555312971347124
accuracies_anomaly['prior'][-1]= 0.43131297637622357
accuracies_anomaly['prior_star'][-1]= 0.5159950513659664



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.3180181980133 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.555312971347124
 first_prior_anomaly_auc= 0.43289274229678143
 first_prior_star_anomaly_auc= 0.5162242944906632


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5556697231019654; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42741940553527846; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.514133865412074 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5576803152239647; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.42708580859330636; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5150596388352102 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5611377164451139; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4266097204952154; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5173324775482133 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5656115196556073; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.42637880100397596; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5205421956126972 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5704425984854866; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 500 
last prior auc 0.42589600743971473; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.5240531357903 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5751900685340552; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 600 
last prior auc 0.4255714209679089; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.5273751704131363 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5791706008893963; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 700 
last prior auc 0.42523593811357635; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.5298644699559493 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5817230784962825; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 800 
last prior auc 0.4248775099921923; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.5312753419473428 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5822972340371139; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 870 
last prior auc 0.4246925858079647; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.5311408135323012 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 840
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.582388805559502 at iter 870
0.43289274229678143 at iter 0
0.5314430833745092 at iter 840
last anomaly aucs:
0.5803314847201284
0.42465591528984586
0.5293634459055376




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 136.60914850234985 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5799846863916336,first_prior_anomaly_auc= 0.42443966400585387, first_prior_star_anomaly_auc= 0.5290851690594705


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5799846863916336 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4219111793951083 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.531487821406614 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5799848959374514 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4202317744381763 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5302175546589789 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5799846863916336 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4171495650038368 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5324599044554889 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5799848959374514 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41489401382080393 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5303432821496719 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5799846863916336 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.42340702221562854 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5306873563825352 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5799847911645426 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4190511933005687 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5299631660361434 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5799848959374514 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4194030207286914 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5302422810654819 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5799848959374515 at iter 6
max_prior_anomaly= 0.44367073143644076 at iter 41
max_prior_star_anomaly= 0.5385629263995461 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5799848959374515
accuracies_anomaly['prior'][-1]= 0.41856410404704225
accuracies_anomaly['prior_star'][-1]= 0.5306435613066104



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.10354089736938 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5799848959374514
 first_prior_anomaly_auc= 0.4111314091159975
 first_prior_star_anomaly_auc= 0.5296111290622028


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.574503910753598; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4163155726489064; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.5262546241523347 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5707896063597994; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4176049080659634; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.5238597250004505 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5688691189394635; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4184837432259076; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.5224310416145421 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5672283751859195; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41876139143452135; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.5211111125080832 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.56579885361674; count_not_improved_vanilla_star_anomaly= 50 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41938709524653695; count_not_improved_prior_anomaly= 48; iter_best_prior_anomaly= 20 
last prior star auc 0.5200206360721391 ; count_not_improved_prior_star_anomaly= 49 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5644544076495959; count_not_improved_vanilla_star_anomaly= 60 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41743098503717135; count_not_improved_prior_anomaly= 58; iter_best_prior_anomaly= 20 
last prior star auc 0.5184146769243535 ; count_not_improved_prior_star_anomaly= 59 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5628077966131528; count_not_improved_vanilla_star_anomaly= 70 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41839510534496904; count_not_improved_prior_anomaly= 68; iter_best_prior_anomaly= 20 
last prior star auc 0.5172609176514272 ; count_not_improved_prior_star_anomaly= 69 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5610662613212366; count_not_improved_vanilla_star_anomaly= 80 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41774519899099494; count_not_improved_prior_anomaly= 78; iter_best_prior_anomaly= 20 
last prior star auc 0.5156983344879308 ; count_not_improved_prior_star_anomaly= 79 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5593714547466948; count_not_improved_vanilla_star_anomaly= 90 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4167338261012785; count_not_improved_prior_anomaly= 88; iter_best_prior_anomaly= 20 
last prior star auc 0.5142256464802798 ; count_not_improved_prior_star_anomaly= 89 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5799848959374514 at iter 0
0.42054619793781767 at iter 20
0.5308235611641192 at iter 10
last anomaly aucs:
0.5579920146279744
0.41545853025401563
0.5127591400742546




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 137.31879949569702 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5578887085397883,first_prior_anomaly_auc= 0.41739525747523276, first_prior_star_anomaly_auc= 0.5131831560366168


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5578884989939705 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42256653394034566 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5148689521409925 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5578884989939705 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4043567928258217 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5134535749145157 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5578887085397883 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4169089016320685 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5139964033555829 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5578884989939705 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41847745685137294 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5139292439209711 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5578887085397883 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41884080929947576 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5143972645050758 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5578887085397883 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4163784363942529 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5142505824326007 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5578887085397883 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4204444634432653 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5150389985721548 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5578887085397883 at iter 0
max_prior_anomaly= 0.43551835139408734 at iter 66
max_prior_star_anomaly= 0.519997166940543 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5578884989939705
accuracies_anomaly['prior'][-1]= 0.4161885878833065
accuracies_anomaly['prior_star'][-1]= 0.5144633762105986



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.05323719978333 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5578884989939705
 first_prior_anomaly_auc= 0.41740384885376336
 first_prior_star_anomaly_auc= 0.5146464144824658


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5565532730428107; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42392219060874314; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 90 
last prior star auc 0.5147034109449133 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5554213065349377; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4241756362753985; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 200 
last prior star auc 0.5139239005026166 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5546288042519361; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42256318120726055; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 230 
last prior star auc 0.5129365206090407 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5539709351568849; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42183773358596177; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 230 
last prior star auc 0.5124293149570033 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5538038223671721; count_not_improved_vanilla_star_anomaly= 49 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4227232742120763; count_not_improved_prior_anomaly= 45; iter_best_prior_anomaly= 230 
last prior star auc 0.5122684885418252 ; count_not_improved_prior_star_anomaly= 49 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5534915990986177; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4224324246169398; count_not_improved_prior_anomaly= 55; iter_best_prior_anomaly= 230 
last prior star auc 0.5119193852093342 ; count_not_improved_prior_star_anomaly= 59 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5533481649863188; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4224625992147061; count_not_improved_prior_anomaly= 65; iter_best_prior_anomaly= 230 
last prior star auc 0.5118317950574848 ; count_not_improved_prior_star_anomaly= 69 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.553011739175806; count_not_improved_vanilla_star_anomaly= 79 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42319318070854145; count_not_improved_prior_anomaly= 75; iter_best_prior_anomaly= 230 
last prior star auc 0.5118217368582293 ; count_not_improved_prior_star_anomaly= 79 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5528289104497566; count_not_improved_vanilla_star_anomaly= 89 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4214439969942748; count_not_improved_prior_anomaly= 85; iter_best_prior_anomaly= 230 
last prior star auc 0.5115478604743363 ; count_not_improved_prior_star_anomaly= 89 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5580003964606873 at iter 10
0.4252573117869942 at iter 230
0.5159732586009128 at iter 10
last anomaly aucs:
0.5526940677159884
0.4218641363590073
0.5112639258911879




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 137.97234535217285 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5529348358606654,first_prior_anomaly_auc= 0.4243589888659925, first_prior_star_anomaly_auc= 0.5119606657354451


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5529350454064833 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42287854766308214 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5141135394677452 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5529351501793922 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4191987135563152 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5122779181036271 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5529348358606655 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41852942421419265 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.511907860189354 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5529347310877565 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42059617461536825 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5121138437282727 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5529350454064833 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4219370583036093 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5125941227427201 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5529344167690298 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4237850428709789 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5127890003532943 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5529350454064832 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4255759262029921 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5133541454239594 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5529352549523011 at iter 1
max_prior_anomaly= 0.4255759262029921 at iter 70
max_prior_star_anomaly= 0.5158331772216991 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5529348358606654
accuracies_anomaly['prior'][-1]= 0.4239545654375967
accuracies_anomaly['prior_star'][-1]= 0.513380443424096



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.53924441337585 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.552935254952301
 first_prior_anomaly_auc= 0.42400820916695897
 first_prior_star_anomaly_auc= 0.513195938331504


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5528084797325189; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41445962534045955; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5086403074791512 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5526488058193387; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41687893658012004; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5093761276184321 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5521915768448519; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4190123225513628; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.509722925946927 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5524000749335845; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4158179013315798; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5082135674211573 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5523041029490221; count_not_improved_vanilla_star_anomaly= 49 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.414388589308218; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.5080566176036089 ; count_not_improved_prior_star_anomaly= 50 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5523126943275528; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41170849829827844; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.5069707511756568 ; count_not_improved_prior_star_anomaly= 60 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.552875429621313; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4134634445225352; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.5073746507395082 ; count_not_improved_prior_star_anomaly= 70 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5528101560990616; count_not_improved_vanilla_star_anomaly= 79 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4126443299206702; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.5066631379150945 ; count_not_improved_prior_star_anomaly= 80 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5532831010098851; count_not_improved_vanilla_star_anomaly= 89 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4167352929220033; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.5077337074983457 ; count_not_improved_prior_star_anomaly= 90 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5536288516092909 at iter 940
0.42400820916695897 at iter 0
0.513195938331504 at iter 0
last anomaly aucs:
0.5533065701414812
0.4125294988125038
0.505715362181087




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 137.80602312088013 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5535988865573425,first_prior_anomaly_auc= 0.41486844923102967, first_prior_star_anomaly_auc= 0.5063926142642867


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5535990961031603 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.41460002103840016 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5114171038840156 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5535989913302513 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4163178776529024 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5101516566901902 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5535990961031603 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4182383650732384 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5099478733823587 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.553599410421887 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41645994971738554 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5092221114423332 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5535988865573425 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.417667562265492 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5095022742007609 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5535990961031603 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4172354787891437 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5094348004474223 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.553599410421887 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41643564240251824 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5095800156991727 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5535995151947959 at iter 14
max_prior_anomaly= 0.42366057265519275 at iter 79
max_prior_star_anomaly= 0.5141803845836304 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5535988865573425
accuracies_anomaly['prior'][-1]= 0.42366057265519275
accuracies_anomaly['prior_star'][-1]= 0.5113200841703641



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.09499311447144 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5535993056489781
 first_prior_anomaly_auc= 0.4178852803702088
 first_prior_star_anomaly_auc= 0.5103256844918912


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5569921667582381; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4318309736378788; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.5142363333169888 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5571307813167272; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4309630348604614; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.5135255539029375 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5570670793881094; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4281375190529535; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.5112104917076433 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.557175833667559; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4275002902209577; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.5092879088291292 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5577833069934239; count_not_improved_vanilla_star_anomaly= 46 ;iter_best_vanilla_star_anomaly= 440 
last prior auc 0.42686955730931436; count_not_improved_prior_anomaly= 48; iter_best_prior_anomaly= 20 
last prior star auc 0.5073680500462467 ; count_not_improved_prior_star_anomaly= 48 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5582156000155902; count_not_improved_vanilla_star_anomaly= 54 ;iter_best_vanilla_star_anomaly= 540 
last prior auc 0.42595646140815635; count_not_improved_prior_anomaly= 58; iter_best_prior_anomaly= 20 
last prior star auc 0.5045586692667111 ; count_not_improved_prior_star_anomaly= 58 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5592336783714769; count_not_improved_vanilla_star_anomaly= 60 ;iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4273906977582369; count_not_improved_prior_anomaly= 68; iter_best_prior_anomaly= 20 
last prior star auc 0.5018100567743439 ; count_not_improved_prior_star_anomaly= 68 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5588542956683107; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 790 
last prior auc 0.42376775534100863; count_not_improved_prior_anomaly= 78; iter_best_prior_anomaly= 20 
last prior star auc 0.49537071379268294 ; count_not_improved_prior_star_anomaly= 78 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5595711519110788; count_not_improved_vanilla_star_anomaly= 76 ;iter_best_vanilla_star_anomaly= 870 
last prior auc 0.42478080459726764; count_not_improved_prior_anomaly= 88; iter_best_prior_anomaly= 20 
last prior star auc 0.48918366397567925 ; count_not_improved_prior_star_anomaly= 88 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5605444922348606 at iter 950
0.4412642024916674 at iter 20
0.5172058071013401 at iter 20
last anomaly aucs:
0.5602978568072845
0.4247142738001092
0.48135985177567026




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 137.82926869392395 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5597734683981856,first_prior_anomaly_auc= 0.4235381978975849, first_prior_star_anomaly_auc= 0.4800663254422569


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5597737827169125 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4162219056683401 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48635636702872 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5597733636252767 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41982420782251306 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4827730287710599 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5597735731710946 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.42191778008836966 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48097051564615756 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5597737827169124 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4230069992494069 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48045775702994786 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5597739922627302 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4234026217534543 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48037687234426873 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5597732588523678 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4254389880110456 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4815834371632861 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5597732588523678 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.42153787352065897 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4791183401624316 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5597745161272747 at iter 59
max_prior_anomaly= 0.42901886876271156 at iter 59
max_prior_star_anomaly= 0.49264651338809184 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5597738874898213
accuracies_anomaly['prior'][-1]= 0.4235090710289077
accuracies_anomaly['prior_star'][-1]= 0.4806723319473973



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.2025785446167 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5597737827169125
 first_prior_anomaly_auc= 0.42295398415749796
 first_prior_star_anomaly_auc= 0.4800935663985737


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.565144232481865; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4312794490453721; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 100 
last prior star auc 0.4757002287821239 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5629836055543053; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.43232906404684107; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 150 
last prior star auc 0.46323141443846116 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5551143219118291; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4285000333177851; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 150 
last prior star auc 0.45189037568631496 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5260056837207625; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.42742757782217355; count_not_improved_prior_anomaly= 32; iter_best_prior_anomaly= 150 
last prior star auc 0.44476099832656707 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46132349976719467; count_not_improved_vanilla_star_anomaly= 48 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.43038217385345956; count_not_improved_prior_anomaly= 42; iter_best_prior_anomaly= 150 
last prior star auc 0.43390191495541075 ; count_not_improved_prior_star_anomaly= 48 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.45156034102324577; count_not_improved_vanilla_star_anomaly= 58 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4239723768321114; count_not_improved_prior_anomaly= 52; iter_best_prior_anomaly= 150 
last prior star auc 0.4022382846076443 ; count_not_improved_prior_star_anomaly= 58 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.45459728856093573; count_not_improved_vanilla_star_anomaly= 68 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4286500681233454; count_not_improved_prior_anomaly= 62; iter_best_prior_anomaly= 150 
last prior star auc 0.39899619171430684 ; count_not_improved_prior_star_anomaly= 68 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4511100270607469; count_not_improved_vanilla_star_anomaly= 78 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4258749480850236; count_not_improved_prior_anomaly= 72; iter_best_prior_anomaly= 150 
last prior star auc 0.3973583816022125 ; count_not_improved_prior_star_anomaly= 78 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4484257451344509; count_not_improved_vanilla_star_anomaly= 88 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4267155411332154; count_not_improved_prior_anomaly= 82; iter_best_prior_anomaly= 150 
last prior star auc 0.3976270193406599 ; count_not_improved_prior_star_anomaly= 88 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5653208796062885 at iter 90
0.4372303407256907 at iter 150
0.482640176722561 at iter 20
last anomaly aucs:
0.4469277020828435
0.42713169912740934
0.39865662271652685




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 137.8608193397522 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.446387702510317,first_prior_anomaly_auc= 0.42820813599355945, first_prior_star_anomaly_auc= 0.39859805466044573


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44638749296449914 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41993212391869117 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39426276123553244 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4463879120561348 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4262092784373582 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39693048904222056 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4463879120561348 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4256139587689267 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3963544475890287 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.446387702510317 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.42674781118915994 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3969466240701929 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.446387702510317 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4267188938663006 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3970296042140502 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44638833114777043 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4274870888344349 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3974472290289689 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4463879120561348 iter_best_vanilla_star_anomaly= 620 
last prior auc 0.4296892058339232 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3986651093221486 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.44638854069358824 at iter 62
max_prior_anomaly= 0.4296892058339232 at iter 70
max_prior_star_anomaly= 0.3986651093221486 at iter 70
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4463879120561348
accuracies_anomaly['prior'][-1]= 0.4282888111334207
accuracies_anomaly['prior_star'][-1]= 0.39811211790891715



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.38043284416199 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.446387702510317
 first_prior_anomaly_auc= 0.42809980080574556
 first_prior_star_anomaly_auc= 0.397911373015444


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4472133130325345; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42340314561799886; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4008665976841834 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4433597654427933; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41785426758917116; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.39706962746525415 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4422051679865958; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4201651388681089; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.398631791537115 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4402125968049292; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4186492844219867; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.39973630754285316 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4397907810736541; count_not_improved_vanilla_star_anomaly= 49 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41205424889768416; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.3983009186907745 ; count_not_improved_prior_star_anomaly= 49 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4392926906646919; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4161439546241104; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.4012270164908368 ; count_not_improved_prior_star_anomaly= 59 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43883577600893164; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41238480742529793; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.40097807605926455 ; count_not_improved_prior_star_anomaly= 69 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4381468941328428; count_not_improved_vanilla_star_anomaly= 79 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41227531973548615; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.4012882038696407 ; count_not_improved_prior_star_anomaly= 79 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4380629710328052; count_not_improved_vanilla_star_anomaly= 89 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4110522007968609; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.4028059442281233 ; count_not_improved_prior_star_anomaly= 86 ; iter_best_prior_star_anomaly= 880
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.45207372827690895 at iter 10
0.42809980080574556 at iter 0
0.406433182334617 at iter 980
last anomaly aucs:
0.4384478019272348
0.4110008620714945
0.40489228716326514




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 137.85975122451782 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4382638206991873,first_prior_anomaly_auc= 0.41468153436153277, first_prior_star_anomaly_auc= 0.4057203074623875


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43826382069918735 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41536381554436025 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4040860596291961 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4382638206991873 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4161437450782926 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40406646709522975 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4382638206991873 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41646487404410437 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4041397033585585 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4382638206991873 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.415938809268463 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.404311845247899 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4382638206991873 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41519743616500976 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4042680501719743 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43826382069918735 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4149308938847405 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4042819849688595 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4382638206991873 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41905140284638653 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40541646602654613 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43826382069918735 at iter 6
max_prior_anomaly= 0.4193381662980756 at iter 21
max_prior_star_anomaly= 0.4077769996643076 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4382638206991873
accuracies_anomaly['prior'][-1]= 0.4153196013767998
accuracies_anomaly['prior_star'][-1]= 0.4046205062375503



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.38663172721863 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4382638206991873
 first_prior_anomaly_auc= 0.4149981580922613
 first_prior_star_anomaly_auc= 0.40442898136006133


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4380523889690052; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41813862126395523; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 100 
last prior star auc 0.40871775561341817 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.438407569130213; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41708240556922493; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 110 
last prior star auc 0.4089644958139032 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4383369521896071; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4173940002003258; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 110 
last prior star auc 0.41022868573282156 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4384111314091159; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4171223240475199; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 110 
last prior star auc 0.41141618188241713 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4386866841595515; count_not_improved_vanilla_star_anomaly= 42 ;iter_best_vanilla_star_anomaly= 490 
last prior auc 0.41322854366075706; count_not_improved_prior_anomaly= 46; iter_best_prior_anomaly= 490 
last prior star auc 0.4116891153101299 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43913836016986624; count_not_improved_vanilla_star_anomaly= 51 ;iter_best_vanilla_star_anomaly= 600 
last prior auc 0.4158826509892868; count_not_improved_prior_anomaly= 56; iter_best_prior_anomaly= 490 
last prior star auc 0.41388347911435885 ; count_not_improved_prior_star_anomaly= 42 ; iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4390969748708464; count_not_improved_vanilla_star_anomaly= 61 ;iter_best_vanilla_star_anomaly= 600 
last prior auc 0.41633547950159944; count_not_improved_prior_anomaly= 65; iter_best_prior_anomaly= 620 
last prior star auc 0.4145977160344041 ; count_not_improved_prior_star_anomaly= 49 ; iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4392022716443018; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 750 
last prior auc 0.41709277808720713; count_not_improved_prior_anomaly= 75; iter_best_prior_anomaly= 620 
last prior star auc 0.41550022987176216 ; count_not_improved_prior_star_anomaly= 55 ; iter_best_prior_star_anomaly= 780
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43950244602833144; count_not_improved_vanilla_star_anomaly= 78 ;iter_best_vanilla_star_anomaly= 840 
last prior auc 0.41144007010564887; count_not_improved_prior_anomaly= 84; iter_best_prior_anomaly= 860 
last prior star auc 0.41591324467868873 ; count_not_improved_prior_star_anomaly= 62 ; iter_best_prior_star_anomaly= 860
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43980565882671946 at iter 990
0.42097168072090463 at iter 860
0.41756153208167424 at iter 990
last anomaly aucs:
0.43980565882671946
0.41791880770106027
0.41756153208167424




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 136.71767711639404 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4397712933125967,first_prior_anomaly_auc= 0.41686552564777946, first_prior_star_anomaly_auc= 0.41767112454439503


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4397712933125967 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42005732754483965 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4169804615288546 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4397712933125967 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4238667657399293 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41745141575440897 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4397712933125967 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4289225824594225 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4183487957192304 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4397712933125967 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4257222939567405 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41768977412218117 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4397712933125967 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42697097748514 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4177532665049811 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4397712933125967 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4273125371681894 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4181792731526126 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4397712933125967 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4279436891714684 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41804736406029386 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4397712933125967 at iter 0
max_prior_anomaly= 0.4313752114841166 at iter 75
max_prior_star_anomaly= 0.4211854174550828 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4397712933125967
accuracies_anomaly['prior'][-1]= 0.42774891633380313
accuracies_anomaly['prior_star'][-1]= 0.41818639771041854



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.01389980316162 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4397712933125967
 first_prior_anomaly_auc= 0.4266128636824828
 first_prior_star_anomaly_auc= 0.41787124080041477


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4408707802187071; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.43012128931027155; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 30 
last prior star auc 0.42152718668395006 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44078486643340026; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.42720168743056175; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 170 
last prior star auc 0.42175391525883305 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44097932495233877; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.43469965588385795; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 220 
last prior star auc 0.4233469873388226 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.441023748665717; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.43415127447861857; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 220 
last prior star auc 0.423386486725482 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4409639233347289; count_not_improved_vanilla_star_anomaly= 46 ;iter_best_vanilla_star_anomaly= 440 
last prior auc 0.42242006141368826; count_not_improved_prior_anomaly= 47; iter_best_prior_anomaly= 220 
last prior star auc 0.4226617725145456 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4414304770981089; count_not_improved_vanilla_star_anomaly= 54 ;iter_best_vanilla_star_anomaly= 590 
last prior auc 0.42661244459084713; count_not_improved_prior_anomaly= 57; iter_best_prior_anomaly= 220 
last prior star auc 0.4238203513412818 ; count_not_improved_prior_star_anomaly= 47 ; iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44160387626235637; count_not_improved_vanilla_star_anomaly= 63 ;iter_best_vanilla_star_anomaly= 670 
last prior auc 0.4319637209134689; count_not_improved_prior_anomaly= 67; iter_best_prior_anomaly= 220 
last prior star auc 0.42534490193884367 ; count_not_improved_prior_star_anomaly= 55 ; iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44175359674919; count_not_improved_vanilla_star_anomaly= 71 ;iter_best_vanilla_star_anomaly= 740 
last prior auc 0.4233284425339454; count_not_improved_prior_anomaly= 77; iter_best_prior_anomaly= 220 
last prior star auc 0.42472799905117653 ; count_not_improved_prior_star_anomaly= 64 ; iter_best_prior_star_anomaly= 740
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4422890910866334; count_not_improved_vanilla_star_anomaly= 78 ;iter_best_vanilla_star_anomaly= 900 
last prior auc 0.42937080096374314; count_not_improved_prior_anomaly= 87; iter_best_prior_anomaly= 220 
last prior star auc 0.426312898844271 ; count_not_improved_prior_star_anomaly= 71 ; iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44251340988461146 at iter 970
0.4369893630351957 at iter 220
0.42676174598604505 at iter 960
last anomaly aucs:
0.4423754239635759
0.42808618032758716
0.42641693834281946




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 136.29631400108337 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44237605260102936,first_prior_anomaly_auc= 0.42667593697364714, first_prior_star_anomaly_auc= 0.4266036436664986


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4423763669197561 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42507626420039624 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42557917416316826 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4423763669197561 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.42561458740638014 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4254379402819565 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4423759478281205 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4263264145495205 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4256401519961544 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44237615737393826 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4269259251343084 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.425554866848301 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4423762621468472 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.42913328077924223 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42581533229985336 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4423759478281205 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.42929106878006196 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4259422122925444 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44237615737393826 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.43181923907208086 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42631698498771853 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.44237657646557393 at iter 16
max_prior_anomaly= 0.43181923907208086 at iter 70
max_prior_star_anomaly= 0.42829300204977716 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44237594782812045
accuracies_anomaly['prior'][-1]= 0.4314236165680334
accuracies_anomaly['prior_star'][-1]= 0.426398707856669



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.57790541648865 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.44237594782812045
 first_prior_anomaly_auc= 0.4292497882539511
 first_prior_star_anomaly_auc= 0.4258668805710375


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44289645963958957; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4350166987062222; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 60 
last prior star auc 0.42890655220435914 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44337317637513396; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4377116674692272; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 60 
last prior star auc 0.429681243092846 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4434963893160131; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.44152393453285743; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 60 
last prior star auc 0.43053137047574863 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4438989268320486; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.4393495823542305; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 350 
last prior star auc 0.43086119559299996 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4442480301645396; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 500 
last prior auc 0.4429926411699697; count_not_improved_prior_anomaly= 45; iter_best_prior_anomaly= 350 
last prior star auc 0.43216163693840143 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44413885679345444; count_not_improved_vanilla_star_anomaly= 47 ;iter_best_vanilla_star_anomaly= 590 
last prior auc 0.44162661198359004; count_not_improved_prior_anomaly= 55; iter_best_prior_anomaly= 350 
last prior star auc 0.43204932038004906 ; count_not_improved_prior_star_anomaly= 46 ; iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4447580646851176; count_not_improved_vanilla_star_anomaly= 53 ;iter_best_vanilla_star_anomaly= 700 
last prior auc 0.43449891099038473; count_not_improved_prior_anomaly= 65; iter_best_prior_anomaly= 350 
last prior star auc 0.43231921539340346 ; count_not_improved_prior_star_anomaly= 54 ; iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4448454452911492; count_not_improved_vanilla_star_anomaly= 61 ;iter_best_vanilla_star_anomaly= 770 
last prior auc 0.43766263374785686; count_not_improved_prior_anomaly= 75; iter_best_prior_anomaly= 350 
last prior star auc 0.4331651518599497 ; count_not_improved_prior_star_anomaly= 62 ; iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4450822320652878; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 890 
last prior auc 0.44288357257179356; count_not_improved_prior_anomaly= 85; iter_best_prior_anomaly= 350 
last prior star auc 0.43389541903505835 ; count_not_improved_prior_star_anomaly= 70 ; iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44521990366759656 at iter 950
0.4453572609511787 at iter 350
0.43437611714114127 at iter 950
last anomaly aucs:
0.44514572444808775
0.4371170812111581
0.4336035217108326




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 136.38717985153198 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4451400667110066,first_prior_anomaly_auc= 0.4411769266585447, first_prior_star_anomaly_auc= 0.4341253955701176


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4451400667110065 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4457802291844519 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43367267183071384 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4451400667110066 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4423755287364848 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4334513914470941 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4451402762568244 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4457209277180083 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43351373132789606 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4451404858026422 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4463321728685943 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336672236394504 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4451400667110065 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4455844086176975 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4335119501884446 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4451400667110066 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4446069821504681 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4334684694312465 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4451402762568244 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.44461159215846024 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4334631260128921 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.44514048580264226 at iter 3
max_prior_anomaly= 0.4494548246457733 at iter 54
max_prior_star_anomaly= 0.43481836358965403 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4451400667110066
accuracies_anomaly['prior'][-1]= 0.44368519009787044
accuracies_anomaly['prior_star'][-1]= 0.4334700410248802



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.31410789489746 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4451402762568244
 first_prior_anomaly_auc= 0.4505511683646164
 first_prior_star_anomaly_auc= 0.4342288064312126


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44495524729968783; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4265489522080471; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.433570203925799 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4452444205282818; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.43397756099564444; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.43422943506866607 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4456222316378143; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4369591884374294; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4349959536702579 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.445567330633545; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.4275338175518092; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4345753952138897 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4460140823171409; count_not_improved_vanilla_star_anomaly= 44 ;iter_best_vanilla_star_anomaly= 500 
last prior auc 0.43213334825299554; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.4357815409412714 ; count_not_improved_prior_star_anomaly= 43 ; iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.445969344285036; count_not_improved_vanilla_star_anomaly= 51 ;iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4248116078324874; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.43509192565482024 ; count_not_improved_prior_star_anomaly= 51 ; iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4462542218243645; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 660 
last prior auc 0.42888413080185217; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.43590894479850706 ; count_not_improved_prior_star_anomaly= 60 ; iter_best_prior_star_anomaly= 660
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44642866871770115; count_not_improved_vanilla_star_anomaly= 65 ;iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4266652501369382; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.43604640685499807 ; count_not_improved_prior_star_anomaly= 69 ; iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4465817419376199; count_not_improved_vanilla_star_anomaly= 73 ;iter_best_vanilla_star_anomaly= 830 
last prior auc 0.43021160355775273; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.43669159842807115 ; count_not_improved_prior_star_anomaly= 77 ; iter_best_prior_star_anomaly= 830
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4469056997719722 at iter 990
0.4505511683646164 at iter 0
0.43738959554723517 at iter 950
last anomaly aucs:
0.4469056997719722
0.42789235044610213
0.43702561446167887




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 136.17673754692078 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44692015843340194,first_prior_anomaly_auc= 0.4218928441360489, first_prior_star_anomaly_auc= 0.43649986400476426


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44692015843340194 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4254021079471089 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.436127605859404 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44692015843340194 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.427080360402043 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4360549982335288 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44692026320631084 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4251250883759487 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4360130890699644 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44692026320631084 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4279601385181674 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4362582576768158 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44692015843340194 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.428685690912375 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4363488862430237 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44692036797921975 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4312451883041582 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.436438990944687 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44692036797921975 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4247884530196181 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4360005163208951 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4469203679792198 at iter 22
max_prior_anomaly= 0.4354079207480953 at iter 69
max_prior_star_anomaly= 0.43826193478682696 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44692015843340194
accuracies_anomaly['prior'][-1]= 0.428056948686001
accuracies_anomaly['prior_star'][-1]= 0.43625700040190885



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.71180510520935 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4469203679792198
 first_prior_anomaly_auc= 0.43214424463552226
 first_prior_star_anomaly_auc= 0.43653988725596815


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4483172004008192; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4525051831158038; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 50 
last prior star auc 0.44075825411453695 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4481211702882471; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.44515724946806795; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 120 
last prior star auc 0.44008204976042625 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4484678638438331; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 240 
last prior auc 0.4490493534882882; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 120 
last prior star auc 0.44063881299837854 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44868579149436766; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4480182832916966; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 310 
last prior star auc 0.44104973234712685 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4487083176697835; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4464889131403249; count_not_improved_prior_anomaly= 45; iter_best_prior_anomaly= 310 
last prior star auc 0.4413313619262793 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44874802660226065; count_not_improved_vanilla_star_anomaly= 46 ;iter_best_vanilla_star_anomaly= 510 
last prior auc 0.44293753061988267; count_not_improved_prior_anomaly= 55; iter_best_prior_anomaly= 310 
last prior star auc 0.4411984051048714 ; count_not_improved_prior_star_anomaly= 46 ; iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44937268268518715; count_not_improved_vanilla_star_anomaly= 53 ;iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4532708635341243; count_not_improved_prior_anomaly= 65; iter_best_prior_anomaly= 310 
last prior star auc 0.44240214105534814 ; count_not_improved_prior_star_anomaly= 55 ; iter_best_prior_star_anomaly= 660
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4489984338545576; count_not_improved_vanilla_star_anomaly= 61 ;iter_best_vanilla_star_anomaly= 720 
last prior auc 0.4504921812168996; count_not_improved_prior_anomaly= 75; iter_best_prior_anomaly= 310 
last prior star auc 0.4420957850696928 ; count_not_improved_prior_star_anomaly= 64 ; iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4496157558338603; count_not_improved_vanilla_star_anomaly= 68 ;iter_best_vanilla_star_anomaly= 900 
last prior auc 0.44622551404732297; count_not_improved_prior_anomaly= 84; iter_best_prior_anomaly= 860 
last prior star auc 0.4423809769277482 ; count_not_improved_prior_star_anomaly= 72 ; iter_best_prior_star_anomaly= 860
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44985799079926225 at iter 980
0.45779066205162955 at iter 860
0.44320522540214985 at iter 860
last anomaly aucs:
0.4497194810136821
0.4538152635688251
0.4430551905965895




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 136.26871824264526 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4499872805688582,first_prior_anomaly_auc= 0.45120683722858057, first_prior_star_anomaly_auc= 0.4429450742693242


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4499872805688582 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4492934743660505 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44230826452896405 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4499872805688582 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4491480495684823 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4420630959221127 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4499872805688582 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4497833924881178 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44205073271886114 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4499872805688582 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.449364615171201 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44205660000176017 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4499872805688582 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4549197795745633 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44259618048265104 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4499872805688582 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4500702607127156 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44200002263094834 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4499872805688582 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.45272311076633837 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4422303134847344 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.449987490114676 at iter 11
max_prior_anomaly= 0.45530094341718097 at iter 66
max_prior_star_anomaly= 0.44378053344497936 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4499872805688582
accuracies_anomaly['prior'][-1]= 0.4519513535193011
accuracies_anomaly['prior_star'][-1]= 0.4421546674445007



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.00280952453613 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4499872805688582
 first_prior_anomaly_auc= 0.4504145444913967
 first_prior_star_anomaly_auc= 0.4419678573479127


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4498690967276068; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4508693636889787; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 100 
last prior star auc 0.442846587734948 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4497240910216742; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44664596773078225; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 110 
last prior star auc 0.44239795013899175 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44976956246414146; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4515358241625606; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 230 
last prior star auc 0.4427011629373797 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44990409087918304; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.44691628183577226; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 230 
last prior star auc 0.4425506042672748 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4500511920432938; count_not_improved_vanilla_star_anomaly= 44 ;iter_best_vanilla_star_anomaly= 480 
last prior auc 0.4523767315294791; count_not_improved_prior_anomaly= 44; iter_best_prior_anomaly= 430 
last prior star auc 0.44307101130583504 ; count_not_improved_prior_star_anomaly= 42 ; iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.45023538281715914; count_not_improved_vanilla_star_anomaly= 53 ;iter_best_vanilla_star_anomaly= 590 
last prior auc 0.45224482243716035; count_not_improved_prior_anomaly= 54; iter_best_prior_anomaly= 430 
last prior star auc 0.4435437466708408 ; count_not_improved_prior_star_anomaly= 50 ; iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.45053901470718277; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4481994356512034; count_not_improved_prior_anomaly= 63; iter_best_prior_anomaly= 630 
last prior star auc 0.44376314114210014 ; count_not_improved_prior_star_anomaly= 58 ; iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.45047237913711546; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 700 
last prior auc 0.44502093991357494; count_not_improved_prior_anomaly= 73; iter_best_prior_anomaly= 630 
last prior star auc 0.44337432887713196 ; count_not_improved_prior_star_anomaly= 68 ; iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.45059768753617285; count_not_improved_vanilla_star_anomaly= 77 ;iter_best_vanilla_star_anomaly= 830 
last prior auc 0.4518379892318595; count_not_improved_prior_anomaly= 83; iter_best_prior_anomaly= 630 
last prior star auc 0.4439247009676407 ; count_not_improved_prior_star_anomaly= 76 ; iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.45088225075677474 at iter 830
0.45469388918295156 at iter 630
0.4443548985316287 at iter 970
last anomaly aucs:
0.45062010893867976
0.44897580290623285
0.44413906633927225




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 136.2616491317749 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4506741717596778,first_prior_anomaly_auc= 0.4510576406062915, first_prior_star_anomaly_auc= 0.444108891741506


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4506741717596778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45109609226386177 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44360975360345467 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4506741717596777 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45136881614575675 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.443543537125023 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4506741717596778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45216446161602575 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44352258254324084 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4506741717596778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4512047417704024 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4435202775392448 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4506741717596778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4507315873137609 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44351168616071407 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4506741717596778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45317132927065906 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44370258240074967 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4506741717596778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4543032957785319 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44366423551608836 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4506741717596778 at iter 0
max_prior_anomaly= 0.4587123493313183 at iter 69
max_prior_star_anomaly= 0.4450562483838779 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4506741717596778
accuracies_anomaly['prior'][-1]= 0.4543346228782962
accuracies_anomaly['prior_star'][-1]= 0.44355799578645266



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.77166652679443 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4506741717596777
 first_prior_anomaly_auc= 0.4570149234340536
 first_prior_star_anomaly_auc= 0.4437646079628249


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45126592914920627; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.44942569777709607; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4451293798742977 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4518025759886477; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.46174217231120235; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 200 
last prior star auc 0.44649876179376247 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4514314703452854; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4575303013729861; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 200 
last prior star auc 0.4459570858546934 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4509880713947747; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.45075547553699263; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 200 
last prior star auc 0.44517086994622634 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.45109808294913106; count_not_improved_vanilla_star_anomaly= 44 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4530453922341482; count_not_improved_prior_anomaly= 48; iter_best_prior_anomaly= 200 
last prior star auc 0.44541792446543815 ; count_not_improved_prior_star_anomaly= 41 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4510724135864479; count_not_improved_vanilla_star_anomaly= 54 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.44754313814978586; count_not_improved_prior_anomaly= 58; iter_best_prior_anomaly= 200 
last prior star auc 0.4449495895626066 ; count_not_improved_prior_star_anomaly= 51 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.45113999211269545; count_not_improved_vanilla_star_anomaly= 64 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4484586438278489; count_not_improved_prior_anomaly= 68; iter_best_prior_anomaly= 200 
last prior star auc 0.4452127791097906 ; count_not_improved_prior_star_anomaly= 61 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.45116597579410533; count_not_improved_vanilla_star_anomaly= 74 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.45067752449276294; count_not_improved_prior_anomaly= 78; iter_best_prior_anomaly= 200 
last prior star auc 0.44513210396992936 ; count_not_improved_prior_star_anomaly= 71 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.451396790512436; count_not_improved_vanilla_star_anomaly= 84 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4537819457837915; count_not_improved_prior_anomaly= 87; iter_best_prior_anomaly= 880 
last prior star auc 0.4457571791444915 ; count_not_improved_prior_star_anomaly= 81 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.45184050378167334 at iter 170
0.46374354441721743 at iter 880
0.44649876179376247 at iter 200
last anomaly aucs:
0.45151005002696853
0.44834527954040737
0.4456429766737786




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 136.35723280906677 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4514614353972339,first_prior_anomaly_auc= 0.45447218970769615, first_prior_star_anomaly_auc= 0.4460419519109112


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45146164494305174 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4476579692579522 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44510297710125213 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.45146164494305174 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4442347240051079 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4456639312555608 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45146164494305174 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4528689546555423 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44526705147660656 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.45146164494305174 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.44815323079837377 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44503173152319275 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.45146185448886955 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.4509209119601628 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4451080062008798 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4514614353972339 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.45422450655103097 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44528119581930947 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.45146164494305174 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.4521466502215109 iter_best_prior_anomaly= 650
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4451761085916719 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.45146185448886955 at iter 38
max_prior_anomaly= 0.458682174733552 at iter 65
max_prior_star_anomaly= 0.44676739953220995 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.45146164494305174
accuracies_anomaly['prior'][-1]= 0.45196581218073073
accuracies_anomaly['prior_star'][-1]= 0.44502209241557295



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.26857686042786 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.46073698102311167
accuracies_anomaly["prior"][-1]= 0.41238847447710986
accuracies_anomaly["prior_star"][-1]= 0.4575783921381762


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam photoGGAD 
took 3171.9059925079346 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0031576156616210938 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4617611362077152
 first_prior_anomaly_auc= 0.4122030264283376
 first_prior_star_anomaly_auc= 0.4584511504694036


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.48023092368215586; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4121357622208169; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4679701883355901 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.533545770883441; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41214477269098315; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5144974274059946 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5425327719181783; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41213932449971985; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5186837337544365 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5424376381168872; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.41211774128048423; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.516772256804267 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5412350546684084; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.41210275875450997; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.5154925604948298 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5417157527744914; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4120903955512585; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.5161209884024771 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5414896528370619; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4120789753041872; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.516322152387586 ; count_not_improved_prior_star_anomaly= 45 ; iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5422660200920912; count_not_improved_vanilla_star_anomaly= 46 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.4120741557503772; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.517070859594663 ; count_not_improved_prior_star_anomaly= 55 ; iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5437852272712985; count_not_improved_vanilla_star_anomaly= 53 ;iter_best_vanilla_star_anomaly= 900 
last prior auc 0.4120736318858327; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.5175976577806667 ; count_not_improved_prior_star_anomaly= 65 ; iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5438315368970371 at iter 920
0.4122030264283376 at iter 0
0.5186905439935158 at iter 310
last anomaly aucs:
0.5431800589494296
0.4120743652961951
0.5156972867588416




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 137.6795380115509 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5430333768769543,first_prior_anomaly_auc= 0.41207373665874164, first_prior_star_anomaly_auc= 0.5154544231559863


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5430329577853186 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4203935438095346 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5057424983644949 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5430330625582276 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4112516884154271 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5017103129650607 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5430329577853187 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4099040992610158 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5011988116237579 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5430329577853186 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.41011888372428296 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5010611400214491 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5430331673311365 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4105023525708967 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5014985669161519 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5430333768769543 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.41077748622969656 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5020617213015477 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5430331673311365 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.41064411031665304 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5019394513168488 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5430335864227721 at iter 29
max_prior_anomaly= 0.4364036824743841 at iter 5
max_prior_star_anomaly= 0.5154544231559863 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5430329577853186
accuracies_anomaly['prior'][-1]= 0.4095293265658416
accuracies_anomaly['prior_star'][-1]= 0.5018551091251756



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.52832102775574 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5430333768769543
 first_prior_anomaly_auc= 0.4110957863269677
 first_prior_star_anomaly_auc= 0.5028824074970465


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5414320277371607; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4102177893502948; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.5001045633630931 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5420367769673943; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4086889430634677; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.4998739581905802 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5444795573386507; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4080547526458303; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.501507891705045 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5479918595640693; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4073595843952068; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.5040014869371232 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5517683990657609; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 500 
last prior auc 0.4068566744324346; count_not_improved_prior_anomaly= 48; iter_best_prior_anomaly= 20 
last prior star auc 0.5066564324489242 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5553601191561338; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 600 
last prior auc 0.4066360226862684; count_not_improved_prior_anomaly= 58; iter_best_prior_anomaly= 20 
last prior star auc 0.5091818786453115 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5592450986185482; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 700 
last prior auc 0.40645874692439127; count_not_improved_prior_anomaly= 68; iter_best_prior_anomaly= 20 
last prior star auc 0.5118154504836946 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5631208580649785; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 800 
last prior auc 0.40561658228256586; count_not_improved_prior_anomaly= 78; iter_best_prior_anomaly= 20 
last prior star auc 0.5142275323926402 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5667476770798365; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 900 
last prior auc 0.40499611711599576; count_not_improved_prior_anomaly= 88; iter_best_prior_anomaly= 20 
last prior star auc 0.5163874259098374 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5698377444823444 at iter 990
0.41144929012163295 at iter 20
0.5180890427234586 at iter 990
last anomaly aucs:
0.5698377444823444
0.4044160942922652
0.5180890427234586




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 137.63828921318054 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5701236697507621,first_prior_anomaly_auc= 0.40435113508874054, first_prior_star_anomaly_auc= 0.5182491357282745


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5701236697507621 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40939500769661785 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5184945138809436 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5701236697507621 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4099662295959999 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5195770275758106 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5701236697507621 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40852130640921025 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5185072961758307 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5701236697507621 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40821736020045996 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5189020804966069 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5701236697507621 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.407575626133381 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5208395411281863 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5701236697507621 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40496416137877794 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5200017769485351 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5701236697507621 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41167811415469424 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5203988662733072 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5701236697507621 at iter 0
max_prior_anomaly= 0.4208490964174789 at iter 34
max_prior_star_anomaly= 0.5239152546421733 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5701236697507621
accuracies_anomaly['prior'][-1]= 0.4047111348037583
accuracies_anomaly['prior_star'][-1]= 0.5196143267313829



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.1101450920105 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5701236697507621
 first_prior_anomaly_auc= 0.4063698994976349
 first_prior_star_anomaly_auc= 0.5196130694564758


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5735843189320875; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4033451056173786; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5210145118860675 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5758763310874212; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4012609629133239; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5218979570540038 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5775374007852939; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4028987730254183; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5230492017771162 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5786801589027846; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.40455366112166524; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5244542064856107 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5789435579957865; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 500 
last prior auc 0.40347376674952107; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.5243173730665731 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5788221261943588; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4024235231105987; count_not_improved_prior_anomaly= 58; iter_best_prior_anomaly= 570 
last prior star auc 0.5236826587843911 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 530
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5778125344440939; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4046012280223108; count_not_improved_prior_anomaly= 68; iter_best_prior_anomaly= 570 
last prior star auc 0.5232918558341537 ; count_not_improved_prior_star_anomaly= 47 ; iter_best_prior_star_anomaly= 530
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.57618813526434; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4039953262900793; count_not_improved_prior_anomaly= 78; iter_best_prior_anomaly= 570 
last prior star auc 0.522598049631346 ; count_not_improved_prior_star_anomaly= 57 ; iter_best_prior_star_anomaly= 530
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5741042021061031; count_not_improved_vanilla_star_anomaly= 43 ;iter_best_vanilla_star_anomaly= 540 
last prior auc 0.40488903920308883; count_not_improved_prior_anomaly= 86; iter_best_prior_anomaly= 870 
last prior star auc 0.5212137899588158 ; count_not_improved_prior_star_anomaly= 67 ; iter_best_prior_star_anomaly= 530
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5790967359886141 at iter 540
0.4086455670791786 at iter 990
0.5246802016501314 at iter 530
last anomaly aucs:
0.5717201993367456
0.4086455670791786
0.520670647199022




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 137.90713930130005 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5713845069365951,first_prior_anomaly_auc= 0.4055478512543203, first_prior_star_anomaly_auc= 0.5190239313896702


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5713845069365953 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4183240693127275 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5208936039491843 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5713845069365951 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41105220079686083 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5195191929300917 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5713845069365953 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4117208615015299 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5199448852589965 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.571384611709504 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4117858207050546 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5197423592260718 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5713845069365951 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.41164584409874966 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5203699489504479 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5713846117095042 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.41086591456481736 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.520690658824624 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.571384611709504 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.41179881254575956 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5205414622023349 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5713846117095042 at iter 21
max_prior_anomaly= 0.42298290148035744 at iter 7
max_prior_star_anomaly= 0.5260824822629943 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5713845069365951
accuracies_anomaly['prior'][-1]= 0.41370379357557663
accuracies_anomaly['prior_star'][-1]= 0.5215228700401029



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.44030356407166 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5713845069365951
 first_prior_anomaly_auc= 0.4158407418257224
 first_prior_star_anomaly_auc= 0.522619213758946


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5684179667936933; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41716957662943877; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 80 
last prior star auc 0.521284197353604 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5646170152042254; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4197641729457071; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 80 
last prior star auc 0.5191503922907255 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5605658659082784; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4198499819581051; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 80 
last prior star auc 0.5164958658705602 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5563072662526879; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4209133222106413; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 80 
last prior star auc 0.5137420147327473 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5519285968434856; count_not_improved_vanilla_star_anomaly= 49 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4218888627655103; count_not_improved_prior_anomaly= 47; iter_best_prior_anomaly= 460 
last prior star auc 0.5115533086655997 ; count_not_improved_prior_star_anomaly= 49 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5475863884065842; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42094297294386307; count_not_improved_prior_anomaly= 57; iter_best_prior_anomaly= 460 
last prior star auc 0.508691122339973 ; count_not_improved_prior_star_anomaly= 59 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5434941681303441; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4234751246064206; count_not_improved_prior_anomaly= 66; iter_best_prior_anomaly= 610 
last prior star auc 0.5058195064525444 ; count_not_improved_prior_star_anomaly= 69 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5394317033602348; count_not_improved_vanilla_star_anomaly= 79 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42301454289884843; count_not_improved_prior_anomaly= 76; iter_best_prior_anomaly= 610 
last prior star auc 0.5037332682903115 ; count_not_improved_prior_star_anomaly= 79 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5354088427496937; count_not_improved_vanilla_star_anomaly= 89 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4250484993795348; count_not_improved_prior_anomaly= 84; iter_best_prior_anomaly= 890 
last prior star auc 0.5021044686483833 ; count_not_improved_prior_star_anomaly= 89 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.571387021486409 at iter 20
0.4288872739891195 at iter 990
0.5232604239614804 at iter 20
last anomaly aucs:
0.532091941999394
0.4288872739891195
0.5010467861329283




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 137.85545229911804 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5320865985810396,first_prior_anomaly_auc= 0.4318103333748234, first_prior_star_anomaly_auc= 0.5022226524896348


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5320864938081307 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4185669329155828 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4962749039965836 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5320862842623129 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4233433202870107 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49673045660452797 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5320862842623129 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42010426580803173 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49579609180286094 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5320864938081307 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41835413913758485 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49537532380067495 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5320864938081307 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41791136882452756 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4953208418880414 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5320864938081307 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41902311416098065 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49567518386597786 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5320864938081307 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41997633808625157 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4960140194533955 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5320865985810396 at iter 0
max_prior_anomaly= 0.4318103333748234 at iter 0
max_prior_star_anomaly= 0.5022226524896348 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5320864938081307
accuracies_anomaly['prior'][-1]= 0.41917377760399444
accuracies_anomaly['prior_star'][-1]= 0.49617851292038556



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.21611642837524 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5320864938081307
 first_prior_anomaly_auc= 0.4189937777464856
 first_prior_star_anomaly_auc= 0.49614362354171826


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5289593367958685; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4257822240606376; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 50 
last prior star auc 0.4956973957226669 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5249219127509888; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.425403155676198; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 50 
last prior star auc 0.4940748824552735 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5212112754090019; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.424558266938741; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 220 
last prior star auc 0.492284313441987 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5193523944591056; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4251753793722259; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 220 
last prior star auc 0.49044355820533225 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5155480901365527; count_not_improved_vanilla_star_anomaly= 49 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4293359115850758; count_not_improved_prior_anomaly= 43; iter_best_prior_anomaly= 500 
last prior star auc 0.4913577018355795 ; count_not_improved_prior_star_anomaly= 48 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5148808962526084; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4275564485001339; count_not_improved_prior_anomaly= 51; iter_best_prior_anomaly= 530 
last prior star auc 0.4901134187693542 ; count_not_improved_prior_star_anomaly= 58 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5133635749857614; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.43433431275048584; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 700 
last prior star auc 0.4917079576700684 ; count_not_improved_prior_star_anomaly= 68 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5115039606255026; count_not_improved_vanilla_star_anomaly= 79 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4305686696313209; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 700 
last prior star auc 0.4904012299501323 ; count_not_improved_prior_star_anomaly= 78 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5101654867141665; count_not_improved_vanilla_star_anomaly= 89 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4314885757715582; count_not_improved_prior_anomaly= 78; iter_best_prior_anomaly= 880 
last prior star auc 0.48959007808934446 ; count_not_improved_prior_star_anomaly= 88 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.533078064618063 at iter 10
0.43811420498526266 at iter 970
0.4975073477241019 at iter 50
last anomaly aucs:
0.5093413430126738
0.4369190604133165
0.4911626146791874




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 137.79607319831848 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5090733339116797,first_prior_anomaly_auc= 0.43301763160420315, first_prior_star_anomaly_auc= 0.49034894826858577


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5090735434574976 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.43154462927782544 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4852865308558312 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5090733339116797 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42992798329333104 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4844276025485801 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5090735434574976 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4343955001292898 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48530727589179556 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5090735434574976 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4323556763657044 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48483454052678976 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5090733339116797 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42951947372148763 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4843261823727543 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5090735434574976 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4273498363237618 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48389053661750303 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5090735434574976 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42527491363569114 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4833084183355943 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5090737530033155 at iter 2
max_prior_anomaly= 0.4343955001292898 at iter 30
max_prior_star_anomaly= 0.49034894826858577 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5090735434574976
accuracies_anomaly['prior'][-1]= 0.423497022144383
accuracies_anomaly['prior_star'][-1]= 0.4829724116167172



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.53672242164612 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5090737530033154
 first_prior_anomaly_auc= 0.4248067882786775
 first_prior_star_anomaly_auc= 0.4833912937065428


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.509345743474848; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4092639367875704; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4764747101247929 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5096185721296519; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4129756218586462; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4772745465114183 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5096779783690043; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.41001557763609686; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.47559671314811997 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5093726701124381; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4139531530987845; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.47562500183352596 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5097976290309805; count_not_improved_vanilla_star_anomaly= 43 ;iter_best_vanilla_star_anomaly= 450 
last prior auc 0.4137180426911886; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.4751067950260528 ; count_not_improved_prior_star_anomaly= 50 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5105349159909862; count_not_improved_vanilla_star_anomaly= 50 ;iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4109069855451104; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.47292563260834675 ; count_not_improved_prior_star_anomaly= 60 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5099540549839845; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 630 
last prior auc 0.41414509706790914; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.47245101133098055 ; count_not_improved_prior_star_anomaly= 70 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5093209122954361; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 630 
last prior auc 0.41611461820961543; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.47217933517817473 ; count_not_improved_prior_star_anomaly= 80 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5080048597866069; count_not_improved_vanilla_star_anomaly= 79 ;iter_best_vanilla_star_anomaly= 630 
last prior auc 0.41208107076236533; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.46873764989336214 ; count_not_improved_prior_star_anomaly= 90 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5107945432592673 at iter 630
0.4248067882786775 at iter 0
0.4833912937065428 at iter 0
last anomaly aucs:
0.5065536502252828
0.41483282644200004
0.46868044388509683




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 137.8178789615631 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5066166187435381,first_prior_anomaly_auc= 0.41733585123588024, first_prior_star_anomaly_auc= 0.46905280680336603


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5066164091977203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40759448525698494 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4645634972023538 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5066166187435381 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4157533612196908 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4679549962637981 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5066166187435381 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.416439519000148 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4688101527463285 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5066166187435381 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4156892401994373 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.468555764123493 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5066166187435381 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4143527569733705 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46800884953897826 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5066166187435381 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4144439094041229 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46812242337223764 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5066164091977203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41433683149121603 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46777321526683774 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.506616828289356 at iter 74
max_prior_anomaly= 0.41827503559135715 at iter 33
max_prior_star_anomaly= 0.4697765780581222 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5066166187435381
accuracies_anomaly['prior'][-1]= 0.41510680759880186
accuracies_anomaly['prior_star'][-1]= 0.4683948329354058



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.33210825920105 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5066166187435381
 first_prior_anomaly_auc= 0.41540530561628897
 first_prior_star_anomaly_auc= 0.468873016491675


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5057064564838296; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4149309986576495; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.4702082424428349 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5050961542894238; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4163053049038331; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.46732929245178245 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5024259119329219; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.414552035046119; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.46049935606570186 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5000406518886574; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41407385148984976; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.4539344951391657 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4945873267527565; count_not_improved_vanilla_star_anomaly= 49 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4148873083546336; count_not_improved_prior_anomaly= 49; iter_best_prior_anomaly= 10 
last prior star auc 0.4466020678819486 ; count_not_improved_prior_star_anomaly= 49 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.48959028763516227; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41571501433502933; count_not_improved_prior_anomaly= 59; iter_best_prior_anomaly= 10 
last prior star auc 0.4366742061251919 ; count_not_improved_prior_star_anomaly= 59 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.48156206348986824; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4192802268794479; count_not_improved_prior_anomaly= 69; iter_best_prior_anomaly= 10 
last prior star auc 0.43008608561287753 ; count_not_improved_prior_star_anomaly= 69 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.47253105783338845; count_not_improved_vanilla_star_anomaly= 79 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41617832013823314; count_not_improved_prior_anomaly= 79; iter_best_prior_anomaly= 10 
last prior star auc 0.41970602398126156 ; count_not_improved_prior_star_anomaly= 79 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4614597045487787; count_not_improved_vanilla_star_anomaly= 89 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41431378145125564; count_not_improved_prior_anomaly= 89; iter_best_prior_anomaly= 10 
last prior star auc 0.4106238891452333 ; count_not_improved_prior_star_anomaly= 89 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.508382042258686 at iter 10
0.4228609458143852 at iter 10
0.4776607394536638 at iter 10
last anomaly aucs:
0.4491484686601179
0.41635790090410635
0.40334762016719244




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 137.71359395980835 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4454827788960539,first_prior_anomaly_auc= 0.41851349873203825, first_prior_star_anomaly_auc= 0.4062812616166963


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44548152162114707 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41520896118498996 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4002832221273678 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.445481626394056 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.413174480839759 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3987533281114516 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4454820454856916 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41380668057212716 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4001799160391817 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44548089298369353 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41173406288805264 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3978566815569925 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44548099775660255 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4130574495005056 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39916969565146326 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44548141684823805 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41082086221398567 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39698895232539283 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4454809977566025 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4134533863232797 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39926325785912065 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4454827788960539 at iter 0
max_prior_anomaly= 0.41851349873203825 at iter 0
max_prior_star_anomaly= 0.4062812616166963 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4454818359398738
accuracies_anomaly['prior'][-1]= 0.41350598232355296
accuracies_anomaly['prior_star'][-1]= 0.3989494629969326



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.15251851081848 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4454818359398737
 first_prior_anomaly_auc= 0.4138140146757509
 first_prior_star_anomaly_auc= 0.3997501375668294


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43763518324572226; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41559180139415025; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.39016278776403296 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4397352514319313; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41436616790571107; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 120 
last prior star auc 0.3803811889881158 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44710518739053845; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4174280513957218; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 120 
last prior star auc 0.38689146322910944 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44937645450990793; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4131154936920422; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 120 
last prior star auc 0.3868891582251134 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4518015282595585; count_not_improved_vanilla_star_anomaly= 49 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42242069005114175; count_not_improved_prior_anomaly= 48; iter_best_prior_anomaly= 120 
last prior star auc 0.39738687983343624 ; count_not_improved_prior_star_anomaly= 49 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.45131422946021416; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41356109287364007; count_not_improved_prior_anomaly= 58; iter_best_prior_anomaly= 120 
last prior star auc 0.3970444819671156 ; count_not_improved_prior_star_anomaly= 59 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4518565340367367; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41785919191589; count_not_improved_prior_anomaly= 68; iter_best_prior_anomaly= 120 
last prior star auc 0.40140533998180306 ; count_not_improved_prior_star_anomaly= 69 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4518970811524853; count_not_improved_vanilla_star_anomaly= 79 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4175433015955238; count_not_improved_prior_anomaly= 78; iter_best_prior_anomaly= 120 
last prior star auc 0.4023770039390423 ; count_not_improved_prior_star_anomaly= 79 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4522438794809801; count_not_improved_vanilla_star_anomaly= 89 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4229837396636286; count_not_improved_prior_anomaly= 88; iter_best_prior_anomaly= 120 
last prior star auc 0.4070421224812069 ; count_not_improved_prior_star_anomaly= 89 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.45369707972757367 at iter 10
0.42470400605503594 at iter 120
0.41153562299857555 at iter 10
last anomaly aucs:
0.45174044565366345
0.41774739922208215
0.4045271535757108




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 137.77832174301147 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4518564292638278,first_prior_anomaly_auc= 0.4234495600166463, first_prior_star_anomaly_auc= 0.4081017956819313


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45185642926382785 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.420894986951582 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4039598082739585 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.45185621971801 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.41720069418338523 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4025685288165313 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4518564292638278 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4164172023705499 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4030357112173648 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.45185621971801 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.41563517737843925 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026402982591353 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.45185621971801 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.41826204375065223 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4036969330455012 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.45185621971801 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4173708453874565 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40364863273449325 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4518563244909189 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.41584325637553626 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4025316487525947 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.45185663880964566 at iter 29
max_prior_anomaly= 0.4234495600166463 at iter 0
max_prior_star_anomaly= 0.4081017956819313 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.45185642926382785
accuracies_anomaly['prior'][-1]= 0.41562868145808685
accuracies_anomaly['prior_star'][-1]= 0.40274454730350157



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.02818179130554 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.45185621971801
 first_prior_anomaly_auc= 0.416260881190455
 first_prior_star_anomaly_auc= 0.4033309612746756


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44946341602430395; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.39926294354039393; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.3985936541982714 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4503085143075789; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40754964245197106; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.40548886410660345 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45006879389199095; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40521530204143724; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.40455146089057814 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.45035147120023233; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40527166986643126; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.40692812955631186 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.45051083079468573; count_not_improved_vanilla_star_anomaly= 50 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40558787450552425; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.4080571624227352 ; count_not_improved_prior_star_anomaly= 43 ; iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4506930308832817; count_not_improved_vanilla_star_anomaly= 60 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40396305623413475; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.4100656590865563 ; count_not_improved_prior_star_anomaly= 51 ; iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4504438809058917; count_not_improved_vanilla_star_anomaly= 70 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40010322226985895; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.41014696286387103 ; count_not_improved_prior_star_anomaly= 59 ; iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4502974083792343; count_not_improved_vanilla_star_anomaly= 80 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40645183191240314; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.41249219965693157 ; count_not_improved_prior_star_anomaly= 68 ; iter_best_prior_star_anomaly= 720
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4497655810936029; count_not_improved_vanilla_star_anomaly= 90 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4053802146000629; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.4131751094772126 ; count_not_improved_prior_star_anomaly= 77 ; iter_best_prior_star_anomaly= 840
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.45185621971801 at iter 0
0.416260881190455 at iter 0
0.41621729566034804 at iter 980
last anomaly aucs:
0.44953948115617326
0.410474902068762
0.4161118941139837




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 138.09724068641663 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44956714120412566,first_prior_anomaly_auc= 0.4074019126504067, first_prior_star_anomaly_auc= 0.4155042112423008


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4495671412041258 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4157240248051957 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4172629292912783 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4495672459770347 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4103855307774611 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41504624885745145 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44956714120412566 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4063967213623161 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41469662166041593 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44956714120412566 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4104992093836293 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41606914676714807 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44956724597703457 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.40694856027354953 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41510565509680386 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4495673507499436 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.40698889784348014 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4151327912802118 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4495671412041257 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.4052632880337184 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4148204632387485 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4495673507499436 at iter 60
max_prior_anomaly= 0.41999645448476247 at iter 2
max_prior_star_anomaly= 0.42652024443100556 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4495671412041257
accuracies_anomaly['prior'][-1]= 0.40721395005182065
accuracies_anomaly['prior_star'][-1]= 0.41533908913785733



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.85216307640076 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4495671412041257
 first_prior_anomaly_auc= 0.40558787450552425
 first_prior_star_anomaly_auc= 0.4149942814946317


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45150208728589136; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41503378088129106; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 90 
last prior star auc 0.4203459769088891 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4511018547738519; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4201010178478555; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 140 
last prior star auc 0.42183479994451223 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4508571052586361; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4194323571431864; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 140 
last prior star auc 0.42281631255518914 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4506993172578163; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4228689085554624; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 140 
last prior star auc 0.4241940763073668 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4506226234884936; count_not_improved_vanilla_star_anomaly= 48 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4266981488303362; count_not_improved_prior_anomaly= 42; iter_best_prior_anomaly= 450 
last prior star auc 0.42531305097453476 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4504111917583115; count_not_improved_vanilla_star_anomaly= 58 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42431896561478855; count_not_improved_prior_anomaly= 52; iter_best_prior_anomaly= 450 
last prior star auc 0.42583943006890285 ; count_not_improved_prior_star_anomaly= 50 ; iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.45091954991234695; count_not_improved_vanilla_star_anomaly= 68 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41887685118014106; count_not_improved_prior_anomaly= 62; iter_best_prior_anomaly= 450 
last prior star auc 0.4252856004724001 ; count_not_improved_prior_star_anomaly= 60 ; iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4506498644448105; count_not_improved_vanilla_star_anomaly= 78 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4165919635826132; count_not_improved_prior_anomaly= 72; iter_best_prior_anomaly= 450 
last prior star auc 0.4260324217671166 ; count_not_improved_prior_star_anomaly= 67 ; iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.45068737314620055; count_not_improved_vanilla_star_anomaly= 88 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42103538264952245; count_not_improved_prior_anomaly= 82; iter_best_prior_anomaly= 450 
last prior star auc 0.4277718616008547 ; count_not_improved_prior_star_anomaly= 77 ; iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4523373369157286 at iter 20
0.43495530178160047 at iter 450
0.42918000949661644 at iter 990
last anomaly aucs:
0.4504585491131392
0.4278206857764071
0.42918000949661644




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 138.16226387023926 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.45047531277856495,first_prior_anomaly_auc= 0.42176145890827466, first_prior_star_anomaly_auc= 0.42874918329517503


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45047531277856495 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41877983146648967 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42794913736273177 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4504754175514739 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4145421863926813 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42678615807382136 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45047531277856495 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41456135983501197 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4267765189662015 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.45047531277856495 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41471757624219807 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42662072165065107 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.45047531277856495 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4144964006314873 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4267012920176035 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.45047531277856495 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.41599727255163527 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4270889517805737 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.45047531277856495 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4159974820974531 iter_best_prior_anomaly= 630
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42729053485731816 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4504755223243828 at iter 58
max_prior_anomaly= 0.4217881760000469 at iter 63
max_prior_star_anomaly= 0.43492491763801633 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.45047531277856495
accuracies_anomaly['prior'][-1]= 0.41493738980509304
accuracies_anomaly['prior_star'][-1]= 0.42681507539668073



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.60978579521179 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.45047531277856495
 first_prior_anomaly_auc= 0.4187772121437669
 first_prior_star_anomaly_auc= 0.4281488345271159


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45026995787709967; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41883200837512724; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 80 
last prior star auc 0.42790429455771795 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4502112850481096; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4249128184624953; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 180 
last prior star auc 0.42910813528110364 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4502263723469928; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41915303256803016; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 220 
last prior star auc 0.4285547247762365 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4502703769687353; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42063724559566124; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 330 
last prior star auc 0.42929976493150157 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4505176410337649; count_not_improved_vanilla_star_anomaly= 48 ;iter_best_vanilla_star_anomaly= 500 
last prior auc 0.42164589438974603; count_not_improved_prior_anomaly= 43; iter_best_prior_anomaly= 330 
last prior star auc 0.4298495083845568 ; count_not_improved_prior_star_anomaly= 42 ; iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4506253475841253; count_not_improved_vanilla_star_anomaly= 55 ;iter_best_vanilla_star_anomaly= 590 
last prior auc 0.42921479410237484; count_not_improved_prior_anomaly= 52; iter_best_prior_anomaly= 530 
last prior star auc 0.4317957699404848 ; count_not_improved_prior_star_anomaly= 49 ; iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4508286070274124; count_not_improved_vanilla_star_anomaly= 63 ;iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4268416877155441; count_not_improved_prior_anomaly= 62; iter_best_prior_anomaly= 530 
last prior star auc 0.4317630807929046 ; count_not_improved_prior_star_anomaly= 59 ; iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4508239970194203; count_not_improved_vanilla_star_anomaly= 72 ;iter_best_vanilla_star_anomaly= 770 
last prior auc 0.427438788523427; count_not_improved_prior_anomaly= 72; iter_best_prior_anomaly= 530 
last prior star auc 0.432239797528449 ; count_not_improved_prior_star_anomaly= 65 ; iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.45097246023134696; count_not_improved_vanilla_star_anomaly= 79 ;iter_best_vanilla_star_anomaly= 900 
last prior auc 0.4308729301587981; count_not_improved_prior_anomaly= 82; iter_best_prior_anomaly= 530 
last prior star auc 0.43386304420620486 ; count_not_improved_prior_star_anomaly= 72 ; iter_best_prior_star_anomaly= 880
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.45098702366568555 at iter 990
0.4371787924545065 at iter 990
0.4351390734638301 at iter 990
last anomaly aucs:
0.45098702366568555
0.4371787924545065
0.4351390734638301




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 136.46539759635925 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4508619248124461,first_prior_anomaly_auc= 0.4278443644538209, first_prior_star_anomaly_auc= 0.4337787020145316


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.450861924812446 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.42144043471537185 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43355155434801285 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4508619248124461 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41686762110595765 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43243949469283305 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45086213435826383 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4143891131727626 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43219684063579544 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.450861924812446 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4173957813397773 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43241309191978755 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.450861924812446 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.41499972968589505 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.432394966206546 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.45086213435826383 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.41814029763049776 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43282212535617554 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.450861924812446 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.421131145088267 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4331456640988922 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.45086234390408164 at iter 57
max_prior_anomaly= 0.4278443644538209 at iter 0
max_prior_star_anomaly= 0.4396053330248819 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.450861924812446
accuracies_anomaly['prior'][-1]= 0.4155553404218493
accuracies_anomaly['prior_star'][-1]= 0.43229679399089654



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.80637311935425 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.450861924812446
 first_prior_anomaly_auc= 0.41810111256256516
 first_prior_star_anomaly_auc= 0.4329876665522546


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4511478500808638; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.40632516146552994; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4328399367506903 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4513128674123983; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4104989998378115; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4334107395584366 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4514349278512795; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4087756950320458; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4336701572808999 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.45163452024275463; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.41317448083975905; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43426505785769576 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4516439498045566; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 440 
last prior auc 0.4105168112323264; count_not_improved_prior_anomaly= 49; iter_best_prior_anomaly= 410 
last prior star auc 0.4344045105994562 ; count_not_improved_prior_star_anomaly= 42 ; iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.45180152825955855; count_not_improved_vanilla_star_anomaly= 45 ;iter_best_vanilla_star_anomaly= 580 
last prior auc 0.41266486541081665; count_not_improved_prior_anomaly= 59; iter_best_prior_anomaly= 410 
last prior star auc 0.4348419374941589 ; count_not_improved_prior_star_anomaly= 49 ; iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4520707946354594; count_not_improved_vanilla_star_anomaly= 53 ;iter_best_vanilla_star_anomaly= 660 
last prior auc 0.4131304762180165; count_not_improved_prior_anomaly= 69; iter_best_prior_anomaly= 410 
last prior star auc 0.4355030545493864 ; count_not_improved_prior_star_anomaly= 56 ; iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.45210306469140393; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 790 
last prior auc 0.4163049905851064; count_not_improved_prior_anomaly= 79; iter_best_prior_anomaly= 410 
last prior star auc 0.43629304228257426 ; count_not_improved_prior_star_anomaly= 63 ; iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.45225917632568113; count_not_improved_vanilla_star_anomaly= 65 ;iter_best_vanilla_star_anomaly= 890 
last prior auc 0.41862518665293724; count_not_improved_prior_anomaly= 87; iter_best_prior_anomaly= 840 
last prior star auc 0.436625801041275 ; count_not_improved_prior_star_anomaly= 69 ; iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4524039724857959 at iter 970
0.4208421814054909 at iter 950
0.4374520402009461 at iter 980
last anomaly aucs:
0.45239527633435633
0.41635999636228455
0.4369608648039719




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 136.2971704006195 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4524894671794672,first_prior_anomaly_auc= 0.41930537237758647, first_prior_star_anomaly_auc= 0.43728628945904907
