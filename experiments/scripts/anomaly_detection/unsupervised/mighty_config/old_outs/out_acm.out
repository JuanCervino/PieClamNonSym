

/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0066967010498046875 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.48898250969191687
 first_prior_anomaly_auc= 0.6721893441160857
 first_prior_star_anomaly_auc= 0.4891643683656679


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.704113088019387; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6881637234692682; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.7295374689030112 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7025863406509548; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.6887406471551203; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 200 
last prior star auc 0.7294920306214966 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7024813206971636; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.6894553633532079; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 300 
last prior star auc 0.730280735751853 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7032943545705845; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.690228341877419; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 400 
last prior star auc 0.7318894936771654 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7043958502869314 at iter 130
0.690835768846332 at iter 490
0.7329571613581456 at iter 490
last anomaly aucs:
0.7039441589379369
0.690835768846332
0.7329571613581456




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 51.905760765075684 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7040347716317357,first_prior_anomaly_auc= 0.6908863789647671, first_prior_star_anomaly_auc= 0.7331064057949905


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7040347188578895 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7648529878968461 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8190417536115782 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7040347716317357 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.8075340998206744 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8242273117319427 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7040347716317357 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.8092274542213271 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8210359717089966 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7040347188578895 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.8062462068798096 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8162743986684103 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7040347188578895 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.790303544608149 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8180962573843804 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7040347716317357 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7940459491323452 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8130079086885804 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7040347716317357 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7877125070848887 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8061833532290734 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7040347716317357 at iter 0
max_prior_anomaly= 0.8108950549850703 at iter 28
max_prior_star_anomaly= 0.8242273117319427 at iter 20
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7040347716317356
accuracies_anomaly['prior'][-1]= 0.7798210755520936
accuracies_anomaly['prior_star'][-1]= 0.8031546094260422



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.50812005996704 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7040347716317357
 first_prior_anomaly_auc= 0.7886686636290041
 first_prior_star_anomaly_auc= 0.8087965557677065


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.2973140223275589; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7601739003777552; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.7357777123382085 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.28806920551085613; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7316599802203625; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.3656590556225784 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.2854738933060598; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7252256345791128; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.3014035204377274 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 362


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 363 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7054200850925495 at iter 80
0.789612101676203 at iter 10
0.8169694302218928 at iter 80
last anomaly aucs:
0.2871442910836476
0.7072963536438757
0.29969823914785015




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 42.53048229217529 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4889825096919168
accuracies_anomaly["prior"][-1]= 0.6721893441160857
accuracies_anomaly["prior_star"][-1]= 0.4891643683656679


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 169.5042688846588 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.006300687789916992 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4727784057865467
 first_prior_anomaly_auc= 0.6569592343148214
 first_prior_star_anomaly_auc= 0.4729405798156926


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7027714185293196; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6851341880585452; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 100 
last prior star auc 0.7289662447925407 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6996720105463254; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6868630592576408; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 200 
last prior star auc 0.7274711089579382 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7002543171644823; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6882252577738514; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 300 
last prior star auc 0.7288149421756968 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7015821599068648; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6892071151810301; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 400 
last prior star auc 0.7308629368223178 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.702977236529212 at iter 90
0.689902674472974 at iter 490
0.7321691422877885 at iter 490
last anomaly aucs:
0.7023384091218537
0.689902674472974
0.7321691422877885




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.8364040851593 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.702392449540287,first_prior_anomaly_auc= 0.6899622561452505, first_prior_star_anomaly_auc= 0.7322627630908164


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7023924495402871 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7501518303553052 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8195043691467208 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.702392449540287 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7989434676005527 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8239587984028522 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7023924495402871 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7967214248094073 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8190037564423673 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.702392449540287 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7963855192788137 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8149987492598468 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7023924495402871 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7918908763519339 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8130318680147217 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.702392449540287 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7908722355740052 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8081840625095652 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.702392449540287 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7789969591709862 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8097003078826182 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7023924495402871 at iter 1
max_prior_anomaly= 0.7992315072527096 at iter 21
max_prior_star_anomaly= 0.8241555393012109 at iter 19
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7023924495402871
accuracies_anomaly['prior'][-1]= 0.777899474266945
accuracies_anomaly['prior_star'][-1]= 0.804320489234663



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.76666307449341 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.702392449540287
 first_prior_anomaly_auc= 0.7808971342746077
 first_prior_star_anomaly_auc= 0.8046940752913908


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.707395937891516; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7537843597318665; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.8092655041643841 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7128424099071287; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7290061945940584; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.8098906103717494 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.2893200512117403; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.7185795602672046; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.32930895814928457 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.289175292551816; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.7181611164412696; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.3314887818635289 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7130862250762319 at iter 250
0.7852694474261668 at iter 20
0.8103583449699665 at iter 170
last anomaly aucs:
0.28842046823067236
0.7166665611189744
0.30105357706406427




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.671417474746704 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.28815944878773203,first_prior_anomaly_auc= 0.7145631011600746, first_prior_star_anomaly_auc= 0.300990353996405


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.28815944878773203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7151819800535971 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3021048848527451 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.28815944878773203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7357048316567082 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.30148405332691597 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.28815944878773203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7379633939493729 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3016396306252962 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.28815944878773203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7279565755684534 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3015738216391768 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.28815944878773203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7390428301980392 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.30135618229775213 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.28815944878773203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7347868306033423 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.30142452442848566 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.28815944878773203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7355723165290853 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3014116476100308 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.28815944878773203 at iter 0
max_prior_anomaly= 0.746955476816977 at iter 69
max_prior_star_anomaly= 0.3023883331802891 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.28815944878773203
accuracies_anomaly['prior'][-1]= 0.7368351418930401
accuracies_anomaly['prior_star'][-1]= 0.30125976448087954



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.88944005966187 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.28815944878773203
 first_prior_anomaly_auc= 0.7310575139929854
 first_prior_star_anomaly_auc= 0.30146779898230913


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 44


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 45 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.28815944878773203 at iter 0
0.7310575139929854 at iter 0
0.30146779898230913 at iter 0
last anomaly aucs:
0.286646580940831
0.6365948097977812
0.2973706486644523




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 5.315126657485962 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 2:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4727784057865467
accuracies_anomaly["prior"][-1]= 0.6569592343148214
accuracies_anomaly["prior_star"][-1]= 0.4729405798156926


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 274.6416506767273 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0058689117431640625 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4905168564941912
 first_prior_anomaly_auc= 0.6752003031329722
 first_prior_star_anomaly_auc= 0.49070325371870904


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7078184453036027; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6888762231658185; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.7337120912269814 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7041183654039996; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6902465488543326; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 200 
last prior star auc 0.7316550194788267 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7046061012898983; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6914002906783445; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 300 
last prior star auc 0.7327969399613062 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7052376986803373; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6923223025440162; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 400 
last prior star auc 0.733966513939156 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7113321279786877 at iter 60
0.6929834532882857 at iter 490
0.7348443013217738 at iter 70
last anomaly aucs:
0.7057314507846943
0.6929834532882857
0.7347213910341457




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.252846240997314 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7057724560631344,first_prior_anomaly_auc= 0.6930438793421002, first_prior_star_anomaly_auc= 0.7347799700033459


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7057724560631344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6965606229002606 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7327095464721212 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7057724560631344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7016122409991566 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.728664958905006 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7057724560631344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5753949858513319 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7283501629128629 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7057724560631344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6832407680072279 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8034959506627867 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7057724560631344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7009719886979531 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8255349420912587 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7057724560631344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7459386303498168 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8272570582380502 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7057724560631344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7874037800850504 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8298141621782511 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7057724560631344 at iter 0
max_prior_anomaly= 0.7984643866254185 at iter 79
max_prior_star_anomaly= 0.8302909211041556 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7057724560631344
accuracies_anomaly['prior'][-1]= 0.7984643866254185
accuracies_anomaly['prior_star'][-1]= 0.8302909211041556



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.85066723823547 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7057724560631344
 first_prior_anomaly_auc= 0.7990455322189609
 first_prior_star_anomaly_auc= 0.8303391563995148


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7094212397843027; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7221573103914869; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.826978570652042 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7102023454808172; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7187775677378703; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.82885726680029 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7109974362465552; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7177210353384229; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8297704654336584 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7116330444492996; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7172956781386453; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.830226748107266 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7116591147292859 at iter 410
0.7990455322189609 at iter 0
0.8326740296736783 at iter 10
last anomaly aucs:
0.7115213749908965
0.7178133895691439
0.8301568227611489




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.22009205818176 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7115148310339768,first_prior_anomaly_auc= 0.7178295911399045, first_prior_star_anomaly_auc= 0.8301490650057681


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7115148310339768 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7582968929925832 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8336143012901095 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7115148310339768 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7603077348515312 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8324886351522367 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7115148310339768 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7564414701104768 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.830653160783966 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.711514831033977 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7554801417294411 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.829868888656684 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7115148310339768 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.755315751198758 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8293984098184686 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7115148310339768 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7551470859865383 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8288763709325878 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7115148310339768 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7552303103418796 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.828474339772798 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.711514831033977 at iter 2
max_prior_anomaly= 0.7628239918348305 at iter 14
max_prior_star_anomaly= 0.8342277972513269 at iter 11
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7115148310339768
accuracies_anomaly['prior'][-1]= 0.7552660910095531
accuracies_anomaly['prior_star'][-1]= 0.8281376426345126



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.2561674118042 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.711514831033977
 first_prior_anomaly_auc= 0.7551542104557655
 first_prior_star_anomaly_auc= 0.8281060838745291


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6693721706621747; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5849840992401623; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6711989901196804 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6705740422338536; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5844185219312272; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6723171095975572 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6696952521481594; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5809654236314951; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6723969564267462 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6704300751816211; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5845519342142345; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6761133962186483 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.711514831033977 at iter 0
0.7551542104557655 at iter 0
0.8281060838745291 at iter 0
last anomaly aucs:
0.6707179037383937
0.58947209266243
0.6767936510952156




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.298322439193726 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6712398370765822,first_prior_anomaly_auc= 0.5810665383206729, first_prior_star_anomaly_auc= 0.6738510869829086


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6712398898504284 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7101312591100852 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.830621390928598 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6712398898504284 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.7249374893792635 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8194479011313658 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6712398370765822 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.7315493662388819 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8209343292813576 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6712398370765822 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.7338930527453482 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.821490618393374 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6712398898504284 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.7357686352366748 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8219795680777338 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6712398370765822 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.7374168679988895 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.822455852039023 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6712398370765822 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.7386932562412988 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8226517485558438 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6712399426242744 at iter 15
max_prior_anomaly= 0.7394864471485763 at iter 78
max_prior_star_anomaly= 0.830621390928598 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6712398898504284
accuracies_anomaly['prior'][-1]= 0.7394521441485942
accuracies_anomaly['prior_star'][-1]= 0.8226518013296898



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.1474666595459 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6712397843027361
 first_prior_anomaly_auc= 0.7396319974161925
 first_prior_star_anomaly_auc= 0.8226465239450772


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6869149887222291; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6519405998697542; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7853981100630225 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6862430193395035; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6519439246220601; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7874341250465728 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.68687192526379; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6568474065348798; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7923963442501312 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6860931943903512; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6569386525148321; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7909244816816703 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6877110821910434 at iter 80
0.7396319974161925 at iter 0
0.8226465239450772 at iter 0
last anomaly aucs:
0.6863799146963552
0.6542912525239092
0.7912009110876795




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.24090790748596 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.686498550302447,first_prior_anomaly_auc= 0.6549281272989607, first_prior_star_anomaly_auc= 0.7894839667778084


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.686498550302447 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7018057099190553 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8321138880708943 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.686498550302447 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7051844498695958 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8163460127776037 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.686498550302447 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6992338820757854 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.811645287981601 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.686498550302447 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6944998042090309 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8095754977365297 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.686498550302447 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6907678489063676 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8081649583772674 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.686498550302447 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6888119446212368 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8073271207961672 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.686498550302447 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6866038868993148 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8065990528150098 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.686498550302447 at iter 0
max_prior_anomaly= 0.705687859587794 at iter 18
max_prior_star_anomaly= 0.8321138880708943 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.686498550302447
accuracies_anomaly['prior'][-1]= 0.685303433783072
accuracies_anomaly['prior_star'][-1]= 0.8065747240719454



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.69621634483337 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6864985503024469
 first_prior_anomaly_auc= 0.6888747982719732
 first_prior_star_anomaly_auc= 0.8067997517518277


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6829395348935392; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6092114109721047; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7107293451082339 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6839471459376276; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.610032097053214; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7154853768949769 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.683386687691767; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5909905545370203; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7063673228566694 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6817389826680136; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6039909165656048; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7154885433257445 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6875088528126877 at iter 420
0.6888747982719732 at iter 0
0.8067997517518277 at iter 0
last anomaly aucs:
0.6828985296150992
0.6231077673602206
0.7242303198411718




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.15408420562744 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6814531595173937,first_prior_anomaly_auc= 0.6134397042975854, first_prior_star_anomaly_auc= 0.723774723227564


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6814531595173937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6695832660466795 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7973065284414089 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6814531595173937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6561098392614195 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7654908126011278 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6814531595173937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6563453161628348 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7639812695065329 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6814531595173937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6564816310073789 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7641011189110856 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6814531595173937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6568396487794992 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7645209348570198 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6814531595173937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6572571954500501 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7648460217491575 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6814531595173937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6577603940728638 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7650301496982921 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6814531595173937 at iter 0
max_prior_anomaly= 0.676647098124523 at iter 9
max_prior_star_anomaly= 0.8050595869496611 at iter 9
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6814531595173937
accuracies_anomaly['prior'][-1]= 0.6580742929096227
accuracies_anomaly['prior_star'][-1]= 0.7652058866058924



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.96649861335754 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6814531595173937
 first_prior_anomaly_auc= 0.658256679321835
 first_prior_star_anomaly_auc= 0.7654242647811627


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6924185092655042; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6008777346087717; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7114991572016773 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6914943336721414; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5887884074858645; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7071768208823999 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6854521504814557; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5829000600566369; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6980635692640899 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6859651122658029; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5834413086225076; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7038715948995133 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6939153866370289 at iter 50
0.658256679321835 at iter 0
0.7654242647811627 at iter 0
last anomaly aucs:
0.6819831144801933
0.5919423836257532
0.7034427018520453




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.41117334365845 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6838192221346177,first_prior_anomaly_auc= 0.594109805486158, first_prior_star_anomaly_auc= 0.7058552582277065


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6838192221346177 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6273350052087786 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7503081464875311 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6838192221346175 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6292640476062311 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7433525535680925 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6838192221346177 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6268225711628927 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7422773920009627 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6838192221346177 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.624664754142483 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7412100937369055 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6838192221346177 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6231562137509644 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7404270881819304 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6838192221346177 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.6220374609869341 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7398248330499377 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6838192221346177 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.6213289721026894 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7393896599147809 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6838192749084637 at iter 58
max_prior_anomaly= 0.643021661552881 at iter 5
max_prior_star_anomaly= 0.7813487728497561 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6838192221346177
accuracies_anomaly['prior'][-1]= 0.620828412172182
accuracies_anomaly['prior_star'][-1]= 0.7390591373164922



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.90323805809021 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6838192221346177
 first_prior_anomaly_auc= 0.6208018141537345
 first_prior_star_anomaly_auc= 0.7390643091534126


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7016229013160742; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6539081671748788; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 60 
last prior star auc 0.7668712180942521 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6997653674801227; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6498018342077959; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 180 
last prior star auc 0.7656799012917982 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7010306732148455; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6504709010289844; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 180 
last prior star auc 0.7661339146900223 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6990932397758589; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6456863185914871; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 180 
last prior star auc 0.76297344736706 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7047394080252132 at iter 170
0.6705787918800049 at iter 180
0.7768306983351962 at iter 180
last anomaly aucs:
0.7017713541452274
0.6440205649123585
0.7658571158670902




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.477888345718384 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7010942129255815,first_prior_anomaly_auc= 0.6486637134422375, first_prior_star_anomaly_auc= 0.7653743407227273


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7010942129255815 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6707755855522097 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7876893393664395 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7010942129255815 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6806528969147354 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7872549050651283 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7010942129255815 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6800935469196433 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7869338817591423 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7010942129255815 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6788020125833959 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7860509225396041 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7010941601517354 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6783974482789921 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.785473154472214 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7010941601517354 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6786516598957821 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7855562732798629 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7010942129255815 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6789121516002614 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7855668808229344 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7010942129255815 at iter 0
max_prior_anomaly= 0.6868831660930149 at iter 5
max_prior_star_anomaly= 0.81493235976142 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7010941601517354
accuracies_anomaly['prior'][-1]= 0.6789228119171788
accuracies_anomaly['prior_star'][-1]= 0.7849404552694157



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.8261649608612 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7010942129255815
 first_prior_anomaly_auc= 0.6790373311632727
 first_prior_star_anomaly_auc= 0.7850976685570259


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6572641088238926; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5833800909610012; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6729338775372345 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6744222055456869; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6149840781306237; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7064766702658429 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6287895051818639; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5921167484133543; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6336093933224198 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6419419086611381; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.602757855650865; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6605423145975626 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7010942129255815 at iter 0
0.6790373311632727 at iter 0
0.7850976685570259 at iter 0
last anomaly aucs:
0.6662690157361055
0.5808997201930678
0.6838554249930602




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.73427987098694 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6652051477720465,first_prior_anomaly_auc= 0.5912890434107103, first_prior_star_anomaly_auc= 0.6853908272722571


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6652051477720465 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6232551119386049 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7237120806722122 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6652051477720465 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6249292566592678 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7166433406266789 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6652051477720465 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6264322557969431 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.718911718854723 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6652051477720466 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.627542089780978 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7208061943829629 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6652051477720465 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6282745379913641 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7220163514484838 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6652051477720466 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.628702164466525 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7227374005081065 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6652051477720465 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6290446139540381 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7232180646986244 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6652051477720466 at iter 3
max_prior_anomaly= 0.6492965246311372 at iter 5
max_prior_star_anomaly= 0.7618737459614814 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6652051477720464
accuracies_anomaly['prior'][-1]= 0.6292975589985212
accuracies_anomaly['prior_star'][-1]= 0.7235016713477067



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.03768515586853 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4905168037203451
accuracies_anomaly["prior"][-1]= 0.6752003031329722
accuracies_anomaly["prior_star"][-1]= 0.49070325371870904


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 1069.6484727859497 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.00597071647644043 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5066804828595826
 first_prior_anomaly_auc= 0.6776030963471
 first_prior_star_anomaly_auc= 0.5068560614456445


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7072278004177578; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6864334801501734; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.7334317037825127 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7019419192159073; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6875742396080381; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.7302452717272563 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7023906552295187; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6885763093982832; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 300 
last prior star auc 0.7314597562481595 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7030310658522607; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6893729833794049; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 400 
last prior star auc 0.7328465473766649 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7135320585283064 at iter 60
0.6898942306575938 at iter 490
0.7364742215593827 at iter 60
last anomaly aucs:
0.7037165453395944
0.6898942306575938
0.7339269335545613




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.37152719497681 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7037928563210929,first_prior_anomaly_auc= 0.689939035652955, first_prior_star_anomaly_auc= 0.7340599764206456


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7037928563210931 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6895709908500706 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7315567545773396 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7037928563210929 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6739045996628806 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.726924213590532 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.703792856321093 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5443382106921923 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7266728517614327 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7037928563210931 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6712147167258262 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8114657513570793 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7037928563210929 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6945564305459244 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8274879965886985 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7037928563210929 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7496039322848225 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8299064108612797 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7037928563210931 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7907418314002274 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8325036229245365 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7037928563210931 at iter 6
max_prior_anomaly= 0.8034776909120271 at iter 79
max_prior_star_anomaly= 0.832607429079867 at iter 72
last values
accuracies_anomaly['vanilla_star'][-1]= 0.703792856321093
accuracies_anomaly['prior'][-1]= 0.8034776909120271
accuracies_anomaly['prior_star'][-1]= 0.8318448997771889



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.47557067871094 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7037928563210929
 first_prior_anomaly_auc= 0.8039105419979544
 first_prior_star_anomaly_auc= 0.8317335469618625


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.710511178028348; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7161170270592618; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8216677801948199 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7128675302578846; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.712037028241396; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8230982152940716 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7132394803253824; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.7111493721495526; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8236084328384202 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7133187994161101; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.7108175829789569; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8236876463814558 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7133500943068631 at iter 420
0.8039105419979544 at iter 0
0.8317335469618625 at iter 0
last anomaly aucs:
0.7132242814576981
0.7108080836866543
0.823584526286125




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.4181022644043 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7132015887038637,first_prior_anomaly_auc= 0.7107793219405155, first_prior_star_anomaly_auc= 0.8235681663938259


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7132015887038637 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7687940331778617 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8362443386856568 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7132015887038639 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.768158372201271 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8339759076837665 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7132015887038637 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7687313906225097 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8327890238843872 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7132015887038637 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.769252374031468 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8318776723356331 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7132015887038637 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7693580800452589 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8310609970668297 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7132015887038639 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7707621282214474 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8307731685100572 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7132015887038637 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7711310174058699 iter_best_prior_anomaly= 670
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8302266425595737 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7132015887038639 at iter 2
max_prior_anomaly= 0.7715222827010499 at iter 76
max_prior_star_anomaly= 0.8376398902726191 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7132015887038637
accuracies_anomaly['prior'][-1]= 0.7714340448303267
accuracies_anomaly['prior_star'][-1]= 0.8297494614429003



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.07738137245178 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7132015887038637
 first_prior_anomaly_auc= 0.7712061673627536
 first_prior_star_anomaly_auc= 0.8296007447445166


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7023338177972407; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6270309750812454; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7415680059613337 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7019650869343568; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.63890276841042; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7480202947102663 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7010198018025435; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6292173427524094; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7414556504429308 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7000560458245861; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6270765716842984; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.744690898305854 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7132015887038637 at iter 0
0.7712061673627536 at iter 0
0.8296007447445166 at iter 0
last anomaly aucs:
0.6989779816959192
0.6367139731423342
0.7492690294573054




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.55821704864502 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6990491208404974,first_prior_anomaly_auc= 0.637159067760563, first_prior_star_anomaly_auc= 0.7493536787064918


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6990491208404974 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7253580441590435 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8176021358631004 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6990491208404974 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7225481007220518 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8172309246294485 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6990491208404974 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7214263926226385 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8170812580018343 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6990491208404974 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7215692514241022 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8170728141864543 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6990491208404974 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7218076308870545 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8169963448834172 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6990491208404974 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7215203828425893 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8169261028942234 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6990491208404974 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7220372498915497 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8167979152219825 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6990491208404974 at iter 0
max_prior_anomaly= 0.7254721412143683 at iter 11
max_prior_star_anomaly= 0.8177899579814636 at iter 15
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6990491208404974
accuracies_anomaly['prior'][-1]= 0.7222157310391486
accuracies_anomaly['prior_star'][-1]= 0.8166455043543701



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.32616925239563 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6990491208404974
 first_prior_anomaly_auc= 0.7222849175514202
 first_prior_star_anomaly_auc= 0.8166407547082186


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7032215266629303; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6911054959738834; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8241563309089028 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7031726580814174; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.6906854161587185; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.823954893138239 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7031337109829762; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.690694862677175; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8240019674089836 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7034623864966505; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.6905691553757023; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8242913791811399 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7038306423949194 at iter 470
0.7222849175514202 at iter 0
0.8250112144423019 at iter 490
last anomaly aucs:
0.7036965968257587
0.6922102108948439
0.8250112144423019




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.504664182662964 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7032856996598198,first_prior_anomaly_auc= 0.693495306821864, first_prior_star_anomaly_auc= 0.8242239869796366


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7032856996598198 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7395964278439033 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8267019301506482 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7032856996598198 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7366642601792833 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8247090841732291 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7032856996598198 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7349140683463526 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8231752123355699 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7032856996598198 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7341250465729192 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8221808475268593 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7032856996598198 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7340193405591282 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8211704394689261 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7032856996598198 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7337454970715793 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8210009826490149 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7032856996598198 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7339643502114649 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8203375626293619 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7032856996598198 at iter 0
max_prior_anomaly= 0.740140156780542 at iter 8
max_prior_star_anomaly= 0.8324240399645783 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7032856996598198
accuracies_anomaly['prior'][-1]= 0.7336524040070127
accuracies_anomaly['prior_star'][-1]= 0.8203010431278426



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.1688859462738 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7032856996598198
 first_prior_anomaly_auc= 0.7339551675622389
 first_prior_star_anomaly_auc= 0.820080553998727


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6337196378869774; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5995537971310025; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6761669088986204 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6363091977425459; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6134416569298922; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.694223955315329 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6652211382474227; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.611387434969428; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7179561955967614 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6785112814650864; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6279347271961572; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7375843194126481 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7032856996598198 at iter 0
0.7339551675622389 at iter 0
0.820080553998727 at iter 0
last anomaly aucs:
0.6850932355539512
0.6385700293105941
0.7534802240566411




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.64314889907837 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6819560414971306,first_prior_anomaly_auc= 0.6178874840491051, first_prior_star_anomaly_auc= 0.7420355294641661


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6819560942709768 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6558602717430885 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7698593260357659 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6819560414971306 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6672476011648243 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.77399874820437 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6819560414971306 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6709021372352204 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7755765806558522 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6819560414971306 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6727641568480927 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7762860194693273 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6819560414971307 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6739708836136152 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7767300058367874 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6819560942709768 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.674549337741005 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7768454750121117 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6819560414971306 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6750197638053743 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7769844813228081 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6819560942709768 at iter 1
max_prior_anomaly= 0.6753946692082551 at iter 79
max_prior_star_anomaly= 0.778560044498907 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6819560414971306
accuracies_anomaly['prior'][-1]= 0.6753946692082551
accuracies_anomaly['prior_star'][-1]= 0.7770545649904639



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.53628873825073 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6819560942709768
 first_prior_anomaly_auc= 0.6754388409174628
 first_prior_star_anomaly_auc= 0.7770693944412252


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6972206653937616; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.688853372090446; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 80 
last prior star auc 0.806605016259622 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6985511468284502; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.6952242307948058; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 200 
last prior star auc 0.8169244669049933 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.699810647440099; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.6954305237593132; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 270 
last prior star auc 0.8168944913603936 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6989747097174593; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 310 
last prior auc 0.6917783097381467; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 380 
last prior star auc 0.8155060114688123 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7048330816020874 at iter 310
0.6988759170775112 at iter 380
0.8200437178541309 at iter 380
last anomaly aucs:
0.7016147213699245
0.6912911543645553
0.8140817509095573




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.576255321502686 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7036672545673126,first_prior_anomaly_auc= 0.6880778076477747, first_prior_star_anomaly_auc= 0.8210998280628095


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7036672545673126 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7094044577012345 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8124334125996502 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7036672545673126 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7094355414966029 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8103241475176766 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7036672545673126 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7089458002045513 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8092266626136353 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7036672545673126 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7089171440061048 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.808189339894178 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7036672545673126 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7087309051031254 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8073786280699865 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7036672545673125 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7086749120523854 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.806928572710222 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7036672545673126 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7087786126600235 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8065863343180933 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7036672545673126 at iter 0
max_prior_anomaly= 0.7103429350068976 at iter 4
max_prior_star_anomaly= 0.8240337372643516 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7036672545673126
accuracies_anomaly['prior'][-1]= 0.708899253672268
accuracies_anomaly['prior_star'][-1]= 0.8062907480059402



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.40832924842834 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7036672545673125
 first_prior_anomaly_auc= 0.7088591455492121
 first_prior_star_anomaly_auc= 0.8062603502705715


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.28698749998680656; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5223048132914098; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.29061918498183 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 108


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 109 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7036672545673125 at iter 0
0.7088591455492121 at iter 0
0.8062603502705715 at iter 0
last anomaly aucs:
0.28698749998680656
0.5223048132914098
0.29061918498183




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 12.79169487953186 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 6:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 6 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5066804828595826
accuracies_anomaly["prior"][-1]= 0.6776030963471
accuracies_anomaly["prior_star"][-1]= 0.5068560614456445


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 827.0343894958496 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.005787372589111328 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4994090384710783
 first_prior_anomaly_auc= 0.6723524680744618
 first_prior_star_anomaly_auc= 0.4995995520555941


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7058364707384855; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6904148446496292; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7320144093709463 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7033671297043925; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6918186817304333; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.7314438713204755 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7033207414936475; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6929625548452196; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.7319255382140698 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7038316978718419; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6938049309770866; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.733119968673445 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7058364707384855 at iter 100
0.6943906151213957 at iter 490
0.7342054211405695 at iter 490
last anomaly aucs:
0.7044666727884328
0.6943906151213957
0.7342054211405695




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.36214733123779 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7045017146222606,first_prior_anomaly_auc= 0.6944411196921384, first_prior_star_anomaly_auc= 0.7342737632713029


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7045017146222606 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6945600719413071 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7340692118437175 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7045017146222606 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6946816101089357 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7338416510192213 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7045017146222606 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6948312767365498 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7335796816470507 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7045017146222606 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6949726578703219 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7333048882302712 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7045017146222606 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6951495558025371 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7329861341996688 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7045017146222606 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6953204902901401 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7326574586859946 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7045017146222606 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6954625047100658 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.732307304216947 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7045017146222606 at iter 0
max_prior_anomaly= 0.6956458410515083 at iter 79
max_prior_star_anomaly= 0.7342737632713029 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7045017146222606
accuracies_anomaly['prior'][-1]= 0.6956458410515083
accuracies_anomaly['prior_star'][-1]= 0.7319738262832752



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.73323178291321 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7045017146222606
 first_prior_anomaly_auc= 0.6956609871453465
 first_prior_star_anomaly_auc= 0.7319387844494474


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7049002627082059; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.696094629838966; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7326140258106326 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7056289639755172; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6964368682310945; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.7334574046455762 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.706335816870532; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6966842720217342; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.7342840013974514 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7068287245933511; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6968635975508713; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.734977396961704 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.707250018206977 at iter 490
0.6969558990077461 at iter 490
0.7355193315875745 at iter 490
last anomaly aucs:
0.707250018206977
0.6969558990077461
0.7355193315875745




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.27512550354004 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7072911290331092,first_prior_anomaly_auc= 0.6969665593246637, first_prior_star_anomaly_auc= 0.7355694667413945


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7072911290331092 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6971044573845915 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.735148278675461 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7072911290331092 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6971666777491743 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7347216021295303 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7072911290331092 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6971713218476334 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7342772463451472 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7072911290331092 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6971270973645798 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7338148419053891 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7072911818069554 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6969310425262207 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7333297974856428 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7072911290331092 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6964259440449465 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7328343038443635 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7072911818069554 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6953607039608882 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.732290627681571 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7072911818069554 at iter 1
max_prior_anomaly= 0.6971921147430071 at iter 29
max_prior_star_anomaly= 0.7355694667413945 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7072911290331092
accuracies_anomaly['prior'][-1]= 0.6937588066355723
accuracies_anomaly['prior_star'][-1]= 0.7318051610710559



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.41089177131653 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7072911290331092
 first_prior_anomaly_auc= 0.6935522498018344
 first_prior_star_anomaly_auc= 0.7317606727187714


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7076828692929045; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6935896664587377; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.7322478808662088 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7080034704081213; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.693578900594128; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 140 
last prior star auc 0.7326288552613942 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7083682432325459; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.693520796589543; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 140 
last prior star auc 0.7330413356427168 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7086278905554869; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6934447494772751; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 140 
last prior star auc 0.7333598785779348 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7088809411476622 at iter 490
0.6936008545141165 at iter 140
0.7336841738623806 at iter 490
last anomaly aucs:
0.7088809411476622
0.6933716049265441
0.7336841738623806




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.297897815704346 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.708905058795342,first_prior_anomaly_auc= 0.6933666969588543, first_prior_star_anomaly_auc= 0.7337129883823655


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7089050587953419 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6903980625665611 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7331341648380529 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7089050587953419 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6857973442089674 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7325712262214242 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7089050587953419 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6787501886664999 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7320240669847875 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7089050587953419 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6694369241713715 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7314768022004583 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7089050587953419 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6586507416308596 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7309396699945854 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7089050587953419 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6468954201800856 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7304238056487014 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7089050587953419 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6338843450607374 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.729955807181254 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.708905058795342 at iter 0
max_prior_anomaly= 0.6933666969588543 at iter 0
max_prior_star_anomaly= 0.7337129883823655 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7089050587953419
accuracies_anomaly['prior'][-1]= 0.6211114910828032
accuracies_anomaly['prior_star'][-1]= 0.7295653862676119



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.20316576957703 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7089050587953419
 first_prior_anomaly_auc= 0.6198240203327074
 first_prior_star_anomaly_auc= 0.7295270196814783


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7090905060906296; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6196702901189417; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7297866142305731 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7092858220951427; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6194889591836519; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.730014386150454 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7094642504688957; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.61920303048534; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7302155600518871 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7096155003118934; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6189597430546979; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7303854390625677 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7096155003118934 at iter 400
0.6198240203327074 at iter 0
0.7303854390625677 at iter 400
last anomaly aucs:
0.7094454629796746
0.6187287519302034
0.7302586235103261




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.350157260894775 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7094419271319842,first_prior_anomaly_auc= 0.6187082229040604, first_prior_star_anomaly_auc= 0.730257673581096


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7094419799058302 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.603492309267404 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7299251455766546 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7094419799058304 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5886128816736487 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7297268214629122 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7094419799058304 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5754474958282275 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.729668664684481 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7094419799058304 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5644320637001432 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7299552266689465 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7094419799058302 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5554607209540666 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7303458059041268 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7094419799058302 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5487563315421891 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7310690186914408 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7094419799058304 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5447860495504195 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7322709430369659 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7094419799058304 at iter 1
max_prior_anomaly= 0.6187082229040604 at iter 0
max_prior_star_anomaly= 0.7338457673792191 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7094419799058304
accuracies_anomaly['prior'][-1]= 0.5436714131463872
accuracies_anomaly['prior_star'][-1]= 0.7338457673792191



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.35394024848938 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7094419799058302
 first_prior_anomaly_auc= 0.5437017053340638
 first_prior_star_anomaly_auc= 0.7340394473945024


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7095039891750285; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5434274924295918; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7341035148436997 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7095005588750305; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.543180510829721; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7341529639375199 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7095071028319501; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5430126899990395; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7342159231359486 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7096033623272844; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5428799110021859; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7343526601712616 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7096943444380059 at iter 490
0.5437017053340638 at iter 0
0.7344555163973616 at iter 490
last anomaly aucs:
0.7096943444380059
0.5427713024268581
0.7344555163973616




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.339056730270386 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.709697299773389,first_prior_anomaly_auc= 0.5427630697068624, first_prior_star_anomaly_auc= 0.7344600549481286


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7096972997733891 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5447739643396567 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7370423847867779 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7096972997733891 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5509820685025633 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.740607891378759 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.709697299773389 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5619473127029814 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7451584745825325 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.709697299773389 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5759887443940982 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7507699176411358 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7096972997733891 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.591618352210538 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7579335978358501 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.709697299773389 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6092236545044061 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7664637512283112 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.709697299773389 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6269325518582199 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7759973465310168 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7096972997733891 at iter 2
max_prior_anomaly= 0.6413242963399227 at iter 79
max_prior_star_anomaly= 0.7844510306204411 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7096972997733891
accuracies_anomaly['prior'][-1]= 0.6413242963399227
accuracies_anomaly['prior_star'][-1]= 0.7844510306204411



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.36136388778687 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7096972997733891
 first_prior_anomaly_auc= 0.6426562554423029
 first_prior_star_anomaly_auc= 0.7852414772877198


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.714088769831092; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6423362876132395; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7852259090031126 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7153872703150282; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6420282994472467; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7852248007523439 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7161752893853852; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6417460121443174; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7853641237061173 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7166230754697663; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6414774988152272; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.785498222049124 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7169106401573082 at iter 490
0.6426562554423029 at iter 0
0.7856239293505968 at iter 490
last anomaly aucs:
0.7169106401573082
0.6412272452368966
0.7856239293505968




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.378700733184814 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.716930588671144,first_prior_anomaly_auc= 0.6412044997092161, first_prior_star_anomaly_auc= 0.7856358562398212


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7169305358972979 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6553148012695276 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7944987487321082 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7169304831234518 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6640914085233983 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8012501068670383 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7169304303496056 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6695865907989854 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8064537664166243 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7169304303496056 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6733732725800816 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8107328281820783 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7169305358972979 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6752833691667748 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8137249997097438 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7169304831234518 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6768434696059589 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8162669047822604 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7169304303496056 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6781659294160363 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8184774956487965 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.716930588671144 at iter 0
max_prior_anomaly= 0.6790427140955776 at iter 79
max_prior_star_anomaly= 0.820055433647971 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7169304303496056
accuracies_anomaly['prior'][-1]= 0.6790427140955776
accuracies_anomaly['prior_star'][-1]= 0.820055433647971



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.16218614578247 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7169304831234518
 first_prior_anomaly_auc= 0.6791190778509223
 first_prior_star_anomaly_auc= 0.8202018282971252


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7268717036136363; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6785879090896616; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8201835685463656 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7295217950707117; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6782190199052393; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8202032004171245 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7308296365254121; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6779621695961429; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8202132274478885 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7316724348480483; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6777672230085525; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8202195603094237 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7323661998292238 at iter 490
0.6791190778509223 at iter 0
0.8202625709940164 at iter 490
last anomaly aucs:
0.7323661998292238
0.6776336524040071
0.8202625709940164




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.256986141204834 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7324322726845738,first_prior_anomaly_auc= 0.677626158517857, first_prior_star_anomaly_auc= 0.8202666345801682


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7324322726845739 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6811396300975576 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8238768933936644 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7324322726845739 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6818050555233636 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8251895900422086 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7324322726845738 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6824329587445735 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8262443809047337 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7324322726845739 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.6831578602949636 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8271250180750424 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7324322726845739 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.6839062462068798 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.827860263299273 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7324322726845739 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.6847505749710536 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8285024154589372 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7324322726845739 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.6856425057444332 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8290249820832792 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.732432272684574 at iter 33
max_prior_anomaly= 0.686543724714731 at iter 79
max_prior_star_anomaly= 0.8294235301692247 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7324322726845739
accuracies_anomaly['prior'][-1]= 0.686543724714731
accuracies_anomaly['prior_star'][-1]= 0.8294235301692247



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.1850426197052 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7324322726845739
 first_prior_anomaly_auc= 0.6866387704116044
 first_prior_star_anomaly_auc= 0.8294586775507446


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7391204605256909; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6859746643319516; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8299198154181958 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.741202758172294; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6854361600060794; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.830223792771883 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7419731507780447; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6851141339970173; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8304371046579253 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7422545409255898; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6848849899571371; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.830633951103976 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.742307209224024 at iter 450
0.6866387704116044 at iter 0
0.8307055124393232 at iter 490
last anomaly aucs:
0.7422927491901852
0.684723185344914
0.8307055124393232




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.508800983428955 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7422887383778798,first_prior_anomaly_auc= 0.6847082503464603, first_prior_star_anomaly_auc= 0.8307076233931683


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7422887383778798 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6881659927446516 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8318381447248846 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7422887383778797 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6891592493025938 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8319054841525417 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7422887383778798 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6903896187511808 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8319272269771458 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7422887383778798 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6918674975381001 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8318828969463996 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7422887383778798 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6935984796910408 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8317969811249062 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7422887383778798 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6956315921130543 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8316610356972851 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7422887383778798 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6979936439179726 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8314828711927629 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7422887383778798 at iter 0
max_prior_anomaly= 0.7003441382505892 at iter 79
max_prior_star_anomaly= 0.8319336653863731 at iter 29
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7422887383778797
accuracies_anomaly['prior'][-1]= 0.7003441382505892
accuracies_anomaly['prior_star'][-1]= 0.8313034401159336



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.53907585144043 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4994090384710783
accuracies_anomaly["prior"][-1]= 0.6723524680744618
accuracies_anomaly["prior_star"][-1]= 0.4995995520555941


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 1060.8923876285553 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.006433010101318359 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4929933219975112
 first_prior_anomaly_auc= 0.6759086336956786
 first_prior_star_anomaly_auc= 0.49317565563587734


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7051926298157454; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.687944606460152; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.7308799300007706 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7037257279888204; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6893079132271313; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 200 
last prior star auc 0.731192034526761 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7041633287208993; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6903452887204347; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 300 
last prior star auc 0.7323458291246191 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7050992201081019; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6911263944169493; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 400 
last prior star auc 0.7338633938438253 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7055306990740301 at iter 490
0.6916591463935936 at iter 490
0.7349005054678981 at iter 490
last anomaly aucs:
0.7055306990740301
0.6916591463935936
0.7349005054678981




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.481847286224365 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7055851616832324,first_prior_anomaly_auc= 0.6917060095689538, first_prior_star_anomaly_auc= 0.7350264238647554


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7055851616832324 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6917572529735424 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7348408182479294 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7055851616832324 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6918820631196309 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7346360029511134 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7055851616832324 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6919993266057234 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7344106058543083 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7055851616832324 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6921665141502513 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7341563942375182 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7055851616832324 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6923489005624637 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7338875642653511 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7055851616832324 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6925151381777614 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7336035354254997 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7055851616832324 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6927038046776626 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7332844647518204 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7055851616832324 at iter 0
max_prior_anomaly= 0.6928596458452734 at iter 79
max_prior_star_anomaly= 0.7350264238647554 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7055851616832324
accuracies_anomaly['prior'][-1]= 0.6928596458452734
accuracies_anomaly['prior_star'][-1]= 0.7329943141458184



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.81113290786743 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7055851616832324
 first_prior_anomaly_auc= 0.6928697256498835
 first_prior_star_anomaly_auc= 0.7329606972058359


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7060574876060621; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6933366158665625; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7340130604714394 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7068158477748963; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6936599084479318; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.7350848972862634 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7075855015468014; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6939202418308725; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.7360096533919334 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7081938256710986; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6941190936830761; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.7367283276284806 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7087213530369765 at iter 490
0.6942407373983972 at iter 490
0.7372798670943459 at iter 490
last anomaly aucs:
0.7087213530369765
0.6942407373983972
0.7372798670943459




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.75223255157471 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7087769238969475,first_prior_anomaly_auc= 0.6942534031214674, first_prior_star_anomaly_auc= 0.7373298967004736


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7087769238969475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6944758976567357 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7369411645499077 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7087769238969475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.694677071558169 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7365423525947317 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7087769238969475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6948436258165434 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7361218505887979 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7087769238969475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6949748743718591 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7356857802982566 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7087769238969475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6950332422456749 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7352346694615697 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7087769238969475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6949252669565006 iter_best_prior_anomaly= 520
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.734764560040277 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7087769238969475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6946170149212773 iter_best_prior_anomaly= 520
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7342805710974533 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7087769238969475 at iter 0
max_prior_anomaly= 0.6950351948779817 at iter 52
max_prior_star_anomaly= 0.7373298967004736 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7087769238969475
accuracies_anomaly['prior'][-1]= 0.6939278412647146
accuracies_anomaly['prior_star'][-1]= 0.7338305685115348



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.44502449035645 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7087769238969475
 first_prior_anomaly_auc= 0.6938065669663167
 first_prior_star_anomaly_auc= 0.7337818582515603


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7092554771336201; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6938939604555016; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7342983558835978 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7097090155672291; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6938898968693499; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 130 
last prior star auc 0.7347580688572034 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7100357912224429; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6938499998416785; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 130 
last prior star auc 0.7351057957293292 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.710223982757729; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.693793795695554; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 130 
last prior star auc 0.735305069772302 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7104275842560839 at iter 490
0.6938971796601153 at iter 130
0.7355271421168013 at iter 490
last anomaly aucs:
0.7104275842560839
0.6937161125940562
0.7355271421168013




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.836493253707886 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7104394055976163,first_prior_anomaly_auc= 0.6937043968002161, first_prior_star_anomaly_auc= 0.7355416021506398


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7104393528237702 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6915353389505814 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.735015816321684 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7104393528237702 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6875849526988017 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7344842253696544 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7104393528237702 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6814354275050953 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7339322637130199 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7104393528237701 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6730424333387163 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7333837851302302 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7104393528237701 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6622565674412813 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7328292903289815 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7104393528237702 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.648354142060861 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7322844531415743 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7104393528237702 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6317011438203409 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.731740038144936 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7104394055976163 at iter 0
max_prior_anomaly= 0.6937043968002161 at iter 0
max_prior_star_anomaly= 0.7355416021506398 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7104394055976163
accuracies_anomaly['prior'][-1]= 0.6161378199546356
accuracies_anomaly['prior_star'][-1]= 0.7313112506451603



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.36795282363892 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7104394055976163
 first_prior_anomaly_auc= 0.614619252532353
 first_prior_star_anomaly_auc= 0.7312741506313336


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7106137703852173; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6142920546863704; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7314481460020117 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7107380000189986; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6139714007973073; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7316036705265458 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7108299320589504; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6135342222559974; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7317319637464786 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7108643406066248; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.6129785664301344; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7317820461264526 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7108765841389262 at iter 370
0.614619252532353 at iter 0
0.7317879040233726 at iter 370
last anomaly aucs:
0.7108416478527905
0.6125911008518754
0.7317733384418417




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.60476016998291 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7108475585235566,first_prior_anomaly_auc= 0.6125661388226578, first_prior_star_anomaly_auc= 0.7317800407202997


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7108475585235567 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5960117221267016 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7313622301805183 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7108475585235566 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5811711360836951 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7310558780037555 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7108475585235567 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5688083348901618 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7308896931623039 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7108475585235566 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5591014302767777 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7311194177144913 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7108475585235566 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5517064950883381 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7314093044512628 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7108475585235567 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5462571732850346 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7320027463509524 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7108475585235567 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5428615457037339 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7330775385011594 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7108475585235567 at iter 4
max_prior_anomaly= 0.6125661388226578 at iter 0
max_prior_star_anomaly= 0.7345801682219119 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7108475585235567
accuracies_anomaly['prior'][-1]= 0.5418519820273389
accuracies_anomaly['prior_star'][-1]= 0.7345801682219119



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.37305450439453 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7108475585235566
 first_prior_anomaly_auc= 0.5418577343765667
 first_prior_star_anomaly_auc= 0.7347683597571981


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7108748426020038; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5415637840536435; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7348084151064078 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7108598020558581; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.5413007592045505; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7347811310279606 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7108676653589308; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.5410986353738869; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7347916857971858 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7108661349173933; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.540946066184736; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.734794693906415 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7108843946681528 at iter 130
0.5418577343765667 at iter 0
0.7348188643279409 at iter 110
last anomaly aucs:
0.7108439699020201
0.5407871113602037
0.7347697846510435




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.79474997520447 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7108419644958672,first_prior_anomaly_auc= 0.540773917898672, first_prior_star_anomaly_auc= 0.7347739010110412


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7108419644958672 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5421869904025483 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7373505840481551 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7108419644958672 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5464874783495296 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7408918674447642 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7108419644958672 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.5550441242127462 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7455937532653818 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7108419644958672 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.568838099339377 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7512255670285898 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7108419117220212 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.587144449405186 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7577315795528788 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7108419644958672 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.6075296140437537 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7650605474336607 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7108419644958672 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.6265599157307224 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7733518463985544 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7108419644958673 at iter 23
max_prior_anomaly= 0.6394103472624624 at iter 79
max_prior_star_anomaly= 0.7813221748313084 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7108419644958673
accuracies_anomaly['prior'][-1]= 0.6394103472624624
accuracies_anomaly['prior_star'][-1]= 0.7813221748313084



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.62000441551208 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7108419117220212
 first_prior_anomaly_auc= 0.6405910037479986
 first_prior_star_anomaly_auc= 0.7821138880708942


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7139540909757778; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.640294784149692; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7821335727154993 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7153900145550267; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6400585684144309; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7822131029016116 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7162001986407569; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.639903149437589; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7822825532831138 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7167451941497025; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6398229331914773; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.782305246036948 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7171477002741075 at iter 490
0.6405910037479986 at iter 0
0.7823249834553992 at iter 490
last anomaly aucs:
0.7171477002741075
0.6397106832207666
0.7823249834553992




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.87587308883667 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7171799978679366,first_prior_anomaly_auc= 0.6396975425330813, first_prior_star_anomaly_auc= 0.7823297331015505


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7171799978679366 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6532546686382975 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.791693607715114 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7171799978679366 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6619024021599279 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7990562980835705 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7171799978679366 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6667176462020246 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8044942207361108 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7171799978679366 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.669543738435931 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8083518305664005 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7171799978679366 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.6715407007733479 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8113667476217467 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7171799978679366 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.6738838067675068 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8145312785308605 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7171799978679366 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.6760412543709938 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8173924653724409 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7171799978679367 at iter 31
max_prior_anomaly= 0.6772870865564959 at iter 79
max_prior_star_anomaly= 0.8192433497037804 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7171799978679366
accuracies_anomaly['prior'][-1]= 0.6772870865564959
accuracies_anomaly['prior_star'][-1]= 0.8192433497037804



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.51075792312622 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7171799978679366
 first_prior_anomaly_auc= 0.6774111050948926
 first_prior_star_anomaly_auc= 0.8194267915929152


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7309749756976438; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6768434168321127; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.819337234376039 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7325033062814599; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6764452381630902; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8193410340929601 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7331121053703722; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6762177301124399; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8193343318145021 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7335269078009243; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6760968252309648; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8192945403345228 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7338671407869002 at iter 490
0.6774111050948926 at iter 0
0.8194355520513721 at iter 10
last anomaly aucs:
0.7338671407869002
0.6760477983279135
0.8193318514437342




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.41635870933533 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7338970635576538,first_prior_anomaly_auc= 0.6760570337509856, first_prior_star_anomaly_auc= 0.8193350706483478


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7338970635576538 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.680953285646886 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.824170632621203 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7338970635576538 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6818973569802382 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8257211809942381 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7338970635576538 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6827665422259376 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.826946800796674 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7338970635576538 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6836672862316201 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8280013805638147 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7338970635576538 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6846447106357243 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8288890366556582 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7338970635576538 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6857062565505536 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8296568961167948 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7338970635576538 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.686825537053045 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8303188912426025 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7338970635576538 at iter 0
max_prior_anomaly= 0.6879028623478662 at iter 79
max_prior_star_anomaly= 0.8308456797746344 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7338970635576538
accuracies_anomaly['prior'][-1]= 0.6879028623478662
accuracies_anomaly['prior_star'][-1]= 0.8308456797746344



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.8601713180542 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7338970635576538
 first_prior_anomaly_auc= 0.6880225006570344
 first_prior_star_anomaly_auc= 0.8308951816423009


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7401503949066905; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6878133051309899; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.8318351893895015 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7418769968304028; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6876290188603171; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.8321731003262478 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7424232061378093; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6876479646710765; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.8323698939984527 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7426144585561709; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6877764162125477; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.8324276285861147 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7426560443469185 at iter 490
0.6880651946985505 at iter 20
0.8324546487953315 at iter 490
last anomaly aucs:
0.7426560443469185
0.687894418532486
0.8324546487953315




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.24129605293274 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7426574692407638,first_prior_anomaly_auc= 0.6879107256509391, first_prior_star_anomaly_auc= 0.8324510601737948


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7426574692407638 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6901916112805152 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8332905865179709 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7426574692407637 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6912150017045953 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8335151920070845 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7426574692407637 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6923925445332101 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8335951971578117 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7426574692407637 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6937098852802133 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8335604719670606 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7426574692407638 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6951837532548271 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8334339202840501 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7426574692407637 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6968409575708832 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8332212416841612 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7426574692407637 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6986569056160871 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8329499841150723 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7426575220146099 at iter 1
max_prior_anomaly= 0.7004793448443647 at iter 79
max_prior_star_anomaly= 0.8335972025639646 at iter 31
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7426574692407638
accuracies_anomaly['prior'][-1]= 0.7004793448443647
accuracies_anomaly['prior_star'][-1]= 0.8326755601152158



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.82850456237793 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4929933219975112
accuracies_anomaly["prior"][-1]= 0.6759086336956786
accuracies_anomaly["prior_star"][-1]= 0.49317565563587734


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 1079.0004796981812 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0057332515716552734 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5042189523547163
 first_prior_anomaly_auc= 0.6806466168270464
 first_prior_star_anomaly_auc= 0.5043982251100071


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7050415910681321; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6899087434652785; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.731127597660641 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7006324417719769; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6910237492862338; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 200 
last prior star auc 0.7288280828633822 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7011574359932407; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6919986405457238; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 300 
last prior star auc 0.7302203096980386 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7020882610912154; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6927267085268815; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 400 
last prior star auc 0.7316378152049895 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7097702332287357 at iter 50
0.693219827345085 at iter 490
0.7330972231457645 at iter 490
last anomaly aucs:
0.7031827906598737
0.693219827345085
0.7330972231457645




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.70862078666687 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7032811611090529,first_prior_anomaly_auc= 0.6932556080127587, first_prior_star_anomaly_auc= 0.7332294216303108


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7032811611090529 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.783369114001007 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8310013626207069 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7032811611090529 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.8226474738743075 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8325879555306464 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7032811611090529 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.8221004201853628 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8284293764558984 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7032811611090529 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.8187878058640188 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.823649754759937 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7032811611090529 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.8105940857406124 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8195456382943915 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7032811611090529 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.8023375647403157 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8117498857446233 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.703281161109053 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7927105597299668 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8050214314589119 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7032811611090529 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7935409561987632 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8075438629822078 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7032811611090529 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7800495863058202 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.796819531389356 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7032811611090529 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7813829175281997 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.805648120881661 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7032811611090529 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7743683234487919 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7941310205723007 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7032811611090529 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7710860013151243 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7904460339926898 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.703281161109053 at iter 3
max_prior_anomaly= 0.8231073979432977 at iter 21
max_prior_star_anomaly= 0.835633639738284 at iter 12
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7032811611090529
accuracies_anomaly['prior'][-1]= 0.7840220320252808
accuracies_anomaly['prior_star'][-1]= 0.8002456094798714



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.98702049255371 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7032811611090529
 first_prior_anomaly_auc= 0.7810325519637676
 first_prior_star_anomaly_auc= 0.8013614596823648


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.28783367583559466; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.733179814214952; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.30507177770811633 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 142


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 143 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7059662943999561 at iter 50
0.7810325519637676 at iter 0
0.8013614596823648 at iter 0
last anomaly aucs:
0.28771715118334795
0.685398321158407
0.2969694091123545




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 17.240607261657715 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5042189523547163
accuracies_anomaly["prior"][-1]= 0.6806466168270464
accuracies_anomaly["prior_star"][-1]= 0.5043982251100071


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 201.25237131118774 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.006360054016113281 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4843813163697082
 first_prior_anomaly_auc= 0.6692334809945548
 first_prior_star_anomaly_auc= 0.48456681643884203


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7035137882227773; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6865931738085513; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.7303359371949012 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7020620852635368; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6879686713339856; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 200 
last prior star auc 0.7302107576318897 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7020101030251024; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6891775618271995; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 300 
last prior star auc 0.7307099454423979 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7030959249091497; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6901758319005233; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 400 
last prior star auc 0.7325923357598747 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7039552414456234 at iter 490
0.6909269620524383 at iter 490
0.7338595413530582 at iter 490
last anomaly aucs:
0.7039552414456234
0.6909269620524383
0.7338595413530582




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.55656456947327 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.704076251874791,first_prior_anomaly_auc= 0.6909926127170192, first_prior_star_anomaly_auc= 0.7340151186514382


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.704076251874791 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7682146818950877 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8242447271011644 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.704076251874791 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.8121345543090374 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8274952793794639 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.704076251874791 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.8140126171711317 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.824645069497878 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.704076251874791 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.8125534203257414 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8216787571548143 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.704076251874791 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.8070674206993801 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8189526185854709 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.704076251874791 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.8086381814554815 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8187194109594391 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7040762518747908 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.806298611309013 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8158953769055317 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.704076251874791 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7966927686109606 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.811129054218794 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.704076251874791 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7952497205624849 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8105302293867995 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.704076251874791 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7920406485272403 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8119355969091413 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7040762518747908 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7880349025108742 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8059806488861023 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.704076251874791 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7723372164329314 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8120538630983103 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.704076251874791 at iter 0
max_prior_anomaly= 0.8145723365831469 at iter 34
max_prior_star_anomaly= 0.8305256063978789 at iter 12
last values
accuracies_anomaly['vanilla_star'][-1]= 0.704076251874791
accuracies_anomaly['prior'][-1]= 0.7801327578873152
accuracies_anomaly['prior_star'][-1]= 0.8042516721393145



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.98021507263184 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.704076251874791
 first_prior_anomaly_auc= 0.787869403729422
 first_prior_star_anomaly_auc= 0.805837473441562


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.28737501833891155; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7420369015841652; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.3420004876303382 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.2881033501892998; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6942345628584004; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.2984399523346622 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 215


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 216 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7094592369535137 at iter 10
0.787869403729422 at iter 0
0.8089351926614801 at iter 20
last anomaly aucs:
0.28797859281705734
0.6934655423726488
0.2978365361780548




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 25.94321084022522 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4843813163697082
accuracies_anomaly["prior"][-1]= 0.6692334809945548
accuracies_anomaly["prior_star"][-1]= 0.48456681643884203


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 209.63629364967346 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.005782127380371094 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4849301643694212
 first_prior_anomaly_auc= 0.6638274337450749
 first_prior_star_anomaly_auc= 0.48511297297240247


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7056775159139532; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6894518802793637; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7315585488881078 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7023784116972174; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.690633856111053; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.7297394344121363 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7023628961864563; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.691743742868934; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.7307431929654573 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7028161179769884; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6927416962991811; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.7320329857647828 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7066879239718863 at iter 70
0.6934773637141811 at iter 490
0.7329848148535156 at iter 490
last anomaly aucs:
0.7031915511183304
0.6934773637141811
0.7329848148535156




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.35944986343384 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7032540353521439,first_prior_anomaly_auc= 0.6935401118172251, first_prior_star_anomaly_auc= 0.7331039781980687


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.703254035352144 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6915263673967401 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7306743758701087 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7032540353521441 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6596593026041782 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7257531091711446 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.703254035352144 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5195224178020958 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.72476629102243 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.703254035352144 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6593655106027935 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8053451462310502 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7032540353521441 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6778093893116074 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8209606106567283 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.703254035352144 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7314251366051008 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8209023483306049 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.703254035352144 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7896023912885157 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8262872860416344 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7032540353521441 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.801749083582162 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8268498552413401 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7032540353521441 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.8053335359849024 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8274523214687173 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7032540353521439 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.8069292059963755 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8275805619148041 iter_best_prior_star_anomaly= 990
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7032540353521441 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.8078979227158688 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8274193905887345 iter_best_prior_star_anomaly= 1020
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7032540353521439 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.8088655839584395 iter_best_prior_anomaly= 1190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8274381780779555 iter_best_prior_star_anomaly= 1020
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7032540353521441 at iter 2
max_prior_anomaly= 0.8098174130471724 at iter 129
max_prior_star_anomaly= 0.827623625373243 at iter 102
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7032540353521441
accuracies_anomaly['prior'][-1]= 0.8098174130471724
accuracies_anomaly['prior_star'][-1]= 0.8272848172811125



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.36788320541382 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7032540353521441
 first_prior_anomaly_auc= 0.8098624819117642
 first_prior_star_anomaly_auc= 0.827227293788835


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7055618356432446; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7146298600754244; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8121869587382406 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7066419051780642; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7078522205651234; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8130159303131916 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7067819141918371; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7067815447749143; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8129949263224334 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7066767359165075; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.707547293282206; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8130338734208745 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7068830288810151 at iter 490
0.8098624819117642 at iter 0
0.827227293788835 at iter 0
last anomaly aucs:
0.7068830288810151
0.7078975532989459
0.8132326197253859




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.4946346282959 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7068824483687077,first_prior_anomaly_auc= 0.7079001919912523, first_prior_star_anomaly_auc= 0.8132544680976823


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7068824483687077 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7530357099507197 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8250999800514862 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7068824483687077 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7466113913402341 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.820018703051067 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7068824483687077 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.742447271011643 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.817047218871083 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7068824483687077 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7406071525449132 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8156542004287348 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7068824483687077 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.74047627340652 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8146106503954345 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7068824483687077 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7402277613651116 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.813873083121974 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7068824483687077 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.739980832539087 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8131390516962042 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7068824483687077 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7397173854992247 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8124865558626994 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7068824483687077 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.739807417680716 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8121181944167382 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7068824483687077 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7393884461163199 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.811491927184758 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7068824483687077 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7395305660839379 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8111180772587997 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7068824483687077 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7393411079763448 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8106278610021331 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7068824483687077 at iter 0
max_prior_anomaly= 0.7530357099507197 at iter 10
max_prior_star_anomaly= 0.8258747001126194 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7068824483687077
accuracies_anomaly['prior'][-1]= 0.7393071216194392
accuracies_anomaly['prior_star'][-1]= 0.810364044545348



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.88998556137085 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7068824483687077
 first_prior_anomaly_auc= 0.7393782607640175
 first_prior_star_anomaly_auc= 0.8104159212360902


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7006768773504151; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6335508671270657; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7804153090594752 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6998889638277503; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6335425288593778; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7884624762121888 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.700146711292231; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6384324478937431; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.796865127992409 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6999540867538702; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6352472824107938; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.797604278481253 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7068824483687077 at iter 0
0.7393782607640175 at iter 0
0.8104159212360902 at iter 0
last anomaly aucs:
0.7001292959230093
0.6413162747153115
0.8024450650648749




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.59597706794739 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7003639284428866,first_prior_anomaly_auc= 0.6365316922778141, first_prior_star_anomaly_auc= 0.7979629295395272


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7003639284428866 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7114223184817174 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8283302143990273 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7003639284428865 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7192412915237816 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8218460502470344 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7003639284428866 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7150303607936764 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8172745686001949 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7003639284428865 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7138608395896728 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8152524859120218 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7003639284428865 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7137948195081689 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8142366421479377 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7003639284428865 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7141838155279654 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.813734657323585 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7003639284428866 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7145475328754674 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.813423238857594 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7003639284428866 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7149650267721721 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8132417496007659 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7003639284428866 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7153739713058044 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8132674504638293 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7003639284428865 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7158903106163035 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8131493953700449 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7003639284428866 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7162499643776539 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.813367615223777 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7003639284428865 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7168403453942682 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8132719890145963 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7003639284428866 at iter 0
max_prior_anomaly= 0.7224487803436422 at iter 15
max_prior_star_anomaly= 0.8299632482935577 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7003639284428865
accuracies_anomaly['prior'][-1]= 0.7171849058356263
accuracies_anomaly['prior_star'][-1]= 0.8133000647007353



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 128.9758050441742 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7003639284428866
 first_prior_anomaly_auc= 0.7173290312093972
 first_prior_star_anomaly_auc= 0.8132742582899797


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6849105324986622; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5972316423537558; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7123423249412363 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6794201526430725; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5846317810434234; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7025532514494337 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6844402647558312; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5880818184600802; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7076975404221275 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6836586313208555; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5907806201771302; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7115862868216318 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7003639284428866 at iter 0
0.7173290312093972 at iter 0
0.8132742582899797 at iter 0
last anomaly aucs:
0.6814579091635451
0.581790226072602
0.6997522795662834




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.83516335487366 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6851688604754502,first_prior_anomaly_auc= 0.5869991102329544, first_prior_star_anomaly_auc= 0.704182907817812


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6851688604754501 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.646509379495672 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7657365276286916 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6851688604754501 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6636198742082604 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7689754168869974 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6851688604754501 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6665599579497994 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7704208397585491 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6851688604754502 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6673004277847967 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7711612040458542 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6851688604754502 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6678859008337212 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7717512684193917 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6851688604754501 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6684108422811389 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7723498821560015 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6851688604754501 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6690432312792697 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.773006758218735 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6851688604754501 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6697466538742863 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7736809968768438 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6851688604754501 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.670585494158463 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7743337038057332 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6851688604754501 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6714359974626335 iter_best_prior_anomaly= 990
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7750806120499578 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6851688604754502 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.672760990417325 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7758485770587868 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6851688604754501 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6737006815214489 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7765826612584029 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6851688604754502 at iter 0
max_prior_anomaly= 0.6745624256548443 at iter 129
max_prior_star_anomaly= 0.8028115794262216 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6851688604754501
accuracies_anomaly['prior'][-1]= 0.6745624256548443
accuracies_anomaly['prior_star'][-1]= 0.7772152085780719



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.0360381603241 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6851688604754501
 first_prior_anomaly_auc= 0.674630028951732
 first_prior_star_anomaly_auc= 0.7772765845611169


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6918421133181134; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.605174475612678; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7150262972075248 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6903844996881066; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6057415833631505; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7137699630266434 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6944523077475173; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.598466180936187; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7156328797948998 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6856550659198113; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.592436769016264; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7023542412756916 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6948385595273152 at iter 460
0.674630028951732 at iter 0
0.7772765845611169 at iter 0
last anomaly aucs:
0.6928295119791353
0.6106348271498219
0.7198058133557939




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.42050838470459 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6905775464172363,first_prior_anomaly_auc= 0.6088798328968936, first_prior_star_anomaly_auc= 0.7175418681308242


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6905775464172363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6555717043524703 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.759281705735145 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6905775464172363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6630681764208566 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7632686114884442 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6905775464172363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6642506799910073 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7633826029960769 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6905775464172363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6669381881049862 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7645141798047157 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6905775464172363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6688602115809038 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7654025219565587 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6905775464172363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6707048685984005 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7663427407991439 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6905775464172363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6722420651883657 iter_best_prior_anomaly= 670
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7671219994110439 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6905775464172363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6732958005739683 iter_best_prior_anomaly= 770
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7677417754599505 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6905775464172363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6732029713786323 iter_best_prior_anomaly= 860
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7677072085907378 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6905775464172363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6745916095917521 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7683657734165472 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6905775464172363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6761736639509246 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7691990724468805 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6905775464172363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.675926365707977 iter_best_prior_anomaly= 1180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7689765779116122 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6905775464172363 at iter 0
max_prior_anomaly= 0.6772468728857477 at iter 128
max_prior_star_anomaly= 0.7987632449160313 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6905775464172363
accuracies_anomaly['prior'][-1]= 0.6765679901291799
accuracies_anomaly['prior_star'][-1]= 0.7691217587623056



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.80673432350159 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6905775464172363
 first_prior_anomaly_auc= 0.6772737875472722
 first_prior_star_anomaly_auc= 0.7695332364405518


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.2863532111302153; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6820907203524449; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 90 
last prior star auc 0.6301739742611399 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.33250404511530557; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6915233065136648; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 160 
last prior star auc 0.6708838247106146 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5318941905494707; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6962340583404314; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 270 
last prior star auc 0.6959743582436442 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6483860174639211; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7016768361868153; count_not_improved_prior_anomaly= 31; iter_best_prior_anomaly= 270 
last prior star auc 0.7149025425383586 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6951689238040655 at iter 20
0.7036621882780845 at iter 270
0.7695332364405518 at iter 0
last anomaly aucs:
0.6845840207126791
0.6963285762988436
0.7219568753238995




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.376752853393555 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6654693336457544,first_prior_anomaly_auc= 0.6938135331140052, first_prior_star_anomaly_auc= 0.7171818977263972


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6654693336457544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7188884455885816 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7373019265620266 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6654693336457544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7325763980583446 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7461951112419902 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6654693336457544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7320487651447745 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7451537249363811 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6654693336457544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7318305452910425 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7446816101089359 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6654693336457544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7310805233898964 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7436735768740784 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6654693336457544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7312577379651882 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7437685697971057 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6654693336457544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7310097008883949 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7433163507096499 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6654693336457544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7318114411587447 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7441929770676529 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6654693336457544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7312770004190243 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7433839540065377 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6654693336457544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.731098360949887 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7431202430974448 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6654693336457544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.731480021405072 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.743440105378816 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6654693336457544 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7315915853157828 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7435191078264669 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6654693336457544 at iter 0
max_prior_anomaly= 0.7334250542779008 at iter 25
max_prior_star_anomaly= 0.7478322087226724 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6654693336457544
accuracies_anomaly['prior'][-1]= 0.7320863928970627
accuracies_anomaly['prior_star'][-1]= 0.7439959195262176



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.51252436637878 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6654693336457544
 first_prior_anomaly_auc= 0.7322355317862153
 first_prior_star_anomaly_auc= 0.7441977794876504


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5792482682262393; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6058515640584776; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6161033058592691 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6308283699531051; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6356478359028919; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6680646458505508 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.2875762450141909; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6522700142172742; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.39902906677896943 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.27904276686942375; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6541726169178175; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4159103646778315 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6654693336457544 at iter 0
0.7322355317862153 at iter 0
0.7441977794876504 at iter 0
last anomaly aucs:
0.2848411348910062
0.6598967321379001
0.2977469789611785




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.381043910980225 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.28460961602805035,first_prior_anomaly_auc= 0.6588909681784263, first_prior_star_anomaly_auc= 0.29795992143029787


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.28460961602805035 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6815572295419547 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29933325522804105 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.28460961602805035 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.692781276683776 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29949907065256975 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.28460961602805035 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6984708778084922 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29957992018483515 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.28460961602805035 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7018546840482607 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29966314454017623 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.28460961602805035 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7039452671887055 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29969222292939174 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.28460961602805035 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7054652595048336 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2997157600647641 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.28460961602805035 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7066548347703652 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2997118548001507 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.28460961602805035 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7075946841960274 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2997056274863078 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.28460961602805035 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7083304571587195 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29968594284170275 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.28460961602805035 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7088600427045963 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29966609987555926 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.28460961602805035 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7091957371398053 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2996438820863402 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.28460961602805035 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7093793373504785 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2996084708355894 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.28460961602805035 at iter 0
max_prior_anomaly= 0.7094189705089193 at iter 129
max_prior_star_anomaly= 0.30102402371023357 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.28460961602805035
accuracies_anomaly['prior'][-1]= 0.7094189705089193
accuracies_anomaly['prior_star'][-1]= 0.2995753288602221



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 121.26976037025452 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.28460961602805035
 first_prior_anomaly_auc= 0.7094101045027701
 first_prior_star_anomaly_auc= 0.2995720041079162


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 93


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 94 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.2857541224289901 at iter 20
0.7094101045027701 at iter 0
0.2995720041079162 at iter 0
last anomaly aucs:
0.28403612264219646
0.6287840167018668
0.2945850867443709




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 11.020845413208008 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 7:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4849301643694212
accuracies_anomaly["prior"][-1]= 0.6638274337450749
accuracies_anomaly["prior_star"][-1]= 0.48511297297240247


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 1294.5280466079712 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.006045103073120117 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5055144447294232
 first_prior_anomaly_auc= 0.6777618928500938
 first_prior_star_anomaly_auc= 0.5056955117954824


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7076045001314069; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6907188747771624; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.7339575423853144 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7062368131351991; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6919989044149545; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 200 
last prior star auc 0.7339297305684059 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7070766561224522; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6930532730867106; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 300 
last prior star auc 0.735764149459754 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7080307017127224; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6939046207724191; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 400 
last prior star auc 0.7372802365112688 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7084636583463421 at iter 490
0.694501545745953 at iter 490
0.7381863106754102 at iter 490
last anomaly aucs:
0.7084636583463421
0.694501545745953
0.7381863106754102




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.6371214389801 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7085194930755436,first_prior_anomaly_auc= 0.6945531057936184, first_prior_star_anomaly_auc= 0.7382561832476814


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7085194930755436 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6935766840925907 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7358141262920357 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7085194930755437 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6625251863180637 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7308920679853795 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7085194930755437 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5148770527706796 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7296250734875807 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7085194930755437 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6542662904946914 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8063034137290105 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7085194930755437 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6794344015815266 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8267021940198789 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7085194930755436 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7417196779951005 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8278650129454244 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7085194930755437 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7927258641453433 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8327973621520751 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7085194930755437 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.8001349427245448 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8329853425919769 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7085194930755437 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.8034418046966612 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8337945767484767 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7085194930755436 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.8064206244412568 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8346649230187908 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7085194930755436 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.8091182651336921 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8353138302307589 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7085194930755436 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.8114752506493821 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8355248200675717 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7085194930755437 at iter 1
max_prior_anomaly= 0.813075828628545 at iter 129
max_prior_star_anomaly= 0.8356449861152011 at iter 126
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7085194930755436
accuracies_anomaly['prior'][-1]= 0.813075828628545
accuracies_anomaly['prior_star'][-1]= 0.835564294904474



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.53233408927917 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7085194930755436
 first_prior_anomaly_auc= 0.8132319864392326
 first_prior_star_anomaly_auc= 0.8355334749783363


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7062882148613262; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7248732636085278; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8225202889051432 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7065315022919681; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7170241039264798; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8226201370220141 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7059796989568721; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7148977401183612; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8210167620290065 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7055426259632548; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7153048375673791; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8203445287770506 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7085194930755436 at iter 0
0.8132319864392326 at iter 0
0.8355334749783363 at iter 0
last anomaly aucs:
0.705321186904909
0.7154910236965124
0.8202053113709695




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.66660928726196 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.705314959591066,first_prior_anomaly_auc= 0.715482896524209, first_prior_star_anomaly_auc= 0.8201965509125124


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7053149068172199 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.751880384911324 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8267140681352573 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7053149068172199 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7514378234377095 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8246299761778858 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7053149068172199 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.751818903380587 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8236725002876174 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7053149068172199 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.751898275245161 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8229379411233864 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7053149068172199 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7504382867920785 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8216144786102325 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7053149068172199 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7514952413822947 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8215480891118057 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7053149068172199 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7511689406916964 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.820934593150588 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7053149068172199 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7505099009012717 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8203124422786059 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.70531490681722 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7511601274593932 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8202703815232432 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7053149068172199 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7518347355344248 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8204001524108676 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7053149068172199 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7511067203271133 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8198133072419438 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7053149068172199 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7517749427667638 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8199782782849343 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.705314959591066 at iter 0
max_prior_anomaly= 0.7606699745313419 at iter 5
max_prior_star_anomaly= 0.8311450130298627 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7053149068172199
accuracies_anomaly['prior'][-1]= 0.7518841846282451
accuracies_anomaly['prior_star'][-1]= 0.8198982203603609



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.42511081695557 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7053148540433738
 first_prior_anomaly_auc= 0.752044247703546
 first_prior_star_anomaly_auc= 0.8199955881064638


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6876686520187579; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5974509704582565; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6947012947535409 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6876852230064416; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6004751757105207; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6979995545887387 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6885534583229106; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6023124971634057; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7004069391274794 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6890147017380538; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5873685799296842; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6946664640150976 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7053148540433738 at iter 0
0.752044247703546 at iter 0
0.8199955881064638 at iter 0
last anomaly aucs:
0.689786044273035
0.603579227791974
0.7105963550159957




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.554319620132446 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6902259670543434,first_prior_anomaly_auc= 0.6022190874557624, first_prior_star_anomaly_auc= 0.7040537702163411


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6902259670543434 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7189331450362504 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8123718782950671 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6902259670543434 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7416467973136001 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8248968535177462 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6902259670543434 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7490657973758734 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8288295077572277 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6902259670543434 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7525000554125384 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8304610639840666 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6902259670543434 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7543493565284942 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8312447028251951 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6902259670543434 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7554709590802151 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8315835636911717 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6902259670543434 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7563753444812805 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8317986698879822 iter_best_prior_star_anomaly= 670
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6902259670543434 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7569637200917421 iter_best_prior_anomaly= 780
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8318611541217957 iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6902259670543434 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7574077064592021 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8316703238942033 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6902259670543434 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7584900980432514 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8321322005955001 iter_best_prior_star_anomaly= 980
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6902259670543434 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7589849583983771 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8318973569802384 iter_best_prior_star_anomaly= 1040
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6902259670543434 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7599517224855638 iter_best_prior_anomaly= 1190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8319520834586712 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6902259670543434 at iter 0
max_prior_anomaly= 0.7609058736235261 at iter 129
max_prior_star_anomaly= 0.8326769322352152 at iter 119
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6902259670543434
accuracies_anomaly['prior'][-1]= 0.7609058736235261
accuracies_anomaly['prior_star'][-1]= 0.8323362242846242



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.68454813957214 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6902259670543434
 first_prior_anomaly_auc= 0.7609901534557897
 first_prior_star_anomaly_auc= 0.8322220744554532


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6898702713314524; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6138265365896907; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.725972753918722 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6922050390579235; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6221900829499313; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7315957016757807 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6961687243189271; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6192048247961082; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7298003882044121 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6933674885665462; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6319853837555769; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7409775193970272 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6961687243189271 at iter 300
0.7609901534557897 at iter 0
0.8322220744554532 at iter 0
last anomaly aucs:
0.6921905262502388
0.6153787737258019
0.7245115516671785




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.48698306083679 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6967394206909363,first_prior_anomaly_auc= 0.6303235881149076, first_prior_star_anomaly_auc= 0.740197785820512


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6967394206909363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6822656128785073 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7861103458903422 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6967394206909363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6881480496369687 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7901072786744054 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6967394206909363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6903484551512024 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7917824788719906 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6967394206909363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6927250197638054 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7934113964065233 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6967394206909363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6948088478519462 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7951224828194744 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6967394206909363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.697725447231959 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7967324545432476 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6967394206909363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.699996675247694 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7983528227147078 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6967394206909363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7019367473789869 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.799808958677023 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6967394206909363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7041938847778063 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8011565916117027 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6967394206909363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7048334510190102 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8020565967835396 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6967394206909363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7070828834362951 iter_best_prior_anomaly= 1090
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8029669456292172 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6967394206909363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7084616529401894 iter_best_prior_anomaly= 1190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.803754014770344 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6967394206909363 at iter 0
max_prior_anomaly= 0.7096866922303178 at iter 127
max_prior_star_anomaly= 0.8043931060469328 at iter 127
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6967394206909363
accuracies_anomaly['prior'][-1]= 0.7096551334703343
accuracies_anomaly['prior_star'][-1]= 0.8043788571084788



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.92064380645752 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6967394206909363
 first_prior_anomaly_auc= 0.7088424162399901
 first_prior_star_anomaly_auc= 0.8041314005439928


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7000077049815344; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6367996778684433; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7675221834862191 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7039839504179161; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.652954279906147; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7788135172818513 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7060028139014756; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.664276855818686; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7906206098756754 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7045879998606771; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.6501842334968267; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7873746489219887 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7077797093005461 at iter 370
0.7088424162399901 at iter 0
0.8041314005439928 at iter 0
last anomaly aucs:
0.7022555541834354
0.6590714019583319
0.7884397306845085




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.864771366119385 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.703231870336771,first_prior_anomaly_auc= 0.6698289810742434, first_prior_star_anomaly_auc= 0.7995530582971568


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.703231870336771 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.722439122729801 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8176024525061771 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7032318703367709 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.727541667590209 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8182222285550838 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7032318703367709 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7291788706185833 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8187678045763369 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.703231870336771 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7304416959825382 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8190443923038844 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7032318703367709 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7318074303464391 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8193244631052765 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.703231870336771 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7328057004197632 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8194466345590586 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7032318703367709 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7336155678624166 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8195026803836448 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.703231870336771 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7340791861006355 iter_best_prior_anomaly= 790
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8194814125236559 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7032318703367709 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7351081177785588 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8198565817957674 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7032318703367709 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7355778050090823 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8197160978173792 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7032318703367709 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7357855756412813 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.819566747832842 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7032318703367709 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7365475244316521 iter_best_prior_anomaly= 1190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8197202669512234 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.703231870336771 at iter 0
max_prior_anomaly= 0.7369597409437442 at iter 127
max_prior_star_anomaly= 0.8259792451017954 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7032318703367709
accuracies_anomaly['prior'][-1]= 0.7368925070637793
accuracies_anomaly['prior_star'][-1]= 0.8195805745805271



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.57409143447876 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.703231870336771
 first_prior_anomaly_auc= 0.736745268033087
 first_prior_star_anomaly_auc= 0.8195389887897796


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3465803075448657; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5411140453369557; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.40028788133061866 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 159


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 160 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.703231870336771 at iter 0
0.736745268033087 at iter 0
0.8195389887897796 at iter 0
last anomaly aucs:
0.3034606977335744
0.5562239890905906
0.3041811135070437




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 18.74889636039734 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 5:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 5 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5055144447294232
accuracies_anomaly["prior"][-1]= 0.6777618928500938
accuracies_anomaly["prior_star"][-1]= 0.5056955117954824


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 925.2677252292633 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.006374359130859375 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.503538750251995
 first_prior_anomaly_auc= 0.6753369346205929
 first_prior_star_anomaly_auc= 0.5037304776349718


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7065178866396676; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6854611748091434; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.7331415531765104 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7026878775309018; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6868348780238095; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 200 
last prior star auc 0.7311757801821542 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7029484747830731; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.688002710464737; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 300 
last prior star auc 0.7321736808385554 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7039088532348785; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6889286275950219; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 400 
last prior star auc 0.7336783687393067 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7069413439809846 at iter 80
0.689570304790071 at iter 490
0.7354508311353026 at iter 490
last anomaly aucs:
0.7052669353910911
0.689570304790071
0.7354508311353026




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.00752258300781 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7054105858002467,first_prior_anomaly_auc= 0.6896240285654275, first_prior_star_anomaly_auc= 0.7356399725998192


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7054105858002467 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6897394449669054 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7354703574583694 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7054105858002467 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.6898691630806839 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7352629562430932 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7054105858002467 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.6900321814913677 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7350397756478253 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7054105858002468 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.6901454869390009 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7347924246310317 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7054105858002467 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.6902635948066312 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7345135676281006 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7054105858002467 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.6903854496173368 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7342241030820982 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7054105858002467 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.6905047712834282 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7339056656945724 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7054105858002467 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.6906067831279903 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7335779401101283 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7054105858002467 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.6906893214233317 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.733219025182624 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7054105858002468 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.6908262167801832 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7328379980135925 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7054105858002468 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.6908970920555306 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7324353335676492 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7054105858002468 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.6909645898047262 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7320270750940165 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7054105858002468 at iter 11
max_prior_anomaly= 0.6909652758647258 at iter 121
max_prior_star_anomaly= 0.7356399725998192 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7054105858002468
accuracies_anomaly['prior'][-1]= 0.690937305726279
accuracies_anomaly['prior_star'][-1]= 0.7316385540388353



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.07585144042969 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7054105858002467
 first_prior_anomaly_auc= 0.6909188876539809
 first_prior_star_anomaly_auc= 0.731597918177318


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7065596835257995; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6914044070383424; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.733104558710376 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7072119682639199; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.691775090533533; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.7339826099622244 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7076427083960022; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6920962193872112; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.734684291020319 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.707937714195848; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6923642049778403; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.735194719660052 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7083932580356097 at iter 490
0.6925497578208201 at iter 490
0.7357134865674729 at iter 490
last anomaly aucs:
0.7083932580356097
0.6925497578208201
0.7357134865674729




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.98448896408081 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7084490927648113,first_prior_anomaly_auc= 0.6925691258223484, first_prior_star_anomaly_auc= 0.7357846784858972


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7084490927648113 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6923216692578625 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7352943039076922 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7084490927648113 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6919096110673087 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7348049320325636 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7084490927648113 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6909566737278074 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7342935006897542 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7084490927648113 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6892540311302362 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7337815416084835 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7084490927648113 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6864504733286259 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7332612970333711 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7084490927648113 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6813540502343687 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7327424245782577 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7084490927648113 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6728892308634118 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7322258741723742 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7084490927648113 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6607044886267085 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7317148650203338 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7084490927648113 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6463775504280487 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7312327231621244 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7084490927648113 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6301272166334719 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.730753906056221 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7084490927648113 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6131841733346421 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7303449615225888 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7084490927648113 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5975962040827959 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7300182386412211 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7084490927648113 at iter 0
max_prior_anomaly= 0.6925691258223484 at iter 0
max_prior_star_anomaly= 0.7357846784858972 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7084490927648113
accuracies_anomaly['prior'][-1]= 0.584427229615838
accuracies_anomaly['prior_star'][-1]= 0.7297980133813364



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.05476021766663 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7084490927648113
 first_prior_anomaly_auc= 0.583122924008828
 first_prior_star_anomaly_auc= 0.7297838699905745


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7089008368876519; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5829007988904826; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7302756166887789 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7092623377336166; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.582782216058237; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7306752202516468 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7094375469027557; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5826991500244343; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7308599287130886 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7095665261826883; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5825786145598819; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7310342407268435 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7095827805272952 at iter 390
0.583122924008828 at iter 0
0.731051919965296 at iter 380
last anomaly aucs:
0.7094786577288881
0.5826437902598478
0.7310313381653067




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.924947023391724 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7094810325519638,first_prior_anomaly_auc= 0.5826616278198385, first_prior_star_anomaly_auc= 0.7310232637668495


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7094810853258099 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5690233883131262 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7310105980437791 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7094810325519638 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5573263291884755 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.731130130805255 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7094810325519638 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5478573818472746 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7313485617543715 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7094810853258099 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.541139218461558 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7318509687694934 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7094810325519637 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5370644970283047 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7327386776351827 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7094810853258098 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5357183417613165 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.73419887718365 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7094810325519637 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.537444996458875 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7363922110025025 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7094810325519637 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5425360366208274 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7394367341855254 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7094810325519638 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5516142464053094 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7435374731249188 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7094810325519637 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.562660762328762 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7487487321083468 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7094810325519637 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5757577004957575 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7552106784711204 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7094810325519638 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5953153712270658 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7630358788270275 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7094810853258099 at iter 4
max_prior_anomaly= 0.6159585999731908 at iter 129
max_prior_star_anomaly= 0.7712596272688795 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7094810853258098
accuracies_anomaly['prior'][-1]= 0.6159585999731908
accuracies_anomaly['prior_star'][-1]= 0.7712596272688795



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.70945382118225 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7094810853258098
 first_prior_anomaly_auc= 0.6179817909121326
 first_prior_star_anomaly_auc= 0.772118891031507


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7100734717485768; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6176800300599827; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7721611628822541 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7106179922929075; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6174311486016514; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7722472897991322 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7111149108280322; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6171614214741001; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7723789077713711 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7115659161170271; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6169246252265318; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7725569139543548 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7118837202183993 at iter 490
0.6179817909121326 at iter 0
0.7727180852804244 at iter 490
last anomaly aucs:
0.7118837202183993
0.6167352198927847
0.7727180852804244




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.656331300735474 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.711914540144537,first_prior_anomaly_auc= 0.6167162740820253, first_prior_star_anomaly_auc= 0.7727332313742628


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7119145929183832 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6352782606584698 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.782691920007515 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7119146456922293 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6473207773798629 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7922819305517295 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7119145929183832 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6560223929983884 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8003829270274919 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7119146456922294 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6623536185443073 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8069493128317496 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.711914540144537 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6661533354653968 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8115197917755127 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7119146456922292 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6692305784330179 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8154804689272872 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.711914540144537 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6716000185763938 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8187228940332834 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.711914540144537 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6730297148417999 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8209765483582583 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.711914540144537 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6742519571180835 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8227746588434717 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.711914540144537 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6753507613682781 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8243755006918652 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.711914540144537 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6765351647968894 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8257723188511346 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.711914540144537 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6777441080639492 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8270487598673899 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7119146456922294 at iter 5
max_prior_anomaly= 0.6788897227156577 at iter 129
max_prior_star_anomaly= 0.8280209068868813 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7119146456922294
accuracies_anomaly['prior'][-1]= 0.6788897227156577
accuracies_anomaly['prior_star'][-1]= 0.8280209068868813



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.48204326629639 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.711914540144537
 first_prior_anomaly_auc= 0.6790018143648298
 first_prior_star_anomaly_auc= 0.8281115723545263


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7305048662763514; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6786005220388859; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8282828762590521 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7330600703580916; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6783038802498103; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8283515878067084 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7344086004481555; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6782159590221639; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8285012544343224 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7352927206923084; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6781945856144829; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8286379386957894 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7359386725688937 at iter 490
0.6790018143648298 at iter 0
0.8287451223772717 at iter 490
last anomaly aucs:
0.7359386725688937
0.6782254055406206
0.8287451223772717




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.95074987411499 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7360048509719359,first_prior_anomaly_auc= 0.6782311578898482, first_prior_star_anomaly_auc= 0.8287583686126494


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7360049037457821 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.682815252485912 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8315363838727348 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7360048509719359 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6835624245993673 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8319680739340475 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7360048509719359 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6843777805220177 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8322513639400532 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7360048509719359 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6852627451477087 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8323596558723043 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7360048509719359 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6862593792318028 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8324248843461162 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7360048509719359 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6873689493466071 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8324305311476518 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7360048509719359 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6886044906321145 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8323647221615322 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7360048509719359 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6899449463237212 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8322672488677372 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7360048509719359 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6914682633921551 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8320807988693731 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7360048509719359 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.693213916674319 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.831854187974107 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7360048509719359 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6951726707471405 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8316080507557743 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7360048509719359 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6974548229490236 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.831370885091283 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7360049037457821 at iter 7
max_prior_anomaly= 0.6998265851416292 at iter 129
max_prior_star_anomaly= 0.8324425108107224 at iter 56
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7360048509719359
accuracies_anomaly['prior'][-1]= 0.6998265851416292
accuracies_anomaly['prior_star'][-1]= 0.8311061187052675



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.55467987060547 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7360048509719359
 first_prior_anomaly_auc= 0.7000708752753475
 first_prior_star_anomaly_auc= 0.83108537858374


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7420452398518532; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6982533440147598; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.8338006985146273 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7421675696271739; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6968571063677977; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.8345064959327196 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7421351664856524; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6960366313820732; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.8349519071940252 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7419205880273032; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6954917414208197; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.8351980971862041 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7421796020640907 at iter 240
0.7000900849553375 at iter 10
0.835327656978444 at iter 490
last anomaly aucs:
0.7417141367412572
0.6951617993348385
0.835327656978444




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.86887788772583 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7416904940581927,first_prior_anomaly_auc= 0.6951312432779314, first_prior_star_anomaly_auc= 0.8353338315184409


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7416904940581927 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6978849825687985 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8339297833422521 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7416904940581927 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.700478236593596 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8334026781671432 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7416904940581927 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7035945849811966 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8329889312135135 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7416904940581927 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7073279651777054 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8326427347829255 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7416904940581927 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.7115786346139434 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8324534877707166 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7416904940581927 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.7163359329729936 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8323269888615521 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7416904940581927 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.7214125658749533 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8323417127646213 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7416904940581927 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.7269425788889838 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8324671561968634 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7416904940581925 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.7323647221615324 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8326664830136822 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7416904940581925 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.7377464934417941 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8329426485504607 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7416904940581927 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.7431105327097576 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8332783429856698 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7416904940581925 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.7480998776702247 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8335380958563031 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7416904940581928 at iter 45
max_prior_anomaly= 0.752327643257244 at iter 129
max_prior_star_anomaly= 0.8353477110399721 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7416904940581927
accuracies_anomaly['prior'][-1]= 0.752327643257244
accuracies_anomaly['prior_star'][-1]= 0.8337786390469466



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.81561517715454 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7416904940581927
 first_prior_anomaly_auc= 0.7527078788185836
 first_prior_star_anomaly_auc= 0.8337939434623232


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7331202325426754; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7181038040443765; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8318538185571842 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7318856411863983; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.712896925290177; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8314750606635362 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7315735366604077; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.711417041097105; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8315536936942642 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7315768614127136; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.71100281917886; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8319062229863876 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7416904940581927 at iter 0
0.7527078788185836 at iter 0
0.8341037259390842 at iter 10
last anomaly aucs:
0.7316434092326789
0.7108220159820315
0.8322890444661872




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.88198781013489 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7313733126882048,first_prior_anomaly_auc= 0.7107558903528354, first_prior_star_anomaly_auc= 0.8321858188231643


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7313733126882048 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.714010981181902 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.831416903885105 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7313733126882048 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7205092887246567 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8301557145103801 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7313733126882048 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7248590674439199 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8302694949226282 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7313733126882048 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7287290791280494 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.830480484759441 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7313733126882048 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7322327875462167 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8307246165716209 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7313733126882048 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7353526717815079 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8309213046961335 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7313733126882048 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.738134381210822 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8311044827160377 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7313733126882048 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.740593695214151 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8312561547498045 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7313733126882048 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7427360494976458 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8313862950543518 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7313733126882048 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7446393382581887 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8314694666358466 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7313733126882048 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7462892070096333 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8314917371989119 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7313733126882048 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7477477705688704 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8314432908081681 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.731373418235897 at iter 26
max_prior_anomaly= 0.7489191916313346 at iter 129
max_prior_star_anomaly= 0.833332383404103 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7313733654620509
accuracies_anomaly['prior'][-1]= 0.7489191916313346
accuracies_anomaly['prior_star'][-1]= 0.8314464572389357



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.59661865234375 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7313733126882048
 first_prior_anomaly_auc= 0.7490292778743539
 first_prior_star_anomaly_auc= 0.831439491091247


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7244013598764669; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7140648105049507; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8308392941392533 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7235048377784744; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7136582407943941; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8308012969700425 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7231712015232643; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7135069381775503; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8305943707193814 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7227465831573325; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.714199542134111; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8306385952024352 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7313733126882048 at iter 0
0.7490292778743539 at iter 0
0.831944853441752 at iter 160
last anomaly aucs:
0.7223414383406214
0.714520618213943
0.8307436151562264




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.832987785339355 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.722308665782177,first_prior_anomaly_auc= 0.7145524936170033, first_prior_star_anomaly_auc= 0.8307503702085306


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7223087185560231 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7076167436637082 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8326709160167567 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7223087185560231 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7153924421519486 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8310685965006718 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7223087185560231 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7223406995067755 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8296334645291148 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7223087185560231 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.726474369326152 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8291256745816882 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7223087185560231 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7289184844617965 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8290437695725001 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7223087185560231 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7305655561993964 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8290356424001967 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7223087185560231 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7316886891926552 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8289570093694686 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7223087185560231 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7324568652968688 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8288127256741595 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7223087185560231 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7329629664812194 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8286476490834767 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7223087185560231 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7333050993256558 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8283977121482228 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7223087185560231 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7334767198732584 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8281366927052823 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7223087185560231 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.733487485737868 iter_best_prior_anomaly= 1160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8278621103838876 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7223087185560231 at iter 1
max_prior_anomaly= 0.733497882185555 at iter 116
max_prior_star_anomaly= 0.8345316162834757 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7223087185560231
accuracies_anomaly['prior'][-1]= 0.7334429973855837
accuracies_anomaly['prior_star'][-1]= 0.8275966051640263



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.82803869247437 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.503538750251995
accuracies_anomaly["prior"][-1]= 0.6753369346205929
accuracies_anomaly["prior_star"][-1]= 0.5037304776349718


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 1436.4061496257782 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.006319999694824219 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.48672626944848163
 first_prior_anomaly_auc= 0.6620938128998278
 first_prior_star_anomaly_auc= 0.4868998426283908


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7014114892884924; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6893117657178985; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7278296016946737 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6997750778678099; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.6901192055636299; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.7277910767870015 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7009585841410371; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.6907400898633052; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.7295316110060912 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7023969880910539; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6912735278999492; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.7315457248434991 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7036769649549999 at iter 490
0.6916580909166712 at iter 490
0.7331611850472695 at iter 490
last anomaly aucs:
0.7036769649549999
0.6916580909166712
0.7331611850472695




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.76629376411438 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7037739632841797,first_prior_anomaly_auc= 0.6916947687397289, first_prior_star_anomaly_auc= 0.7332861007410503


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7037740160580258 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6916372452474513 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.73313801732882 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7037739632841797 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6916986740043422 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7329611193966049 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7037740160580258 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6917700242443049 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.732760051042864 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7037740160580259 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.691843643759651 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7325315930629835 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7037740160580259 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6919100332580778 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7322943218507999 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7037739632841797 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6919628598780501 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7320362577432425 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7037740160580259 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6920105674349484 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.731759722789541 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7037740160580258 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6920478785441596 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7314626588096964 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7037739632841797 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6920578000272314 iter_best_prior_anomaly= 830
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7311434298144788 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7037740160580258 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6920570084195393 iter_best_prior_anomaly= 940
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7307982888608132 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7037739632841797 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6918931456273173 iter_best_prior_anomaly= 940
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7304343604179266 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7037740160580259 iter_best_vanilla_star_anomaly= 1130 
last prior auc 0.6916032061166998 iter_best_prior_anomaly= 940
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7300739150488843 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7037740688318721 at iter 113
max_prior_anomaly= 0.6920844508195251 at iter 94
max_prior_star_anomaly= 0.7332861007410503 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7037739632841797
accuracies_anomaly['prior'][-1]= 0.6911366325430977
accuracies_anomaly['prior_star'][-1]= 0.7297360568859843



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.5880663394928 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7037739632841798
 first_prior_anomaly_auc= 0.6910816949692804
 first_prior_star_anomaly_auc= 0.7297031787798475


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7046648913544831; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6912431829384267; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7308066271285012 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7052705240126277; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6914268359229458; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.7315645651065663 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7060533712460644; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.691595765004396; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.7324305839214978 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7065698161042557; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6917102314766439; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.7330209121642661 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7068993359994681 at iter 490
0.691753347708929 at iter 490
0.7334808362332562 at iter 490
last anomaly aucs:
0.7068993359994681
0.691753347708929
0.7334808362332562




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.891770362854004 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7069279921979146,first_prior_anomaly_auc= 0.6917532949350829, first_prior_star_anomaly_auc= 0.7335285965640005


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7069279394240685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6909534545231936 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7331044531626838 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7069279394240684 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6897846193791894 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7326900729229007 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7069279394240685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.68791452536786 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7322427090292883 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7069279394240685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6849807744878562 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7317946063018306 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7069279394240685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6803934079133327 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7313446564897581 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7069279394240685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6734993492984772 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7308946539038398 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7069279394240685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6646201496877372 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7304621722348351 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7069279394240685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.65444872968075 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7300202968212202 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7069279394240685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.64277631594224 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7296270261198874 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7069279394240684 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6299232457181939 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7292621477477705 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7069279394240685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6151272008013181 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7289800187663797 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7069279394240685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5995190719402516 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7287752562434098 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7069279921979146 at iter 0
max_prior_anomaly= 0.6917532949350829 at iter 0
max_prior_star_anomaly= 0.7335285965640005 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7069279394240685
accuracies_anomaly['prior'][-1]= 0.5857804565782071
accuracies_anomaly['prior_star'][-1]= 0.7286530320157815



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.42610144615173 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7069279394240685
 first_prior_anomaly_auc= 0.584489924945036
 first_prior_star_anomaly_auc= 0.7286518182173205


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7073174631823262; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.58431767111128; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7291909558293462 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7075814907344958; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.584024670717587; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7295040102845671 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7077621883836321; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5837818582515601; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7297097755106132 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.707873752294343; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5835993135178096; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7298698385859143 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7082583680849109 at iter 490
0.584489924945036 at iter 0
0.7302598373087872 at iter 490
last anomaly aucs:
0.7082583680849109
0.5833641004856249
0.7302598373087872




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.776843547821045 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7082811663864375,first_prior_anomaly_auc= 0.5833401411594837, first_prior_star_anomaly_auc= 0.7302826356103136


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7082811663864376 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5705505578723273 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7305166348440374 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7082811663864376 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5606917173559458 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7307228222608527 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7082811663864375 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5532329258136935 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7311600008021624 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7082811663864376 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.548250547000915 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7318548740341067 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7082811663864376 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.545593489396151 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7329784292181344 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7082811663864376 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5453805997008778 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7346957957187744 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7082811663864375 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.547245996839902 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7369703484868155 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7082811663864376 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5517376844313987 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.740161424640531 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7082811663864376 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5599905112624665 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7441533966830582 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7082811663864376 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.572332044596011 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7493330441326567 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7082811663864376 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5862064998379842 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7557836968923595 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7082811663864376 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5987448268437334 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7633879331545356 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7082811663864376 at iter 1
max_prior_anomaly= 0.6099287130886526 at iter 129
max_prior_star_anomaly= 0.7706144669999864 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7082811663864376
accuracies_anomaly['prior'][-1]= 0.6099287130886526
accuracies_anomaly['prior_star'][-1]= 0.7706144669999864



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.63664054870605 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7082811663864375
 first_prior_anomaly_auc= 0.611128632028025
 first_prior_star_anomaly_auc= 0.7713631695549792


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7124562109011767; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.610664222182114; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7716916867471151 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7147535619707442; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6101618679408385; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7718997212485448 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7158804946809241; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6096876421595481; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7721808475268592 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7165542583744178; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6092637098536159; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7724227100636558 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7169800905388104 at iter 490
0.611128632028025 at iter 0
0.772613856934325 at iter 490
last anomaly aucs:
0.7169800905388104
0.6089056920814955
0.772613856934325




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.825918197631836 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7170101716311024,first_prior_anomaly_auc= 0.6088682226507458, first_prior_star_anomaly_auc= 0.7726290558020094


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7170101716311023 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6242424050519346 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7816629883295917 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7170101716311024 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6376710268418336 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7894324595039891 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7170101716311023 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6476444921520013 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7957703873283661 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7170101716311023 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6537524843288064 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8004506886459181 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7170101716311023 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6587263137785124 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8045772867699135 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7170101716311023 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6623947821442858 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8078818794666465 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7170101716311023 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6647357244107535 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8104860049037458 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7170101716311023 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6664673398498479 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8126553793964572 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7170101716311023 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6680353563659508 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8146388316292658 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7170101716311023 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.670385692377029 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8168313738404266 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7170101716311023 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6720900765115221 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8185802991010502 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7170101716311023 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.673494599652326 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8201047244202528 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7170101716311024 at iter 0
max_prior_anomaly= 0.6748361635947011 at iter 129
max_prior_star_anomaly= 0.8213638028411328 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7170101716311023
accuracies_anomaly['prior'][-1]= 0.6748361635947011
accuracies_anomaly['prior_star'][-1]= 0.8213638028411328



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.47656512260437 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7170101716311023
 first_prior_anomaly_auc= 0.6749589683346369
 first_prior_star_anomaly_auc= 0.8214819107087633


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7373258858881679; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6742683170103827; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8212789424965619 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7390900100164761; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6736203069537986; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8213008964165502 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7399033605329737; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6731525195817356; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8214514601995485 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7404627633019119; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6727423612496425; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8217293144994032 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7407087949725523 at iter 490
0.6749589683346369 at iter 0
0.8219514923915945 at iter 490
last anomaly aucs:
0.7407087949725523
0.6723944232821323
0.8219514923915945




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.885875940322876 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7407329653940782,first_prior_anomaly_auc= 0.6723602258298423, first_prior_star_anomaly_auc= 0.821976296099274


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7407329653940781 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6787674457141831 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8251595089499166 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7407329653940782 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6796186350783533 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8260377185233033 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7407329653940782 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.680494733697895 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8267115349906431 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7407329653940782 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6814613922373893 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8271815388642434 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7407329653940782 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6824634092537882 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8275176554902215 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7407329653940782 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6835970442424262 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8278013676869963 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7407329653940782 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6848383378771615 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8279737270684445 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7407329653940782 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6862285065318189 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8280520434560958 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7407329653940781 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.687770716637166 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8280684033483949 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7407329653940782 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6895857147531398 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8280218568161117 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7407329653940782 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6917209973412537 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8279393185207702 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7407329653940782 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6941955102122669 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.827832662577749 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7407329653940782 at iter 0
max_prior_anomaly= 0.6966988376032652 at iter 129
max_prior_star_anomaly= 0.8280903572683835 at iter 87
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7407329653940782
accuracies_anomaly['prior'][-1]= 0.6966988376032652
accuracies_anomaly['prior_star'][-1]= 0.827727695397804



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.20382523536682 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7407329653940782
 first_prior_anomaly_auc= 0.6969706756846614
 first_prior_star_anomaly_auc= 0.8277283286839575


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7426135086269408; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6945696240074559; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8312971072543984 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7417979416089058; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6929094115821705; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8320352550401662 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7411885620076859; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6918166235504344; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8324121130753537 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7409171461170587; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6909792609339492; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8327188346690394 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7428725226637283 at iter 60
0.6969706756846614 at iter 0
0.8329052318935573 at iter 490
last anomaly aucs:
0.7405754882372374
0.6904432897526912
0.8329052318935573




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.172730922698975 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.740538546544949,first_prior_anomaly_auc= 0.6903874022496435, first_prior_star_anomaly_auc= 0.832916419948936


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7405385465449491 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6992377873403987 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.832148929904722 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7405385465449491 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.702830578010827 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.832107080244744 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7405385465449491 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.707242102130058 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8321421220785719 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7405385465449491 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7124157333611979 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.832296854995414 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7405385465449491 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7183835582026916 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8326034710414075 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7405385465449491 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7251715413868334 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8330521542811726 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7405385465449491 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7325874805660312 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8336526151023971 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7405385465449491 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7405581256418619 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8343241622943536 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7405385465449491 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7487733774944878 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8350618351155061 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7405385465449491 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7569579149686682 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8358203536058786 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7405385465449491 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7646433701800327 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8365842550285559 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7405385465449491 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7717768637347628 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8372434531405188 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7405385465449491 at iter 1
max_prior_anomaly= 0.7776289027578557 at iter 129
max_prior_star_anomaly= 0.8377699778033203 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7405385465449491
accuracies_anomaly['prior'][-1]= 0.7776289027578557
accuracies_anomaly['prior_star'][-1]= 0.8377699778033203



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.62214779853821 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.740538546544949
 first_prior_anomaly_auc= 0.7781838725237192
 first_prior_star_anomaly_auc= 0.8378065500786859


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7347182246033782; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.717535904686212; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8334702286901847 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7340056721329816; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7127578662056344; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8353297151584429 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7337777418915624; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7108186912297256; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8367474845346243 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7335236358224646; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7093924252643179; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8374557095496385 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.740538546544949 at iter 0
0.7781838725237192 at iter 0
0.8378335702879024 at iter 490
last anomaly aucs:
0.7334472192932737
0.708586093669355
0.8378335702879024




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.938985109329224 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7334552409178849,first_prior_anomaly_auc= 0.7085258259370788, first_prior_star_anomaly_auc= 0.8378710397186521


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7334552409178849 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7218141748439741 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8360337182657669 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7334552409178849 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7303771535687258 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8368396276699608 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7334552409178849 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.737867292775577 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8374530180834863 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7334552409178849 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7441960907245744 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8379271910909304 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7334552409178849 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7491782584419684 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8382002429707875 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7334552409178849 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7530600914676301 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8383656362045472 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7334552409178849 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7560019695199374 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8384074330906791 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7334552409178849 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7581741938003397 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.838382682156846 iter_best_prior_star_anomaly= 730
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7334552409178849 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7597050575287696 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8382891141276642 iter_best_prior_star_anomaly= 730
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7334552409178849 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7608557384697062 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8381426667046639 iter_best_prior_star_anomaly= 730
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7334552409178849 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.761712205218489 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8379837646539778 iter_best_prior_star_anomaly= 730
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7334552409178849 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7623535129966151 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8378119330109908 iter_best_prior_star_anomaly= 730
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7334552409178849 at iter 0
max_prior_anomaly= 0.7628184505809872 at iter 129
max_prior_star_anomaly= 0.8384147158814446 at iter 73
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7334552409178849
accuracies_anomaly['prior'][-1]= 0.7628184505809872
accuracies_anomaly['prior_star'][-1]= 0.8376651161710675



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.89554715156555 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7334552409178849
 first_prior_anomaly_auc= 0.7628628333855795
 first_prior_star_anomaly_auc= 0.8376513949710747


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7258085217095771; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7100273474070626; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8351486480923838 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7261045829863454; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7146378289261894; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8347332651495242 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.727188030047317; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7161679538207737; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8349213511371181 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7275749151132684; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7170537628280026; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.834997820440155 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7334552409178849 at iter 0
0.7628628333855795 at iter 0
0.8376513949710747 at iter 0
last anomaly aucs:
0.7276563451578413
0.717423443620117
0.8350300124862919




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.893924713134766 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7276739716224475,first_prior_anomaly_auc= 0.7174504638293335, first_prior_star_anomaly_auc= 0.8350334427862902


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7276739716224475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7350578243032005 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8323260917061679 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7276739716224475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7382236745584676 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8325843669091096 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7276739716224475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7385835394152025 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8322988604015668 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7276739716224475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.737877689223264 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8317260003018663 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7276739716224475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7368306033422732 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8310721851222085 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7276739716224475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7356979182828657 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8304005851564058 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7276739716224475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7346253954080422 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8297272964275273 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7276739716224475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7337168936469787 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8291015041601624 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7276739188486014 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.732949825793534 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8285442123450691 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7276739716224475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7323544840353837 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8280358946591813 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7276739716224475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7319321877186817 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8275848893701864 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7276739188486013 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7316968163649585 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8272235996196062 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7276739716224475 at iter 0
max_prior_anomaly= 0.7386582671813172 at iter 27
max_prior_star_anomaly= 0.8357969747920447 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7276739716224475
accuracies_anomaly['prior'][-1]= 0.7315881022419386
accuracies_anomaly['prior_star'][-1]= 0.8269170363474587



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.23646950721741 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.48672626944848163
accuracies_anomaly["prior"][-1]= 0.6620938128998278
accuracies_anomaly["prior_star"][-1]= 0.4868998426283908


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 1418.4186053276062 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.005939483642578125 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.48881764419661844
 first_prior_anomaly_auc= 0.6616492987939065
 first_prior_star_anomaly_auc= 0.48900995209190246


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.498257988113219; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6820770519262982; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4993659222387932 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5370259721206325; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6848443013217738; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.542150945865644 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6290598128217226; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6856345368936682; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6413560661952907 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6950325034118292; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6860373068873036; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.7131436957946633 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7115980026154718 at iter 490
0.6862994873548587 at iter 490
0.7329157338889364 at iter 490
last anomaly aucs:
0.7115980026154718
0.6862994873548587
0.7329157338889364




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.53624176979065 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7122227921797604,first_prior_anomaly_auc= 0.6863129974594671, first_prior_star_anomaly_auc= 0.7337675565392601


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7122227394059143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6757592837111412 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.801067720454826 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7122227921797604 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.68171164581572 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7889202365534879 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7122227921797604 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6818589903941045 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.783803073337703 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7122227394059143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6808378164715616 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7783398192390223 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7122227921797604 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6761941929770676 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.771374357610358 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7122227921797604 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6679908680136664 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7647702385061201 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7122227394059143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6690980633053949 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7640179473295906 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7122227921797604 at iter 0
max_prior_anomaly= 0.6863183276179258 at iter 1
max_prior_star_anomaly= 0.8140629634203363 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7122227394059143
accuracies_anomaly['prior'][-1]= 0.6650645582459662
accuracies_anomaly['prior_star'][-1]= 0.7574949944006949



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.50374150276184 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7122227394059142
 first_prior_anomaly_auc= 0.6741060902073907
 first_prior_star_anomaly_auc= 0.7655860693933857


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.715111263099788; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6820561534832321; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 100 
last prior star auc 0.7803207383272168 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7134604971929591; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.694671635852018; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 200 
last prior star auc 0.7920020180718759 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.711868943541484; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6978465632088187; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 280 
last prior star auc 0.7931525934651202 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7099171028425049; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7030719128091624; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 370 
last prior star auc 0.797034004300013 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7152549135089437 at iter 80
0.7139344063311728 at iter 470
0.8042432810977804 at iter 470
last anomaly aucs:
0.7085717391832086
0.7093031319166723
0.8009144652056756




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.44838237762451 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7085016027417068,first_prior_anomaly_auc= 0.7081780990649529, first_prior_star_anomaly_auc= 0.7994824996648862


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7085017082893992 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.705713824320088 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8366844725623497 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.708501655515553 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.694597646919749 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8114633237601576 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.708501655515553 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6983914531700721 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7947664704535067 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7085017082893992 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7035702562381324 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7913728482783589 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.708501655515553 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7086029285262692 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7910605326569837 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7085016027417068 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.715079123827497 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7936815984986896 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7085016027417069 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.719696782589697 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7944381643567553 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7085017082893992 at iter 3
max_prior_anomaly= 0.7274875216240834 at iter 7
max_prior_star_anomaly= 0.8370552088313865 at iter 11
last values
accuracies_anomaly['vanilla_star'][-1]= 0.708501655515553
accuracies_anomaly['prior'][-1]= 0.7228607857603497
accuracies_anomaly['prior_star'][-1]= 0.7950442192056693



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.86058259010315 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7085017082893992
 first_prior_anomaly_auc= 0.7230806416033118
 first_prior_star_anomaly_auc= 0.7950633233379667


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7081366715957438; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7138769883865874; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7964267884264844 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.709314794936666; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7113433160340665; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8037273112042042 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.709971512677861; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.709896257173285; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8100891983547226 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7102233494715755; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.706676947011892; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8121195137628913 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7103234086838308 at iter 420
0.7230806416033118 at iter 0
0.8143941720786245 at iter 470
last anomaly aucs:
0.7102583913054032
0.706005980332243
0.8142778585217624




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.64510202407837 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7102526389561756,first_prior_anomaly_auc= 0.7060700477814402, first_prior_star_anomaly_auc= 0.8144748105155055


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7102526389561756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6917076455581838 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8301386157842352 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7102526389561756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6994370613833714 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8174483528754886 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7102526389561755 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7088167681507728 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8122390992982134 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7102526389561756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7158323121594108 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8139422168603995 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7102526389561756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7198443910373122 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8144864207616532 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7102526389561756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7215225993441267 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8148331977045488 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7102526389561756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7217695809439975 iter_best_prior_anomaly= 630
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8144628836262808 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7102526389561756 at iter 0
max_prior_anomaly= 0.7235969281399647 at iter 76
max_prior_star_anomaly= 0.8301386157842352 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7102526389561756
accuracies_anomaly['prior'][-1]= 0.7232109930032435
accuracies_anomaly['prior_star'][-1]= 0.8145350782477816



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.61852717399597 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7102526389561756
 first_prior_anomaly_auc= 0.7233196015785713
 first_prior_star_anomaly_auc= 0.8143323211309645


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7117372200215528; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6903752642650344; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8066841770288113 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7120170269537142; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6907635742248314; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8092841861059129 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7119934898183419; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.69785717075189; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8114599462340055 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7119777632121962; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6974909202597739; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8148054914353324 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7121341848921144 at iter 250
0.7233196015785713 at iter 0
0.8184588664811139 at iter 410
last anomaly aucs:
0.711849311670725
0.700635872071975
0.8128406155963602




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.587117195129395 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7117115719323355,first_prior_anomaly_auc= 0.7039724984933067, first_prior_star_anomaly_auc= 0.8184522169765018


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7117115719323355 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6956813578499512 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8323193366538637 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7117115719323355 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7139405280973234 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8240070864720578 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7117115719323355 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7122060100966923 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8218035673009026 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7117115719323355 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7133243406699534 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8214071301688024 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7117115719323355 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7120434138767773 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8203371932124389 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7117115719323355 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7096886448626244 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8184023456919127 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7117115719323355 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7074516670730253 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8178674299875769 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7117115719323355 at iter 0
max_prior_anomaly= 0.7141295640141476 at iter 34
max_prior_star_anomaly= 0.8323320023769342 at iter 11
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7117115719323355
accuracies_anomaly['prior'][-1]= 0.7024767821463967
accuracies_anomaly['prior_star'][-1]= 0.8146859059000104



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.87800669670105 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7117115719323355
 first_prior_anomaly_auc= 0.7033904029705342
 first_prior_star_anomaly_auc= 0.8138519735835235


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7103596643161196; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6609690966911854; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7872322123112938 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7106562005575029; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6735073181492424; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7954108391147082 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7105950884436887; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6639727729173065; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7906419832833564 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7104563460022228; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6588800967661242; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7886632279228531 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7117115719323355 at iter 0
0.7033904029705342 at iter 0
0.8138519735835235 at iter 0
last anomaly aucs:
0.7106044821882992
0.6622891816781873
0.7886147815321092




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.74834704399109 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7107733584959032,first_prior_anomaly_auc= 0.6651021859982543, first_prior_star_anomaly_auc= 0.7873220333974008


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7107733584959032 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6946434546181866 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8309290096776679 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7107733584959032 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7042513554962377 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8194268443667614 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7107733584959032 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6915456826244224 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8113282227140745 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7107733584959031 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6879913640878199 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.807503385442229 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7107733584959032 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6862102995549054 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8080462172234835 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7107733584959032 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6857333295336163 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.806620901187306 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7107733584959032 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6885664934629037 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8083163137679577 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7107733584959032 at iter 0
max_prior_anomaly= 0.7049182058158889 at iter 19
max_prior_star_anomaly= 0.8309290096776679 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7107733584959032
accuracies_anomaly['prior'][-1]= 0.6831590740934246
accuracies_anomaly['prior_star'][-1]= 0.8059798045045644



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.50182271003723 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7107733584959032
 first_prior_anomaly_auc= 0.6835796816470505
 first_prior_star_anomaly_auc= 0.8059965865876325


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7082577347987575; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6608387980650997; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7751829933114427 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7086672598446971; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.650934783136434; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7679198871906265 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7083251797741068; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6614830611786089; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7703550307724296 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7084352660171263; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6617755338338405; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7754202645236263 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7107733584959032 at iter 0
0.6835796816470505 at iter 0
0.8059965865876325 at iter 0
last anomaly aucs:
0.7084231280325172
0.6499034766354352
0.7641986449787268




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.459961891174316 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7085733223985926,first_prior_anomaly_auc= 0.6585933236862742, first_prior_star_anomaly_auc= 0.7733934321893019


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7085733223985924 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7017366289544763 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8280827050606951 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7085733223985926 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6838221774700007 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8072615756792786 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7085733223985924 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6751377133514664 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7977671913442448 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7085733223985924 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.673399765050837 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7931958152450975 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7085733223985926 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6690434423746542 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7895988554408252 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7085733223985924 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6727900160326945 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7923429898916975 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7085733223985924 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6730495578079433 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7915245203121255 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7085733223985926 at iter 0
max_prior_anomaly= 0.7062977141536289 at iter 11
max_prior_star_anomaly= 0.8306427115624331 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7085733223985924
accuracies_anomaly['prior'][-1]= 0.673839951701376
accuracies_anomaly['prior_star'][-1]= 0.792364521620917



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.76864266395569 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7085733223985924
 first_prior_anomaly_auc= 0.6750089979407645
 first_prior_star_anomaly_auc= 0.7946484153597224


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7077620828359399; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6401785761405221; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7563492742012943 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7069730082886604; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6297785398321158; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7525463380755912 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7076013864744854; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6486541086022425; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7645378224877801 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7072965119654142; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6444503551152105; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.764299443024828 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7085733223985924 at iter 0
0.6750089979407645 at iter 0
0.7946484153597224 at iter 0
last anomaly aucs:
0.707318571433095
0.6553222951556776
0.7654790968072878




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.57250475883484 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.70673214845494,first_prior_anomaly_auc= 0.6371308865267316, first_prior_star_anomaly_auc= 0.7580904417065373


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7067322540026324 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6950887603317997 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8157005358656335 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7067321484549401 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6672759407201941 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7906706922556491 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.70673214845494 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6517083949467987 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7798443488182353 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7067322012287862 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6497353391616769 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7783507961990165 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7067322012287862 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6500198957399896 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7777392528701055 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7067322012287862 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6454643517946802 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7742079437304143 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7067322540026324 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6453505186085859 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7739973233105245 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7067322540026324 at iter 1
max_prior_anomaly= 0.7004170189320895 at iter 9
max_prior_star_anomaly= 0.8307126896823964 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7067322012287862
accuracies_anomaly['prior'][-1]= 0.6474356660428797
accuracies_anomaly['prior_star'][-1]= 0.7740737398397153



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.74649000167847 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7067322540026324
 first_prior_anomaly_auc= 0.6456459465992006
 first_prior_star_anomaly_auc= 0.7731402760494342


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7070985044947486; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.645181695074828; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 40 
last prior star auc 0.7659919530439427 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7074035373253582; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6496369687124975; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 180 
last prior star auc 0.7644878456554987 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.707633842389853; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6462378580573525; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 240 
last prior star auc 0.7654438438780755 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.707341211413083; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6459533014790397; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 240 
last prior star auc 0.7622579395612804 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.707633842389853 at iter 300
0.6683855108349983 at iter 240
0.7802940875349231 at iter 240
last anomaly aucs:
0.7065538784027257
0.6422734867363493
0.7592036004428782




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.57090377807617 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.707056074322463,first_prior_anomaly_auc= 0.6420729988949156, first_prior_star_anomaly_auc= 0.7625672998472726


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.707056074322463 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6874610397080972 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8019904183804973 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.707056074322463 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6689319312377895 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7916989378735728 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.707056074322463 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6646378289261895 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7883043657691946 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.707056074322463 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.662724249265652 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7866176080993077 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.707056074322463 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6609793348173338 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7851944030169752 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.707056074322463 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6643619272586415 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7897573353007423 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.707056074322463 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6702049947278929 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7945188555674825 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.707056074322463 at iter 0
max_prior_anomaly= 0.7019736362974291 at iter 5
max_prior_star_anomaly= 0.8306530552362736 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.707056074322463
accuracies_anomaly['prior'][-1]= 0.6591034356829306
accuracies_anomaly['prior_star'][-1]= 0.7830452936811764



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.90830850601196 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.48881764419661844
accuracies_anomaly["prior"][-1]= 0.6616492987939065
accuracies_anomaly["prior_star"][-1]= 0.48900995209190246


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 1074.533322095871 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.006577968597412109 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5056736634231861
 first_prior_anomaly_auc= 0.6794226330138404
 first_prior_star_anomaly_auc= 0.5058596912307811


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5129962456685866; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6889334300150194; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.514024385738818 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5399522818883327; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6894325650516814; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5448706987996061 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6232326302801553; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6896487267254144; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6353809585630315 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6860565165672935; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6897580213607419; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.7050378441250571 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7023434754110819 at iter 490
0.6898461009099266 at iter 490
0.7250247773207563 at iter 490
last anomaly aucs:
0.7023434754110819
0.6898461009099266
0.7250247773207563




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.65059161186218 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7030917030014597,first_prior_anomaly_auc= 0.6898574472868438, first_prior_star_anomaly_auc= 0.7260978807078873


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7030917030014598 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6926443285530783 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.806528124765816 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7030917030014598 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6932194579281621 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7941398338046038 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7030917030014596 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6934515573034253 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7891908080625771 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7030917030014598 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6930987113682252 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7846037581311303 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7030917030014597 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6841485309344453 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7757719494342116 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7030917030014596 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.681368826911284 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7725702129635786 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7030917030014596 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.683270057491828 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7724924243143887 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7030917030014598 at iter 2
max_prior_anomaly= 0.6938409755139908 at iter 21
max_prior_star_anomaly= 0.8179838490921315 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7030917030014596
accuracies_anomaly['prior'][-1]= 0.6847209688433767
accuracies_anomaly['prior_star'][-1]= 0.7698425439526977



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.8423433303833 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7030917030014596
 first_prior_anomaly_auc= 0.6764666643446176
 first_prior_star_anomaly_auc= 0.7625285110703698


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7090312410614298; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6819161972433053; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7768939741767016 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7098220571456315; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6867389351715519; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 190 
last prior star auc 0.7817183480941781 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7105123390529628; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6916421004412949; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 300 
last prior star auc 0.7840360170945042 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7102173332531171; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 310 
last prior auc 0.6968571063677979; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 390 
last prior star auc 0.7861601116272393 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7105208884160352 at iter 310
0.7009414326410459 at iter 490
0.7878460249155882 at iter 490
last anomaly aucs:
0.7096610969149465
0.7009414326410459
0.7878460249155882




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.85665774345398 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7096080064257435,first_prior_anomaly_auc= 0.7013322229716109, first_prior_star_anomaly_auc= 0.7880491514493281


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7096080064257434 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7117430779184728 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7983393126100995 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7096080064257435 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7070367063209346 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7807907949746633 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7096080064257434 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7052059815988154 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7753430036128975 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7096080064257435 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7064065865981873 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7727495912665618 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7096080064257434 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.707433143453035 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7717131129286423 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7096080064257435 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7112897505802485 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7775829367378797 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7096080064257435 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7086437754831709 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7705392114954104 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7096080064257435 at iter 0
max_prior_anomaly= 0.723874201927512 at iter 1
max_prior_star_anomaly= 0.819295068072984 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7096080064257434
accuracies_anomaly['prior'][-1]= 0.7083352068048708
accuracies_anomaly['prior_star'][-1]= 0.7704559343662231



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.37019109725952 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7096080064257435
 first_prior_anomaly_auc= 0.7098050111933327
 first_prior_star_anomaly_auc= 0.7769822648212709


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7091332001321458; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7060873576029697; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7792305362139409 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7100265030255246; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7093291494228124; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7858400382504835 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7108488250958637; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7109493064988881; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 300 
last prior star auc 0.7915065772044427 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7111510609126286; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.7110210789296199; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 370 
last prior star auc 0.79499107594262 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7112027265079862 at iter 370
0.7124198497211958 at iter 490
0.7968058101893631 at iter 490
last anomaly aucs:
0.7109326299635121
0.7124198497211958
0.7968058101893631




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.83925175666809 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7109277747696685,first_prior_anomaly_auc= 0.7125630779395824, first_prior_star_anomaly_auc= 0.7969221237462254


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7109277747696685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7064297015427906 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8370668718513803 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7109277747696685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7095211406750198 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8258602400787809 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7109277747696685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7331406032472804 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8172664942017376 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7109277747696685 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.7430203422067279 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8157770579425168 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7109277747696685 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.7495926386817516 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8149040729798964 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7109277747696685 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.755340027167976 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8128804070763395 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7109277747696685 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.7548060613928707 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8115920391708595 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7109277747696686 at iter 37
max_prior_anomaly= 0.7556649029647291 at iter 77
max_prior_star_anomaly= 0.8370668718513803 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7109277747696686
accuracies_anomaly['prior'][-1]= 0.755496765490971
accuracies_anomaly['prior_star'][-1]= 0.8102736957207799



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.55776977539062 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7109277747696685
 first_prior_anomaly_auc= 0.7556196230047527
 first_prior_star_anomaly_auc= 0.8101903130439004


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7022033080757706; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6725276244697548; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7925256401731404 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7030348127953356; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6604432580883834; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7967006319140335 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7032166714690867; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.659827281756398; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8012640391624157 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7035802304950503; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6692968096099062; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8057333506431549 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7109277747696685 at iter 0
0.7556196230047527 at iter 0
0.8113055827340863 at iter 340
last anomaly aucs:
0.7036923749180686
0.6676561235076875
0.8078922231404871




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.317254304885864 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7037739632841797,first_prior_anomaly_auc= 0.6700279384741392, first_prior_star_anomaly_auc= 0.8077953303589993


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7037739632841797 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6728949832126395 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7939692159600775 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7037739632841797 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6925027363239217 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8264760053153818 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7037739632841797 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6957089057976291 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8274118967025845 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7037739632841797 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6944449194090595 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8249965960869248 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7037739632841797 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6927367883314915 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8212255353642821 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7037739632841797 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.692420145254734 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8187745068547949 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7037739632841797 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6937578039324959 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8190364762269655 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7037739632841797 at iter 0
max_prior_anomaly= 0.6979962826102788 at iter 35
max_prior_star_anomaly= 0.8291895309355009 at iter 26
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7037739632841797
accuracies_anomaly['prior'][-1]= 0.6905708969126245
accuracies_anomaly['prior_star'][-1]= 0.8166511511559056



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.63113617897034 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7037739632841797
 first_prior_anomaly_auc= 0.6903485606988946
 first_prior_star_anomaly_auc= 0.8165202720175124


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.671261052162725; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6195033664436443; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7524621637910198 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6728313379542112; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6245675974917646; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7550204815296815 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6749505772931028; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6192591290837721; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7539557691840847 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6758991344033758; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6240405450905019; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7556369856001284 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7037739632841797 at iter 0
0.6903485606988946 at iter 0
0.8165202720175124 at iter 0
last anomaly aucs:
0.6774242985564242
0.6251997753945109
0.7573050085546404




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.059945821762085 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6775861031686472,first_prior_anomaly_auc= 0.6230198989064204, first_prior_star_anomaly_auc= 0.7560652453614427


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6775860503948011 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6194002463483137 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7641158955880009 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6775860503948011 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.6374531764050246 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7662879087730186 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6775860503948011 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.6660385523500721 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7938943826462707 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6775860503948011 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.6751287417976248 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8075852904514169 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6775861031686473 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.6778170942931419 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.816129270591563 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6775860503948011 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.6781464030929696 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8185050435964742 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.677586050394801 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.6781866167637178 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8174769035262428 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6775861031686473 at iter 13
max_prior_anomaly= 0.6797745817936564 at iter 79
max_prior_star_anomaly= 0.8185227756087727 at iter 61
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6775861031686472
accuracies_anomaly['prior'][-1]= 0.6797745817936564
accuracies_anomaly['prior_star'][-1]= 0.8167863049758349



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.50308132171631 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6775861031686472
 first_prior_anomaly_auc= 0.6798638223674558
 first_prior_star_anomaly_auc= 0.8167096773512597


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7034877179427911; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6852343000446466; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.8211939238304523 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7074798483068567; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6881140632800633; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.8227410946773355 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7103538591930457; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.690009699832918; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.8242496878427 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7125471930118984; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6914351741906339; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.8254750965497515 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7140739403803305 at iter 490
0.6924357135393413 at iter 490
0.8264266089954077 at iter 490
last anomaly aucs:
0.7140739403803305
0.6924357135393413
0.8264266089954077




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.93824362754822 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7142038695894934,first_prior_anomaly_auc= 0.6925240569577567, first_prior_star_anomaly_auc= 0.8265194909645899


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7142038695894933 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6922890550209564 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8198341001373176 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7142038695894933 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6857665242828299 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8133705705591601 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7142038695894933 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6811040077514225 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8093832426150919 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7142038695894933 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6778286517654435 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.806827458021044 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7142038695894933 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6749274623484994 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8048365119020855 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7142038695894933 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6716665136225128 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8027658772754762 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7142038695894933 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6678838426537224 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8004194465290113 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7142038695894934 at iter 0
max_prior_anomaly= 0.694812964211944 at iter 4
max_prior_star_anomaly= 0.8265194909645899 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7142038695894933
accuracies_anomaly['prior'][-1]= 0.6647579949738189
accuracies_anomaly['prior_star'][-1]= 0.7984898236192515



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.68052172660828 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7142038695894933
 first_prior_anomaly_auc= 0.664449584617057
 first_prior_star_anomaly_auc= 0.7983267524347215


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7085377528263034; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6818773556925565; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.8029905883122819 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7090111342260557; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6838459784746036; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.8049488146466421 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7096601469857162; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6849581872817141; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.806578734884251 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7102011844562024; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6854422289983841; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.8074757847207049 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7142038695894933 at iter 0
0.6860064341873198 at iter 490
0.8081993669249419 at iter 490
last anomaly aucs:
0.7106123982652182
0.6860064341873198
0.8081993669249419




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.93426036834717 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7106497093744295,first_prior_anomaly_auc= 0.6860831145857411, first_prior_star_anomaly_auc= 0.8082680784725983


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7106497093744294 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6803519804441236 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8147671776230448 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7106497621482755 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.686500661256292 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8071254719301191 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7106497621482755 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.680934075966896 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8010699369563634 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7106497093744294 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6803617963795031 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8002201724860386 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7106497093744294 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.680060774361199 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.799621717070967 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7106497093744294 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6796661315398669 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.799149707791214 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7106497621482755 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6789325223048661 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7986094091545736 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7106497621482755 at iter 1
max_prior_anomaly= 0.686500661256292 at iter 20
max_prior_star_anomaly= 0.8186296954210245 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7106497621482755
accuracies_anomaly['prior'][-1]= 0.6786169347050311
accuracies_anomaly['prior_star'][-1]= 0.7983609498870112



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.79421758651733 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7106497093744293
 first_prior_anomaly_auc= 0.67885563081106
 first_prior_star_anomaly_auc= 0.7982434225316881


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6924599895085594; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6203843730308759; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7300480030904364 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6981291671548248; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6225894754174148; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7387262926689739 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7003649311459629; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6280984844406869; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7414326938198661 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7004523246351481; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6219029404531585; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7437962760663219 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7106497093744293 at iter 0
0.67885563081106 at iter 0
0.7982434225316881 at iter 0
last anomaly aucs:
0.7011414455178644
0.6333530179779384
0.7480764988563907




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.886559009552 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7018970614466999,first_prior_anomaly_auc= 0.6326388295183121, first_prior_star_anomaly_auc= 0.7502199613906542


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7018970614467 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6843316034066574 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8170318089080142 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7018970614466999 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6828107667089913 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8114607906155435 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7018970614466999 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6819356707925259 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7967520336401605 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7018970614467 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.681329563169766 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7983807400793086 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7018970614466999 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6823263555753984 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7993413824003445 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7018970614467 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6838801231530474 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7998873278385203 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7018970614466999 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6828843334504913 iter_best_prior_anomaly= 640
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7993552619218758 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7018970614467 at iter 1
max_prior_anomaly= 0.6853778976799563 at iter 64
max_prior_star_anomaly= 0.8180353035921046 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7018970614466999
accuracies_anomaly['prior'][-1]= 0.6851632664477608
accuracies_anomaly['prior_star'][-1]= 0.799920944778503



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.6242184638977 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5056736634231861
accuracies_anomaly["prior"][-1]= 0.6794226330138404
accuracies_anomaly["prior_star"][-1]= 0.5058596912307811


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 1044.6622273921967 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.00582575798034668 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5135332195529212
 first_prior_anomaly_auc= 0.6758322171664878
 first_prior_star_anomaly_auc= 0.5136952352605287


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5229054324341726; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6890744417318687; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.523766384959876 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5590393682337332; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6891390896933735; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 120 
last prior star auc 0.5630424755577932 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6442830620229905; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6892120231487199; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 300 
last prior star auc 0.6546455233529547 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7000186819415287; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6893207372717399; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 400 
last prior star auc 0.7168073089665931 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7117316259938635 at iter 490
0.6893974176701614 at iter 490
0.7325872694706466 at iter 490
last anomaly aucs:
0.7117316259938635
0.6893974176701614
0.7325872694706466




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.52335596084595 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7120496411906202,first_prior_anomaly_auc= 0.6894003730055445, first_prior_star_anomaly_auc= 0.7332367044210762


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7120496411906202 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.689634319465422 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.73184120560796 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7120496411906202 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.671791957054755 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7291957582493438 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7120496411906202 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5233255650231835 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7318429471448822 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7120496411906202 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6666916286958844 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7963212407342319 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7120496411906202 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6797562692690506 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.82267945482506 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7120496411906202 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6879050788494034 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8174680375200936 iter_best_prior_star_anomaly= 530
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7120496411906202 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6915640479228742 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8070005562363382 iter_best_prior_star_anomaly= 530
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7120496411906202 at iter 0
max_prior_anomaly= 0.6921863043425488 at iter 79
max_prior_star_anomaly= 0.8240537913258796 at iter 53
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7120496411906202
accuracies_anomaly['prior'][-1]= 0.6921863043425488
accuracies_anomaly['prior_star'][-1]= 0.8034564758258844



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.72182655334473 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7120496411906202
 first_prior_anomaly_auc= 0.6921998144471571
 first_prior_star_anomaly_auc= 0.8032065388906304


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7136055197221141; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6934554097941925; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.8224228683851943 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7134113119683695; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6915996174951633; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 60 
last prior star auc 0.8268923909613178 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7124892473288518; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6897560687284353; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 60 
last prior star auc 0.8269145559766908 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7115797428647122; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6883594616645504; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 60 
last prior star auc 0.8256643435619602 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7136832028236119 at iter 120
0.6935982158218102 at iter 60
0.8271463914827234 at iter 250
last anomaly aucs:
0.7105233160129572
0.6875352925095969
0.8243628349687948




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.60117769241333 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.710444682982229,first_prior_anomaly_auc= 0.6874731776927063, first_prior_star_anomaly_auc= 0.8242321669257862


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.710444682982229 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7229944091387415 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8254472319589968 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7104446829822291 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7254821154712862 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.82279988474192 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.710444682982229 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7254667582820635 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8211052109951142 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.710444682982229 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7251285834760866 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8198991702895913 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.710444682982229 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7248372190716236 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.818934675477788 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7104446829822291 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7246338814424993 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8180890801413072 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.710444682982229 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7244329186364505 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.817377055409372 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7104446829822291 at iter 1
max_prior_anomaly= 0.7255804859204656 at iter 23
max_prior_star_anomaly= 0.8257214976373148 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.710444682982229
accuracies_anomaly['prior'][-1]= 0.7242492656519312
accuracies_anomaly['prior_star'][-1]= 0.8168086810865924



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.8996217250824 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.710444682982229
 first_prior_anomaly_auc= 0.7242268367673275
 first_prior_star_anomaly_auc= 0.8167530574527753


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7080739762665459; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.706179078547537; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8103886371576428 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7068794930333245; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7003245591536764; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8095269985719398 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7061308432521778; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6975522962428187; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8102534833377135 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7058222218000314; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6966108636017728; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8111954964910669 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.710444682982229 at iter 0
0.7242268367673275 at iter 0
0.8167530574527753 at iter 0
last anomaly aucs:
0.7056653779293443
0.6965526540494955
0.8119673139906632




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.5686354637146 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.705648965263199,first_prior_anomaly_auc= 0.69656035903103, first_prior_star_anomaly_auc= 0.8120413029229323


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.705649018037045 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.72564418395274 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8189536212885474 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.705649018037045 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7531887541044859 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8247589026839723 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.705649018037045 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7519483576251348 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8215852418994786 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.705649018037045 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7499964641523096 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8195300172359382 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7056490180370452 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7484103989808315 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8180796336228506 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7056490180370452 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7474492289213343 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8171089114972047 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7056490180370452 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7472379224414448 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8165384789944261 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7056490180370452 at iter 6
max_prior_anomaly= 0.7535086163858571 at iter 23
max_prior_star_anomaly= 0.8266980248860349 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.705649018037045
accuracies_anomaly['prior'][-1]= 0.7466167214986928
accuracies_anomaly['prior_star'][-1]= 0.8159576500439607



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.68046307563782 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7056490180370452
 first_prior_anomaly_auc= 0.7473386149398537
 first_prior_star_anomaly_auc= 0.8162249495745901


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7094448296935211; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6885508724044503; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8011695739778497 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7095794030011431; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6861528816103201; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8017079727560297 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7095725424011468; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.6842976170497519; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8008460703010959 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7095082638565648; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.6852739859769337; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8017555219913894 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7095892189365226 at iter 210
0.7473386149398537 at iter 0
0.8162249495745901 at iter 0
last anomaly aucs:
0.7094535901519782
0.684201410328264
0.8008976831226075




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.56702542304993 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7094332722212194,first_prior_anomaly_auc= 0.6853174188522955, first_prior_star_anomaly_auc= 0.80181341490059


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7094332722212194 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6794258522184542 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8171354039679599 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7094332722212194 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6918091824381306 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8018958476482391 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7094332722212195 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6965074268633653 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8022552903142048 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7094332722212194 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6965664280233345 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8015268529161246 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7094332722212195 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6987045603991391 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8029522744999942 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7094333249950656 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6969526270292863 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8010024919810141 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7094333249950655 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6957091696668597 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8001019590707158 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7094333249950657 at iter 19
max_prior_anomaly= 0.703505238859705 at iter 26
max_prior_star_anomaly= 0.8200640885587358 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7094332722212195
accuracies_anomaly['prior'][-1]= 0.6957077975468604
accuracies_anomaly['prior_star'][-1]= 0.8002011211275871



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.73712182044983 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7094332722212195
 first_prior_anomaly_auc= 0.6979522164487635
 first_prior_star_anomaly_auc= 0.8012178092732092


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6924303306070364; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5992296073942491; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7236106493399574 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6939385015816322; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5989452619113209; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7225919557881826 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6956708558545722; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6215834475887102; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7388477252889104 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6955819846976956; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5934269119172844; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7273593339518427 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7094332722212195 at iter 0
0.6979522164487635 at iter 0
0.8012178092732092 at iter 0
last anomaly aucs:
0.6966290705786863
0.6088604648953653
0.7364432960855527




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.87237548828125 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6956433079068944,first_prior_anomaly_auc= 0.5990764049189448, first_prior_star_anomaly_auc= 0.7246186298009687


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6956433079068943 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6708546407737068 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8179208371198567 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6956433079068943 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6293536048231073 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7680274930628779 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6956433079068942 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6196917163004689 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.757154708640873 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6956433079068943 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6174906247262357 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7547462158513635 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6956433079068943 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6172410572079047 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7544265646653769 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6956433079068943 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6170504380756967 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7548146635297892 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6956433079068943 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6165192165405899 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7540740881470998 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6956433079068944 at iter 0
max_prior_anomaly= 0.6708546407737068 at iter 10
max_prior_star_anomaly= 0.8179208371198567 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6956433079068943
accuracies_anomaly['prior'][-1]= 0.6175645608846585
accuracies_anomaly['prior_star'][-1]= 0.7557761502323632



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.20324897766113 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6956433079068944
 first_prior_anomaly_auc= 0.6175836122431101
 first_prior_star_anomaly_auc= 0.7562231447090525


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6956913848807152; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.587573764643423; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7238622222644413 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6934260675357464; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5884033167306814; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7249556435823309 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6922932241548005; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.59158399643671; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7281031813129921 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6944792751828877; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5770441157689308; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7226913817142846 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6972330672476011 at iter 60
0.6175836122431101 at iter 0
0.7562231447090525 at iter 0
last anomaly aucs:
0.6955093678854258
0.5974076959044329
0.732751237810561




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.70704650878906 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6944892494398056,first_prior_anomaly_auc= 0.6058942053261477, first_prior_star_anomaly_auc= 0.7358939203473785


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6944892494398056 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6693267851545059 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.825169747076065 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6944892494398056 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.630085841938109 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7769762486028124 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6944892494398056 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.6221280209068869 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.770381470469339 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6944892494398056 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.6218365509547317 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7701971314248199 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6944892494398057 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.6217348029794003 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7705218489000347 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6944892494398056 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.6209037732244502 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7709085228706016 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6944892494398057 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.6209898473674822 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.772172403711479 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6944892494398057 at iter 22
max_prior_anomaly= 0.6764073465415715 at iter 1
max_prior_star_anomaly= 0.825169747076065 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6944892494398056
accuracies_anomaly['prior'][-1]= 0.6223828658098305
accuracies_anomaly['prior_star'][-1]= 0.7720793106469124



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.08076643943787 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6944892494398056
 first_prior_anomaly_auc= 0.6224251376605776
 first_prior_star_anomaly_auc= 0.7717011860394178


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6864763852870739; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5490616282420293; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6748526290346925 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6900161382421454; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5837654983592611; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7002980139090749 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6820670248955342; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5637563473743428; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6846689866049424 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6851624220662227; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5496646749817139; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6753889696328734 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6944892494398056 at iter 0
0.6224251376605776 at iter 0
0.7717011860394178 at iter 0
last anomaly aucs:
0.6827951984243841
0.5622414741212891
0.6802782026072391




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.982455015182495 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6863289351609971,first_prior_anomaly_auc= 0.5589830585399166, first_prior_star_anomaly_auc= 0.6763840732754299


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6863289351609971 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6270370440735498 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7890582401611079 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6863289879348433 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5922893188901871 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7367904424453712 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6863289879348433 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5847551135218204 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7299045110028191 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6863289879348433 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5831295735134399 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7290665678740267 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6863289879348433 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5827917153505398 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7293263207446601 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6863289351609971 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5829279774212377 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7299696867027851 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6863289351609971 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5833274754364133 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7307325326485399 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6863290407086895 at iter 12
max_prior_anomaly= 0.6860065397350119 at iter 1
max_prior_star_anomaly= 0.8209200803429033 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6863289351609971
accuracies_anomaly['prior'][-1]= 0.5836557287593186
accuracies_anomaly['prior_star'][-1]= 0.7315087831512108



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.04756140708923 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6863290407086894
 first_prior_anomaly_auc= 0.5839508928807026
 first_prior_star_anomaly_auc= 0.7317632586372316


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6840372836668112; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5651067773228672; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.6864579144409297 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6874989313296158; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5734306377508208; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.6958227917575697 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6844628519619733; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.589034016965736; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.708176885266492 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6870754739882989; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5850662153447346; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.7042521998777758 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6931302701282088 at iter 30
0.6115691353216408 at iter 20
0.7317632586372316 at iter 0
last anomaly aucs:
0.6846495130557217
0.5889823513703785
0.706837485051808




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.05028438568115 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6800957106473345,first_prior_anomaly_auc= 0.5737681792706443, first_prior_star_anomaly_auc= 0.6923201388163249


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6800957106473345 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6212928220180929 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7686235208810277 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6800957106473345 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5936613333417772 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7297784342844236 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6800957106473345 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5847750620356561 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7211218347566439 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6800957106473345 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5826774071998302 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7186975625871428 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6800957106473345 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.580728416288542 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.717563083216967 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6800957106473345 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5800748649781147 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7170587763433847 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6800957106473345 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5803103946533761 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7170983039541332 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6800957106473345 at iter 0
max_prior_anomaly= 0.69858534428074 at iter 1
max_prior_star_anomaly= 0.8214107715641852 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6800957106473345
accuracies_anomaly['prior'][-1]= 0.5811645393529293
accuracies_anomaly['prior_star'][-1]= 0.7176649895138367



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.27323007583618 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5135332195529212
accuracies_anomaly["prior"][-1]= 0.6758322171664878
accuracies_anomaly["prior_star"][-1]= 0.5136952352605287


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 1078.6969022750854 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.005692958831787109 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49757931645203546
 first_prior_anomaly_auc= 0.6728608385341959
 first_prior_star_anomaly_auc= 0.4977542089780978


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5036688905565424; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6860563582457551; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5046413014452646 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5342508594220842; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6866852113961954; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5387662952443376 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6199649792757105; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6867704939315356; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 290 
last prior star auc 0.6315388642435027 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6849916459001582; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6868194680607406; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 400 
last prior star auc 0.7031781993352606 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7032989986690437 at iter 490
0.6868976789006997 at iter 490
0.7247087675301522 at iter 490
last anomaly aucs:
0.7032989986690437
0.6868976789006997
0.7247087675301522




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.59694457054138 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.704146546637831,first_prior_anomaly_auc= 0.6869143554360756, first_prior_star_anomaly_auc= 0.7257581754603727


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.704146546637831 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6892966196240603 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7244118090980001 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.704146546637831 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6937458242694253 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.72207498319153 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.704146546637831 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5896479878915688 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7256899916511775 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.704146546637831 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.6855816574998497 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7923075786409468 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7041465466378312 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.6941024699215464 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8193196606852788 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.704146546637831 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.6932087448373985 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8147163036353791 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.704146546637831 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.6918556761965677 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8025734638325002 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7041465466378312 at iter 22
max_prior_anomaly= 0.6948226218257851 at iter 18
max_prior_star_anomaly= 0.8214237539303322 at iter 54
last values
accuracies_anomaly['vanilla_star'][-1]= 0.704146546637831
accuracies_anomaly['prior'][-1]= 0.6908988335924529
accuracies_anomaly['prior_star'][-1]= 0.7986144754438016



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.61342453956604 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7041465466378309
 first_prior_anomaly_auc= 0.6908634223417022
 first_prior_star_anomaly_auc= 0.7983452232808657


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7112390876879673; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6961725768096944; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.8192149046007183 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7127739094548566; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6975714003751164; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.8251656307160672 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7125039184580748; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.6979283626703143; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.8263650219169782 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.711794110227677; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.6980191864594977; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 400 
last prior star auc 0.8261104936571114 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7128020906886883 at iter 210
0.6981487990255837 at iter 490
0.8263796402723552 at iter 320
last anomaly aucs:
0.7108759508527726
0.6981487990255837
0.8254394214297701




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.94738507270813 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7107693476835977,first_prior_anomaly_auc= 0.6981507516578903, first_prior_star_anomaly_auc= 0.8253873864174897


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7107693476835975 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7392048986794929 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8261832160170735 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7107693476835975 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7407493252863773 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8241511062981361 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7107693476835975 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7406419305095103 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.822843370391128 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7107693476835976 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7403824415081076 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8218121166639751 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7107693476835976 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7401189944682456 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8209482615767347 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7107693476835975 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7398174974853262 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8201451491863855 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7107693476835976 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7395574279716159 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8195062690051813 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7107693476835977 at iter 0
max_prior_anomaly= 0.7407888001232796 at iter 22
max_prior_star_anomaly= 0.8273429740595438 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7107693476835976
accuracies_anomaly['prior'][-1]= 0.7394023256378511
accuracies_anomaly['prior_star'][-1]= 0.8188786824270481



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.79455041885376 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7107693476835976
 first_prior_anomaly_auc= 0.7393635896347944
 first_prior_star_anomaly_auc= 0.8188157232286195


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7071929696793144; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7236660091045439; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.814972942849091 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7065940392996277; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7160216119454655; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8151026609628693 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7065385739873491; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7114082806386479; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.815591610647229 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7065341937581204; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.708355313640245; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8160491598931435 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7107693476835976 at iter 0
0.7393635896347944 at iter 0
0.8188157232286195 at iter 0
last anomaly aucs:
0.7065701327473326
0.70674713622724
0.8163572536068286




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.89724016189575 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7065853316150169,first_prior_anomaly_auc= 0.7066391609380657, first_prior_star_anomaly_auc= 0.8163789964314325


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.706585384388863 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7589194660553344 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8257471457265322 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7065853843888631 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.758517540443237 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8235362382169196 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.706585384388863 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7585349030386125 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8225950166712579 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.706585384388863 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7586801894369981 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8220154542930995 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7065853843888631 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7584990695970928 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8214015889149592 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.706585384388863 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7575917816344904 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8205815888938497 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.706585384388863 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.758411359464831 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.820536150612335 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7065853843888631 at iter 3
max_prior_anomaly= 0.7608902525650727 at iter 7
max_prior_star_anomaly= 0.8283616148374724 at iter 7
last values
accuracies_anomaly['vanilla_star'][-1]= 0.706585384388863
accuracies_anomaly['prior'][-1]= 0.758150128926506
accuracies_anomaly['prior_star'][-1]= 0.820183357450981



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.39959263801575 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7065853843888631
 first_prior_anomaly_auc= 0.7581193090003684
 first_prior_star_anomaly_auc= 0.8201105295433267


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7086406618262495; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6781627102114226; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8123662842673778 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.708754969976959; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6769318657982202; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8137280605928192 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.708623299230874; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6777982012562286; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.815015953533684 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7084561644601921; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6788774791833565; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8152949688581534 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7087831512107904 at iter 170
0.7581193090003684 at iter 0
0.8201105295433267 at iter 0
last anomaly aucs:
0.708267972924906
0.6794542445476701
0.8151220817382439




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.27926969528198 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7081845902480266,first_prior_anomaly_auc= 0.6873855203342906, first_prior_star_anomaly_auc= 0.8176209761261675


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7081845902480266 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6997315922186019 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8196399979312652 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7081845902480265 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6975688144566563 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8179032106552506 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7081845902480265 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6997444162632106 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8176358583507752 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7081845902480265 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6999909228984662 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8170148157295616 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7081845902480265 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6980097927148872 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8172370991694452 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7081845902480265 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.700034250226136 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8158782254055407 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7081845902480264 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6996017685571314 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8149485085583346 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7081845902480266 at iter 0
max_prior_anomaly= 0.7019735835235831 at iter 6
max_prior_star_anomaly= 0.82370870314606 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7081845902480265
accuracies_anomaly['prior'][-1]= 0.6999344548831112
accuracies_anomaly['prior_star'][-1]= 0.8143991328201605



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.30691266059875 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7081845902480265
 first_prior_anomaly_auc= 0.699956936541561
 first_prior_star_anomaly_auc= 0.8145874826769851


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7052623968403243; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6359473274796583; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7951978438717426 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7053942259079476; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.641949455321134; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8002153700660413 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7051809140219054; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6424147623224292; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.801612768737618 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7050107711419944; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6470857226692167; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8021876870173172 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7081845902480265 at iter 0
0.699956936541561 at iter 0
0.8145874826769851 at iter 0
last anomaly aucs:
0.7049331408143427
0.6455057792638892
0.803601814998116




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.48890924453735 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7048798920036012,first_prior_anomaly_auc= 0.6535093552197028, first_prior_star_anomaly_auc= 0.8039073755671869


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7048798920036012 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7132630702346008 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8293930268861637 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7048798920036012 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7135803465975118 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8242000276534954 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7048798920036012 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7126188598949379 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8217626147963087 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7048798920036012 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7047951372067226 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8222112980360741 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7048798920036012 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7131068596500671 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8198056022604094 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7048798920036013 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7125638167734282 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8176065688661749 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7048798920036012 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7126145852134016 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8173323559617031 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7048798920036013 at iter 3
max_prior_anomaly= 0.7172300802479104 at iter 13
max_prior_star_anomaly= 0.829899444713591 at iter 11
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7048798920036012
accuracies_anomaly['prior'][-1]= 0.7127996630917663
accuracies_anomaly['prior_star'][-1]= 0.8192267787160967



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.47256636619568 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7048798920036012
 first_prior_anomaly_auc= 0.7130591520931691
 first_prior_star_anomaly_auc= 0.8172849650478817


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6967873393432189; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5754029547020969; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6799498437366416 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6977417015765659; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5933412071911753; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6975301312274458 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7027240803893443; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5740582771028002; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6920951111364426 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7022277951403731; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5962189122465932; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7043433403100359 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7048798920036012 at iter 0
0.7130591520931691 at iter 0
0.8172849650478817 at iter 0
last anomaly aucs:
0.7009021161256819
0.5971934868630064
0.7049107647035853




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.32781434059143 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7004137469536297,first_prior_anomaly_auc= 0.6036956468965284, first_prior_star_anomaly_auc= 0.7119796630706567


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7004137469536297 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6530591415383998 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7721421642976487 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7004137469536297 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6553719553448824 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7664474441098582 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7004137469536297 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6576470358513846 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7683036058258105 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7004137469536297 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6590606360937221 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7696060643482061 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7004137469536297 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6599110866240465 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7705157799077302 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7004137469536297 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.6603615641745801 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7711230485551048 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7004137469536297 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.6604939209806647 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7714630176718501 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7004137469536298 at iter 57
max_prior_anomaly= 0.6772462395995944 at iter 6
max_prior_star_anomaly= 0.813201272060787 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7004137469536297
accuracies_anomaly['prior'][-1]= 0.6603800877945705
accuracies_anomaly['prior_star'][-1]= 0.7715859279594782



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.28532385826111 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7004137469536297
 first_prior_anomaly_auc= 0.6603765519468799
 first_prior_star_anomaly_auc= 0.7715863501502471


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7067742619841488; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6463220323419238; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 30 
last prior star auc 0.7838783816161252 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7069332168086812; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.6545568105176164; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 30 
last prior star auc 0.7890318004641987 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7078656778958856; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6532835359321286; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 30 
last prior star auc 0.7913992352014219 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7065672301857956; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6569207621809954; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 30 
last prior star auc 0.7884642705229572 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.708352886043323 at iter 410
0.6719004073085444 at iter 440
0.7974512871013332 at iter 390
last anomaly aucs:
0.7070883191424461
0.6590845954198634
0.7923507476470781




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.08283472061157 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7071389292608813,first_prior_anomaly_auc= 0.6495667267233036, first_prior_star_anomaly_auc= 0.7888322097781493


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7071389292608813 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6661240459807967 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8026176883155538 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7071389820347274 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6667956987204453 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7986006486961167 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7071389820347274 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6633599630160887 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7949851124980077 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7071389820347274 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6637204083851309 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7948925471719023 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7071389292608813 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6608140471312665 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7917816344904527 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7071389292608813 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6609156895589057 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7913956465798854 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7071389292608813 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6618762263322494 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7917778347735316 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7071390348085734 at iter 8
max_prior_anomaly= 0.6821364225031902 at iter 5
max_prior_star_anomaly= 0.8290686788278718 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7071389292608813
accuracies_anomaly['prior'][-1]= 0.6619669445737404
accuracies_anomaly['prior_star'][-1]= 0.7917122896566429



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.95106625556946 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7071389820347274
 first_prior_anomaly_auc= 0.6624894584242362
 first_prior_star_anomaly_auc= 0.792444737867029


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7126969651872047; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5939114813724156; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7157419633348426 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7123852828519831; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.610273748494626; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7291481562401378 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7101984929900499; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5893180458055876; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7160323778100754 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7120419362090857; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5997005084232336; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7187944553686306 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7159337962655116 at iter 250
0.6624894584242362 at iter 0
0.792444737867029 at iter 0
last anomaly aucs:
0.7124172638027355
0.6040384130271184
0.7228404678295912




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.21294641494751 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7111065197864981,first_prior_anomaly_auc= 0.6097872264071883, first_prior_star_anomaly_auc= 0.7325921774383364


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7111065197864981 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6360440091657615 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7695428412805468 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7111065197864981 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6320279194755546 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7638864876788901 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7111065197864981 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6341562359159798 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7644960783754944 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7111065197864981 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6356864135844101 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7650980168644104 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7111065197864981 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6364338495670963 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7655111305318865 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7111065197864981 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6368405775991911 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7657936817040464 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7111065197864981 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6371297782759628 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7661582962069325 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7111065197864981 at iter 0
max_prior_anomaly= 0.6686772446563841 at iter 5
max_prior_star_anomaly= 0.8218101640316686 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7111065197864981
accuracies_anomaly['prior'][-1]= 0.6373209251466321
accuracies_anomaly['prior_star'][-1]= 0.766785988332758



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.5667655467987 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.49757931645203546
accuracies_anomaly["prior"][-1]= 0.6728608385341959
accuracies_anomaly["prior_star"][-1]= 0.4977542089780978


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 1082.4191048145294 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.010548591613769531 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49809966657484017
 first_prior_anomaly_auc= 0.6710433600474542
 first_prior_star_anomaly_auc= 0.49828743591935737


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.508637917586251; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6867137092731035; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5096799371780136 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5448638909734558; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6876367766156978; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.549584036544833 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6297860864921119; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6878756838171112; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6409828495554859 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6915332279967364; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6879829202724398; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 400 
last prior star auc 0.708897142718423 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7058078673138851 at iter 490
0.6880818184600802 at iter 490
0.7272470312072861 at iter 490
last anomaly aucs:
0.7058078673138851
0.6880818184600802
0.7272470312072861




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.44361615180969 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.706332861535149,first_prior_anomaly_auc= 0.688096278493919, first_prior_star_anomaly_auc= 0.7280995926914556


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.706332914308995 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6882623577876782 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7279944671899722 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7063328615351488 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6883545009230146 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.72786316586081 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7063328615351488 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.6884030000876046 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7277218902747301 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.706332914308995 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.6884786777829497 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7275612466871219 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.706332914308995 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.688539051062918 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7273922120579794 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.706332914308995 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.6886014825228852 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7272069230842302 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.706332914308995 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.6886743104305395 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7270185204535595 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7063329143089951 at iter 26
max_prior_anomaly= 0.6887110410274435 at iter 77
max_prior_star_anomaly= 0.7280995926914556 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.706332861535149
accuracies_anomaly['prior'][-1]= 0.6887072413105224
accuracies_anomaly['prior_star'][-1]= 0.7268303289182733



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.06625843048096 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.706332861535149
 first_prior_anomaly_auc= 0.6887080856920604
 first_prior_star_anomaly_auc= 0.7268108553690527


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7090866008260163; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6887048664874466; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 30 
last prior star auc 0.7320678692770721 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.709947658899412; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6887034415936013; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 30 
last prior star auc 0.7341975578374966 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7099437536347987; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.6887192737474391; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 280 
last prior star auc 0.7345966864357494 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7098236403610154; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.6887554766058818; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 400 
last prior star auc 0.7348721131386823 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7100132040163007 at iter 260
0.688808672642777 at iter 490
0.7348721131386823 at iter 400
last anomaly aucs:
0.7093747987997115
0.688808672642777
0.734652098974182




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.7391562461853 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7093073538243624,first_prior_anomaly_auc= 0.6888147416350815, first_prior_star_anomaly_auc= 0.7346135740665098


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7093074065982083 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6888951162027317 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7342980392405211 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7093073010505161 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6888885722458121 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.733974957754536 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7093074065982085 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6888021814597034 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7336275475254871 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7093074065982085 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6886235419905662 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7332721156718268 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7093074065982085 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6882149141000106 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7328736203597277 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7093074065982085 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6874700112619389 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7324777109660885 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7093074065982083 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6862068164810611 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7320574200555392 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7093074065982085 at iter 3
max_prior_anomaly= 0.6889183366950273 at iter 12
max_prior_star_anomaly= 0.7346135740665098 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7093074065982083
accuracies_anomaly['prior'][-1]= 0.6844879723127293
accuracies_anomaly['prior_star'][-1]= 0.731653911228058



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.31762647628784 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7093074065982085
 first_prior_anomaly_auc= 0.6842447904297796
 first_prior_star_anomaly_auc= 0.7316107949957729


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7084859816832534; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6842066877128765; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7310255330422328 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7076718923329101; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6842027296744171; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.730410717734862 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7069454603409824; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6842432072143958; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7298353772643937 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7065192587596669; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6843024194697495; count_not_improved_prior_anomaly= 31; iter_best_prior_anomaly= 400 
last prior star auc 0.7294635855184344 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7093074065982085 at iter 0
0.6843722392681746 at iter 490
0.7316107949957729 at iter 0
last anomaly aucs:
0.7063058413259324
0.6843722392681746
0.7292519623954683




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.34194040298462 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.706280615427484,first_prior_anomaly_auc= 0.6843809469527854, first_prior_star_anomaly_auc= 0.7292355497293229


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.706280615427484 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6806614462778078 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7287719842649499 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.706280615427484 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.675089478056107 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7283292116959508 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.706280615427484 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.667572265866193 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7278620048361952 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.706280615427484 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.658214460244934 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7274090469148937 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.706280615427484 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.647416931327505 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.726956458410515 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.706280615427484 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.636162117033392 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7265339509984283 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.706280615427484 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6232142122078572 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7261610510017004 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.706280615427484 at iter 0
max_prior_anomaly= 0.6843809469527854 at iter 0
max_prior_star_anomaly= 0.7292355497293229 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.706280615427484
accuracies_anomaly['prior'][-1]= 0.611609771183158
accuracies_anomaly['prior_star'][-1]= 0.7258602400787808



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.90391874313354 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.706280615427484
 first_prior_anomaly_auc= 0.6104042582160962
 first_prior_star_anomaly_auc= 0.7258342753464866


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7059998585660924; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6104869548329761; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7256414397127414 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.705766809261599; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6105471697914061; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.7254550952620696 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7056551398031958; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6105990464821482; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 300 
last prior star auc 0.7253252188267529 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7055899113293838; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6106239557375198; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 390 
last prior star auc 0.7252504910606382 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.706280615427484 at iter 0
0.6106278082282871 at iter 420
0.7258342753464866 at iter 0
last anomaly aucs:
0.7056102820339885
0.6106128204559871
0.7252805193790841




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.36752963066101 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7056122874401413,first_prior_anomaly_auc= 0.6106091262867583, first_prior_star_anomaly_auc= 0.7252833691667748


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7056122874401413 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5966726090017405 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7250201859961433 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7056122874401413 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5837356283623536 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7249006004608212 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7056122874401413 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5722715657683503 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7252071109591224 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7056122874401413 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5637632607481854 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7256490391465837 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7056122874401413 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5579630456419885 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7263581085431358 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7056122874401413 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5546351269052677 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7274286787856528 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7056122874401413 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.553793700702631 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7291508477062902 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7056122874401414 at iter 7
max_prior_anomaly= 0.6106091262867583 at iter 0
max_prior_star_anomaly= 0.731539761398887 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7056122874401413
accuracies_anomaly['prior'][-1]= 0.5552603914341714
accuracies_anomaly['prior_star'][-1]= 0.731539761398887



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.40128493309021 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7056122874401413
 first_prior_anomaly_auc= 0.5555250522724946
 first_prior_star_anomaly_auc= 0.7318126021833595


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7056625281416534; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5554517494002252; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7318496494233402 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7057206849200846; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.555382299018723; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7319100227033086 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7057919296123549; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5553132180541439; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7319725069371221 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7058469199600185; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5552309964018792; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7320330913124751 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7058816451507697 at iter 490
0.5555250522724946 at iter 0
0.7320986364293638 at iter 490
last anomaly aucs:
0.7058816451507697
0.5551721535634484
0.7320986364293638




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.40043902397156 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7058920943723026,first_prior_anomaly_auc= 0.555162759818838, first_prior_star_anomaly_auc= 0.7321061303155137


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7058920943723026 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5600757410239604 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7357031956674783 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7058920943723026 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5689635955454653 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7405938535356894 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7058920943723026 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5828126665674518 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7466805778525054 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7058920943723026 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6001979546968195 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7536779676580762 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7058920943723026 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6179508654383026 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.761545862055499 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7058920943723026 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6347641378495079 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7699434475464911 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7058920943723026 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6472255205876051 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7781197523006758 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7058920943723026 at iter 0
max_prior_anomaly= 0.655852566761554 at iter 79
max_prior_star_anomaly= 0.7847625546341241 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7058920943723026
accuracies_anomaly['prior'][-1]= 0.655852566761554
accuracies_anomaly['prior_star'][-1]= 0.7847625546341241



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.94640493392944 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7058920943723026
 first_prior_anomaly_auc= 0.656628025656533
 first_prior_star_anomaly_auc= 0.7853483970999715


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7066182624949997; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6565051681427512; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7854851341352846 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7075880346914155; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6564161386643362; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.785624932053673 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7083535721033227; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.656328322984382; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7857775012428241 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7090163060629762; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6562402434351975; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7858893817966117 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7095649957411505 at iter 490
0.656628025656533 at iter 0
0.78600738411655 at iter 490
last anomaly aucs:
0.7095649957411505
0.6561727456860019
0.78600738411655




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.31407070159912 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7096145503826632,first_prior_anomaly_auc= 0.6561657795383133, first_prior_star_anomaly_auc= 0.7860215275073119


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7096145503826632 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6650378546798263 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7925281205439084 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7096145503826632 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6708307869952579 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7971037713245918 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7096145503826632 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6746025337779002 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8004596074259134 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7096145503826632 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.67826614694983 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8036460394811697 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7096145503826632 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.680692055108561 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8061858335998412 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7096145503826632 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.682862485078195 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8084859289094073 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7096145503826632 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.684374561317404 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8104001418560983 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7096145503826632 at iter 0
max_prior_anomaly= 0.6861694525980038 at iter 79
max_prior_star_anomaly= 0.8121526557382588 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7096145503826632
accuracies_anomaly['prior'][-1]= 0.6861694525980038
accuracies_anomaly['prior_star'][-1]= 0.8121526557382588



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.4256763458252 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7096146559303556
 first_prior_anomaly_auc= 0.6863080894917772
 first_prior_star_anomaly_auc= 0.8123126660397133


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7135146431590846; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6862338894641238; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8124469754781047 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7160498459531432; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6861422740672487; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8125745298641919 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7177779255445469; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6860444841303768; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8126847216549034 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.719155850666903; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6859565101288843; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8128192949625253 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7202393505017209 at iter 490
0.6863080894917772 at iter 0
0.8129275341209302 at iter 490
last anomaly aucs:
0.7202393505017209
0.6858846321504604
0.8129275341209302




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.47172665596008 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7203369821170544,first_prior_anomaly_auc= 0.6858830489350766, first_prior_star_anomaly_auc= 0.8129391971409241


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7203369293432084 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6912366389815069 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8164015308637285 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7203369293432084 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6921856182825491 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8178810456398775 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7203369821170544 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6930909536128448 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8191945866699598 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7203369293432084 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6940232036046649 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.820331757506288 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7203369293432084 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6949724467749375 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8214029610349585 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7203369821170544 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.695879418094463 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8223594869959966 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7203369293432084 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6968393215816534 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8232047656894007 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7203370348909006 at iter 3
max_prior_anomaly= 0.6977012768104331 at iter 79
max_prior_star_anomaly= 0.8239082410582634 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7203369821170544
accuracies_anomaly['prior'][-1]= 0.6977012768104331
accuracies_anomaly['prior_star'][-1]= 0.8239082410582634



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.27399230003357 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7203369293432084
 first_prior_anomaly_auc= 0.6977946865180766
 first_prior_star_anomaly_auc= 0.8239663978366946


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7227383504373368; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6977506203565612; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.8242373915365527 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7243259460503526; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6977110927458126; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.8244671160887402 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7256030203527615; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.697662329711992; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.8246674456086355 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7266022403553158; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6976051756366373; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.8248576425500744 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7273508901364627 at iter 490
0.6977972196626907 at iter 20
0.8250183916853749 at iter 490
last anomaly aucs:
0.7273508901364627
0.6975640648105049
0.8250183916853749




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.24162459373474 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7274207627087337,first_prior_anomaly_auc= 0.6975617955351214, first_prior_star_anomaly_auc= 0.8250312685038298


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7274207627087338 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7002795958367768 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8262292875847416 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7274207627087337 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.701116589036339 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8266882617245016 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7274207627087337 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7020125306220242 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8270677584519952 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7274207627087337 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7030117506245784 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.82737068032876 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7274207627087337 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7040609474594143 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8276639445916835 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7274207627087337 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.705211258983428 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8278867557700285 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7274207627087337 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7065069624535195 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8280739973760844 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7274207627087338 at iter 10
max_prior_anomaly= 0.7077870976390037 at iter 79
max_prior_star_anomaly= 0.8281981214621733 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7274207627087337
accuracies_anomaly['prior'][-1]= 0.7077870976390037
accuracies_anomaly['prior_star'][-1]= 0.8281981214621733



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.02559757232666 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7274207627087338
 first_prior_anomaly_auc= 0.7079160769189363
 first_prior_star_anomaly_auc= 0.8282093095175521


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7288457621018345; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7079492188943035; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.8290989710155483 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7297217023998379; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7077651964928613; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 60 
last prior star auc 0.8296522520183357 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7303841197164145; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.707485442334546; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 60 
last prior star auc 0.8300569746442779 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.730968326193032; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.707204052187001; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 60 
last prior star auc 0.8304011128948671 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.731457856389699 at iter 490
0.7079850523358233 at iter 60
0.8306889414516396 at iter 490
last anomaly aucs:
0.731457856389699
0.706945302019444
0.8306889414516396




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.37119102478027 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7314980700604472,first_prior_anomaly_auc= 0.7069238230640706, first_prior_star_anomaly_auc= 0.8307179670670091


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.731498017286601 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7094736442135061 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8305153154978844 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7314980700604472 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7115027458232139 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8305194318578821 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.731498017286601 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7136817251559203 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8305581678609387 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7314980700604472 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.716161832054623 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8306635044578068 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.731498017286601 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7188648029055168 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8307853064946661 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.731498017286601 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7217448827840103 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8309255793776698 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7314980700604472 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7248473516500797 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.831122636919105 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7314980700604472 at iter 0
max_prior_anomaly= 0.7277806803393148 at iter 79
max_prior_star_anomaly= 0.8313037567590102 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.731498017286601
accuracies_anomaly['prior'][-1]= 0.7277806803393148
accuracies_anomaly['prior_star'][-1]= 0.8313037567590102



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.61387491226196 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.731498017286601
 first_prior_anomaly_auc= 0.7280714642314703
 first_prior_star_anomaly_auc= 0.8313166335774652


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7311997922821416; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7258905850403035; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8320079709617189 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7308870544699976; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7235059460292431; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8321482438447225 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7305748443963147; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7215770619533289; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8321700922170187 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7303392619472071; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7200681521448875; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8321979568077733 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.731498017286601 at iter 0
0.7280714642314703 at iter 0
0.8322629741862009 at iter 490
last anomaly aucs:
0.7301477984334611
0.718980641497764
0.8322629741862009




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.21167016029358 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7301212004150135,first_prior_anomaly_auc= 0.7188838542639684, first_prior_star_anomaly_auc= 0.8322638185677389


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7301212004150135 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7240020729566758 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8321692478354807 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7301212004150135 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7277902324054635 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8323460402200036 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7301212531888595 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7313967442758846 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.832621308601398 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7301212531888597 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7349588733417138 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8329007988904826 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7301212004150135 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7385024260137064 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8331578075211175 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7301212004150135 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7420161086887915 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8334399365025082 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7301212004150135 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7454042423839424 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.83371319947775 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7301212531888597 at iter 1
max_prior_anomaly= 0.7483454871500961 at iter 79
max_prior_star_anomaly= 0.8339397048253239 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7301212004150135
accuracies_anomaly['prior'][-1]= 0.7483454871500961
accuracies_anomaly['prior_star'][-1]= 0.8339397048253239



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.98247861862183 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7301212531888597
 first_prior_anomaly_auc= 0.7486398068899422
 first_prior_star_anomaly_auc= 0.8339826099622245


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7283763915143877; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7387714143074118; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8325144943368386 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7271125634473564; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7331299429303628; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8319046925448499 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7262283904293574; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7295236949291721; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8316901668603467 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7255502465066352; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7270194176089437; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8316589247434398 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7301212531888597 at iter 0
0.7486398068899422 at iter 0
0.8339826099622245 at iter 0
last anomaly aucs:
0.7250663103376576
0.725291390791386
0.8317167648787944




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.205161809921265 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7250191305192206,first_prior_anomaly_auc= 0.7251478987037688, first_prior_star_anomaly_auc= 0.8317230977403294


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7250191305192208 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7258943847572245 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8319279130371453 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7250191305192206 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7334388810255859 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8313560028666753 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7250191305192208 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.736776193506917 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8315992902973173 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7250191305192208 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7397744340268873 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8318646371956402 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7250191305192207 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7425754586838835 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8321386390047274 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7250191305192206 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7452278721901885 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.832427311943038 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7250191305192206 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7477272415427274 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8326873814567481 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7250191305192208 at iter 1
max_prior_anomaly= 0.7499198365277342 at iter 79
max_prior_star_anomaly= 0.8328978963289457 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7250191305192208
accuracies_anomaly['prior'][-1]= 0.7499198365277342
accuracies_anomaly['prior_star'][-1]= 0.8328978963289457



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.82436561584473 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7250191305192208
 first_prior_anomaly_auc= 0.7501359454276211
 first_prior_star_anomaly_auc= 0.8329162088535516


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7226474738743075; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.737847608130972; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.831347453503603 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7214454967549362; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7321849216677802; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.831207497263676 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7208308925429501; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7285960362619651; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8313829175281997 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7204431103216143; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7260538673202179; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8316463645680618 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7250191305192208 at iter 0
0.7501359454276211 at iter 0
0.8329162088535516 at iter 0
last anomaly aucs:
0.7202284263155727
0.7242958121842145
0.8319117114663848




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.53360986709595 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.720213491317119,first_prior_anomaly_auc= 0.7241449317581394, first_prior_star_anomaly_auc= 0.831942848035599


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7202135440909652 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7175562226169706 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.832696141915205 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.720213491317119 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7264277700200223 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8315697369434867 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7202135440909652 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7316523807865203 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8307460427531482 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7202134913171191 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7347903136771867 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8307774431915933 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7202134913171191 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7373676300004539 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8310170364530065 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7202135440909653 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7397270431130658 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8312544659867285 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7202135440909653 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7419465527595971 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.831502186420445 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7202135968648113 at iter 4
max_prior_anomaly= 0.7438705816416677 at iter 79
max_prior_star_anomaly= 0.8330453992288687 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7202134913171191
accuracies_anomaly['prior'][-1]= 0.7438705816416677
accuracies_anomaly['prior_star'][-1]= 0.8316914334326537



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.00512099266052 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7202134913171192
 first_prior_anomaly_auc= 0.7440641561092588
 first_prior_star_anomaly_auc= 0.8317134929003346


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7190467143531141; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7297268214629122; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8310124451283936 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7189749419223823; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7238555727598294; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8315626124742594 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.719106454346929; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7206500365722753; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8321256566385804 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7192275175499425; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7186741309994628; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8325660016106579 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7202134913171192 at iter 0
0.7440641561092588 at iter 0
0.8329032264874044 at iter 490
last anomaly aucs:
0.7193734900083277
0.7173604316478422
0.8329032264874044




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.00585150718689 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7193938607129324,first_prior_anomaly_auc= 0.7172373102648297, first_prior_star_anomaly_auc= 0.8329391127027703


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7193939134867786 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.707704875986739 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8343725559112513 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7193939134867786 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7132851824761277 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8339801295914566 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7193939134867786 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7189861299777611 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8326821568459816 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7193939134867786 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.72350884859078 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8318168240910496 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7193939134867786 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7268324926459646 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8316532779419044 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7193939134867786 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7295124013261012 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8318310730295038 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7193939134867786 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7319719791986607 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8321077135308975 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7193939134867786 at iter 1
max_prior_anomaly= 0.734080663768327 at iter 79
max_prior_star_anomaly= 0.8365396611285792 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7193939134867786
accuracies_anomaly['prior'][-1]= 0.734080663768327
accuracies_anomaly['prior_star'][-1]= 0.8323661470553776



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.87300729751587 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7193939134867786
 first_prior_anomaly_auc= 0.7342961393820604
 first_prior_star_anomaly_auc= 0.8323850928661372


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7195853242266784; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7151538515936118; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8314375384589405 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7197235917035292; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7096321240734231; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8316901668603467 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7197994804942588; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7067948965579842; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.83182035993874 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7198795911926783; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.705004754923536; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8318435804310358 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7199173244926587 at iter 490
0.7342961393820604 at iter 0
0.8323850928661372 at iter 0
last anomaly aucs:
0.7199173244926587
0.704017356262514
0.8318395168448839




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.95336651802063 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.719923287937271,first_prior_anomaly_auc= 0.7039370872425559, first_prior_star_anomaly_auc= 0.8318368781525776


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.719923287937271 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6980973445256107 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8350916523385675 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7199232879372709 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7001422255153102 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8348432986186973 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7199232879372709 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7026066058078674 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8336851237916107 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.719923287937271 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7051118858311722 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8320708773863015 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.719923287937271 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7073145078469432 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8306875693316402 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.719923287937271 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7092323621890169 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8300148611150691 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7199232879372709 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7109751656834898 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8297905722690326 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.719923287937271 at iter 0
max_prior_anomaly= 0.712477214891935 at iter 79
max_prior_star_anomaly= 0.8383881178629969 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7199232879372708
accuracies_anomaly['prior'][-1]= 0.712477214891935
accuracies_anomaly['prior_star'][-1]= 0.8297759011398096



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.99675941467285 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.719923287937271
 first_prior_anomaly_auc= 0.7126208653010906
 first_prior_star_anomaly_auc= 0.8297842921813436


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7208654066383164; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6998728678046818; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8286255896157959 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7208885215829199; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.6974484900874884; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8285068484620118 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7207854014875892; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.6965611506387219; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8284692734835699 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7206794316045677; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.6961897810835316; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8284554467358848 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7209158584352131 at iter 150
0.7126208653010906 at iter 0
0.8297842921813436 at iter 0
last anomaly aucs:
0.720588027303077
0.6960872415005082
0.8284804615389486




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.976834297180176 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7205235376631108,first_prior_anomaly_auc= 0.6960776366605133, first_prior_star_anomaly_auc= 0.8284842612558698


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7205235376631108 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6937636618294161 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8341559720467493 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7205235376631108 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6943942565167784 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8338888308376582 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7205235376631107 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6951955218225131 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8328797948997244 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7205235376631108 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6960991156158867 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8311153541283397 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7205235376631108 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6967486033401622 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8290532160909567 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7205235376631107 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6973510167936934 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.827377752024141 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7205235376631107 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6978755888241881 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8262356732201229 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7205235376631108 at iter 0
max_prior_anomaly= 0.6984314557454357 at iter 79
max_prior_star_anomaly= 0.8375352925095969 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7205235376631107
accuracies_anomaly['prior'][-1]= 0.6984314557454357
accuracies_anomaly['prior_star'][-1]= 0.8257122622142428



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.32148432731628 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.49809966657484017
accuracies_anomaly["prior"][-1]= 0.6710433600474542
accuracies_anomaly["prior_star"][-1]= 0.49828743591935737


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 1996.80948138237 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.006246805191040039 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.469077639826944
 first_prior_anomaly_auc= 0.6612205112941307
 first_prior_star_anomaly_auc= 0.4692619788714629


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4810940334945047; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.685944688787352; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.48214117214934155 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5244884367225753; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6877448574525643; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5292991949877512 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.616729520317403; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6880927954200746; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6285727102219774 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6816369180496052; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6882310628969253; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.7000185763938365 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6998130750370208 at iter 490
0.6883770353553105 at iter 490
0.721680340370198 at iter 490
last anomaly aucs:
0.6998130750370208
0.6883770353553105
0.721680340370198




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.107195138931274 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7006071103258363,first_prior_anomaly_auc= 0.6883919703537642, first_prior_star_anomaly_auc= 0.7226837295065962


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7006071103258363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6885424813629162 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7225740654543458 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7006071103258363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6886064432644212 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7224472499021045 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7006071103258363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6886350994628677 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7222962111544913 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7006071103258362 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6887177433059014 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7221319261715002 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7006071103258363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6888260352381524 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7219508591054411 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7006071103258363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6889705828026923 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7217527460870832 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7006071103258362 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6891626796025918 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7215630241102594 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7006071103258363 at iter 0
max_prior_anomaly= 0.6893645395640247 at iter 79
max_prior_star_anomaly= 0.7226837295065962 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7006071103258363
accuracies_anomaly['prior'][-1]= 0.6893645395640247
accuracies_anomaly['prior_star'][-1]= 0.7213757297303574



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.66416072845459 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7006071103258362
 first_prior_anomaly_auc= 0.6893870739963206
 first_prior_star_anomaly_auc= 0.721355517347291


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7047006720221566; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6894125109901534; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.7271226960258128 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7057543546339131; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6894388451393705; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 200 
last prior star auc 0.7292261559847124 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7063853187381984; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6894875026254988; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 300 
last prior star auc 0.7304601140548362 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7064972520658322; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6895451844393148; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 400 
last prior star auc 0.7309413587576614 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7065021072596759 at iter 410
0.6896197538838912 at iter 490
0.7310246358868486 at iter 490
last anomaly aucs:
0.7063687477505148
0.6896197538838912
0.7310246358868486




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.14031195640564 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7063760305412802,first_prior_anomaly_auc= 0.6896305197485011, first_prior_star_anomaly_auc= 0.7310550336222172


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7063760305412803 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6900628430959672 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7307391821531518 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7063760305412803 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6904624994326811 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.730406073636403 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7063760305412802 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6909186765585964 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7300676877350415 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7063760305412803 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6914884757752214 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7296835996829347 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7063760305412803 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6920626552210749 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7292857904308351 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7063760305412802 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6925469080331292 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7288566335141367 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7063760305412803 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6929524750406093 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7284277932405147 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7063760305412803 at iter 2
max_prior_anomaly= 0.69307221889747 at iter 78
max_prior_star_anomaly= 0.7310550336222172 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7063760305412803
accuracies_anomaly['prior'][-1]= 0.6930570728036317
accuracies_anomaly['prior_star'][-1]= 0.728024917699187



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.64336061477661 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7063760305412802
 first_prior_anomaly_auc= 0.6930574422205545
 first_prior_star_anomaly_auc= 0.7279845984807465


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7063168182859265; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6930511093590195; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 30 
last prior star auc 0.7280223317807268 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7060434497629926; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.69312071806206; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 200 
last prior star auc 0.7278259075254448 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7057085469354756; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6932320708773864; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 300 
last prior star auc 0.7276123317701719 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7053274142187518; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6933634777542408; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 400 
last prior star auc 0.727395378488747 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7064024174643433 at iter 30
0.6934563069495766 at iter 490
0.7280877713499233 at iter 60
last anomaly aucs:
0.7050514070035117
0.6934563069495766
0.7272667158518913




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.14534401893616 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7050271838081397,first_prior_anomaly_auc= 0.6934639063834189, first_prior_star_anomaly_auc= 0.7272545778672823


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7050271838081396 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6925507077500503 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7268153411459735 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7050272365819856 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6899467406344895 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7263936781154248 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7050271838081397 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6852063299061997 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.725963571269496 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7050271838081396 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6772596969303564 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7255736253204692 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7050272365819857 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6651520045089974 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7252063721252767 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7050272365819857 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6514590912976983 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7249128439931225 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7050271838081396 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6377714026971657 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7246516662286437 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7050272365819858 at iter 18
max_prior_anomaly= 0.6934639063834189 at iter 0
max_prior_star_anomaly= 0.7272545778672823 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7050271838081396
accuracies_anomaly['prior'][-1]= 0.6256206468173676
accuracies_anomaly['prior_star'][-1]= 0.7245226341748651



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.52255940437317 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7050272365819856
 first_prior_anomaly_auc= 0.624428960597991
 first_prior_star_anomaly_auc= 0.7245106017379483


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.704863057146687; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6242466797334709; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7244466398364432 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7047275339098349; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6240952715689347; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7244134978610761 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7046786125544758; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6239563180320845; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7244481702779809 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.704651961762182; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6238212697598474; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7244991498133388 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7050272365819856 at iter 0
0.624428960597991 at iter 0
0.7245186761364056 at iter 460
last anomaly aucs:
0.7046054680037449
0.6236717086799256
0.7245044271979516




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.146873235702515 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7046008766791318,first_prior_anomaly_auc= 0.6236630009953147, first_prior_star_anomaly_auc= 0.7245007858025688


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7046008766791318 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6114194159201807 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.724440676391831 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7046008766791318 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6014826284330705 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7248266643023984 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7046008766791318 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5934508712434257 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7253929804451791 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7046008766791318 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5873664689758391 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7261338724709454 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7046008766791318 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5834705453332615 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7272554222488202 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7046008766791318 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5817824683172215 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7289794910279184 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7046008766791318 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5826157673475548 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.731446984977397 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7046008766791318 at iter 0
max_prior_anomaly= 0.6236630009953147 at iter 0
max_prior_star_anomaly= 0.7345233307896339 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7046008239052857
accuracies_anomaly['prior'][-1]= 0.5859576711534991
accuracies_anomaly['prior_star'][-1]= 0.7345233307896339



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.47149682044983 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7046008239052857
 first_prior_anomaly_auc= 0.5864430322163221
 first_prior_star_anomaly_auc= 0.7348784987740635


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7045646210468431; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5863265603379215; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7349029858386661 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7045676819299185; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5861834376672271; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7349483185724887 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7045765479360677; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5860356181242274; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7350080057924574 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.704562932283767; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5859130772535224; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7350615184724294 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7046008239052857 at iter 0
0.5864430322163221 at iter 0
0.7350830502016489 at iter 470
last anomaly aucs:
0.7045377063853188
0.5858071601443471
0.7350809392478038




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.23214054107666 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7045366509083962,first_prior_anomaly_auc= 0.5857957609935838, first_prior_star_anomaly_auc= 0.7350802531878041


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7045366509083962 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5931047803605298 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7395918892931365 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7045366509083962 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6041201069409218 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7453805469270317 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7045366509083961 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6200615554141216 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7523388840864689 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7045366509083962 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.635366551303039 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7602416619961814 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7045366509083962 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6493159981803578 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7692306839807102 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7045366509083962 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6620715951106088 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7780404332099481 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7045366509083962 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6699491998957189 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7856017115613776 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7045366509083962 at iter 0
max_prior_anomaly= 0.675071059983809 at iter 79
max_prior_star_anomaly= 0.7917730323535341 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7045366509083962
accuracies_anomaly['prior'][-1]= 0.675071059983809
accuracies_anomaly['prior_star'][-1]= 0.7917730323535341



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.17794179916382 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7045366509083962
 first_prior_anomaly_auc= 0.6755188460681901
 first_prior_star_anomaly_auc= 0.7923418816409289


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7052005458926643; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6754080737651711; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7923793510716786 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7058191609169562; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.675299359642151; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7924655835362489 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7062750213997946; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6752124411175812; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7925613680669679 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7065689717227177; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6751271058083951; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7926217413469363 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7068289356887356 at iter 490
0.6755188460681901 at iter 0
0.7926824312699815 at iter 490
last anomaly aucs:
0.7068289356887356
0.6750530113284338
0.7926824312699815




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.12872767448425 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7068522617287235,first_prior_anomaly_auc= 0.6750491588376666, first_prior_star_anomaly_auc= 0.7926928804915144


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7068522089548773 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6799542239658701 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.798555263188448 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7068522089548773 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6825348122675972 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8024176754387354 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7068522089548773 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6843592041281813 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8056007827416858 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7068522089548773 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6860012623503995 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8085279368909237 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7068522089548773 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6871209122698135 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8109330521542811 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7068522089548773 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6879800177109027 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8130615269162448 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7068522089548773 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6887799108966381 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.81488971849375 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7068522617287235 at iter 0
max_prior_anomaly= 0.6894524080178248 at iter 79
max_prior_star_anomaly= 0.816441902856015 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7068522089548773
accuracies_anomaly['prior'][-1]= 0.6894524080178248
accuracies_anomaly['prior_star'][-1]= 0.816441902856015



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.82366895675659 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7068522089548773
 first_prior_anomaly_auc= 0.6895256581162481
 first_prior_star_anomaly_auc= 0.8165930471513205


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7095242543319411; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6895015404685685; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8167285703881728 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7114036365401888; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6894734120085831; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8168706375819446 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7128150730548353; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6894373674716789; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8169992474449542 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7137928668758622; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6894082363086173; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8171177247295076 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7145208293093276 at iter 490
0.6895256581162481 at iter 0
0.8172378907771372 at iter 490
last anomaly aucs:
0.7145208293093276
0.6893835909224761
0.8172378907771372




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.127307653427124 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7145877465462156,first_prior_anomaly_auc= 0.6893822715763231, first_prior_star_anomaly_auc= 0.8172499759879


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7145877465462156 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.690764629701754 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8198708307342213 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7145877465462156 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6912318365615095 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8212185692165934 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7145877465462156 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6917094398689521 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8223805965344471 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7145877465462156 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6921942731933137 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.823453277730809 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7145877465462157 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6926825368176737 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8243982989933916 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7145877465462156 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6931505880589672 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8252082192098911 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7145877465462156 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6935913024479676 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8259536497864243 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7145877465462157 at iter 5
max_prior_anomaly= 0.6940078991892883 at iter 79
max_prior_star_anomaly= 0.8265160078907455 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7145877465462156
accuracies_anomaly['prior'][-1]= 0.6940078991892883
accuracies_anomaly['prior_star'][-1]= 0.8265160078907455



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.69590854644775 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7145877465462156
 first_prior_anomaly_auc= 0.6940567677708009
 first_prior_star_anomaly_auc= 0.8265678318076414


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.71738961558475; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6940841573969405; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 100 
last prior star auc 0.8268056307582863 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7194347076698342; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6940746581046379; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 110 
last prior star auc 0.8270203147643278 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7208559073460138; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6941051613876988; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 300 
last prior star auc 0.8272285603611419 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7218992462839295; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6941147662276939; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 400 
last prior star auc 0.8274410278656462 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7226503236619982 at iter 490
0.6941464833092157 at iter 490
0.8276116984840185 at iter 490
last anomaly aucs:
0.7226503236619982
0.6941464833092157
0.8276116984840185




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.33476638793945 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7227151299450414,first_prior_anomaly_auc= 0.6941472749169075, first_prior_star_anomaly_auc= 0.8276298526870859


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7227151299450413 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6941607850215159 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8277153463178104 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7227151299450414 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6946316860505004 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8280085578068878 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7227151299450414 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6952078709025067 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8282649331513692 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7227151299450413 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6958466455360187 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8284373980805098 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7227151299450414 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6965893318725533 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8285247915696947 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7227151299450414 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6975432719151312 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8286563039942414 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7227151299450413 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6986010708868856 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8284965047881712 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7227151299450414 at iter 0
max_prior_anomaly= 0.6997877963647263 at iter 79
max_prior_star_anomaly= 0.8286563039942414 at iter 60
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7227151299450413
accuracies_anomaly['prior'][-1]= 0.6997877963647263
accuracies_anomaly['prior_star'][-1]= 0.8284133332066761



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.82550883293152 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7227151299450413
 first_prior_anomaly_auc= 0.6999246917215778
 first_prior_star_anomaly_auc= 0.8284023562466818


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7241844593688881; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7001979019229734; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.8292072629477993 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.725014222551531; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7003391247352072; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.8298383325997769 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.725521273665112; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7004429308905374; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.830378525688725 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7259626213402657; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7005135422966544; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.8308409301284831 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7262306597047409 at iter 490
0.7005690603827792 at iter 490
0.8311993173175265 at iter 490
last anomaly aucs:
0.7262306597047409
0.7005690603827792
0.8311993173175265




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.71293306350708 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.726251610921653,first_prior_anomaly_auc= 0.7005734406120079, first_prior_star_anomaly_auc= 0.8312266013959738


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.726251610921653 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.701333964508533 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.829378566852325 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7262516109216529 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7033850200382293 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8292069990785687 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.726251610921653 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7058200580723404 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8290706842340245 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.726251610921653 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7087313800677406 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8289752691202283 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.726251610921653 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7121184055121226 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8289625506233119 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.726251610921653 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7160624061285211 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8290036614494442 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7262516109216529 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7205509272892503 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8292079490077988 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.726251610921653 at iter 0
max_prior_anomaly= 0.7250159640884531 at iter 79
max_prior_star_anomaly= 0.8312266013959738 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.726251610921653
accuracies_anomaly['prior'][-1]= 0.7250159640884531
accuracies_anomaly['prior_star'][-1]= 0.8294214192153796



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.11439847946167 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.726251610921653
 first_prior_anomaly_auc= 0.7254809016728254
 first_prior_star_anomaly_auc= 0.8294528724276707


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7256018065543006; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7246400032086497; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.8313262911913062 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7250173889822986; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7229857014541305; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.832115049095509 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7245454324763916; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7214197958918728; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.8326072707583285 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7241706326212032; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7200846175848788; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.8329802763027487 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.726251610921653 at iter 0
0.725520429283574 at iter 10
0.8332464675826095 at iter 490
last anomaly aucs:
0.723924389855178
0.7190477170561904
0.8332464675826095




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.81968665122986 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7239011693628825,first_prior_anomaly_auc= 0.7189543601223931, first_prior_star_anomaly_auc= 0.8332703213610586


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7239011693628825 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7269444259735982 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8319037426156195 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7239011693628825 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7338141558453894 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8326699660875264 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7239011693628824 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7411468706692462 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8333978757471459 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7239011693628825 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.74878683482525 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8342000909821108 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7239011693628825 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7563290090443817 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8349493740494112 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7239011693628825 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7634774375975656 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8356970739013277 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7239011693628825 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7700734295295001 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.836346403304065 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7239011693628825 at iter 0
max_prior_anomaly= 0.7753637965082711 at iter 79
max_prior_star_anomaly= 0.8368495491530326 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7239011693628825
accuracies_anomaly['prior'][-1]= 0.7753637965082711
accuracies_anomaly['prior_star'][-1]= 0.8368495491530326



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.76188445091248 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7239011693628825
 first_prior_anomaly_auc= 0.7758706893003138
 first_prior_star_anomaly_auc= 0.8368989454730067


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7212131862842885; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7570887941070612; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8367316523807866 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7195124435451781; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7465025188956756; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8365291063593541 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7183354284550245; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7399303279683442; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8365307423485839 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.717522922320065; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7354436538922294; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8366207217562291 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7239011693628825 at iter 0
0.7758706893003138 at iter 0
0.8369776312775811 at iter 20
last anomaly aucs:
0.7169532814249782
0.7326027322075617
0.8367105956161821




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.40277075767517 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7169048878080806,first_prior_anomaly_auc= 0.7323682052353766, first_prior_star_anomaly_auc= 0.8367237363038675


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7169048350342344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7496973419924661 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8364076209655713 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7169048878080806 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7589563549737766 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8378281873555976 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7169048878080805 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7664818526575325 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8388372232935313 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7169048350342344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7724247154698086 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8395525200039263 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7169048878080806 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.777046701687391 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8399874292698526 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7169048878080805 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7805038635732748 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8402035381697397 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7169048350342344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7829979027673549 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8402758911127788 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7169048878080806 at iter 0
max_prior_anomaly= 0.7846097743495888 at iter 79
max_prior_star_anomaly= 0.8402871847158498 at iter 72
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7169048350342344
accuracies_anomaly['prior'][-1]= 0.7846097743495888
accuracies_anomaly['prior_star'][-1]= 0.8402767882681629



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.50588750839233 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7169048350342344
 first_prior_anomaly_auc= 0.7847573300233577
 first_prior_star_anomaly_auc= 0.8402733579681647


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.713495961217556; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7530592470860921; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8396311530346545 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7130246379978025; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.741498766675216; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8399455268360285 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7130882304823847; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7354602248799131; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8403620708035029 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7133617045530107; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7316087895896202; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.840693596104868 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7169048350342344 at iter 0
0.7847573300233577 at iter 0
0.8408982530801454 at iter 490
last anomaly aucs:
0.7137274273066657
0.7291878421724247
0.8408982530801454




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.42175555229187 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7137630496528008,first_prior_anomaly_auc= 0.7289704139263848, first_prior_star_anomaly_auc= 0.8409182015939811


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7137629968789547 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7525531986755876 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8404323655665431 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7137629968789547 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7618891031507042 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8422616126209709 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7137630496528008 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.767936405404464 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8433348215557941 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7137630496528009 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7717724307316882 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8439193446754885 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7137629968789547 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7742364416073225 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8441973572968813 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7137630496528008 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.775724030781929 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8442837480829901 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7137630496528008 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7766349073660679 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8442538780860825 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7137630496528009 at iter 1
max_prior_anomaly= 0.7770238506120184 at iter 79
max_prior_star_anomaly= 0.8443021661552882 at iter 63
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7137630496528008
accuracies_anomaly['prior'][-1]= 0.7770238506120184
accuracies_anomaly['prior_star'][-1]= 0.8441769865922767



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.33790612220764 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7137629968789547
 first_prior_anomaly_auc= 0.7770552510504634
 first_prior_star_anomaly_auc= 0.8441635292615143


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7151843021028267; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7257915285311245; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8398682131514535 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7172919839694165; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7184366486918946; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8396433965669556 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7183734256242355; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.716094070436197; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8393735111178662 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7189830163208397; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7156519311533514; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8392485426502393 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7194026211713895 at iter 490
0.7770552510504634 at iter 0
0.8441635292615143 at iter 0
last anomaly aucs:
0.7194026211713895
0.7158973823116844
0.8391496444625988




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.36591076850891 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7194433625805988,first_prior_anomaly_auc= 0.7159440343916601, first_prior_star_anomaly_auc= 0.8391777201487378


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7194433625805989 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7213898203472731 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8362659231887224 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7194433625805989 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7254223227036253 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.832268884856967 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7194433625805988 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7260634721602129 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8317007216295719 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7194433625805989 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7259641517818034 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8310637413068283 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7194433625805989 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7256419674512027 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8304376323963865 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7194433625805988 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7252067943160458 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8299357531197259 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7194433625805989 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7247273439239887 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8293566129323365 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7194433625805989 at iter 1
max_prior_anomaly= 0.7260942393125045 at iter 32
max_prior_star_anomaly= 0.8414505841537028 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7194433625805989
accuracies_anomaly['prior'][-1]= 0.7243372396534236
accuracies_anomaly['prior_star'][-1]= 0.8288195862741559



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.42393708229065 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7194433625805989
 first_prior_anomaly_auc= 0.724307686299593
 first_prior_star_anomaly_auc= 0.8287812196880222


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7216619750717461; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6678284301152897; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8049494479327957 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7219491703423649; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6659998163470154; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8053591840741199 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7219499091762108; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.6625751631503453; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8030363432368732 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7219773515761965; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.6644275251493764; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8045030867422599 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7220774107884518 at iter 260
0.724307686299593 at iter 0
0.8287812196880222 at iter 0
last anomaly aucs:
0.7218724371700974
0.6644338580109116
0.8049658078250949




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.461747884750366 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7219383517039092,first_prior_anomaly_auc= 0.6644494262955187, first_prior_star_anomaly_auc= 0.8032642734782925


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7219383517039092 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.689899349720668 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8332500034303001 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7219383517039092 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6866381371254509 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8291985024893422 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7219383517039092 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6827021053598173 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8240286709751234 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7219383517039092 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6815142188573617 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8213319274380725 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7219383517039092 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6817047324418776 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8204199426031649 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7219383517039092 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6823262500277063 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8202163938786561 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7219383517039092 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6829630720289117 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.82021892702327 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7219383517039092 at iter 0
max_prior_anomaly= 0.6908939783986092 at iter 6
max_prior_star_anomaly= 0.8337572128654194 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7219383517039091
accuracies_anomaly['prior'][-1]= 0.6835432149193774
accuracies_anomaly['prior_star'][-1]= 0.8203294882309047



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.97162222862244 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7219383517039092
 first_prior_anomaly_auc= 0.6835897614516606
 first_prior_star_anomaly_auc= 0.8203454787062809


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7229388910526167; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6837195851131314; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.8238614834305955 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.723178167670953; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6829434401581527; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.8250328517192136 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7230756808617758; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6768341814090406; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.8203271134078289 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7230884521325384; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6814354802789414; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.8235915452076598 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7232332635663088 at iter 180
0.7022526516218985 at iter 10
0.8349189763140423 at iter 10
last anomaly aucs:
0.7230483440094824
0.6823534285584614
0.8245387301979337




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.06514835357666 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.72303979464641,first_prior_anomaly_auc= 0.6801092207519428, first_prior_star_anomaly_auc= 0.8229164093941668


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.72303979464641 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6941408365076802 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8364939062039878 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.72303979464641 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6901637466897604 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8324271008476535 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7230397946464099 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6843776222004794 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8257978613926595 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.72303979464641 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6805662422593962 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8203585666201202 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.72303979464641 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6788877173095049 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8176257257723187 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.72303979464641 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6781383814683584 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8163215784868472 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.72303979464641 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6777889130593104 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8157173179487017 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.72303979464641 at iter 0
max_prior_anomaly= 0.6959619563898045 at iter 6
max_prior_star_anomaly= 0.8371540014713348 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.72303979464641
accuracies_anomaly['prior'][-1]= 0.677603149120946
accuracies_anomaly['prior_star'][-1]= 0.8153780348919561



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 77.72367548942566 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.469077639826944
accuracies_anomaly["prior"][-1]= 0.6612205112941307
accuracies_anomaly["prior_star"][-1]= 0.4692619788714629


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 2016.5336813926697 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.006036996841430664 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5033803231659242
 first_prior_anomaly_auc= 0.6766067261322366
 first_prior_star_anomaly_auc= 0.5035399640504561


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5100076099886114; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.686803741454595; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 90 
last prior star auc 0.5109347936912034 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5399077935360481; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6868336642253485; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 200 
last prior star auc 0.5440300642046612 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6246189464440455; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6870723075575315; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 300 
last prior star auc 0.6353853915661062 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.688853002673523; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.687264034940508; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 400 
last prior star auc 0.7055275326432625 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7061506862183212 at iter 490
0.6873897950158269 at iter 490
0.7262623767862628 at iter 490
last anomaly aucs:
0.7061506862183212
0.6873897950158269
0.7262623767862628




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.19460129737854 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7069244563502242,first_prior_anomaly_auc= 0.6874037273112042, first_prior_star_anomaly_auc= 0.72724275652575


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7069244563502242 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6762748841877947 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8016707144206645 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7069244563502242 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6888171164581571 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7931656286051134 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7069244563502242 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6889627722734656 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7879009624894056 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7069244563502242 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6867359270623228 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7818814720525543 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7069244563502242 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6770559898843093 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7733992373123757 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7069244563502242 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6660127987131625 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7624104559765852 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7069244563502242 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6731405926925111 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7649165276075822 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7069244563502242 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6641675084095123 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7549350406728033 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7069244563502242 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6749997625176924 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7617735812015338 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7069244563502242 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6614982072724471 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7490536593912642 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7069244563502242 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6608023841112727 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7460292430436155 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7069244563502242 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6727226766050374 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7593495729012634 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7069244563502242 at iter 0
max_prior_anomaly= 0.6895666633946882 at iter 28
max_prior_star_anomaly= 0.8119957063198792 at iter 9
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7069244563502242
accuracies_anomaly['prior'][-1]= 0.6700914781848752
accuracies_anomaly['prior_star'][-1]= 0.7518306719482732



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.27539014816284 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7069244563502242
 first_prior_anomaly_auc= 0.6684261994703617
 first_prior_star_anomaly_auc= 0.7508160419826501


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7129403581655389; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6741924282196532; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 100 
last prior star auc 0.7666995447728033 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7120594571259996; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.6853932548691788; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 190 
last prior star auc 0.7769496505843647 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7105021009268143; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.6970228162446342; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 300 
last prior star auc 0.7851558781093032 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.708936406459941; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7006272699350564; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 390 
last prior star auc 0.7858508041150933 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7131136674762175 at iter 110
0.7052872005480036 at iter 480
0.7889910590549893 at iter 480
last anomaly aucs:
0.7078762854389571
0.6990864319497087
0.7827459076521022




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.35031604766846 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7077666213867067,first_prior_anomaly_auc= 0.7028407633631294, first_prior_star_anomaly_auc= 0.7860125031796242


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7077666213867067 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6858631004212408 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8229997392972002 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7077666213867067 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7027096731293518 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.815208683619737 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7077666213867067 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7109679356665706 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7985617015976755 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7077666213867067 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.713203383014632 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7943709304767905 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7077666741605528 iter_best_vanilla_star_anomaly= 500 
last prior auc 0.7160657836546733 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7943678168198691 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7077666213867067 iter_best_vanilla_star_anomaly= 500 
last prior auc 0.71732940062632 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7927003216038183 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7077666213867067 iter_best_vanilla_star_anomaly= 500 
last prior auc 0.7187987300501668 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7913905802906573 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7077666213867067 iter_best_vanilla_star_anomaly= 500 
last prior auc 0.7195470631882369 iter_best_prior_anomaly= 780
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7898973970883614 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7077666213867067 iter_best_vanilla_star_anomaly= 500 
last prior auc 0.7168478920542642 iter_best_prior_anomaly= 780
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7873220333974007 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7077666213867067 iter_best_vanilla_star_anomaly= 500 
last prior auc 0.7199402283418774 iter_best_prior_anomaly= 780
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7870960557882882 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7077666213867067 iter_best_vanilla_star_anomaly= 500 
last prior auc 0.7228388846142073 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7905116318834247 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7077666213867067 iter_best_vanilla_star_anomaly= 500 
last prior auc 0.7194937088298032 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7848257249279373 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7077666741605528 at iter 50
max_prior_anomaly= 0.7228388846142073 at iter 110
max_prior_star_anomaly= 0.8255174211743448 at iter 9
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7077666213867067
accuracies_anomaly['prior'][-1]= 0.717708158519968
accuracies_anomaly['prior_star'][-1]= 0.7857116394828585



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.0987651348114 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7077666213867067
 first_prior_anomaly_auc= 0.7179639005782958
 first_prior_star_anomaly_auc= 0.7841852615313494


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7064647961504646; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7066122462765413; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7892757211809942 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.706973324931737; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.701519992316128; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7901311852267006 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7073418974730827; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7011306268794085; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7934724029726452 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7078893733527963; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.6949921314195425; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7917321326227863 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7079835218942856 at iter 460
0.7179639005782958 at iter 0
0.7948812535688314 at iter 490
last anomaly aucs:
0.7079801443681335
0.6953039193024564
0.7948812535688314




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.53640007972717 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7079655787866026,first_prior_anomaly_auc= 0.6930183895744211, first_prior_star_anomaly_auc= 0.7912439217722724


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7079655787866026 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6866053117931603 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8328250156474454 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7079655787866026 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.690400542937329 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8234010316231442 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7079655787866025 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6983882867393045 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8091778995798147 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7079655787866026 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7018465568759571 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7986694130176191 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7079655787866026 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7067125165841811 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7955341188192591 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7079655787866026 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7092297762705567 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7944709369151999 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7079655787866026 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7113068493063933 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7970564859584628 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7079655787866026 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7064918163596812 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7904087228834785 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7079655787866026 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7030997773999171 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7884326062152814 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7079655787866026 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6979362787472333 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7847392285941364 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7079655787866026 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6963931187126559 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.783009671335041 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7079655787866026 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6950321339949063 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7813790650374325 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7079655787866026 at iter 0
max_prior_anomaly= 0.7116618061954385 at iter 68
max_prior_star_anomaly= 0.8338092478776997 at iter 9
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7079655787866026
accuracies_anomaly['prior'][-1]= 0.6923538085301535
accuracies_anomaly['prior_star'][-1]= 0.7791615080232078



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.71963000297546 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7079655787866026
 first_prior_anomaly_auc= 0.6944891966659594
 first_prior_star_anomaly_auc= 0.7807632998008314


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7079706978496769; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6469882493754215; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.771303693430395 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7076535798083042; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.63270152484751; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7685424074795317 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7077982856943825; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6320080765094112; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7661614626377002 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7078819850143387; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 330 
last prior auc 0.6346014360819008; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7718549690270298 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7082495020787618 at iter 330
0.6944891966659594 at iter 0
0.7807632998008314 at iter 0
last anomaly aucs:
0.7081751965034161
0.6349453632371055
0.7735903314091989




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.4781539440155 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.70807228750347,first_prior_anomaly_auc= 0.6313407512251448, first_prior_star_anomaly_auc= 0.7683397031365607


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7080722875034698 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6839971227699092 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8249408141315694 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7080722875034698 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.670032002060291 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8044050857100036 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.70807228750347 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6725791845174202 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8040620029363368 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7080722875034698 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6701339083571608 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8013547574039068 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.70807228750347 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6688908731855032 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7996679469601737 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.70807228750347 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6689959986869868 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7991896048188855 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7080722875034698 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6628201921179095 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7934675477788016 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7080722875034698 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6527043957447393 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7857075758967067 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.70807228750347 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6415456298505762 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.778859747171058 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.70807228750347 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6446428741058792 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7814640309296957 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7080722875034698 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6394719343408917 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7745065909256427 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.70807228750347 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6357739653951336 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7714121964580305 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.708072340277316 at iter 6
max_prior_anomaly= 0.691037259390842 at iter 12
max_prior_star_anomaly= 0.8256545276265808 at iter 11
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7080722875034698
accuracies_anomaly['prior'][-1]= 0.6332209778149306
accuracies_anomaly['prior_star'][-1]= 0.769641581146649



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.93396139144897 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7080723402773159
 first_prior_anomaly_auc= 0.6349881100524677
 first_prior_star_anomaly_auc= 0.7695652701651504


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6986248191176423; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5601340561239299; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6888111002396988 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6982995211301203; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5591817520705819; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6870297718375536 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6992165194804099; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5380027104647371; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6742201344888695 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6979136387672451; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5291455175478316; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6685452044933763 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7080723402773159 at iter 0
0.6349881100524677 at iter 0
0.7695652701651504 at iter 0
last anomaly aucs:
0.6987979173329364
0.5543723659254052
0.6836421658808641




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.528074502944946 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.698560223929984,first_prior_anomaly_auc= 0.5516730892437403, first_prior_star_anomaly_auc= 0.6816333822019148


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6985602239299838 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6562267861044352 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7972719087983501 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6985602239299838 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6441697565753574 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.781646839532677 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.698560223929984 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6269520254074404 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.762524447484218 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6985602239299838 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6303119778687599 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7619468905122123 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6985602239299838 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6193563385083367 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7502564808921736 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6985602239299838 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5987896846129408 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7327796301397768 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.698560223929984 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6001321984845462 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7344840670481161 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.698560223929984 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.594537062544396 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7257749575434408 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6985602239299838 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5931728058481865 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7240481445243441 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.698560223929984 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5916356092582213 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7241245610535348 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.698560223929984 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5921159568056624 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7233923239385331 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.698560223929984 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5894640182639727 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7205790029753895 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.698560223929984 at iter 0
max_prior_anomaly= 0.6735909119215063 at iter 8
max_prior_star_anomaly= 0.8136001367898091 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.698560223929984
accuracies_anomaly['prior'][-1]= 0.5885693432505945
accuracies_anomaly['prior_star'][-1]= 0.720287005284773



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.0957932472229 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6985602239299838
 first_prior_anomaly_auc= 0.5901294964636246
 first_prior_star_anomaly_auc= 0.722766848314245


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7038667397056697; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5903832331157995; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 70 
last prior star auc 0.7136092138913429 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7056670666924203; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6071098508716657; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 170 
last prior star auc 0.7218102168055147 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7052431343864881; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6089714482937688; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 170 
last prior star auc 0.7269093841397705 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7055359236847966; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 350 
last prior auc 0.6180710842597782; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 310 
last prior star auc 0.7269098591043857 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7070440418855461 at iter 410
0.621606773628698 at iter 310
0.7340998206744709 at iter 170
last anomaly aucs:
0.7056837432277961
0.6062957087474761
0.724024237972049




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.49523448944092 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7060427109291469,first_prior_anomaly_auc= 0.6103683192268843, first_prior_star_anomaly_auc= 0.7247561056701276


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7060427109291469 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.68320736216263 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.801013363393316 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7060427109291469 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6879878282401294 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8035947433027351 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7060427109291469 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6942727711229958 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8011122615809566 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7060427109291469 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6830987008134561 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7917038986151087 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7060427109291469 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6690450783638842 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7759442560418137 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7060427109291469 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6712549831704204 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7774156964195057 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7060427109291469 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.677645315424001 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7866577162223637 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7060427109291469 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6755352587343355 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7832571806733732 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7060427109291469 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6846647119234062 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7911042821754224 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7060427109291469 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6659897365424055 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7740800199274044 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7060427109291469 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6635517431729113 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7711228902335665 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7060427109291469 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6642097274864134 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7711695950873882 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7060427109291469 at iter 0
max_prior_anomaly= 0.7014112781931079 at iter 35
max_prior_star_anomaly= 0.8241745378858163 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7060427109291469
accuracies_anomaly['prior'][-1]= 0.6633186938684179
accuracies_anomaly['prior_star'][-1]= 0.7695720779913009



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.27302646636963 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7060427109291469
 first_prior_anomaly_auc= 0.681801941866442
 first_prior_star_anomaly_auc= 0.7897861498207273


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7047832103174981; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6374523320234865; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7459451215328903 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7046960279236973; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6138009940481656; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7314588590927753 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7044537959699781; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6216708938517413; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7358838933166145 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7039064256379566; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.6354418595814613; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7464062594003413 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7061010788029625 at iter 360
0.681801941866442 at iter 0
0.7897861498207273 at iter 0
last anomaly aucs:
0.7058379484061772
0.623062804043321
0.7449624725180196




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.445451736450195 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7042174746870247,first_prior_anomaly_auc= 0.6285173504573909, first_prior_star_anomaly_auc= 0.743807147478624


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7042174746870247 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6801003547457937 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8005356017643352 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7042174746870247 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6823774934322948 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7959346195375112 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7042174746870247 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.679493033324573 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7922166493040713 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7042174746870247 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6599205331425031 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7755534657112491 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7042174746870247 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6565030571889061 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.770664074415345 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7042174746870247 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.664837472386085 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7772765845611168 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7042174746870247 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6572995200746433 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7705337230154132 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7042174746870247 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6585137407263159 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7708480968167872 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7042174746870247 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6520580744512312 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7677601935322486 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7042174746870247 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6507551937380665 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7658304123009503 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7042174746870247 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6626171711318618 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7749821360530863 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7042174746870247 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6524556198341 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7643634577001791 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7042174746870247 at iter 0
max_prior_anomaly= 0.6972908546091094 at iter 12
max_prior_star_anomaly= 0.821283164404252 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7042174746870247
accuracies_anomaly['prior'][-1]= 0.6495410786340863
accuracies_anomaly['prior_star'][-1]= 0.7631542505638885



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.62811636924744 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7042174746870247
 first_prior_anomaly_auc= 0.6748469294593109
 first_prior_star_anomaly_auc= 0.7866071588777747


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7057882354431262; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6263864480985055; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7395631803208439 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7065570448334931; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6289959036940636; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7449698608564773 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7062955504259377; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.620979292598257; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7439486341600885 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.706939444122524; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6162031012022938; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7366911220669616 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7076932657405912 at iter 170
0.6748469294593109 at iter 0
0.7866071588777747 at iter 0
last anomaly aucs:
0.7058792175538479
0.6027488840970237
0.733297605439506




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.50674867630005 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7088690670322839,first_prior_anomaly_auc= 0.6222529366006677, first_prior_star_anomaly_auc= 0.7488098969960071


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7088690670322838 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6636216157451825 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7963224545326929 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7088690670322838 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6573171993130956 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7917820566812217 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7088690142584376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.658544666200146 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.792181026957936 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7088690670322838 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6361990587256805 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7725894226435686 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7088690142584376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6310501784283737 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.768043008573639 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7088690670322838 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6299775500058579 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.764337070777116 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7088690142584376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.646949566146211 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7822268768754506 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7088690670322838 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6533780538905407 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7847133694095345 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7088690142584376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6306115222193724 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7641000106603169 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7088690670322838 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6307227167131604 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7638651670450551 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7088690142584376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6300183969627596 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7651967039566665 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7088690142584377 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6282607640175252 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7626307340103162 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7088690670322839 at iter 0
max_prior_anomaly= 0.6901918223758996 at iter 2
max_prior_star_anomaly= 0.824108359482774 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7088690142584376
accuracies_anomaly['prior'][-1]= 0.6343301257389659
accuracies_anomaly['prior_star'][-1]= 0.7694835234775009



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.40486431121826 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7088690670322839
 first_prior_anomaly_auc= 0.6352221620600376
 first_prior_star_anomaly_auc= 0.7714339392826345


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7049738294497059; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5819224773309943; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7032150882537029 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7040356687871198; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5808393469130994; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.701930097874375 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7049269662743458; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5681335684935918; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6924047880655113 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7023311263310884; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5740968020104724; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6954084642916325 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7088690670322839 at iter 0
0.6352221620600376 at iter 0
0.7714339392826345 at iter 0
last anomaly aucs:
0.7066774747503533
0.5789269282771767
0.7018781156359407




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.53724145889282 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7075513568683578,first_prior_anomaly_auc= 0.5820547813632329, first_prior_star_anomaly_auc= 0.7057160408216254


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7075513568683578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6309129664284454 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7658946380716859 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7075513568683578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6174070309539716 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7517600605421563 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7075513568683578 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5920055539195663 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7279033795315583 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7075513568683578 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.5940565566754166 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7298395463982378 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7075513568683578 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.5949047907042035 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7304994833440464 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7075513568683578 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.6212792591396386 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7561060395444984 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7075513568683578 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.6127124806979658 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7468810656939391 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7075513568683578 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.5941328676569151 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7296482939798763 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7075513568683578 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.5941632126184377 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7296120383475875 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7075513568683578 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.6146618410261768 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7499652220354027 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7075513568683578 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.6168835144003993 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7519944819666491 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7075513568683578 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.5932867973558191 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7279546757099931 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.707551409642204 at iter 35
max_prior_anomaly= 0.6777719198808577 at iter 2
max_prior_star_anomaly= 0.8150332633552134 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7075513568683578
accuracies_anomaly['prior'][-1]= 0.5931073662789901
accuracies_anomaly['prior_star'][-1]= 0.7284036228189888



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.64166331291199 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7075513568683578
 first_prior_anomaly_auc= 0.5923368153517008
 first_prior_star_anomaly_auc= 0.7272942637995692


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7102665712515529; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5883553453045526; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.7089610518460819 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7075596423621995; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5658099360486533; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.6919925187795731 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.711671252713895; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5772716765934272; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.7093130006258979 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.712036606050627; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.5941171938246157; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.7169837847080394 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.712470565387323 at iter 380
0.6067458696549328 at iter 10
0.7272942637995692 at iter 0
last anomaly aucs:
0.7110699475111326
0.5805289311501849
0.707567769534503




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.48577666282654 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7116308279477623,first_prior_anomaly_auc= 0.5856266735905953, first_prior_star_anomaly_auc= 0.709320652833586


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7116308279477623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6439476314570121 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7757040822680932 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7116308279477623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6422426140363654 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7737394702983517 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7116308279477623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6357098979459364 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7679649032813722 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7116308279477623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6101090413208661 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7447634623442776 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7116308279477623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6107670784082141 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7442559362660814 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7116308279477623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6087744435261795 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7423206665547861 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7116308279477623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6087117481969816 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7444745783105824 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7116308279477623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6081881788695631 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7417330825520164 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7116308279477623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6100246031670641 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7441075362107745 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7116308279477623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.607743770311334 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7414887924182981 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7116308279477623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6074945194360798 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7414671023675403 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7116308279477623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6084119927509845 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7438115804816985 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7116308279477623 at iter 0
max_prior_anomaly= 0.6649510944767949 at iter 2
max_prior_star_anomaly= 0.8003151654090659 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7116308279477623
accuracies_anomaly['prior'][-1]= 0.6066558374734417
accuracies_anomaly['prior_star'][-1]= 0.7412623398445706



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.67392754554749 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7116308279477623
 first_prior_anomaly_auc= 0.6059304081845902
 first_prior_star_anomaly_auc= 0.7403842358188759


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7133619684222414; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6002337353644931; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7372715816005041 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7121332349628842; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5926743040976781; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7233445108339429 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7129112270024771; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.6078116902512984; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 300 
last prior star auc 0.7377445408094875 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7129504907439952; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5863927915148099; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 300 
last prior star auc 0.718326879091952 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7143372818725005 at iter 220
0.6078116902512984 at iter 300
0.7403842358188759 at iter 0
last anomaly aucs:
0.7127053034548927
0.5904990717080466
0.7214377917734018




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.98027420043945 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7127331680456472,first_prior_anomaly_auc= 0.5941348730630679, first_prior_star_anomaly_auc= 0.7252551351590972


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7127331680456475 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6468537288416457 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7819504474694412 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7127331680456472 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6409731919416448 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7761146627909554 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7127331680456472 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6366622547731305 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7714066024303412 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7127331680456472 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6355709971829322 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7696678625220199 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7127331680456472 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6332971304748908 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7690127807700549 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7127331680456475 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6106723493544175 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7464020374926512 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7127331680456475 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6094477322550581 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7461868257481483 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7127331680456475 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6151101020751732 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7522191930034545 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7127331680456472 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6098053278364095 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.745472215097753 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7127331680456475 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6101352699223909 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7469460830723667 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7127331680456475 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6146466421584925 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7569009192148519 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7127331680456475 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.609113673809079 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7448850005119063 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7127331680456475 at iter 1
max_prior_anomaly= 0.6594717971288917 at iter 1
max_prior_star_anomaly= 0.801262086530109 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7127331680456475
accuracies_anomaly['prior'][-1]= 0.6095185547565596
accuracies_anomaly['prior_star'][-1]= 0.7448871114657514



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.36554265022278 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7127331680456472
 first_prior_anomaly_auc= 0.6279690301961394
 first_prior_star_anomaly_auc= 0.7648670785137619


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7150792821490354; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5980026154718141; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7322854030708045 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7156042763702993; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6092745284920718; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7374078964450481 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7140272883003549; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5872900524466482; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7220649561607659 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7145883798323691; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5993424906511131; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7307285218362343 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7175481482185133 at iter 60
0.6279690301961394 at iter 0
0.7648670785137619 at iter 0
last anomaly aucs:
0.7151871518905175
0.6063064746120859
0.7366616742608232




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.84794092178345 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7146426313461869,first_prior_anomaly_auc= 0.5972366558691378, first_prior_star_anomaly_auc= 0.7278054840469941


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.714642631346187 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6374173429635048 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7744865896379608 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.714642631346187 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6364418711917073 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7730215348956504 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.714642631346187 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6274886826486982 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7645752391446837 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.714642631346187 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6237360927721995 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7608774812943102 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.714642631346187 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6203043151063024 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.757450717143795 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7146426313461869 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5996910619047771 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7387123075997504 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.714642631346187 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6002644497429386 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7391886443348858 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7146426313461869 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6001510387476132 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7390842576672483 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7146426313461869 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5997873214001113 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7386897731674547 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7146426313461869 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5997289007524494 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7387943181566308 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.714642631346187 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5996017685571313 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7383890150183812 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7146426313461869 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6005737044812384 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7394876081731911 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.714642631346187 at iter 1
max_prior_anomaly= 0.648138877542512 at iter 2
max_prior_star_anomaly= 0.7953409665424369 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.714642631346187
accuracies_anomaly['prior'][-1]= 0.5987371746360451
accuracies_anomaly['prior_star'][-1]= 0.7394090806901552



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.43588280677795 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7146426313461869
 first_prior_anomaly_auc= 0.6001230158353204
 first_prior_star_anomaly_auc= 0.7390828327734028


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7148573153522285; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5915052578582896; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7285731324127463 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7136577658297791; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5934360945665104; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7271366283211901 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7144840987124237; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5879208054555491; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 260 
last prior star auc 0.7265016534045992 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7147750936999637; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5890622509734136; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 310 
last prior star auc 0.7286212621604136 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7159096258439859 at iter 260
0.6018422294205749 at iter 310
0.7390828327734028 at iter 0
last anomaly aucs:
0.7137397763866592
0.5956008249607626
0.7333525430133233




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.1719388961792 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7145155519247149,first_prior_anomaly_auc= 0.5930962837713034, first_prior_star_anomaly_auc= 0.7317502762710845


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.714515551924715 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6416327066966845 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7851150839262475 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.714515551924715 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6396336861792685 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7830433410488695 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.714515551924715 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6305829715686182 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7744847425533464 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.714515551924715 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.62986471952284 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7726790854081371 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7145155519247149 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6251421991283872 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7684863088810995 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.714515551924715 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6246782642470913 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7671115501895109 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.714515551924715 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6047475879713629 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7485895661884301 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.714515551924715 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6054050445464034 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7491264345250723 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.714515551924715 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6038562377102905 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7485828639099721 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.714515551924715 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6023497554987709 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7476557329812262 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.714515551924715 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.602993543647665 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7479396562733853 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.714515551924715 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6046229889206588 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7487543789098823 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.714515551924715 at iter 1
max_prior_anomaly= 0.666403852912958 at iter 2
max_prior_star_anomaly= 0.8116332555446841 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.714515551924715
accuracies_anomaly['prior'][-1]= 0.6050488210850514
accuracies_anomaly['prior_star'][-1]= 0.7485979572299641



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.35855555534363 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7145155519247148
 first_prior_anomaly_auc= 0.6039639491302342
 first_prior_star_anomaly_auc= 0.7487999755129354


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.716725298409713; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5770555676935402; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7080608883527066 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7164570489498533; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5870132536237161; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7161839970699961 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7191228142392281; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5807479953854549; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.707831585991288 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7187583580578802; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5710192951736207; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7052913169080015 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7211663231089283 at iter 180
0.6039639491302342 at iter 0
0.7487999755129354 at iter 0
last anomaly aucs:
0.7174583271324064
0.5926301851623165
0.7153498536581246




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.57624697685242 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7167126326866426,first_prior_anomaly_auc= 0.5812016393667561, first_prior_star_anomaly_auc= 0.7096083230688203


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7167126326866426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6380652474723967 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7746312427501929 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7167126326866426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6336037992947303 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7678622053768105 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7167126326866426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.62913818198322 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7628539146055842 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7167126326866426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6157585870963724 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7511534779547813 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7167126326866426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5985756338930527 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7341071562390824 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7167126326866426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.598219568753239 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7335175140563139 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7167126326866426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5998556635308447 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7346655563049441 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7167126326866426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5996772351570918 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7355650337383199 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7167126326866425 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5974799432997797 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7328631711381948 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7167126326866426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5985681400069028 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7336346719947142 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7167126326866426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6024828511387013 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7414102649352623 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7167126326866426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5969558990077461 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7325675320521954 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7167126326866426 at iter 0
max_prior_anomaly= 0.654452107206902 at iter 2
max_prior_star_anomaly= 0.7947690563719669 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7167126326866426
accuracies_anomaly['prior'][-1]= 0.5973718624629132
accuracies_anomaly['prior_star'][-1]= 0.7324938069891571



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.78985357284546 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7167126326866426
 first_prior_anomaly_auc= 0.5991423722266025
 first_prior_star_anomaly_auc= 0.734280465549761


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.714829556309166; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5903796444942628; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 20 
last prior star auc 0.7227477441819474 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7146478559569533; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5854763209029816; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 20 
last prior star auc 0.7253588885405815 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7152615630135555; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.578284987212897; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 20 
last prior star auc 0.7206708822414952 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7126296257595476; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5785314938481527; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 380 
last prior star auc 0.7177966074860755 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7173298755909352 at iter 480
0.612495580190387 at iter 380
0.7437581733494187 at iter 20
last anomaly aucs:
0.7169481623619041
0.5911957392507592
0.7268043641859793




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.32352066040039 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7166028103128539,first_prior_anomaly_auc= 0.5900645846328894, first_prior_star_anomaly_auc= 0.7304377907179248


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7166028103128539 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6403502494619706 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7866653156562058 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.716602810312854 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6418342500150405 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7867271138300198 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7166028103128539 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6315668343819496 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7782307884729255 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7166028103128539 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.630564922913243 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7737527165337295 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.716602810312854 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6193026147329801 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7670015167203377 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7166028103128539 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6037548063780359 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7498730789000665 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7166028103128539 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.601680899772967 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.749214936265026 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7166028103128539 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6018685107959456 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7493754215310959 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7166028103128539 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6169883760326522 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7647765185938092 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7166028103128539 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6204002579585599 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7661441000423246 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7166028103128539 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6006359776196672 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7497655785755073 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7166028103128539 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6010402252809943 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.750262497110632 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.716602810312854 at iter 6
max_prior_anomaly= 0.6472462079352865 at iter 19
max_prior_star_anomaly= 0.7954808172346715 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.716602810312854
accuracies_anomaly['prior'][-1]= 0.6011276715440255
accuracies_anomaly['prior_star'][-1]= 0.7484784772423344



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.81816148757935 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5033803231659242
accuracies_anomaly["prior"][-1]= 0.6766067261322366
accuracies_anomaly["prior_star"][-1]= 0.5035399640504561


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 2731.228045463562 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.00647282600402832 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5068686743948687
 first_prior_anomaly_auc= 0.6788277134464592
 first_prior_star_anomaly_auc= 0.507043144730162


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5147519787553605; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.686357327490213; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 70 
last prior star auc 0.5157733637732878 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.545524461205418; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6855924761383054; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 70 
last prior star auc 0.5505476869750981 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6315844608465558; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.685514054202962; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 70 
last prior star auc 0.643655000480242 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6927658139468609; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6855410216383324; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 70 
last prior star auc 0.7104268981960844 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7054072082740948 at iter 490
0.6868013666315194 at iter 70
0.7267480017183163 at iter 490
last anomaly aucs:
0.7054072082740948
0.6856102609244499
0.7267480017183163




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.153913259506226 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7057854912031276,first_prior_anomaly_auc= 0.6856155910829088, first_prior_star_anomaly_auc= 0.7274248790687317


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7057854912031276 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6875398838342099 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8141384300202967 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7057854912031276 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6879946360662798 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7985553687361403 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7057854912031276 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6880992338293019 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7928387474022074 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7057854912031276 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.686496914313217 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7869410062283695 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7057854912031276 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6848104732864069 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7813081897620849 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7057854912031276 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6778356706869783 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7729579424110681 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7057854912031276 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6754127706374764 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7667314729497097 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7057854912031276 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6761326586724844 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7650471428767446 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7057854912031276 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6905251419880329 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7816559694080569 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7057854912031276 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6840421388606549 iter_best_prior_anomaly= 910
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.767386290832444 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7057854912031276 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6919931520657265 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7811946732190674 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7057854912031276 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6682860321350503 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7516150380130013 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7057854912031276 at iter 0
max_prior_anomaly= 0.6919931520657265 at iter 110
max_prior_star_anomaly= 0.8251529122191508 at iter 9
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7057854912031276
accuracies_anomaly['prior'][-1]= 0.6653706993273445
accuracies_anomaly['prior_star'][-1]= 0.7483202084778018



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.283607006073 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7057854912031276
 first_prior_anomaly_auc= 0.6701124821756335
 first_prior_star_anomaly_auc= 0.7561788674521526


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7067894608518333; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6748466655900802; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.7707799130075921 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7071239414885813; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6821249178047346; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 200 
last prior star auc 0.7775648353086584 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7068991249040835; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6877680779448597; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 300 
last prior star auc 0.7801242085242427 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7064713401073841; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6931101632928346; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 400 
last prior star auc 0.7814186981958733 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7071246803224271 at iter 190
0.6974212587828873 at iter 490
0.7819518723632868 at iter 490
last anomaly aucs:
0.7059351050568954
0.6974212587828873
0.7819518723632868




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.0355429649353 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7058586357538587,first_prior_anomaly_auc= 0.697802391499611, first_prior_star_anomaly_auc= 0.781981320169425


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7058585829800124 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6916924466904993 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7759332263079733 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7058585829800125 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7037043545811392 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7748892540839041 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7058586357538585 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7042215382731765 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7799400805751083 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7058585829800125 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7138749829804346 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7799352781551108 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7058585829800125 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.701539201996118 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7826694911229114 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7058585829800124 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7014327043746352 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7613737137694352 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7058585829800125 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7012133762701346 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7635521125898341 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7058585829800125 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.700201068353741 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7629379833424632 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7058585829800124 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7073136634654051 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7682776410935164 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7058585829800125 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.703368976789007 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7631034821239151 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7058585829800125 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7083053895818094 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7651612399320695 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7058586357538585 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7009898790317899 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7613863267186594 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7058586357538587 at iter 0
max_prior_anomaly= 0.7171944051279291 at iter 98
max_prior_star_anomaly= 0.8109780154711808 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7058586357538585
accuracies_anomaly['prior'][-1]= 0.7077659881005531
accuracies_anomaly['prior_star'][-1]= 0.7640257578588173



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.57399845123291 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7058585829800125
 first_prior_anomaly_auc= 0.7068785431040943
 first_prior_star_anomaly_auc= 0.7629709669962921


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7048900245820575; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.709417545615074; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.7701041439079457 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.704736769332907; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7144130123416917; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 200 
last prior star auc 0.7748265587547061 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.703939567613324; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.717535060304674; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 290 
last prior star auc 0.7756938441419448 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7034366328597409; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7245306557994763; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 390 
last prior star auc 0.7792956063662145 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7058585829800125 at iter 0
0.7287508747264996 at iter 490
0.7811630616852379 at iter 490
last anomaly aucs:
0.7025998507555631
0.7287508747264996
0.7811630616852379




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.15105867385864 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7023146081172509,first_prior_anomaly_auc= 0.7282397072529208, first_prior_star_anomaly_auc= 0.780565767294781


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.702314660891097 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6975397888412869 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8213454375426809 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7023145553434047 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7114365674201717 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8164614291790817 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7023146081172509 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7519039220466964 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8216352715056061 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7023145553434047 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7693161776114346 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8222708797083507 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7023145553434047 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7767629367167702 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8230540435848641 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7023146081172509 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7809038893269119 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8236955624583747 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7023146081172509 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7848471511094646 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8245283865240928 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7023145553434047 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7884641649752648 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8251908566145156 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7023146081172509 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7923015624224885 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8259798256141029 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7023145553434048 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7946414492120337 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8264838158446084 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7023145553434047 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.796127719040487 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8267178150783322 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.702314660891097 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7962377525096602 iter_best_prior_anomaly= 1150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8265251377661252 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.702314660891097 at iter 10
max_prior_anomaly= 0.7964844702403006 at iter 115
max_prior_star_anomaly= 0.8267178150783322 at iter 110
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7023145553434047
accuracies_anomaly['prior'][-1]= 0.7959778940913347
accuracies_anomaly['prior_star'][-1]= 0.8260781960632823



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.38526248931885 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7023146081172509
 first_prior_anomaly_auc= 0.7955991889715327
 first_prior_star_anomaly_auc= 0.8260778794202055


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7057792638892847; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7215365844133501; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8097790992348848 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7072796243346537; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.691893356722702; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8025584232863541 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7076296732560091; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.6817770326110705; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8018621779344105 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7073446417130813; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.670772366347596; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7985971656222723 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7079751836265976 at iter 280
0.7955991889715327 at iter 0
0.8260778794202055 at iter 0
last anomaly aucs:
0.707071167642455
0.6646883862707784
0.7957426810591499




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.11266350746155 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7072930288915699,first_prior_anomaly_auc= 0.6606387324144352, first_prior_star_anomaly_auc= 0.7963963906911158


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7072930288915698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6612861619587119 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.747317874818326 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7072930288915699 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6789190122002576 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8203001987463044 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7072930288915699 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6847382786649061 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8309765589130277 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7072930288915698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6891372953826052 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.832978693087365 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7072930288915699 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6930486289882516 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8334706508809538 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7072930288915698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6963182326250027 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8334255292425159 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7072930288915698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6964950777833718 iter_best_prior_anomaly= 640
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8322476697708243 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7072930288915698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6963151189680812 iter_best_prior_anomaly= 640
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.830906475245372 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7072930288915699 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6981130183579101 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8300390843104412 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7072930288915698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7009297168472061 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8296802749306288 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7072930288915698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7038577681518283 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8296238596891199 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7072930288915698 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7050390051496719 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.828947932267935 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7072930288915699 at iter 0
max_prior_anomaly= 0.7050390051496719 at iter 120
max_prior_star_anomaly= 0.8340354365821968 at iter 56
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7072930288915698
accuracies_anomaly['prior'][-1]= 0.7035158991766225
accuracies_anomaly['prior_star'][-1]= 0.8270141929981771



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.05184769630432 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7072930288915699
 first_prior_anomaly_auc= 0.7033521947059389
 first_prior_star_anomaly_auc= 0.8267657337306148


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.710881544880462; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6988581850652126; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8249674121500171 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7122462765412866; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6948917555642105; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8253814757467235 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.713203383014632; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6913364343245317; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8257717911126732 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7139359895465567; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.688358828378397; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8256172692912155 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7144560230262844 at iter 490
0.7033521947059389 at iter 0
0.8267657337306148 at iter 0
last anomaly aucs:
0.7144560230262844
0.6861527760626278
0.825424750300547




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.138376235961914 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7144928591708807,first_prior_anomaly_auc= 0.6859362977458179, first_prior_star_anomaly_auc= 0.8252485384283316


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7144928591708806 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6905520038757113 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8251979283098965 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7144928591708806 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6931226179205205 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8254285500174683 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7144928591708806 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6952347327901849 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8257060349003998 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7144928591708806 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6970818701784496 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8258209763372629 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7144928591708806 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6988316398206111 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8259397174910469 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7144928591708807 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7007827944595906 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8261411552617108 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7144928591708806 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7025121406233013 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8262093918447521 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7144928591708806 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.703965532345618 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8261607343586237 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7144928591708806 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7053759133833418 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8259821476633324 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7144928591708806 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7070343842717051 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8259369732510483 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7144928591708806 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7093128423043594 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8256433395712021 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7144928591708806 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7116918345138843 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8254170980928587 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7144928591708808 at iter 17
max_prior_anomaly= 0.7137285355574343 at iter 129
max_prior_star_anomaly= 0.8322587522785108 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7144928591708806
accuracies_anomaly['prior'][-1]= 0.7137285355574343
accuracies_anomaly['prior_star'][-1]= 0.8252771418529319



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.05695128440857 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7144928591708807
 first_prior_anomaly_auc= 0.71399847378037
 first_prior_star_anomaly_auc= 0.825333134903672


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7086062532785752; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6830555318073248; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.809881163853293 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7112400376171975; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6953561126362753; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8204424770354608 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.712253559332052; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6920127839364857; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8218747592193272 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7128511703655855; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6919176854657662; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8232842958755129 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7144928591708807 at iter 0
0.71399847378037 at iter 0
0.8267834657429134 at iter 480
last anomaly aucs:
0.7133163190453422
0.6870088206206415
0.8213433265888358




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.88520050048828 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7133149469253429,first_prior_anomaly_auc= 0.6837781113084852, first_prior_star_anomaly_auc= 0.81998978298339


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7133149469253429 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6960768450528214 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8216541645425195 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7133149469253429 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6916184049843842 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8230121411510397 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7133149469253429 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.688373552281466 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8282420820759965 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7133149469253429 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.68853071279523 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8264600676138516 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7133149469253429 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6899667419221713 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8244375099610635 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7133149469253429 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6930370715159498 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8238880814490432 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7133149469253429 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6948271603765519 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8238911951059646 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7133149469253429 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.695777353476055 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8239667144797713 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7133149469253429 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6968044908432101 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8241561725873645 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7133149469253429 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6976659183335286 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.824292645753447 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7133149469253429 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6984360470700489 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8244032597349275 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7133149469253429 iter_best_vanilla_star_anomaly= 1110 
last prior auc 0.6991079109050821 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8244419429641381 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.713314946925343 at iter 111
max_prior_anomaly= 0.7028593925308121 at iter 4
max_prior_star_anomaly= 0.8282420820759965 at iter 30
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7133149469253429
accuracies_anomaly['prior'][-1]= 0.6997187154001472
accuracies_anomaly['prior_star'][-1]= 0.8245273838210165



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.82494401931763 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.713314946925343
 first_prior_anomaly_auc= 0.6997820967893449
 first_prior_star_anomaly_auc= 0.8245321334671678


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7153342853735174; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6856288373182864; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8236089078030353 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7157069215010149; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6857983996858901; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8246752561378621 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7158363229717164; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.6866848419792725; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8258407137557141 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7159364349578179; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.6868307088899654; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8272095090026905 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7160106349854714 at iter 440
0.6997820967893449 at iter 0
0.8288767931233567 at iter 450
last anomaly aucs:
0.7159810816316406
0.6881677870554199
0.8276560285147646




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.81684422492981 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7159680992654935,first_prior_anomaly_auc= 0.6878156799540657, first_prior_star_anomaly_auc= 0.826070174438671


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7159681520393397 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7059417545615074 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8162816286853296 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7159680992654935 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7001280821245484 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8259971354356324 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7159682048131859 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6998642128939172 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8290076722617498 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7159680992654935 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6996036156417459 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.829873057790528 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7159681520393396 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6985582712976772 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8301966670149741 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.715968257587032 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6974498622074878 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8302931376056929 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7159680992654935 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6965883819433231 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8304586363871447 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7159681520393396 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6954025008470202 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8305378499301801 iter_best_prior_star_anomaly= 750
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7159682048131858 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6942074898753376 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8302111270488127 iter_best_prior_star_anomaly= 750
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7159680992654935 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6925252179823713 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8291790289401217 iter_best_prior_star_anomaly= 750
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7159680992654935 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6903805944234931 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8274708978625537 iter_best_prior_star_anomaly= 750
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7159681520393397 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6881309509108239 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8256798590727213 iter_best_prior_star_anomaly= 750
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.715968257587032 at iter 18
max_prior_anomaly= 0.707699915245203 at iter 7
max_prior_star_anomaly= 0.8305669810932419 at iter 75
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7159681520393397
accuracies_anomaly['prior'][-1]= 0.6863215468225394
accuracies_anomaly['prior_star'][-1]= 0.8243544967011069



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.4681715965271 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7159680992654935
 first_prior_anomaly_auc= 0.6861277084857178
 first_prior_star_anomaly_auc= 0.8242290004950186


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7187095950240596; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6825163941952992; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.824615832787124 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7189658120470024; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6823876787845973; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8254360439036181 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7190422813500394; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.6810090676022414; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8238336716136871 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7190639186269512; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.6815177547050522; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8242398191334745 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7190642352700279 at iter 380
0.6861277084857178 at iter 0
0.8259364455125872 at iter 210
last anomaly aucs:
0.7190303016869688
0.6819382567109862
0.8252216237668071




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.105939865112305 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7190522028331112,first_prior_anomaly_auc= 0.6809337065499731, first_prior_star_anomaly_auc= 0.824835688630086


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7190522028331111 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6784776645251039 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8240525775274187 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7190522028331112 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.679496041433802 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8237497084245 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7190522028331112 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.680244796762641 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8230999568309938 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7190522028331112 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6810927669221976 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8232277750863116 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7190522028331112 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6826456901183084 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8238430653582974 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7190522028331112 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6844810061650407 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8244807317410409 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7190522028331112 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6857734376566724 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8248833434131378 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7190522028331112 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6866768731285074 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8251169732299388 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7190522028331112 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.687286199955881 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8252270066991121 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7190522028331111 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6877578398187113 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8252273761160349 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7190522028331112 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6882145446830878 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8251877957314402 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7190522028331112 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6885693432505946 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8251257864622419 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7190522028331112 at iter 0
max_prior_anomaly= 0.7265779643860977 at iter 1
max_prior_star_anomaly= 0.8261780969539992 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7190522028331112
accuracies_anomaly['prior'][-1]= 0.6890134879395929
accuracies_anomaly['prior_star'][-1]= 0.8251915954483613



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.9264760017395 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7190522028331112
 first_prior_anomaly_auc= 0.6890404026011174
 first_prior_star_anomaly_auc= 0.8251796685591368


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 4


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 5 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7190522028331112 at iter 0
0.6890404026011174 at iter 0
0.8251796685591368 at iter 0
last anomaly aucs:
0.7190522028331112
0.6890404026011174
0.8251796685591368




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 0.6707773208618164 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 8:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 8 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5068686743948687
accuracies_anomaly["prior"][-1]= 0.6788277134464592
accuracies_anomaly["prior_star"][-1]= 0.507043144730162


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 1465.8628780841827 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.00569605827331543 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49939135923262606
 first_prior_anomaly_auc= 0.6839011271438055
 first_prior_star_anomaly_auc= 0.49957369287099224


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5092709926443814; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6919067085057719; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 70 
last prior star auc 0.5103186062638333 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5386975309228351; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.690494585931126; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 70 
last prior star auc 0.5434101298342162 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6215272434425858; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6902219034681916; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 70 
last prior star auc 0.6334351340825108 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6835609469316758; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6902143040343494; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 70 
last prior star auc 0.7021541228511808 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6995020259879527 at iter 490
0.6922881578655723 at iter 70
0.7216436625471402 at iter 490
last anomaly aucs:
0.6995020259879527
0.6902504541189458
0.7216436625471402




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.38923263549805 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7002493036491004,first_prior_anomaly_auc= 0.6902510874050996, first_prior_star_anomaly_auc= 0.7226398216666191


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7002493036491004 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6903648150435014 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7212227911242834 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7002493036491004 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6732652445170613 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7187424203563502 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7002493036491003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5596334434195763 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.722810281189607 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7002493036491003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6731806480417208 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.78993528870988 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7002493036491003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6855224980183421 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8155062225641969 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7002493036491004 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6973113836352525 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8175286218954465 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7002493036491004 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7001301930783934 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8116259199800726 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7002493036491004 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7000604260538146 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8090565197337243 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7002493036491004 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6999519758000252 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8076041834883301 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7002493036491004 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7001336233783918 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8065981028857796 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7002493036491003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7001224353230129 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8056005716463013 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7002493036491003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6999313940000358 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8044694170284313 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7002493036491004 at iter 0
max_prior_anomaly= 0.700237060116799 at iter 71
max_prior_star_anomaly= 0.8197639109219697 at iter 56
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7002493036491004
accuracies_anomaly['prior'][-1]= 0.6997539683293594
accuracies_anomaly['prior_star'][-1]= 0.8034888261935597



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.6069974899292 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7002493036491003
 first_prior_anomaly_auc= 0.6997321727309094
 first_prior_star_anomaly_auc= 0.803398266273607


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7085637175585974; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7033377346721004; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.8179426327183069 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7111548078557036; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7046977166867736; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.82114859109663 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7111489499587836; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 240 
last prior auc 0.7052782817680083; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.8211937127350679 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7103173924653723; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 240 
last prior auc 0.7057089691262445; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.8203610997647343 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7113842685386605 at iter 240
0.7059644473153418 at iter 490
0.8213735132288201 at iter 250
last anomaly aucs:
0.7092927354689854
0.7059644473153418
0.8195229983144033




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.39109683036804 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7091783217705837,first_prior_anomaly_auc= 0.7060023389368603, first_prior_star_anomaly_auc= 0.8194335994190656


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7091783217705836 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7248916816808259 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8176009748384857 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7091783217705836 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7288446010772197 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8158359535547934 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7091783217705836 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7305145766640385 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8151599205859164 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7091783217705837 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7318486994941099 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8148340948599329 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7091783217705837 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7329623331950659 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8147188367799932 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7091783217705836 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7339860402622227 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8146914999276998 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7091783217705836 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7347641906233541 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.814549432733928 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7091783217705836 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7354297743706983 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8144284750786067 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7091783217705836 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7359207294612107 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8142687814202287 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7091783217705836 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7362842884871743 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8140414844649629 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7091783217705837 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7365835689685564 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8137917058512474 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7091783217705836 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7367978307838289 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8135500016359891 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7091783217705837 at iter 0
max_prior_anomaly= 0.7369716150591225 at iter 129
max_prior_star_anomaly= 0.8268438917967278 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7091783217705836
accuracies_anomaly['prior'][-1]= 0.7369716150591225
accuracies_anomaly['prior_star'][-1]= 0.813324129574569



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.78537273406982 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7091783217705836
 first_prior_anomaly_auc= 0.7369872361175759
 first_prior_star_anomaly_auc= 0.8132983759376593


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7058559442877061; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7279176284700122; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8077828757313137 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7058733068830817; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7158531578286306; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8075206952637585 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7061015009937316; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7082404249772281; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8084677747063398 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.706257183839804; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7044531626838245; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8095351785180893 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7091783217705836 at iter 0
0.7369872361175759 at iter 0
0.8132983759376593 at iter 0
last anomaly aucs:
0.7062924367690162
0.7025707723663476
0.8103247808038301




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.66661763191223 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7063003528459352,first_prior_anomaly_auc= 0.702418783689504, first_prior_star_anomaly_auc= 0.8103868956207205


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7063003528459352 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7105868029498469 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.816528451963662 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7063003528459352 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7320159398124839 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8152436199058726 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7063003528459352 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7305439189224847 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8134018126760667 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7063003528459352 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7297311489182945 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8119020855168511 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7063003528459352 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7295187341876364 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8117128385046425 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7063003528459352 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7296002170060553 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8111717482603102 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7063003528459352 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7295649640768429 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8103959199484083 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7063003528459353 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7297780648675007 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8105643740652433 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7063003528459352 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7299853605350847 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8100066600593812 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7063003528459352 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7295714024860703 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8101160074685547 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7063003528459352 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7296330423383458 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8093213388935857 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7063003528459352 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.729961665078174 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8093096230997456 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7063003528459353 at iter 17
max_prior_anomaly= 0.7332769180918244 at iter 16
max_prior_star_anomaly= 0.827722629108576 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7063003528459352
accuracies_anomaly['prior'][-1]= 0.7303846474548759
accuracies_anomaly['prior_star'][-1]= 0.8093673576874079



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.93219089508057 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7063003528459352
 first_prior_anomaly_auc= 0.7302551932103281
 first_prior_star_anomaly_auc= 0.8093241359074305


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7033498726567093; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6571339157454992; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7854591166291445 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7040612641024911; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6488178658467723; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7831231351042125 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7044932708068805; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6524625859817887; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7865822496224031 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7046417236360336; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6509763161533355; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7869749925852747 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7063003528459352 at iter 0
0.7302551932103281 at iter 0
0.8093241359074305 at iter 0
last anomaly aucs:
0.7051849248342108
0.6475933542951051
0.786169558145696




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.23900127410889 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7052512087849455,first_prior_anomaly_auc= 0.6631562559700414, first_prior_star_anomaly_auc= 0.7957421005468426


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7052512615587916 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6616601702062086 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8081956727557131 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7052512087849455 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.6694861093959611 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.803754436961113 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7052512615587916 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.6601099384762501 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.795404506253173 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7052512615587916 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.6571026736285925 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.793209008706629 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7052512615587916 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.6564033673935736 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7922374949732911 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7052512087849455 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.655951623270733 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7915754998474835 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7052512615587916 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.6551794891280599 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7917027903643401 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7052512615587916 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.654425350866916 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7913789172706633 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7052512615587916 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.6546984555206192 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7916757701551234 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7052512615587916 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.6543298829792736 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7910665488754421 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7052512087849454 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.6535394363119947 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7905390215095642 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7052512087849454 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.6531604145491161 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7909341920693576 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7052512615587917 at iter 14
max_prior_anomaly= 0.6810508117145273 at iter 17
max_prior_star_anomaly= 0.8210751299028223 at iter 13
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7052512087849454
accuracies_anomaly['prior'][-1]= 0.6547905986559557
accuracies_anomaly['prior_star'][-1]= 0.7919786920318881



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.5914306640625 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7052513143326378
 first_prior_anomaly_auc= 0.6544859352422688
 first_prior_star_anomaly_auc= 0.791511749041363


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6974647972059416; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6026214352586288; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.72786152987158 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6979116333610924; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6018349994036555; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7283703225220832 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6990704942481786; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6164424305944763; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7381849385554109 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7000329308799829; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6239224899967175; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7453752695424191 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7052513143326378 at iter 0
0.6544859352422688 at iter 0
0.791511749041363 at iter 0
last anomaly aucs:
0.6985346286146126
0.6066986370626499
0.7347059810710768




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.42988157272339 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7002247110368056,first_prior_anomaly_auc= 0.6024444317787214, first_prior_star_anomaly_auc= 0.7333819908194618


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7002246582629594 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6536744318103858 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8038113271672371 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7002246582629594 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6224340036667269 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7595821472411417 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7002246582629594 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6138147680220045 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7521492148834912 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7002246582629594 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6108187440035717 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7499288608554218 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7002247110368056 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6110014470588608 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7505745488627764 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7002246582629594 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6109918422188658 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.751292959230093 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7002246582629594 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.609100691442932 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7499979945938472 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7002246582629594 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6087856843554045 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7507578852042189 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7002246582629594 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6092532078582368 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7507381477857678 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7002247110368056 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6090985277152408 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7509269198333612 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7002246582629594 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6095571852119239 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7513196100223867 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7002246054891132 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6106843817913343 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7535527353212186 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7002247110368056 at iter 0
max_prior_anomaly= 0.6560820274445109 at iter 12
max_prior_star_anomaly= 0.8096740792810936 at iter 13
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7002247110368056
accuracies_anomaly['prior'][-1]= 0.6113575649725207
accuracies_anomaly['prior_star'][-1]= 0.7533179444798029



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.72389531135559 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7002247110368056
 first_prior_anomaly_auc= 0.6102963884746142
 first_prior_star_anomaly_auc= 0.7522387193265212


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7016212125529981; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6100390104270565; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7433972002419154 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7033655992628549; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6127355428687229; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 180 
last prior star auc 0.7478011777011502 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7029054113246341; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.6231413843002029; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 250 
last prior star auc 0.7520963882635188 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.70268967184167; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.6204767272615967; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 250 
last prior star auc 0.7467215303570995 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7052658799141686 at iter 270
0.632908451098171 at iter 250
0.7608751592450806 at iter 480
last anomaly aucs:
0.7022839465126516
0.6159886282916367
0.740470837700369




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.507853269577026 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7032455915367638,first_prior_anomaly_auc= 0.6159649856085722, first_prior_star_anomaly_auc= 0.7473256853475527


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7032456443106099 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6782306829252331 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8185725941195159 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7032456443106099 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6344498695958263 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7694964530698019 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.70324564431061 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6242720639534577 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7587388739538903 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.70324564431061 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6214593235026213 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7568534227533381 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.70324564431061 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6199337371588038 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7564195689643344 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.70324564431061 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6179137126506298 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7539495418702419 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.70324564431061 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6183137911781127 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7542755786916097 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7032456443106099 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6183302566181041 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7550304557865994 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7032456443106099 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.617236571430984 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7525830158986488 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.70324564431061 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6167261955650971 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7518802793636319 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7032456443106099 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6179963037198173 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7531995199690956 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.70324564431061 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6194211975652257 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7551412808634645 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7032456970844561 at iter 7
max_prior_anomaly= 0.6786382025650199 at iter 11
max_prior_star_anomaly= 0.8227497495881002 at iter 12
last values
accuracies_anomaly['vanilla_star'][-1]= 0.70324564431061
accuracies_anomaly['prior'][-1]= 0.6167846162127588
accuracies_anomaly['prior_star'][-1]= 0.7522678504895829



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.08992409706116 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7032456970844561
 first_prior_anomaly_auc= 0.617837665538362
 first_prior_star_anomaly_auc= 0.7530559751076322


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.698881300009816; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5879570083139917; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7061190746844916 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6983912420746876; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6077248772744208; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7235979836168873 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7023486472480023; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6183052418150403; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 240 
last prior star auc 0.7326517063367668 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7047382470005985; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6273818156102926; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 240 
last prior star auc 0.74792065768878 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7080868530850007 at iter 10
0.6359911825457893 at iter 240
0.7530559751076322 at iter 0
last anomaly aucs:
0.703465552927418
0.6221426392622639
0.7453222318270623




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.20828366279602 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7046038320145148,first_prior_anomaly_auc= 0.6216434514517558, first_prior_star_anomaly_auc= 0.7399021467345128


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7046038320145148 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6716274609763795 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8112964528587064 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7046038320145148 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6393020553302112 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.765221613212038 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7046038320145149 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6378119857848368 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7611517997464745 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7046038320145149 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6369771563129658 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7598527187502309 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7046038320145149 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6361447016641705 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7590179948260521 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7046038320145149 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6370722547836853 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7601599153085317 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7046038320145148 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6345782155896053 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7577641410159388 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7046038320145148 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6344503973342874 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7579682702527551 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7046038320145149 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6346704114987878 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7574944666622336 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7046038320145148 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6347806032894994 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7575415937068244 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7046038320145148 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6341661046252054 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7567507248487766 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7046038320145148 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6348980250971303 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7571543392239501 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7046038320145149 at iter 1
max_prior_anomaly= 0.6741271469719949 at iter 1
max_prior_star_anomaly= 0.8112964528587064 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7046038320145148
accuracies_anomaly['prior'][-1]= 0.6352506599369458
accuracies_anomaly['prior_star'][-1]= 0.7574052788622803



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.10362362861633 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7046038320145148
 first_prior_anomaly_auc= 0.6350896997062608
 first_prior_star_anomaly_auc= 0.7573356173853937


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7035269816843089; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5956280034915176; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7175922143800286 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7055802009416965; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.626176777607846; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7419344675488342 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7073366728623163; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6148519851937697; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7366675849315892 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7099423287409533; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.624558995354846; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7462794438481 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7171268018310414 at iter 10
0.6400273262975242 at iter 470
0.7577593913697874 at iter 470
last anomaly aucs:
0.7091127238798487
0.624121658491998
0.7453683033947304




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.30640435218811 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7103617752699647,first_prior_anomaly_auc= 0.6209223496182867, first_prior_star_anomaly_auc= 0.744335202582963


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7103617752699646 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6790913715817061 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8206317240476696 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7103617752699646 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.629901925084359 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7619162289076131 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7103617224961185 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6272910973688016 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7573277540823209 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7103618280438108 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.627353159411846 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7568806012840932 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7103617752699646 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6280115131422709 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7570331704732441 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7103617752699646 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6289762190494587 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7582187349264702 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7103617752699646 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6310671716068263 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.759183440833658 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7103618280438108 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6292343359308621 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7584347382786649 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7103617224961184 iter_best_vanilla_star_anomaly= 810 
last prior auc 0.6302595206657103 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7582632760526007 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7103617224961185 iter_best_vanilla_star_anomaly= 810 
last prior auc 0.6281907331237156 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.757387177433059 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7103618280438108 iter_best_vanilla_star_anomaly= 810 
last prior auc 0.6300836254365716 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7584246584740548 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7103617752699646 iter_best_vanilla_star_anomaly= 810 
last prior auc 0.6292787715093003 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7575421742191317 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7103618280438109 at iter 81
max_prior_anomaly= 0.6832450426887641 at iter 7
max_prior_star_anomaly= 0.8206317240476696 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7103617224961185
accuracies_anomaly['prior'][-1]= 0.6302992593718435
accuracies_anomaly['prior_star'][-1]= 0.7583780591679252



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.79302477836609 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7103617752699646
 first_prior_anomaly_auc= 0.6313192722697715
 first_prior_star_anomaly_auc= 0.7591402718275266


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7078760743435726; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.599413946438768; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7192986566945206 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7108088225205; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6278781008592638; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7389514258965485 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7123284454197052; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.612066317725996; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7379390124324627 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7120595098998459; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6178389321106689; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7429695209929083 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7182605951412175 at iter 10
0.6322648740446615 at iter 480
0.7591402718275266 at iter 0
last anomaly aucs:
0.7127369677625683
0.6239199040782573
0.7435689263372101




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.739912271499634 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7120781390675284,first_prior_anomaly_auc= 0.6091029079444693, first_prior_star_anomaly_auc= 0.7391278488641485


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7120781390675284 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6648620649983799 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8065233223458186 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7120781390675284 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.621405230310342 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7562604030444176 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7120781390675284 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.616555577720571 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7510253430563867 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7120781390675284 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6150950087551811 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7495456171848531 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7120781390675284 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6145509104016195 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7488948628882705 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7120781390675284 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6145290092554772 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7486223387468744 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7120781390675284 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.614598354089287 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7486753764622314 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7120781390675284 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6145028862016446 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7488529604544463 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7120781390675284 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6145367142370115 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7488229849098464 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7120781390675284 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6146195691754297 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7491860161973488 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7120781390675284 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6154761414719048 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7489542334651624 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7120781390675284 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6171084893064356 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7502488286844852 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7120781390675284 at iter 0
max_prior_anomaly= 0.6889848317411464 at iter 1
max_prior_star_anomaly= 0.8217912709947555 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7120781390675284
accuracies_anomaly['prior'][-1]= 0.6154409940903848
accuracies_anomaly['prior_star'][-1]= 0.7495143222941001



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.28726983070374 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7120781390675284
 first_prior_anomaly_auc= 0.6152129055274271
 first_prior_star_anomaly_auc= 0.7496374436771127


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7160703749792863; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6054349673171571; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7247656049624303 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.715758798191757; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6035407556581479; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 170 
last prior star auc 0.7233469384308646 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7161816222469204; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6138196232158482; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 170 
last prior star auc 0.736078892678051 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7169552340572849; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6229336664418501; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 170 
last prior star auc 0.7442612664245403 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7276053656224835 at iter 10
0.6338885669684275 at iter 170
0.7502827094936984 at iter 480
last anomaly aucs:
0.7175885729846458
0.6166912592789615
0.7398633051837639




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.614256143569946 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7186517021148591,first_prior_anomaly_auc= 0.6180161466859607, first_prior_star_anomaly_auc= 0.7389261999981002


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7186516493410129 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6555258438801865 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.792071468453378 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7186517021148592 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6278597883346579 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7546706437037107 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7186516493410131 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6249833498515471 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7528897374923347 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.718651649341013 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6247882977162645 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7529391865861549 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7186517021148591 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6247660271531993 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7532912409136631 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7186516493410129 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6258397110526377 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7539782508425344 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7186517021148592 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6254515066405331 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7534957923412484 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7186517021148591 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.625409656980555 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7538214069718473 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7186516493410131 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6270870209058315 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.75493957922357 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7186516493410129 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6261480686355533 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7538957653210391 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7186516493410131 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6256769565111844 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7532403669259974 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.718651649341013 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6261692309478499 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7537475235872706 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7186517021148592 at iter 20
max_prior_anomaly= 0.6785467454896832 at iter 1
max_prior_star_anomaly= 0.8195726585036083 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7186516493410129
accuracies_anomaly['prior'][-1]= 0.6261768303816921
accuracies_anomaly['prior_star'][-1]= 0.7534907260520203



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.60642838478088 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.718651649341013
 first_prior_anomaly_auc= 0.6262686568739518
 first_prior_star_anomaly_auc= 0.7535610735889066


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7172273360079119; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5897912688838015; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.716234976605354 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7200535337895105; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6003303115029042; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7252664815360144 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7220582538823079; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6111117443972647; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7376323436126232 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7223259756037064; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6147701329584279; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7419482415226732 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7248955341715931 at iter 10
0.6262686568739518 at iter 0
0.7535610735889066 at iter 0
last anomaly aucs:
0.7231178999386767
0.6133060809191937
0.7420186418334057




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.65363907814026 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7229768882218275,first_prior_anomaly_auc= 0.6111040394157302, first_prior_star_anomaly_auc= 0.7381492634354296


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7229770465433658 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6412286173568958 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7846000639619015 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7229769937695196 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6171022092187465 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7501414339076183 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7229769937695196 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6157906735948171 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7498724983877589 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7229769409956737 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6164157270283364 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7508839091487685 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7229769937695196 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.618364876261163 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7527632913570161 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7229770465433658 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6186282177533329 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7529482636876885 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7229770465433658 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.618373214528851 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7530924418353055 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7229770465433658 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6189851800485309 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7532047973537082 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7229770465433658 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6194122787852304 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7535199627627742 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7229769409956736 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6197920393819549 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7535720505489008 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7229769937695198 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6199134192280452 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.753763619610339 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7229769937695197 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6208959626952236 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7542463419808557 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7229770465433659 at iter 12
max_prior_anomaly= 0.6810314964868451 at iter 1
max_prior_star_anomaly= 0.8249276206700378 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7229769937695197
accuracies_anomaly['prior'][-1]= 0.6205600571646301
accuracies_anomaly['prior_star'][-1]= 0.7543342632085022



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.22850561141968 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7229769409956737
 first_prior_anomaly_auc= 0.6202491136632543
 first_prior_star_anomaly_auc= 0.7538988262041144


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7215059755825968; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6159502617055029; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 40 
last prior star auc 0.7371240787005813 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7248412298839293; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6157239674533136; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 140 
last prior star auc 0.7360296019057693 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7246498191440294; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6165918333528597; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 250 
last prior star auc 0.7436099843894963 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7260048404171666; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 330 
last prior auc 0.6236951930414518; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 250 
last prior star auc 0.7519565903451304 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.727602304739408 at iter 490
0.6356275707459793 at iter 250
0.7563704365135908 at iter 250
last anomaly aucs:
0.727602304739408
0.621900248987006
0.7515016797915222




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.571799993515015 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7254860735097458,first_prior_anomaly_auc= 0.6243702233072526, first_prior_star_anomaly_auc= 0.7472294786260645


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7254860735097458 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6509781104641037 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7810507589406812 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7254860735097457 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6359532909242706 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7605070088945041 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7254860735097458 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6357895336797409 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7606661220405746 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7254860735097459 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6372792338081924 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7628870038071053 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7254860735097459 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6377964702740757 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7618152725399735 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7254860735097457 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6381444082415861 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7625910480780294 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7254860735097458 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6378278179386747 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7620147576783307 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7254860735097459 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6385634853536745 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7628059959533015 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7254860735097457 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6407130696540886 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7656377877625895 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7254860735097459 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6390330142626596 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7635559650806015 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7254860735097457 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6392593612886951 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7631372573854359 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7254860735097458 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6390179737165136 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7627917997886935 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7254860735097459 at iter 2
max_prior_anomaly= 0.6859314953258204 at iter 1
max_prior_star_anomaly= 0.8261595733340088 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7254860735097457
accuracies_anomaly['prior'][-1]= 0.6391018841318543
accuracies_anomaly['prior_star'][-1]= 0.7625486179057438



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.93397450447083 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7254860735097457
 first_prior_anomaly_auc= 0.6407691682525207
 first_prior_star_anomaly_auc= 0.7640833868987872


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.727803795283918; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6097970951164138; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7292065768877997 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7283587650497816; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6092022810967249; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7342225726405605 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7286975731419121; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6244968805379554; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7441214685061519 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7296136215629714; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6371158987544316; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7613760358186648 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7471237726122738 at iter 10
0.6407691682525207 at iter 0
0.7640833868987872 at iter 0
last anomaly aucs:
0.7280373723268728
0.6150522091659727
0.747641800685849




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.045687437057495 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7287024283357556,first_prior_anomaly_auc= 0.6273169565534035, first_prior_star_anomaly_auc= 0.7508746737256963


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7287024283357556 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6479498416256878 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7754972615651246 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7287024283357556 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6342108040728743 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7584413350094307 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7287024283357556 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6347381731172139 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7592810196751453 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7287024283357556 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6358148651258815 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7606417932975105 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7287024283357556 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6367237363038675 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7616784299569682 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7287024283357557 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.637543261360362 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7625622863318904 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7287024283357557 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6383558730430139 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.763477595919104 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7287024283357557 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6386906175489926 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7635048799975512 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7287024283357556 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6391419922549104 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7639669150203866 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7287024283357557 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6393331918994256 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7639528244034708 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7287024283357557 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6393716640332517 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7640828591603259 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7287024283357557 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6392456928625484 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7638016801081653 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7287024283357557 at iter 1
max_prior_anomaly= 0.6841914888451921 at iter 1
max_prior_star_anomaly= 0.8264862434415303 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7287024283357556
accuracies_anomaly['prior'][-1]= 0.6398642023391479
accuracies_anomaly['prior_star'][-1]= 0.7647537730661288



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.81995701789856 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7287024283357557
 first_prior_anomaly_auc= 0.6398173391637879
 first_prior_star_anomaly_auc= 0.7646019954846697


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.726156723546318; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6253947747559474; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7429674100390632 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7267495849337001; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6259881638817908; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7467741458816874 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7263044375416254; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6098583127779202; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 280 
last prior star auc 0.7347543219141286 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7285206224358507; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.6167002836066491; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 280 
last prior star auc 0.7433890730696118 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7298251919120915 at iter 340
0.6420938445641355 at iter 280
0.7646019954846697 at iter 0
last anomaly aucs:
0.7297930526398005
0.6352002081400492
0.7516306590714548




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.94800591468811 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7270407910166248,first_prior_anomaly_auc= 0.6266216083568441, first_prior_star_anomaly_auc= 0.7446985505135424


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7270407910166248 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6465531290141107 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.770252755058637 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7270407910166248 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6425746143023456 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7655062753380428 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7270407910166248 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6435682402772105 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7659952777962487 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7270407910166248 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.643734477892508 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7665479255128826 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7270407910166248 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6445991773612867 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7661054695869602 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7270407910166248 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6447467330350557 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7660049881839359 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7270407910166248 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6442596832091564 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.765778905027131 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7270407910166248 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6448264215427062 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7655699205964711 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7270407910166248 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6460779005297439 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7664971570729091 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7270407910166248 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6440842101707867 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7647460153107482 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7270407910166248 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.643787515607865 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.764367574060177 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7270407910166248 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6449206228580415 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.76521327494435 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7270407910166248 at iter 0
max_prior_anomaly= 0.6841190303544608 at iter 1
max_prior_star_anomaly= 0.822763048597324 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7270407910166248
accuracies_anomaly['prior'][-1]= 0.6485972183961184
accuracies_anomaly['prior_star'][-1]= 0.768451003178041



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.94744920730591 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7270407910166249
 first_prior_anomaly_auc= 0.6425033696100751
 first_prior_star_anomaly_auc= 0.7669177646265353


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7323059320969477; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6129551348424542; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7266508978414441 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7330935817503819; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6105885972606152; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7324041969984347 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7317728107033804; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6180896606536146; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7351203613108601 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7319586274155909; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6327717140628579; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7432391953466134 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7356906354921003 at iter 50
0.6425033696100751 at iter 0
0.7669177646265353 at iter 0
last anomaly aucs:
0.730269389374936
0.6251109042376343
0.7424190370039654




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.897664070129395 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7333559205394754,first_prior_anomaly_auc= 0.6395576390670007, first_prior_star_anomaly_auc= 0.7525568400709702


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7333559205394753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6520929051896744 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7671530304325662 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7333559205394753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6456724918438022 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7594650420765875 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7333559205394753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6466788890894295 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7606197338298297 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7333559205394753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6482380923732293 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7622134512089961 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7333559205394753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6492818007280681 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7632233315284677 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7333559205394753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6501896164291316 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7638761440050493 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7333559205394753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6511723709916944 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7647519259815143 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7333559205394753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6515863818145549 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7668378650235002 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7333559205394753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6505052040289665 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7648315089414728 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7333559205394753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6510932102225051 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7650616029105832 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7333559205394753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.650495388093587 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7648439635691585 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7333559205394753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6504553327443772 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7651245093351657 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7333559205394754 at iter 0
max_prior_anomaly= 0.6885209496336967 at iter 1
max_prior_star_anomaly= 0.8257698912542126 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7333559205394753
accuracies_anomaly['prior'][-1]= 0.6532532437444523
accuracies_anomaly['prior_star'][-1]= 0.7688067516747781



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.89633417129517 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.49939135923262606
accuracies_anomaly["prior"][-1]= 0.6839011271438055
accuracies_anomaly["prior_star"][-1]= 0.49957369287099224


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 2767.2148768901825 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.006021022796630859 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4932876417373572
 first_prior_anomaly_auc= 0.6703661660539623
 first_prior_star_anomaly_auc= 0.4934746194741825


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.506634675161145; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6874652088419414; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5076809694344437 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5433923450480717; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6887525740443449; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5478314698888266 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6337944712007846; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6890739139934074; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6442442732460876 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6945807065151424; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6892677523302291; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.7117601238707716 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7086620880077767 at iter 490
0.6893940929178554 at iter 490
0.7297729458044264 at iter 490
last anomaly aucs:
0.7086620880077767
0.6893940929178554
0.7297729458044264




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.84221124649048 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7092914161228322,first_prior_anomaly_auc= 0.689404436591696, first_prior_star_anomaly_auc= 0.7306675680439585


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.709291363348986 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6918675503119461 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7290815028724804 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7092913633489861 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.671645667953293 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7261974649555274 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7092913633489861 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5477236001473446 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7283697947836221 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.709291363348986 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6690088227315953 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7942918752552934 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.709291363348986 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6835789955870509 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8155263293995709 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7092913633489861 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.690771331980212 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8131367824208207 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7092913633489861 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6917062206643383 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8070845721993711 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7092913633489861 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6921505236748752 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.804551110942235 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.709291363348986 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6928970097283308 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8026137302770944 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7092913633489861 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.693957236297007 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8012457794116561 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7092913633489861 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6946781798089376 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8000902432768758 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7092913633489861 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6949954561718485 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7990147122928231 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7092914161228322 at iter 0
max_prior_anomaly= 0.6951655462779134 at iter 129
max_prior_star_anomaly= 0.8170889102095227 at iter 54
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7092913633489861
accuracies_anomaly['prior'][-1]= 0.6951655462779134
accuracies_anomaly['prior_star'][-1]= 0.7980886368409998



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 121.63245701789856 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.709291363348986
 first_prior_anomaly_auc= 0.6951792674779061
 first_prior_star_anomaly_auc= 0.7979933272748958


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7161906993484541; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7000780525184207; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.8141401187833728 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7167770167789166; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7024049041679727; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.8179240035506243 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7142998124417509; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7039892278025286; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.8179811048521328 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7115073371478269; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7050547317558176; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.8169505371849797 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.717041360974163 at iter 170
0.7057117133662432 at iter 490
0.8181963693704819 at iter 260
last anomaly aucs:
0.7097259031979894
0.7057117133662432
0.8157840240902052




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.61899423599243 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7095555492226939,first_prior_anomaly_auc= 0.7057649094031383, first_prior_star_anomaly_auc= 0.8156896116794854


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7095554964488479 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7317975088633675 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8162075869792145 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7095554436750017 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7341928081913452 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.81520414506897 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7095554964488479 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7356774948044149 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8148991122383604 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7095554436750017 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7367651109992306 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8146596245246396 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7095555492226939 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7370007989960304 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8141887762695014 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7095555492226939 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7373051457666404 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8138025772635494 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7095555492226939 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7375721814280392 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8133959547791467 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7095554436750017 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7377267560233429 iter_best_prior_anomaly= 780
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8130163525039606 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7095554436750017 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7380626615539365 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8126647731410677 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7095554436750017 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7377084962725833 iter_best_prior_anomaly= 910
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8121294880198092 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7095554964488479 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7381879994384863 iter_best_prior_anomaly= 1010
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8118744847953272 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7095554436750018 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7383040491261179 iter_best_prior_anomaly= 1170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.811526969018586 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.709555549222694 at iter 5
max_prior_anomaly= 0.738678268468999 at iter 125
max_prior_star_anomaly= 0.8183871468242283 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.709555496448848
accuracies_anomaly['prior'][-1]= 0.7385312933075374
accuracies_anomaly['prior_star'][-1]= 0.8112680605294904



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.02307271957397 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7095555492226939
 first_prior_anomaly_auc= 0.7383989892752991
 first_prior_star_anomaly_auc= 0.8111979240879887


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.704993883511234; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7352736693338567; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.8068342130733483 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7055164501355761; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7274990263225392; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.8082684478895211 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7064265878858691; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7201330639756227; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.8094696334012006 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7072056354023848; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7136967657020663; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.8104112771376311 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7095555492226939 at iter 0
0.7395656079177657 at iter 20
0.8111979240879887 at iter 0
last anomaly aucs:
0.7076160048298623
0.7089511303630102
0.8106309746590545




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.15193796157837 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7076451887667702,first_prior_anomaly_auc= 0.7085532683370644, first_prior_star_anomaly_auc= 0.8106527174836585


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7076451359929241 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7360909251149679 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.816258777609957 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7076451359929241 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7386908814182231 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8147633779061239 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7076451359929241 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7411077124754206 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8148440163430046 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7076451359929241 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7414135896875683 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.814772243912273 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7076451359929241 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7421221841195054 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8146236327615815 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7076451887667703 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7422574962609729 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8151419774782334 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7076451359929241 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7427205867607307 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.81508371515211 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7076451359929241 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7426430619807713 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8145520714262343 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7076451359929241 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7428985929437146 iter_best_prior_anomaly= 870
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8140937305726279 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7076451359929241 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7435695596233637 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.815054478441356 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7076451359929241 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7425047945039206 iter_best_prior_anomaly= 1020
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8137960860804759 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7076451359929241 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7439343852216344 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8152848362796972 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7076451887667703 at iter 18
max_prior_anomaly= 0.7439343852216344 at iter 120
max_prior_star_anomaly= 0.8280299312145689 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7076451887667703
accuracies_anomaly['prior'][-1]= 0.7423604580347654
accuracies_anomaly['prior_star'][-1]= 0.8136148606928784



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.10177779197693 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7076451359929241
 first_prior_anomaly_auc= 0.7430042989575054
 first_prior_star_anomaly_auc= 0.813772707266642


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7077413954882583; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6384735059460293; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.777019998121251 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7076554796667649; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6332303715595411; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.778793252124939 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7072398856285207; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6367653220946151; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7831486248718914 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7070829889839874; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6364638251116959; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7839119457822614 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7078011882559194 at iter 70
0.7430042989575054 at iter 0
0.813772707266642 at iter 0
last anomaly aucs:
0.7070353869747814
0.6434626398111118
0.7897535883576674




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.134201526641846 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7069970731624938,first_prior_anomaly_auc= 0.6418014774565961, first_prior_star_anomaly_auc= 0.7846493547341834


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7069970731624938 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6556195702309067 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7977983279134593 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7069970731624938 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6469289315723756 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7927209034038074 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7069970731624938 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6464852090741462 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7944665566859714 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7069970731624938 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6457016230068637 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7934180459111352 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7069970731624938 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6442720850629962 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7932046284774007 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7069970731624938 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6435532525049106 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7936906228263773 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7069970731624938 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6440451047508072 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7945464562890066 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7069970731624938 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.644744410985826 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7953470883085876 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7069970731624938 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6455181283438828 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7962180678650552 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7069970731624938 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6462202315927463 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7969971153815708 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7069970731624938 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6469645539185108 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.797768932881167 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7069970731624938 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6475995816089479 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7984249117885162 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7069970731624938 at iter 0
max_prior_anomaly= 0.6737937745860156 at iter 7
max_prior_star_anomaly= 0.8219850565577309 at iter 7
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7069970731624938
accuracies_anomaly['prior'][-1]= 0.6508330351611027
accuracies_anomaly['prior_star'][-1]= 0.8001744703352933



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.29009246826172 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7069970731624938
 first_prior_anomaly_auc= 0.650867865899546
 first_prior_star_anomaly_auc= 0.8002143673629649


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7021962363803896; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5849538598263317; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7217075716747992 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7016589458529784; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6033975802136073; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7401456452605392 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7027287772616495; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6206981135460964; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7497268425724506 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7028354332046707; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5973881168075201; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7335493366855281 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7069970731624938 at iter 0
0.650867865899546 at iter 0
0.8002143673629649 at iter 0
last anomaly aucs:
0.7018818625790157
0.612643980245694
0.7369220076437639




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.83924078941345 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.701240343705505,first_prior_anomaly_auc= 0.6010451860225302, first_prior_star_anomaly_auc= 0.7264480351769349


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.701240290931659 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6272157890903794 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7529491080692267 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7012402909316588 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6189723560039221 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7513288454454587 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.701240290931659 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6152864722689271 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7526781143693684 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.701240290931659 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6138105461143144 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7540911868732446 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.701240290931659 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6126170655841695 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7544318420499896 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.701240290931659 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6142245569371749 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7571051539993603 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.701240290931659 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6124201135904264 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7554038307479426 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.701240290931659 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6130926634854592 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7564619991366199 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.701240290931659 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6122717663089655 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7558140418538819 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.701240290931659 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6134770681806427 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7570850471639863 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.701240343705505 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6154830548457473 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7600782741685745 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7012403437055051 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6173365778693931 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7611320623280233 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7012403437055051 at iter 6
max_prior_anomaly= 0.6658997571347601 at iter 4
max_prior_star_anomaly= 0.8056709191831876 at iter 7
last values
accuracies_anomaly['vanilla_star'][-1]= 0.701240343705505
accuracies_anomaly['prior'][-1]= 0.6134494146852726
accuracies_anomaly['prior_star'][-1]= 0.75711333394551



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.99166178703308 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.701240343705505
 first_prior_anomaly_auc= 0.6134727934991066
 first_prior_star_anomaly_auc= 0.7571673215900971


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7043430236669591; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.629799491049028; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 70 
last prior star auc 0.7411519897323204 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7033423259967133; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6319409481771385; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 180 
last prior star auc 0.7392811041132992 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7051413336373108; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6312512995559608; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 260 
last prior star auc 0.7475918766274134 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7049690270297084; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6245394162579333; count_not_improved_prior_anomaly= 31; iter_best_prior_anomaly= 340 
last prior star auc 0.7395851342408324 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.707048158245544 at iter 10
0.653057558323016 at iter 340
0.7577070924882763 at iter 230
last anomaly aucs:
0.7064564051089305
0.643781657710945
0.752037545425088




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.76874899864197 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7056682277170351,first_prior_anomaly_auc= 0.6370127786591011, first_prior_star_anomaly_auc= 0.7492358874819381


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7056682277170351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6550201648866047 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7705987403938406 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7056682277170351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6534653946058796 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7661098498161887 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7056682277170351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6531664307675745 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7667722671327654 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7056682277170351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6533004763367352 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7671388870418043 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7056682277170351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6531707582229569 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.767084424432602 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7056682277170351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6528309474277498 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.766858657918874 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7056682277170351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.652345639138773 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.766492935165219 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7056682277170351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6513664204239006 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7658353202686401 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7056682277170351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.654264812827 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7688321358947646 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7056682277170351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6507176715334708 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7655205242764969 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7056682277170351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6509055991995263 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7656536726902734 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7056682277170351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6529814584369019 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7673647063293785 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7056682277170351 at iter 0
max_prior_anomaly= 0.705502253970968 at iter 3
max_prior_star_anomaly= 0.8203996246724063 at iter 7
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7056682277170351
accuracies_anomaly['prior'][-1]= 0.6506252117550575
accuracies_anomaly['prior_star'][-1]= 0.7654368777303868



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.8742995262146 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7056682277170351
 first_prior_anomaly_auc= 0.6511909473855308
 first_prior_star_anomaly_auc= 0.766081932451588


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6960977434958873; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6267768162383014; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7308093713684997 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7004922744366655; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6393680754117153; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7434889211864828 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7007188853319317; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6273816572887542; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7406519047664282 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7031034715691459; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6262227436278219; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7400278012621393 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7056682277170351 at iter 0
0.6511909473855308 at iter 0
0.766081932451588 at iter 0
last anomaly aucs:
0.7044008638023134
0.6240848223474018
0.7358676389720077




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.80324196815491 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7044345862899881,first_prior_anomaly_auc= 0.6352566233815581, first_prior_star_anomaly_auc= 0.7466499162479062


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7044345862899881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.658689372086224 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7721581019991788 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7044345862899881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6621618911613307 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7706534140984274 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7044345862899881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6632920958499703 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7712862252873272 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7044345862899881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6639614265403895 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7717873129562959 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7044345862899881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6643708460386368 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7721197354130451 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7044345862899881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6649879306213909 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7726854710435184 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7044345862899881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6649787479721649 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7729361995864641 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7044345862899881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6663941425252707 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.774201135904264 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7044345862899881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6658602822978578 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7739970066674478 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7044345862899881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6659249830332085 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7749387559515706 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7044345862899881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6658393838547917 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7745591536763844 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7044345862899881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.666707408075876 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.775763716714216 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7044345862899881 at iter 0
max_prior_anomaly= 0.714802377778411 at iter 3
max_prior_star_anomaly= 0.8167193877389468 at iter 7
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7044345862899881
accuracies_anomaly['prior'][-1]= 0.6670576680926159
accuracies_anomaly['prior_star'][-1]= 0.7751978755360505



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.55891537666321 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7044345862899881
 first_prior_anomaly_auc= 0.6671349290033448
 first_prior_star_anomaly_auc= 0.7750900057945684


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7052010736311256; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6358980894812225; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7520456725973915 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7067315151687866; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.656265574881338; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7682896735304331 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7085571208278316; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.6382851560892047; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7640156780542071 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.709207769576722; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.6445371680920883; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7634600222283441 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7097836905594977 at iter 390
0.6671349290033448 at iter 0
0.7765151635092074 at iter 480
last anomaly aucs:
0.709455595558131
0.6471386548368814
0.7680820084459263




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.97269916534424 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7086644100570063,first_prior_anomaly_auc= 0.6576484079713839, first_prior_star_anomaly_auc= 0.7734654157154182


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7086644100570063 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.677297957968798 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7925655372008119 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7086644100570063 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6690088755054415 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7812294511836646 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7086644100570063 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6687500725640385 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7801477984334612 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7086644100570063 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6694540756713625 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7810932418868127 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7086644100570063 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6703016764139961 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7808869489223051 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7086644100570063 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6699276681664994 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7800031980950752 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7086644100570063 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6706946304722521 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.780339578590284 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7086644100570063 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.670681648106105 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7807182309362397 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7086644100570063 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6703248969062916 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7799664147243253 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7086644100570063 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.671358894873443 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7804657608563716 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7086644100570063 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6718034617532105 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7805767970286213 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7086644100570063 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6711846356335341 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7801662692796053 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7086644100570063 at iter 0
max_prior_anomaly= 0.7164265984406384 at iter 3
max_prior_star_anomaly= 0.8245513431471577 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7086644100570063
accuracies_anomaly['prior'][-1]= 0.6703908642139493
accuracies_anomaly['prior_star'][-1]= 0.7794424232061379



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.41659474372864 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7086644100570063
 first_prior_anomaly_auc= 0.672213778406842
 first_prior_star_anomaly_auc= 0.7805535765363258


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7161554991930879; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6318873299494743; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7505220916597269 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7159585999731909; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6146208357477367; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7378452860817424 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7172657025940457; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6318464829925726; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7490212034758966 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7142386475540906; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6319724013894299; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.748788523588326 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7187836367301748 at iter 180
0.672213778406842 at iter 0
0.7805535765363258 at iter 0
last anomaly aucs:
0.7122681776874289
0.6184920612303273
0.7414065179921874




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.20115685462952 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7127383926564137,first_prior_anomaly_auc= 0.6108972187127615, first_prior_star_anomaly_auc= 0.7346563736557182


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7127384454302599 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6292651558569997 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7577655131359381 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7127384454302599 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6332374432549219 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7591590593167475 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7127384454302599 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6356227683259819 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7606852789467184 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7127384454302599 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6375637903865051 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7620318564044756 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7127384454302599 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6389437736888601 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7630672792654725 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7127384454302599 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6399751857375514 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7639378366311711 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7127384982041061 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.640691960115638 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7646238966308121 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7127384454302599 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6411194810431067 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7649949495429258 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7127384454302599 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.641368731918361 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7656002655579937 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7127384454302599 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6417017348874176 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7657570566548347 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7127384454302599 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.641657193761287 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7657099823840902 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7127384454302599 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6418610063550265 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7658987016578376 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7127384982041061 at iter 2
max_prior_anomaly= 0.6930574422205547 at iter 3
max_prior_star_anomaly= 0.8160484210592978 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7127384454302599
accuracies_anomaly['prior'][-1]= 0.6419851832149616
accuracies_anomaly['prior_star'][-1]= 0.7663611588714418



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.38816785812378 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7127383926564138
 first_prior_anomaly_auc= 0.6414593446121598
 first_prior_star_anomaly_auc= 0.7656750460979547


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7111763395849231; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6332921169595087; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 70 
last prior star auc 0.7573690760038377 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7111683179603119; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6502300411952643; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 190 
last prior star auc 0.7727374532819526 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7109234473142862; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6313875088528127; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 190 
last prior star auc 0.760932577189666 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7101883604115938; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.622992139863358; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 190 
last prior star auc 0.757162677491638 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7127383926564138 at iter 0
0.650624578468904 at iter 190
0.7727374532819526 at iter 200
last anomaly aucs:
0.711818808387664
0.6203508616385857
0.7565695522350252




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.637319564819336 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.711154543986473,first_prior_anomaly_auc= 0.6388996547534986, first_prior_star_anomaly_auc= 0.7644975560431859


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.711154543986473 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6555770345109289 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7816687406788194 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.711154543986473 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6577510531020994 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7811935649682987 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.711154543986473 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6595402975811635 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7816410871834492 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.711154543986473 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6604311728776207 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7817188758326393 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.711154543986473 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6612306438725871 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7822577495754344 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.711154543986473 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6614618460924662 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7823411322523138 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.711154543986473 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6610398664188407 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7814062435681876 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.711154543986473 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6604293257930061 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7810692297868254 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.711154543986473 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6599404816563388 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.780458372517914 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.711154543986473 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.659579350227297 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.779859283816689 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.711154543986473 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6595578712719236 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7797142612875341 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.711154543986473 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6596647383103292 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7796547323891037 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.711154543986473 at iter 0
max_prior_anomaly= 0.6962251923342823 at iter 2
max_prior_star_anomaly= 0.8198812799557544 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.711154543986473
accuracies_anomaly['prior'][-1]= 0.6589953020722178
accuracies_anomaly['prior_star'][-1]= 0.7791484201093686



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.21808862686157 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.711154543986473
 first_prior_anomaly_auc= 0.6584393296032779
 first_prior_star_anomaly_auc= 0.7789389079402473


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.71602509501931; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6300481614119748; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7543881980792431 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7168390788219611; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6337477135731165; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7668871557957821 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7170617844526138; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6240033395289828; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7507715008565194 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7154511266688408; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 320 
last prior auc 0.60488522216206; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7346268203018875 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7189052804454957 at iter 320
0.6584393296032779 at iter 0
0.7789389079402473 at iter 0
last anomaly aucs:
0.7144028269893893
0.6270589979935384
0.7504171772536279




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.57077431678772 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7166430767574482,first_prior_anomaly_auc= 0.6292149151554876, first_prior_star_anomaly_auc= 0.7533207414936476


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7166430767574482 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.640909705004755 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7702769254801629 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7166430767574482 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6382274742753886 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7700944862941044 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7166430767574483 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6360227413057727 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7688239559486152 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7166430767574482 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6348363324710087 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7679347166413881 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7166430767574483 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6346524683911048 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7680247488228793 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.716642971209756 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6336022160793465 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7669972420388014 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7166430767574483 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6329533088673782 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7664777362975348 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7166430767574483 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6322549525615897 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7660428798054545 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7166430767574483 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6321148907739707 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7657390079994595 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7166430767574483 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6316853644403493 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7653489037288944 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7166430239836021 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.631203275355986 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7649611742814049 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7166430767574483 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6312315093636636 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7653680078611922 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7166430767574483 at iter 1
max_prior_anomaly= 0.6892008350933412 at iter 2
max_prior_star_anomaly= 0.8167548517635437 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7166430767574482
accuracies_anomaly['prior'][-1]= 0.6305066078132735
accuracies_anomaly['prior_star'][-1]= 0.7646361401631134



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.15865325927734 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7166430767574482
 first_prior_anomaly_auc= 0.6305878267624617
 first_prior_star_anomaly_auc= 0.7643655686540242


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.717385868641675; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.604918258589735; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7333928622317637 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7210225671520805; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6111079974541898; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7294767262061199 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7172558338848201; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6006288531504402; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.724590712436368 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7209380234505862; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6141709387095107; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7385687627382871 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7223380080406232 at iter 190
0.6305878267624617 at iter 0
0.7643655686540242 at iter 0
last anomaly aucs:
0.7206252856384421
0.6162800454699457
0.7373309521773961




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.77654480934143 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7198890904849811,first_prior_anomaly_auc= 0.6019762222158893, first_prior_star_anomaly_auc= 0.729022818355588


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7198890904849811 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6206819647491817 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7519898906420361 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7198890904849811 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6209469950044277 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7532129245260117 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7198890904849811 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6215165303518221 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7543845566838604 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7198890904849811 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6221040615807456 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7552793372449307 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7198890904849811 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6227087443096601 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7559988030891699 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7198890904849811 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6235715966938241 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7568589112333354 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7198890904849811 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6241644580812062 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7575772688268058 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7198890904849811 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6235686413584409 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7569709501086613 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7198890904849811 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6233781277739253 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7569283616148375 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7198890904849811 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6244455315856746 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7584277721309762 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7198890904849811 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6230820137233111 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7571542336762578 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7198890904849811 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6232253474893898 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7575509346775888 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7198890904849811 at iter 0
max_prior_anomaly= 0.6793528132154154 at iter 2
max_prior_star_anomaly= 0.8125802822134196 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7198890904849811
accuracies_anomaly['prior'][-1]= 0.6234001344677599
accuracies_anomaly['prior_star'][-1]= 0.757498002509924



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.62100076675415 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7198890904849811
 first_prior_anomaly_auc= 0.6227148660758106
 first_prior_star_anomaly_auc= 0.7568593334241044


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.720210905398659; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6160964980331187; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7368488103191868 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7205769975692367; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6143201303725094; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 120 
last prior star auc 0.7383907037814571 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.717548887052359; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6027206500893462; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 120 
last prior star auc 0.7307881562823569 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7200180697649137; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.6038805136795086; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 120 
last prior star auc 0.7303501861333553 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7223134682021745 at iter 390
0.6238960502998082 at iter 120
0.7568593334241044 at iter 0
last anomaly aucs:
0.7197440151819802
0.6053175455095262
0.7302542432810979




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.57425093650818 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7186352366748677,first_prior_anomaly_auc= 0.613472529629876, first_prior_star_anomaly_auc= 0.7390834660595563


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7186352366748676 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.626379534724663 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7555733403417002 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7186352894487138 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6225131116620701 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7498707040769907 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7186352366748676 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6207148428553184 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7476588994119939 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7186352894487138 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.6194520702652097 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7461074011097284 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7186352366748676 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.618334795168871 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7458930337467636 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7186352366748676 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.6186452637056317 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7455914312161522 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7186352894487138 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.6176258840938571 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7453584346855049 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7186352894487138 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.6175825567661876 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7440875349230927 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7186352894487138 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.6169856845664998 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7437829770570982 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7186352894487138 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.6164382086867861 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7429548498636852 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7186352366748676 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.6159853563131769 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7426181527253998 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7186352894487138 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.6167944849219844 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7434273341080533 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7186352894487139 at iter 34
max_prior_anomaly= 0.6714384250595553 at iter 2
max_prior_star_anomaly= 0.8071815705285511 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7186352894487138
accuracies_anomaly['prior'][-1]= 0.6155588908626307
accuracies_anomaly['prior_star'][-1]= 0.7424840016085468



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 122.95892429351807 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7186352366748676
 first_prior_anomaly_auc= 0.6164350950298647
 first_prior_star_anomaly_auc= 0.7430151703698075


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7255250733820331; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6255713560450857; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 90 
last prior star auc 0.7576146327098631 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7264323085707892; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6315693147527176; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 150 
last prior star auc 0.7672541451217441 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7288380571203001; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6268169771352035; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 150 
last prior star auc 0.7589037394491889 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7266148005306938; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6264571650523147; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 150 
last prior star auc 0.7589473834199352 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7300546525950483 at iter 450
0.6437708918463352 at iter 430
0.7744050012718496 at iter 430
last anomaly aucs:
0.725310231054453
0.6171322375371924
0.7524236388833476




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.75441360473633 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7250989245745637,first_prior_anomaly_auc= 0.6195805745805271, first_prior_star_anomaly_auc= 0.7573689704561455


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7250989245745637 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6313412789636061 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7732687275909056 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7250989245745637 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6287124553665197 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.773013038306424 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7250989245745637 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6290949074293966 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7741529533827507 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7250989245745636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6292061019231845 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7752117022837355 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7250989245745636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6277432636824112 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7737551969044973 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7250989245745636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6273354273995476 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7733677841000846 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7250989245745637 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6262149858724414 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7720745082269148 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7250989245745637 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6277301229947257 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.774410595299539 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7250989245745636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6271167853550466 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7736728697045403 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7250989245745636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6266296299814553 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7732632918847546 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7250989245745636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6270406854689325 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7732620780862938 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7250989245745636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6245066436994888 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7714219068457179 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7250989245745637 at iter 0
max_prior_anomaly= 0.6722764209621939 at iter 2
max_prior_star_anomaly= 0.8114586796616985 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7250989245745636
accuracies_anomaly['prior'][-1]= 0.6254632752082192
accuracies_anomaly['prior_star'][-1]= 0.7723062909591013



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.0795578956604 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7250989245745637
 first_prior_anomaly_auc= 0.6253487559621254
 first_prior_star_anomaly_auc= 0.7714842327579929


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7185847321041248; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5656136701149097; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6791812454416591 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7189207959562567; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5703950861216395; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6816680546188199 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7201408217310032; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5671918192094689; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6822441339231339 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7219568753238994; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5711330228120228; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6878979543801764 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7258583402203203 at iter 60
0.6253487559621254 at iter 0
0.7714842327579929 at iter 0
last anomaly aucs:
0.7201166513094774
0.5865878964239386
0.6997027249247709




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.96770167350769 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.71795144595061,first_prior_anomaly_auc= 0.5814640837035419, first_prior_star_anomaly_auc= 0.6935160997172378


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.71795144595061 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5957300681099258 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7120008253829534 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.71795144595061 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5953460328316651 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7123755196904498 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.71795144595061 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.596728390957096 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7140651799218736 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.71795144595061 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5964923863172193 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7142963821417526 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7179514987244562 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.596195427885067 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7143435619601896 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7179514987244561 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5958164588960344 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.714268939741767 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7179514987244561 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5954009704054826 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7140437537403463 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.71795144595061 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5965328110833521 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7152309014089562 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7179514987244562 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5960976907220412 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7149714124075535 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.71795144595061 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5956604594068853 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7146590967861783 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.71795144595061 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5936996999279109 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7128713827486518 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7179514987244562 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5933140814342664 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.71264403301954 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7179514987244562 at iter 3
max_prior_anomaly= 0.6434798440849491 at iter 2
max_prior_star_anomaly= 0.7768483775736486 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7179514987244561
accuracies_anomaly['prior'][-1]= 0.5946482042643378
accuracies_anomaly['prior_star'][-1]= 0.7140048066419051



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.02794814109802 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4932876417373572
accuracies_anomaly["prior"][-1]= 0.6703661660539623
accuracies_anomaly["prior_star"][-1]= 0.4934746194741825


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 2744.2145829200745 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.005693197250366211 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5176841464199806
 first_prior_anomaly_auc= 0.67605302293868
 first_prior_star_anomaly_auc= 0.517847745342972


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5276134400209407; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6887208569628228; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5285851648496631 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5663693915914376; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.689050640727266; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 140 
last prior star auc 0.5707407020399202 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6428145769806816; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6888020759120111; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 140 
last prior star auc 0.6531866431506408 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6978911571087953; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6886905647751465; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 140 
last prior star auc 0.7134831899467934 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7083145722310356 at iter 490
0.689124260242612 at iter 140
0.7276021464178697 at iter 490
last anomaly aucs:
0.7083145722310356
0.6886609586474697
0.7276021464178697




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.805537939071655 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7085607622232144,first_prior_anomaly_auc= 0.6886574227997793, first_prior_star_anomaly_auc= 0.7281752176129546


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7085607622232144 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6888272490366134 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7280682978007027 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7085607622232144 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6889266221888691 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7279457569299976 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7085607622232144 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6889926950442191 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.727800839948535 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7085607622232144 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6890855242395552 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7276449987809241 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7085607622232144 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6892056375133386 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7274759641517818 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7085607622232144 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6893472297424953 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7272918889764934 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7085607622232144 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6895077150085651 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7270949369827504 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7085607622232144 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6896633978546376 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7268856359090137 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7085607622232144 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6898749154299115 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7266666244475898 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7085607622232144 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6900692815051944 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7264357388707874 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7085607622232144 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6902719330743192 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7262003675170643 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7085607622232144 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6904163750911668 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.725959349361806 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7085607622232144 at iter 0
max_prior_anomaly= 0.6904733708449833 at iter 128
max_prior_star_anomaly= 0.7281752176129546 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7085607622232144
accuracies_anomaly['prior'][-1]= 0.6904648214819106
accuracies_anomaly['prior_star'][-1]= 0.7257295192619261



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.89110159873962 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7085607622232144
 first_prior_anomaly_auc= 0.6904621827896044
 first_prior_star_anomaly_auc= 0.7257070903773224


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7085610788662912; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6903585877296585; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7281564828975796 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7081956199818669; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6903018558450729; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7290761199401756 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.707555262132971; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6902633837112468; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7294290186492217 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7071724934270176; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6902468127235633; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.729727613070604 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7089367758768639 at iter 40
0.6904621827896044 at iter 0
0.7298973337597461 at iter 480
last anomaly aucs:
0.706857961304105
0.6902449656389488
0.729879285104371




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.77369737625122 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7068062429349014,first_prior_anomaly_auc= 0.6902417992081812, first_prior_star_anomaly_auc= 0.7298560646120752


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7068062429349014 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6901274910574717 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7294798926368874 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7068062429349014 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.689775595051502 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7291003959093937 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7068062429349014 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6888085670950848 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7286972564988353 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7068062429349014 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6871367971974977 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7282699994405972 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7068062429349014 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6845281859834775 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7278535082469688 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7068062957087475 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6804260749240849 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7274303147748825 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7068062429349014 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6743951853364701 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7269999968335692 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7068062957087474 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6657289281948495 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7265866192968624 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7068062429349014 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6542499306023923 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7261673310893894 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7068062429349014 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6401010513605625 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7257774379142087 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7068062429349014 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6239142045028756 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7253860142974904 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7068062429349014 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6076134189114022 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7250772345238058 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7068062957087475 at iter 24
max_prior_anomaly= 0.6902417992081812 at iter 0
max_prior_star_anomaly= 0.7298560646120752 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7068062957087475
accuracies_anomaly['prior'][-1]= 0.5937832937001748
accuracies_anomaly['prior_star'][-1]= 0.7248806519469855



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.49207997322083 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7068062429349014
 first_prior_anomaly_auc= 0.5923979802393611
 first_prior_star_anomaly_auc= 0.7248643976023786


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.706240507304428; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5920130478057163; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7245044271979515 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7058700349046217; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5916058448090062; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7242902709303711 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7055527585417108; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5911914645692229; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7241392849566041 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7052742181818565; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5908066904571164; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.723928981179791 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7068062429349014 at iter 0
0.5923979802393611 at iter 0
0.7248643976023786 at iter 0
last anomaly aucs:
0.7050453380112071
0.5904608634434512
0.7237525054383449




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.862977504730225 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7050313529419836,first_prior_anomaly_auc= 0.5904255049665467, first_prior_star_anomaly_auc= 0.7237358816768151


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7050313529419836 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5757720549819039 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7235624140445982 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7050314057158298 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.563464666326803 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7236030499061153 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7050313529419836 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5530322796507217 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7240847167997095 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7050313529419836 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5450769389902674 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.724835688630086 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7050314057158298 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5401756735789851 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7259438338510447 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7050314057158298 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5389130065365686 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7277357697962614 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7050314057158298 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.541949402547288 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7304401655410004 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7050313529419836 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5487691028129515 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7341083700375433 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7050313529419836 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5586423505893255 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7389133231796454 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7050314057158298 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5720258507407865 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.745270302362474 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7050313529419836 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.59018527841898 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7526596962970704 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7050314057158297 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6091158903106163 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7606899230451776 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7050314057158298 at iter 2
max_prior_anomaly= 0.6237473863752706 at iter 129
max_prior_star_anomaly= 0.7683220238981086 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7050313529419836
accuracies_anomaly['prior'][-1]= 0.6237473863752706
accuracies_anomaly['prior_star'][-1]= 0.7683220238981086



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.56717896461487 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7050314057158298
 first_prior_anomaly_auc= 0.6251332803483919
 first_prior_star_anomaly_auc= 0.7691045017146223


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7050799048804197; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6247786928762696; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7689368919793254 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7051411225419262; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6244338157918345; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7688090737240075 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7052144781880416; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6241344297627605; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7687577775455728 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7052713683941657; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6238343576736867; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7687573553548039 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7052941666956922 at iter 490
0.6251332803483919 at iter 0
0.7691045017146223 at iter 0
last anomaly aucs:
0.7052941666956922
0.6235851595722786
0.7687732930563339




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.837157011032104 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.705290683621848,first_prior_anomaly_auc= 0.6235636806169051, first_prior_star_anomaly_auc= 0.7687755095578712


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.705290683621848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6379113061632464 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7771154660088935 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.705290683621848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6479619796102968 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7842908092236018 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.705290683621848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6545570216130009 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7896870405377022 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.705290683621848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6598607931486882 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7943120348645136 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.705290683621848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6638536623465996 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7981003526348398 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.705290683621848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6661420946361718 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8008454370149424 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.705290683621848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6679818436859787 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8031124958968334 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.705290683621848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6696724010727868 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8052295715080336 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.705290683621848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6713717189180517 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8072564038423581 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.705290683621848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6727857413511582 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8090631692383362 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.705290683621848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6743205631180478 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8108525192650926 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.705290683621848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6756068728435287 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8125274555934472 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.705290683621848 at iter 0
max_prior_anomaly= 0.6769758264120435 at iter 129
max_prior_star_anomaly= 0.8140832285772488 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.705290683621848
accuracies_anomaly['prior'][-1]= 0.6769758264120435
accuracies_anomaly['prior_star'][-1]= 0.8140832285772488



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 123.79855418205261 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.705290683621848
 first_prior_anomaly_auc= 0.6770876014181387
 first_prior_star_anomaly_auc= 0.8142150576448721


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7117022837354173; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6769674881443555; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8141754244864313 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7148092911522536; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6768533383151843; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8141680889218197 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7170067941049503; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6767448880613949; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8141369523526052 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7185012438795533; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6766597638475933; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8141626532156687 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7193967105006234 at iter 490
0.6770876014181387 at iter 0
0.8142150576448721 at iter 0
last anomaly aucs:
0.7193967105006234
0.6765907884307064
0.8142100969033362




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.6344358921051 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7194684829313549,first_prior_anomaly_auc= 0.6765835584137871, first_prior_star_anomaly_auc= 0.8142146354541031


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.719468482931355 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6805838687240023 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8173594289447659 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7194684829313549 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6811698695113881 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8184922723257116 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7194685357052011 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6817319637464787 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8194515953005945 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.719468482931355 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6823384935600075 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8202696954632436 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7194684829313549 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6829700381766003 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.820994385918249 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7194685357052011 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6836496597670141 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8216142675148479 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7194684829313549 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6842832625636057 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8221239045468891 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7194684829313549 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6850443669724382 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8224868302866992 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7194684829313549 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6858550260227836 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8227529160188678 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7194684829313549 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6867597808407719 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8228823174895693 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.719468482931355 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6877521930171758 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8229260142341618 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7194684829313549 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6889135342750298 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8229007883357135 iter_best_prior_star_anomaly= 1120
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7194685357052011 at iter 3
max_prior_anomaly= 0.6900847970159556 at iter 129
max_prior_star_anomaly= 0.8229418991618458 at iter 112
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7194684829313549
accuracies_anomaly['prior'][-1]= 0.6900847970159556
accuracies_anomaly['prior_star'][-1]= 0.8227876412096189



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.26919317245483 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.719468482931355
 first_prior_anomaly_auc= 0.6902102932220439
 first_prior_star_anomaly_auc= 0.8227731284019342


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7216165895640775; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6905486263495593; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.8237827448521752 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7224420780651841; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6907060507325538; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.8243675846149463 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.723075786409468; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.690802310227888; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.8247263412209124 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7235035184323213; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6908676442493923; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 400 
last prior star auc 0.824937753248494 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7237237964660521 at iter 490
0.6909326088539738 at iter 490
0.825052694685357 at iter 490
last anomaly aucs:
0.7237237964660521
0.6909326088539738
0.825052694685357




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.686842918395996 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7237363566414303,first_prior_anomaly_auc= 0.6909312367339745, first_prior_star_anomaly_auc= 0.8250701100545788


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7237363038675841 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.695611854694603 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8250486838730514 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7237363038675841 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6977097206258135 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8247244413624517 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7237363038675841 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7001121971968645 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8244745044271979 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7237363038675841 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.702901558833867 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8242769191473014 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7237363038675841 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7059418601091996 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8242197122981005 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7237363038675841 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.709502828150414 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8241434013166019 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7237363038675841 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7132615925669094 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8242056744550309 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7237363038675841 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7172838567971132 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8243664235903314 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7237363038675841 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7215084559533648 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8246815889993973 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7237363038675841 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7258873658356896 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8250624050730442 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7237363038675841 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7302877546733879 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8255604846327836 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7237363038675841 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7347507860664381 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8260851622109708 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7237363566414303 at iter 0
max_prior_anomaly= 0.7386223281921053 at iter 129
max_prior_star_anomaly= 0.8266012376522394 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7237363038675841
accuracies_anomaly['prior'][-1]= 0.7386223281921053
accuracies_anomaly['prior_star'][-1]= 0.8266012376522394



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.41502046585083 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7237363038675841
 first_prior_anomaly_auc= 0.7390074189472884
 first_prior_star_anomaly_auc= 0.8266484702445224


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.722212089643766; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7304201114794725; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8278339819239022 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.72138522902266; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7244286439549142; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8278494446608171 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7208000726168122; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7209579191905758; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8280150489899614 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7204435325123834; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7189458635331668; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8283105297544222 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7237363038675841 at iter 0
0.7390074189472884 at iter 0
0.8285774598681287 at iter 490
last anomaly aucs:
0.7202423586109501
0.7177948659491533
0.8285774598681287




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.45071887969971 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7202272652909579,first_prior_anomaly_auc= 0.7177094778661212, first_prior_star_anomaly_auc= 0.8286142960127248


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7202272652909579 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7264402246477082 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8298025519321033 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7202272652909579 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7343825301681692 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8300588217288922 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.720227265290958 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7390058885057507 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8305920486701518 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7202272652909579 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.743175919505108 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8311347749037141 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7202272652909579 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7469785389877344 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8316341210357605 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.720227265290958 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7505254691858789 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8320864984447548 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.720227265290958 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7537757575949481 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.832502514673768 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7202272652909579 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7567944743672153 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.832898846258176 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7202272652909579 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7595372894719343 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8332629330226009 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7202272652909579 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7620497467383124 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8335793650039739 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.720227265290958 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7643333766078871 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8338473505946029 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.720227265290958 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7664057527714185 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8340988707452406 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.720227265290958 at iter 6
max_prior_anomaly= 0.7681698768997265 at iter 129
max_prior_star_anomaly= 0.8342781962743776 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.720227265290958
accuracies_anomaly['prior'][-1]= 0.7681698768997265
accuracies_anomaly['prior_star'][-1]= 0.8342781962743776



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.89950656890869 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.720227265290958
 first_prior_anomaly_auc= 0.7683346368473327
 first_prior_star_anomaly_auc= 0.8342931840466774


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7181017458643776; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7401630606297609; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8310815788668189 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.717296786389414; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7314778576773808; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8311759912775387 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7169775573941963; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7273492013733867; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8318591487156429 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.716844883945035; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7250328517192136; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8326575642336869 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.720227265290958 at iter 0
0.7683346368473327 at iter 0
0.8342931840466774 at iter 0
last anomaly aucs:
0.7168933303357787
0.7236656924614672
0.8333116960564215




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.439645528793335 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7168915360250105,first_prior_anomaly_auc= 0.7235355521569198, first_prior_star_anomaly_auc= 0.8333627811394718


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7168915360250107 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7186112773487264 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8333416716010213 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7168915360250105 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7327683365367057 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8333693250963914 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7168915360250105 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7407905416602019 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8334434723501989 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7168915360250105 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7447804555227303 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8337906714838633 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7168915360250105 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7475813218581882 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8341233578098431 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7168915360250105 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7499083846031249 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8343910267573955 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7168915360250107 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.751866980354408 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8345574754680776 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7168915360250105 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7535300425673842 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.834688882344932 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7168915360250105 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7549357267328027 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8347429227633653 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7168915360250105 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7561123196321875 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8347191745326085 iter_best_prior_star_anomaly= 920
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7168915360250105 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.757114653291663 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8346871935818558 iter_best_prior_star_anomaly= 920
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7168915360250105 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7579636789281421 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8345936783265202 iter_best_prior_star_anomaly= 920
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7168915360250107 at iter 7
max_prior_anomaly= 0.7585627676293671 at iter 129
max_prior_star_anomaly= 0.834749097303362 at iter 92
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7168915360250105
accuracies_anomaly['prior'][-1]= 0.7585627676293671
accuracies_anomaly['prior_star'][-1]= 0.8344852808465769



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.68016648292542 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7168915360250105
 first_prior_anomaly_auc= 0.7586097363524195
 first_prior_star_anomaly_auc= 0.834478631341965


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7161495357484756; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7262160413493639; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8325837863968024 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7162783039330236; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7173651812939936; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8334036280963735 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7164791084175339; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7126948014595135; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8339254558868697 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7166603338051314; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7098149326764045; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8341782426098145 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7168915360250105 at iter 0
0.7586097363524195 at iter 0
0.834478631341965 at iter 0
last anomaly aucs:
0.7167306813420177
0.7079454191773824
0.8342054739144156




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.83187007904053 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.716739125157398,first_prior_anomaly_auc= 0.7077887336282337, first_prior_star_anomaly_auc= 0.8342018852928791


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7167391251573979 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7001875582491327 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8360524529811418 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.716739125157398 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7056384104939739 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8355338971691053 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.716739125157398 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7122396270366746 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8338979079391918 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.716739125157398 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7178520200245082 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8323885231661353 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.716739125157398 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7216835595748117 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8318279065987361 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.716739125157398 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7243319094949648 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8318479606602642 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.716739125157398 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7265506803076505 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8319840116355776 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.716739125157398 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7285546615666021 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.832172730909325 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.716739125157398 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7304633332594499 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8323898952861345 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.716739125157398 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.732244608887749 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8325959771552576 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.716739125157398 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7338926305545792 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8327804745213149 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.716739125157398 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7354498812060724 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.832957794644299 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.716739125157398 at iter 0
max_prior_anomaly= 0.736769913419228 at iter 129
max_prior_star_anomaly= 0.838354659244553 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7167391251573979
accuracies_anomaly['prior'][-1]= 0.736769913419228
accuracies_anomaly['prior_star'][-1]= 0.8330968009549955



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.52390646934509 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.716739125157398
 first_prior_anomaly_auc= 0.7368858047853213
 first_prior_star_anomaly_auc= 0.8331121053703721


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7187985717286285; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6957238407960828; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8260891202494303 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.718779995334792; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.6927006910207412; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8260448429925304 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.718572224702593; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.6917108647627974; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8260297496725383 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.718326879091952; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.6914666801767713; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8260404627633019 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7188318192516879 at iter 150
0.7368858047853213 at iter 0
0.8331121053703721 at iter 0
last anomaly aucs:
0.7181131450151408
0.6914612972444664
0.8260419932048395




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.66587781906128 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7181214832828287,first_prior_anomaly_auc= 0.6914599778983133, first_prior_star_anomaly_auc= 0.8260352381525353


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7181214305089827 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6880284641016466 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8327681782151675 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7181214305089827 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.689577059842375 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8319895001155746 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7181214305089827 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6909583097170372 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8295756243937604 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7181214305089826 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6918517709319544 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8261162987801853 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7181214305089826 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.692488276290083 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8226427242281562 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7181214305089827 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6928542101391224 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8203376681770542 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7181214305089827 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.693127842531287 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8189044888378039 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7181214832828289 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6933566171542442 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8179483850675346 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7181214305089826 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6935093446649335 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8171913970186999 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7181214305089826 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6936435485556326 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8165564221021089 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7181214305089826 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6937949567201688 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8159685214562626 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7181214305089827 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6938932216216558 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.815453237622686 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7181214832828289 at iter 1
max_prior_anomaly= 0.6939635163846959 at iter 128
max_prior_star_anomaly= 0.8360421620811472 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7181214305089827
accuracies_anomaly['prior'][-1]= 0.6939470509447045
accuracies_anomaly['prior_star'][-1]= 0.8149555802537155



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.67715835571289 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7181214832828287
 first_prior_anomaly_auc= 0.6939396626062468
 first_prior_star_anomaly_auc= 0.8149054978737418


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7226597174066087; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6456257869899804; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7576229182037049 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.723372164329313; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6436883007771477; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.75563519128936 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7231664518771129; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6438113693863141; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7566720390442023 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7232402297139975; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6422045113194622; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7553207119402938 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7233878909354587 at iter 420
0.6939396626062468 at iter 0
0.8149054978737418 at iter 0
last anomaly aucs:
0.7231817562924896
0.6454243492193165
0.7560235540230031




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.72855734825134 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7230731477171618,first_prior_anomaly_auc= 0.6424402520901082, first_prior_star_anomaly_auc= 0.7557137715462421


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7230731477171617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6744462176456743 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8209309517552053 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7230731477171618 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6726804047542901 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8183282512119514 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7230731477171618 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6707066629091687 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8155556188841709 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7230731477171617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6690996465207786 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.813009808547041 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7230731477171617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6678241554337535 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8109322077727431 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7230731477171618 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6669396657726778 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8094769161919659 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7230731477171618 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6664184184944889 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8084921562232502 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7230731477171618 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6661047835269606 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8078720635312668 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7230731477171617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6659136366562913 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8074594248284057 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7230731477171617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6657836546732825 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.80718104279009 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7230731477171617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6657642866717541 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8070457306486223 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7230731477171618 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6657420161086888 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8069341139640652 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7230731477171618 at iter 0
max_prior_anomaly= 0.6745389940671642 at iter 9
max_prior_star_anomaly= 0.821503547985675 at iter 7
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7230731477171617
accuracies_anomaly['prior'][-1]= 0.6657591676086798
accuracies_anomaly['prior_star'][-1]= 0.8068723157902514



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.97936511039734 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7230731477171617
 first_prior_anomaly_auc= 0.6657570566548348
 first_prior_star_anomaly_auc= 0.8068647163564092


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7214670284841558; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6845795877096046; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.8251133846084022 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7212355623950459; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6845488205573129; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.8250323239807523 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7211407277935572; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6845290303650156; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.824992057536158 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7210943395828122; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6845533063342336; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.8249926380484653 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7230731477171617 at iter 0
0.6858850015673834 at iter 10
0.8266201306891525 at iter 10
last anomaly aucs:
0.7210599310351379
0.684533780011167
0.8249811333500099




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.61250019073486 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7210429906305313,first_prior_anomaly_auc= 0.6845153091650228, first_prior_star_anomaly_auc= 0.8250125337884551


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7210429906305313 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6847333179233703 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8303658071918086 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7210429906305313 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6853438057753586 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8291921696278072 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7210429906305313 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6861730412195404 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8267313251829405 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7210429906305313 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.686774451969995 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8232359022586151 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7210429906305313 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6871163209452007 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8192416609407044 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7210429906305313 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6873819844866003 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8159949083793258 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7210429906305313 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6876136088972483 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8138513930712161 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7210429906305313 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6878409058525139 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8126095716980195 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7210429906305313 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6880828211631567 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8117959045384453 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7210429906305313 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6882843117076667 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8111316929111003 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7210429906305313 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6885101309952409 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8106080180359896 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7210429906305313 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6887478771720397 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8101134743239407 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7210430434043775 at iter 5
max_prior_anomaly= 0.6889415571873229 at iter 129
max_prior_star_anomaly= 0.8349348612417263 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7210430434043775
accuracies_anomaly['prior'][-1]= 0.6889415571873229
accuracies_anomaly['prior_star'][-1]= 0.8097295445933723



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.75195693969727 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7210429906305313
 first_prior_anomaly_auc= 0.6889560699950076
 first_prior_star_anomaly_auc= 0.8096878004810865


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7218457336039577; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5766800290045059; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6568659301548702 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7222376321852911; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.5747317769270633; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6563530739182153 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7228568804957363; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5772834979349595; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6569240869333013 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7231452367909701; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5686660038271594; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6502210696414228 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7236827911876121 at iter 270
0.6889560699950076 at iter 0
0.8096878004810865 at iter 0
last anomaly aucs:
0.7227455276804101
0.5713461236026806
0.653953394361009




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.83044791221619 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7220521848900034,first_prior_anomaly_auc= 0.5729785769849035, first_prior_star_anomaly_auc= 0.6509059686164492


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7220521848900033 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6491294954081477 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7861455988195547 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7220521848900033 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6502840288398515 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7890488991903437 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7220521848900036 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6513909602623493 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.790852075964785 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7220521848900033 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6522262646988355 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7921432936579558 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7220521848900033 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.652843929793897 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.793137447371282 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7220521848900036 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6533246995321071 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.793927946812407 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7220521848900036 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.653746520884194 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7945735292720693 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7220521848900033 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6541115575778493 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7951127196579411 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7220521848900033 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6544227121746096 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7955638304946282 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7220521848900033 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.654719670606762 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7959868656451762 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7220521848900036 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6549830648727781 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7963648319311323 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7220521848900033 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6552607080772482 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7967126115771042 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7220521848900036 at iter 1
max_prior_anomaly= 0.6554910131417431 at iter 129
max_prior_star_anomaly= 0.7970085673061802 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7220521848900033
accuracies_anomaly['prior'][-1]= 0.6554910131417431
accuracies_anomaly['prior_star'][-1]= 0.7970085673061802



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.46186256408691 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7220521848900034
 first_prior_anomaly_auc= 0.6555087451540416
 first_prior_star_anomaly_auc= 0.7970395983277024


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7194644193452033; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6834011477256056; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.8290686788278718 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7185961312548881; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6838957442115008; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.8289397523217853 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7181980053597117; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6844329291912198; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.8289464546002434 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7179729776798296; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6850029395032292; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.8290104165017484 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7220521848900034 at iter 0
0.6854604359752976 at iter 490
0.8301205671288601 at iter 20
last anomaly aucs:
0.7178282717937514
0.6854604359752976
0.8290832444094026




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.74443292617798 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.717823099956831,first_prior_anomaly_auc= 0.685514106976808, first_prior_star_anomaly_auc= 0.829099709849394


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.717823099956831 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6892596251579257 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.830546135424022 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.717823099956831 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6903820193173387 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8302271175241889 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.717823099956831 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6932162387235484 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8293402530400374 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.717823099956831 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6963472582403722 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8274586015564064 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.717823099956831 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6992484476573162 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8247809093778069 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.717823099956831 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7019690449728162 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8221098139299734 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.717823099956831 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.7041334059501456 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8202358146540305 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.717823099956831 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.7056556147678109 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8190329931531212 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.717823099956831 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.706717424551871 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8182775883196701 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.717823099956831 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.7074743598268596 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8176302643230857 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.717823099956831 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.7080030482173523 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8170193542803282 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.717823099956831 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.7083491918740944 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.816435622768326 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7178230999568311 at iter 63
max_prior_anomaly= 0.7085659868339809 at iter 129
max_prior_star_anomaly= 0.8374584010157909 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.717823099956831
accuracies_anomaly['prior'][-1]= 0.7085659868339809
accuracies_anomaly['prior_star'][-1]= 0.8159277800470532



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 124.73839831352234 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7178230999568311
 first_prior_anomaly_auc= 0.7085828216908951
 first_prior_star_anomaly_auc= 0.8158776448932332


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7201426160417715; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5718287931993511; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6605920803344596 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.720095541771027; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5723373747544697; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6593747987997116 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7196075947897436; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.570356455666275; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6583678738156229 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.719425894437531; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5689619595562353; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6568213890287395 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7205556769354016 at iter 270
0.7085828216908951 at iter 0
0.8158776448932332 at iter 0
last anomaly aucs:
0.7200716879925778
0.5713171507611572
0.6589081724522634




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 59.792651414871216 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.719717258841994,first_prior_anomaly_auc= 0.570466753004679, first_prior_star_anomaly_auc= 0.6563623621151335


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.719717258841994 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6632436494592263 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8070964990885958 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7197173116158402 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6609241333742858 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8069253007317623 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.719717258841994 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6601431332254636 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8062730159936418 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.719717258841994 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6597159817149179 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8059089292292169 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7197173116158402 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6595217739611733 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8057358837877691 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.719717258841994 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6594758607150434 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8057174129416247 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.719717258841994 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6594816658381173 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8057858078462043 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7197173116158402 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6595458916088529 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8058756817061573 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.719717258841994 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6596405678888034 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8059876150337911 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.719717258841994 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6597415242564428 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8061128473706487 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.719717258841994 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6598251180287069 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8061958606306052 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.719717258841994 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6599501392701799 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8062978197013211 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7197173116158402 at iter 1
max_prior_anomaly= 0.6643229801602003 at iter 9
max_prior_star_anomaly= 0.8074117700453538 at iter 13
last values
accuracies_anomaly['vanilla_star'][-1]= 0.719717258841994
accuracies_anomaly['prior'][-1]= 0.6600497762916663
accuracies_anomaly['prior_star'][-1]= 0.8063769276966644



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 125.0083978176117 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5176841464199806
accuracies_anomaly["prior"][-1]= 0.67605302293868
accuracies_anomaly["prior_star"][-1]= 0.517847745342972


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 2761.1140637397766 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.005674123764038086 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5242372859888604
 first_prior_anomaly_auc= 0.6798939034597478
 first_prior_star_anomaly_auc= 0.5244012543287747


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5331446668334321; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6876720295449099; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 90 
last prior star auc 0.5340468357329601 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5664597931898518; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6867927644946006; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 90 
last prior star auc 0.5708770168844643 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6397700537976587; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6864423989301686; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 90 
last prior star auc 0.6507682816519058 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6931388722651273; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6864368049024793; count_not_improved_prior_anomaly= 31; iter_best_prior_anomaly= 90 
last prior star auc 0.7109557976819616 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7073236377223231 at iter 490
0.6877391051033366 at iter 90
0.7291081008909281 at iter 490
last anomaly aucs:
0.7073236377223231
0.6864921118932195
0.7291081008909281




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.27059531211853 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7080637381403975,first_prior_anomaly_auc= 0.6864944867162952, first_prior_star_anomaly_auc= 0.7300785591473434


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7080637381403975 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6865407693793478 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7299896352166209 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7080637381403975 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6865146463255155 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7298796545212937 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7080637381403975 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.686425458525562 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7297570608767424 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7080637381403975 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6863425508132976 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.729620218293737 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7080637381403975 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.686259854196418 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7294710794045843 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7080637381403975 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6861730412195403 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7293074277077469 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7080637381403975 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6860544583872947 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7291406095801418 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7080637381403975 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6858884846412275 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7289430770740912 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7080637381403975 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6857009263920948 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7287384728726598 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7080637381403975 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6854545780783776 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7285187753512363 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7080637381403975 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6850896997062608 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7282931143852005 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7080637381403975 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6845498232603892 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7280502491453276 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7080637381403975 at iter 0
max_prior_anomaly= 0.6865407693793478 at iter 10
max_prior_star_anomaly= 0.7300785591473434 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7080637381403975
accuracies_anomaly['prior'][-1]= 0.6838535779084458
accuracies_anomaly['prior_star'][-1]= 0.727819205246987



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.48111343383789 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7080637381403975
 first_prior_anomaly_auc= 0.6837765280931015
 first_prior_star_anomaly_auc= 0.727794137670077


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7112312243848944; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6836051186408836; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7326035765890996 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7121238412182738; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6834628403517271; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7344286017358373 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7124897750673131; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.6833993534148374; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.735097351913949 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7115615886616447; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.6833844184163835; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7344189968958423 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7125376937195956 at iter 280
0.6837765280931015 at iter 0
0.735097351913949 at iter 300
last anomaly aucs:
0.7102496836207924
0.6834064251102181
0.7332957055810453




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.35033321380615 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.710121073757783,first_prior_anomaly_auc= 0.6834120719117537, first_prior_star_anomaly_auc= 0.7331855665641799


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.710121073757783 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6823219753461701 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.732765908939784 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7101210737577828 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6806303097085934 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.732332846758472 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7101210209839368 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6780833911206948 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7318736087494816 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.710121073757783 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6744209917472259 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7313985913604992 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7101210737577828 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6693644656806401 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7308911708299953 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7101210209839368 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6621812591628591 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7303649100364245 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.710121073757783 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6526863470893641 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7298270389967059 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.710121073757783 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6410988464692714 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7292611450446942 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7101210209839368 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6268860580997826 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7286841685849961 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.710121126531629 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.609645845273416 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7281103057822192 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.710121126531629 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5904032871773275 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7275555471117402 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.710121073757783 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5694270026882997 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7270069629812579 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.710121126531629 at iter 12
max_prior_anomaly= 0.6834120719117537 at iter 0
max_prior_star_anomaly= 0.7331855665641799 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.710121073757783
accuracies_anomaly['prior'][-1]= 0.5510912048163523
accuracies_anomaly['prior_star'][-1]= 0.7265045031922899



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.50071883201599 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7101210737577828
 first_prior_anomaly_auc= 0.5493525176818771
 first_prior_star_anomaly_auc= 0.7264515182507791


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7087648914600307; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5491150881481551; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7251093737960967 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7077620828359399; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5489015651667284; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7240848751212479 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7070950214209042; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5487752245791022; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7233546961862451 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7065133480889008; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5487032938268321; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7227001949465877 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7101210737577828 at iter 0
0.5493525176818771 at iter 0
0.7264515182507791 at iter 0
last anomaly aucs:
0.7060249789168485
0.5487052464591389
0.7221756229160927




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.29758286476135 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7059768491691814,first_prior_anomaly_auc= 0.5487011828729871, first_prior_star_anomaly_auc= 0.7221294985745785


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7059768491691814 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5311612673744694 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7217292617255571 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7059768491691814 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5170954541664424 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7212345596919696 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7059768491691814 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5057592098277567 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7209410843336616 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7059768491691814 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4968825961354768 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7207324693199245 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7059768491691814 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4905989725987636 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7208122106014213 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7059768491691814 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48709563359751923 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.721344276518066 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7059767963953353 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4865283147516621 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7224103082098161 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7059767963953353 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48942559890399273 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7243708038195599 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7059768491691814 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4968180009478183 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7275945469840275 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7059768491691814 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5064431588735527 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.732258382861588 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7059768491691814 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5171495473587218 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7381956516461745 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7059768491691814 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5325131749906854 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7451250687379346 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7059768491691814 at iter 0
max_prior_anomaly= 0.5522428356865191 at iter 129
max_prior_star_anomaly= 0.75217211873271 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7059767963953352
accuracies_anomaly['prior'][-1]= 0.5522428356865191
accuracies_anomaly['prior_star'][-1]= 0.75217211873271



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 121.39278411865234 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7059767963953352
 first_prior_anomaly_auc= 0.5545447780806997
 first_prior_star_anomaly_auc= 0.7528923234107947


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7055025706140449; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5545309513330146; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7524458038987206 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7051496719049986; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5545071503284117; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7520800283712197 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7048226851544005; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5544875712314988; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7517935191606003 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7045608741037681; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5545020840391836; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7515708663037937 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7059767963953352 at iter 0
0.5545447780806997 at iter 0
0.7528923234107947 at iter 0
last anomaly aucs:
0.7043600696192578
0.5545442503422384
0.7513706423315907




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.24820423126221 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7043321522546571,first_prior_anomaly_auc= 0.5545519025499267, first_prior_star_anomaly_auc= 0.751356551714675


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7043322050285032 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5813116200620831 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7597328693456782 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7043322050285031 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6054708007586768 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7680355146874891 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.704332152254657 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6235546562892176 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7752001975852798 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7043322050285032 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6347730038556572 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7808454159054039 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.704332152254657 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6409162489616745 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7848146424202508 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7043322050285031 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6455069402885041 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7882526473999909 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.704332152254657 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6488527493590617 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7911634416569299 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7043321522546571 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6534979560689396 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7947642011781234 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.704332152254657 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6563979316874226 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7975358835766735 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7043321522546571 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6583892999971501 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7996854678770875 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.704332152254657 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6602840921684667 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8017859725006042 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7043321522546571 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6634614998960355 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.804664838580637 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7043322050285032 at iter 1
max_prior_anomaly= 0.6647480207169011 at iter 129
max_prior_star_anomaly= 0.8061306321567931 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7043321522546571
accuracies_anomaly['prior'][-1]= 0.6647480207169011
accuracies_anomaly['prior_star'][-1]= 0.8061306321567931



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.78828310966492 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7043321522546571
 first_prior_anomaly_auc= 0.664852935123
 first_prior_star_anomaly_auc= 0.8062638333444159


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7091656032736672; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6649718873721685; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.8061165943137237 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7122299166489874; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6651622426351459; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.8060175905783908 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7135706362098246; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6653382961858232; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.8059244975138242 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7151517934136129; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6655055892780433; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.8058896667753808 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.715998760870093 at iter 490
0.6656346741056679 at iter 490
0.8062638333444159 at iter 0
last anomaly aucs:
0.715998760870093
0.6656346741056679
0.8058920943723026




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.851802349090576 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7160687917639025,first_prior_anomaly_auc= 0.6656529866302738, first_prior_star_anomaly_auc= 0.8058899834184576


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7160687917639026 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6704096517031704 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8098850691179063 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7160687917639026 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.671612631525618 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8111822502556894 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7160688445377487 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.672971241420292 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8125138399411467 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7160687917639025 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.6742267312196352 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8136465777744002 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7160688445377487 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.6756191163758299 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8148251760799375 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7160687917639025 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.6770396827658562 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8158907855809187 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7160687917639025 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.6785047375081668 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8168858892234752 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7160687917639026 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.6799846744750848 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8177703788845508 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7160688445377486 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.6815524798958034 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8185683722118258 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7160687917639025 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.6833015634779653 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.819388213911397 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7160687917639026 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.6851113897570187 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8200852508710323 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7160687917639025 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.6870389544867797 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8207118347460891 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7160688973115947 at iter 13
max_prior_anomaly= 0.6890286868072774 at iter 129
max_prior_star_anomaly= 0.8212125002242888 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7160687917639026
accuracies_anomaly['prior'][-1]= 0.6890286868072774
accuracies_anomaly['prior_star'][-1]= 0.8212125002242888



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.83024311065674 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7160688445377487
 first_prior_anomaly_auc= 0.6892479093640858
 first_prior_star_anomaly_auc= 0.8212558275519586


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7195447939128534; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6896742164930935; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.8219143396039217 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7207724191214422; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6899487988144883; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.8223089824252539 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.721351770404216; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6901240079836275; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.8225703185112709 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7217274146409426; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6902613783050942; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.8227746588434717 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.721971335357738 at iter 490
0.6903755281342651 at iter 490
0.8229527178003017 at iter 490
last anomaly aucs:
0.721971335357738
0.6903755281342651
0.8229527178003017




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.2963171005249 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7219902811684973,first_prior_anomaly_auc= 0.6903824415081077, first_prior_star_anomaly_auc= 0.8229657001664488


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7219902811684974 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6970355347415507 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8251009299807165 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7219902811684975 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7002891479029256 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8255168934358834 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7219902811684973 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7038626233456718 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8259324347002814 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7219902811684975 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7078250420343685 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8263215890416165 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7219902811684975 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7120693258352252 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8267694278998438 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7219902811684975 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7164911936282969 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8272090340380752 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7219902811684973 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7210670027305188 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8276406185516958 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7219902811684974 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7256753732958006 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8281262434837495 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7219902811684975 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7303138777272205 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.828641527317326 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7219902811684973 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7348572309140746 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.829118075147846 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7219902811684975 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7393214233317397 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8296038056275918 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7219902811684975 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7436818623679202 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8300765537411907 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7219902811684975 at iter 3
max_prior_anomaly= 0.7473576135244591 at iter 129
max_prior_star_anomaly= 0.8304982167717394 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7219902811684974
accuracies_anomaly['prior'][-1]= 0.7473576135244591
accuracies_anomaly['prior_star'][-1]= 0.8304982167717394



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.67953515052795 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7219902811684974
 first_prior_anomaly_auc= 0.7476406396612342
 first_prior_star_anomaly_auc= 0.8305481408301748


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7217182319917166; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7389941199380645; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8316414038265261 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7209732763797987; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.731059466625292; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8310475925099137 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7203597804185811; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7258202375034171; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8305711502270858 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7198650256111476; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7224278819005762; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8303306070364425 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7221518219114897 at iter 20
0.7476406396612342 at iter 0
0.8317557647510816 at iter 70
last anomaly aucs:
0.7195224178020959
0.720412026526246
0.8301902813795928




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.265503883361816 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7194947115328796,first_prior_anomaly_auc= 0.7202391394063365, first_prior_star_anomaly_auc= 0.8301760852149848


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7194947115328796 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7432423617773809 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8337476080254245 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7194946587590335 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7510827610009722 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.834679277504937 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7194946587590335 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7578455182866655 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.835387819163028 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7194947115328796 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7633794365653093 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8359650594919568 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7194946587590335 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7679411550506154 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8364149037563369 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7194947115328797 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7716330550040689 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8367094873654135 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7194947115328797 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7747449176147487 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8369930940144958 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7194946587590335 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7773875151856742 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8372141108820725 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7194946587590334 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7796328312429613 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8373841482142914 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7194946587590335 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7815603431988761 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8375218879526809 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7194947115328797 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7831694177672652 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8376577278326098 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7194946587590335 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7846021221419004 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8377748857710101 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7194947115328797 at iter 3
max_prior_anomaly= 0.785756127835143 at iter 129
max_prior_star_anomaly= 0.8378707230755753 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7194947115328797
accuracies_anomaly['prior'][-1]= 0.785756127835143
accuracies_anomaly['prior_star'][-1]= 0.8378707230755753



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.88524270057678 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7194947115328796
 first_prior_anomaly_auc= 0.7858523873304772
 first_prior_star_anomaly_auc= 0.8378792724386478


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7169708023418923; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7488146994160045; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8332865229318194 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.715869201077853; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7355735831013922; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.831878411169479 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7156412180625876; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7287147774157492; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8315516882881113 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7154396219703855; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7242243563965596; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8315154854296689 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7194947115328796 at iter 0
0.7858523873304772 at iter 0
0.8378792724386478 at iter 0
last anomaly aucs:
0.7153680606350382
0.7214260759795618
0.8316220885988439




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.25994896888733 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7153693272073454,first_prior_anomaly_auc= 0.7211790416058448, first_prior_star_anomaly_auc= 0.8316282631388406


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7153693272073453 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7607272869282349 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8376863312572103 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7153693272073453 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7691885704515014 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8386880316305323 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7153693272073453 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.7734405592338925 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.838778169359716 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7153693272073454 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.7756193802450606 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8384380419214325 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7153693799811913 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.776749479386008 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8380135291031929 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7153693272073453 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.7772182694611474 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8376116034910954 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7153693799811913 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.7774105773564314 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8372170662174557 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7153693799811914 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.7774415028302615 iter_best_prior_anomaly= 770
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.836890712753011 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7153693272073454 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.7773608116195343 iter_best_prior_anomaly= 770
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8366293238931477 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7153693799811913 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.7773248726303223 iter_best_prior_anomaly= 770
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8363952718855779 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7153693272073453 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.7773112569780217 iter_best_prior_anomaly= 770
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8362095607210596 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7153693272073453 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.7772971663611061 iter_best_prior_anomaly= 770
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8360392595196102 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7153693799811914 at iter 21
max_prior_anomaly= 0.7774531130764092 at iter 77
max_prior_star_anomaly= 0.8388224466166159 at iter 26
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7153693272073453
accuracies_anomaly['prior'][-1]= 0.777316745458019
accuracies_anomaly['prior_star'][-1]= 0.835900358756606



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 121.13480925559998 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7153692216596531
 first_prior_anomaly_auc= 0.7773213367826318
 first_prior_star_anomaly_auc= 0.8358972978735306


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7148268120691674; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7151151155905552; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8261309699094084 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7151632453382223; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7037893204734025; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8260139175187003 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7152706401150892; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6994675118925862; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8259962382802482 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7152485278735623; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6979560689395307; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8260073207879346 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7153692216596531 at iter 0
0.7773213367826318 at iter 0
0.8358972978735306 at iter 0
last anomaly aucs:
0.7151713197366797
0.6976536220273812
0.8260342882233052




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.25858426094055 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.715156437512072,first_prior_anomaly_auc= 0.6976645462135294, first_prior_star_anomaly_auc= 0.8260490649002206


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.715156437512072 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7240829752627874 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8272153668996104 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.715156437512072 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7277362447608765 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8267231980106371 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.715156437512072 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7282419237544582 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8257611307957556 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.715156437512072 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7275865781332624 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8246702953963263 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.715156437512072 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7265944298260889 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8236645314368525 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.715156437512072 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7255876103896927 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8227586155942495 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.715156437512072 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7245546678994637 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8219917588361889 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.715156437512072 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7240708900520245 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8213691329995916 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.715156437512072 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7233286259062588 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8207727357645189 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.715156437512072 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7227722312465499 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8202451028509488 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.715156437512072 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7223497238344632 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8197962085157989 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.715156437512072 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7217991870716743 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8193387648175766 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.715156437512072 at iter 0
max_prior_anomaly= 0.7282588113852184 at iter 29
max_prior_star_anomaly= 0.8281689375252654 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.715156437512072
accuracies_anomaly['prior'][-1]= 0.7219264248146846
accuracies_anomaly['prior_star'][-1]= 0.8190838143669408



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 121.33574676513672 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.715156437512072
 first_prior_anomaly_auc= 0.7219074262300793
 first_prior_star_anomaly_auc= 0.8190540499177255


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7245044799717977; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6359499661719646; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7658285652163357 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7248550038577681; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6350811503431883; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7677691650860899 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.724711986734766; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.633427692970207; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7674659793400946 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7244466926102894; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6335879671408925; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.767402545177051 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.724867458485454 at iter 180
0.7219074262300793 at iter 0
0.8190540499177255 at iter 0
last anomaly aucs:
0.7242309003534793
0.6347058227495386
0.767880781770647




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.40486025810242 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7242686864273056,first_prior_anomaly_auc= 0.6369148831745368, first_prior_star_anomaly_auc= 0.7735004575492459


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7242686864273056 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6832807178087454 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8278097059546841 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7242686864273056 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6768039419952102 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8246018477179007 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7242686864273056 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.675932170831051 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8238079707506235 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7242686864273057 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6771035391196689 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8241528478350584 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7242686864273056 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6783591872405506 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8244732378548909 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7242686864273056 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.679495197052264 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8247173696670709 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7242686864273056 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6805474547701752 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8249169075792742 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7242686864273056 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6816034066573151 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8250486838730514 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7242686864273057 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6826308078937009 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8251201924345526 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7242686864273056 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6835670159239804 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8251541260176117 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7242686864273057 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6845217475742501 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8251719635776024 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7242686864273056 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.685402543066097 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.825154653756073 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7242686864273057 at iter 19
max_prior_anomaly= 0.6861636474749299 at iter 129
max_prior_star_anomaly= 0.8297371123629067 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7242686864273056
accuracies_anomaly['prior'][-1]= 0.6861636474749299
accuracies_anomaly['prior_star'][-1]= 0.8251404048176189



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 121.10699915885925 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7242686864273056
 first_prior_anomaly_auc= 0.6862259733872049
 first_prior_star_anomaly_auc= 0.8251408270083879


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7207337886660776; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6595445194888536; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8150717882628855 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7201170735002465; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6561277823691024; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.813037778685488 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.719886979531136; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.656572032605793; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8131043792792992 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7197613777773556; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6567861888733734; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8133986462452991 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7242686864273056 at iter 0
0.6862259733872049 at iter 0
0.8251408270083879 at iter 0
last anomaly aucs:
0.7196559356327954
0.6570889524285997
0.8133776950283871




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.3186309337616 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7195559819682323,first_prior_anomaly_auc= 0.6618892614722426, first_prior_star_anomaly_auc= 0.8167569627173887


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7195559819682322 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6772012235088486 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8260957169801961 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7195559819682323 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6688859124439674 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.822828699261905 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7195559819682323 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6627587633610185 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8169355494126799 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7195559819682323 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.661471820349384 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8143089423171307 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7195559819682323 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6615871312031698 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8134694687468007 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7195560347420784 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6620561851475399 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8131970501530968 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7195559819682323 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6626301007241627 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8131112398792957 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7195559819682323 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6632676087853677 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8131220057439054 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7195559819682323 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6639379949527094 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8131614278069617 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7195559819682322 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.664589540856984 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8132122490207813 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7195559819682323 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.665276814655086 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8132792718053616 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7195559819682323 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6659224498885943 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8133596463730118 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7195560347420784 at iter 6
max_prior_anomaly= 0.6790323176478907 at iter 6
max_prior_star_anomaly= 0.8320677109555338 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7195559819682322
accuracies_anomaly['prior'][-1]= 0.6665177916467445
accuracies_anomaly['prior_star'][-1]= 0.8134372767006637



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.95201635360718 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7195559819682322
 first_prior_anomaly_auc= 0.6665609078790298
 first_prior_star_anomaly_auc= 0.8134447705868134


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7172558866586661; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6401192583374762; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8146880168538555 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7170980928587487; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6424048936132035; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8170602012372301 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7169986669326469; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6425906047777219; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8173694559755298 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.716950642732672; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6424267419854999; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8173700892616834 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7195559819682322 at iter 0
0.6665609078790298 at iter 0
0.8175973334431029 at iter 450
last anomaly aucs:
0.716923094784994
0.642323991307092
0.8174434449077987




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.33594632148743 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7172261222094509,first_prior_anomaly_auc= 0.6425471191285138, first_prior_star_anomaly_auc= 0.8181473424674307


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7172261222094509 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6789249228710239 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8330526292457879 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7172261222094509 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6733529018754769 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8314971201312169 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7172261222094509 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6694141786436909 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8297814951674989 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7172261222094509 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6692320033268633 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8286981008803732 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7172261222094509 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.670185837821749 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8278970466700231 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7172261222094509 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.671399002996499 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8272468728857477 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7172261222094509 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.6726601395973777 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8266130062199255 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7172261222094509 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.6739340474690191 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8260141813879309 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7172261222094509 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.6752136549160421 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8254206867143953 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7172261222094509 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.6764327835354043 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8248436047070048 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7172261222094509 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.6775999299163323 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8242909569903709 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7172261222094509 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.6787263348880508 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.823724957490667 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.717226122209451 at iter 65
max_prior_anomaly= 0.6809158689899825 at iter 6
max_prior_star_anomaly= 0.8339779658637654 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7172261222094509
accuracies_anomaly['prior'][-1]= 0.6796418027968028
accuracies_anomaly['prior_star'][-1]= 0.8232601782278332



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.74334192276001 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.717226122209451
 first_prior_anomaly_auc= 0.6797327321336784
 first_prior_star_anomaly_auc= 0.823219120175547


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7160044604454746; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6302704448518586; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8175815540631112 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7159930085208653; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6288023820003188; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8194562921728998 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7160002913116306; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6342176646728708; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8206545223491961 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.715936962696279; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6313189028528485; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8207803351983611 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.717226122209451 at iter 0
0.6797327321336784 at iter 0
0.823219120175547 at iter 0
last anomaly aucs:
0.7158542660793993
0.6306909468577924
0.819702640486617




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.3591091632843 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7158061363317322,first_prior_anomaly_auc= 0.639985846054469, first_prior_star_anomaly_auc= 0.8211346060274065


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7158061891055782 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6711939766042986 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.83460444419113 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7158061363317322 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6665736791497922 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8339498374037801 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7158061891055782 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6637901226358636 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8338078229838544 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7158061891055782 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.663173249148494 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8339784408283805 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7158061891055782 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6635310030513838 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8342129150267195 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7158061891055782 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6641244977249194 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8343605762481806 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7158061363317322 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6646896000692393 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8343949847958549 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7158061891055782 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.665234595578185 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8343300201912736 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7158061891055782 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6657091907763983 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8342663749328453 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7158061891055782 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6661350757146371 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.834146261659062 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7158061891055782 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6665608023313374 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8339763826483816 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7158061891055782 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6669237808449937 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8338329961084566 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7158061891055784 at iter 9
max_prior_anomaly= 0.6730372615017959 at iter 6
max_prior_star_anomaly= 0.8351218389785516 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7158061363317322
accuracies_anomaly['prior'][-1]= 0.6672769961971167
accuracies_anomaly['prior_star'][-1]= 0.8336871291977637



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 121.66872429847717 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7158061363317322
 first_prior_anomaly_auc= 0.6673050718832558
 first_prior_star_anomaly_auc= 0.8336754134039235


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7162871171653267; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6418961009627006; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.8258113714972679 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7162510726284226; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.649127912192764; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.8296918324029305 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7161430973392482; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6510244459010026; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.8316268910188414 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.716123782111566; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6493073960434391; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.8295626420276134 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7164947822498335 at iter 70
0.6833955536979162 at iter 10
0.8336754134039235 at iter 0
last anomaly aucs:
0.7160763384238985
0.6532350895413848
0.8318469579571877




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.28604078292847 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7159615025347279,first_prior_anomaly_auc= 0.6629399887486159, first_prior_star_anomaly_auc= 0.8336017938885776


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.715961555308574 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6778058006900708 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8345783739111436 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7159615025347279 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.673826124953691 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8342283777636343 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7159615025347279 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.669324252009892 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8338943720915015 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7159615025347278 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6666344746205296 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8335976247547335 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7159615025347279 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6654682253949858 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8333602479948578 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7159615025347279 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6648574736737669 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8330093019181182 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7159614497608817 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6644362856078333 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.832623314007551 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7159615025347279 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6640546251526485 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8322265602323738 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.715961555308574 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.66370747879283 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8318169824125881 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.715961555308574 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6633733675730047 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8314200703158725 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.715961555308574 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6630218409839578 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8310137117007005 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7159615025347278 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6626785471149066 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8306196493916759 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.715961555308574 at iter 4
max_prior_anomaly= 0.6796280815968099 at iter 2
max_prior_star_anomaly= 0.8370121981467936 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7159615025347279
accuracies_anomaly['prior'][-1]= 0.6623574182612284
accuracies_anomaly['prior_star'][-1]= 0.8302570930687886



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 121.0971999168396 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7159614497608817
 first_prior_anomaly_auc= 0.6623265455612445
 first_prior_star_anomaly_auc= 0.8302237399980369


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7155214214318811; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6515992586330097; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.834396673558931 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7153770321888798; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6518131510313593; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.8337385836977367 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7154281172719299; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6545049866007204; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.8347112584556895 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7153757656165726; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6518280332559668; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.8339270918760997 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7159614497608817 at iter 0
0.6623265455612445 at iter 0
0.8370556310221555 at iter 380
last anomaly aucs:
0.7153825206688769
0.6545214520407119
0.8340162796760531




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.26720213890076 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7158629737640101,first_prior_anomaly_auc= 0.6539526555271633, first_prior_star_anomaly_auc= 0.8342713356743812


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7158629737640101 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.678155374646811 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8366134389654637 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7158629737640101 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6752519159544836 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8354206444953185 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7158629737640101 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6718629906516408 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8330285643719544 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7158629737640101 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6701852573094416 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8306808142793362 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7158629737640101 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6696884970958553 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8289358998310181 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7158629737640101 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6694315940129126 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8274368059579561 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7158629737640101 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6692332698991702 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8260912312032754 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7158629737640103 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6690674544746417 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8248651364362244 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7158629737640103 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6689247012208702 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8237965188260141 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.7158629737640101 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6688262779978447 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8228069036634549 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.7158629737640101 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6687082229040603 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8218896414439346 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.7158629737640101 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.66859855885181 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8210607226428299 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.7158629737640103 at iter 18
max_prior_anomaly= 0.6788349962372249 at iter 5
max_prior_star_anomaly= 0.8370375295929342 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7158629737640101
accuracies_anomaly['prior'][-1]= 0.6685405603949173
accuracies_anomaly['prior_star'][-1]= 0.820390283701642



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 121.45449304580688 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5242372859888604
accuracies_anomaly["prior"][-1]= 0.6798939034597478
accuracies_anomaly["prior_star"][-1]= 0.5244012543287747


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 2690.371561765671 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0058135986328125 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4919615933057432
 first_prior_anomaly_auc= 0.6755504048281736
 first_prior_star_anomaly_auc= 0.49212735595642565


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7109198586927497; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.691888395981166; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.7376382542833892 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.706737531387245; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6927785852176235; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 200 
last prior star auc 0.7349105324986622 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7064616297196971; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6936096677464195; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 300 
last prior star auc 0.7352479156969473 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7073689176822993; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6942608970076174; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 400 
last prior star auc 0.7364616086101585 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7079028306835584; count_not_improved_vanilla_star_anomaly= 44 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.694722668161222; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 500 
last prior star auc 0.7374815159603942 ; count_not_improved_prior_star_anomaly= 42 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7074004764422828; count_not_improved_vanilla_star_anomaly= 54 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6950697617471943; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 600 
last prior star auc 0.7374510654511794 ; count_not_improved_prior_star_anomaly= 52 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7070396088824715; count_not_improved_vanilla_star_anomaly= 64 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6953397527439762; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 700 
last prior star auc 0.7373814039742927 ; count_not_improved_prior_star_anomaly= 62 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7073663845376853; count_not_improved_vanilla_star_anomaly= 74 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6955255166823404; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 800 
last prior star auc 0.7378787974740327 ; count_not_improved_prior_star_anomaly= 72 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.70749546936531; count_not_improved_vanilla_star_anomaly= 84 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6956611454668848; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 900 
last prior star auc 0.7382197165200082 ; count_not_improved_prior_star_anomaly= 72 ; iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7124351013627261 at iter 60
0.6957588298560646 at iter 990
0.7384826885952552 at iter 990
last anomaly aucs:
0.7076120995652491
0.6957588298560646
0.7384826885952552




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 119.03191757202148 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7076265595990876,first_prior_anomaly_auc= 0.695766534837599, first_prior_star_anomaly_auc= 0.7385029009783215


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7076265595990876 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7858473210412491 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8325186106968364 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7076265595990876 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.826076876717129 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.836238533562583 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7076265595990876 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.8276944478747444 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8326774599736765 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7076266123729338 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.8245904485671374 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8284942882866337 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7076265595990876 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.8171060089356676 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.829021499009435 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7076265595990876 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.8163254837514606 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8268950824274702 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7076265595990876 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.809754928813359 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.817576435000037 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7076266123729338 at iter 5
max_prior_anomaly= 0.8277152407701183 at iter 27
max_prior_star_anomaly= 0.8384225264106713 at iter 13
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7076265595990876
accuracies_anomaly['prior'][-1]= 0.8155315012364912
accuracies_anomaly['prior_star'][-1]= 0.8226705888189108



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 76.7497673034668 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7076265595990876
 first_prior_anomaly_auc= 0.8063176098936184
 first_prior_star_anomaly_auc= 0.8164688175175394


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.2907240993879289; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.761876120784557; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.3480162838979607 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.2906209792925982; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7267139098137189; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.30090470204414216 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.29153460011673576; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7135878932575079; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.30116266060400726 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 351


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 352 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7076265595990876 at iter 0
0.8092726814074573 at iter 10
0.8164688175175394 at iter 0
last anomaly aucs:
0.28982509691916836
0.7030522809384034
0.2994938460418032




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 42.0359148979187 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4919615933057432
accuracies_anomaly["prior"][-1]= 0.6755504048281736
accuracies_anomaly["prior_star"][-1]= 0.49212735595642565


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 237.9821207523346 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0059163570404052734 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49985925215238125
 first_prior_anomaly_auc= 0.6758716920033901
 first_prior_star_anomaly_auc= 0.500033036427675


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.706482950353532; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6912042886138315; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.7317919148356781 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7034121457951383; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6927234893222678; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 200 
last prior star auc 0.7306838223885654 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7035237624796953; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6941228933999973; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 300 
last prior star auc 0.7313471368605262 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7045255156268635; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6952513037778685; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 400 
last prior star auc 0.7328947826720242 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7056313915724388; count_not_improved_vanilla_star_anomaly= 45 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6961391709650964; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 500 
last prior star auc 0.7344386287666014 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7063681144643613; count_not_improved_vanilla_star_anomaly= 55 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6968285557170436; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 600 
last prior star auc 0.7356188630613686 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7068091982702844; count_not_improved_vanilla_star_anomaly= 65 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6973330209121643; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 700 
last prior star auc 0.736522456854742 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7072802576208073; count_not_improved_vanilla_star_anomaly= 75 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6977191143704239; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 800 
last prior star auc 0.737282822429729 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7077524252220987; count_not_improved_vanilla_star_anomaly= 85 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6980068901533503; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 900 
last prior star auc 0.7379850312262848 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7120671621075341 at iter 50
0.6981938151163295 at iter 990
0.7383968255476079 at iter 990
last anomaly aucs:
0.7080176137988832
0.6981938151163295
0.7383968255476079




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 116.82696533203125 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7080362957404118,first_prior_anomaly_auc= 0.6982084334717065, first_prior_star_anomaly_auc= 0.7384339783352807


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7080362957404118 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7995505251525429 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8334797279824875 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7080362957404117 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.8241397071473731 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8333038855271949 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7080362429665656 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.8236274314230256 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8285985694065792 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7080362957404118 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.821565821124104 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8248493570562325 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7080362429665656 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.8214582680256988 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.826658761144517 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7080362957404117 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.8222178419929937 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8241487842489068 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7080362957404118 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.8267247812260209 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8264865600846071 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7080362957404118 at iter 0
max_prior_anomaly= 0.8267247812260209 at iter 70
max_prior_star_anomaly= 0.8354721517691377 at iter 13
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7080362429665656
accuracies_anomaly['prior'][-1]= 0.8189479217131658
accuracies_anomaly['prior_star'][-1]= 0.825365801914424



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.44579982757568 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7080362957404118
 first_prior_anomaly_auc= 0.8154702835749849
 first_prior_star_anomaly_auc= 0.82320286583094


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.2895366350762424; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7462766468342553; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.32551752672203693 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.2905046657357361; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7006272171612103; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.2995712652740704 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 248


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 249 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7080362957404118 at iter 0
0.8154702835749849 at iter 0
0.82320286583094 at iter 0
last anomaly aucs:
0.28946612921781767
0.6880806046616195
0.2987575453406499




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 29.11690664291382 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.49985925215238125
accuracies_anomaly["prior"][-1]= 0.6758716920033901
accuracies_anomaly["prior_star"][-1]= 0.500033036427675


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on pieclam ACM 
took 221.55015397071838 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of pieclam on ACM on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.005708932876586914 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4866625186423611
 first_prior_anomaly_auc= 0.6631521923838896
 first_prior_star_anomaly_auc= 0.48685334886995374


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.703612686410418; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6869759425145049; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7301642110996065 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7020253546666329; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.688540317635225; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.7295499235306969 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7024488120079498; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6897398143838284; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.7309159745376748 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7033014790398116; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6906628817264224; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.7325563439968167 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7042270795270198; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 500 
last prior auc 0.6913851973583524; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 500 
last prior star auc 0.7338646604161323 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7049000516128215; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 600 
last prior auc 0.6919482942965194; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 600 
last prior star auc 0.7349037246725119 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7055666908370882; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 700 
last prior auc 0.6923855256116753; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 700 
last prior star auc 0.7357990857458896 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.7061506334444752; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 800 
last prior auc 0.6927495068284079; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 800 
last prior star auc 0.7366058923054677 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.7068648219041016; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 900 
last prior auc 0.693027519449801; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 900 
last prior star auc 0.7374401412650313 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.7071502228639521 at iter 990
0.6932359761419996 at iter 990
0.7379372708955405 at iter 990
last anomaly aucs:
0.7071502228639521
0.6932359761419996
0.7379372708955405




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 117.00443768501282 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.7071586666793322,first_prior_anomaly_auc= 0.6932514388789146, first_prior_star_anomaly_auc= 0.7379781706262883


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7071586666793322 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6920893060133688 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.735498644239893 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.7071586666793324 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.668183439778181 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.730753431091606 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.7071586666793322 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.520537417184642 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7279954698930484 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.7071586666793322 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6536206024873369 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8038661591933624 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.7071586666793322 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6833751302194654 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8239471881567045 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.7071586666793324 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7384566183152688 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8247067093501534 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.7071586666793324 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7919728869088143 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.8326878036475172 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.7071586666793324 at iter 1
max_prior_anomaly= 0.8094566510350534 at iter 79
max_prior_star_anomaly= 0.8367811542484529 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.7071586666793322
accuracies_anomaly['prior'][-1]= 0.8094566510350534
accuracies_anomaly['prior_star'][-1]= 0.8367811542484529



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 75.42126774787903 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.7071586666793324
 first_prior_anomaly_auc= 0.8100984865516407
 first_prior_star_anomaly_auc= 0.8368658562714857


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.7118186500661257; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7103985586407147; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.8237165664491328 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       
