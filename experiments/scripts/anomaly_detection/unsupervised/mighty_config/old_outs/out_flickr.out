

/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0035789012908935547 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.47774619033361176
 first_prior_anomaly_auc= 0.7143408922577493
 first_prior_star_anomaly_auc= 0.4812127897631467


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5856245961832421; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7607389255716469; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.656279212695211 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5850043336432544; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.7626020769970216; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6572921821075689 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5817608774445687; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.7657697338355106; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6549545361425847 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5803905006539862; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.7693612997778022; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6545251114928219 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5873205477725073 at iter 140
0.7721156058433271 at iter 490
0.6586825724506358 at iter 150
last anomaly aucs:
0.5802477268071292
0.7721156058433271
0.6552556849520148




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 53.549543619155884 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5802770379942324,first_prior_anomaly_auc= 0.7723497801660966, first_prior_star_anomaly_auc= 0.6553477157760373


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5802770379942324 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7778533495122681 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7648946530721591 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5802770379942324 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7737132231274721 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7583541610854594 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5802770379942324 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7749323163717163 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.756479190633027 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5802770379942324 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7755708590068865 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.752715382069748 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5802770379942324 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7771542934585625 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7494189766298438 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5802770379942324 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7779294640465197 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7459838946057961 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5802770379942324 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7773597869423389 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7437934349244371 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5802770379942324 at iter 0
max_prior_anomaly= 0.7987093622453 at iter 8
max_prior_star_anomaly= 0.7655325653592195 at iter 11
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5802770379942324
accuracies_anomaly['prior'][-1]= 0.7726873315788645
accuracies_anomaly['prior_star'][-1]= 0.7357943174117907



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 70.79493594169617 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5802770379942324
 first_prior_anomaly_auc= 0.7726246119419449
 first_prior_star_anomaly_auc= 0.7369708621586272


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5854421104054714; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7536694139338449; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.733802102210946 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.586328064673716; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7477302740438407; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7346618970326363 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5865578265597176; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.7446308523882313; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7345131348787368 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5868168996328222; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.7432242305813386; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7352686070882646 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5870718754432135 at iter 440
0.7726246119419449 at iter 0
0.7369708621586272 at iter 0
last anomaly aucs:
0.5870365759490679
0.7423143230849236
0.7352383503789968




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.19491267204285 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5871254550325418,first_prior_anomaly_auc= 0.7422430937485227, first_prior_star_anomaly_auc= 0.7356162440707881


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5871254550325418 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7459262177537545 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.745686685472052 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5871254550325418 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7450434152260587 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.737889436941551 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5871254550325418 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7350873820067132 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7393400255290985 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5871254550325418 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7464683171281339 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7323620719542367 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5871254550325418 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7461024000504279 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7335758072395481 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5871254550325418 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7340696849835322 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.72173314212774 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5871254550325418 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7337592385394834 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7211897820571411 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5871254550325418 at iter 0
max_prior_anomaly= 0.7594036906881826 at iter 3
max_prior_star_anomaly= 0.745686685472052 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5871254550325418
accuracies_anomaly['prior'][-1]= 0.7356058433269773
accuracies_anomaly['prior_star'][-1]= 0.7274869596734796



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.15023708343506 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5871254550325418
 first_prior_anomaly_auc= 0.7384981956285359
 first_prior_star_anomaly_auc= 0.7260125754447894


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5856923586050395; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6914994405660526; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7187846888444143 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.589479805222434; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6958543580692437; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7245277904722883 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5877261767811274; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 230 
last prior auc 0.7004812707817892; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7300502702617521 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5867046976692879; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 230 
last prior auc 0.6948037253573285; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7247528247474668 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5925284838552091 at iter 230
0.7384981956285359 at iter 0
0.735121263217612 at iter 310
last anomaly aucs:
0.5856699812471438
0.6981203019367446
0.7269554186299383




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.59560513496399 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5883722835936146,first_prior_anomaly_auc= 0.6910682824589879, first_prior_star_anomaly_auc= 0.7242770695116378


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5883722835936146 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7230010873504893 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7436985675339206 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5883722835936146 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7152210158059789 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7400066186551523 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5883722835936146 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6950486155979639 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7250928975526734 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5883722835936145 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6920437461588163 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7232237578202563 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5883722835936146 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6918486534188506 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7242718691397324 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5883722835936146 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6919157854925383 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7249929873772791 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5883722835936146 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.708799029263911 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7356074191972517 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5883722835936146 at iter 0
max_prior_anomaly= 0.7410027262555746 at iter 5
max_prior_star_anomaly= 0.7440840254030288 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5883722835936146
accuracies_anomaly['prior'][-1]= 0.6945426036528672
accuracies_anomaly['prior_star'][-1]= 0.7231930283499062



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.9830687046051 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5883722835936146
 first_prior_anomaly_auc= 0.6858668074444112
 first_prior_star_anomaly_auc= 0.718045290511685


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5825336842271145; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6780998156231779; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.7036747718927778 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5820580865783128; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6719907969175977; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.7004049986605102 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5833832358920213; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6880142458672802; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.712159730211009 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5817756906251478; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6698977260191941; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.7009004522747687 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5883722835936146 at iter 0
0.6914647714200166 at iter 10
0.718045290511685 at iter 0
last anomaly aucs:
0.5804667727752651
0.6738717556770727
0.7030625462911892




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.11289358139038 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.582534629749279,first_prior_anomaly_auc= 0.6733394266983942, first_prior_star_anomaly_auc= 0.7011718171360134


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.582534629749279 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7292853428305783 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7381877491844872 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.582534629749279 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7179293064594922 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7288961028728115 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.582534629749279 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6885639094189766 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7130343382132783 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.582534629749279 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6905391052208583 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7147911183951337 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.582534629749279 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7198830704256425 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7361621255338261 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.582534629749279 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7113503632380982 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7253403091857479 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.582534629749279 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6896107600422334 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7133167341664434 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.582534629749279 at iter 0
max_prior_anomaly= 0.7397951368643334 at iter 4
max_prior_star_anomaly= 0.7428753329025954 at iter 44
last values
accuracies_anomaly['vanilla_star'][-1]= 0.582534629749279
accuracies_anomaly['prior'][-1]= 0.6863494965094472
accuracies_anomaly['prior_star'][-1]= 0.7102069117670233



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.35514163970947 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.582534629749279
 first_prior_anomaly_auc= 0.7001582173755456
 first_prior_star_anomaly_auc= 0.7197176040468349


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5860081630080212; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7047559764880156; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 50 
last prior star auc 0.7229910017807334 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.587446932568511; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7118968750492459; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 50 
last prior star auc 0.7286423877586398 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5866801140930078; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7148888223521439; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 50 
last prior star auc 0.7283177584821218 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5825012212994626; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7033580219676318; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 360 
last prior star auc 0.7213111240682667 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5884034858250469 at iter 110
0.7199672218982933 at iter 360
0.7305933151582962 at iter 320
last anomaly aucs:
0.5826739366815323
0.7066826354854467
0.7209505649494934




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.100600242614746 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5820432733977339,first_prior_anomaly_auc= 0.7037631782151693, first_prior_star_anomaly_auc= 0.7199918054745733


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5820432733977339 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7337784641568307 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7385924326709425 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5820432733977339 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7238331468553509 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7263302708921002 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5820432733977339 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7042425579526295 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7139357360102117 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5820432733977339 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6977212915832769 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7118344705863814 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5820432733977339 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6939529129962021 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7090584175110705 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5820432733977339 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6951888680523819 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.710598673117229 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5820432733977339 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6944828781694692 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.711200970736089 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5820432733977339 at iter 0
max_prior_anomaly= 0.742815134658115 at iter 3
max_prior_star_anomaly= 0.7438652946089478 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5820432733977339
accuracies_anomaly['prior'][-1]= 0.6947714200167042
accuracies_anomaly['prior_star'][-1]= 0.7096036686259987



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.97918772697449 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5820432733977339
 first_prior_anomaly_auc= 0.7103386545219599
 first_prior_star_anomaly_auc= 0.720749483902485


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5899632822226075; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6978853396788377; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7128272688592275 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5918883653497644; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.7023203113919662; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7154035015837497 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.591510786832028; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.7068835589454278; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 260 
last prior star auc 0.7179920260964118 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5881567045400823; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.70297461272988; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 260 
last prior star auc 0.7134943347463637 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5948018343129993 at iter 160
0.7113695888554454 at iter 490
0.7221983390327309 at iter 260
last anomaly aucs:
0.5933113762075106
0.7113695888554454
0.7207360890051531




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.207810401916504 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5921097751233119,first_prior_anomaly_auc= 0.7093830467875883, first_prior_star_anomaly_auc= 0.7194503364483036


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5921099327103393 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7361343902169972 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7388362198023859 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5921099327103393 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7214048883495912 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7241188521360922 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5921099327103393 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7017266810596151 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7109753061128008 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5921099327103393 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6966008478182076 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7059983926123201 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5921099327103393 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7030702680555336 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7121657185180515 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5921099327103393 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6972655498999323 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7074463022204012 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5921099327103393 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6954186299383834 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7059277936240289 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5921099327103394 at iter 19
max_prior_anomaly= 0.746603211623619 at iter 3
max_prior_star_anomaly= 0.7526469892998409 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5921099327103393
accuracies_anomaly['prior'][-1]= 0.6978851820918103
accuracies_anomaly['prior_star'][-1]= 0.7073520651779945



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.27459502220154 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5921099327103393
 first_prior_anomaly_auc= 0.6981663173487559
 first_prior_star_anomaly_auc= 0.7066255889815151


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5928524827836172; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7017993286792631; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 30 
last prior star auc 0.7130828750177285 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5917301479742187; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.6955962305183038; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 180 
last prior star auc 0.7038615125202894 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5911221772223711; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.6997882030351262; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 250 
last prior star auc 0.7087356792788817 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5903169075121737; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.6988697858392297; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 250 
last prior star auc 0.7084110500023637 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5987121988117938 at iter 270
0.7147113793592511 at iter 480
0.7209604929322218 at iter 480
last anomaly aucs:
0.5952887782277763
0.7094126731487463
0.7158437997384056




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.746673822402954 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5960634760546512,first_prior_anomaly_auc= 0.7054786705958366, first_prior_star_anomaly_auc= 0.7142660384197173


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5960634760546512 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7285714735962936 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7346338465417527 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5960634760546512 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7063879477441418 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7149228611500701 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5960634760546512 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.704204106717935 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7117077706163228 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5960634760546512 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7109686874576484 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7178126920591897 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5960634760546512 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7044196857714672 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7117419670012766 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5960634760546512 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7298304363584789 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7348001008556975 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5960634760546512 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7262974927903935 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7303550435728132 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5960634760546512 at iter 0
max_prior_anomaly= 0.743759868887593 at iter 3
max_prior_star_anomaly= 0.7584613202641158 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5960634760546512
accuracies_anomaly['prior'][-1]= 0.7074661581858581
accuracies_anomaly['prior_star'][-1]= 0.7158890272152796



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.08979940414429 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5960634760546512
 first_prior_anomaly_auc= 0.702958696440109
 first_prior_star_anomaly_auc= 0.7100130797232771


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5921758040878076; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7000176497470728; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 80 
last prior star auc 0.709701372583009 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5761961643317522; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7086499519359566; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 110 
last prior star auc 0.7141349260128906 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5261257229304884; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7167663141970154; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 280 
last prior star auc 0.7157117418094142 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.41694659375640203; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7093713853475583; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 320 
last prior star auc 0.7007479080322108 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6075087066832658 at iter 20
0.7195264509825551 at iter 320
0.7208701955655011 at iter 110
last anomaly aucs:
0.43463447688986245
0.7177468206817215
0.7004330491513938




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.94574499130249 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43637203145437065,first_prior_anomaly_auc= 0.7116459965015679, first_prior_star_anomaly_auc= 0.6923091227130183


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43637203145437065 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7293102415809131 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7096701703515766 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43637203145437065 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7175446365255213 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.698453440912744 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43637203145437065 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.723628598893739 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7000781631656082 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43637203145437065 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7150520825125675 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6974754558204768 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43637203145437065 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7131985438958666 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6947633830783051 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43637203145437065 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7121209638022599 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6943262366641978 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43637203145437065 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7137611295838127 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6962175961674835 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.43637203145437076 at iter 8
max_prior_anomaly= 0.7475046094205524 at iter 2
max_prior_star_anomaly= 0.7137894952487511 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43637203145437065
accuracies_anomaly['prior'][-1]= 0.7099832957750918
accuracies_anomaly['prior_star'][-1]= 0.6930296106024552



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.80022501945496 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.47774619033361176
accuracies_anomaly["prior"][-1]= 0.7143408922577493
accuracies_anomaly["prior_star"][-1]= 0.4812127897631467


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 1049.5758202075958 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003197908401489258 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5036481396851411
 first_prior_anomaly_auc= 0.7248694391477695
 first_prior_star_anomaly_auc= 0.507275950643743


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5869086152827899; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7606180563216036; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6569056211292686 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5848215326914288; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.7619294955639252; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6564438911388815 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5816666404021621; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.7649031627716406; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6544614463337377 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5807015774461446; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.7681560741919726; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.654591298044345 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.587596640244575 at iter 130
0.7696870321635122 at iter 490
0.6579992750996737 at iter 140
last anomaly aucs:
0.5809250358510487
0.7696870321635122
0.6556581622200861




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.82710242271423 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5809798761365964,first_prior_anomaly_auc= 0.7698004948232661, first_prior_star_anomaly_auc= 0.6557804497533762


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5809798761365964 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7732171391651039 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7610366074664734 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5809798761365964 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7756518587389887 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7560696219487212 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5809798761365964 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7767855398143624 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7526482499960603 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5809798761365964 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7774165182722158 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7500858849299525 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5809798761365964 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7766222796539388 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7451729517626109 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5809798761365964 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7752928754904896 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.742586318294278 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5809798761365964 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7739458215799675 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7407986510550452 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5809798761365964 at iter 0
max_prior_anomaly= 0.783002820807791 at iter 8
max_prior_star_anomaly= 0.7624303071371166 at iter 12
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5809798761365964
accuracies_anomaly['prior'][-1]= 0.7738522148856706
accuracies_anomaly['prior_star'][-1]= 0.738416880722379



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.34061741828918 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5809798761365964
 first_prior_anomaly_auc= 0.7712063286950218
 first_prior_star_anomaly_auc= 0.7347636982523599


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5842501221299463; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7578848669177554; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.7352298406795152 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5848568321855745; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7487114108766566; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.7351992687961928 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5846935720251509; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7456395669508487; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.7353039065824101 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.584627070299573; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7441620309816095; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.7353984587988717 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5848820461099642 at iter 180
0.7732398316970548 at iter 10
0.7358293017318814 at iter 120
last anomaly aucs:
0.5845552106150622
0.743402619096396
0.7355078241959123




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.51891565322876 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5845473312636904,first_prior_anomaly_auc= 0.7431485888081693, first_prior_star_anomaly_auc= 0.7354046046929417


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5845473312636904 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7476921379832012 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.740543360070599 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5845473312636904 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7451652299982665 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7368583450210378 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5845473312636904 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7474406290874135 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7358510487416676 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5845473312636904 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7461477851143294 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7361835573695573 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5845473312636904 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7340145295239295 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.721305450935279 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5845473312636904 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7405201947775658 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7320283026301275 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5845473312636904 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7401619994642041 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7264818696124935 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5845473312636904 at iter 0
max_prior_anomaly= 0.7501426162598294 at iter 24
max_prior_star_anomaly= 0.7455198008099972 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5845473312636904
accuracies_anomaly['prior'][-1]= 0.7398416250374269
accuracies_anomaly['prior_star'][-1]= 0.7240058622374206



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.58608198165894 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5845473312636904
 first_prior_anomaly_auc= 0.7410934963833777
 first_prior_star_anomaly_auc= 0.7274270766030541


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4235899900720173; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6981166774351135; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5790524292040279 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4223474163606852; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6986753234473739; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6167707266337834 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.41865263091542304; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6959194415115747; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6572241045117166 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4558463211308445; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7012203539404637; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6936285988937391 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5845473312636904 at iter 0
0.7410934963833777 at iter 0
0.7274270766030541 at iter 0
last anomaly aucs:
0.5325429818617331
0.6984576957624848
0.6988083268985297




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.10331439971924 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5355283105094789,first_prior_anomaly_auc= 0.6969536851726366, first_prior_star_anomaly_auc= 0.6980856327907087


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5355283105094789 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7271514568920687 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7271374316466268 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5355283105094789 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7219499818774918 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7208413571394803 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5355283105094789 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7182309280300047 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7167426761428999 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5355283105094789 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7080656192382242 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.707601998203508 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5355283105094788 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7009470980348897 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7010429109475707 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5355283105094789 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6962743274973604 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6961977402020266 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5355283105094789 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7162443859621477 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7150505066422932 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5355283105094789 at iter 0
max_prior_anomaly= 0.7327954362796854 at iter 6
max_prior_star_anomaly= 0.752557795042312 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5355283105094789
accuracies_anomaly['prior'][-1]= 0.7155722772901335
accuracies_anomaly['prior_star'][-1]= 0.7148201144081819



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.33566093444824 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5355283105094789
 first_prior_anomaly_auc= 0.7009275572434878
 first_prior_star_anomaly_auc= 0.699948311455001


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5812931591471391; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.7093146540176812; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.7164539767086373 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.579277305892179; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.7078686354539294; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 140 
last prior star auc 0.7162440707880928 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5792382243093749; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.7039132010652883; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 140 
last prior star auc 0.712553067431489 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5800743810769498; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.698642860519722; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 380 
last prior star auc 0.708944009329152 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5859211749688766 at iter 380
0.716949115148841 at iter 420
0.7213886568857653 at iter 380
last anomaly aucs:
0.42804481775060277
0.7069004207573631
0.5640230392234111




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.934757709503174 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.42860708826449406,first_prior_anomaly_auc= 0.710832217091889, first_prior_star_anomaly_auc= 0.5667355847266653


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42860708826449406 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7325354176844163 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5611201285910143 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42860708826449406 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7391597459697117 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5780348897678743 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42860708826449406 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7368473139291174 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5784086861969523 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42860708826449406 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7360612698362671 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5815768157965236 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.42860708826449406 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7350546039050065 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5780021116661677 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.42860708826449406 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7317767937343398 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5750851757883291 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.42860708826449406 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7250662653450368 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5712983595190444 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.42860708826449406 at iter 0
max_prior_anomaly= 0.751719747230408 at iter 5
max_prior_star_anomaly= 0.5825399877082118 at iter 38
last values
accuracies_anomaly['vanilla_star'][-1]= 0.42860708826449406
accuracies_anomaly['prior'][-1]= 0.7180682982176907
accuracies_anomaly['prior_star'][-1]= 0.5688682099689553



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.90943717956543 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.42860708826449406
 first_prior_anomaly_auc= 0.7177175094946184
 first_prior_star_anomaly_auc= 0.5682052413445324


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.41564051247301326; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6789246261247774; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5553297508549097 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.41245977591124694; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6715813858203192; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5636799722646831 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40770506011945096; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6620300360874294; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5651341853538616 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4099314496430653; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6738537907559449; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.580341648675481 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.42860708826449406 at iter 0
0.7177175094946184 at iter 0
0.5977970909434734 at iter 480
last anomaly aucs:
0.41079943899018234
0.6837852403990103
0.5943999873930378




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.81206488609314 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.41085648549411413,first_prior_anomaly_auc= 0.6870280662495865, first_prior_star_anomaly_auc= 0.601298201932017


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.41085648549411413 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7219137368611817 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6272118127235766 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.410856800668169 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6961854484138866 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6045419733047576 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.41085648549411413 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6877684101044802 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6003667050128434 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.410856800668169 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6905870116771987 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5990683454937991 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.41085648549411413 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.687604204421892 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5990160266006903 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.410856800668169 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6884903162771641 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5991969365081866 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.41085648549411413 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6926151567202987 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6010840411617316 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.41085680066816904 at iter 16
max_prior_anomaly= 0.7296547268228879 at iter 1
max_prior_star_anomaly= 0.6334954378555557 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.41085648549411413
accuracies_anomaly['prior'][-1]= 0.6926558141733773
accuracies_anomaly['prior_star'][-1]= 0.6015667302267678



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.91099643707275 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.410856800668169
 first_prior_anomaly_auc= 0.6920632869502183
 first_prior_star_anomaly_auc= 0.6011891517090313


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4442920402792442; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7054266668767826; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 100 
last prior star auc 0.6353319570732937 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4278300266322077; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7082711127220007; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 190 
last prior star auc 0.5115621602029721 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4273400885639094; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7068235182879746; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 270 
last prior star auc 0.5139365239453488 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4282392801424587; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7094199221520084; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 270 
last prior star auc 0.5167994074727769 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.44598862221661917 at iter 60
0.721541516302378 at iter 270
0.6434404399829806 at iter 120
last anomaly aucs:
0.4272587736577525
0.7164117433852845
0.5209842885733647




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.02028560638428 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.42774508722441973,first_prior_anomaly_auc= 0.7069694438753802, first_prior_star_anomaly_auc= 0.5203381817608775


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42774508722441973 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7302206218384103 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5017041461146918 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42774508722441973 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7294583733867028 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5262480104637786 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42774508722441973 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7258426966292135 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5266470208172463 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42774508722441973 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7209281875915975 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5269587279575145 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.42774508722441973 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.718006208928881 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.525944497848937 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.42774508722441973 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7164336479820981 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5256482342373576 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.42774508722441973 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7132962478528768 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5234290937170052 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.42774508722441973 at iter 0
max_prior_anomaly= 0.7361017697023181 at iter 4
max_prior_star_anomaly= 0.5272458515215027 at iter 44
last values
accuracies_anomaly['vanilla_star'][-1]= 0.42774508722441973
accuracies_anomaly['prior'][-1]= 0.7101457680003782
accuracies_anomaly['prior_star'][-1]= 0.5228847881242416



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.20278549194336 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.42774508722441973
 first_prior_anomaly_auc= 0.7099251461619679
 first_prior_star_anomaly_auc= 0.5215897379327734


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42591833840238275; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.688099500449123; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4674853838032053 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42486282049261703; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6785295554469957; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.46877791260223456 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.425912665269395; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6765754763067904; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4726183084608475 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4249548513166396; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6778859700269474; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4741894511243835 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.42774508722441973 at iter 0
0.7099251461619679 at iter 0
0.5215897379327734 at iter 0
last anomaly aucs:
0.42490946625273807
0.6870844824054083
0.4783759080952456




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.968297481536865 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.42491104212301245,first_prior_anomaly_auc= 0.6826729911593676, first_prior_star_anomaly_auc= 0.47642025308476604


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42491104212301245 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7230699528814787 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4782506264084341 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42491104212301245 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6963011172920246 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47778779330885485 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42491104212301245 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.696135335739162 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4801046377862174 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42491104212301245 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6959849977149881 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47896938084056917 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.42491104212301245 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.689241533636951 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4761621255338261 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.42491104212301245 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6928083584159352 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47659233811872603 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.42491104212301245 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6846065839860063 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.475390264273445 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.42491104212301245 at iter 0
max_prior_anomaly= 0.7263745528468097 at iter 6
max_prior_star_anomaly= 0.4805698346912082 at iter 33
last values
accuracies_anomaly['vanilla_star'][-1]= 0.42491104212301245
accuracies_anomaly['prior'][-1]= 0.6863096269915061
accuracies_anomaly['prior_star'][-1]= 0.4754009801913106



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.81235694885254 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.42491104212301245
 first_prior_anomaly_auc= 0.6862574656854248
 first_prior_star_anomaly_auc= 0.47562223237783063


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4275865546748191; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.697055801566415; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 100 
last prior star auc 0.48284192445277907 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4290076744882361; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6908829601147233; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 190 
last prior star auc 0.4833896969601463 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4276817372393904; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.6961195770364184; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 190 
last prior star auc 0.4868206817214807 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4252635643033865; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.6879641331925556; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 190 
last prior star auc 0.42911231227445357 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 449


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 450 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.43002285011897823 at iter 220
0.7090076744882361 at iter 190
0.4875761539310084 at iter 190
last anomaly aucs:
0.4252619884331122
0.6886568857651637
0.42908520730573463




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 51.9880096912384 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 7:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5036481396851411
accuracies_anomaly["prior"][-1]= 0.7248694391477695
accuracies_anomaly["prior_star"][-1]= 0.507275950643743


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 974.4368448257446 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0032477378845214844 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.47310997998644755
 first_prior_anomaly_auc= 0.7180003782088658
 first_prior_star_anomaly_auc= 0.47677119939486584


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5864541342956648; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7588086420725847; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6570126227208977 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5853560678884915; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.7609261389602409; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.657445514285264 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5827045085648549; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.7637753124162819; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.655666829506595 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5813199489418032; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.7685035535874687; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6553168287186599 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5869224829412043 at iter 140
0.7720249933025514 at iter 490
0.6582157996753708 at iter 150
last anomaly aucs:
0.5809827127030903
0.7720249933025514
0.6558980096758436




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.32462239265442 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5809663236522369,first_prior_anomaly_auc= 0.7723431615109443, first_prior_star_anomaly_auc= 0.6559670327938605


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5809663236522369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7764407393983328 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6561926974171486 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5809663236522369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.716936823360701 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6567886915549113 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5809663236522369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6493305703074523 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.662918196574058 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5809663236522369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6600994374143121 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.704594922545976 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5809663236522369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7609247206769938 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7427653371574452 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5809663236522369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.77457932143026 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7640770915738216 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5809663236522369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7712230329199299 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7660787619963125 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5809663236522369 at iter 0
max_prior_anomaly= 0.7792591833840238 at iter 7
max_prior_star_anomaly= 0.766650172557795 at iter 68
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5809663236522369
accuracies_anomaly['prior'][-1]= 0.7712123170020643
accuracies_anomaly['prior_star'][-1]= 0.7637250421545297



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.47431564331055 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5809663236522369
 first_prior_anomaly_auc= 0.7713338166002175
 first_prior_star_anomaly_auc= 0.763545392943253


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5808437209448918; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.752402256646233; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.76490505381597 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5805543911625195; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7507171785618608; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7664683171281339 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5805055391840144; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7502078572891879; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7669829963597397 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.580563216036056; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7498780276407647; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.767223158989552 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5809663236522369 at iter 0
0.7713338166002175 at iter 0
0.7673564776147628 at iter 490
last anomaly aucs:
0.5806199473659328
0.7498460374741951
0.7673564776147628




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.147698402404785 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5806312936319082,first_prior_anomaly_auc= 0.7498334305120002, first_prior_star_anomaly_auc= 0.7673766487542746


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5806312936319082 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7540561324991728 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7647433695258207 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5806312936319082 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7535616244070789 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7632812770852703 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5806312936319082 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7550924247915911 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7625548008887909 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5806312936319082 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7556616291346896 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7617804182359709 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5806312936319082 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7556962982807256 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7610306191594308 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5806312936319082 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7563937784641569 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7608033786658682 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5806312936319082 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7563720314543707 iter_best_prior_anomaly= 650
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7601519138944481 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5806314512189357 at iter 17
max_prior_anomaly= 0.7572583008966701 at iter 74
max_prior_star_anomaly= 0.7709031312542352 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5806312936319082
accuracies_anomaly['prior'][-1]= 0.7568076019982035
accuracies_anomaly['prior_star'][-1]= 0.7599180547457334



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.74002408981323 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5806312936319082
 first_prior_anomaly_auc= 0.757310619789779
 first_prior_star_anomaly_auc= 0.7601925713475266


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5743224545755393; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7338660825440849; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7562175961674834 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5738131333028664; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7487722394692469; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7661575555100305 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5727699071812408; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7360571725735537; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7578735206517799 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5720579289912855; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7278319176765369; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7524184881100588 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5806312936319082 at iter 0
0.757310619789779 at iter 0
0.7661575555100305 at iter 200
last anomaly aucs:
0.5742165560931025
0.7394188190428164
0.7609089619742503




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.135499000549316 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5737365460075325,first_prior_anomaly_auc= 0.7384528105646343, first_prior_star_anomaly_auc= 0.7584966197582614


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5737365460075327 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.740997841057724 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7607841530485211 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5737365460075327 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7414110342436611 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7607135540602298 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5737365460075327 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.741747955308319 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7605468269852026 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5737365460075325 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7421441290952928 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7604847376963929 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5737365460075327 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7426417889279355 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7604328915643663 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5737365460075327 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7432559055738531 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.760513733709441 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5737365460075327 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7435460232913627 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.760201396221063 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5737365460075327 at iter 1
max_prior_anomaly= 0.7440408465575113 at iter 73
max_prior_star_anomaly= 0.7645933466757016 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5737365460075327
accuracies_anomaly['prior'][-1]= 0.7438236916337048
accuracies_anomaly['prior_star'][-1]= 0.7600493247395874



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.42858505249023 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5737365460075327
 first_prior_anomaly_auc= 0.7439919945790062
 first_prior_star_anomaly_auc= 0.7600772176434436


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5640581811305294; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7225324235308949; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.749037616023449 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5631350363238098; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7345875159556865; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7554501473438706 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5605953637896528; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7247219376900893; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7505129457743038 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5597043667365302; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7344346565390737; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7552462297303686 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5737365460075327 at iter 0
0.7439919945790062 at iter 0
0.7600772176434436 at iter 0
last anomaly aucs:
0.5579258395448887
0.7208991915785492
0.746864175741053




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.88739228248596 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5591840143719369,first_prior_anomaly_auc= 0.7257598058527822, first_prior_star_anomaly_auc= 0.7504335219124763


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5591840143719369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7321600453850639 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7563534361851333 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5591840143719369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7332190302094331 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7574792379091353 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5591840143719369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7340192571347526 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7574631640323368 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5591840143719369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7342181319633767 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7573613628126132 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5591840143719369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7345443371101691 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7574344831933436 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5591840143719369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7344749988180972 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7571930598673118 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5591840143719369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7343728824243188 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7571706825094158 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5591840143719369 at iter 0
max_prior_anomaly= 0.7404393526324913 at iter 4
max_prior_star_anomaly= 0.7617802606489433 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5591840143719369
accuracies_anomaly['prior'][-1]= 0.7343640575507824
accuracies_anomaly['prior_star'][-1]= 0.7570649416140063



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.03754878044128 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5591840143719369
 first_prior_anomaly_auc= 0.7343530264588619
 first_prior_star_anomaly_auc= 0.7570493404982902


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4152270041130214; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.730106686417574; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 60 
last prior star auc 0.5524027294073152 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4144102305498212; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7161214680807475; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 60 
last prior star auc 0.5491157791890572 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.41412988322801264; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7387916226736215; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 300 
last prior star auc 0.5538380320532014 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.41410277825929365; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7284964621712341; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 300 
last prior star auc 0.5501949351529382 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5591840143719369 at iter 0
0.7402716800352994 at iter 430
0.7570493404982902 at iter 0
last anomaly aucs:
0.4141960697795357
0.7208695652173913
0.55128449186063




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.76979732513428 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4134913405928424,first_prior_anomaly_auc= 0.7198241328773816, first_prior_star_anomaly_auc= 0.5514748569897726


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4134913405928424 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7303091857478292 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5550943158359203 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4134913405928424 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.732518713459508 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5569106639141466 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4134913405928424 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7327405959941378 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5571765132294308 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4134913405928424 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7329159903556739 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5571286067730905 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4134913405928424 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7331537891800747 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5570071071749374 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4134913405928424 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7333246135178152 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5568069716500939 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4134913405928424 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7334735332587421 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5566377231826276 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4134913405928424 at iter 0
max_prior_anomaly= 0.7340080684558048 at iter 77
max_prior_star_anomaly= 0.5572050364813969 at iter 44
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4134913405928424
accuracies_anomaly['prior'][-1]= 0.733770269631404
accuracies_anomaly['prior_star'][-1]= 0.5564133192555589



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.96584939956665 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4134913405928424
 first_prior_anomaly_auc= 0.7336536552311015
 first_prior_star_anomaly_auc= 0.5563364167861702


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4216781442551649; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6949528026852829; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4308170887372552 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42151882377042726; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6994957215122051; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4310235277431962 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4214827363411444; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.706554359645114; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4313604488078542 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42166128244322926; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7004610996422775; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4316155822052729 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4219214586255259 at iter 40
0.7336536552311015 at iter 0
0.5563364167861702 at iter 0
last anomaly aucs:
0.42146508659407156
0.7052552121909325
0.43173424523693216




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.68432545661926 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.42142285327071877,first_prior_anomaly_auc= 0.7016896481081678, first_prior_star_anomaly_auc= 0.4316784594292198


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42142285327071877 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7133906424823109 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4322943095324393 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42142285327071877 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7134163291677831 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43233150007091414 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42142285327071877 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7143366374080085 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4323324455930788 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42142285327071877 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7151724790015286 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4323523015585357 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.42142285327071877 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7157442047370659 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4323162141292529 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.42142285327071877 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7177755015207147 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43229336401027463 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.42142285327071877 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7180112517137588 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43225050033881207 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.42142285327071877 at iter 0
max_prior_anomaly= 0.7226906409064405 at iter 6
max_prior_star_anomaly= 0.4323604960839624 at iter 34
last values
accuracies_anomaly['vanilla_star'][-1]= 0.42142285327071877
accuracies_anomaly['prior'][-1]= 0.7180894148793671
accuracies_anomaly['prior_star'][-1]= 0.4322618466047875



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.30499339103699 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.42142285327071877
 first_prior_anomaly_auc= 0.7181163622610587
 first_prior_star_anomaly_auc= 0.432196605575429


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4218168208393086; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7197882030351261; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 40 
last prior star auc 0.43000236380541157 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4216366988669493; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7238091936271807; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 160 
last prior star auc 0.42962037285090693 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4217260507115054; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7294227587185023; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 160 
last prior star auc 0.42968246213971667 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4215995083284744; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7240695273965048; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 160 
last prior star auc 0.42975542493341945 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.422012228753329 at iter 40
0.7307726491955182 at iter 160
0.432196605575429 at iter 0
last anomaly aucs:
0.4215828041035662
0.7192505160975149
0.42977890540050745




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.608861446380615 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4216144790960808,first_prior_anomaly_auc= 0.7244162188568638, first_prior_star_anomaly_auc= 0.4297662984383126


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4216144790960808 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.734711379359251 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4299090722851695 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4216144790960808 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7327112848070346 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4299717919220889 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4216144790960808 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7311918306884977 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4299639125707171 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4216144790960808 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7308255984367367 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42996895535559515 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4216144790960808 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7307266337835069 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4299825078399546 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4216144790960808 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7321556329482957 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4299842412972564 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4216144790960808 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.732097168161117 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4299847140583387 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4216144790960808 at iter 0
max_prior_anomaly= 0.7434226326488803 at iter 7
max_prior_star_anomaly= 0.42998881132105204 at iter 72
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4216144790960808
accuracies_anomaly['prior'][-1]= 0.7319022330081788
accuracies_anomaly['prior_star'][-1]= 0.42998597475455824



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.12996506690979 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4216144790960808
 first_prior_anomaly_auc= 0.7318247001906802
 first_prior_star_anomaly_auc= 0.429984083710229


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42199300313598187; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.7016663252281072; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4284026978899098 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4216245646658367; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.6972135461808784; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4283773263784925 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42155932363647824; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7000557858077123; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4284239721386135 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42153237625478673; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.6939143041744803; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.42830420599776226 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 493


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 494 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.42201932016956367 at iter 110
0.7318247001906802 at iter 0
0.429984083710229 at iter 0
last anomaly aucs:
0.4217897158705895
0.7000879335613093
0.4286977008052697




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.14519906044006 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 7:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4731099799864475
accuracies_anomaly["prior"][-1]= 0.7180003782088658
accuracies_anomaly["prior_star"][-1]= 0.4767711993948658


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 981.9518301486969 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0032885074615478516 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49918637817734846
 first_prior_anomaly_auc= 0.7200501126747246
 first_prior_star_anomaly_auc= 0.5028840001891044


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5862858313503633; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7475693776888286; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 100 
last prior star auc 0.6558699591849598 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5842808516002962; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7555202735710795; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 200 
last prior star auc 0.6560538632459776 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5811626770884221; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7626157870684085; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 300 
last prior star auc 0.6541926028649321 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5803769481696266; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7696769465937564; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 400 
last prior star auc 0.6543643727248373 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5864223017161228 at iter 110
0.77409316545062 at iter 490
0.6567907401862678 at iter 150
last anomaly aucs:
0.580808736624801
0.77409316545062
0.6556209716816112




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.79602766036987 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5808645224325133,first_prior_anomaly_auc= 0.7744223647509337, first_prior_star_anomaly_auc= 0.6557568116992609


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5808643648454859 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7743858045605686 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6557404226484076 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5808645224325133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7411325779661819 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6561465244181099 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5808645224325133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6932929385253006 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6632336858029847 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5808645224325133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7125552736498733 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7070564319145248 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5808645224325133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7750308082638637 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7422859574199852 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5808645224325133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7793512142080465 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7647395874371621 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5808645224325133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7756802244039271 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.763316261405361 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5808645224325133 at iter 0
max_prior_anomaly= 0.78151188994122 at iter 55
max_prior_star_anomaly= 0.7648804702396899 at iter 61
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5808645224325133
accuracies_anomaly['prior'][-1]= 0.7752323620719542
accuracies_anomaly['prior_star'][-1]= 0.763661061821391



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.44737887382507 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5808645224325133
 first_prior_anomaly_auc= 0.7751327670706148
 first_prior_star_anomaly_auc= 0.7635211245410278


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5812748790519565; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7537188962604597; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7630206281418914 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5815591660494508; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7502316529303308; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7638564697354114 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5814289991647887; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.7492875490489623; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7639141465874528 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5812852797957673; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.7490483319413146; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7637943804466016 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5815635784862191 at iter 210
0.7751327670706148 at iter 0
0.7639412515561719 at iter 260
last anomaly aucs:
0.5811161889153285
0.7490442346786013
0.7636396299856596




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.80678081512451 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5810958601887892,first_prior_anomaly_auc= 0.7490418708731897, first_prior_star_anomaly_auc= 0.7636304899380683


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5810958601887892 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7527645492223078 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7600110310919205 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5810958601887892 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.754175583465969 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7597560552815292 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5810958601887892 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7551129111051578 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7588628520100226 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5810958601887892 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.75540224088753 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7581578076492743 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5810958601887892 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7564933734654962 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7577587972958066 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5810958601887892 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7569437571899083 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7573329971476748 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5810958601887892 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7574757709945317 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7569800022062184 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5810958601887892 at iter 0
max_prior_anomaly= 0.7578692658020392 at iter 79
max_prior_star_anomaly= 0.7636304899380683 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5810958601887892
accuracies_anomaly['prior'][-1]= 0.7578692658020392
accuracies_anomaly['prior_star'][-1]= 0.7567240808736625



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.30747485160828 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5810958601887892
 first_prior_anomaly_auc= 0.7576075137494682
 first_prior_star_anomaly_auc= 0.7566263769166521


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5708076335156089; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7354663788076966; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7494164552374049 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5720765242605228; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7345014734387065; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7507931355090849 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5728975526734639; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7426890650361663; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7576377704587358 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5721162361914367; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7399903871913265; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7546489748963865 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5810958601887892 at iter 0
0.7576075137494682 at iter 0
0.7599758891848023 at iter 290
last anomaly aucs:
0.5724764801361552
0.7447402177852718
0.7586967552831051




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.83267831802368 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5718064200954978,first_prior_anomaly_auc= 0.7367563862142867, first_prior_star_anomaly_auc= 0.7529810737980049


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5718064200954978 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7380547457333312 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7546385741525757 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5718064200954978 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7380916210977513 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7545909828702901 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5718064200954978 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.737719558125975 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7543104779614542 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5718064200954978 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7378895945285785 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7542301085774619 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5718064200954978 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7380024268402225 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7541229493988054 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5718064200954978 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7381162046740313 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.754072521550026 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5718064200954978 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7376702333863876 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7536703594560096 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5718064200954978 at iter 0
max_prior_anomaly= 0.7386926580203917 at iter 71
max_prior_star_anomaly= 0.7557448350851756 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5718064200954978
accuracies_anomaly['prior'][-1]= 0.7380872086609831
accuracies_anomaly['prior_star'][-1]= 0.7537151141718015



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.08099913597107 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5718064200954978
 first_prior_anomaly_auc= 0.7380909907496416
 first_prior_star_anomaly_auc= 0.7536952582063445


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5641688072237893; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7295864916400081; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 30 
last prior star auc 0.7476495894857935 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5636935247490427; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7336517641867722; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 170 
last prior star auc 0.750874135241187 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5613426414737539; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7330270892100162; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 240 
last prior star auc 0.7485219912696788 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5610700159162898; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7334418582662274; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 240 
last prior star auc 0.7501705091636858 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5718064200954978 at iter 0
0.7493121326252423 at iter 240
0.7600649258553036 at iter 240
last anomaly aucs:
0.5595811336810754
0.7332716642765968
0.7478954252485935




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.82012057304382 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5599903871913264,first_prior_anomaly_auc= 0.7306169532124116, first_prior_star_anomaly_auc= 0.7475512551806736


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.559990229604299 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7372059820035615 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7540876499046599 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5599902296042989 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7394676710213215 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7563121483839452 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.559990229604299 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7401325306900737 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7564120585593392 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5599902296042989 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7406981105315411 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7566307893534205 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.559990229604299 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7412859101438769 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7572806782545661 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.559990229604299 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7408689348692816 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7560300676048348 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5599902296042989 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.741035346770254 iter_best_prior_anomaly= 650
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7559556865278851 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5599903871913264 at iter 0
max_prior_anomaly= 0.7413271979450651 at iter 65
max_prior_star_anomaly= 0.7615859558441149 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.559990229604299
accuracies_anomaly['prior'][-1]= 0.7411131947618071
accuracies_anomaly['prior_star'][-1]= 0.7556537497833178



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.46773862838745 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.559990229604299
 first_prior_anomaly_auc= 0.7404217028854184
 first_prior_star_anomaly_auc= 0.7552263737649116


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42176781127377594; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7231630868146934; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.45130182643364797 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4215163023779882; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.717548576201207; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4516801928865215 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42126306002489877; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7230786201679879; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4286899790409254 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42123043951021955; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7251102321256915; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.42873221236427816 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.559990229604299 at iter 0
0.7404217028854184 at iter 0
0.7552263737649116 at iter 0
last anomaly aucs:
0.4213234158564067
0.7032749736041728
0.4285402713648613




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.71200489997864 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.42136627952786926,first_prior_anomaly_auc= 0.7230247254046047, first_prior_star_anomaly_auc= 0.42881793970720333


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42136627952786926 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7268890744913878 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4288789258868209 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42136627952786926 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7274894810659187 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42886868273003764 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42136627952786926 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.727898892163197 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4288712041224766 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42136627952786926 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7285869171249822 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4288779803646564 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.42136627952786926 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7290073593141813 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4288784531257387 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.42136627952786926 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7294298501347369 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4288790834738484 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.42136627952786926 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7301449800652411 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42888664765116535 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.42136627952786926 at iter 0
max_prior_anomaly= 0.7304379343492444 at iter 72
max_prior_star_anomaly= 0.42889106008793354 at iter 72
last values
accuracies_anomaly['vanilla_star'][-1]= 0.42136627952786926
accuracies_anomaly['prior'][-1]= 0.7303635532722945
accuracies_anomaly['prior_star'][-1]= 0.4288869628252202



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.503333568573 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.42136627952786926
 first_prior_anomaly_auc= 0.7306254629118931
 first_prior_star_anomaly_auc= 0.42888664765116535


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 57


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 58 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.42136627952786926 at iter 0
0.7306254629118931 at iter 0
0.42888664765116535 at iter 0
last anomaly aucs:
0.4213022991947303
0.7073758608191373
0.42847471516144797




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 6.733674049377441 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 5:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 5 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.49918637817734846
accuracies_anomaly["prior"][-1]= 0.7200501126747246
accuracies_anomaly["prior_star"][-1]= 0.5028840001891044


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 667.6686894893646 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003406047821044922 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46656050553918404
 first_prior_anomaly_auc= 0.7114368785161606
 first_prior_star_anomaly_auc= 0.46997904092535103


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5850553918401438; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7555502151062925; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.655867122618466 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5847528247474667; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.7594014844697984; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6570154592873915 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5816631734875586; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.7632470807003167; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.654862820492617 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5803621349890478; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.7668369131853067; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6544948547835543 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5867330633342264 at iter 130
0.7693909261389601 at iter 490
0.6581058039302204 at iter 150
last anomaly aucs:
0.5801203964889611
0.7693909261389601
0.6550568101233907




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.61398959159851 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5801388341711711,first_prior_anomaly_auc= 0.7695844430086516, first_prior_star_anomaly_auc= 0.6551600296263612


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5801388341711711 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7715402556061585 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6551850859637234 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5801386765841436 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7734259419764565 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6552068329735097 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5801388341711711 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7752501694060545 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6552175488913752 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5801386765841436 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7771067021762768 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6552184944135399 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5801386765841436 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7787670390973415 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.655238035204942 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5801386765841436 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7801285910143878 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.655235198638448 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5801386765841436 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7808128338875144 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.655235198638448 iter_best_prior_star_anomaly= 660
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5801388341711711 at iter 0
max_prior_anomaly= 0.7808498668389618 at iter 73
max_prior_star_anomaly= 0.6552437083379297 at iter 75
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5801386765841436
accuracies_anomaly['prior'][-1]= 0.7805703074522905
accuracies_anomaly['prior_star'][-1]= 0.6552342531162835



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.22765254974365 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5801386765841436
 first_prior_anomaly_auc= 0.7804828466520637
 first_prior_star_anomaly_auc= 0.6552361441606127


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5804970294845329; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7818207605149944; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6563846384165655 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5808909970531226; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7822957278156863; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 190 
last prior star auc 0.6575224167546527 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5812455678648534; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7817813637581355; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 190 
last prior star auc 0.6584783396630789 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5816262981231386; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.781230281923192; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 190 
last prior star auc 0.6592851852435507 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5819228769087729 at iter 490
0.7823240934806247 at iter 190
0.6599112785035536 at iter 490
last anomaly aucs:
0.5819228769087729
0.7809231448067195
0.6599112785035536




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.71445655822754 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5819512425737113,first_prior_anomaly_auc= 0.780873032131995, first_prior_star_anomaly_auc= 0.6599741557275005


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5819512425737113 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7793056715571175 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6599599728950314 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5819512425737113 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7767762421797438 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6599520935436595 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5819512425737113 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7733846541752682 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6599697432907323 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5819512425737113 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7693515293821013 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6599968482594514 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5819512425737113 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7648185385379075 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6600115038530028 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5819512425737113 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7583606221535844 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6600230077060056 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5819512425737113 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7516902784562776 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6600510581968893 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5819512425737113 at iter 0
max_prior_anomaly= 0.780873032131995 at iter 0
max_prior_star_anomaly= 0.6600838362985959 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5819512425737113
accuracies_anomaly['prior'][-1]= 0.7451876073561623
accuracies_anomaly['prior_star'][-1]= 0.6600838362985959



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.56759548187256 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5819512425737113
 first_prior_anomaly_auc= 0.7444997399814046
 first_prior_star_anomaly_auc= 0.6600895094315835


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.582412027041934; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7439292749420866; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6608222891091605 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5828516948484801; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7437170052161305; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6615027498936288 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5833439967221898; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7434160139937279; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6622035394046362 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5838167578044975; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7433370628929826; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.662891091605339 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5842293206423247 at iter 490
0.7444997399814046 at iter 0
0.6634205840175236 at iter 490
last anomaly aucs:
0.5842293206423247
0.7433439967221898
0.6634205840175236




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.70897388458252 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5842676142899916,first_prior_anomaly_auc= 0.7433510881384244, first_prior_star_anomaly_auc= 0.6634784184565926


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5842674567029642 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7358696440109049 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6635381439399908 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5842674567029642 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7290800069338292 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6636032273823218 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5842676142899916 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7233939518098869 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.663739224986999 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5842674567029642 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7186776872527852 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6638805805506091 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5842676142899916 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.712152481207747 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6640896985360165 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5842676142899916 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7035923538774288 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6642983437603417 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5842677718770191 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.6967515010164361 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6645697086215863 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5842677718770191 at iter 26
max_prior_anomaly= 0.7433510881384244 at iter 0
max_prior_star_anomaly= 0.6648354003498431 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5842676142899916
accuracies_anomaly['prior'][-1]= 0.6926312305970973
accuracies_anomaly['prior_star'][-1]= 0.6648354003498431



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.15069007873535 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5842677718770191
 first_prior_anomaly_auc= 0.6922681500858849
 first_prior_star_anomaly_auc= 0.6648659722331658


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5846456655688104; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6921056778605986; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6654584994563247 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5849951935956632; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6919428904612571; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6659908284350031 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5853280173976079; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6917815213451628; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6665285153726146 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.585588351166932; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6916220432733977; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6670350000787935 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5858345021037868 at iter 490
0.6922681500858849 at iter 0
0.6674453566982366 at iter 490
last anomaly aucs:
0.5858345021037868
0.6915309579715397
0.6674453566982366




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.61344075202942 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5858571946357376,first_prior_anomaly_auc= 0.6915295396882929, first_prior_star_anomaly_auc= 0.6674844382810408


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5858571946357376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6870770758151189 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6678657988874356 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5858571946357376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6829044865026711 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6683221709188899 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5858571946357376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6788888538695494 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6689210016231464 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5858571946357376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6749980301621571 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6696418046866381 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5858571946357376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.673075783601494 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6704691365806768 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5858571946357376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6725272231589894 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6715092109617535 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5858571946357376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6724148636084278 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6727550940006619 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5858571946357376 at iter 0
max_prior_anomaly= 0.6915295396882929 at iter 0
max_prior_star_anomaly= 0.6740625935672975 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5858571946357376
accuracies_anomaly['prior'][-1]= 0.67196054020833
accuracies_anomaly['prior_star'][-1]= 0.6740625935672975



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.11969923973083 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5858571946357376
 first_prior_anomaly_auc= 0.6718864743054351
 first_prior_star_anomaly_auc= 0.6741948090833163


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5860765557779284; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6717065099201034; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6746247064941614 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5862659753849063; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6713525694564824; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6750546039050065 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5864018154025561; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6710659186535763; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6754066533242984 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5864957372709079; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6707464897489639; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6757579148084529 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5865354492018217 at iter 480
0.6718864743054351 at iter 0
0.676090896197425 at iter 490
last anomaly aucs:
0.5865351340277669
0.670405313834565
0.676090896197425




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.56629300117493 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5865455347715776,first_prior_anomaly_auc= 0.6703769481696267, first_prior_star_anomaly_auc= 0.6761217832548025


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5865455347715776 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6700042548497407 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6778965283577856 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5865455347715776 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6699098602203066 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6799467355847266 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5865455347715776 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6700936066942969 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6822664166285831 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5865455347715776 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6709095923223599 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6848944954851317 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5865455347715776 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6719014450730416 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.687751390705517 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5865455347715776 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.673739540161054 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6909563956695084 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5865455347715776 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6747476243755614 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6948254723671148 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5865455347715776 at iter 0
max_prior_anomaly= 0.6757486171738343 at iter 79
max_prior_star_anomaly= 0.6983409237751548 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5865455347715776
accuracies_anomaly['prior'][-1]= 0.6757486171738343
accuracies_anomaly['prior_star'][-1]= 0.6983409237751548



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.34676098823547 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5865455347715776
 first_prior_anomaly_auc= 0.675872165403344
 first_prior_star_anomaly_auc= 0.6986680744441117


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5866514332540145; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6754736278109587; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6989046125722931 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5867803394424571; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6750858061364389; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6991316954788281 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.586861654348614; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.674829569629828; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6993360858534126 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5869152339379422; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6747411633074367; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6994976125565344 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5869562065650755 at iter 490
0.675872165403344 at iter 0
0.6996142269568368 at iter 490
last anomaly aucs:
0.5869562065650755
0.674679861953764
0.6996142269568368




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.607335805892944 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5869628252202279,first_prior_anomaly_auc= 0.6746693036229259, first_prior_star_anomaly_auc= 0.6996284097893062


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5869628252202279 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6764200954977386 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7032989268323432 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5869628252202279 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6792914887246482 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7076694454512504 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5869628252202279 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6817326693666578 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7114367209291331 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5869628252202279 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.686625588981515 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7151379674425201 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5869628252202279 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6923743637423768 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7187421403470067 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5869628252202279 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6986516853932584 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7223833462029405 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5869628252202279 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7049562695998866 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7254162661329719 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5869628252202279 at iter 0
max_prior_anomaly= 0.7101952503269932 at iter 79
max_prior_star_anomaly= 0.7276291031722268 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5869628252202279
accuracies_anomaly['prior'][-1]= 0.7101952503269932
accuracies_anomaly['prior_star'][-1]= 0.7276291031722268



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.68511986732483 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5869628252202279
 first_prior_anomaly_auc= 0.7105721984966197
 first_prior_star_anomaly_auc= 0.7278897521156058


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5880706620231022; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7104322612162567; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.7269590431315693 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.588390878862852; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7104043683124005; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.7267437792520919 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5886092944828781; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7105435176576265; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.7267463006445309 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5887542745481191; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7106755755866176; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 400 
last prior star auc 0.726834549379895 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5888705737743669 at iter 490
0.7108769718076808 at iter 490
0.7278897521156058 at iter 0
last anomaly aucs:
0.5888705737743669
0.7108769718076808
0.7269114518492839




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.612858057022095 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5888757741462722,first_prior_anomaly_auc= 0.7108873725514916, first_prior_star_anomaly_auc= 0.7269221677671495


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5888757741462722 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7143900594103093 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7299938541059301 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5888757741462722 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7179337188962605 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7322690956080495 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5888757741462722 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7212692059189688 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7337639661503066 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5888757741462722 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7242578438942906 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7357700490095656 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5888757741462722 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7265201632601604 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7377118363616307 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5888757741462722 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7285415320610809 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.73976645602534 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5888757741462722 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7305120002521394 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7414160770285392 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5888757741462722 at iter 0
max_prior_anomaly= 0.732114502734135 at iter 79
max_prior_star_anomaly= 0.7430483634587202 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5888757741462722
accuracies_anomaly['prior'][-1]= 0.732114502734135
accuracies_anomaly['prior_star'][-1]= 0.7430483634587202



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.14232230186462 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5888757741462722
 first_prior_anomaly_auc= 0.732284854310793
 first_prior_star_anomaly_auc= 0.7432399892840822


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5887378854972658; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7328360937327638; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.743112343791859 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5887126715728761; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.732930803536253; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 170 
last prior star auc 0.7430824022566462 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5887224419685771; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7328613076571537; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 240 
last prior star auc 0.7431006823518288 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5887523835037899; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7327388625368358; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 240 
last prior star auc 0.74310982239942 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5888757741462722 at iter 0
0.732946719826024 at iter 240
0.7432399892840822 at iter 0
last anomaly aucs:
0.5886865121263217
0.7326387947744142
0.7430597097246955




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.589444637298584 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5886688623792489,first_prior_anomaly_auc= 0.7326317033581795, first_prior_star_anomaly_auc= 0.7430512000252139


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5886688623792489 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7389470034826733 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7455442267992499 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5886688623792489 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7408205556518587 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7475118584238145 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5886688623792489 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.742190774855414 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7494719258710623 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5886688623792489 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7432713491025419 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7513468963234947 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5886688623792489 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7442654080716076 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7531600926611721 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5886688623792489 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.745096364467277 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7547783538459114 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5886688623792489 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7459719179917108 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7563178215169327 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5886688623792489 at iter 0
max_prior_anomaly= 0.7465560931024158 at iter 79
max_prior_star_anomaly= 0.7576384008068456 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5886688623792489
accuracies_anomaly['prior'][-1]= 0.7465560931024158
accuracies_anomaly['prior_star'][-1]= 0.7576384008068456



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.4869031906128 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.46656050553918404
accuracies_anomaly["prior"][-1]= 0.7114368785161606
accuracies_anomaly["prior_star"][-1]= 0.46997904092535103


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 1047.9174647331238 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0032711029052734375 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.490910695431552
 first_prior_anomaly_auc= 0.720060355831508
 first_prior_star_anomaly_auc= 0.49439793876168114


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5856138802653765; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.757481286540492; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6552451266211765 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5839113100209591; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.7602879114991256; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6556190806372819 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5813139606347606; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.7641875600800542; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6542086767417306 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5806962194872118; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.768499298737728; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6546325858455333 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5860724585152151 at iter 120
0.7709162109775123 at iter 490
0.6565132294309532 at iter 130
last anomaly aucs:
0.5810637124351923
0.7709162109775123
0.6559405581732511




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.62924790382385 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5811317900310446,first_prior_anomaly_auc= 0.77106938556818, first_prior_star_anomaly_auc= 0.6560760830168461


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5811317900310446 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7740224088753014 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6560886899790409 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5811317900310446 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7769527396504721 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6561028728115101 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5811317900310446 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7797448666025812 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6561050790298942 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5811317900310446 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7824747466788533 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6560962541563579 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5811317900310446 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7850689443245032 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6560871141087665 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5811317900310446 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7876585719463575 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6560842775422727 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5811317900310446 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7900515309579715 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6560741919725168 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5811317900310446 at iter 0
max_prior_anomaly= 0.7920166411900971 at iter 79
max_prior_star_anomaly= 0.6561064973131412 at iter 33
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5811317900310446
accuracies_anomaly['prior'][-1]= 0.7920166411900971
accuracies_anomaly['prior_star'][-1]= 0.6560593787919379



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.52676272392273 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5811317900310446
 first_prior_anomaly_auc= 0.7921999149030051
 first_prior_star_anomaly_auc= 0.6560581180957183


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5819052271617; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7912447799297164; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6576834706966923 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5827549364136344; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7898009675843484; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6591531273145594 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5835958207920323; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7885812439919946; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.660464881730936 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5844010905022299; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7873586838331468; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6616010841987487 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5849832169815781 at iter 490
0.7921999149030051 at iter 0
0.6625012212994627 at iter 490
last anomaly aucs:
0.5849832169815781
0.7862361914367211
0.6625012212994627




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.692007541656494 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.585027656523315,first_prior_anomaly_auc= 0.7861315536505035, first_prior_star_anomaly_auc= 0.662579069291016


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.585027656523315 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7870567470885796 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6625661471547662 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.585027656523315 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7878448398127865 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6625453456671446 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.585027656523315 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7883990733882786 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6625343145752242 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.585027656523315 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7885078084372095 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6625280110941267 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.585027656523315 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7877479237909136 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6625160344800416 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.585027656523315 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7864557101659391 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6625040578659565 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.585027656523315 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7854156357848622 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6625122523913831 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.585027656523315 at iter 0
max_prior_anomaly= 0.788554611784358 at iter 35
max_prior_star_anomaly= 0.662579069291016 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.585027656523315
accuracies_anomaly['prior'][-1]= 0.7841788927935451
accuracies_anomaly['prior_star'][-1]= 0.6625376239028002



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.99644136428833 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.585027656523315
 first_prior_anomaly_auc= 0.7840072805206676
 first_prior_star_anomaly_auc= 0.6625393573601022


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5854881258174827; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7827059268481018; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6633250862788975 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5858111792237264; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7818576358794144; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6640200450698899 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5861938005263407; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7811401421434988; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.664678758844572 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5865360795499315; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7803834092377516; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6652892509888586 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5868607088264494 at iter 490
0.7840072805206676 at iter 0
0.6658297744929638 at iter 490
last anomaly aucs:
0.5868607088264494
0.7796986936035427
0.6658297744929638




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.740450620651245 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5868915958838269,first_prior_anomaly_auc= 0.7796074507146572, first_prior_star_anomaly_auc= 0.6658882392801424


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5868915958838269 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7765839860062719 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6659000583072001 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5868915958838269 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7719246103660746 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6659586806814064 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5868915958838269 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7676684999290858 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6660885323920135 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5868915958838269 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7626548686512127 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6662130261436878 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5868915958838269 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7577781805001812 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6663999243582268 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5868915958838269 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7529739823817704 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.666597380903604 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5868915958838269 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7485275068156388 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6668799344437966 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5868915958838269 at iter 0
max_prior_anomaly= 0.7796074507146572 at iter 0
max_prior_star_anomaly= 0.6671601241785776 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5868915958838269
accuracies_anomaly['prior'][-1]= 0.7450304930898088
accuracies_anomaly['prior_star'][-1]= 0.6671601241785776



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.37049460411072 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5868915958838269
 first_prior_anomaly_auc= 0.7444835085175788
 first_prior_star_anomaly_auc= 0.6671900657137904


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5872679137053438; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7437508864270294; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6677892115921018 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5875402240887531; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7435036323809823; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6683889878185227 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5873612052255858; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.744693256851096; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 300 
last prior star auc 0.6685598121562633 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5873637266180247; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.7450640591266526; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 400 
last prior star auc 0.6689307720188473 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.587564807665033 at iter 220
0.7451732669366657 at iter 440
0.6693464865972233 at iter 490
last anomaly aucs:
0.5873668783585735
0.7451318215484501
0.6693464865972233




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.60795283317566 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5873697149250674,first_prior_anomaly_auc= 0.7451286698079014, first_prior_star_anomaly_auc= 0.6693873016373292


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5873697149250674 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7387898892163198 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6697508549096238 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5873697149250674 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7342263264888034 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6702169973367792 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5873697149250674 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7308156704540082 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6707833651133839 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5873697149250674 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7287099925934096 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6714568920686449 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5873697149250674 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7260971996785224 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6723359125076823 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5873697149250674 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7211103581953133 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6733769324109239 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5873697149250674 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7171271884898436 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6746351072379722 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5873697149250674 at iter 0
max_prior_anomaly= 0.7451286698079014 at iter 0
max_prior_star_anomaly= 0.6759972895031281 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5873697149250674
accuracies_anomaly['prior'][-1]= 0.7133558157492476
accuracies_anomaly['prior_star'][-1]= 0.6759972895031281



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.29224514961243 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5873697149250674
 first_prior_anomaly_auc= 0.7130231495343304
 first_prior_star_anomaly_auc= 0.6761485730494666


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5873060497659832; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.713285847109066; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6765469530548245 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5871194667254992; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7134363427202672; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 190 
last prior star auc 0.6768917534708543 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5868619695226689; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7131805789747389; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 190 
last prior star auc 0.6772241045117166 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5865729549143515; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7129702002931119; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 190 
last prior star auc 0.6775476306790424 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5873697149250674 at iter 0
0.7134695935830562 at iter 190
0.6778007154451046 at iter 490
last anomaly aucs:
0.5862733819751957
0.7127546212395796
0.6778007154451046




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.684428215026855 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5862410766345714,first_prior_anomaly_auc= 0.7126978899097026, first_prior_star_anomaly_auc= 0.6778281355878784


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5862410766345714 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7091644735805348 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6797522731928707 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5862410766345714 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7077305892178956 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6820795184140442 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5862410766345715 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7080003782088659 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6847293442803788 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5862410766345714 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7091799171092236 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.687643601178751 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5862410766345714 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7112838615125203 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6913774682068172 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5862410766345714 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7134817277841686 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6951277242857367 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5862410766345715 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7167587500196984 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6989432213940148 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5862410766345715 at iter 2
max_prior_anomaly= 0.7209054950596467 at iter 79
max_prior_star_anomaly= 0.7025664623288211 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5862410766345714
accuracies_anomaly['prior'][-1]= 0.7209054950596467
accuracies_anomaly['prior_star'][-1]= 0.7025664623288211



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.35634136199951 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5862410766345715
 first_prior_anomaly_auc= 0.7214015790220148
 first_prior_star_anomaly_auc= 0.7029560174606426


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5860232913626551; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7201722426209874; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7031791606914919 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5857862804733915; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7193901382038231; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7033764596498416 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5855713317679689; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7188440991537577; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7036547583402935 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5853488188852294; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.718210126542383; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7039522826480924 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5862410766345715 at iter 0
0.7214015790220148 at iter 0
0.7042100950249774 at iter 490
last anomaly aucs:
0.5851672786296233
0.7174752982334495
0.7042100950249774




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.59154224395752 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5851436405755079,first_prior_anomaly_auc= 0.7174203003608743, first_prior_star_anomaly_auc= 0.7042346786012574


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5851436405755079 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.722320941740076 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7083089336085854 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5851436405755079 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7265132294309533 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7124068266700285 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5851436405755079 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7314498006524104 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7160666277951999 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5851436405755079 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7362694422995099 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7200267897946642 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5851436405755079 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.739970373638842 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7231066706588714 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5851436405755079 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7458437997384055 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7269779535748617 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5851436405755079 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7496734796791529 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7304948232661488 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5851436405755079 at iter 0
max_prior_anomaly= 0.7515700395543439 at iter 79
max_prior_star_anomaly= 0.7334179050380574 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5851436405755079
accuracies_anomaly['prior'][-1]= 0.7515700395543439
accuracies_anomaly['prior_star'][-1]= 0.7334179050380574



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.33197712898254 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5851436405755079
 first_prior_anomaly_auc= 0.7517630836629527
 first_prior_star_anomaly_auc= 0.7336653166711318


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5874043840711033; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7509893313582426; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7322372630285074 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5876766944545125; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7499799864475156; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7312249239642593 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5880110941267316; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7493294671982603; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7308943063806987 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5882808831177018; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7490502229856437; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7307332524386593 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5884242873126684 at iter 490
0.7517630836629527 at iter 0
0.7336653166711318 at iter 0
last anomaly aucs:
0.5884242873126684
0.749011614163922
0.7306352333075941




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.553858041763306 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5884408339505492,first_prior_anomaly_auc= 0.7490212269725955, first_prior_star_anomaly_auc= 0.7306320815670454


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5884408339505491 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7518568479442772 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7338244795688419 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5884408339505492 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7556661991584852 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7362601446648912 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5884408339505492 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7593609846037475 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7373651449012717 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5884408339505492 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7624933419480908 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7393696518902564 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5884408339505492 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7644790960808108 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7413303496856138 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5884408339505492 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7659419764564981 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7431325149313709 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5884408339505492 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7667946798619537 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7449104117749027 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5884408339505492 at iter 0
max_prior_anomaly= 0.7672414390847346 at iter 79
max_prior_star_anomaly= 0.7465089745812126 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5884408339505492
accuracies_anomaly['prior'][-1]= 0.7672414390847346
accuracies_anomaly['prior_star'][-1]= 0.7465089745812126



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.34247946739197 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5884408339505491
 first_prior_anomaly_auc= 0.767269016814536
 first_prior_star_anomaly_auc= 0.7466769623524592


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5895251902863357; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7679321430259862; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7465360795499314 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5900219045968136; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.768705737743669; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.7463305860661551 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5901760247096459; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7695043887987141; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.7462344579794191 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5903622925760751; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7700524764801362; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.7461780418235971 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5904842649353105 at iter 490
0.7703864033912728 at iter 490
0.7466769623524592 at iter 0
last anomaly aucs:
0.5904842649353105
0.7703864033912728
0.7461566099878658




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.60202622413635 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5904979750066974,first_prior_anomaly_auc= 0.7704215452983909, first_prior_star_anomaly_auc= 0.7461550341175915


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.59049781741967 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7719846510235278 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7485178940069653 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5904979750066974 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7724715949383048 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.75021510629245 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.59049781741967 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7728550041760562 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7518275367571742 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.59049781741967 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7732863198701483 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7535532722946247 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5904979750066974 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7735888869628251 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7550489307720188 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5904979750066974 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7738865688576517 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7565726397402965 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.59049781741967 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7741911845816852 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7580326835494902 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5904979750066974 at iter 0
max_prior_anomaly= 0.774291252344107 at iter 78
max_prior_star_anomaly= 0.7591313803047732 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.59049781741967
accuracies_anomaly['prior'][-1]= 0.77428368816679
accuracies_anomaly['prior_star'][-1]= 0.7591313803047732



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.65241146087646 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.490910695431552
accuracies_anomaly["prior"][-1]= 0.720060355831508
accuracies_anomaly["prior_star"][-1]= 0.49439793876168114


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 1048.1335036754608 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003279447555541992 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46657295491435147
 first_prior_anomaly_auc= 0.7062221661912791
 first_prior_star_anomaly_auc= 0.4702010810470082


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5873281119498244; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7553856942496494; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6572062971776164 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5848331941314591; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7594246497628315; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6571486203255749 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5820034038797927; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.763485037111745; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6552569456482342 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5810709614384544; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7673629386828876; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6554060229761887 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5873693997510125 at iter 110
0.7699057629575934 at iter 490
0.6583365113383866 at iter 140
last anomaly aucs:
0.58099563483934
0.7699057629575934
0.6562743274973604




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.646979093551636 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5810158059788518,first_prior_anomaly_auc= 0.7700811573191293, first_prior_star_anomaly_auc= 0.6563953543344312


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5810158059788518 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7798594323715271 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7653983012118443 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5810158059788518 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7786138645066738 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7589999527238919 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5810158059788518 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7806145894070002 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7561526703121798 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5810158059788518 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7808733473060498 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7518514899853443 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5810158059788518 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7804888349591061 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.746977323226752 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5810158059788518 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7790027892903857 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7403659170777062 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5810158059788518 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7733488819200405 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7374051720062405 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5810158059788518 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7760981452006871 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7383850481428369 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5810158059788518 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7612064862820493 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7252908268591329 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5810158059788518 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7658362355610886 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7281289692232535 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5810158059788518 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7600501126747246 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.723149219156279 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5810158059788518 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7531378728903037 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7176283152370897 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5810158059788518 at iter 0
max_prior_anomaly= 0.7920081314906157 at iter 8
max_prior_star_anomaly= 0.7682399104905684 at iter 11
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5810158059788518
accuracies_anomaly['prior'][-1]= 0.7622314323084923
accuracies_anomaly['prior_star'][-1]= 0.7242428731266841



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.53982543945312 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5810158059788518
 first_prior_anomaly_auc= 0.7544964306538285
 first_prior_star_anomaly_auc= 0.7188817624533148


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5885859716028177; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.730287753912098; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7147365932836409 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5905123154261942; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7185334951226816; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7137056589501553 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5897710260491356; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7150249775438486; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7145399246734008 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5897691350048064; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.7163723466284255; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7165879256819578 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5907770616322865 at iter 450
0.7544964306538285 at iter 0
0.7188817624533148 at iter 0
last anomaly aucs:
0.5899724222701987
0.7150864364845486
0.7171016593913989




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.634984731674194 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5895932678821879,first_prior_anomaly_auc= 0.7125127251524654, first_prior_star_anomaly_auc= 0.7142682446381013


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5895932678821879 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6799074964148951 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6945564713112817 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5895932678821879 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7188426808705108 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7336167798666814 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5895932678821879 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7282304552689223 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.730788092724207 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5895932678821879 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7197610980664072 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7228258505759805 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5895932678821879 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7182871865987992 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7235844745260571 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5895932678821879 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7159600989646533 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7186794207100872 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5895932678821879 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7286827300376633 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7268329735096206 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5895932678821879 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7115591660494509 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7150697322596404 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5895932678821879 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7113818806435854 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7142531162834675 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5895932678821879 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7108117307783224 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7117433852845234 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5895932678821879 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.711551286698079 iter_best_prior_anomaly= 1020
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7133608585341255 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5895932678821879 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.71021510629245 iter_best_prior_anomaly= 1020
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.711696581937375 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5895932678821879 at iter 0
max_prior_anomaly= 0.7391953606379122 at iter 102
max_prior_star_anomaly= 0.7390677151456893 at iter 22
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5895932678821879
accuracies_anomaly['prior'][-1]= 0.7102472540460469
accuracies_anomaly['prior_star'][-1]= 0.7095362213782562



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 117.68386101722717 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5895932678821879
 first_prior_anomaly_auc= 0.7132726097987613
 first_prior_star_anomaly_auc= 0.7144059757000804


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5905271286067731; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6761774114754875; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7055833083820541 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.591766392990529; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.673518287974534; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7052183368265125 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5927175882881321; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.679478702113242; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7096512599082844 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5907824195912192; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6719337504136659; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7056082071323888 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5953445640354886 at iter 170
0.7132726097987613 at iter 0
0.7190459681359032 at iter 320
last anomaly aucs:
0.5913128575255685
0.6823828734418583
0.7157607513749469




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.54100322723389 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5926480924090329,first_prior_anomaly_auc= 0.6827090785886505, first_prior_star_anomaly_auc= 0.7146978268748917


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5926479348220054 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7212728304205999 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7321603605591187 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5926479348220054 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7273003766329955 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7473028980254345 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5926480924090329 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7228460217154924 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7418324219550246 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5926480924090329 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7011048426493531 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7277217643443591 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5926479348220054 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6954447893849378 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7240433679499503 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5926479348220054 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6954536142584742 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7242003246292765 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5926480924090329 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7007115054288731 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7254644877633672 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5926482499960604 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6983465969081426 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7238403958586128 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5926480924090329 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7045277904722883 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7270759727059268 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5926479348220054 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6962166506453189 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7230518303733237 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5926480924090329 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6876313093906109 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7166675071308131 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5926480924090329 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6917725388845991 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7197002694738169 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5926482499960604 at iter 19
max_prior_anomaly= 0.7316450509794034 at iter 17
max_prior_star_anomaly= 0.749962021526388 at iter 13
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5926482499960604
accuracies_anomaly['prior'][-1]= 0.6952057298643176
accuracies_anomaly['prior_star'][-1]= 0.7220073435554785



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 117.4314489364624 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5926479348220054
 first_prior_anomaly_auc= 0.701335077296437
 first_prior_star_anomaly_auc= 0.727736892698993


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5971511417180138; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7136021242731299; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.7345957104811132 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4297366720771546; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7065994295349608; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 120 
last prior star auc 0.5420738452810565 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42925382542509105; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7163288526088533; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 260 
last prior star auc 0.5509110106056069 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4296430653828577; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.703301763398837; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 260 
last prior star auc 0.5531518981357454 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6000198559654569 at iter 20
0.7196632365223695 at iter 260
0.7356272751627086 at iter 110
last anomaly aucs:
0.42917471673731816
0.7085501993475898
0.5634413855051452




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.538795948028564 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4289351844556157,first_prior_anomaly_auc= 0.7100728052066754, first_prior_star_anomaly_auc= 0.5653404667727753


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4289351844556157 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7312293364010274 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.541165198480861 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4289350268685882 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7309280300045701 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5685602849173454 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4289350268685882 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7221693430196825 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.569863372047213 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42893486928156077 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.717108593220606 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5694829569629828 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4289351844556156 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7129155175945916 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.567926312305971 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.42893486928156077 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7107520052949241 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5664512977291709 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4289351844556156 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7119529760310133 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5667065887136171 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4289350268685882 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7087924106087587 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5651467923160565 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4289351844556157 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7073006918070504 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5645788486691775 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4289351844556156 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7082492081251871 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5647411633074365 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4289351844556157 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.711326725183983 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5667147832390438 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4289351844556157 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7096622910002048 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641469026269758 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4289351844556157 at iter 0
max_prior_anomaly= 0.7370160896355012 at iter 1
max_prior_star_anomaly= 0.5706264084340577 at iter 25
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4289350268685882
accuracies_anomaly['prior'][-1]= 0.7096058748443828
accuracies_anomaly['prior_star'][-1]= 0.5620467403123375



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 116.62646889686584 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4289351844556156
 first_prior_anomaly_auc= 0.7097492790393495
 first_prior_star_anomaly_auc= 0.5617416518272216


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4339697748081378; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7022070063192398; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 70 
last prior star auc 0.5707206454764644 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42965472682288797; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7136169374537088; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 70 
last prior star auc 0.5887186598799187 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4324938147091732; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7028006366515909; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 70 
last prior star auc 0.5986614557889594 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42635516964243503; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.7011894668830861; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 70 
last prior star auc 0.6306582410135998 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4361012969412358 at iter 340
0.7183046787588445 at iter 70
0.6926424192760452 at iter 490
last anomaly aucs:
0.43320075011425063
0.7061618103597713
0.6926424192760452




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.5789635181427 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43945191231857794,first_prior_anomaly_auc= 0.7032853743479837, first_prior_star_anomaly_auc= 0.6941223190506958


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4394519123185779 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.732963739224987 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6882865562506895 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43945254266668765 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7402116393778464 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7264963676190177 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4394522274926328 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7328903036702019 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7220713238886174 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4394522274926328 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7327995335423988 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7232185574483507 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43945191231857794 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.732415651543565 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7230587642025307 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43945191231857794 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7310985391682556 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7217225837969018 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4394522274926328 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7258950155223223 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7162406038734891 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4394522274926328 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.717265865073987 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7076291031722268 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43945191231857794 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7116431599350741 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7021995997289503 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4394519123185779 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7102970515467166 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7009272420694328 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4394522274926328 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7046834864553949 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6954238303102889 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4394522274926328 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7059612020738453 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.696752446538601 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43945254266668765 at iter 2
max_prior_anomaly= 0.7405840175236775 at iter 21
max_prior_star_anomaly= 0.727832705611674 at iter 22
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43945254266668765
accuracies_anomaly['prior'][-1]= 0.7089985344406449
accuracies_anomaly['prior_star'][-1]= 0.6996208456119892



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 116.58608150482178 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43945254266668765
 first_prior_anomaly_auc= 0.7151488409474132
 first_prior_star_anomaly_auc= 0.7056222323778306


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5637527774713585; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6967098980411932; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7130195250326993 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5747898576989142; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6957687883133461; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.715520431158107 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5786368722126793; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6909789306144318; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7125675654380131 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.586863860566998; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6932316371716281; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7206341301984021 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.586863860566998 at iter 400
0.7151488409474132 at iter 0
0.7278137951683817 at iter 390
last anomaly aucs:
0.5852057298643176
0.6999552452842082
0.7237114896701704




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.64109516143799 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5852753833304443,first_prior_anomaly_auc= 0.700150022850119, first_prior_star_anomaly_auc= 0.725322659438675


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5852753833304443 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7266501725577951 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7438195943709913 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5852753833304443 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7270980348897678 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7446091053784453 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5852753833304443 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7165056652536365 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7347805600642954 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5852753833304443 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7005553366846842 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7260434625021668 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5852753833304443 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6965683848905557 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7228015821737555 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5852753833304443 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7008805963093118 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7255655010479537 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5852753833304443 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6980222828056795 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7230650676836283 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5852753833304443 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6978186803662323 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7226096411743386 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5852753833304443 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6967524465386009 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.721816978426336 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5852753833304443 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6948781064342784 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7194727138061994 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5852753833304443 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6956171895929528 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.71986479033046 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5852753833304443 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6958529397859968 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7199375955371353 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5852753833304443 at iter 0
max_prior_anomaly= 0.7298157807649274 at iter 17
max_prior_star_anomaly= 0.7493433348566745 at iter 14
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5852753833304443
accuracies_anomaly['prior'][-1]= 0.6990566840537689
accuracies_anomaly['prior_star'][-1]= 0.7249923570291694



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 117.39816951751709 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5852753833304443
 first_prior_anomaly_auc= 0.6954337582930172
 first_prior_star_anomaly_auc= 0.7194982429046441


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5981726208298533; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6958639708779173; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 90 
last prior star auc 0.7205852782198969 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5944545125045306; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.7025990828435003; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 180 
last prior star auc 0.7235400349843202 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5976384008068456; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6965705911089399; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 240 
last prior star auc 0.7250853333753565 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5965986415998235; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.7080857903777361; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 350 
last prior star auc 0.7291952030508848 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5989933340687394 at iter 160
0.7092427943331705 at iter 350
0.7318530658556188 at iter 350
last anomaly aucs:
0.5963858991127851
0.695787541169611
0.7219045968135902




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.52932262420654 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5979144932789133,first_prior_anomaly_auc= 0.6996217911341538, first_prior_star_anomaly_auc= 0.7260475597648801


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5979144932789133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7189351844556157 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7402366957152087 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5979144932789133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7016748349275888 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7269149187638874 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5979144932789133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6992902280284286 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.724506358636557 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5979144932789133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6983913516239343 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7232484989835637 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5979144932789133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.698129126810281 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7234388641127063 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5979144932789132 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6969592007185967 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7212703090281608 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5979144932789133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6963565879256819 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7204358857178876 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5979144932789133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6957854925382542 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7197262713333438 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5979144932789133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6954908047969491 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7191710922356871 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5979144932789133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6951225239138313 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7187931985438959 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5979144932789133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6947255621917203 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7180318956143532 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5979144932789133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6949130907543691 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7198153080038451 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5979144932789133 at iter 0
max_prior_anomaly= 0.7342647777234979 at iter 5
max_prior_star_anomaly= 0.7587396189545677 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5979144932789133
accuracies_anomaly['prior'][-1]= 0.6950486155979639
accuracies_anomaly['prior_star'][-1]= 0.7182110720645477



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 117.3948380947113 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5979144932789133
 first_prior_anomaly_auc= 0.6947676379280457
 first_prior_star_anomaly_auc= 0.7172497911971887


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5961640165781552; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7024734859826339; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 60 
last prior star auc 0.7191570669902454 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6017016247222529; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7004707124509509; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 60 
last prior star auc 0.720088248735364 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5933258742140348; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6975655956001701; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 60 
last prior star auc 0.7179425437697968 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5993340372220559; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6981492979497927; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 330 
last prior star auc 0.7197844209464677 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6035378287659361 at iter 20
0.708540901712971 at iter 330
0.7245561561372268 at iter 170
last anomaly aucs:
0.5995537135383016
0.7003326662149172
0.7181187260664703




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.53564643859863 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.598687300061459,first_prior_anomaly_auc= 0.6992505160975149, first_prior_star_anomaly_auc= 0.7183245347243016


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.598687300061459 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7199071812408403 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7338831019430481 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.598687300061459 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7024974392108042 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7223864979434893 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.598687300061459 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7002455205887451 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7207457018138268 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.598687300061459 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7016058118095718 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7212004979750067 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.598687300061459 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7030382778889641 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.720543360070599 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.598687300061459 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6997737050286021 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7193280489150133 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.598687300061459 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6993420741604551 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7188329104748097 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.598687300061459 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7005616401657816 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7208935184455616 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.598687300061459 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7063414595710481 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7218623634902376 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.598687300061459 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.700636336416786 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7185725767054856 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.598687300061459 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7000772176434437 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7189233654285578 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.598687300061459 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7066391414658746 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7228412941046694 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.598687300061459 at iter 0
max_prior_anomaly= 0.7336640559749121 at iter 1
max_prior_star_anomaly= 0.7557523992624926 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.598687300061459
accuracies_anomaly['prior'][-1]= 0.6972822541248405
accuracies_anomaly['prior_star'][-1]= 0.7165532565359221



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 117.0028121471405 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.46657295491435147
accuracies_anomaly["prior"][-1]= 0.7062221661912791
accuracies_anomaly["prior_star"][-1]= 0.47020108104700814


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 1400.4772968292236 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0033812522888183594 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5103750571252974
 first_prior_anomaly_auc= 0.7334093953385759
 first_prior_star_anomaly_auc= 0.5139451912318578


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5874691523393794; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.756407646122571; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.658281671052839 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5863053721417653; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.7595787698756638; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 200 
last prior star auc 0.6584515498684148 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5823858675953796; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.7635039475550371; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 300 
last prior star auc 0.6556351545140804 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5809351214208046; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.7671396378650109; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 400 
last prior star auc 0.655318719762989 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5880497029484533 at iter 120
0.7692850276565234 at iter 490
0.6593693367162015 at iter 140
last anomaly aucs:
0.5809092771483051
0.7692850276565234
0.6562223237783065




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.551647663116455 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5809385883354082,first_prior_anomaly_auc= 0.769423389066612, first_prior_star_anomaly_auc= 0.6563313740012923


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5809385883354082 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7785659580503334 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7650405786595648 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5809385883354082 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7741188521360922 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.757231511102006 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5809385883354082 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7755812597506972 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7553631593047261 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5809385883354082 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7739212380036875 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7513866082544085 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5809385883354082 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7738797926154719 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7492115921017382 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5809385883354082 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7720494192918039 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7436442000094552 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5809385883354082 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7690685030808264 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7408867422033818 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5809385883354082 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7701974565453772 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7392284539136738 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5809385883354082 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7693294671982603 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7357996753707234 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5809385883354082 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7613968514111917 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7308787052649826 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5809385883354082 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7641052996517327 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7314798997746506 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5809385883354082 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7566147154766221 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7263069480120397 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5809385883354082 at iter 0
max_prior_anomaly= 0.810291693587784 at iter 8
max_prior_star_anomaly= 0.7650405786595648 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5809385883354082
accuracies_anomaly['prior'][-1]= 0.7526012890618845
accuracies_anomaly['prior_star'][-1]= 0.7193497959247994



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 117.39877676963806 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5809385883354082
 first_prior_anomaly_auc= 0.7580433994673559
 first_prior_star_anomaly_auc= 0.7247052334651811


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5835513812502955; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7480028996013048; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.7291056936193012 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5845331484312212; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7412212994626282; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.7320979560962542 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5848253147800874; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.7365743731975984; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.7291425689837212 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5849765983264258; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 350 
last prior auc 0.7403205320138047; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.7337365460075327 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5852114029973052 at iter 350
0.7613101785461021 at iter 10
0.7337365460075327 at iter 400
last anomaly aucs:
0.5848807854137448
0.7350152071481475
0.7297354113809351




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.549031496047974 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.584939092613896,first_prior_anomaly_auc= 0.7384197172888728, first_prior_star_anomaly_auc= 0.7330639645744362


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.584939092613896 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7389737932773374 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7386135493326189 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5849390926138961 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7394501788612761 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7390937170052161 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.584939092613896 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7403444852419748 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7358176402918513 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5849390926138961 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7435296342405093 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7363381502434719 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.584939092613896 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7428488582819862 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7364864396362891 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.584939092613896 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7355146004380919 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7314108766566337 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.584939092613896 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7392257749342075 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7318182391225554 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.584939092613896 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7428613076571536 iter_best_prior_anomaly= 740
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7325839544888665 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5849390926138961 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7470354728398758 iter_best_prior_anomaly= 740
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7347098034889767 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5849392502009234 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7381954709488314 iter_best_prior_anomaly= 740
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.73103865609783 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.584939092613896 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7500313598184598 iter_best_prior_anomaly= 740
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7383979702790866 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.584939092613896 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7349146666246436 iter_best_prior_anomaly= 740
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7271610697007422 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.584939407787951 at iter 11
max_prior_anomaly= 0.7538755377657311 at iter 74
max_prior_star_anomaly= 0.7468856075767842 at iter 7
last values
accuracies_anomaly['vanilla_star'][-1]= 0.584939092613896
accuracies_anomaly['prior'][-1]= 0.7379876136596436
accuracies_anomaly['prior_star'][-1]= 0.7286824148636084



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 117.42799115180969 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5849392502009234
 first_prior_anomaly_auc= 0.7344913878689507
 first_prior_star_anomaly_auc= 0.7249485478355422


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4264182044534094; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7014901429314339; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.44189829333249286 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4250227713254645; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.70560505539184; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4286004696093417 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 254


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 255 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6005682588209339 at iter 60
0.7344913878689507 at iter 0
0.7249485478355422 at iter 0
last anomaly aucs:
0.42490332035866807
0.6941774745102983
0.42843153631593045




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 29.388453245162964 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 2:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5103750571252974
accuracies_anomaly["prior"][-1]= 0.7334093953385759
accuracies_anomaly["prior_star"][-1]= 0.5139451912318578


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 379.4598186016083 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003341197967529297 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49073498589596104
 first_prior_anomaly_auc= 0.7248702270829066
 first_prior_star_anomaly_auc= 0.4942053674141545


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5842340482531477; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7534298816521423; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.6550506642293207 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5858691712498227; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.7589893943930535; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 200 
last prior star auc 0.6580251193721733 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5832432986116582; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.7639568526718881; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 300 
last prior star auc 0.6563925177679373 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5815629481381093; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.7681311754416376; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 400 
last prior star auc 0.6557051231542619 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5866782230486787 at iter 160
0.770675733173645 at iter 490
0.6584164079612966 at iter 170
last anomaly aucs:
0.5813788864900641
0.770675733173645
0.6563780197614132




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.77685570716858 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5813965362371369,first_prior_anomaly_auc= 0.770840884378398, first_prior_star_anomaly_auc= 0.6564598074286525


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5813965362371369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.783052303134406 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6563509147926943 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5813965362371369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7712756669870937 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6564914824211671 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5813965362371369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.742995571804529 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6648218478654837 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5813965362371369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7555719621160786 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7163124635579999 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5813965362371369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7790874135241187 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7482462139716659 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5813965362371369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7726224057235608 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7626632207636667 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5813965362371369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7697366720771547 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7620407520052949 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5813965362371369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7692443702034448 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7608868997904092 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5813965362371369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7694054241454843 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7607977055328805 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5813965362371369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7697246954630695 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7597588918480229 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5813965362371369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7702608065304064 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7592855004176056 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5813965362371369 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7710616638038357 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7590494350505066 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5813965362371369 at iter 0
max_prior_anomaly= 0.783052303134406 at iter 10
max_prior_star_anomaly= 0.7630697952944513 at iter 61
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5813965362371369
accuracies_anomaly['prior'][-1]= 0.7716053390484894
accuracies_anomaly['prior_star'][-1]= 0.758591487148778



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.06139993667603 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5813965362371369
 first_prior_anomaly_auc= 0.7714994405660525
 first_prior_star_anomaly_auc= 0.7584647871787195


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5823064437335519; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7519781899554029; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7565976960776589 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.582488299163213; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7493776888286556; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7577758166947698 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5823685330223616; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.748681154167389; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7581641111303717 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5820051373370945; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.7484277542272719; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7582473170808579 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5825062640843406 at iter 220
0.7714994405660525 at iter 0
0.7584647871787195 at iter 0
last anomaly aucs:
0.5816912239784421
0.7483062546291189
0.7581962588839688




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.733068227767944 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5816653797059426,first_prior_anomaly_auc= 0.7482982176907196, first_prior_star_anomaly_auc= 0.7581937374915299


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5816653797059426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7494549064720992 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7563767590651937 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5816653797059426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7509188899569788 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.756063791228706 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5816653797059426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7521014230108578 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7561135887293757 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5816653797059426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.75292544557732 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.756012417857762 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5816653797059426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7540799281403154 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7560779740611753 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5816653797059426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7548261027152244 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.755962935531147 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5816653797059426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7541922876908772 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.75523078620168 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5816653797059426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.756019666861024 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7556411428211229 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5816653797059426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7586762689695384 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.757725704020045 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5816653797059426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7569544731077739 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7553054824526844 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5816653797059426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7576910348740091 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7553202956332635 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5816653797059426 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7582930173188143 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7553962525804877 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5816653797059426 at iter 0
max_prior_anomaly= 0.7586762689695384 at iter 90
max_prior_star_anomaly= 0.764752194399357 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5816653797059426
accuracies_anomaly['prior'][-1]= 0.758464629591692
accuracies_anomaly['prior_star'][-1]= 0.755077926785067



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.43605160713196 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5816653797059426
 first_prior_anomaly_auc= 0.7581458310351893
 first_prior_star_anomaly_auc= 0.7547507761161102


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5775703232109932; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7371290795341727; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.757118678790362 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5741825172951762; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.727063680917787; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7498583292623351 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5741188521360922; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.733103991679405; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7553363695100619 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5735748617173835; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7290443922656287; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7519493515293821 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5816653797059426 at iter 0
0.7581458310351893 at iter 0
0.7583497486486912 at iter 50
last anomaly aucs:
0.5742036339568527
0.737263343681548
0.7577830656980317




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.74506664276123 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.574264147375388,first_prior_anomaly_auc= 0.7308339505491909, first_prior_star_anomaly_auc= 0.753138345651386


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.574264147375388 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7307234820429583 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.753777518634666 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.574264147375388 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7299185275068156 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.752872969097184 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.574264147375388 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7283499062357186 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7519936334840915 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.574264147375388 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7274447263501268 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7515388373229116 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.574264147375388 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7267277053752935 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7512813401200813 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.574264147375388 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7273013221551601 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.75133365901319 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.574264147375388 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7271714704445531 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7510559906708479 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.574264147375388 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7268808799659612 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7508215011740234 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.574264147375388 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7284959894101517 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7517643443591724 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.574264147375388 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7275164284476101 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7506954315520746 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.574264147375388 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7279244212616417 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7507307310462202 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.574264147375388 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7272505791323258 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7502324408654679 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.574264147375388 at iter 0
max_prior_anomaly= 0.7351954867075343 at iter 6
max_prior_star_anomaly= 0.7571101690908805 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.574264147375388
accuracies_anomaly['prior'][-1]= 0.7278479915533353
accuracies_anomaly['prior_star'][-1]= 0.7503506311360448



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.32059073448181 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.574264147375388
 first_prior_anomaly_auc= 0.7279802070693541
 first_prior_star_anomaly_auc= 0.7503679657090628


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5606634413855052; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.703928644593977; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.716840695273965 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5629733520336605; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7153827000961281; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7241924452779047 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5644575066580519; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7056025339994011; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7188009203082403 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5670800699686402; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7088872779992751; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7211176071985753 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.574264147375388 at iter 0
0.7279802070693541 at iter 0
0.7503679657090628 at iter 0
last anomaly aucs:
0.5651663331074586
0.6902513513087603
0.7120768394345778




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.64375042915344 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5655335108813843,first_prior_anomaly_auc= 0.700875553524434, first_prior_star_anomaly_auc= 0.7169888270797548


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5655335108813843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7079283609373276 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7283681863309013 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5655335108813843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7060384197172889 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7260475597648802 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5655335108813843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7051682241517878 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7258764202530847 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5655335108813843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7048435948752698 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7258767354271396 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5655335108813843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7045006855035694 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7255420205808658 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5655335108813843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7042589470034827 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.725305324865657 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5655335108813843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7042313692736814 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7250626408434058 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5655335108813843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7039639440881227 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7245870431946042 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5655335108813843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.704413067116315 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7248760578029217 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5655335108813843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7040553445640355 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7243456198685725 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5655335108813843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7041565154356493 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7241596671761981 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5655335108813843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7038772712230329 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7236156767574893 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5655335108813843 at iter 0
max_prior_anomaly= 0.7120658083426572 at iter 9
max_prior_star_anomaly= 0.7312409978410577 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5655335108813843
accuracies_anomaly['prior'][-1]= 0.7048719605402083
accuracies_anomaly['prior_star'][-1]= 0.7244685377499724



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.85555815696716 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5655335108813843
 first_prior_anomaly_auc= 0.7047509337031375
 first_prior_star_anomaly_auc= 0.724167231353515


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5709362245299967; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7077000173345731; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 70 
last prior star auc 0.7139313235734435 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5686965976960776; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7103818333674772; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 190 
last prior star auc 0.717433222497124 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5679159115621601; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7199870778637503; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 190 
last prior star auc 0.7222872181162047 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5641807838378745; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7101070015916291; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 190 
last prior star auc 0.7187544321351467 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5720626566021085 at iter 110
0.7213851899711616 at iter 190
0.724167231353515 at iter 0
last anomaly aucs:
0.5626720456372031
0.7045961832421955
0.7149074176213814




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.7261917591095 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5617310934963834,first_prior_anomaly_auc= 0.7141680192886521, first_prior_star_anomaly_auc= 0.7196523630174765


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5617310934963834 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7248019919000268 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7331203807302583 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5617312510834108 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7248568321855745 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7297218588965756 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5617312510834108 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7245772727989032 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7295869644010905 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5617312510834108 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7242564256110438 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7295459917739572 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5617312510834109 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7253774997242227 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7299973210205336 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5617312510834108 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7248180657768253 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7293089808846936 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5617312510834108 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7251527806230991 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7302582851379673 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5617312510834108 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7251136990402951 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7300080369383992 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5617312510834108 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.724947759900405 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7298898466678223 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5617312510834108 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7247666924058811 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7289572466394567 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5617312510834108 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7242926706273539 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7283924547331264 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5617310934963834 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7248552563153001 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7294035331011551 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5617312510834109 at iter 2
max_prior_anomaly= 0.7265228422396268 at iter 14
max_prior_star_anomaly= 0.7350813936996707 at iter 11
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5617312510834109
accuracies_anomaly['prior'][-1]= 0.7248814157618544
accuracies_anomaly['prior_star'][-1]= 0.7288116362261059



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.55408978462219 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5617312510834108
 first_prior_anomaly_auc= 0.724083395054919
 first_prior_star_anomaly_auc= 0.7268629150448336


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5624266826354855; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.7169566793261579; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 90 
last prior star auc 0.720726318609452 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5625286414422365; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.7212900074065902; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 160 
last prior star auc 0.7270851127535182 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5607223789337661; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.724132877381534; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 270 
last prior star auc 0.7287422979340341 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5577556455552579; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.7271216729438833; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 270 
last prior star auc 0.7276990718124086 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5648029374221915 at iter 90
0.7295037584506043 at iter 270
0.7327623430039238 at iter 430
last anomaly aucs:
0.5527954362796854
0.7169229557022866
0.7217060371590209




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.69531059265137 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5564347510912901,first_prior_anomaly_auc= 0.7180462360338498, first_prior_star_anomaly_auc= 0.7221932962478529


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5564347510912901 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7301839040610177 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7375221015805979 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5564347510912901 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7248108167735632 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7284189293537355 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5564347510912901 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7225711899396442 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7269965488440991 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5564347510912901 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.721188678947949 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7262114502734136 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5564347510912901 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7216155822052729 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7263888932663063 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5564347510912901 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.720661235167121 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7253157256094678 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5564347510912901 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7203816757804499 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7252769592007187 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5564347510912901 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7203706446885293 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7251121231700206 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5564347510912901 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7207988086420725 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.726119419449391 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5564347510912901 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7193691791291741 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7240679515262304 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5564347510912901 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7184335849472872 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7233736230833478 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5564347510912901 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7194122003876641 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7242854216240919 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5564347510912901 at iter 0
max_prior_anomaly= 0.7301839040610177 at iter 10
max_prior_star_anomaly= 0.7383992309753061 at iter 11
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5564347510912901
accuracies_anomaly['prior'][-1]= 0.7192965315095261
accuracies_anomaly['prior_star'][-1]= 0.7239084734544652



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.20034193992615 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5564347510912901
 first_prior_anomaly_auc= 0.7191298044344989
 first_prior_star_anomaly_auc= 0.7227905510818349


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5577833808720867; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7291709346486597; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 70 
last prior star auc 0.7310988543423105 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4078084372094489; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7258017240020802; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 70 
last prior star auc 0.6277201884740848 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4217274689947524; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.723203429093717; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 220 
last prior star auc 0.47776793734339795 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4216896481081677; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7228436579100809; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 220 
last prior star auc 0.48157508233922186 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.563289786784752 at iter 60
0.7311358872937579 at iter 220
0.7313084450888003 at iter 40
last anomaly aucs:
0.42257245063586363
0.7302447326536079
0.48675638621428685




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.65301179885864 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.42295585987361517,first_prior_anomaly_auc= 0.7223066013205792, first_prior_star_anomaly_auc= 0.48506421671368016


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42295585987361517 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7327322438816837 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47355469057787164 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42295585987361517 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7273246450352207 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4871944781505586 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42295585987361517 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7257875411696109 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48693540507745403 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42295585987361517 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7245856249113574 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4871059142411397 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.42295585987361517 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7238443355342988 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48673684542288487 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.42295585987361517 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7244190554233575 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48715649967694663 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.42295585987361517 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7242636746143056 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4871122177222371 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.42295585987361517 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7241996942811667 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4870948831492191 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.42295585987361517 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7242910947570795 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4873941409143199 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.42295585987361517 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7234440644846116 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4866709740454166 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.42295585987361517 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7241511574767167 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4869183856784909 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.42295585987361517 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7236062215358432 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48743999873930377 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.42295585987361517 at iter 0
max_prior_anomaly= 0.7327322438816837 at iter 10
max_prior_star_anomaly= 0.4882392801424587 at iter 122
last values
accuracies_anomaly['vanilla_star'][-1]= 0.42295585987361517
accuracies_anomaly['prior'][-1]= 0.7241183793750099
accuracies_anomaly['prior_star'][-1]= 0.4880233859148715



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.78701400756836 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.42295585987361517
 first_prior_anomaly_auc= 0.7232188726224058
 first_prior_star_anomaly_auc= 0.4874697826874891


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42583072001512834; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7189236806026128; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 60 
last prior star auc 0.4895954741005721 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42482752099847143; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7223398521833682; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 60 
last prior star auc 0.49428211229651575 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4236248168050806; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.716223584474526; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 270 
last prior star auc 0.49996265187449773 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.423289471610697; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7193307278944796; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 270 
last prior star auc 0.5042290054682699 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4267226625904156 at iter 170
0.732934428037884 at iter 270
0.5117927100241109 at iter 490
last anomaly aucs:
0.42306128559496986
0.7214022093701247
0.5117927100241109




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.64141058921814 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.42445687630994217,first_prior_anomaly_auc= 0.7241990639330569, first_prior_star_anomaly_auc= 0.5140964747781963


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42445687630994217 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7447231983863087 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4996668610240005 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42445687630994217 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7332600028365664 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5155840963171912 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42445687630994217 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7340665332429834 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.516528357785587 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42445687630994217 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.733659328364089 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.517010574089541 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.42445687630994217 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7338408686196951 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5171574451991112 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.42445687630994217 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7341199552452842 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5172787872102368 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.42445687630994217 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7343813921238004 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5172631860945207 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.42445687630994217 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7347028696597696 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5174868020864523 iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.42445687630994217 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7349780166096728 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5171689490521141 iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.42445687630994217 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7352801109412673 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5169828387727122 iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.42445687630994217 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7349342074160454 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5170613171123752 iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.42445687630994217 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7349007989662291 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5170594260680461 iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.42445687630994217 at iter 0
max_prior_anomaly= 0.7457399498873253 at iter 6
max_prior_star_anomaly= 0.5179970688812897 at iter 77
last values
accuracies_anomaly['vanilla_star'][-1]= 0.42445687630994217
accuracies_anomaly['prior'][-1]= 0.7345574168334463
accuracies_anomaly['prior_star'][-1]= 0.5164795058070819



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 121.13898015022278 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4907349858959611
accuracies_anomaly["prior"][-1]= 0.7248702270829066
accuracies_anomaly["prior_star"][-1]= 0.4942053674141545


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 1426.1319315433502 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0034334659576416016 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4626167325905731
 first_prior_anomaly_auc= 0.7074938935026869
 first_prior_star_anomaly_auc= 0.4661909639598468


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5858174827048237; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7572039333722048; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6567147832390439 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5854022408875301; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.7616773563200276; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6576380856327908 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5821529539688293; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.766132499172668; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6555379233181524 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5806933829207179; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.770657925839545; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.655122366326804 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5871572876120839 at iter 130
0.7738961816663251 at iter 490
0.6585067053280174 at iter 140
last anomaly aucs:
0.5806205777140425
0.7738961816663251
0.6557795042312118




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.768571853637695 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5806347605465119,first_prior_anomaly_auc= 0.7741727468994751, first_prior_star_anomaly_auc= 0.6558753171438927


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5806347605465119 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7709026584931529 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6556824306223111 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5806347605465119 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7076361945884615 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6556329482956963 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5806347605465119 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6624523693209575 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6608497092519343 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5806347605465119 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.675244181099012 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7048152292103315 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5806347605465119 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7754041319318593 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7413413807775344 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5806347605465119 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7787493893502686 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7654953748207447 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5806347605465119 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7739779693335644 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7647269804749672 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5806347605465119 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7733176796886081 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.763795956316876 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5806347605465119 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.773243928959768 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.761924767953102 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5806347605465119 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7738771136360054 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7617299903871912 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5806347605465119 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7743167814425517 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7605316986305688 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5806347605465119 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7749244370203445 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7597963975605528 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5806347605465119 at iter 0
max_prior_anomaly= 0.7834874009171564 at iter 55
max_prior_star_anomaly= 0.7659627779441196 at iter 63
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5806347605465119
accuracies_anomaly['prior'][-1]= 0.7751248877192429
accuracies_anomaly['prior_star'][-1]= 0.7591953606379123



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.99570655822754 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5806347605465119
 first_prior_anomaly_auc= 0.7751582961690593
 first_prior_star_anomaly_auc= 0.7591414658745292


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5815295396882929; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7556871582331344; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7580292166348866 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5814520068707945; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7525341569881967; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7591351623934317 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5813435869959185; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7517084009644326; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7595795578108011 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5813735285311313; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7512898498195628; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7597298958349749 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5815954110657611 at iter 80
0.7751582961690593 at iter 0
0.7597541642372001 at iter 450
last anomaly aucs:
0.5813873961895456
0.7510408623162141
0.7597541642371999




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.917057514190674 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5813949603668627,first_prior_anomaly_auc= 0.7510287281151016, first_prior_star_anomaly_auc= 0.7597588918480231


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5813949603668627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7597109853916826 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.760717651322943 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5813949603668627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7624690735458657 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7610697007422349 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5813949603668627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7638306254629119 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7610643427833019 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5813949603668627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7639904187087319 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7606851883952912 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5813949603668627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7649132483413965 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7606316088059631 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5813949603668627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.765205887451345 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7603490552657706 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5813949603668627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7653875852939787 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7600206439005941 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5813949603668627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7659262177537545 iter_best_prior_anomaly= 750
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7598849614699718 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5813949603668627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7660440928502765 iter_best_prior_anomaly= 840
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7596183242195502 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5813949603668627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7653875852939787 iter_best_prior_anomaly= 990
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7591830688497723 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5813949603668627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7669138156546953 iter_best_prior_anomaly= 1040
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.759418661455789 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5813949603668627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7666553729297003 iter_best_prior_anomaly= 1170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7589983768536174 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5813949603668627 at iter 0
max_prior_anomaly= 0.7680208645224326 at iter 129
max_prior_star_anomaly= 0.7627186913973242 at iter 38
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5813949603668627
accuracies_anomaly['prior'][-1]= 0.7680208645224326
accuracies_anomaly['prior_star'][-1]= 0.7594670406732117



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.41957092285156 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5813949603668627
 first_prior_anomaly_auc= 0.767215594812235
 first_prior_star_anomaly_auc= 0.7589117039885276


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5669707045715997; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7214428668232031; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7427643916352805 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.568465732700884; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7201503380241738; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7435948752698678 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5688336984099469; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7194670406732118; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.743709913799896 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5683205950486155; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7306929101596357; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7495633263469751 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5813949603668627 at iter 0
0.767215594812235 at iter 0
0.7589117039885276 at iter 0
last anomaly aucs:
0.5681961012969412
0.723833934790488
0.7450598042769119




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.77648305892944 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5685212033345415,first_prior_anomaly_auc= 0.7263778621743857, first_prior_star_anomaly_auc= 0.7474239248625052


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5685212033345415 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7245079345068315 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7482767858549885 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5685212033345415 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7248249996060324 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7486677592700569 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5685212033345415 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7250314386119734 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.748725593709126 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5685212033345415 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7254375403816757 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7491507635091479 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5685212033345415 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.725418472351356 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7489887640449437 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5685212033345415 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7257438895630111 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7490555809445767 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5685212033345415 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7268849772286745 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7493717005216132 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5685212033345415 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.726718880501757 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7491394172431725 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5685212033345415 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7264689474762437 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7490354098050649 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5685212033345415 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7263113604488078 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7487709787730273 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5685212033345415 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7270381518193423 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7493181209322849 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5685212033345415 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7270936224529996 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7491573821643002 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5685213609215689 at iter 1
max_prior_anomaly= 0.7287731849914114 at iter 124
max_prior_star_anomaly= 0.7526019194099942 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5685212033345415
accuracies_anomaly['prior'][-1]= 0.7275581890098808
accuracies_anomaly['prior_star'][-1]= 0.7493124477992972



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.7672507762909 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5685212033345415
 first_prior_anomaly_auc= 0.727313929117355
 first_prior_star_anomaly_auc= 0.7495355910301463


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5667771877019083; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7146521266369353; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7301467135225428 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5660560694643617; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7110487416675859; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7287196054020834 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5638102967363727; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7084674661581858; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7242151378098556 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5634350820240478; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7251789400696536; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7332029563326348 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5685212033345415 at iter 0
0.727313929117355 at iter 0
0.7495355910301463 at iter 0
last anomaly aucs:
0.5606186866697134
0.7145148683360385
0.7276647178404274




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.769179582595825 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5607469625100461,first_prior_anomaly_auc= 0.7082591361079157, first_prior_star_anomaly_auc= 0.7248391824385017


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5607469625100461 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7124518965598752 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.732907323069165 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5607469625100461 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7133455725924642 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7338216430023481 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5607469625100462 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7131449643065382 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7335228579983296 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5607469625100461 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7131736451455317 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7336697291078998 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5607469625100462 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7131021006350757 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7336208771293947 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5607469625100461 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7130548245268449 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7333871755677073 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5607469625100461 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7127963818018501 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7325521219093245 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5607469625100461 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7126438375592921 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7325442425579526 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5607469625100462 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7128844729501866 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7322980916210977 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5607469625100461 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7128920371275036 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7315921017381849 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5607469625100461 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7131355090848921 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.732032084718786 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5607469625100462 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7127415415163023 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7312154687426131 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5607469625100462 at iter 2
max_prior_anomaly= 0.7144025087854768 at iter 2
max_prior_star_anomaly= 0.7431905069574674 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5607469625100461
accuracies_anomaly['prior'][-1]= 0.7120052949241218
accuracies_anomaly['prior_star'][-1]= 0.7304382495232993



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.52437663078308 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5607469625100461
 first_prior_anomaly_auc= 0.7119107427076603
 first_prior_star_anomaly_auc= 0.7304100414453882


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5663892084403612; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.7214866760168304; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 40 
last prior star auc 0.725016783018422 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.566404336794995; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.720125439273839; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 160 
last prior star auc 0.7249381470917313 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5646475566131396; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.7302753045369305; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 300 
last prior star auc 0.7281945254266668 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5636935247490427; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.7239672534156988; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 300 
last prior star auc 0.7234757394771263 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5694668830861843 at iter 90
0.7302753045369305 at iter 300
0.7324708070031675 at iter 340
last anomaly aucs:
0.5676681847550309
0.7192535102510361
0.7243257639031155




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.85474920272827 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.568504026348551,first_prior_anomaly_auc= 0.7194289046125723, first_prior_star_anomaly_auc= 0.7260377893691792


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.568504026348551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.723451786248956 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7283639314811604 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.568504026348551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7220792032399892 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7285862867768724 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.568504026348551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7226323337062893 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7287514379816253 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.568504026348551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7222828056794365 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7294029027530453 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.568504026348551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7226131080889421 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7301675150101643 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.568504026348551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7220489465307216 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.727417306207353 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.568504026348551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7227601367855397 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7286685472051941 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.568504026348551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7211650408938337 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7269287864223016 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.568504026348551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7214031548922893 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7272981704146115 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.568504026348551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7224158091305923 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7282320311391967 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.568504026348551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7228236443575965 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7298892163197126 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.568504026348551 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7220445340939534 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7285175788329105 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.568504026348551 at iter 0
max_prior_anomaly= 0.7307171785618607 at iter 3
max_prior_star_anomaly= 0.7422292260901082 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.568504026348551
accuracies_anomaly['prior'][-1]= 0.7219638495359062
accuracies_anomaly['prior_star'][-1]= 0.7272155948122351



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.6564929485321 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.568504026348551
 first_prior_anomaly_auc= 0.7225267503979073
 first_prior_star_anomaly_auc= 0.72915801251241


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42035898324849896; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7074931055675495; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5432856895220386 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42036024394471844; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7140561324991727; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5500887214964465 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.41925744992672204; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7202111666167641; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5569254770947256 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4190144507304159; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7125864758813054; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5573471799801442 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.568504026348551 at iter 0
0.7227683313109665 at iter 420
0.72915801251241 at iter 0
last anomaly aucs:
0.4205767685204154
0.72077438265282
0.5655037269331988




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.63920474052429 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.42090990749641494,first_prior_anomaly_auc= 0.7187213388593852, first_prior_star_anomaly_auc= 0.5648636084277542


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42090990749641494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.72164709961076 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5661941157003956 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42090990749641494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7189737932773373 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5646374710433837 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42090990749641494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7191532849015869 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5661849756528043 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42090990749641494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7184001764974708 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5664850213530422 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.42090990749641494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7176374552846809 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5634883464393211 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.42090990749641494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7171060718281672 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5631769544731078 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.42090990749641494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7172373418220211 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5646150936854878 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.42090990749641494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7148954410072962 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5621447594434026 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.42090990749641494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7166821627243645 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5652088816048663 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.42090990749641494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7172910789983769 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5657585451565628 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.42090990749641494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7160464566556881 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5639172983280016 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.42090990749641494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7176377704587358 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5651991112091652 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.42090990749641494 at iter 0
max_prior_anomaly= 0.7285167908977733 at iter 3
max_prior_star_anomaly= 0.5709314969191737 at iter 127
last values
accuracies_anomaly['vanilla_star'][-1]= 0.42090990749641494
accuracies_anomaly['prior'][-1]= 0.7170737664875427
accuracies_anomaly['prior_star'][-1]= 0.5646759222780781



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 118.58432483673096 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.42090990749641494
 first_prior_anomaly_auc= 0.7189473186567281
 first_prior_star_anomaly_auc= 0.5673095166805868


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.414256898372126; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7007784799155334; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5560143089020912 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4133860724585152; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7060346376286304; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5703663898387885 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4160080054209937; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7045512709393763; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5733296563026932 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4114288415777613; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7090076744882361; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5769179129174087 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.42090990749641494 at iter 0
0.7189473186567281 at iter 0
0.5829648423341791 at iter 440
last anomaly aucs:
0.41068187906771514
0.7070082102841294
0.5823940621208061




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.91265511512756 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.41002915360007564,first_prior_anomaly_auc= 0.7009931134469011, first_prior_star_anomaly_auc= 0.5772113399624943


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.41002915360007564 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7082522022787084 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5783387175567708 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.41002915360007564 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7083086184345304 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5796495264509826 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.41002915360007564 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7083798477709315 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5822465606631262 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.41002915360007564 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7071692642261688 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5795045463857414 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.41002915360007564 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7074321193879319 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5790436043304914 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.41002915360007564 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7061865515230785 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5789788360622153 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.41002915360007564 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7074771892777786 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5818982933324929 iter_best_prior_star_anomaly= 660
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.41002915360007564 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7065433285531935 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5788899569787415 iter_best_prior_star_anomaly= 660
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.41002915360007564 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7075090218573207 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.583658225254897 iter_best_prior_star_anomaly= 830
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.41002915360007564 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7086137069196464 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.584611941944939 iter_best_prior_star_anomaly= 830
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.41002915360007564 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7075585041839356 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5817173834249965 iter_best_prior_star_anomaly= 830
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.41002915360007564 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7059493830467876 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5789819878027641 iter_best_prior_star_anomaly= 830
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.41002915360007564 at iter 0
max_prior_anomaly= 0.7252498542319996 at iter 3
max_prior_star_anomaly= 0.5853294356808547 at iter 123
last values
accuracies_anomaly['vanilla_star'][-1]= 0.41002915360007564
accuracies_anomaly['prior'][-1]= 0.7050399483114549
accuracies_anomaly['prior_star'][-1]= 0.5803318782797801



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.74066305160522 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.41002915360007564
 first_prior_anomaly_auc= 0.7077674645823157
 first_prior_star_anomaly_auc= 0.583348724333013


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.41405676284728243; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7071969995429976; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 50 
last prior star auc 0.5899683250074854 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4115044833509306; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.710485210457475; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 50 
last prior star auc 0.5972595615928897 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.41349071024473266; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.716007690246939; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 50 
last prior star auc 0.5992944828781694 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4130078635926691; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 330 
last prior auc 0.7126238240068077; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 350 
last prior star auc 0.6060787619963124 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4151519926879619 at iter 330
0.7175271443654759 at iter 350
0.6122902122697259 at iter 480
last anomaly aucs:
0.4065042469703894
0.7038832595300755
0.6052761712655814




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.81958055496216 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.41039979828860484,first_prior_anomaly_auc= 0.7148092409032888, first_prior_star_anomaly_auc= 0.616872843027562


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.41039979828860484 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7224416534030917 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6178769875663835 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.41039979828860484 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7226298123138503 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6201509683722836 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.41039979828860484 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7217268386466427 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6192070220779425 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.41039979828860484 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7210091873236996 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6188192004034228 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.41039979828860484 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7197634618718187 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6174864869123974 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.41039979828860484 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.721540413193186 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6191884268087051 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.41039979828860484 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.721025261200498 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6186504246970389 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.41039979828860484 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7202029720913374 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6189693808405692 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.41039979828860484 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7199907023653813 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6171092235687159 iter_best_prior_star_anomaly= 810
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.41039979828860484 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7188311770175079 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6161662227965394 iter_best_prior_star_anomaly= 810
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.41039979828860484 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7202890146083174 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.61791654191027 iter_best_prior_star_anomaly= 810
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.41039979828860484 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7191162519501395 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6163978757268702 iter_best_prior_star_anomaly= 810
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.41039979828860484 at iter 0
max_prior_anomaly= 0.7321496446412532 at iter 3
max_prior_star_anomaly= 0.6202464661109097 at iter 81
last values
accuracies_anomaly['vanilla_star'][-1]= 0.41039979828860484
accuracies_anomaly['prior'][-1]= 0.7188827079754794
accuracies_anomaly['prior_star'][-1]= 0.6162620357092204



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.94346237182617 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4626167325905731
accuracies_anomaly["prior"][-1]= 0.7074938935026869
accuracies_anomaly["prior_star"][-1]= 0.4661909639598468


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 1426.255764245987 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0034110546112060547 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.45007548418614174
 first_prior_anomaly_auc= 0.6934585624911356
 first_prior_star_anomaly_auc= 0.4535041051420647


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5845993349827443; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7551373370944102; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6552500118190271 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5849557968388042; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.7589893943930535; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6571051263060024 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5826005011267472; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.7636517641867722; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6555576216965819 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5821638274737224; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.7676540019225618; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6560133633799266 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5862240572356083 at iter 150
0.7699837685361741 at iter 490
0.6579170146713522 at iter 160
last anomaly aucs:
0.5824835715523898
0.7699837685361741
0.6571415289093401




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.68699765205383 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5825251745276329,first_prior_anomaly_auc= 0.7701284334273604, first_prior_star_anomaly_auc= 0.6572671257702065


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5825251745276329 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7720215263879477 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6572447484123107 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5825251745276329 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.773716059693966 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6572425421939265 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5825251745276329 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7752925603164347 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6572475849788045 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5825251745276329 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7766435539026427 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6572302504057865 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.582525174527633 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7777160912113714 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6572189041398112 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.582525174527633 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7786259987077864 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6572223710544148 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5825251745276329 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7789849819562853 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6572239469246892 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.582525174527633 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7791709346486596 iter_best_prior_anomaly= 790
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6572179586176466 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.582525174527633 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7790291063239673 iter_best_prior_anomaly= 790
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6572132310068235 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.582525174527633 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7791929968325009 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6572171706825094 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.582525174527633 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7790453377877933 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6572048788943694 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.582525174527633 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7784334273602598 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6572044061332871 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.582525174527633 at iter 1
max_prior_anomaly= 0.7791929968325009 at iter 100
max_prior_star_anomaly= 0.6572671257702065 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.582525174527633
accuracies_anomaly['prior'][-1]= 0.7771878594954064
accuracies_anomaly['prior_star'][-1]= 0.6572230014025244



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 118.99476075172424 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5825251745276329
 first_prior_anomaly_auc= 0.7770490253242353
 first_prior_star_anomaly_auc= 0.6572245772727989


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5830099122240258; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7784222386813118; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6585628063097846 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5835641457995178; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.778156231779; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 140 
last prior star auc 0.6598710938115575 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5841584064799785; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7768019288652158; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 140 
last prior star auc 0.6610577241281498 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.584894968246214; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7746264399514631; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 140 
last prior star auc 0.6622566462328822 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5854767795515073 at iter 490
0.7784862190144507 at iter 140
0.6632374678916431 at iter 490
last anomaly aucs:
0.5854767795515073
0.7727376018406165
0.6632374678916431




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.6447331905365 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5855240556597381,first_prior_anomaly_auc= 0.7725406180563216, first_prior_star_anomaly_auc= 0.6633263469751169


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5855240556597381 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.770235750193044 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6633242983437604 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5855240556597381 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7672839875821421 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6633616464692627 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5855240556597381 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7635573695573381 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6634182202121122 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5855240556597381 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7595234568290339 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6635015837496256 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5855240556597381 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7549286918700853 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6636100036245016 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5855240556597381 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7508022755566761 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.663783664528736 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5855240556597381 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7454339158800447 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.663962998565958 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5855240556597381 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7389436941550972 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6642192350725687 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5855240556597381 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7336237136958885 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6645151835100934 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5855240556597381 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7286493215878469 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.664887404068897 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5855240556597381 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.723426887498621 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6653422002300771 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5855240556597381 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7191137305577004 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6658902879114992 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5855240556597381 at iter 0
max_prior_anomaly= 0.7725406180563216 at iter 0
max_prior_star_anomaly= 0.6664558677529665 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5855240556597381
accuracies_anomaly['prior'][-1]= 0.7160485052870447
accuracies_anomaly['prior_star'][-1]= 0.6664558677529665



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.00239539146423 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5855240556597381
 first_prior_anomaly_auc= 0.7157787162960746
 first_prior_star_anomaly_auc= 0.6665140173660905


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5861096490536899; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7143973084135714; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6674346407803711 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5866684526529775; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7131649778590226; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6683043635847897 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5872225286414422; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7123091227130182; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6690814252170761 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5876789006728966; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7114029973052618; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.669801913106513 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5880136155191704 at iter 490
0.7157787162960746 at iter 0
0.6703728509069133 at iter 490
last anomaly aucs:
0.5880136155191704
0.7104384071103267
0.6703728509069133




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.69104743003845 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5880438722284382,first_prior_anomaly_auc= 0.710346376286304, first_prior_star_anomaly_auc= 0.6704139811210741


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5880438722284382 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7080574247127976 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6711680350473549 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5880438722284382 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7050651622358448 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6720522558582978 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5880438722284381 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7021173393006288 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.673107616181036 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5880438722284382 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6999152181792394 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6743076413949605 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5880438722284381 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6981641111303717 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.675714893549963 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5880438722284382 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.6966164489339239 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6773487558504183 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5880438722284382 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.6953187197629891 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6792968466835809 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5880438722284381 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.6945919283924546 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6813251493137086 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5880438722284382 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.6943287580566366 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6837874466173944 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5880438722284382 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.6948417038309406 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6864777723497801 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5880438722284381 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.6958408055848841 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6893475897064154 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5880438722284381 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.6968539325842698 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6924771104842649 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5880440298154657 at iter 53
max_prior_anomaly= 0.710346376286304 at iter 0
max_prior_star_anomaly= 0.6955658162220086 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5880438722284381
accuracies_anomaly['prior'][-1]= 0.6978336511338387
accuracies_anomaly['prior_star'][-1]= 0.6955658162220086



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.1133873462677 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5880438722284382
 first_prior_anomaly_auc= 0.6979250516097515
 first_prior_star_anomaly_auc= 0.6958677529665758


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5883164977859022; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6976549474447264; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6963578486219015 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5885033960004412; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6968955355595128; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.696737633358022 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5882761555068786; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.6949351529382102; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6966991821233276 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5882692216776715; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.693418535386167; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6969070394125156 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.588513796744252 at iter 220
0.6979250516097515 at iter 0
0.6971725735537451 at iter 490
last anomaly aucs:
0.5883483303654443
0.6924197488062783
0.6971725735537451




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.59578537940979 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5883590462833099,first_prior_anomaly_auc= 0.6923357549206549, first_prior_star_anomaly_auc= 0.6971974723040799


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5883590462833099 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6930674314890397 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7007063050569677 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5883590462833099 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.694131143924232 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7044173219660557 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.58835904628331 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6955683376144476 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.708344233102731 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5883590462833099 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6972852482783617 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7122007028381423 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5883590462833099 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6996476354066532 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7156600532644153 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5883590462833099 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7028843153631593 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7192725782813558 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5883590462833099 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7070964590194935 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7225964038640339 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5883590462833099 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7121898293332493 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7259649841625038 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5883590462833099 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7177904722883213 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7291044329230818 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5883590462833099 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7252952392959011 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7318038987030588 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5883590462833099 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7330638069874088 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7343161510944418 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5883590462833099 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7391865357643759 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7367322753990891 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.58835904628331 at iter 5
max_prior_anomaly= 0.7431233748837796 at iter 129
max_prior_star_anomaly= 0.7389249412988323 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.58835904628331
accuracies_anomaly['prior'][-1]= 0.7431233748837796
accuracies_anomaly['prior_star'][-1]= 0.7389249412988323



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.38801002502441 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5883590462833099
 first_prior_anomaly_auc= 0.7434355547851301
 first_prior_star_anomaly_auc= 0.7390746489748964


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5893455410750587; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7425286414422365; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7389927037206298 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5899352317317239; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7417605622705139; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7390380887845313 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5903500007879352; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7409940589690658; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7391512362702303 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5906891280709772; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7402866508029058; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7392640685818743 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5909248782640213 at iter 490
0.7434355547851301 at iter 0
0.7393538931875129 at iter 490
last anomaly aucs:
0.5909248782640213
0.7396255732228123
0.7393538931875129




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.499799966812134 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.590947885970027,first_prior_anomaly_auc= 0.7395452038388199, first_prior_star_anomaly_auc= 0.7393176481712026


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.590947885970027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7432916778290811 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7420795184140442 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5909475707959722 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7463354712640056 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7441445388215642 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.590947885970027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7487397765415951 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7461014545282633 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.590947885970027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7503162771640638 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7481475644924911 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5909477283829996 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.751280867358999 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.74994468695337 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.590947885970027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7521887262240572 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7516400081945255 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.590947885970027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7529129962021528 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7535225428242749 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.590947885970027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.753477788108483 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7550331720692751 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.590947885970027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.754057708369447 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7567136801298517 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.590947885970027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7546284885828198 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7582785193122902 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5909477283829996 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7551890256394094 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7600642955071939 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.590947885970027 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7555738531604078 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7613004081504011 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.590947885970027 at iter 0
max_prior_anomaly= 0.7558395448886648 at iter 129
max_prior_star_anomaly= 0.7624098208235497 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.590947885970027
accuracies_anomaly['prior'][-1]= 0.7558395448886648
accuracies_anomaly['prior_star'][-1]= 0.7624098208235497



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.00037264823914 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.590947885970027
 first_prior_anomaly_auc= 0.7558854027136486
 first_prior_star_anomaly_auc= 0.7625220227870841


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5909989441669161; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7552648249996061; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7629717761633863 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5909472556219171; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7547028696597696; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.763254802464661 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5908454544021936; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7541287801188206; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7634391792867611 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5907814740690547; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7535028444458453; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7635863655703863 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5910002048631356 at iter 80
0.7558854027136486 at iter 0
0.7637502560789196 at iter 490
last anomaly aucs:
0.5907187544321352
0.7530590793765857
0.7637502560789196




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.65546655654907 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5907130812991475,first_prior_anomaly_auc= 0.7530321319948942, first_prior_star_anomaly_auc= 0.7637606568227303


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5907130812991475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7577472934428038 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7655319350111098 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5907130812991475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7577633673196023 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.766753234473738 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5907130812991475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7578259293694942 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7676719668436894 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5907130812991475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7577959878342815 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7684504467592228 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5907130812991475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7578566588398443 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.769355784231842 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5907130812991475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7579929716185764 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7699109633294987 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5907130812991475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7581020218415621 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7703402303922341 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5907130812991475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7582646516538759 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7706402760924721 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5907130812991475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.758381108467151 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7710465354492019 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5907130812991475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7584956742360969 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7714162346155664 iter_best_prior_star_anomaly= 970
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5907130812991475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7586545219597522 iter_best_prior_anomaly= 1070
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7713103361331295 iter_best_prior_star_anomaly= 970
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5907130812991475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7588165214239564 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7712031769544732 iter_best_prior_star_anomaly= 970
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5907130812991475 at iter 0
max_prior_anomaly= 0.7589567738783743 at iter 129
max_prior_star_anomaly= 0.7714594134610839 at iter 97
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5907130812991475
accuracies_anomaly['prior'][-1]= 0.7589567738783743
accuracies_anomaly['prior_star'][-1]= 0.7712762973352033



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.13652753829956 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5907130812991475
 first_prior_anomaly_auc= 0.7589808846935719
 first_prior_star_anomaly_auc= 0.7712595931102952


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5894240194147218; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.752383503789968; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7730482058716925 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5886335628851033; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7496312463558; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7733561309233024 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5877967757694187; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7482897079912382; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7732306916494633 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5870056888916904; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7476139748175931; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7730869722804419 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5907130812991475 at iter 0
0.7589808846935719 at iter 0
0.7733561309233024 at iter 200
last anomaly aucs:
0.5863778621743858
0.7477479237909135
0.7730412720424854




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.64448118209839 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5863050569677104,first_prior_anomaly_auc= 0.7477721921931386, first_prior_star_anomaly_auc= 0.7730378051278819


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5863050569677104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.752422900546827 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7720913374411018 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5863050569677104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.752768488897994 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7715233937942229 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5863050569677104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7529016499361773 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7709456797516429 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5863050569677104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7529534960682037 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7702805049088359 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5863050569677104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.752973509620688 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7697067305419418 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5863050569677104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7530579762673937 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7690974990938746 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5863050569677104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7529654726822889 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7685100146555937 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5863050569677104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7529262335124574 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7679562538411837 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5863050569677104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7529287549048964 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7673987109381156 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5863050569677104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.752960114723356 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7670658871361709 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5863050569677104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7529952566304742 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7666930362292577 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5863050569677104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.752966260617426 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7663435082024048 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5863050569677104 at iter 0
max_prior_anomaly= 0.7530587642025309 at iter 59
max_prior_star_anomaly= 0.7732663063176639 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5863050569677104
accuracies_anomaly['prior'][-1]= 0.7529508170887373
accuracies_anomaly['prior_star'][-1]= 0.7659309453645775



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.05041098594666 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5863050569677104
 first_prior_anomaly_auc= 0.7529590116141638
 first_prior_star_anomaly_auc= 0.7659246418834801


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5825803299872354; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.745399719495091; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7654953748207447 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5815033802417385; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7437461588162063; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7650736719353263 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5809823975290354; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7427738468569267; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.76456025339994 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5807189120191626; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7422856422459303; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7641855114486976 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5863050569677104 at iter 0
0.7529590116141638 at iter 0
0.7661036607466473 at iter 10
last anomaly aucs:
0.5805553366846841
0.7422522337961139
0.7638322013331862




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.56715703010559 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5805482452684495,first_prior_anomaly_auc= 0.7422657862804733, first_prior_star_anomaly_auc= 0.7637997384055344


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5805480876814221 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7444850843878532 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7632727673857888 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5805484028554769 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7449983453362119 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7620728997588919 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5805480876814221 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7452339379422286 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7615475046094207 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5805484028554769 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7453683596766314 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7612068014561042 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5805484028554769 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7454165813070268 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.760588587547473 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5805482452684495 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7454698457223002 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7601802795593866 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5805480876814221 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7453844335534299 iter_best_prior_anomaly= 620
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7596501567990923 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5805480876814221 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7453485037111744 iter_best_prior_anomaly= 620
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7592114345147106 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5805482452684495 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7453091069543155 iter_best_prior_anomaly= 620
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7588458326110595 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5805480876814221 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7452571032352617 iter_best_prior_anomaly= 620
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7583781143136297 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5805480876814221 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7452295255054604 iter_best_prior_anomaly= 620
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7579655514758025 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5805480876814221 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7452019477756591 iter_best_prior_anomaly= 620
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7575618135115116 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5805484028554769 at iter 2
max_prior_anomaly= 0.7454777250736719 at iter 62
max_prior_star_anomaly= 0.7677548576201206 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5805480876814221
accuracies_anomaly['prior'][-1]= 0.745184928376696
accuracies_anomaly['prior_star'][-1]= 0.7572737444253589



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 116.71482586860657 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4500753265991143
accuracies_anomaly["prior"][-1]= 0.6934585624911356
accuracies_anomaly["prior_star"][-1]= 0.45350410514206474


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 1411.5512602329254 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003459453582763672 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49539767086373443
 first_prior_anomaly_auc= 0.7259556865278851
 first_prior_star_anomaly_auc= 0.4988760893203271


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5863321619364293; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7588226673180264; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6574760861685865 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5844587673542714; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.760378208865846; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6568217848306728 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5822115763430354; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.7636865909198355; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6553844335534299 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5813952755409175; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.7671732039018547; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6554693729612179 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5866252738074602 at iter 120
0.7694511243834408 at iter 490
0.6582006713207369 at iter 130
last anomaly aucs:
0.5816234615566446
0.7694511243834408
0.6565891863781773




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.78344106674194 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5817088737255149,first_prior_anomaly_auc= 0.7696025655168067, first_prior_star_anomaly_auc= 0.6567414154466804


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5817088737255149 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7707453866397718 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6567451975353389 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5817088737255149 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7717459066769623 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6567401547504609 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5817088737255149 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7726149991332713 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6567355847266653 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5817088737255149 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7732193453834881 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.656739839576406 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5817088737255149 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7733720472130734 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6567247112217722 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5817088737255149 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7730902816080181 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6567061159525347 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5817088737255149 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.772180689285658 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.656698236601163 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5817088737255149 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7701241785776196 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6566812172021999 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5817088737255149 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7668447925366784 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.656651590841042 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5817088737255149 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.763923601809099 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6566352017901886 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5817088737255149 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7611095702601762 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6566309469404479 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5817088737255149 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.757039885276644 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6566144003025671 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5817088737255149 at iter 0
max_prior_anomaly= 0.7733811872606647 at iter 51
max_prior_star_anomaly= 0.656747088579668 at iter 12
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5817088737255149
accuracies_anomaly['prior'][-1]= 0.752054146902627
accuracies_anomaly['prior_star'][-1]= 0.6566014781663173



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 121.26534628868103 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5817088737255149
 first_prior_anomaly_auc= 0.7516106970074221
 first_prior_star_anomaly_auc= 0.6565999022960429


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5825138282616575; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7547222528641442; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6581355878784059 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5831312542351514; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.756961406936981; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6594213404352554 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5837726334368156; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7579540476227997; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6605808657831287 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5843349039507068; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7585566604157147; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.661526703121799 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5847439998739303 at iter 490
0.7587826402130576 at iter 490
0.6622405723560836 at iter 490
last anomaly aucs:
0.5847439998739303
0.7587826402130576
0.6622405723560836




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.8131947517395 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5847920639172983,first_prior_anomaly_auc= 0.7587982413287738, first_prior_star_anomaly_auc= 0.6623017161227288


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5847920639172983 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7545366153458247 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6622906850308082 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5847920639172983 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7508025907307311 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6622727201096805 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5847920639172983 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.748236916337047 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6622724049356257 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5847920639172983 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.7463277494996612 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6622802842869975 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5847920639172983 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.7451141718013773 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6623162141292529 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5847920639172983 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.7429322218194999 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6623598657358527 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5847920639172983 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.7389000425484974 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.662476007375073 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5847920639172983 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.7329002316529303 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6626027073451314 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5847920639172983 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.7244379658666498 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6627669130277196 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5847920639172983 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.7161255653434608 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6629629512898498 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5847920639172983 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.7083937154293459 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6632097325748144 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5847920639172983 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.7021132420379155 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.663515766582095 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5847922215043257 at iter 29
max_prior_anomaly= 0.7587982413287738 at iter 0
max_prior_star_anomaly= 0.6638794774414171 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5847920639172983
accuracies_anomaly['prior'][-1]= 0.6983076729123658
accuracies_anomaly['prior_star'][-1]= 0.6638794774414171



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.66092705726624 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5847920639172983
 first_prior_anomaly_auc= 0.6978717871944782
 first_prior_star_anomaly_auc= 0.6639191893723309


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5852066753864822; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.699462785823471; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.664624548907134 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5855867752966576; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7009794033755141; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6652498542319996 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5860311707140269; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7026031801062137; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6659249570575351 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5864317569377688; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7042950344327654; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6665212663693525 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5868657516113274 at iter 490
0.7056765999022961 at iter 490
0.6671048111319475 at iter 490
last anomaly aucs:
0.5868657516113274
0.7056765999022961
0.6671048111319475




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.797003984451294 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5869164946341617,first_prior_anomaly_auc= 0.7057952629339553, first_prior_star_anomaly_auc= 0.6671604393526325


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5869164946341617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6980673526955261 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6676801613691161 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5869164946341617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6915386797358841 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6682354980538002 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5869164946341617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6852887782277763 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.668907133964732 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5869164946341617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.681253447216225 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6697377751863467 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5869164946341617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6791041177490269 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6707746978268749 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5869164946341617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6774215610570938 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6719849661975826 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5869164946341617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6753664686323022 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6734029342704508 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5869164946341617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6732612635327859 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6750137888649006 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5869164946341617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6718551144869754 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6767883763808563 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5869164946341617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6715443528688718 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6788926359582079 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5869164946341617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6719228769087728 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6814011062609326 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5869164946341617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.672753675717415 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6841993791071119 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5869164946341617 at iter 0
max_prior_anomaly= 0.7057952629339553 at iter 0
max_prior_star_anomaly= 0.6869016814535828 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5869164946341617
accuracies_anomaly['prior'][-1]= 0.6737612871708402
accuracies_anomaly['prior_star'][-1]= 0.6869016814535828



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 121.04693460464478 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5869164946341617
 first_prior_anomaly_auc= 0.6738690766976063
 first_prior_star_anomaly_auc= 0.6871163149849504


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.587327639188742; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6735477567486645; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6876541595095891 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5876735427139639; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6732527538333044; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6881434672297777 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5879439620530438; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6727328742297933; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6885656428762784 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.588231085617032; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6717900310446443; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6890020013552485 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5883971823439494 at iter 490
0.6738690766976063 at iter 0
0.6893375041366594 at iter 490
last anomaly aucs:
0.5883971823439494
0.6708512851222088
0.6893375041366594




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.843464851379395 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.588410734828309,first_prior_anomaly_auc= 0.6707921899869203, first_prior_star_anomaly_auc= 0.6893704398253936


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.588410734828309 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6713059236963614 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6927774713585577 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.588410734828309 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.671990166569488 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6963420899191578 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.588410734828309 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6738963392533527 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7000107159178657 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.588410734828309 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6780536426241391 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7041647099610759 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.588410734828309 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.684009959500134 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7083893029925776 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.588410734828309 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6885613880265378 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7126923743637424 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.588410734828309 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6953913673826372 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7166380383566825 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.588410734828309 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.701989063460296 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7206933829207179 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.588410734828309 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7088039144617615 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7243724096632365 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.588410734828309 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7158748443828102 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7279431741179067 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.588410734828309 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7249088359046283 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7310418078383787 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.588410734828309 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7318001166144003 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7331626140536112 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.588410734828309 at iter 0
max_prior_anomaly= 0.7367343240304459 at iter 129
max_prior_star_anomaly= 0.7354514080400902 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.588410734828309
accuracies_anomaly['prior'][-1]= 0.7367343240304459
accuracies_anomaly['prior_star'][-1]= 0.7354514080400902



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.91238355636597 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.588410734828309
 first_prior_anomaly_auc= 0.7370950407362467
 first_prior_star_anomaly_auc= 0.7356452400838362


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5893978599681675; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7363830625462912; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7356212868556662 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5896695400034669; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7353946767102133; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7357235608364718 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5894605796050869; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7343684699875507; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7354958475818271 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.589455536820209; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7338221157634304; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7355591975668563 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5896695400034669 at iter 200
0.7370950407362467 at iter 0
0.7357375860819138 at iter 190
last anomaly aucs:
0.5895277116787745
0.733405140488835
0.7356149833745687




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.7433660030365 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5895387427706951,first_prior_anomaly_auc= 0.7333942669839418, first_prior_star_anomaly_auc= 0.7356253841183793


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5895387427706952 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7349833745686055 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7384805458814631 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5895387427706952 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7354553477157761 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7405468269852027 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5895387427706952 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7368462108199252 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7424785287675119 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5895387427706951 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7392667475613408 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7442829002316529 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5895387427706951 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7416841325622074 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7459404005862238 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5895387427706951 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7438842050522402 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7474897962399736 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5895387427706951 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7456539073703452 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7491753470854279 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5895387427706951 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7469675528310509 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7509069133428936 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5895387427706951 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7482733189403847 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7525634681752998 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5895387427706951 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7495218809587595 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7543505050664229 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5895387427706951 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7506528830546669 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7561425847424239 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5895387427706951 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7516157397923003 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7580692437398553 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5895387427706952 at iter 10
max_prior_anomaly= 0.7524325133555004 at iter 129
max_prior_star_anomaly= 0.7594355232677246 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5895387427706952
accuracies_anomaly['prior'][-1]= 0.7524325133555004
accuracies_anomaly['prior_star'][-1]= 0.7594355232677246



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 121.20366787910461 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5895387427706951
 first_prior_anomaly_auc= 0.7525272231589895
 first_prior_star_anomaly_auc= 0.7595556045826307


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5913402776683423; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7532674094268559; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7594796476354067 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5915120475282475; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7535371984178263; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.7595515073199175 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5916100666593126; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7534689632349464; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 200 
last prior star auc 0.7596318767039096 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5916907512173597; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7532666214917189; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 200 
last prior star auc 0.759737144838237 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5918648848826764 at iter 490
0.7535371984178263 at iter 200
0.7598212963108877 at iter 480
last anomaly aucs:
0.5918648848826764
0.7529889531493766
0.7598030162157051




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.80915832519531 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5918704004286367,first_prior_anomaly_auc= 0.7529632664639048, first_prior_star_anomaly_auc= 0.7598143624816805


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5918704004286367 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7578197834754243 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7623499377531242 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5918704004286367 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.758369919788203 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7639002789290386 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5918704004286367 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7587161384874797 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7653406243598027 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5918704004286367 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.758928093039381 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7665909198354792 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5918704004286367 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7591241313015114 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7676785854988417 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5918704004286367 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7592029248152293 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7685995240871772 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5918704004286367 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7593122902122698 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7692995256630474 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5918704004286367 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7593743795010794 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7698813369683407 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5918704004286367 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7594374143120539 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7703569346171423 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5918704004286367 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7594181886947067 iter_best_prior_anomaly= 910
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7705848054588147 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5918704004286367 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7593474321193879 iter_best_prior_anomaly= 910
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7707781647414784 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5918704004286367 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7592264052823172 iter_best_prior_anomaly= 910
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7708536489276203 iter_best_prior_star_anomaly= 1180
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5918705580156641 at iter 26
max_prior_anomaly= 0.7594528578407426 at iter 91
max_prior_star_anomaly= 0.7708804387222844 at iter 118
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5918704004286367
accuracies_anomaly['prior'][-1]= 0.7591302771955813
accuracies_anomaly['prior_star'][-1]= 0.7707397135067842



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.27680826187134 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5918704004286367
 first_prior_anomaly_auc= 0.7591165671241944
 first_prior_star_anomaly_auc= 0.7707228516948486


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5901358400176497; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7583645618292703; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7728348330365444 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5891239737144838; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7574800258442724; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7733844965882408 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5888130545093527; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7562566777502877; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7736508186646075 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.588554296610303; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7553218715035379; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7738257402650615 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5918704004286367 at iter 0
0.7591165671241944 at iter 0
0.7738361410088721 at iter 390
last anomaly aucs:
0.5882298249208125
0.7546814378240383
0.7737420615534929




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.87981867790222 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5882200545251115,first_prior_anomaly_auc= 0.7546086326173631, first_prior_star_anomaly_auc= 0.7737497833178373


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5882200545251115 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7576365097625164 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7734295664780876 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5882200545251115 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7579370282238366 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7733183100367178 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5882200545251115 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7579906078131649 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7730967426761429 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5882200545251115 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7578429487684575 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7728206502040752 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5882200545251115 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7576513229430955 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7725407756433491 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5882200545251115 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7574336952582063 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7721509053374727 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5882200545251115 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7571347526671605 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7718429802858628 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5882200545251115 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7569005783443907 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7714550010243156 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5882200545251115 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7566764895913769 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7712343791859055 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5882200545251115 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.756479505807082 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.770807633515609 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5882200545251115 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7563556424035173 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7703988527664403 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5882200545251115 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7562380824810502 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7699727374442537 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5882200545251115 at iter 0
max_prior_anomaly= 0.7580289014608317 at iter 28
max_prior_star_anomaly= 0.7737497833178373 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5882200545251115
accuracies_anomaly['prior'][-1]= 0.7561857635879414
accuracies_anomaly['prior_star'][-1]= 0.7696090265849316



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 121.25001692771912 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5882200545251115
 first_prior_anomaly_auc= 0.7561778842365696
 first_prior_star_anomaly_auc= 0.7695589139102069


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.584703027246797; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7494875269867785; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7709043919504546 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5842882581905858; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7474138392927494; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7709540318640971 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5840150022850119; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7460983027877145; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7705860661550341 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5836881667901098; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.745583308382054; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7702759348850403 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5882200545251115 at iter 0
0.7561778842365696 at iter 0
0.7709923255117639 at iter 160
last anomaly aucs:
0.5835776982838773
0.745627432749736
0.7702500906125408




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.873825788497925 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5835756496525206,first_prior_anomaly_auc= 0.745632790708669, first_prior_star_anomaly_auc= 0.7702428416092787


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5835756496525206 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7470466615188238 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7686017303055612 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5835756496525206 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.747213703767906 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7680082575602376 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5835756496525206 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7472074002868083 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7674841231069859 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5835756496525206 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7472754778826607 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7670252296830924 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5835756496525206 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7472130734197961 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7664475156405124 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5835756496525206 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7472754778826608 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7661380147186283 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5835756496525206 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7473734970137258 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7659920891312229 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5835756496525206 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7475058701167719 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7656063160880596 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5835756496525206 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7475824574121057 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7651622358447453 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5835756496525206 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7476454922230802 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7647462060923145 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5835756496525206 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7477624217974377 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7643862773216509 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5835756496525206 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7478397970279087 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7640354885985786 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5835756496525206 at iter 0
max_prior_anomaly= 0.74794112548655 at iter 129
max_prior_star_anomaly= 0.7702428416092787 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5835756496525206
accuracies_anomaly['prior'][-1]= 0.74794112548655
accuracies_anomaly['prior_star'][-1]= 0.7637064468852923



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 121.03026056289673 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.49539767086373443
accuracies_anomaly["prior"][-1]= 0.7259556865278851
accuracies_anomaly["prior_star"][-1]= 0.4988760893203271


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 1430.3578770160675 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0034377574920654297 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4620398064831303
 first_prior_anomaly_auc= 0.7082695368517263
 first_prior_star_anomaly_auc= 0.46565122839087886


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46983090911956127; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7276221693430197; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.47805726712577024 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4876965504199694; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7392528799029263; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.505427139637865 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5130406416943757; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7462847282411713; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5481415761854485 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5383818964022882; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7508282774162031; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.5918050018122508 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5575829301731882 at iter 490
0.7536030697952946 at iter 490
0.6197957672124431 at iter 490
last anomaly aucs:
0.5575829301731882
0.7536030697952946
0.6197957672124431




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.885380268096924 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5590891469814205,first_prior_anomaly_auc= 0.7538022597979736, first_prior_star_anomaly_auc= 0.6219490363553273


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5590891469814205 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7426556565863498 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7447471516144791 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5590891469814205 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7421706037159022 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7406004065745307 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5590891469814205 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7398320122287534 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7350763509147926 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5590891469814205 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7389258868209968 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7303241565154357 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5590891469814205 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7372089761570828 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7243008651527807 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5590891469814205 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7327569850449911 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7172762658177979 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5590891469814205 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.730733882786769 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7197330475755235 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5590891469814205 at iter 0
max_prior_anomaly= 0.7567108435633578 at iter 1
max_prior_star_anomaly= 0.7483885150574405 at iter 11
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5590891469814205
accuracies_anomaly['prior'][-1]= 0.7117578832910475
accuracies_anomaly['prior_star'][-1]= 0.7072357659517469



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.1858332157135 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5590891469814205
 first_prior_anomaly_auc= 0.7200033093275762
 first_prior_star_anomaly_auc= 0.7100572040909593


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5742310540996265; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7191877964605954; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7193567297540067 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5826477772349781; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7186412846494477; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7236191436720929 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5863762863041114; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7178490946625273; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7258628677687253 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5882247821359345; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7168835589454275; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.726937926469893 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5890596782072899 at iter 490
0.7200033093275762 at iter 0
0.7277914178104858 at iter 490
last anomaly aucs:
0.5890596782072899
0.7162412342215989
0.7277914178104858




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.586727142333984 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5891069543155207,first_prior_anomaly_auc= 0.7160899506752605, first_prior_star_anomaly_auc= 0.7278015033802417


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5891069543155207 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7454247758324535 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7347495154198906 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5891069543155207 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7449754952172338 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7354388010778953 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5891069543155207 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.7315651543564934 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7272455363474479 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5891069543155207 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.7293392375939614 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7253951494712955 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5891069543155207 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.7216994185038688 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7200479064563405 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5891069543155207 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.7199347589706415 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7178851820918102 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5891069543155207 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.7151582961690593 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.716081125801724 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5891071119025482 at iter 24
max_prior_anomaly= 0.7574593819436785 at iter 2
max_prior_star_anomaly= 0.7380619947365933 at iter 15
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5891069543155207
accuracies_anomaly['prior'][-1]= 0.7169604614148163
accuracies_anomaly['prior_star'][-1]= 0.7159831066706589



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 71.96562194824219 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5891069543155207
 first_prior_anomaly_auc= 0.7224711221772224
 first_prior_star_anomaly_auc= 0.7186217438580456


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5898942591045906; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7235267976740155; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 100 
last prior star auc 0.7189239957766675 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5899995272389177; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7239566950848606; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 180 
last prior star auc 0.7192788817624534 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5898072710654458; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7242942464976284; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 280 
last prior star auc 0.7190579447499882 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.58939155648707; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7244880785413744; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 390 
last prior star auc 0.7196101296941235 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5900480640433678 at iter 170
0.7246300644530942 at iter 410
0.7200674472477425 at iter 440
last anomaly aucs:
0.5889544100729627
0.7244103881368484
0.7199530390658241




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.55669403076172 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5889090250090613,first_prior_anomaly_auc= 0.7243790283183889, first_prior_star_anomaly_auc= 0.7195590714972344


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5889090250090613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7392054462076681 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7282503112343792 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5889090250090613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7572688592275084 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7314430244102306 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5889090250090613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7414412909529288 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7223742061553493 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5889090250090613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7377395716784594 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7198335880990276 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5889090250090613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7626052287375704 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7396211607860441 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5889090250090613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7379119718864744 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7190144507304159 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5889090250090613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7401125171375893 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7185316040783523 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5889090250090613 at iter 0
max_prior_anomaly= 0.770969948153868 at iter 3
max_prior_star_anomaly= 0.7396211607860441 at iter 50
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5889090250090613
accuracies_anomaly['prior'][-1]= 0.7368923838189639
accuracies_anomaly['prior_star'][-1]= 0.7158261499913328



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.0822365283966 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5889090250090613
 first_prior_anomaly_auc= 0.7385999968482595
 first_prior_star_anomaly_auc= 0.7173742849488629


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.589603038277889; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7356096254156358; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.7149988180972943 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5893382920717967; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7321171817136012; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.7149685613880266 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5891331137620751; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7297105126306003; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.7162232693004712 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5890010558330838; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7278427911814299; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.7156688781379517 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.589603038277889 at iter 100
0.7386031485888082 at iter 10
0.7173742849488629 at iter 0
last anomaly aucs:
0.5889561435302646
0.7271560269158642
0.7162112926863862




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.62424635887146 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5889651259908284,first_prior_anomaly_auc= 0.7270937800400272, first_prior_star_anomaly_auc= 0.716110752162882


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5889651259908284 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7493316734166444 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7258067667869581 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5889651259908284 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7381458310351892 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7517563074207732 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5889651259908284 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7541916573427676 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7426162598294909 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5889651259908284 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7560647367508707 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.737782435349922 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5889651259908284 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7550270261752052 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7357438895630111 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5889651259908284 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.750163732921506 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7294631009975259 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5889651259908284 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.7460940479379738 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7248618749704524 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5889651259908285 at iter 63
max_prior_anomaly= 0.7583588886962827 at iter 44
max_prior_star_anomaly= 0.7527519422601132 at iter 19
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5889651259908284
accuracies_anomaly['prior'][-1]= 0.7415708274894811
accuracies_anomaly['prior_star'][-1]= 0.7224284160927872



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.08539986610413 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5889651259908284
 first_prior_anomaly_auc= 0.7418582662275242
 first_prior_star_anomaly_auc= 0.7227508391509211


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5892566619915848; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7372318262760609; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.7280375687473406 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5892465764218289; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7352838930299258; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.7298901618418772 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5893729612178324; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.7334355547851301; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.7304477047449455 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5894905211402998; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7331903493704398; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.731341223190507 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5896187969806326 at iter 490
0.7427688040720488 at iter 10
0.7320194777565912 at iter 460
last anomaly aucs:
0.5896187969806326
0.7317593015742945
0.731028885702129




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.58861589431763 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5896380225979798,first_prior_anomaly_auc= 0.7317704902532424, first_prior_star_anomaly_auc= 0.7310629245000551


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5896380225979797 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7578940069653466 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7240120081314906 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5896380225979798 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7427350804481775 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7395953165135447 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5896380225979798 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.739845249539058 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7374281797122461 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5896380225979798 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7359854704760704 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7342411396693824 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5896380225979798 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7318656728178137 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7310112359550562 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5896380225979797 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7279735884142018 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7289767874308586 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5896380225979797 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7243415226058592 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7265182722158312 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5896380225979798 at iter 0
max_prior_anomaly= 0.7621434987471831 at iter 4
max_prior_star_anomaly= 0.7424816805080605 at iter 23
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5896380225979797
accuracies_anomaly['prior'][-1]= 0.7230738925571647
accuracies_anomaly['prior_star'][-1]= 0.725696455867753



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.28096842765808 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5896380225979797
 first_prior_anomaly_auc= 0.7214516916967396
 first_prior_star_anomaly_auc= 0.7244379658666499


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5914165497896213; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7169913484721938; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7321048899254614 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5919567581196715; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7163266463904692; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7328318388830232 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5921518508596372; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7173093590935594; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7326323337062892 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5922284381549711; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.7165116535606789; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7322167767149408 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5923359125076824 at iter 460
0.7214516916967396 at iter 0
0.7347517216382746 at iter 170
last anomaly aucs:
0.5922495548166475
0.7167503979072443
0.7325455032541721




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.58314895629883 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5923589202136881,first_prior_anomaly_auc= 0.7207898261815087, first_prior_star_anomaly_auc= 0.7350924247915912


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5923589202136881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7525960886899791 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7410813621822652 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5923589202136881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.739326473044739 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7479795767212443 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5923589202136881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7321493294671982 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7402604913563515 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5923589202136881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7261131159682935 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7352682919142097 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5923589202136881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7200973887829553 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7323740485683219 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5923589202136881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7158277258616071 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7293540507745402 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5923589202136881 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7146507083536884 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7285758860330618 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5923589202136881 at iter 0
max_prior_anomaly= 0.7534659690814252 at iter 4
max_prior_star_anomaly= 0.7506424823108562 at iter 16
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5923589202136881
accuracies_anomaly['prior'][-1]= 0.7141973304757552
accuracies_anomaly['prior_star'][-1]= 0.7272218982933325



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.09599184989929 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5923589202136881
 first_prior_anomaly_auc= 0.729733520336606
 first_prior_star_anomaly_auc= 0.7360076902469388


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5913305072726414; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.707825141434357; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7261857635879414 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5913336590131901; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7095418945112437; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.727943331704934 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5912718848984351; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7093278913279859; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7267858549884174 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5912233480939848; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.711147863907843; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.728444773626235 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5923589202136881 at iter 0
0.729733520336606 at iter 0
0.7360076902469388 at iter 0
last anomaly aucs:
0.5911867879036198
0.7098725120948043
0.727815686212711




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.58145618438721 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5911565311943521,first_prior_anomaly_auc= 0.7103537828765936, first_prior_star_anomaly_auc= 0.7285765163811715


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5911565311943521 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7376040468348645 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7511697685046566 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5911565311943521 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7297502245615142 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7417942858943851 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5911565311943521 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7210022534944923 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7332026411585799 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5911565311943521 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7105320138046236 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7263205004963991 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5911565311943521 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7047969491151489 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7228138739618954 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5911565311943521 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7037814583103519 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.723217927100241 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5911565311943521 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7025355752714435 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.722990844193706 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5911565311943521 at iter 0
max_prior_anomaly= 0.7678722599555605 at iter 3
max_prior_star_anomaly= 0.7550470397276896 at iter 9
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5911565311943521
accuracies_anomaly['prior'][-1]= 0.6994073151898135
accuracies_anomaly['prior_star'][-1]= 0.7200696534661267



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.17642545700073 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5911565311943521
 first_prior_anomaly_auc= 0.6992714751721637
 first_prior_star_anomaly_auc= 0.7194679861953764


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5982622878484644; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6942351513623398; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.7222115763430355 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5977176670816459; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6975249381470918; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.7247701593204847 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5969322533369052; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6899100178073341; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.720882487353641 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5967303843547599; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7010098176718093; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 330 
last prior star auc 0.7280734985895961 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5986532612635328 at iter 40
0.7013353924704919 at iter 330
0.7280734985895961 at iter 400
last anomaly aucs:
0.5966790109838158
0.6964481459886223
0.724039270687237




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.705485105514526 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5965033014482247,first_prior_anomaly_auc= 0.6927257828135588, first_prior_star_anomaly_auc= 0.7213814078825032


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5965033014482248 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7342099374379502 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7514732811194983 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5965033014482248 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7170439825393573 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7349978725751296 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5965031438611974 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7059340971051262 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7284323242510676 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5965033014482248 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7030905967820729 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.725571331767969 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5965033014482248 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7245397670863734 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7367592227807807 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5965033014482248 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7090662968624424 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7290716548213751 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5965033014482248 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6978558709047071 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7215935200214318 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5965033014482248 at iter 1
max_prior_anomaly= 0.7629853286477457 at iter 2
max_prior_star_anomaly= 0.7598288604882046 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5965033014482248
accuracies_anomaly['prior'][-1]= 0.7060358983248498
accuracies_anomaly['prior_star'][-1]= 0.7286389208440363



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.48731756210327 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4620398064831303
accuracies_anomaly["prior"][-1]= 0.7082695368517263
accuracies_anomaly["prior_star"][-1]= 0.46565122839087886


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 1043.6546189785004 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003270387649536133 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.48871235639882127
 first_prior_anomaly_auc= 0.7178984194021147
 first_prior_star_anomaly_auc= 0.4923593929747704


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5062990686606679; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7316059693965993; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5149997636194588 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5164561829270216; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7398359519044392; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5351064500370329 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5254243030713711; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7452063602124274; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5608736624801046 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5430326047559765; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7492353877428809; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.5948762153899492 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5591881116346502 at iter 490
0.7519783475424304 at iter 490
0.6197191799171092 at iter 490
last anomaly aucs:
0.5591881116346502
0.7519783475424304
0.6197191799171092




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.86262822151184 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5605197220164836,first_prior_anomaly_auc= 0.7522552279496351, first_prior_star_anomaly_auc= 0.6216839749751801


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5605197220164836 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7446456655688103 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7352619884331123 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5605197220164836 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7425557464109555 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7365501047953732 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5605197220164836 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7415394676710214 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7323757820256237 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5605197220164836 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7407427076603055 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7283273712907954 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5605197220164836 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7397629891107365 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7239516522999827 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5605197220164836 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7379212695210932 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7177628945585199 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5605197220164836 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7316718407740674 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7128698173566352 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5605197220164836 at iter 0
max_prior_anomaly= 0.7522552279496351 at iter 0
max_prior_star_anomaly= 0.7404147690562113 at iter 12
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5605197220164836
accuracies_anomaly['prior'][-1]= 0.7297930882329766
accuracies_anomaly['prior_star'][-1]= 0.71370597412421



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.42539048194885 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5605197220164836
 first_prior_anomaly_auc= 0.7259738090360401
 first_prior_star_anomaly_auc= 0.7096452716012419


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5759797973430827; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7300315174054871; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 90 
last prior star auc 0.7260390500653986 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5839232866350442; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7315774461446334; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 140 
last prior star auc 0.7330957971539783 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5875370723482043; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7321212789763146; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 270 
last prior star auc 0.7359723907527932 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.588880028996013; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.732003876640875; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 270 
last prior star auc 0.7383305230313442 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5894804355705439 at iter 490
0.733057345919284 at iter 270
0.7387635721827379 at iter 390
last anomaly aucs:
0.5894804355705439
0.7308501820130167
0.7381203019367446




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.99412298202515 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5895327544636525,first_prior_anomaly_auc= 0.7309953196652852, first_prior_star_anomaly_auc= 0.7383535307373497


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5895327544636525 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7501768126447831 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7407712309122714 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5895327544636525 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7345597806388577 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7278131648202719 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5895327544636525 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7309447342294781 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7265953322722473 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5895327544636525 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7239431426005011 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7203901854799313 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5895327544636525 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7241795231416548 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.72177001749216 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5895327544636525 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.719980144034543 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7186116582882898 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5895327544636526 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.715776037316608 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7139713506784121 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5895327544636526 at iter 6
max_prior_anomaly= 0.753551223663268 at iter 6
max_prior_star_anomaly= 0.7419830751532535 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5895327544636525
accuracies_anomaly['prior'][-1]= 0.711970310604031
accuracies_anomaly['prior_star'][-1]= 0.7113008809114834



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.4532721042633 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5895327544636525
 first_prior_anomaly_auc= 0.7283079880864207
 first_prior_star_anomaly_auc= 0.7234710118663031


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5909614384543864; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7329999842412973; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 100 
last prior star auc 0.7269987550624832 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5910780528546891; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.73133365901319; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 140 
last prior star auc 0.7257260822289109 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5905611674046992; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7333079092929069; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 140 
last prior star auc 0.7273318940384828 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.58978489370755; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7308744504152418; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 140 
last prior star auc 0.7259457585451565 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5911612588051751 at iter 170
0.7355714893549965 at iter 140
0.7283757505082182 at iter 140
last anomaly aucs:
0.589101281182533
0.7325269079849348
0.7269388719920576




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.883416175842285 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5890316277164064,first_prior_anomaly_auc= 0.730782734765274, first_prior_star_anomaly_auc= 0.725209511952976


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5890316277164064 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7620763666734953 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.733900436516066 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5890316277164064 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7461074428353058 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7238009991017539 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5890316277164064 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7385941661282442 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7190916683738595 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5890316277164064 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7514137132231274 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7272430149550089 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5890316277164064 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7600523188931088 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7342638322013332 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5890316277164064 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7631656082071323 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7316973698725121 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5890316277164064 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.75154261941157 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7249873142442913 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5890316277164064 at iter 0
max_prior_anomaly= 0.7716028176560505 at iter 4
max_prior_star_anomaly= 0.742485462596719 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5890316277164064
accuracies_anomaly['prior'][-1]= 0.7432639425122525
accuracies_anomaly['prior_star'][-1]= 0.7178079644483666



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.6438295841217 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5890316277164064
 first_prior_anomaly_auc= 0.7419474604850528
 first_prior_star_anomaly_auc= 0.7168766251162204


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5890467560710402; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7369645586775296; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.714480671951085 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5888661613375987; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7325993980175552; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.714601383614101 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5888154183147644; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.731719747230408; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7167360574877477 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5888715192965315; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7294139338449658; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7171940053894763 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5890467560710402 at iter 100
0.7419474604850528 at iter 0
0.7194232314795846 at iter 480
last anomaly aucs:
0.5889771026049135
0.729674582788345
0.7189860850654773




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.71323871612549 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.588975841908694,first_prior_anomaly_auc= 0.7295314937674331, first_prior_star_anomaly_auc= 0.718380005357959


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.588975841908694 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7394030603400727 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7486181193564145 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.588975841908694 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7554277699859748 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7533731503222654 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.588975841908694 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7521414501158266 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7464260838047811 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.588975841908694 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7563742376727548 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7397699229399436 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.588975841908694 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7566542698205084 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.736570275934885 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.588975841908694 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7566017933403721 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7343549175031912 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.588975841908694 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7559080952455993 iter_best_prior_anomaly= 670
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7326996233670044 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5889758419086941 at iter 3
max_prior_anomaly= 0.7596577209764093 at iter 67
max_prior_star_anomaly= 0.7540094867390517 at iter 21
last values
accuracies_anomaly['vanilla_star'][-1]= 0.588975841908694
accuracies_anomaly['prior'][-1]= 0.7551319791354776
accuracies_anomaly['prior_star'][-1]= 0.7323727878721024



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.63581848144531 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.588975841908694
 first_prior_anomaly_auc= 0.7559405581732512
 first_prior_star_anomaly_auc= 0.7339600044124368


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5899626518744977; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7482928597317868; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7358299320799913 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5900499550876972; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.745896748979624; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7375079187481286 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5900761145342515; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.7454342310540998; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7384698299635973 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5900650834423311; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 350 
last prior auc 0.7454663788076965; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7390707092992106 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5900839938856234 at iter 350
0.7559405581732512 at iter 0
0.7394003813606063 at iter 490
last anomaly aucs:
0.5900449123028193
0.745571016593914
0.7394003813606063




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.8617947101593 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5900461729990387,first_prior_anomaly_auc= 0.7455834659690814, first_prior_star_anomaly_auc= 0.7394273287422979


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5900461729990387 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7431756937768883 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7148358731109254 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5900461729990387 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7332316371716281 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7388593850954188 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5900461729990387 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7398747183131884 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7440427376018406 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5900461729990387 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7431448067195109 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7430565579841468 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5900461729990387 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7444729501867405 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7420338181760877 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5900461729990387 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7454885985785649 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7418592117496887 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5900461729990387 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.746420568258821 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7424886143372678 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5900461729990387 at iter 0
max_prior_anomaly= 0.7473101470286966 at iter 6
max_prior_star_anomaly= 0.7489024063539089 at iter 46
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5900461729990387
accuracies_anomaly['prior'][-1]= 0.7439971949509115
accuracies_anomaly['prior_star'][-1]= 0.7418519627464267



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.23873019218445 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5900461729990387
 first_prior_anomaly_auc= 0.7442520131742755
 first_prior_star_anomaly_auc= 0.7408525458184282


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5905526577052176; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.7340643270245993; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7428630411144554 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5907256882613423; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7398881132105204; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7468313976393464 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5907206454764644; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 240 
last prior auc 0.7368035047354902; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7455552578911704 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5907890382463716; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7347000330932758; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7436186709110105 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5908041666010053 at iter 480
0.7442520131742755 at iter 0
0.7478074916872843 at iter 350
last anomaly aucs:
0.5907639819090093
0.7347662196447988
0.7436739839576406




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.86000394821167 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5907452290527444,first_prior_anomaly_auc= 0.7347989977465055, first_prior_star_anomaly_auc= 0.7432418803284113


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5907452290527444 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7284164079612965 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7256255417054068 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5907452290527444 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7310752162881952 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7403810454323401 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5907452290527444 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.739613911782782 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7508668862379249 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5907452290527444 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7433936366358321 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7569138156546953 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5907452290527444 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7424605638463841 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7521657185180515 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5907452290527444 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7415471894353657 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.750738610397592 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5907452290527444 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7426250847030273 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7510440140567629 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5907452290527444 at iter 0
max_prior_anomaly= 0.7448344548276786 at iter 43
max_prior_star_anomaly= 0.7588385836077973 at iter 61
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5907452290527444
accuracies_anomaly['prior'][-1]= 0.7430199977937816
accuracies_anomaly['prior_star'][-1]= 0.7516204674031233



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.67160320281982 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5907452290527444
 first_prior_anomaly_auc= 0.7429629512898497
 first_prior_star_anomaly_auc= 0.7515183510093449


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5890558961186315; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7337595537135383; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7513727405959941 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.588944009329152; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7347031848338246; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7522602707345131 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5888371653245504; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7352793230061302; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7531178593378194 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.588663819594371; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7383239043761918; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7554094898907922 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5907452290527444 at iter 0
0.7429629512898497 at iter 0
0.7554996296704856 at iter 270
last anomaly aucs:
0.588656255417054
0.7358813054509353
0.7536337992656444




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.82125949859619 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5886373449737617,first_prior_anomaly_auc= 0.7335480719227193, first_prior_star_anomaly_auc= 0.751899396441685


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5886373449737617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7277428810060356 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7182744220495769 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5886373449737617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7213415383645618 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.71982791496604 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5886373449737617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7183002663220763 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.73333722048001 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5886373449737617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7304048410734829 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7551207904565296 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5886373449737617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7362450163102573 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7545686055123942 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5886373449737617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7351734245236932 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7531468553508676 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5886373449737617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.735999810895567 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.752774319618009 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5886373449737617 at iter 0
max_prior_anomaly= 0.7371144239406211 at iter 45
max_prior_star_anomaly= 0.7580270104165026 at iter 44
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5886373449737617
accuracies_anomaly['prior'][-1]= 0.7359865735852624
accuracies_anomaly['prior_star'][-1]= 0.7523614416061271



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.26938939094543 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5886373449737617
 first_prior_anomaly_auc= 0.7361585010321949
 first_prior_star_anomaly_auc= 0.7526183084608475


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5886666561608649; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7384339001213419; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 40 
last prior star auc 0.7584565926532928 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5884205052240099; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7389293537356005; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 40 
last prior star auc 0.7587774398411522 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5882938052539515; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7354440014498007; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 280 
last prior star auc 0.7576343035441323 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5882008289077643; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7348355579368706; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 280 
last prior star auc 0.7573022676773248 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5889972737444253 at iter 30
0.7413029295428402 at iter 280
0.7599054477835385 at iter 280
last anomaly aucs:
0.5881406306632838
0.7351116504089383
0.7572412814977072




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.667778968811035 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5881311754416377,first_prior_anomaly_auc= 0.733919977307468, first_prior_star_anomaly_auc= 0.7572028302630128


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5881311754416376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.737220637597113 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.73129678364877 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5881311754416376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7364689474762438 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7415969869360354 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5881311754416376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7383437603416486 iter_best_prior_anomaly= 270
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7458603463762863 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5881311754416377 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7390919835479143 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.749657248215327 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5881311754416376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7376220117559922 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7530337078651685 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5881311754416376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.734131459098287 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7518536962037285 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5881311754416376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.733919977307468 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7534396520478435 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5881311754416377 at iter 0
max_prior_anomaly= 0.7393513717950738 at iter 46
max_prior_star_anomaly= 0.7641678617016248 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5881311754416377
accuracies_anomaly['prior'][-1]= 0.7333335959783791
accuracies_anomaly['prior_star'][-1]= 0.7536257623272452



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.78297662734985 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5881311754416377
 first_prior_anomaly_auc= 0.7333709441038814
 first_prior_star_anomaly_auc= 0.7537264604377767


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5874620609231448; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7363766014781663; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 30 
last prior star auc 0.756924531572561 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5872794175583466; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7320804639362088; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 30 
last prior star auc 0.7561982129631089 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5872852482783617; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7321093023622296; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 30 
last prior star auc 0.7572217407063051 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5872874544967458; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7384402036024393; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 30 
last prior star auc 0.7581972044061334 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5881311754416377 at iter 0
0.7459333091699891 at iter 30
0.7613924389744237 at iter 390
last anomaly aucs:
0.5872947035000079
0.7382074475629166
0.7585476779551508




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.03946495056152 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5873132987692453,first_prior_anomaly_auc= 0.7389466883086184, first_prior_star_anomaly_auc= 0.7595286572009392


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5873132987692453 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.728682257276581 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7392590257969964 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5873132987692453 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.735874371621728 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7444653860094237 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5873132987692453 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.738512378461005 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.749696329798131 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5873132987692453 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7395510345588351 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.754087334730605 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5873132987692453 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7383661376995447 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7532937264604378 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5873132987692453 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7388649006413791 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7538282616575003 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5873132987692453 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7396555147580252 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.754451045589927 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5873132987692453 at iter 0
max_prior_anomaly= 0.7399859747545582 at iter 79
max_prior_star_anomaly= 0.7595286572009392 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5873132987692453
accuracies_anomaly['prior'][-1]= 0.7399859747545582
accuracies_anomaly['prior_star'][-1]= 0.7547165797311566



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 74.8404061794281 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5873132987692453
 first_prior_anomaly_auc= 0.7400666593126054
 first_prior_star_anomaly_auc= 0.7547856028491734


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5876136596435382; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7250010243156784; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7564388483540034 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5879061411664591; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7213319255558883; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7555469057787163 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5880879965961201; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7212039648896102; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7544248861433727 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5881948406007217; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7215219755109759; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7555081393699671 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5882109144775202 at iter 460
0.7400666593126054 at iter 0
0.7627798351639692 at iter 240
last anomaly aucs:
0.5881860157271853
0.7321754889137526
0.7603504735490174




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.63168120384216 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5881872764234048,first_prior_anomaly_auc= 0.7245848369762201, first_prior_star_anomaly_auc= 0.7573616779866681


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5881872764234048 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7350831271569724 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7456800668168997 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5881872764234048 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.741467450399483 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7480605764533463 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5881874340104323 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7402883842602077 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7503698567533921 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5881872764234048 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.742569298895315 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7550375845060434 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5881872764234048 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.738847093307279 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7568901776005799 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5881872764234048 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7372787872102368 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7562689695384276 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5881872764234048 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7373890981294421 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7561353357391619 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5881874340104323 at iter 1
max_prior_anomaly= 0.742569298895315 at iter 40
max_prior_star_anomaly= 0.7573616779866681 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5881872764234048
accuracies_anomaly['prior'][-1]= 0.7375529886379752
accuracies_anomaly['prior_star'][-1]= 0.7561441606126983



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.57543730735779 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5881874340104323
 first_prior_anomaly_auc= 0.7375589769450179
 first_prior_star_anomaly_auc= 0.7561444757867533


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5459634082922293; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6975971130056574; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6955062483256378 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5432677246009109; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6943475109129016; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6932480262224814 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.543859936650015; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6925316355957578; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6926362733819752 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5464582315583781; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6954101202389019; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6963969302047055 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5881874340104323 at iter 0
0.7375589769450179 at iter 0
0.7561444757867533 at iter 0
last anomaly aucs:
0.5474579636604315
0.6920034038797926
0.695584411491246




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.59164476394653 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5479644483666104,first_prior_anomaly_auc= 0.692931906645445, first_prior_star_anomaly_auc= 0.6961012969412358


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5479644483666104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7087840584963045 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6875093370313756 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5479644483666104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7131585167908978 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6978880186583041 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5479644483666104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7171423168444774 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6977770773909893 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5479644483666104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7184780244890241 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6989306144318199 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5479644483666104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7191572245772728 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7015960414138709 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5479644483666104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7197544794112549 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.706043147328112 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5479644483666104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7180730258285138 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7096556723450526 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5479644483666104 at iter 0
max_prior_anomaly= 0.7199672218982933 at iter 79
max_prior_star_anomaly= 0.7103310903446428 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5479644483666104
accuracies_anomaly['prior'][-1]= 0.7199672218982933
accuracies_anomaly['prior_star'][-1]= 0.7103310903446428



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.82254457473755 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5479644483666104
 first_prior_anomaly_auc= 0.7201043226121626
 first_prior_star_anomaly_auc= 0.7102223552957121


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5636664197803236; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7167552831050947; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7212837039254929 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5679130749956663; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7174849110421231; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7248254723671147 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5703128102494603; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.718367713569819; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7270119923727879 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5717692295570228; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7188489843516082; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7283956064736752 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.572794175583466 at iter 490
0.7201043226121626 at iter 0
0.7293559418188695 at iter 490
last anomaly aucs:
0.572794175583466
0.7192085979482168
0.7293559418188695




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.613332986831665 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5728868367555983,first_prior_anomaly_auc= 0.7192571347526672, first_prior_star_anomaly_auc= 0.7294208676741731


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5728868367555983 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7219909545046252 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7293039380998156 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5728868367555984 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7231810517358211 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7297937185810863 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5728868367555983 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7239382574026505 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7302056510708038 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5728868367555983 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7245870431946042 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7305246072143341 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5728868367555983 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7252867295964196 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7307282096537813 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5728868367555983 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7259142411396695 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7308725593709126 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5728868367555983 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7265735852624612 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7310293584632113 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5728868367555984 at iter 20
max_prior_anomaly= 0.7271119025481823 at iter 79
max_prior_star_anomaly= 0.7311962431252659 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5728868367555983
accuracies_anomaly['prior'][-1]= 0.7271119025481823
accuracies_anomaly['prior_star'][-1]= 0.7311505428873095



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.31450986862183 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5728868367555983
 first_prior_anomaly_auc= 0.7271788770348425
 first_prior_star_anomaly_auc= 0.7311707140268213


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5743202483571552; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7144003025670926; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7331975983737018 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5755812597506973; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.715761539310084; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7350057519265014 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.576476984414643; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7143618513323983; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7347075972705926 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5771590210693857; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7142781726208298; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7352430779898199 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.577703641836204 at iter 490
0.7271788770348425 at iter 0
0.7384244448996959 at iter 460
last anomaly aucs:
0.577703641836204
0.717843894290622
0.7368845044675922




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.5850784778595 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5777332681973619,first_prior_anomaly_auc= 0.7155500575192651, first_prior_star_anomaly_auc= 0.7363058449028477


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5777332681973619 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7255029389980616 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7298201932016957 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5777332681973619 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7256209716816111 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7269713349197093 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5777332681973619 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7258441149124605 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7303074522905275 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5777332681973619 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7275644924909782 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.734106875522007 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5777332681973619 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.724034543076414 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7340813464235624 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5777332681973619 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.7221869927667554 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7338767984619505 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5777332681973619 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.7224043052775895 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7343508202404778 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5777334257843894 at iter 53
max_prior_anomaly= 0.7285175788329105 at iter 7
max_prior_star_anomaly= 0.7606710055628221 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5777332681973619
accuracies_anomaly['prior'][-1]= 0.7223530894936729
accuracies_anomaly['prior_star'][-1]= 0.7345317301479741



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 71.88192439079285 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5777332681973619
 first_prior_anomaly_auc= 0.7223321304190239
 first_prior_star_anomaly_auc= 0.7345320453220291


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5789759994957215; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.727092676930835; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 70 
last prior star auc 0.7397560552815292 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.57954520383882; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7205819688923208; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 130 
last prior star auc 0.73713601336338 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5800390815828042; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7254244606583986; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 290 
last prior star auc 0.7401011708716139 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5804380919362718; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7281135256945648; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 290 
last prior star auc 0.7415437225207621 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5807040988385836 at iter 490
0.7364142647777234 at iter 290
0.7453566982366012 at iter 290
last anomaly aucs:
0.5807040988385836
0.726829821769072
0.74066375655956




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.59683656692505 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5807305734591928,first_prior_anomaly_auc= 0.7247173676662937, first_prior_star_anomaly_auc= 0.7408087366248011


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5807305734591928 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.720341963849536 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7340432103629229 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5807305734591928 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7260478749389351 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7341632916778291 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5807305734591928 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7292829790251667 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7376881983075153 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5807305734591928 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7286346659942953 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7374804986053548 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5807305734591928 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7283092487826403 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7374915296972753 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5807305734591928 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7277230250405787 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7377583245347243 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5807305734591928 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7268777282254125 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7366601005405236 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5807305734591928 at iter 0
max_prior_anomaly= 0.7305977275950644 at iter 34
max_prior_star_anomaly= 0.7408087366248011 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5807305734591928
accuracies_anomaly['prior'][-1]= 0.7266011629922625
accuracies_anomaly['prior_star'][-1]= 0.7366931938162851



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 71.9299738407135 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5807305734591928
 first_prior_anomaly_auc= 0.7265893439652048
 first_prior_star_anomaly_auc= 0.7366941393384496


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5821825803299873; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.724816174732496; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7430036087429284 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5828472824117119; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7195048615597964; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7399394865814646 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5832702459933499; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7139877397292655; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.739451597144523 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5836027546212397; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.7203255747986826; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7426827615550688 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5838435475991617 at iter 490
0.7265893439652048 at iter 0
0.7439516522999827 at iter 220
last anomaly aucs:
0.5838435475991617
0.7193381344847691
0.7427599791985124




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.54612493515015 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5838832595300755,first_prior_anomaly_auc= 0.7242009549773862, first_prior_star_anomaly_auc= 0.7447466788533968


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5838832595300755 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7268544053453521 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7372419118458169 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5838832595300755 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7256201837464741 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7350643743007076 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5838832595300755 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.727629891107364 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7361633862300456 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5838832595300755 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.728995697874151 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7373367792363332 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5838832595300755 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7288901145657689 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7383875695352758 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5838832595300755 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7297349386198528 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.739267535496478 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5838832595300755 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7296821469656618 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7395127409111681 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5838832595300755 at iter 0
max_prior_anomaly= 0.730612383188616 at iter 4
max_prior_star_anomaly= 0.7447466788533968 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5838832595300755
accuracies_anomaly['prior'][-1]= 0.7289592952708133
accuracies_anomaly['prior_star'][-1]= 0.7392197866271648



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.32088661193848 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.48871235639882127
accuracies_anomaly["prior"][-1]= 0.7178984194021147
accuracies_anomaly["prior_star"][-1]= 0.4923593929747704


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 1974.3200726509094 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003332376480102539 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46402146335313676
 first_prior_anomaly_auc= 0.7012989898671541
 first_prior_star_anomaly_auc= 0.46765731125013793


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.476362733819752; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7207986510550453; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.48489953827000964 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.48752036812329613; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7325294293773735; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5050843878531919 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5028605197220164; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7378801393069322; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5367522889515735 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5267098980411933; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.742358920213688; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.5771725735537451 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5498485588666341 at iter 490
0.7453607954993146 at iter 490
0.6098096348708574 at iter 490
last anomaly aucs:
0.5498485588666341
0.7453607954993146
0.6098096348708574




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.6017644405365 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5516822415178781,first_prior_anomaly_auc= 0.7455834659690813, first_prior_star_anomaly_auc= 0.6123310273098318


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5516822415178783 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7457894322139401 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6127990607813165 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5516822415178783 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7163816442630444 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6134952802685283 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5516822415178784 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6893565721669792 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6197169736987251 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5516822415178781 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7054465228422396 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6713702192035551 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5516822415178784 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7401579022014908 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7097558976945019 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5516822415178784 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7394273287422979 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7313270403580377 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5516822415178783 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7381656870006461 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7401742912523441 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5516822415178784 at iter 1
max_prior_anomaly= 0.7463597396662307 at iter 3
max_prior_star_anomaly= 0.7406221535843169 at iter 74
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5516822415178784
accuracies_anomaly['prior'][-1]= 0.7377348440676363
accuracies_anomaly['prior_star'][-1]= 0.7394226011314748



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.27480745315552 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5516822415178781
 first_prior_anomaly_auc= 0.7375928581559166
 first_prior_star_anomaly_auc= 0.7390954504625179


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.57074365318247; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7377613186882456; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 70 
last prior star auc 0.7530270892100162 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.580838362985959; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7374092692689538; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 70 
last prior star auc 0.7596963297981311 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5849551664906945; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7367089525190286; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 70 
last prior star auc 0.7631533164189924 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5868195786122886; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7359944529366342; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 70 
last prior star auc 0.7651187418251729 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5878421608333202 at iter 490
0.7377884236569645 at iter 70
0.7663488661613377 at iter 490
last anomaly aucs:
0.5878421608333202
0.7353722993523174
0.7663488661613377




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.60113596916199 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5879329309611232,first_prior_anomaly_auc= 0.7353141497391935, first_prior_star_anomaly_auc= 0.7664667412578596


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5879329309611232 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7422328505917394 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.760154750460942 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5879329309611232 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7423064437335518 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7581909009250358 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5879329309611232 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7423694785445263 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7569904029500292 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5879329309611232 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7425877365775251 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7560786044092851 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5879329309611232 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.742799218368344 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7553294356808549 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5879329309611232 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.743097845785335 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7547057062262634 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5879329309611232 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.7435119844934365 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7546155664465701 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5879329309611233 at iter 52
max_prior_anomaly= 0.7452479631876704 at iter 2
max_prior_star_anomaly= 0.766721717068251 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5879329309611232
accuracies_anomaly['prior'][-1]= 0.7437603416486755
accuracies_anomaly['prior_star'][-1]= 0.7540047591282285



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.34069180488586 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5879329309611232
 first_prior_anomaly_auc= 0.7437880769655042
 first_prior_star_anomaly_auc= 0.7539433001875286


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5900791086877728; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.743196180090455; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7543245032068959 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5906623382763131; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7428671383771688; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.754559150290748 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5904341522605858; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.7424821532691428; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7548182233638527 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5897773295302331; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.7421951872921821; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7550423121168666 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5906699024536299 at iter 220
0.7437880769655042 at iter 0
0.7552449690341492 at iter 490
last anomaly aucs:
0.5890618844256741
0.7419780323683756
0.7552449690341492




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.56581377983093 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5889843516081756,first_prior_anomaly_auc= 0.7419562853585893, first_prior_star_anomaly_auc= 0.755264824999606


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5889843516081756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7466719195675813 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7531547347022394 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5889843516081756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.748530816143215 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7523592353877429 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5889843516081756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7495143167814426 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7519132641000993 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5889843516081756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7500776904045259 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7515126778763572 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5889843516081756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7506267236081126 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7512482468443198 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5889843516081756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7510600879335613 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7509586018878927 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5889843516081756 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7513825109916952 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7506450037032952 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5889843516081756 at iter 0
max_prior_anomaly= 0.7517622957278157 at iter 79
max_prior_star_anomaly= 0.7616767259719179 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5889843516081756
accuracies_anomaly['prior'][-1]= 0.7517622957278157
accuracies_anomaly['prior_star'][-1]= 0.7504801676725973



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.4280366897583 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5889843516081756
 first_prior_anomaly_auc= 0.7517774240824495
 first_prior_star_anomaly_auc= 0.7504442378303418


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5883079880864207; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7492566619915848; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7500263170335818 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5875566131396064; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7478418456592655; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.750868777282254 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5869376112958381; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7467793939202925; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7515482925445578 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.586441212159415; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7461329719337504; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7521496446412531 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5889843516081756 at iter 0
0.7517774240824495 at iter 0
0.7525833241407568 at iter 490
last anomaly aucs:
0.5861134311423484
0.7457435743889562
0.7525833241407568




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.66341710090637 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5860901082622879,first_prior_anomaly_auc= 0.7457052807412894, first_prior_star_anomaly_auc= 0.752619569157067


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5860901082622879 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7478790361977401 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7526671604393527 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5860901082622879 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7500086672865091 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7512108987188175 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5860901082622879 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7505337472619255 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7516850780843721 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5860897930882331 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7526797674015475 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7514278960555967 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5860901082622879 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7529552295255055 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7511552704981326 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5860899506752605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.753659643538144 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7512272877696707 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5860901082622879 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7537934349244371 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7511505428873095 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5860901082622879 at iter 0
max_prior_anomaly= 0.755591660494508 at iter 74
max_prior_star_anomaly= 0.7583298926832343 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5860901082622879
accuracies_anomaly['prior'][-1]= 0.7543850166254314
accuracies_anomaly['prior_star'][-1]= 0.7510733252438659



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.72367715835571 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5860901082622879
 first_prior_anomaly_auc= 0.7539937280363079
 first_prior_star_anomaly_auc= 0.7509069133428936


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5852199126967869; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7465553051672786; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7522646831712814 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5849211276927683; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7449242794333171; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7525685109601777 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5847578675323447; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7447720503648141; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7532054777250737 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5846752919299684; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7445028917219534; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7534431189624471 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5860901082622879 at iter 0
0.7539937280363079 at iter 0
0.7538698646327433 at iter 480
last anomaly aucs:
0.584538506390154
0.7443434136501883
0.7536549159273208




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.74211668968201 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5846592180531698,first_prior_anomaly_auc= 0.7445167593803679, first_prior_star_anomaly_auc= 0.7541989063460297


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5846592180531698 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7427312983595191 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7534673873646721 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5846592180531698 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7449494933577068 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7562727516270861 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5846592180531699 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7436298595899586 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.752656759695542 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5846592180531698 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7434448524197488 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7526082228910915 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5846592180531698 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7451032982964843 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7527642340482532 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5846592180531698 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7445634051404889 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7527617126558142 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5846592180531698 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7447709472556219 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7528215957262399 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5846592180531699 at iter 7
max_prior_anomaly= 0.7454794585309737 at iter 79
max_prior_star_anomaly= 0.7588757741462723 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5846592180531698
accuracies_anomaly['prior'][-1]= 0.7454794585309737
accuracies_anomaly['prior_star'][-1]= 0.7531140772491609



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.2163577079773 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5846592180531698
 first_prior_anomaly_auc= 0.7453615834344518
 first_prior_star_anomaly_auc= 0.7530803536252895


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5806382274611154; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7356890492774635; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.754942717115527 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5806851883952913; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7367691507635092; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7568466835810077 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5807365617662354; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7387845312573869; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7586081913736861 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5807312038073026; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7347161069700743; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7566459177080542 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5846592180531698 at iter 0
0.7453615834344518 at iter 0
0.7603227382321887 at iter 140
last anomaly aucs:
0.5807356162440708
0.7337100713869235
0.7558403328238019




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.52566862106323 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5805799202609642,first_prior_anomaly_auc= 0.7330901240209906, first_prior_star_anomaly_auc= 0.7550643743007075


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5805799202609642 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7348289392817183 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7578038671856533 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5805799202609642 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7373229115779188 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7548639236018091 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.580579920260964 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.738235025292718 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7538288920056102 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.580579920260964 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7364643774524481 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7522640528231715 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5805799202609642 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.737133807144996 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7534298816521424 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5805799202609642 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.736722820177443 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7536517641867722 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.580579920260964 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7361602344894969 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7523961107521628 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5805799202609642 at iter 0
max_prior_anomaly= 0.7469935546905779 at iter 3
max_prior_star_anomaly= 0.7593781615897379 at iter 26
last values
accuracies_anomaly['vanilla_star'][-1]= 0.580579920260964
accuracies_anomaly['prior'][-1]= 0.7373632538569426
accuracies_anomaly['prior_star'][-1]= 0.7543842286902942



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.67748641967773 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5805799202609642
 first_prior_anomaly_auc= 0.7366487542745481
 first_prior_star_anomaly_auc= 0.7531859369336715


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5736552311013757; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7314636683108247; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 70 
last prior star auc 0.7526991506059222 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5743612209842885; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7361091762926076; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 70 
last prior star auc 0.7559887798036466 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5745645082496809; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.733578328631987; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 70 
last prior star auc 0.7555651858738989 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.574709488314922; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7230713711647258; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 320 
last prior star auc 0.7498485588666342 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5805799202609642 at iter 0
0.7396422774477206 at iter 320
0.7587935137179507 at iter 320
last anomaly aucs:
0.5747514064642198
0.7304045258994281
0.7534431189624471




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.505555391311646 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5747306049765983,first_prior_anomaly_auc= 0.7311653560678886, first_prior_star_anomaly_auc= 0.753543659485951


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5747306049765983 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7368118568479443 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7598004948232662 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5747306049765983 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7351340277668342 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7556168744188979 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5747306049765983 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.736958885544542 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7561874970452431 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5747306049765983 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7360414138708102 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7553051672786297 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5747306049765983 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7354800888790836 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7550096916021873 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5747306049765983 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.735365680697165 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7549260128906189 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5747306049765983 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7362809461525128 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7561000362450163 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5747306049765983 at iter 0
max_prior_anomaly= 0.7471003986951794 at iter 4
max_prior_star_anomaly= 0.7598004948232662 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5747306049765983
accuracies_anomaly['prior'][-1]= 0.7340941109727848
accuracies_anomaly['prior_star'][-1]= 0.7546291189309295



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 71.98356008529663 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5747306049765983
 first_prior_anomaly_auc= 0.7347564492490979
 first_prior_star_anomaly_auc= 0.7554353341632917


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5702204642513828; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7290404525899428; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 80 
last prior star auc 0.7470384669933972 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.570746174574909; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7294634161715807; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 80 
last prior star auc 0.750284129410467 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5709510377105756; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7348059315757127; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 80 
last prior star auc 0.7537639661503065 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5711817451187419; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7208828025276959; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 80 
last prior star auc 0.7429389980616795 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5747306049765983 at iter 0
0.7383138188064358 at iter 430
0.7561728414516917 at iter 430
last anomaly aucs:
0.5710471657973115
0.7284200324629277
0.7487325275383331




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.47217798233032 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5710890839466095,first_prior_anomaly_auc= 0.7296616606520951, first_prior_star_anomaly_auc= 0.7495545014734387


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5710890839466095 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7324353499219944 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7567953102100635 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5710890839466095 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.732973509620688 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7530901240209906 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5710890839466095 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7318908867422034 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7536401027467419 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5710890839466095 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7304319460422017 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7531364546070567 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5710890839466095 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7327749499661188 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7543397891485573 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5710890839466095 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7336148888223522 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7556613139606347 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5710890839466095 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.730219833903273 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7527133334383913 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5710892415336369 at iter 71
max_prior_anomaly= 0.7404644089698535 at iter 4
max_prior_star_anomaly= 0.7567953102100635 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5710890839466095
accuracies_anomaly['prior'][-1]= 0.7306155349291645
accuracies_anomaly['prior_star'][-1]= 0.7530797232771799



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.09449744224548 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5710890839466095
 first_prior_anomaly_auc= 0.7307849409836582
 first_prior_star_anomaly_auc= 0.7529690971839198


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5660935751768914; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7286830452117181; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 40 
last prior star auc 0.7443175693776889 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5674318042138772; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7242674567029641; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 150 
last prior star auc 0.7412525016940605 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5679499503600863; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7267135225428243; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 150 
last prior star auc 0.745222118915171 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.568049230187371; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7223398521833684; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 150 
last prior star auc 0.7423543501898924 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5710890839466095 at iter 0
0.7370080526971019 at iter 150
0.7529690971839198 at iter 0
last anomaly aucs:
0.5681387396189546
0.730369856753392
0.7478257717824669




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.44491171836853 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5681352727043509,first_prior_anomaly_auc= 0.7349041082938053, first_prior_star_anomaly_auc= 0.7482893928171832


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5681352727043509 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7365548324061963 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7560622153584318 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5681352727043509 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7390081472493184 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7527472146492901 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5681352727043509 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7380085727342925 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7518779646059537 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5681352727043509 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7374187244906 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7516006114376663 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5681352727043509 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7361466820051373 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7506896008320596 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5681352727043509 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7379745339363663 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7520569834691209 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5681352727043509 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7365841435932994 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7517698599051327 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5681352727043509 at iter 0
max_prior_anomaly= 0.73942228595742 at iter 5
max_prior_star_anomaly= 0.7561246198212963 at iter 11
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5681352727043509
accuracies_anomaly['prior'][-1]= 0.7352443386860393
accuracies_anomaly['prior_star'][-1]= 0.7509954772523126



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.19160413742065 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5681352727043509
 first_prior_anomaly_auc= 0.7358999007201728
 first_prior_star_anomaly_auc= 0.7529161479427013


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5674740375372299; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7234454827678585; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7449754952172338 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5678090675575587; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7248467466158186; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.743550120554076 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5683558945427611; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7292831366121941; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 290 
last prior star auc 0.7459240115353705 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5683555793687063; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.730505381596987; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 290 
last prior star auc 0.7487512803945979 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5685954268244638 at iter 470
0.7421009502497753 at iter 290
0.7536265502623823 at iter 290
last anomaly aucs:
0.5684482405408386
0.7250585435806925
0.7442321572088186




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.49053406715393 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5684936256047401,first_prior_anomaly_auc= 0.7328685566604156, first_prior_star_anomaly_auc= 0.7487757063838505


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5684936256047401 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7360981452006872 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7554293458562491 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5684936256047401 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7323092803000458 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7501085774619033 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5684936256047401 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7305436752446539 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7490656665143326 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5684936256047401 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7324424413382291 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7511741809414249 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5684936256047401 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7304023196810439 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7493294671982602 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5684936256047401 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7268165844587673 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7484501315851679 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5684936256047401 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7306631262114502 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7510755314622499 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5684936256047403 at iter 1
max_prior_anomaly= 0.7419197251682242 at iter 5
max_prior_star_anomaly= 0.7554293458562491 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5684936256047401
accuracies_anomaly['prior'][-1]= 0.728345651385978
accuracies_anomaly['prior_star'][-1]= 0.747943646878989



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.50096225738525 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5684936256047401
 first_prior_anomaly_auc= 0.7300381360606395
 first_prior_star_anomaly_auc= 0.7485495689994801


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5629928928250627; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.722985801408828; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 50 
last prior star auc 0.7356260144664891 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.564029500291536; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7338238492207323; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 200 
last prior star auc 0.7408161432150906 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5644795688418929; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7262071954236726; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 200 
last prior star auc 0.7407579936019667 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5650093764281325; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7205266558456908; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 200 
last prior star auc 0.7354373827946483 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5684936256047401 at iter 0
0.7382835620971682 at iter 430
0.7485495689994801 at iter 0
last anomaly aucs:
0.5647893849378319
0.7171107994389901
0.7360184061648045




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.525076389312744 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5650169406054494,first_prior_anomaly_auc= 0.72953905794475, first_prior_star_anomaly_auc= 0.7439740296578785


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5650169406054494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7367628472824117 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7540876499046598 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5650169406054494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7357876987566383 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7496440109050222 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5650169406054494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.737035157665821 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7510887687725547 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5650169406054493 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.735555100304143 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7505031753786028 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5650169406054494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7357533447846573 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7502330712135776 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5650169406054494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7363253856942498 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7516658524670249 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5650169406054494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7347356477614762 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7512318577934665 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5650169406054494 at iter 0
max_prior_anomaly= 0.7396611878910128 at iter 6
max_prior_star_anomaly= 0.7540876499046598 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5650169406054494
accuracies_anomaly['prior'][-1]= 0.7337441101848495
accuracies_anomaly['prior_star'][-1]= 0.7506352333075942



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.67756175994873 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5650169406054494
 first_prior_anomaly_auc= 0.734180626250847
 first_prior_star_anomaly_auc= 0.7509188899569786


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5626789794664103; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7242732874229794; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7367407850985708 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5634114439699324; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7278501977717194; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.73799643853318 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5636331689175347; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7265502623824006; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7384859038403959 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5639248625053186; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7251080259073074; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.739193784767638 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5650169406054494 at iter 0
0.734180626250847 at iter 0
0.7509188899569786 at iter 0
last anomaly aucs:
0.5643374253431457
0.7248007312038073
0.7392905432024834




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.57420516014099 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5643014955008904,first_prior_anomaly_auc= 0.729755582520447, first_prior_star_anomaly_auc= 0.7428141891359503


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5643014955008904 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7381483524276282 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.753971665852467 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5643014955008904 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7358608191373686 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7484290149234916 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5643014955008904 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7375186346659943 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7491126274485085 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5643014955008904 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7346410955450148 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7475581890098808 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5643014955008904 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7330344958003058 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7485342830578186 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5643014955008904 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7307849409836582 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7455051452164457 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5643014955008904 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7314783239043761 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7466347290291063 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5643014955008904 at iter 0
max_prior_anomaly= 0.7397376175993192 at iter 6
max_prior_star_anomaly= 0.753971665852467 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5643014955008904
accuracies_anomaly['prior'][-1]= 0.7317158075547221
accuracies_anomaly['prior_star'][-1]= 0.7465464802937423



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.15883946418762 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5643014955008904
 first_prior_anomaly_auc= 0.7317156499676947
 first_prior_star_anomaly_auc= 0.746490379311975


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.564152418172936; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7267125770206597; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 20 
last prior star auc 0.733966938241644 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.564353814393999; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.726067730904392; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 20 
last prior star auc 0.7351460043809194 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5645073041587216; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.7187153505523425; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 20 
last prior star auc 0.734979907654002 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.564577903147013; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.7227306680114093; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 370 
last prior star auc 0.7330652252706558 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5647739414091432 at iter 430
0.7368142206533558 at iter 370
0.746490379311975 at iter 0
last anomaly aucs:
0.564739902611217
0.7231949193942355
0.7333722048001009




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.46093726158142 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5648511590525868,first_prior_anomaly_auc= 0.7276565233150007, first_prior_star_anomaly_auc= 0.7350725688261343


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5648511590525868 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7299207337251997 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7462956017460644 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5648511590525869 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.727606725814331 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7410526813432718 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5648511590525868 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7244436389996376 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7404648817309359 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5648511590525868 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7237849252249555 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7421283703925493 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5648511590525868 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7242145074617459 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7408270167199835 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5648511590525869 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7223088075389633 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7412644783081457 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5648511590525868 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.7241524181729361 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7414047307625636 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5648511590525869 at iter 6
max_prior_anomaly= 0.7400748538380321 at iter 6
max_prior_star_anomaly= 0.7501369431268419 at iter 9
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5648511590525869
accuracies_anomaly['prior'][-1]= 0.7241927604519596
accuracies_anomaly['prior_star'][-1]= 0.7422645255842539



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.53608727455139 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5648511590525868
 first_prior_anomaly_auc= 0.724376191751895
 first_prior_star_anomaly_auc= 0.7426358006208928


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5635236459334667; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7234684904738642; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 50 
last prior star auc 0.734891343744583 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5640213057661093; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7218519627464266; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 50 
last prior star auc 0.7303235261673259 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5638394503364483; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7313966938241643; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 300 
last prior star auc 0.7357401074743527 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5641886631892462; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7172472698047497; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 380 
last prior star auc 0.7317667081645839 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5648511590525868 at iter 0
0.7326003435397198 at iter 380
0.7426358006208928 at iter 0
last anomaly aucs:
0.5639078431063556
0.7225869486423877
0.7380642009549774




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.541919469833374 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5638489055580944,first_prior_anomaly_auc= 0.7125488125817483, first_prior_star_anomaly_auc= 0.7277624217974377


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5638489055580944 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7287218116204673 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7423489922309595 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5638489055580944 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7227738468569267 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7352840506169531 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5638489055580944 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7219351686969129 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7353871125328963 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5638489055580944 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7218811163465023 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7356329482956963 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5638489055580944 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7204335219124762 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7371341223190506 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5638489055580944 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.721177805443056 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7378801393069323 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5638489055580944 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7197002694738169 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.736670816458389 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5638489055580944 at iter 0
max_prior_anomaly= 0.7403183257954205 at iter 6
max_prior_star_anomaly= 0.7463797532187151 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5638489055580944
accuracies_anomaly['prior'][-1]= 0.7209943741431205
accuracies_anomaly['prior_star'][-1]= 0.7369270529649999



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.31082105636597 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5638489055580944
 first_prior_anomaly_auc= 0.72102021841562
 first_prior_star_anomaly_auc= 0.7369834691208219


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5620609231448068; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7137690089351845; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.7229610602455205 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5614204894653072; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.718175457396347; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.7247137431646626 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5619786627164851; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7206590289487369; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.7273898860645791 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5618324219550246; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7296875049245947; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.7344980065241029 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5638489055580944 at iter 0
0.7373084135713949 at iter 10
0.7369834691208219 at iter 0
last anomaly aucs:
0.5617665505775564
0.7126063318467624
0.7251855587248057




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.56327795982361 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.562170918889957,first_prior_anomaly_auc= 0.7168195786122886, first_prior_star_anomaly_auc= 0.7241064027609246


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.562170918889957 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7320175867122618 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.740678254566084 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.562170918889957 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7280205493483776 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7344245709693178 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.562170918889957 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.726715256000126 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7342023732606332 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.562170918889957 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7279143356918858 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7350479852498542 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.562170918889957 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7273164505097941 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7326003435397198 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.562170918889957 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.725534141229494 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.733295617504767 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.562170918889957 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7256803819909546 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7342695053343209 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.562170918889957 at iter 0
max_prior_anomaly= 0.7419094820114408 at iter 6
max_prior_star_anomaly= 0.7455360322738231 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.562170918889957
accuracies_anomaly['prior'][-1]= 0.727480971366437
accuracies_anomaly['prior_star'][-1]= 0.7357968388042296



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.01764106750488 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.46402146335313676
accuracies_anomaly["prior"][-1]= 0.7012989898671541
accuracies_anomaly["prior_star"][-1]= 0.46765731125013793


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 1938.6508858203888 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0031719207763671875 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.47768031895614355
 first_prior_anomaly_auc= 0.7139390453377878
 first_prior_star_anomaly_auc= 0.48138645066738106


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4935053658382842; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.729306617079282; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.502135146634729 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5036969916636462; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7386455394991884; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5219335928266385 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5223080196038261; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7431695478828181; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5567622169343021 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5419168886017303; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.745942291630553; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.592724049356257 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5579605086909245 at iter 490
0.7484045889342389 at iter 490
0.6187834281481948 at iter 490
last anomaly aucs:
0.5579605086909245
0.7484045889342389
0.6187834281481948




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.40673899650574 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5594142490190208,first_prior_anomaly_auc= 0.748649006413792, first_prior_star_anomaly_auc= 0.6209426855981216


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5594142490190208 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7518609452069905 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.621258805175158 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5594142490190208 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7220149077327955 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6218989236806025 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5594140914319934 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6823389066612037 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6281973619931608 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5594142490190208 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6968928565800464 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6789189529917897 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5594142490190208 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7337876042044218 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7170345273177112 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5594142490190208 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7388105331169137 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7390377736104764 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5594142490190208 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7391460358983247 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.743771687914651 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5594144066060482 at iter 19
max_prior_anomaly= 0.7522140977354743 at iter 8
max_prior_star_anomaly= 0.7461342326299699 at iter 72
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5594142490190208
accuracies_anomaly['prior'][-1]= 0.7391852750681565
accuracies_anomaly['prior_star'][-1]= 0.7449693493231637



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.4682765007019 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5594142490190208
 first_prior_anomaly_auc= 0.7392829790251666
 first_prior_star_anomaly_auc= 0.7447808752383505


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5750965220543045; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7385136391572246; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7562037285090691 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5832592149014293; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7372929700427061; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7614860456687205 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5870195565501048; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.735842854216241; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7642022156736057 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5887703484249176; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7345036796570905; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7657462533684227 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5895961044486817 at iter 490
0.7392829790251666 at iter 0
0.7666804292670628 at iter 490
last anomaly aucs:
0.5895961044486817
0.7335225428242749
0.7666804292670628




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.4875123500824 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5896380225979797,first_prior_anomaly_auc= 0.7334409127440629, first_prior_star_anomaly_auc= 0.766758592432671


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5896380225979797 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7447969491151488 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7604853680445025 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5896380225979797 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7450572828844729 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7586044092850275 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5896380225979797 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7450216682162725 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7574716737318183 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5896380225979797 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7452063602124273 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.756943757189908 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5896380225979797 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7451218935657216 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7558412783459665 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5896380225979797 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7453358967489795 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7549052114029973 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5896380225979797 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7454638574152576 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7540867043824953 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5896380225979798 at iter 17
max_prior_anomaly= 0.7455807869896149 at iter 78
max_prior_star_anomaly= 0.766758592432671 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5896380225979797
accuracies_anomaly['prior'][-1]= 0.7455596703279386
accuracies_anomaly['prior_star'][-1]= 0.7533974187244905



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.29448008537292 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5896380225979797
 first_prior_anomaly_auc= 0.7456397245378761
 first_prior_star_anomaly_auc= 0.7533280804324187


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5915684636840696; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7452924027294073; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7540113777833808 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5920260964117434; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7447436846998756; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7543492443702035 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5914628803756875; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7440134264147377; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7544327654947445 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5905911089399121; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7433184676237452; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7545263721890414 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5920497344658587 at iter 180
0.7456397245378761 at iter 0
0.7545944497848938 at iter 490
last anomaly aucs:
0.5896807286824148
0.74276628267961
0.7545944497848938




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.81260871887207 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5895916920119135,first_prior_anomaly_auc= 0.7427309831854642, first_prior_star_anomaly_auc= 0.754603589832485


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5895916920119135 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7515145689206865 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7530463148273634 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5895916920119135 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7532559055738532 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7523734182202122 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5895916920119135 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.754092062341428 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.751882061868667 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5895916920119135 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7546637880769655 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7514694990308397 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5895916920119135 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.754822320626566 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7509359093559418 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5895916920119135 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7552016326016042 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7506254629118931 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5895916920119135 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7553354239878973 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7501720850339599 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5895916920119135 at iter 0
max_prior_anomaly= 0.7554700033093277 at iter 66
max_prior_star_anomaly= 0.7547756748664449 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5895916920119135
accuracies_anomaly['prior'][-1]= 0.7553625289566163
accuracies_anomaly['prior_star'][-1]= 0.7496963297981311



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.87060379981995 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5895916920119135
 first_prior_anomaly_auc= 0.7554227272010969
 first_prior_star_anomaly_auc= 0.7497032636273382


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5888806593441227; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7516321288431537; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7481967316450511 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5883072001512836; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7490023165293034; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7487895740422649 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5878304993932899; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7473277967757694; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7493468017712782 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5874406290874135; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7463346833288684; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7497713412231906 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5895916920119135 at iter 0
0.7554227272010969 at iter 0
0.7500953401515988 at iter 490
last anomaly aucs:
0.5871238791622674
0.7457774555998551
0.7500953401515988




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.62336707115173 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5870939376270545,first_prior_anomaly_auc= 0.745739161952188, first_prior_star_anomaly_auc= 0.7501306396457443


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5870939376270545 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7517124982271459 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7509875979009408 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5870939376270545 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7528855760593788 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7495065950170983 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5870939376270545 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.754072521550026 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7507156026915864 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5870939376270545 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7540665332429834 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7490880438722285 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5870939376270545 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7555885087539596 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7495573380399325 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5870939376270545 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7543315946231307 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7480738137636509 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5870939376270545 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7565989567738785 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7497136643711491 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5870939376270545 at iter 0
max_prior_anomaly= 0.7565989567738785 at iter 70
max_prior_star_anomaly= 0.7579819405266559 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5870939376270545
accuracies_anomaly['prior'][-1]= 0.7564133192555589
accuracies_anomaly['prior_star'][-1]= 0.7489011456576895



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.8144097328186 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5870939376270545
 first_prior_anomaly_auc= 0.7564126889074492
 first_prior_star_anomaly_auc= 0.7489033518760736


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5869852025781237; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7434573017949164; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7483250074853838 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5871881746694612; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7426487227571428; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7492588682099689 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5871424744315048; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.7423307121357771; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.749910332981389 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5871557117418095; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.7405811809571837; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7485979482169027 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5872636588556029 at iter 390
0.7564126889074492 at iter 0
0.7530708984036434 at iter 290
last anomaly aucs:
0.5871992057613817
0.7436065367098981
0.7518713459508013




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.53746819496155 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5872080306349181,first_prior_anomaly_auc= 0.7430713711647257, first_prior_star_anomaly_auc= 0.7514405030177915


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5872080306349181 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7403312479316704 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7482503112343792 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5872080306349181 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7417671809256663 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7486269442299509 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5872080306349181 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7422869029421497 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7490180752320469 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5872080306349181 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.742713963786501 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7491715649967694 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5872080306349181 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7430992640685818 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7521969207494839 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5872080306349181 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7431047796145421 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.748822194556944 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5872080306349181 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7431775848212175 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7498220842460248 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5872080306349181 at iter 0
max_prior_anomaly= 0.7456595805033329 at iter 5
max_prior_star_anomaly= 0.7602269253195076 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5872080306349181
accuracies_anomaly['prior'][-1]= 0.7431457522416755
accuracies_anomaly['prior_star'][-1]= 0.7494309532439289



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.767333984375 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5872080306349181
 first_prior_anomaly_auc= 0.743606221535843
 first_prior_star_anomaly_auc= 0.7501876861496761


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5833421056778606; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7342616259829491; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7471040231968105 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5837548261027152; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7331840458893424; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7468673274816018 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.583889247837118; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.734347668499929; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 220 
last prior star auc 0.7487186598799187 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5840411617315663; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7348582504688215; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 220 
last prior star auc 0.749554186299384 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5872080306349181 at iter 0
0.7468610240005042 at iter 220
0.7567716721559481 at iter 220
last anomaly aucs:
0.5841248404431347
0.7405023874434656
0.7527708527034054




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.64215683937073 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.584118064200955,first_prior_anomaly_auc= 0.7408837480498607, first_prior_star_anomaly_auc= 0.7540640118505444


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5841180642009549 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7371903808878454 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7528915643664214 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5841180642009549 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7385691097908819 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7528830546669397 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5841180642009549 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7374994090486471 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7521319948941803 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.584118064200955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7379554659060465 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.75208345808973 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5841180642009549 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7373025828513797 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7553514978646958 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5841180642009549 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7377379958081851 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7518045290511685 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5841180642009549 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7385949540633816 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.752804261153222 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.584118064200955 at iter 0
max_prior_anomaly= 0.7419146823833461 at iter 8
max_prior_star_anomaly= 0.7590289487369399 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5841180642009549
accuracies_anomaly['prior'][-1]= 0.7385858140157903
accuracies_anomaly['prior_star'][-1]= 0.7548878768299794



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.68403768539429 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.584118064200955
 first_prior_anomaly_auc= 0.7339180862631387
 first_prior_star_anomaly_auc= 0.7549638337772036


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.580895094315836; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7238240068077596; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 70 
last prior star auc 0.7421447594434025 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.581268575570859; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7266003750571253; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 70 
last prior star auc 0.7443412074318042 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5810344012480892; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.720053894763383; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 70 
last prior star auc 0.7406653324298343 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5811541673889405; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7220962226389522; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 310 
last prior star auc 0.7419947365932836 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.584118064200955 at iter 0
0.7379904502261374 at iter 310
0.7549638337772036 at iter 0
last anomaly aucs:
0.581293159147139
0.7351215783916667
0.7503884520226295




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.564560651779175 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5812424161243047,first_prior_anomaly_auc= 0.7183191767653687, first_prior_star_anomaly_auc= 0.7405547063365743


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5812424161243047 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7326372189041398 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7560935751768914 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5812424161243047 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7199628094615251 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7414598862221662 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5812424161243047 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7190387191326411 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7417737995808185 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5812424161243047 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7197232771798225 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7424013111240683 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5812424161243047 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.719789936492428 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7423716847629103 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5812424161243047 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7202423688481965 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7428208077911026 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5812424161243047 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7201348944954852 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.743139448760578 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5812424161243047 at iter 0
max_prior_anomaly= 0.7326410009927983 at iter 9
max_prior_star_anomaly= 0.7560935751768914 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5812424161243047
accuracies_anomaly['prior'][-1]= 0.7189457427864538
accuracies_anomaly['prior_star'][-1]= 0.7434662842554802



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.36682891845703 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5812424161243047
 first_prior_anomaly_auc= 0.7178782482626029
 first_prior_star_anomaly_auc= 0.7417233717320391


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5768449501237058; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7175356540649575; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 90 
last prior star auc 0.7386882455836236 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5770758151188995; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7211125644136974; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 110 
last prior star auc 0.7398805490332035 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5769547882818287; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7313925965614511; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 110 
last prior star auc 0.7496003592984226 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5772352931906646; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7256050553918402; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 110 
last prior star auc 0.7443241880328411 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5812424161243047 at iter 0
0.7359612020738453 at iter 110
0.7520147501457679 at iter 110
last anomaly aucs:
0.5771662700726476
0.7239743448319335
0.7421122965157508




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.55647325515747 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5773585262461194,first_prior_anomaly_auc= 0.7214559465464803, first_prior_star_anomaly_auc= 0.740672108672014


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5773585262461194 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7366512756669872 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7568372283593614 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5773585262461194 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7249268008257561 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.745064531887735 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5773585262461194 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7241136517641867 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7446658367083222 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5773585262461194 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7248057739886853 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.74721590998629 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5773585262461194 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7245266873630962 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7439525978221473 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5773585262461194 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7253343208787053 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7460891627401233 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5773585262461194 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7266236979371858 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7488439415667303 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5773585262461194 at iter 0
max_prior_anomaly= 0.7366512756669872 at iter 10
max_prior_star_anomaly= 0.7574981483524277 at iter 11
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5773585262461194
accuracies_anomaly['prior'][-1]= 0.7252652977606884
accuracies_anomaly['prior_star'][-1]= 0.7454096474778196



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.35332584381104 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5773585262461194
 first_prior_anomaly_auc= 0.7248814157618545
 first_prior_star_anomaly_auc= 0.7452050995162078


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5773657752493815; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7251121231700206; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 80 
last prior star auc 0.7446399924358227 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5782734765274122; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7288220369699165; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 80 
last prior star auc 0.7498630568731582 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5785757284460343; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.7255141276770096; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 280 
last prior star auc 0.7463167184077406 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5787692453157256; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.7298112107411319; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 280 
last prior star auc 0.745615456135651 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5789249412988322 at iter 340
0.7342745481191988 at iter 280
0.7498630568731582 at iter 200
last anomaly aucs:
0.5788719920576139
0.7257870684085286
0.7428791149912539




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.580666303634644 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5788902721527963,first_prior_anomaly_auc= 0.7207706005641615, first_prior_star_anomaly_auc= 0.7430833477788108


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.578890114565769 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7347854452621461 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7539332146177726 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5788902721527964 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7275641773169232 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7457582299825078 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.578890114565769 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7282384922073215 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7469659769607765 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.578890114565769 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7287892588682099 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7472305655798415 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5788902721527964 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.730155065634997 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7497681894826418 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.578890114565769 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7301605811809573 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7479427013568243 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5788902721527964 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7321666640402162 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7504713427990608 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5788902721527964 at iter 4
max_prior_anomaly= 0.7359591534424886 at iter 1
max_prior_star_anomaly= 0.7574092692689538 at iter 12
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5788901145657689
accuracies_anomaly['prior'][-1]= 0.730340545566289
accuracies_anomaly['prior_star'][-1]= 0.7492106465795736



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.59951496124268 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.578890114565769
 first_prior_anomaly_auc= 0.7295248751122807
 first_prior_star_anomaly_auc= 0.7468748916589186


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.574342940889106; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7311674046992451; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 100 
last prior star auc 0.7442444489969586 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5746291189309296; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7179475865546747; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 100 
last prior star auc 0.7361495185716311 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5749720283026301; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7192059189687505; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 220 
last prior star auc 0.7364492490978143 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5751021951872922; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7298570685661157; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 220 
last prior star auc 0.7436891123122744 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.578890114565769 at iter 0
0.7321263217611926 at iter 220
0.7468748916589186 at iter 0
last anomaly aucs:
0.5748535228579983
0.7252987062105047
0.739318908867422




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.63491630554199 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5751349732889989,first_prior_anomaly_auc= 0.7276246907354587, first_prior_star_anomaly_auc= 0.7435189183226437


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5751349732889989 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7349726586507399 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.748380005357959 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5751349732889989 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7327093937627055 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.745266243282853 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5751349732889989 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7317525253321147 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7470989804119325 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5751349732889989 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7334781032825379 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7481069070394125 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5751349732889989 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7348286241076634 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7491203492128528 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5751349732889989 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7351406464219865 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7496979056684053 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5751349732889989 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7350003939675687 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7500064610681249 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5751349732889989 at iter 0
max_prior_anomaly= 0.7384852734922861 at iter 1
max_prior_star_anomaly= 0.7581199867626897 at iter 13
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5751349732889989
accuracies_anomaly['prior'][-1]= 0.7338935026868587
accuracies_anomaly['prior_star'][-1]= 0.7465770521770648



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.6614773273468 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5751349732889989
 first_prior_anomaly_auc= 0.7342715539656776
 first_prior_star_anomaly_auc= 0.7476904045258994


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5721143451471075; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7272836724080873; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7437036103187986 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5726403706446885; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7231326725183982; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7442977134122319 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5728631987014828; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7264541342956647; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 240 
last prior star auc 0.7418648848826765 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5728600469609342; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7254090171297098; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 240 
last prior star auc 0.7437748396551995 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5751349732889989 at iter 0
0.7350613801471864 at iter 240
0.7495639566950849 at iter 240
last anomaly aucs:
0.5728408213435869
0.7267775028759632
0.7448636084277542




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.50870156288147 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5733337535654065,first_prior_anomaly_auc= 0.7243361646469262, first_prior_star_anomaly_auc= 0.7416313409080164


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5733337535654065 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7326778763572184 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7469546306948012 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5733337535654065 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7289366027388625 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7431547347022394 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5733337535654065 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7288255038845203 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7431167562286273 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5733337535654065 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7287151929653151 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7435028444458451 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5733337535654065 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7286597223316577 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7436522369478544 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5733337535654065 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7297571583907212 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7447090155538396 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5733337535654065 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7288343287580566 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7455763745528468 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5733337535654065 at iter 0
max_prior_anomaly= 0.735299178971587 at iter 12
max_prior_star_anomaly= 0.7545998077438265 at iter 13
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5733337535654065
accuracies_anomaly['prior'][-1]= 0.7300925035851049
accuracies_anomaly['prior_star'][-1]= 0.7456810123390643



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.40707683563232 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5733337535654065
 first_prior_anomaly_auc= 0.7295660053264414
 first_prior_star_anomaly_auc= 0.7424293616149519


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5709921679247364; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7291173550593314; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 50 
last prior star auc 0.7383900909277148 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.571454055502151; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7252153426729911; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 50 
last prior star auc 0.7396763162456467 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5714387695604898; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7214556313724254; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 50 
last prior star auc 0.7363165608207132 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5714858880816931; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7301837464739902; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 50 
last prior star auc 0.7412600658713775 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5733337535654065 at iter 0
0.7349294798052224 at iter 420
0.7442800636651592 at iter 410
last anomaly aucs:
0.5715315883196495
0.7308716138487479
0.7412948926044408




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.55894637107849 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5713859779062987,first_prior_anomaly_auc= 0.7207356162440708, first_prior_star_anomaly_auc= 0.7372709078588651


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5713859779062989 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.737396031958649 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7485821895141591 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5713859779062989 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7250426272909214 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7430770442977134 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5713859779062987 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7258849299525663 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7420894463967727 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5713859779062987 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7264156830609705 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7454172116551365 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5713859779062987 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.724055186977008 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7421876231148652 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5713859779062987 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7255286256835337 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7429484532833257 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5713859779062989 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7249181335392471 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7431511102006082 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5713859779062989 at iter 1
max_prior_anomaly= 0.7399297161857636 at iter 1
max_prior_star_anomaly= 0.7540019225617347 at iter 11
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5713859779062987
accuracies_anomaly['prior'][-1]= 0.7275518855287832
accuracies_anomaly['prior_star'][-1]= 0.7467768725278535



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.49273586273193 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5713859779062989
 first_prior_anomaly_auc= 0.7273084135713948
 first_prior_star_anomaly_auc= 0.7439756055281528


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5676801613691161; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7346626849677734; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 100 
last prior star auc 0.742797800085097 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5677800715445105; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7217649747072821; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 100 
last prior star auc 0.7381048584080558 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5681504010589848; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7164738326740943; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 100 
last prior star auc 0.735508139369967 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5679477441417022; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7288674220338182; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 100 
last prior star auc 0.7398502923239358 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5713859779062989 at iter 0
0.7346626849677734 at iter 100
0.7439756055281528 at iter 0
last anomaly aucs:
0.5678005578580771
0.7235063113604489
0.740432733977339




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.49728870391846 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5680764927431174,first_prior_anomaly_auc= 0.7217243172542037, first_prior_star_anomaly_auc= 0.741544037694817


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.56807633515609 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7355402871235641 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7451943835983421 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5680764927431174 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7276306790425012 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.744823423735758 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5680764927431174 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7275953795483555 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.746586192224656 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5680764927431174 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7286316718407739 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7464651653875853 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5680764927431174 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7285390106686416 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7464665836708322 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5680764927431174 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7284176686575161 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7462725940400586 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5680764927431174 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7288355894542761 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7468635453929432 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5680764927431174 at iter 0
max_prior_anomaly= 0.739527869265802 at iter 1
max_prior_star_anomaly= 0.7537129079534173 at iter 12
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5680764927431174
accuracies_anomaly['prior'][-1]= 0.7289221047323384
accuracies_anomaly['prior_star'][-1]= 0.7460138361410089



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.40550899505615 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5680764927431174
 first_prior_anomaly_auc= 0.7297703957010259
 first_prior_star_anomaly_auc= 0.7475997919851237


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5688847566068361; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7180003782088659; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 40 
last prior star auc 0.7371713128575256 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5691967789211592; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7245615140961597; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 40 
last prior star auc 0.74199126967868 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5694782293521597; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.7213859779062988; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 290 
last prior star auc 0.7426610145452825 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5694311108309564; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.722524859353578; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 290 
last prior star auc 0.7409783002663222 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5695576532139874 at iter 440
0.7367103708022755 at iter 470
0.7480826386371875 at iter 470
last anomaly aucs:
0.5694558519942639
0.7270822761870243
0.743387805915817




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.408202171325684 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5695500890366705,first_prior_anomaly_auc= 0.7216609672691745, first_prior_star_anomaly_auc= 0.740636966764896


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5695500890366705 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7364818696124935 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7458477394140914 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5695500890366705 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7275408544368627 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7468295065950171 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5695500890366705 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7256348393400256 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7440679515262303 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5695500890366705 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7259892525647288 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7458165371826591 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5695500890366705 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7265173266936665 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7446239185590242 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5695500890366705 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.726236979371858 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7453204532202908 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5695500890366705 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.727456702964212 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.746913342893613 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5695500890366705 at iter 0
max_prior_anomaly= 0.736868903351876 at iter 1
max_prior_star_anomaly= 0.7481384244448996 at iter 13
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5695500890366705
accuracies_anomaly['prior'][-1]= 0.7282529902138456
accuracies_anomaly['prior_star'][-1]= 0.7474800258442725



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.17772245407104 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5695500890366705
 first_prior_anomaly_auc= 0.726654112233481
 first_prior_star_anomaly_auc= 0.7439021699733678


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5665638148667602; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7290368280883119; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.7395196747403754 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.566848259451282; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7232688277101029; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.7398102652189671 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5670614746994027; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7199971634335061; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 270 
last prior star auc 0.7377165639724538 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5669338292071797; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7254468380162944; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 270 
last prior star auc 0.7417964921127693 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5695500890366705 at iter 0
0.7340198874828623 at iter 270
0.7454414800573617 at iter 190
last anomaly aucs:
0.5667492947980522
0.725831665537293
0.7400910853018579




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.57139348983765 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5666530091242888,first_prior_anomaly_auc= 0.7235093055139702, first_prior_star_anomaly_auc= 0.7412783459665601


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.566653009124289 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.736860551239422 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7453455095576533 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5666530091242888 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7289358148037253 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7459681359030524 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5666530091242888 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7268465259939803 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7437321335707644 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.566653009124289 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7272365538868839 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7430329199300314 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5666530091242888 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7275008273318941 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7451300880911483 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5666530091242888 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7272031454370677 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7429451439557495 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5666530091242888 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7282250973099894 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.742834675449517 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.566653009124289 at iter 2
max_prior_anomaly= 0.739835479143357 at iter 1
max_prior_star_anomaly= 0.7491829112627448 at iter 14
last values
accuracies_anomaly['vanilla_star'][-1]= 0.566653009124289
accuracies_anomaly['prior'][-1]= 0.7270156168744188
accuracies_anomaly['prior_star'][-1]= 0.7423685330223616



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.25904369354248 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.47768031895614355
accuracies_anomaly["prior"][-1]= 0.7139390453377878
accuracies_anomaly["prior_star"][-1]= 0.48138645066738106


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 1939.2551918029785 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0032541751861572266 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.48974849110421237
 first_prior_anomaly_auc= 0.7162762185416897
 first_prior_star_anomaly_auc= 0.49340892257749347


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5056450824968088; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7326220905495059; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5138675008273319 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.519596892383819; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7429356887341034; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5373071528751754 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5406798304363585; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7487541169610917; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5738383472272562 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5528550041760563; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7520035614668201; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6033745686055123 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5632510203760026 at iter 490
0.7539387301637329 at iter 490
0.624270608443513 at iter 490
last anomaly aucs:
0.5632510203760026
0.7539387301637329
0.624270608443513




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.72318124771118 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5642006398033315,first_prior_anomaly_auc= 0.7540852860992483, first_prior_star_anomaly_auc= 0.625988937390674


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5642006398033315 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.754336794995036 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.626040625935673 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5642006398033315 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7544146429865892 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6260601667270751 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5642006398033315 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.754255480088879 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6261066549001686 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5642006398033315 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7539280142458671 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6261381723056558 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5642006398033315 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7533739382574027 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6261805632160361 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5642006398033315 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7525659895677389 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6262265786280474 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5642006398033315 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7514294719258712 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6262675512551807 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5642006398033315 at iter 0
max_prior_anomaly= 0.7544370203444852 at iter 17
max_prior_star_anomaly= 0.6263094694044786 at iter 78
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5642006398033315
accuracies_anomaly['prior'][-1]= 0.7499478386939187
accuracies_anomaly['prior_star'][-1]= 0.6263082087082592



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 71.74748063087463 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5642006398033315
 first_prior_anomaly_auc= 0.7497823723151111
 first_prior_star_anomaly_auc= 0.6263141970153017


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5730853964101675; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7504368312400523; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6404409285027657 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5788387411948248; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7506517799454748; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 170 
last prior star auc 0.6481359030524607 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5823581322785508; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.749922624769529; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 170 
last prior star auc 0.6520358668074444 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5840416344926486; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7488157334888191; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 170 
last prior star auc 0.6539997163433506 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5849728162377673 at iter 490
0.7507050443607481 at iter 170
0.6551841404415588 at iter 490
last anomaly aucs:
0.5849728162377673
0.7478145831035189
0.6551841404415588




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.55175852775574 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5850695746726129,first_prior_anomaly_auc= 0.7477023811399846, first_prior_star_anomaly_auc= 0.6553054824526845


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5850695746726129 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7476563657279732 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6553051672786296 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5850695746726129 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7462130261436879 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6552903540980507 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5850695746726129 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7426498258663345 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6553035914083553 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5850695746726129 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.737015616874419 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6553171438927147 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5850695746726129 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.730072647619648 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6553250232440866 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5850695746726129 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.723694785445262 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6553439336873788 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5850695746726129 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7173968198937863 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6553600075641772 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5850695746726129 at iter 0
max_prior_anomaly= 0.747746663094694 at iter 8
max_prior_star_anomaly= 0.6553918401437194 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5850695746726129
accuracies_anomaly['prior'][-1]= 0.7119375325023244
accuracies_anomaly['prior_star'][-1]= 0.6553918401437194



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.21646285057068 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5850695746726129
 first_prior_anomaly_auc= 0.7113911782782041
 first_prior_star_anomaly_auc= 0.6553956222323778


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5858382841924452; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7092248294120428; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6564750933703138 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5863879477441416; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7073807460169879; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.65730809839734 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5865981688387412; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.7060187213388593; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6578108010148604 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5866054178420033; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.705030177915754; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6580642009549774 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5866186551523078 at iter 340
0.7113911782782041 at iter 0
0.6581095860188789 at iter 440
last anomaly aucs:
0.586436484548592
0.704322296988512
0.6581013914934521




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.56110906600952 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5864276596750555,first_prior_anomaly_auc= 0.7042685598121562, first_prior_star_anomaly_auc= 0.6581064342783303


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5864276596750555 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.695880517515798 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6581574924752195 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5864276596750555 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6860745071465717 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6582570874765589 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5864276596750555 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6789321903020943 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6583793750098492 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5864276596750555 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6742304237515168 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6585133239831698 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5864276596750555 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6682077627369716 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.658702113242038 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5864276596750555 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6631372425421939 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6589321903020944 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5864276596750555 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6588442567407851 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6591947302898025 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5864276596750555 at iter 0
max_prior_anomaly= 0.7042685598121562 at iter 0
max_prior_star_anomaly= 0.6594903635532723 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5864276596750555
accuracies_anomaly['prior'][-1]= 0.6562324093480624
accuracies_anomaly['prior_star'][-1]= 0.6594903635532723



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.47295069694519 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5864276596750555
 first_prior_anomaly_auc= 0.6559898829128386
 first_prior_star_anomaly_auc= 0.6595204626755126


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.586142584742424; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6553611106733693; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6594427722709866 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5858155916604945; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6549515419890634; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.65923790913532 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5854484138865688; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6546308523882313; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6589778905400507 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5850591739288021; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.654471689490521; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6586999070236538 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5864276596750555 at iter 0
0.6559898829128386 at iter 0
0.6595232992420064 at iter 10
last anomaly aucs:
0.5847099610760043
0.6544787809067557
0.65842665111808




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.53527903556824 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5846730857115843,first_prior_anomaly_auc= 0.6544896544116489, first_prior_star_anomaly_auc= 0.6583951337125928


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5846730857115843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6509675843484564 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6587746032746584 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5846730857115843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6479390768551933 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6592459460737192 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5846730857115843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6447629103172227 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6598134169595159 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5846730857115843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6412039648896103 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6605052240099596 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5846730857115843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6377242857367982 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6613653340057046 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5846730857115843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.634839655199584 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6624082449532754 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5846730857115843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6324068266700287 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6636402603337693 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5846730857115843 at iter 0
max_prior_anomaly= 0.6544896544116489 at iter 0
max_prior_star_anomaly= 0.6649179759522196 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5846730857115843
accuracies_anomaly['prior'][-1]= 0.6306675386482186
accuracies_anomaly['prior_star'][-1]= 0.6649179759522196



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 71.6151397228241 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5846730857115843
 first_prior_anomaly_auc= 0.6305345351970626
 first_prior_star_anomaly_auc= 0.6650639015396252


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.58426525048458; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6305287044770475; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 70 
last prior star auc 0.6647525095734119 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5839144617615077; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6303369210646579; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 70 
last prior star auc 0.6644991096332951 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5835078872307231; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6302669524244765; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 70 
last prior star auc 0.6642343634272028 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5831262114502733; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6301654663788078; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 70 
last prior star auc 0.6639637865010952 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5846730857115843 at iter 0
0.6305595915344249 at iter 70
0.6650639015396252 at iter 0
last anomaly aucs:
0.5828206502040753
0.6301668846620547
0.663761602344895




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.6158013343811 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5827921269521092,first_prior_anomaly_auc= 0.6301616842901492, first_prior_star_anomaly_auc= 0.6637401705091637


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5827921269521092 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6291379989599255 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6655130245678176 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5827921269521092 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6290959232236002 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6674611154009802 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5827921269521094 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6292664323872859 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6698082165876105 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5827921269521092 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6295923223600233 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6723964259262177 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5827921269521092 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6300104007438108 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6759515892651717 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5827921269521094 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6306780969790567 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6793773736546007 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5827921269521092 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6316620703783664 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6831460674157304 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5827921269521094 at iter 6
max_prior_anomaly= 0.6329668909655357 at iter 79
max_prior_star_anomaly= 0.6865909198354792 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5827921269521092
accuracies_anomaly['prior'][-1]= 0.6329668909655357
accuracies_anomaly['prior_star'][-1]= 0.6865909198354792



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 71.87676644325256 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5827921269521092
 first_prior_anomaly_auc= 0.6331145500102431
 first_prior_star_anomaly_auc= 0.686866697133492


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5824873536410482; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6330592369636132; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6866366200734355 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5821847865483714; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6330326047559764; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6864579163843233 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.581915312731456; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6330649100966009; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6862918196574057 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5816675859243268; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6330504120900767; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6861534582473171 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5827921269521092 at iter 0
0.6331145500102431 at iter 0
0.686866697133492 at iter 0
last anomaly aucs:
0.5814441275194226
0.633081929495564
0.6860343224545755




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.557626247406006 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5814167073766487,first_prior_anomaly_auc= 0.63308523882314, first_prior_star_anomaly_auc= 0.6860201396221063


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5814167073766487 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6346381013914935 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6901035346770255 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5814167073766487 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6373588414201743 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6940595994137763 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5814167073766487 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6399131695478828 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6982088658461636 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5814167073766487 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.643327765258364 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7018139842728146 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5814167073766487 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6477586397087792 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7058861906487859 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5814167073766487 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6518754432135145 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7095771940053894 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5814167073766487 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6568614967615866 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7127056116740471 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5814167073766487 at iter 0
max_prior_anomaly= 0.6608240225664623 at iter 79
max_prior_star_anomaly= 0.7155705438328317 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5814167073766487
accuracies_anomaly['prior'][-1]= 0.6608240225664623
accuracies_anomaly['prior_star'][-1]= 0.7155705438328317



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 71.87340140342712 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5814167073766487
 first_prior_anomaly_auc= 0.6611941944939094
 first_prior_star_anomaly_auc= 0.7159080952455994


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5812370581653719; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6613391745591503; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7157457806073404 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5810823077044298; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6614460185637517; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 190 
last prior star auc 0.7156310572513671 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5809549773862616; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6615946231306239; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 300 
last prior star auc 0.7155232677246008 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5808339505491907; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6617624533148431; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 400 
last prior star auc 0.7155119214586255 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5814167073766487 at iter 0
0.6619176765368674 at iter 490
0.7159080952455994 at iter 0
last anomaly aucs:
0.580740028680839
0.6619176765368674
0.7154583418692972




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.590959787368774 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5807286824148636,first_prior_anomaly_auc= 0.6619346959358307, first_prior_star_anomaly_auc= 0.7154504625179257


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5807286824148636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6684263359440252 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7186274169910334 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5807286824148636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.678631987014829 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7214769056211292 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5807286824148636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6870419339080007 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7239711930913847 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5807286824148636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6942083615676757 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7261247774083238 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5807286824148636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7011295838126606 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.728127708527034 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5807286824148636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7076095623808247 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7296681217202199 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5807286824148636 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7130373323667994 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7313779409678995 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5807286824148636 at iter 0
max_prior_anomaly= 0.717260034353972 at iter 79
max_prior_star_anomaly= 0.7327434325606315 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5807286824148636
accuracies_anomaly['prior'][-1]= 0.717260034353972
accuracies_anomaly['prior_star'][-1]= 0.7327434325606315



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.31714916229248 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5807286824148636
 first_prior_anomaly_auc= 0.7176565233150007
 first_prior_star_anomaly_auc= 0.7327156972438029


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5806539861638591; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.718908237073924; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7325713475266715 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5806111224923964; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7199651732669367; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.7325231258962762 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5805953637896528; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7209319696802559; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.7324934995351183 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5805630584490284; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7217908189797816; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.732482153269143 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5807286824148636 at iter 0
0.7224797894637314 at iter 490
0.7327156972438029 at iter 0
last anomaly aucs:
0.5805525001181903
0.7224797894637314
0.7325130403265203




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.62302589416504 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5805537608144098,first_prior_anomaly_auc= 0.7225462911893092, first_prior_star_anomaly_auc= 0.732520131742755


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5805537608144098 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7384904738641915 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.735456765999023 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5805537608144098 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.741492349149818 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7373641993791071 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5805537608144098 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7439031154955325 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.739033676347763 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5805537608144098 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7462541563578486 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7408516002962636 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5805537608144098 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7482471594938305 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7427602943725673 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5805537608144098 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7500390815828042 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7453819121609909 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5805537608144098 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7519315441952819 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7469833115337945 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5805537608144098 at iter 0
max_prior_anomaly= 0.7532912050679987 at iter 79
max_prior_star_anomaly= 0.7485787225995555 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5805537608144098
accuracies_anomaly['prior'][-1]= 0.7532912050679987
accuracies_anomaly['prior_star'][-1]= 0.7485787225995555



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 71.64203381538391 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5805537608144098
 first_prior_anomaly_auc= 0.7534524165970656
 first_prior_star_anomaly_auc= 0.7487136170950408


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5806751028255355; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7548795247175253; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7486969128701324 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5807898261815088; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7559200718596845; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.7487107805285469 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.580924405502939; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7568309248782641; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.7488759317332997 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5810689128070977; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7576193327765257; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.748962447011362 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5811954551901288 at iter 490
0.7583100367177773 at iter 490
0.74904738641915 at iter 490
last anomaly aucs:
0.5811954551901288
0.7583100367177773
0.74904738641915




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.57352423667908 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5812140504593661,first_prior_anomaly_auc= 0.7583685015049562, first_prior_star_anomaly_auc= 0.7490540050743022


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5812140504593661 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7664067006004066 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7516223584474526 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5812140504593661 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7663368895472524 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7533069637707425 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5812140504593661 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7660500811573192 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.754896071355406 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5812140504593661 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7658351324518966 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7567530768867107 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5812140504593661 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.765644767322754 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7578908552247978 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5812140504593661 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7655954425831665 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7588786107127661 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5812140504593661 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7653557527144365 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7599892840821344 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5812140504593661 at iter 0
max_prior_anomaly= 0.7677047449453961 at iter 5
max_prior_star_anomaly= 0.7608255984367367 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5812140504593661
accuracies_anomaly['prior'][-1]= 0.7651691696739524
accuracies_anomaly['prior_star'][-1]= 0.7608255984367367



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.15016222000122 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5812140504593661
 first_prior_anomaly_auc= 0.7651244149581606
 first_prior_star_anomaly_auc= 0.7609083316261406


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5813420111256441; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7654348614022093; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 90 
last prior star auc 0.7612597506973227 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5814682383346204; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7655089273051043; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 200 
last prior star auc 0.7615333217769513 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.581588162062499; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7654742581590683; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 200 
last prior star auc 0.7618280095182565 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.581701309548198; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7654603905006541; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 200 
last prior star auc 0.7621239579557811 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5817876672392328 at iter 490
0.7655089273051043 at iter 200
0.7623864979434893 at iter 490
last anomaly aucs:
0.5817876672392328
0.7654080716075453
0.7623864979434893




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.5251567363739 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5818012197235923,first_prior_anomaly_auc= 0.7653844335534299, first_prior_star_anomaly_auc= 0.7624129725640985


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5818012197235923 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7696314039428274 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7633597554249334 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5818012197235923 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7690164993617725 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7642204957687883 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5818012197235923 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7684639992435823 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7647165797311566 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5818012197235923 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7678443670517043 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7651300880911482 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5818012197235923 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7673519075909672 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7654424255795264 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5818012197235923 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7668893896654427 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7657024441747955 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5818012197235923 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7664535039475552 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7657806073404037 iter_best_prior_star_anomaly= 650
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5818012197235923 at iter 0
max_prior_anomaly= 0.7712331184896859 at iter 5
max_prior_star_anomaly= 0.7659167625321084 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5818012197235923
accuracies_anomaly['prior'][-1]= 0.7661536158343445
accuracies_anomaly['prior_star'][-1]= 0.7659167625321084



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 71.66356778144836 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5818012197235923
 first_prior_anomaly_auc= 0.7661184739272264
 first_prior_star_anomaly_auc= 0.7659047859180234


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5814091431993318; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7643254487290606; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7667406275115434 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5811878910128118; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7630488362198025; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7673593141812567 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5810854594449785; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7622021211213892; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7679004680334715 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5810377105756654; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7613861354933262; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7683681863309012 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5818012197235923 at iter 0
0.7661184739272264 at iter 0
0.7687621538994911 at iter 490
last anomaly aucs:
0.5810344012480892
0.7607674488236129
0.7687621538994911




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.55450248718262 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5810391288589123,first_prior_anomaly_auc= 0.7607121357769828, first_prior_star_anomaly_auc= 0.7687980837417463


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5810391288589123 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.762388231400791 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7682515719305987 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5810391288589123 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7627549364136343 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7683905636887971 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5810391288589123 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7627043509778275 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7684321666640402 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5810391288589123 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7625929369494303 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.768651527806231 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5810391288589123 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7624517389728478 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7685084387853192 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5810391288589123 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7622623193658699 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7682752099847141 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5810391288589124 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.762007501142506 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7679735884142017 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5810391288589124 at iter 1
max_prior_anomaly= 0.763252596246277 at iter 5
max_prior_star_anomaly= 0.7687980837417463 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5810391288589123
accuracies_anomaly['prior'][-1]= 0.7618667759270057
accuracies_anomaly['prior_star'][-1]= 0.7677507603574074



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.06937456130981 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5810391288589123
 first_prior_anomaly_auc= 0.7618440833950549
 first_prior_star_anomaly_auc= 0.76771987330003


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5803280961911216; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7592202593882471; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7686427029326947 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5800409726271334; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.757781017066675; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7691564366421355 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5799142726570748; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7567083221709188; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7695447310777377 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5798937863435082; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7556424035173426; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7697990765400193 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5810391288589123 at iter 0
0.7618440833950549 at iter 0
0.7700482216303954 at iter 490
last anomaly aucs:
0.5798890587326851
0.7549334194809083
0.7700482216303954




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.51364612579346 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5798959925618923,first_prior_anomaly_auc= 0.7548500559433946, first_prior_star_anomaly_auc= 0.7700704414012639


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5798959925618923 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7543788707313615 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7690552657705217 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5798959925618923 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7551116504089384 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7685843957325433 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5798959925618923 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7551485257733584 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7681554438438627 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5798959925618923 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7551110200608286 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7678235655640828 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5798959925618923 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7549881021794287 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.767432119387932 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5798959925618923 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7547469940274516 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7669703893975448 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5798959925618923 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7546057960508691 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7666703436973068 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5798959925618923 at iter 0
max_prior_anomaly= 0.7578029216634885 at iter 5
max_prior_star_anomaly= 0.7707326220905495 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5798959925618923
accuracies_anomaly['prior'][-1]= 0.7545616716831871
accuracies_anomaly['prior_star'][-1]= 0.7663580062089289



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.30928611755371 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5798959925618923
 first_prior_anomaly_auc= 0.7545342515404131
 first_prior_star_anomaly_auc= 0.766325858455332


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5793901382038231; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.752846967237657; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7667428337299272 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5792350725688261; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7517607198575412; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7670031674992515 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5792580802748317; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7508878453125738; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7672559370912586 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5793245820004097; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7501969837842948; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7674976755913453 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5798959925618923 at iter 0
0.7545342515404131 at iter 0
0.7676749609972107 at iter 490
last anomaly aucs:
0.5794364687898892
0.7496310887687726
0.7676749609972107




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.27758002281189 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.579451912318578,first_prior_anomaly_auc= 0.749583497486487, first_prior_star_anomaly_auc= 0.767682682761555


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.579451912318578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7500326205146791 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7686814693414438 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.579451912318578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7493984903162771 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7664752509573413 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.579451912318578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7497587342609957 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.766185606000914 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.579451912318578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7497990765400191 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7659381943678396 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.579451912318578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7498725120948043 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7656113588729376 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.579451912318578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7498948894527002 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7653116283467546 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.579451912318578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.749934916557669 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7649116724711222 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.579451912318578 at iter 0
max_prior_anomaly= 0.7537787793308854 at iter 4
max_prior_star_anomaly= 0.7705592763603699 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.579451912318578
accuracies_anomaly['prior'][-1]= 0.7499582394377294
accuracies_anomaly['prior_star'][-1]= 0.7646901051105472



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.05270457267761 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.579451912318578
 first_prior_anomaly_auc= 0.7499661187891014
 first_prior_star_anomaly_auc= 0.7646982996359739


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5792382243093748; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.748885071780891; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7650235592606017 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5792782514143435; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7480069968640183; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7652238523724727 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5793920292481523; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7472855634524167; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7653655231101376 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5795278692658021; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7467606410640275; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7654893865137021 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5796583513245189 at iter 490
0.7499661187891014 at iter 0
0.7655956001701939 at iter 490
last anomaly aucs:
0.5796583513245189
0.7463717162803158
0.7655956001701939




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.56048226356506 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5796719038088785,first_prior_anomaly_auc= 0.7463327922845392, first_prior_star_anomaly_auc= 0.765603164347511


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5796719038088785 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7473479679152812 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7683748049860535 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5796719038088785 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.746190333611737 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7649819562853586 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5796715886348236 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7465611358872939 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7644625494429298 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5796719038088785 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7467393668153238 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7641319318593695 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5796719038088785 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7467983043635849 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7638076177569062 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5796719038088785 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7469073545865704 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.763525536977796 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5796719038088785 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7470494980853176 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.763269930819295 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5796719038088785 at iter 0
max_prior_anomaly= 0.7500879335613091 at iter 4
max_prior_star_anomaly= 0.7705753502371685 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.579671746221851
accuracies_anomaly['prior'][-1]= 0.7471604393526325
accuracies_anomaly['prior_star'][-1]= 0.7630423751516775



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.11840295791626 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5796719038088785
 first_prior_anomaly_auc= 0.7471711552704982
 first_prior_star_anomaly_auc= 0.7630174764013427


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5795656901523867; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7462978079644482; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7633745686055124 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5797053122586948; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7457137904407708; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7635526419465148 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5798534440644846; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7452612004979751; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7636758750019699 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5800056731329877; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7449488630095971; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7637962714909309 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5801273303181682 at iter 490
0.7471711552704982 at iter 0
0.7638905085333375 at iter 490
last anomaly aucs:
0.5801273303181682
0.7447260349528027
0.7638905085333375




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.55619478225708 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5801380462360339,first_prior_anomaly_auc= 0.7447146886868272, first_prior_star_anomaly_auc= 0.7639005941030934


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5801380462360338 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7457275005121577 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7678251414343572 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5801380462360338 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7446336889547251 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7639652047843422 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5801380462360338 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7449353105252375 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.763363222339537 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5801380462360338 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7450966796413319 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7630549821138723 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5801380462360338 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7452331500070914 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7628003214775358 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5801380462360338 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7453875852939785 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7625908883180736 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5801380462360339 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7455123942197078 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7623335487022708 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5801380462360339 at iter 0
max_prior_anomaly= 0.7485954268244638 at iter 3
max_prior_star_anomaly= 0.7705895330696377 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5801380462360338
accuracies_anomaly['prior'][-1]= 0.7457103235261673
accuracies_anomaly['prior_star'][-1]= 0.762168397497518



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.06166553497314 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.48974849110421237
accuracies_anomaly["prior"][-1]= 0.7162762185416897
accuracies_anomaly["prior_star"][-1]= 0.49340892257749347


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 1944.7476499080658 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0033457279205322266 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46746095781395275
 first_prior_anomaly_auc= 0.7182192665899744
 first_prior_star_anomaly_auc= 0.4709935862079834


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4819512425737113; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7340908016452086; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.49009927982728463 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.49080432418803277; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7412572293048836; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5084061648045133 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5045069889846668; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7440666908300109; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5397015301700364 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5271825015364735; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7466802716800354; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.5799193154419529 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5494017996438534 at iter 490
0.7491548607718613 at iter 490
0.6103402303922342 at iter 490
last anomaly aucs:
0.5494017996438534
0.7491548607718613
0.6103402303922342




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.55669832229614 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5513749468143783,first_prior_anomaly_auc= 0.7493940778795091, first_prior_star_anomaly_auc= 0.6128365664938462


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5513749468143783 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7501036922640528 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.612867926312306 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5513749468143783 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7505077454023985 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6128956616291348 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5513749468143783 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7507896685944814 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6129289124919237 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5513749468143783 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7509340183116126 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6129520777849568 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5513749468143783 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7509691602187308 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6129902138455963 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5513749468143783 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7507932930961125 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6130226767732481 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5513749468143783 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7502297618860015 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6130636494003814 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5513749468143783 at iter 0
max_prior_anomaly= 0.7509855492695842 at iter 48
max_prior_star_anomaly= 0.6130987913074996 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5513749468143783
accuracies_anomaly['prior'][-1]= 0.7494487605780292
accuracies_anomaly['prior_star'][-1]= 0.6130987913074996



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.0035150051117 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5513749468143783
 first_prior_anomaly_auc= 0.7493772160675731
 first_prior_star_anomaly_auc= 0.6131061978977891


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5676199631246356; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7505033329656302; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6331288904297399 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5762134989047702; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7507006319239801; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 200 
last prior star auc 0.6437658571946356 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5805074302283436; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.750314543706762; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 200 
last prior star auc 0.6493508990339916 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.582662275241502; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7495376396615031; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 200 
last prior star auc 0.65235387742881 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5838889326630632 at iter 490
0.7507006319239801 at iter 200
0.6540917471673732 at iter 490
last anomaly aucs:
0.5838889326630632
0.7490237483650346
0.6540917471673732




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.529181480407715 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5840090139779693,first_prior_anomaly_auc= 0.7489578769875664, first_prior_star_anomaly_auc= 0.6542252233796113


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5840090139779693 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7501864254534567 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.654207731219566 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5840090139779693 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7507915596388104 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6541875600800542 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5840090139779693 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7505372141765291 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6541639220259388 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5840090139779693 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7493701246513388 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6541424901902076 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5840090139779693 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7476393463290103 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6541464298658934 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5840090139779693 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7453653655231102 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6541402839718234 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5840090139779693 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7425516491482422 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6541654978962131 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5840090139779693 at iter 0
max_prior_anomaly= 0.750827804655121 at iter 23
max_prior_star_anomaly= 0.6542252233796113 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5840090139779693
accuracies_anomaly['prior'][-1]= 0.7393518445561561
accuracies_anomaly['prior_star'][-1]= 0.654207731219566



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.0261971950531 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5840090139779693
 first_prior_anomaly_auc= 0.7390087775974281
 first_prior_star_anomaly_auc= 0.6542115133082245


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5848227933876483; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.73894905211403; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.6554772523125896 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5852630915423043; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.73910884535985; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 200 
last prior star auc 0.6562160202972092 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.585516806656476; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.739509431583592; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 300 
last prior star auc 0.656642923554533 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5855152307862017; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.7404396678065462; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 400 
last prior star auc 0.6568534598231874 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5856003277810171 at iter 490
0.7414595710481112 at iter 490
0.6570862158627102 at iter 490
last anomaly aucs:
0.5856003277810171
0.7414595710481112
0.6570862158627102




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.59718084335327 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5856173471799802,first_prior_anomaly_auc= 0.7415583781143136, first_prior_star_anomaly_auc= 0.6571123753092645


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5856173471799802 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7380809051798857 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6571467292812456 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5856175047670076 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7333558157492475 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6572526277636825 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5856173471799802 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.727434325606316 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6574026506138015 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5856175047670076 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7216447358053484 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6575325023244086 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5856173471799802 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7166777502875964 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.657698599051326 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5856175047670076 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7117178561860787 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6578826606993712 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5856175047670076 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7084833824479568 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6581237688513482 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.585617662354035 at iter 75
max_prior_anomaly= 0.7415583781143136 at iter 0
max_prior_star_anomaly= 0.6583803205320138 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5856175047670076
accuracies_anomaly['prior'][-1]= 0.7062349307405014
accuracies_anomaly['prior_star'][-1]= 0.6583803205320138



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 71.84160017967224 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5856173471799802
 first_prior_anomaly_auc= 0.7059558441149124
 first_prior_star_anomaly_auc= 0.6584203476369825


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5856721874655278; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7068550356934618; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6585820319271318 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5856517011519612; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.7076439163528058; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6586523157413682 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5855804718155602; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.7085478355421782; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6586601950927399 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5855048300423908; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.7091703043005498; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6586538916116426 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5856734481617473 at iter 150
0.7095641142821123 at iter 490
0.6586743779252092 at iter 340
last anomaly aucs:
0.5853626865436437
0.7095641142821123
0.6585552421324676




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.52073812484741 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5853409395338576,first_prior_anomaly_auc= 0.7095916920119134, first_prior_star_anomaly_auc= 0.6585473627810958


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5853409395338576 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7067853822273349 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6589318751280395 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5853409395338576 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7045013158516791 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6593904533778779 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5853409395338576 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.702210315646816 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6599525663047419 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5853409395338576 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7002089603983801 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.660658713774682 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5853409395338576 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.696303796271491 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6614885670611595 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5853409395338576 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6926071197818996 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6625106765211087 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5853409395338576 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.690034353971981 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6637515167751391 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5853409395338576 at iter 0
max_prior_anomaly= 0.7095916920119134 at iter 0
max_prior_star_anomaly= 0.665085490962384 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5853409395338576
accuracies_anomaly['prior'][-1]= 0.6877662038860961
accuracies_anomaly['prior_star'][-1]= 0.665085490962384



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.46272563934326 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5853409395338576
 first_prior_anomaly_auc= 0.6875574010747435
 first_prior_star_anomaly_auc= 0.665224325133555


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5851880801172447; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6881029673637267; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6651404888349591 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5849762831523709; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6886672865089746; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6650297051546716 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5847173676662937; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6891953606379122; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6648823612840191 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5844508880028996; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6897073608900515; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6647049182911263 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5853409395338576 at iter 0
0.6902226704697669 at iter 490
0.665224325133555 at iter 0
last anomaly aucs:
0.5842331027309833
0.6902226704697669
0.6645697086215863




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.5981924533844 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5842053674141545,first_prior_anomaly_auc= 0.6902715224482721, first_prior_star_anomaly_auc= 0.6645564713112817


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5842053674141545 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6880326835494903 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6662984383125581 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5842053674141545 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6864386907669761 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6682540933230376 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5842053674141545 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6854348614022094 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.670453377877933 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5842053674141545 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6852408717714358 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6730598673117228 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5842053674141545 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6859156594229163 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6760418866318925 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5842053674141545 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6864333328080433 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6795644294561671 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5842053674141545 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6870813306648597 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6831816820839309 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5842053674141545 at iter 0
max_prior_anomaly= 0.6902715224482721 at iter 0
max_prior_star_anomaly= 0.6868209968955356 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5842053674141545
accuracies_anomaly['prior'][-1]= 0.6880153489764723
accuracies_anomaly['prior_star'][-1]= 0.6868209968955356



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 71.97823548316956 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5842053674141545
 first_prior_anomaly_auc= 0.6881089556707691
 first_prior_star_anomaly_auc= 0.6871368012985171


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.583983957640607; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.688650424697039; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6869951305608522 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5837363884205051; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6892924342468127; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.686886553098949 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5835069417085585; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6898679420710087; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6867718297429756 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5832459775911247; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6903870337393825; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6866426083804781 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5842053674141545 at iter 0
0.6908649951935957 at iter 490
0.6871368012985171 at iter 0
last anomaly aucs:
0.5830518303733236
0.6908649951935957
0.6865685424775831




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.59949970245361 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5830326047559765,first_prior_anomaly_auc= 0.6908930456844793, first_prior_star_anomaly_auc= 0.6865698031738028


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5830326047559765 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6921720219991491 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6907121357769829 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5830326047559765 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6952410293584632 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.694647714200167 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5830326047559765 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.698129126810281 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6987670390973415 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5830326047559765 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7003867185653276 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.70244606583986 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5830326047559765 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7018661455788959 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.706389523614416 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5830326047559764 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7037682210000473 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7099541421750162 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5830326047559764 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.707471516144791 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.713666892541406 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5830326047559765 at iter 0
max_prior_anomaly= 0.7100299415352129 at iter 79
max_prior_star_anomaly= 0.7162711757568117 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5830326047559765
accuracies_anomaly['prior'][-1]= 0.7100299415352129
accuracies_anomaly['prior_star'][-1]= 0.7162711757568117



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 71.92290186882019 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5830326047559765
 first_prior_anomaly_auc= 0.710215421466505
 first_prior_star_anomaly_auc= 0.7166197582614999


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5828639866366201; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7108727169579401; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7165289881336968 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5827398080590005; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7114792694265408; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.7164557101659392 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5826358006208929; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7120747908032211; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.7164813968514112 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5825595284996139; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7126766156609988; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.7164328600469609 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5830326047559765 at iter 0
0.7132368375435334 at iter 490
0.7166197582614999 at iter 0
last anomaly aucs:
0.5824697038939755
0.7132368375435334
0.7164243503474794




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.556554317474365 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5824700190680303,first_prior_anomaly_auc= 0.7132978237231511, first_prior_star_anomaly_auc= 0.7164256110436988


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5824700190680303 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7164268717399184 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.719609184171959 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5824700190680303 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7236661046062688 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7223760971996784 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5824700190680303 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7336917912917409 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7236761901760247 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5824700190680303 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7434576169689711 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.725831665537293 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5824700190680303 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7513245189655987 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7277797563704556 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5824700190680303 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7566879934443796 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7296232094174007 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5824700190680303 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7609141623461557 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7313393321461777 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5824700190680303 at iter 0
max_prior_anomaly= 0.7642773846856927 at iter 79
max_prior_star_anomaly= 0.732967363726618 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5824700190680303
accuracies_anomaly['prior'][-1]= 0.7642773846856927
accuracies_anomaly['prior_star'][-1]= 0.732967363726618



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 71.85036039352417 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5824700190680303
 first_prior_anomaly_auc= 0.7645695510345588
 first_prior_star_anomaly_auc= 0.7331396063476054


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5824072994311108; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7659706572954914; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7331005247648014 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5823527743196181; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7673418220212113; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.7330961123280331 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5823168444773626; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7686581464613833; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.73311596829349 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5822771325464486; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7698799186850938; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.7331443339584285 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5824700190680303 at iter 0
0.7709119561277716 at iter 490
0.7331610381833369 at iter 480
last anomaly aucs:
0.5822493972296201
0.7709119561277716
0.7331585167908977




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.52410960197449 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5822490820555652,first_prior_anomaly_auc= 0.7709973682966419, first_prior_star_anomaly_auc= 0.7331563105725136


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5822490820555652 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7773088863324771 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7351831949193942 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5822492396425927 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.780096916021873 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7368845044675922 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5822493972296201 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7826127929148873 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7386693351403313 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5822490820555652 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7844576642450793 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7403807302582851 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5822492396425927 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7860592212049105 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.742198023858676 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5822492396425927 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7874510298312243 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7439475550372694 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5822492396425927 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7885089115464015 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7461793025198167 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5822493972296201 at iter 4
max_prior_anomaly= 0.7893173329971477 at iter 79
max_prior_star_anomaly= 0.7477252312589628 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5822492396425927
accuracies_anomaly['prior'][-1]= 0.7893173329971477
accuracies_anomaly['prior_star'][-1]= 0.7477252312589628



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 71.88919043540955 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5822492396425927
 first_prior_anomaly_auc= 0.7893973872070852
 first_prior_star_anomaly_auc= 0.7478645381912161


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5822336385268765; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7904108293805254; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7479698063255433 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5822260743495595; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7912509258237862; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.7480630978457854 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5822311171344375; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7919380052634066; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.7482145389791512 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5822367902674251; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7925943552326772; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.7482988480388295 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.582249712403675 at iter 20
0.793075468427439 at iter 490
0.7483997037363885 at iter 490
last anomaly aucs:
0.5822451423798793
0.793075468427439
0.7483997037363885




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.5338249206543 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5822427785744677,first_prior_anomaly_auc= 0.7931183320989016, first_prior_star_anomaly_auc= 0.7484094741320895


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5822427785744677 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7951345005279165 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7503682808831177 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5822427785744677 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.7952348834643932 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7519554974234521 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5822427785744677 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.7951357612241361 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7534125470791244 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5822427785744677 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.79474463022204 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7549297949792774 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5822427785744677 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.7941390232756038 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7561945884614779 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5822427785744677 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.793452574184093 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7574707282096538 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5822427785744677 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.7925587405644767 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7585694249649368 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5822427785744678 at iter 13
max_prior_anomaly= 0.795257575996344 at iter 18
max_prior_star_anomaly= 0.7595143167814425 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5822427785744678
accuracies_anomaly['prior'][-1]= 0.7916225160344801
accuracies_anomaly['prior_star'][-1]= 0.7595143167814425



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 71.62910413742065 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5822427785744677
 first_prior_anomaly_auc= 0.7915337945380335
 first_prior_star_anomaly_auc= 0.7595792426367461


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5822166191279133; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7920030887057379; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7601074743527113 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5821923507256883; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7923343366374078; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.7604894653072158 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5821674519753534; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.792588524512662; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 290 
last prior star auc 0.7608169311502277 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5821386135493326; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7927528877822778; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 400 
last prior star auc 0.76108167735632 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5822427785744677 at iter 0
0.7929170934648659 at iter 490
0.7613322407299431 at iter 490
last anomaly aucs:
0.5821343586995918
0.7929170934648659
0.7613322407299431




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.54556655883789 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5821362497439211,first_prior_anomaly_auc= 0.7929435680854752, first_prior_star_anomaly_auc= 0.7613530422175646


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5821362497439211 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7927888176245332 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.762114502734135 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5821362497439211 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7916746773405613 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7629326945805821 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5821362497439211 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7904804828466521 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7637036103187985 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5821362497439211 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7892016641190098 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7644959578927464 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5821362497439211 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7878828182863986 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7649671431047796 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5821362497439211 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7865937564019729 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7654898592747845 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5821362497439211 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7853908946215548 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.766168586601951 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5821362497439211 at iter 0
max_prior_anomaly= 0.7931963376774824 at iter 1
max_prior_star_anomaly= 0.7668121720219991 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5821362497439211
accuracies_anomaly['prior'][-1]= 0.7843372677561182
accuracies_anomaly['prior_star'][-1]= 0.7668121720219991



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 71.98322916030884 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5821362497439211
 first_prior_anomaly_auc= 0.7842302661644893
 first_prior_star_anomaly_auc= 0.7668074444111761


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5818629938383473; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7837502560789196; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7680580550609074 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5816915391524969; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7828416092787241; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.768725593709126 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5815730337078652; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7820399640701579; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.769211907275793 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5815235513812502; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7811273775942764; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7696046141481634 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5821362497439211 at iter 0
0.7842302661644893 at iter 0
0.7698879556234931 at iter 490
last anomaly aucs:
0.5814769056211293
0.7803495280268528
0.7698879556234931




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.564509868621826 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5814822635800622,first_prior_anomaly_auc= 0.7802568668547205, first_prior_star_anomaly_auc= 0.7699166364624864


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.581482263580062 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7807066202310224 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7697927730589218 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5814822635800622 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7799416927998487 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.769861165828829 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.581482263580062 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7790338339347904 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7698772397056275 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5814822635800622 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7782148541532061 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7696622910002049 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.581482263580062 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7774215610570938 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7694938304678759 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5814822635800622 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7766834234205839 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7694583733867029 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5814822635800622 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7760500811573191 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.769435680854752 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5814822635800622 at iter 0
max_prior_anomaly= 0.7810123390642482 at iter 5
max_prior_star_anomaly= 0.7699929085837653 at iter 24
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5814822635800622
accuracies_anomaly['prior'][-1]= 0.7754917503191137
accuracies_anomaly['prior_star'][-1]= 0.7693042532738704



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 72.50258660316467 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5814822635800622
 first_prior_anomaly_auc= 0.7754488866476511
 first_prior_star_anomaly_auc= 0.769265802039176


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5808500244259893; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7734075042942465; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7704150842302662 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5806665931260538; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7708099973210205; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7707512173597869 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5806092314480672; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.768646485021353; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7709683722835937 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5806202625399877; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7669763777045874; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7711228075704808 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5814822635800622 at iter 0
0.7754488866476511 at iter 0
0.7712498227145942 at iter 490
last anomaly aucs:
0.5806502040752005
0.765747829238697
0.7712498227145942




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.55020713806152 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.58065146477142,first_prior_anomaly_auc= 0.7656509132168241, first_prior_star_anomaly_auc= 0.7712614841546244


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.58065146477142 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7674942086767418 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7704182359708149 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.58065146477142 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7676402918511748 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7705833871755677 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.58065146477142 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7676476984414643 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7705974124210095 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.58065146477142 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7675284050616953 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7701876861496761 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.58065146477142 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7674704130355989 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7701750791874813 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.58065146477142 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7674258159068346 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7703862458042454 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.58065146477142 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7673553745055707 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7699859747545582 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.58065146477142 at iter 0
max_prior_anomaly= 0.767669287864223 at iter 29
max_prior_star_anomaly= 0.7717055643979387 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.58065146477142
accuracies_anomaly['prior'][-1]= 0.767298012827584
accuracies_anomaly['prior_star'][-1]= 0.7696558299320799



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.50946927070618 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.58065146477142
 first_prior_anomaly_auc= 0.7672918669335139
 first_prior_star_anomaly_auc= 0.7696279370282237


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5800728052066754; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7635094631009975; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7696903414910885 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5801616842901492; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7605320138046237; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7695236144160613 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5803104464440487; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7584777093149692; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7694659375640198 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5804264304962415; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7569604614148162; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7694240194147217 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.58065146477142 at iter 0
0.7672918669335139 at iter 0
0.7698885859716028 at iter 20
last anomaly aucs:
0.580494192918039
0.7558989551980081
0.769364136344296




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.56914138793945 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.580501441921301,first_prior_anomaly_auc= 0.7558091305923696, first_prior_star_anomaly_auc= 0.7693553114707596


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.580501441921301 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7572601919409994 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7682681185684794 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.580501441921301 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7577238129757159 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.767810643427833 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.580501441921301 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7580040027104968 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7674034385489387 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.580501441921301 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7581827063996092 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7670580077847992 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.580501441921301 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7582488929511323 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7667072190617268 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.580501441921301 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7583027877145153 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7663630489938067 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.580501441921301 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7583459665600327 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7660585908568006 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5805017570953559 at iter 8
max_prior_anomaly= 0.7583645618292703 at iter 79
max_prior_star_anomaly= 0.7724241612430465 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.580501441921301
accuracies_anomaly['prior'][-1]= 0.7583645618292703
accuracies_anomaly['prior_star'][-1]= 0.7657862804733915



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.85419416427612 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.580501441921301
 first_prior_anomaly_auc= 0.7583617252627765
 first_prior_star_anomaly_auc= 0.7657691034874009


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5800312022314323; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7532568510960178; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7657070141985911 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5801273303181682; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7516100666593126; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7658499456324754 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5802067541799959; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7505567549679311; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7659041555699135 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5802735710796287; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7497729170934649; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7659284239721386 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.580501441921301 at iter 0
0.7583617252627765 at iter 0
0.766111855272074 at iter 490
last anomaly aucs:
0.5803274658430119
0.7496484233417905
0.766111855272074




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.57907748222351 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5803192713175851,first_prior_anomaly_auc= 0.7494073151898135, first_prior_star_anomaly_auc= 0.7660163575334478


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5803192713175851 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7493947082276187 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7656728178136374 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5803192713175851 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7497177616338624 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.765312573868919 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5803192713175851 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7496509447342294 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7650068550356935 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5803192713175851 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7496083962368217 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7647556613139606 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5803192713175851 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7495735695037584 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7645492223080196 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5803192713175851 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7494851631813669 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7643481412610114 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5803192713175851 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7494385174212459 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7641353987739729 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5803192713175851 at iter 0
max_prior_anomaly= 0.7519101123595506 at iter 3
max_prior_star_anomaly= 0.7720998471405833 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5803192713175851
accuracies_anomaly['prior'][-1]= 0.7493578328631987
accuracies_anomaly['prior_star'][-1]= 0.763960792347574



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.80895471572876 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5803192713175851
 first_prior_anomaly_auc= 0.7493534204264305
 first_prior_star_anomaly_auc= 0.7639437729486109


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5792763603700143; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7419200403422791; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7685314464913249 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.579361142190775; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7410615062168081; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7685519328048914 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5794604220180595; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.740857903777361; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7687293757977844 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5795259782214728; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7405086909245632; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7687977685676916 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5803192713175851 at iter 0
0.7493534204264305 at iter 0
0.7697035788013931 at iter 30
last anomaly aucs:
0.5795552894085759
0.7402478843941568
0.7687798036465638




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.552799701690674 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.57954520383882,first_prior_anomaly_auc= 0.7406043462502166, first_prior_star_anomaly_auc= 0.7692301873709757


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.57954520383882 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7436848574625337 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7697250106371244 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.57954520383882 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7423357549206548 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7689528342026885 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.57954520383882 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7424878264021306 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7687911499125393 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.57954520383882 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7427227886600374 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7686037789369179 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.57954520383882 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7429213483146068 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7684485557148937 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.57954520383882 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7431252659281088 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7683228012669997 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.57954520383882 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7432510203760027 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7681541831476433 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.57954520383882 at iter 0
max_prior_anomaly= 0.7505050664229321 at iter 3
max_prior_star_anomaly= 0.7737894952487512 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.57954520383882
accuracies_anomaly['prior'][-1]= 0.7433925335266401
accuracies_anomaly['prior_star'][-1]= 0.7680200765872953



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 73.43755531311035 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4674609578139528
accuracies_anomaly["prior"][-1]= 0.7182192665899744
accuracies_anomaly["prior_star"][-1]= 0.4709935862079834


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 1951.319670677185 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003159046173095703 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5081321209638022
 first_prior_anomaly_auc= 0.7232423530894936
 first_prior_star_anomaly_auc= 0.5117006792000882


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5260576453346361; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.735409805064847; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5342513828261657 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5303243141024631; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7410310919205132; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5477573790125596 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5388127393352979; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.744596025655168; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.572516192067069 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5522705138912964; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7466531667113163; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6036834391792867 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.563252911420332 at iter 490
0.7485175788329104 at iter 490
0.6246459807428653 at iter 490
last anomaly aucs:
0.563252911420332
0.7485175788329104
0.6246459807428653




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.60991597175598 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5642892037127503,first_prior_anomaly_auc= 0.7486693351403313, first_prior_star_anomaly_auc= 0.626307420773122


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5642892037127503 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7362368217848305 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7473110925508611 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5642892037127504 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7362094016420568 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7401440345430764 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5642892037127504 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7374032809619112 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7356332634697511 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5642892037127503 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7361700048851979 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7289052429204028 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5642892037127503 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7357836014939251 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.725010637124352 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5642892037127504 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7346656791212948 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7207724916084908 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5642892037127504 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7280514364057551 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7154347038151818 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5642892037127504 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.727840269788991 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.717797248530501 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5642892037127504 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7232109932710339 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7090637754700033 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5642892037127503 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7241700679200088 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7157930567155713 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5642892037127503 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7122716170004885 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7077662038860961 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5642892037127503 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7132247033424208 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7090732306916494 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5642892037127504 at iter 1
max_prior_anomaly= 0.7486693351403313 at iter 0
max_prior_star_anomaly= 0.7483379296216335 at iter 11
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5642892037127503
accuracies_anomaly['prior'][-1]= 0.712036812329609
accuracies_anomaly['prior_star'][-1]= 0.7059101438769559



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.89540386199951 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5642892037127504
 first_prior_anomaly_auc= 0.7074879051956442
 first_prior_star_anomaly_auc= 0.7017413366531667


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5767089525190287; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.708395606473675; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 40 
last prior star auc 0.7104959263753408 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5843071686338781; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7074217186441212; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 40 
last prior star auc 0.7142518555872481 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5882471594938306; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7077658887120413; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 40 
last prior star auc 0.7169434420158532 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5899884961469972; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.70840821343587; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 40 
last prior star auc 0.7191647887545898 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.590668799344438 at iter 490
0.7085468900200136 at iter 40
0.71996312463558 at iter 470
last anomaly aucs:
0.590668799344438
0.7063297981310178
0.7193313582425894




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.49703621864319 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.59070677781805,first_prior_anomaly_auc= 0.7062593567297539, first_prior_star_anomaly_auc= 0.7193516869691287


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.59070677781805 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7278298690451803 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7265259939801756 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.59070677781805 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7270901555383961 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7253762390280032 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.59070677781805 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7190721275824574 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7195792426367461 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.59070677781805 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7152786926580204 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7181013914934522 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.59070677781805 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.719561120128591 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.718618592117497 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.59070677781805 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7144833509305514 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7155733803993255 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.59070677781805 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7180341018327372 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7177628945585199 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.59070677781805 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7137671178908553 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7129164631167562 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.59070677781805 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7447102762500591 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7335411380935122 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.59070677781805 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7389570890524292 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7269976519532912 iter_best_prior_star_anomaly= 920
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.59070677781805 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7360823864979434 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7227539908914697 iter_best_prior_star_anomaly= 920
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.59070677781805 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7299267220322424 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7179195360637913 iter_best_prior_star_anomaly= 920
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.59070677781805 at iter 0
max_prior_anomaly= 0.7482950659501709 at iter 89
max_prior_star_anomaly= 0.7371341223190506 at iter 92
last values
accuracies_anomaly['vanilla_star'][-1]= 0.59070677781805
accuracies_anomaly['prior'][-1]= 0.7102959484375246
accuracies_anomaly['prior_star'][-1]= 0.7082225759175504



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.91938400268555 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.59070677781805
 first_prior_anomaly_auc= 0.7118042138771136
 first_prior_star_anomaly_auc= 0.7090136627952786


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5918732369951305; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7148273634114439; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.7101856375183194 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5920478434215295; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.716172211103582; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 200 
last prior star auc 0.711350678412153 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5915851679089777; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.7150408938336195; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 210 
last prior star auc 0.7111823754668516 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5909623839765511; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.7168791465086594; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 400 
last prior star auc 0.7125215500260018 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5920740028680839 at iter 150
0.7169929243424682 at iter 470
0.7136605890603086 at iter 470
last anomaly aucs:
0.5904975022456151
0.7144702712072741
0.7114159194415116




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 58.68231916427612 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5904543234000976,first_prior_anomaly_auc= 0.7169275257260822, first_prior_star_anomaly_auc= 0.7131016278739934


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5904543234000977 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7327131758513639 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7307962872496336 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5904543234000977 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7459446554359643 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7338036780812204 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5904543234000977 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7525206045038373 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7294134610838836 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5904543234000977 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7515917865641301 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7261471547662197 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5904543234000976 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7455141276770095 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7224703342420853 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5904541658130702 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7413944876057803 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7220539893155995 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5904541658130702 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.736794049513844 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7144286682320312 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5904543234000976 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7336946278582347 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.71239075279323 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5904541658130703 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.74118001166144 iter_best_prior_anomaly= 850
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7153940463621036 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5904543234000977 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7415798099500448 iter_best_prior_anomaly= 950
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.714817277841688 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5904543234000977 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7352411869454906 iter_best_prior_anomaly= 950
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7111997100398695 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5904543234000977 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7312895346455079 iter_best_prior_anomaly= 950
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7096512599082843 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5904543234000977 at iter 1
max_prior_anomaly= 0.7587700332508629 at iter 95
max_prior_star_anomaly= 0.735115117323542 at iter 21
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5904543234000976
accuracies_anomaly['prior'][-1]= 0.7551570354728399
accuracies_anomaly['prior_star'][-1]= 0.7268191058512063



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.64182376861572 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5904541658130702
 first_prior_anomaly_auc= 0.7318253305387901
 first_prior_star_anomaly_auc= 0.709054635422412


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5900080369383992; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.728897363569031; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.7076527412263423 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.589396599271948; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7259292119072758; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.709366657736735 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5891343744582946; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7232292733662165; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.7096887656208142 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5891465086594072; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7223141654978962; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.711178908552248 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5907269489575618 at iter 20
0.7336609042343635 at iter 10
0.7115454559780638 at iter 430
last anomaly aucs:
0.5891290164993618
0.7209950044912302
0.7110396016199947




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.57487988471985 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5891797595221961,first_prior_anomaly_auc= 0.7212764549222308, first_prior_star_anomaly_auc= 0.711865042469704


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5891797595221961 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7526168901776007 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7194925697716563 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5891797595221961 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7342324723828735 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7351680665647604 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5891797595221961 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7442598925256472 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7438281040704728 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5891797595221961 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7462413918086264 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7345273177112059 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5891797595221961 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7473350457790315 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7335146634729028 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5891797595221961 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7420579289912854 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7266779078746237 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5891797595221961 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7400888790834739 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7240654301337914 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5891797595221961 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7386863545392943 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7243695730967427 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5891797595221961 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7352235371984178 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.719041555699135 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5891797595221961 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7338170729785525 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7178776179144932 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5891797595221961 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7268216272436453 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7218995540287123 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5891797595221961 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7360867989347117 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7190963959846826 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5891797595221961 at iter 0
max_prior_anomaly= 0.7587415099988969 at iter 1
max_prior_star_anomaly= 0.7452290527443781 at iter 27
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5891797595221961
accuracies_anomaly['prior'][-1]= 0.7311086247380114
accuracies_anomaly['prior_star'][-1]= 0.7193088232976661



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.22069001197815 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5891797595221961
 first_prior_anomaly_auc= 0.7395615928896733
 first_prior_star_anomaly_auc= 0.7215295396882928


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5900584647871787; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7312693635059961; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.723342263264888 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5900310446444048; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7301407252155003; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7253957798194053 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5902436295444159; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.7300784783396631; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7271257702065966 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5904432923081772; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7301380462360338; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.72747403753723 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.590539735568968 at iter 480
0.7395615928896733 at iter 0
0.7286077186126039 at iter 450
last anomaly aucs:
0.5905261830846085
0.7304760704098838
0.7282578754116962




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.607964515686035 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5905551790976566,first_prior_anomaly_auc= 0.7309333879635028, first_prior_star_anomaly_auc= 0.7289009880706621


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5905551790976566 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7344964306538286 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7326819736199316 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5905551790976566 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7358229982507839 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7491085301857952 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5905551790976566 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7418450289172196 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7444861874970452 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5905551790976566 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7444184250752478 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7411973462344579 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5905551790976566 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7424715949383047 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7383125581102163 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5905551790976566 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7380437146414106 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7347302898025434 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5905551790976566 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7329454591298045 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7311404573175536 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5905551790976566 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7287454496745828 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7282793072474274 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5905551790976566 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7252120333454151 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7260595363789653 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5905551790976566 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7258795719936334 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7265360795499316 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5905551790976566 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7255398143624816 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7257903777361048 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5905551790976566 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.724094583733867 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.724649132483414 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5905551790976566 at iter 0
max_prior_anomaly= 0.7444518335250643 at iter 41
max_prior_star_anomaly= 0.7497691350048064 at iter 21
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5905551790976566
accuracies_anomaly['prior'][-1]= 0.7247098034889768
accuracies_anomaly['prior_star'][-1]= 0.7243973084135714



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.4518632888794 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5905551790976566
 first_prior_anomaly_auc= 0.7207132388861749
 first_prior_star_anomaly_auc= 0.7223846068991601


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5920721118237546; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.7078180500181225; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7254827678585498 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5921200182800952; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.7084233417905038; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.726474463022204 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5917755330381202; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.7091022267046977; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7273549017444885 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.592172021999149; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7098250783995461; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7285613880265377 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.592172021999149 at iter 400
0.7207132388861749 at iter 0
0.7303143861197348 at iter 350
last anomaly aucs:
0.5917963345257419
0.7108129914745418
0.727820413823534




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.60682702064514 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5916406385426352,first_prior_anomaly_auc= 0.7140999416927998, first_prior_star_anomaly_auc= 0.7303206896008321


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5916406385426352 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7325596860866415 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7405181461462093 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5916406385426352 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7333536095308635 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7512160990907228 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5916406385426352 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7359123500953402 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7532215516018721 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5916406385426352 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7409759364609105 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.752270356304269 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5916406385426352 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7428148194840601 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7530589217895582 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5916406385426352 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7429323794065272 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7526901681453582 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5916406385426352 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.742003246292765 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7517348755850418 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5916406385426352 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7413256220747908 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7502671100115038 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5916404809556077 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7403769481696265 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7486070882644941 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5916404809556077 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7395822367902675 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7469974943662638 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5916406385426352 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7386728020549348 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7456898372126006 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5916406385426352 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7374960997210709 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7443418377799139 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5916406385426352 at iter 0
max_prior_anomaly= 0.7431829427801504 at iter 56
max_prior_star_anomaly= 0.7539811210741132 at iter 27
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5916406385426352
accuracies_anomaly['prior'][-1]= 0.7368258820933861
accuracies_anomaly['prior_star'][-1]= 0.7430231495343302



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.49642300605774 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5916406385426352
 first_prior_anomaly_auc= 0.7362487983989159
 first_prior_star_anomaly_auc= 0.742586318294278


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5924575696928629; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7346461383298926; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 80 
last prior star auc 0.7454660636336417 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5919964700505855; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7331674992514616; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 110 
last prior star auc 0.7439975101249665 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5920894463967725; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7366437114896701; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 230 
last prior star auc 0.7472017271538207 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5919646374710434; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.733526640086988; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 380 
last prior star auc 0.7445704965567235 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5926567596955419 at iter 10
0.7387159809004522 at iter 380
0.7488611185527208 at iter 380
last anomaly aucs:
0.591987645177049
0.7362894558519942
0.7459444978489371




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.58675575256348 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5919844934365003,first_prior_anomaly_auc= 0.7359610444868179, first_prior_star_anomaly_auc= 0.745842539042186


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5919844934365003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7377468206817215 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7479345068313976 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5919844934365003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7394013268827709 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7502478843941567 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5919844934365003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7377420930708984 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7468925414059915 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5919844934365003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7377565910774225 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7464276596750555 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5919844934365003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7368769402902753 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7451704303701718 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5919844934365003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7349149817986984 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7430581338544211 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5919844934365003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7327631309390612 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7407479080322107 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5919844934365003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7315857982570875 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7403460611122492 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5919844934365003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7287158233134249 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7366519060150968 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5919844934365003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7278486219014451 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7359985501993476 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5919844934365003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7263914146587453 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7354476259514316 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5919844934365003 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7260206123831886 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.734251855587248 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5919844934365003 at iter 0
max_prior_anomaly= 0.7397321020533589 at iter 21
max_prior_star_anomaly= 0.7535100934491072 at iter 15
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5919844934365003
accuracies_anomaly['prior'][-1]= 0.722623193658698
accuracies_anomaly['prior_star'][-1]= 0.7325037426919017



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.53638124465942 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5919844934365003
 first_prior_anomaly_auc= 0.7209656933041272
 first_prior_star_anomaly_auc= 0.7308027483177584


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5936511338386624; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7170253872701199; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 50 
last prior star auc 0.7321660336921064 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5933684227114424; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7133428936129977; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 50 
last prior star auc 0.7309945317301481 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5934147532975085; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7155692831366122; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 50 
last prior star auc 0.7329016499361772 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5935064689474763; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7173459192839247; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 50 
last prior star auc 0.7327112848070346 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5938112422585373 at iter 30
0.7250267110011503 at iter 50
0.7378085947964763 at iter 170
last anomaly aucs:
0.5934365003072948
0.7200438091936272
0.7346940447862331




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.57361602783203 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5934374458294593,first_prior_anomaly_auc= 0.7151072379721701, first_prior_star_anomaly_auc= 0.7328329419922152


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5934374458294593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.735428557921112 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7486597223316577 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5934374458294593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7378322328505917 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7571546086326173 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5934374458294593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7380213372835147 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7533041272042484 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5934374458294593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7384988259766456 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7526369037300848 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5934374458294593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7376053075310841 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7512999353893188 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5934374458294593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.737352222765022 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7500606710055628 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5934374458294593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7365765794159824 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.748334147532975 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5934374458294593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7364640622783933 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7472841451691696 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5934374458294593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7358159068345493 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7457683155522637 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5934374458294593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7354649605244497 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7444502576547898 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5934374458294593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7341298832280128 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7428047339143041 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5934374458294593 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7343990418708732 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7416366988669493 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5934374458294593 at iter 0
max_prior_anomaly= 0.7564639046913658 at iter 1
max_prior_star_anomaly= 0.7617132861622832 at iter 17
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5934374458294593
accuracies_anomaly['prior'][-1]= 0.7323088075389634
accuracies_anomaly['prior_star'][-1]= 0.7401796492112769



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.39738059043884 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5934374458294593
 first_prior_anomaly_auc= 0.7326428920371275
 first_prior_star_anomaly_auc= 0.7401065288305466


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5930913847172101; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7288708889484218; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.7371880170824339 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5930192098586444; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.718891217674961; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.7337831917676537 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5931955497423452; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7260513418535386; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.7388023385914871 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5931229021226972; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7258288289707991; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.7380760199820351 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5934374458294593 at iter 0
0.7393299399593426 at iter 10
0.7441505271286066 at iter 10
last anomaly aucs:
0.5930163732921505
0.7252361441606128
0.7389323478891218




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.716259717941284 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5929905290196511,first_prior_anomaly_auc= 0.7218778070189262, first_prior_star_anomaly_auc= 0.7364823423735758


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5929905290196511 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.739454118536962 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7527355532092598 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5929905290196511 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.73226168901776 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7473457616968971 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5929905290196511 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7296626061742599 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7436112643207211 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5929905290196511 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.726394566399294 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7401140930078636 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5929905290196511 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7240112201963534 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.738084687268544 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5929905290196511 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7228450761933278 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7368271427896056 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5929905290196511 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7219906393305703 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7355311470759728 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5929905290196511 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.719768662243724 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7335550057519264 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5929905290196511 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.722274295979955 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7377988244007754 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5929905290196511 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7165939139890003 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7312718848984352 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5929905290196511 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7175126463589517 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7314256898372126 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5929905290196511 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7168367555982792 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.730236065367099 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5929905290196511 at iter 0
max_prior_anomaly= 0.7426208298532865 at iter 4
max_prior_star_anomaly= 0.7529880076272122 at iter 11
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5929905290196511
accuracies_anomaly['prior'][-1]= 0.7198425705595914
accuracies_anomaly['prior_star'][-1]= 0.7349518571631184



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.21333265304565 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5929905290196511
 first_prior_anomaly_auc= 0.7163524906629686
 first_prior_star_anomaly_auc= 0.7318090990749642


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5940520352364593; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7166525363632066; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 60 
last prior star auc 0.7296377074239249 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5944784657327009; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7138541059299998; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 140 
last prior star auc 0.7273826370613171 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5946387317396031; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.7165712214570497; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 280 
last prior star auc 0.7294139338449659 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5948992230959548; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7113153789180074; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 280 
last prior star auc 0.7270504436074823 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.595083284744 at iter 490
0.7226184660478748 at iter 280
0.7351154324975968 at iter 180
last anomaly aucs:
0.595083284744
0.7113609215689365
0.7280974518177663




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 60.31348991394043 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5948746395196747,first_prior_anomaly_auc= 0.7213328710780528, first_prior_star_anomaly_auc= 0.7321802165245757


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5948746395196747 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7490322580645161 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7524304647241439 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5948746395196747 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7393721732826954 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7490164993617725 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5948746395196747 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7383951337125928 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7471913264100098 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5948746395196747 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7379891895299179 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.745457869108215 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5948746395196747 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7374042264840758 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7440411617315663 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5948746395196747 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7367968860803379 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7426584931528437 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5948746395196747 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7365772097640922 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7415944655435964 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5948746395196747 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7361677986668138 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7405865389161164 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5948746395196747 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7355220070283814 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7394632585845533 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5948746395196747 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7349742345210142 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.738596214759601 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5948746395196747 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7339122555431237 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.737047449453961 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5948746395196747 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7334527317711206 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7360122602707345 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5948746395196747 at iter 0
max_prior_anomaly= 0.7576369825235987 at iter 6
max_prior_star_anomaly= 0.7551898135745465 at iter 13
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5948746395196747
accuracies_anomaly['prior'][-1]= 0.733251493137085
accuracies_anomaly['prior_star'][-1]= 0.7354202058086579



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.61604714393616 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5948746395196747
 first_prior_anomaly_auc= 0.733091699891265
 first_prior_star_anomaly_auc= 0.7351772066123516


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5961599193154419; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7308712986746931; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7338679735884142 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5956376759065194; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7293606694296926; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7324708070031675 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5960092661172133; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7158589280930394; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.726097042091495 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5959203870337394; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7175221015805978; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7266845265297761 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5967089525190286 at iter 10
0.733091699891265 at iter 0
0.7359329939959343 at iter 170
last anomaly aucs:
0.5958021967631624
0.7164517704902533
0.7268323431615109




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.543627977371216 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5956925161920671,first_prior_anomaly_auc= 0.7232915202420537, first_prior_star_anomaly_auc= 0.7288412625872638


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5956925161920671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7299424807349859 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7457957356950375 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5956925161920671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7258762626660572 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7379904502261374 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5956925161920671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7256702964211987 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7357664245079345 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5956925161920671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7227492632806467 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7335137179507383 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5956925161920671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7200151283546339 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7313169547882818 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5956925161920671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7220502072269411 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7320437461588163 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5956925161920671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7161558220527285 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7285052870447705 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5956925161920671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7150130009297635 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7275654380131428 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5956925161920671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7120966954000346 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7257541327197945 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5956925161920671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7077214491703043 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7243963628914069 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5956925161920671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7065748459586808 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7228838426020769 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5956925161920671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7079664969979671 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7251316639614227 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5956925161920671 at iter 0
max_prior_anomaly= 0.7490371432623667 at iter 2
max_prior_star_anomaly= 0.7565874529208756 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5956925161920671
accuracies_anomaly['prior'][-1]= 0.7038646642608382
accuracies_anomaly['prior_star'][-1]= 0.7210766345714421



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.92680525779724 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5956925161920671
 first_prior_anomaly_auc= 0.7021668216272436
 first_prior_star_anomaly_auc= 0.7200977039570103


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6020376002647463; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7051299305041209; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 70 
last prior star auc 0.7166065209511953 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6012547079124446; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6922741383929275; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 160 
last prior star auc 0.7136278109586018 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5999637549836897; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7113557211970312; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 220 
last prior star auc 0.721435932993996 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6008207132388862; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7019566005326442; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 220 
last prior star auc 0.7163115180358353 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6048149140362765 at iter 10
0.7128630411144554 at iter 220
0.7285364892762027 at iter 160
last anomaly aucs:
0.6017091888995698
0.7019263438233765
0.7203996407015774




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.56105923652649 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6006628110373955,first_prior_anomaly_auc= 0.6928723387490742, first_prior_star_anomaly_auc= 0.7095740422648408


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6006628110373955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7174612729880077 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7313175851363916 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6006628110373955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.711746852199127 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7247540854436862 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6006628110373953 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7045561561372268 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7203624501631025 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6006628110373954 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6988296011472335 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7169967064311267 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6006628110373955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6946930992640685 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7147268228879398 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6006628110373955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6927201096805712 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7136092156893645 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6006628110373955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7069338292071796 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7237092834517862 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6006628110373955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6976453346360528 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7166755440692122 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6006628110373955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6933126369037301 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.712946719826024 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6006628110373955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6969112942622563 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7148919740926927 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6006628110373953 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6898879556234931 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7112583324140757 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6006628110373954 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7033789810422806 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7207223789337662 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6006628110373955 at iter 0
max_prior_anomaly= 0.7283524276281577 at iter 3
max_prior_star_anomaly= 0.7517329845407126 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6006628110373955
accuracies_anomaly['prior'][-1]= 0.6891383141339806
accuracies_anomaly['prior_star'][-1]= 0.7109114833666892



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.58606100082397 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6006628110373954
 first_prior_anomaly_auc= 0.68590068865531
 first_prior_star_anomaly_auc= 0.7111256441369747


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6043579116567124; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6967888491419387; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 100 
last prior star auc 0.7217164379028318 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6027754227272011; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7005430448965441; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 200 
last prior star auc 0.7231426005011268 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6029582236790267; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6908582189514159; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 200 
last prior star auc 0.7204730762563626 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6018941960697796; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6929889531493767; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 200 
last prior star auc 0.7191034874009171 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6054440014498007 at iter 30
0.7005430448965441 at iter 200
0.7231426005011268 at iter 200
last anomaly aucs:
0.6013769954457349
0.6976971807680792
0.7207538963392534




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.58213138580322 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6014337267756118,first_prior_anomaly_auc= 0.6932971933750414, first_prior_star_anomaly_auc= 0.7190677151456892


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6014337267756118 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7119353262839403 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7295674236096885 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6014337267756118 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.69344784657327 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7200858849299525 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6014337267756118 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.689929873772791 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7163187670390974 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6014337267756118 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6896544116488331 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7161038183336748 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6014337267756118 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7040729943111084 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7259664024457506 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6014337267756118 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6845117165954899 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7121436563342106 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6014337267756118 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6916034480041603 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7168763099421656 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6014337267756118 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6818954567659992 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7098939439305356 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6014337267756118 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6866370928345178 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7128304205997762 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6014337267756118 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6813453204532203 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.70966197582615 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6014337267756118 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6909853916825566 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7150668956931465 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6014337267756118 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6849042658808326 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7136218226515594 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6014337267756118 at iter 0
max_prior_anomaly= 0.7324061963219188 at iter 2
max_prior_star_anomaly= 0.7528206502040752 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6014337267756118
accuracies_anomaly['prior'][-1]= 0.6857462533684227
accuracies_anomaly['prior_star'][-1]= 0.7116466268496777



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.20447206497192 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6014337267756118
 first_prior_anomaly_auc= 0.6815323762547867
 first_prior_star_anomaly_auc= 0.7091104212301242


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6035239611075216; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6814715476621964; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 90 
last prior star auc 0.7024662369793719 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6035327859810581; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6813896024079298; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 190 
last prior star auc 0.7016505665253636 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.603746473990261; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6739335297918275; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 230 
last prior star auc 0.6989769450178862 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.601833997825299; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6755175945916132; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 230 
last prior star auc 0.6961996312463558 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.606033061758356 at iter 10
0.7032935688734103 at iter 430
0.7152238523724728 at iter 430
last anomaly aucs:
0.6030300833635375
0.6948062467497675
0.7092591833840238




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.528064489364624 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6019502970515467,first_prior_anomaly_auc= 0.6761085459444978, first_prior_star_anomaly_auc= 0.6967445671872291


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6019502970515467 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7042397213861356 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7217022550703627 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6019502970515467 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6795522952550547 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7059208597948217 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6019502970515467 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6741576185448414 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7017236869060939 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6019502970515467 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6782707975479458 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7038905085333375 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6019502970515467 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6698090045227476 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.698559024221126 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6019502970515467 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6721792710024111 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6992716327591912 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6019502970515467 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.67178908552248 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6988661613375986 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6019502970515467 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.671488724648187 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6992022944671195 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6019502970515467 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6686743779252093 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6974811289534646 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6019502970515467 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6733009754636998 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7023034495800307 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6019502970515467 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6840802433143703 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7052530059725484 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6019502970515467 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6631756937768883 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6925265928108798 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6019502970515467 at iter 0
max_prior_anomaly= 0.7295571804529053 at iter 2
max_prior_star_anomaly= 0.7497577887388309 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6019502970515467
accuracies_anomaly['prior'][-1]= 0.6649186063003295
accuracies_anomaly['prior_star'][-1]= 0.6945099831381881



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.42272186279297 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6019502970515467
 first_prior_anomaly_auc= 0.6677028539010669
 first_prior_star_anomaly_auc= 0.7002697889909703


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6058947003482673; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.66802716800353; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 50 
last prior star auc 0.6990759096711159 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6036787115684636; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6689074491387869; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 50 
last prior star auc 0.699095450462518 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.602753675717415; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6811570039554344; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 50 
last prior star auc 0.7067642655656585 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.601170241265739; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6687145626172053; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 50 
last prior star auc 0.6975432182422743 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6071525600012607 at iter 10
0.6811724474841231 at iter 50
0.7072899758891849 at iter 50
last anomaly aucs:
0.6011907275793058
0.6746762374521329
0.700022377357896




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.5643093585968 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6007362465921805,first_prior_anomaly_auc= 0.6721477535969239, first_prior_star_anomaly_auc= 0.7011746537025072


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6007362465921805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6821198606930677 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7068597633042848 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6007362465921805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.67234158564067 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6996353436185133 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6007362465921806 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.679396599271948 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7038233764596498 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6007362465921805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6708536489276203 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6975394361536158 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6007362465921805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6700966008478182 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6969434420158532 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6007362465921805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6698003372362387 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6970739240745703 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6007362465921805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6679253667838064 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6955617189592953 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6007362465921805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7087552200702838 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7191647887545897 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6007362465921805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6840373796429077 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.705064531887735 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6007362465921805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6752835778558709 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6998537592385395 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6007362465921805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6783146067415731 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7016045511133524 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6007362465921805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6652879902926391 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6930441086089794 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6007362465921806 at iter 3
max_prior_anomaly= 0.7270268055533669 at iter 2
max_prior_star_anomaly= 0.7448650267110011 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6007362465921805
accuracies_anomaly['prior'][-1]= 0.6656406700600408
accuracies_anomaly['prior_star'][-1]= 0.6935020565107081



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.1302878856659 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5081321209638023
accuracies_anomaly["prior"][-1]= 0.7232423530894936
accuracies_anomaly["prior_star"][-1]= 0.5117006792000882


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 2660.452467441559 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003266572952270508 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.48924405502938995
 first_prior_anomaly_auc= 0.7183019997793781
 first_prior_star_anomaly_auc= 0.49272988007627216


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5034995351182691; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7322875332902596; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5114921915627906 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5170036402603337; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7383155522637377; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5336900578344391 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5288075389633925; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7418875774146272; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5628392454733127 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5400589375482611; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7456346817529981; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.5947695289723749 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5551557747766205 at iter 490
0.7492774634792064 at iter 490
0.61990166569488 at iter 490
last anomaly aucs:
0.5551557747766205
0.7492774634792064
0.61990166569488




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.60619902610779 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5567209291331138,first_prior_anomaly_auc= 0.7496488961028728, first_prior_star_anomaly_auc= 0.622016168429015


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5567209291331138 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7377153032762342 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7430836629528658 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5567209291331138 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7395972075578738 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7374660005988307 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5567209291331138 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7393825740265062 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7334210567786059 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5567209291331138 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7394478150558647 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7289276202782986 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5567209291331138 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7383680287438737 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7244959578927462 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5567209291331138 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7339351056621018 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7168709519832327 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5567209291331138 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7265386009423704 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7108725593709125 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5567209291331138 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7243977811746538 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7111628346754495 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5567209291331138 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7206104921442867 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7072657074869597 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5567209291331138 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7124953905794476 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7023114865184298 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5567209291331138 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7210509478859699 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7068134327182186 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5567209291331138 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7123844493121326 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6988565485289251 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5567209291331138 at iter 0
max_prior_anomaly= 0.7496488961028728 at iter 0
max_prior_star_anomaly= 0.7440310761618104 at iter 11
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5567209291331138
accuracies_anomaly['prior'][-1]= 0.7028806908615282
accuracies_anomaly['prior_star'][-1]= 0.6952263737649116



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.4232907295227 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5567209291331138
 first_prior_anomaly_auc= 0.7074390532171392
 first_prior_star_anomaly_auc= 0.6985675339206077


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5722120491041177; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7052927179034623; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7072594040058622 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5808197677167215; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7058842996044565; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7133353294356808 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5854027136486124; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7079367130497818; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 300 
last prior star auc 0.7184972501063711 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5876848889799392; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7084435129300155; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 400 
last prior star auc 0.7213883417117104 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.588510172242621 at iter 490
0.7110030414296294 at iter 470
0.7242617835699765 at iter 470
last anomaly aucs:
0.588510172242621
0.7108396236821783
0.7240288699434262




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.62678146362305 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5885676915076351,first_prior_anomaly_auc= 0.7098638448082953, first_prior_star_anomaly_auc= 0.7235630426903257


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5885676915076351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7503531525284838 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7354432135146636 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5885676915076351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.725346139905763 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7192227807806861 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5885676915076351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7155324077721922 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7137349701372582 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5885676915076351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7245476464377452 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7193910837259876 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5885676915076351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7112075893912413 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7080268528294751 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5885676915076351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7422096852987061 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7231463825897853 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5885676915076351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7152336227681737 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7100540523504105 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5885676915076351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.727746663094694 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7154208361567675 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5885676915076351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7115961990008983 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7074422049576878 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5885676915076351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7356031643475108 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.717745559985502 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5885676915076351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6907182816710529 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6924638731739603 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5885676915076351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.713030240950565 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7088636399451597 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5885676915076351 at iter 0
max_prior_anomaly= 0.775896748979624 at iter 1
max_prior_star_anomaly= 0.7354432135146636 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5885676915076351
accuracies_anomaly['prior'][-1]= 0.7340195723088075
accuracies_anomaly['prior_star'][-1]= 0.7148234237357581



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.66016244888306 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5885676915076351
 first_prior_anomaly_auc= 0.7190998628992862
 first_prior_star_anomaly_auc= 0.7079163843232426


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5899197882030351; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7238142364120586; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.7096837228359361 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5902242463400413; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7254320248357156; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 150 
last prior star auc 0.7104335219124762 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5899563483934003; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7264996769465938; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 250 
last prior star auc 0.7121301038498511 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5894851631813669; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7266433963156153; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 250 
last prior star auc 0.7127626581779788 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5902264525584253 at iter 190
0.7282887624690735 at iter 440
0.7141431205383173 at iter 440
last anomaly aucs:
0.5890458105488756
0.7279668121720221
0.7140690546354224




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.42357015609741 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5890083048363458,first_prior_anomaly_auc= 0.7271968419559702, first_prior_star_anomaly_auc= 0.7137869738563122


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5890083048363458 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7615542808516002 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7290489622894243 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5890083048363458 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7455593551538837 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7196173786973856 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5890083048363458 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7333803993255275 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7107745402398474 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5890083048363458 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7391266526939503 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7147892273508045 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5890083048363459 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7374557574420473 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7110186425453457 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5890083048363458 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7457957356950375 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7158223679026743 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5890083048363458 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7391537576626692 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7108353688324378 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5890083048363458 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7390491198764518 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7120989016184187 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5890083048363458 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7583554217816789 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7204251698000221 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5890083048363458 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7624753770269631 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7257468837165325 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5890083048363458 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7415758702743589 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7133183100367178 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5890083048363459 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.746261878122193 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7157880139306931 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5890083048363459 at iter 1
max_prior_anomaly= 0.7740647997856817 at iter 2
max_prior_star_anomaly= 0.7336442000094552 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5890083048363458
accuracies_anomaly['prior'][-1]= 0.742874072206376
accuracies_anomaly['prior_star'][-1]= 0.7098318546417259



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 117.90288782119751 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5890083048363459
 first_prior_anomaly_auc= 0.7425135130876026
 first_prior_star_anomaly_auc= 0.7099992120648627


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.58958822509731; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.738249523299242; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.7100398695179413 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5895838126605418; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.7356803819909545; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.7111445545802669 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5890481743542871; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.7332593724884566; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.710984446160392 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5889099705312258; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.7331717541012024; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.7125155617189592 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5898857494051091 at iter 150
0.7431545771152119 at iter 10
0.7142701356824306 at iter 470
last anomaly aucs:
0.5889203712750366
0.7317225837969019
0.712936634256268




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.512399673461914 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5889137526198843,first_prior_anomaly_auc= 0.7317726964716263, first_prior_star_anomaly_auc= 0.7130447389570891


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5889137526198843 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7307606725814332 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7386657106387002 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5889137526198843 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7393661849756528 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7418715035378287 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5889137526198843 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7474472477425658 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7461172132310068 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5889137526198843 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7565343460926297 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7409866523787761 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5889137526198843 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7566796413319257 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7376157082748949 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5889137526198843 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7561558220527287 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7358102337015617 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5889137526198843 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7588685251430103 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7333684227114423 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5889137526198843 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.761270781789243 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7344258316655372 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5889137526198843 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7592265628693446 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7302910632396742 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5889137526198843 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7587405644767323 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7305416266132971 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5889137526198843 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.758369919788203 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7273366216493058 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5889137526198843 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.7589977465055077 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7270602140031832 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5889139102069118 at iter 5
max_prior_anomaly= 0.761270781789243 at iter 80
max_prior_star_anomaly= 0.7461172132310068 at iter 30
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5889137526198843
accuracies_anomaly['prior'][-1]= 0.7598550199347589
accuracies_anomaly['prior_star'][-1]= 0.7271613848747971



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 118.58554673194885 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5889137526198843
 first_prior_anomaly_auc= 0.7593025198165687
 first_prior_star_anomaly_auc= 0.7265480561640166


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5866533242983437; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7466194430874451; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7310859322060608 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5869502182580331; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.743409868099658; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7333236679956506 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5871730463148275; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7418505444631798; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7344980065241029 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5873719211434514; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7415850103219503; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7355793687063681 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5889137526198843 at iter 0
0.7593025198165687 at iter 0
0.7375074459870463 at iter 460
last anomaly aucs:
0.5875477882660699
0.7412414706021401
0.7363460295948437




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.529563665390015 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5874973604172905,first_prior_anomaly_auc= 0.7416924846746616, first_prior_star_anomaly_auc= 0.7369027845627748


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5874973604172905 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7118521203334541 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7209511952976031 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5874973604172905 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7360029626361158 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7399873930378051 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5874973604172905 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7398728272688593 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7379787887861071 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5874973604172905 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7398543895866492 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7388439415667302 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5874973604172905 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.742018374647399 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7441328773815339 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5874973604172905 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7529974628488583 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7508533337535654 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5874973604172905 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7404113021416077 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7384406763635218 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5874973604172905 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.738981987802764 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7367962557322281 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5874973604172905 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7399741557275005 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7371593362434403 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5874973604172905 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7392730510424383 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7364555525789117 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5874973604172905 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7372324566241706 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7348223206265659 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5874973604172905 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7368235182879745 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7356134075042942 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5874973604172905 at iter 0
max_prior_anomaly= 0.7529974628488583 at iter 60
max_prior_star_anomaly= 0.7508533337535654 at iter 60
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5874973604172905
accuracies_anomaly['prior'][-1]= 0.7361630710559905
accuracies_anomaly['prior_star'][-1]= 0.7332511779630301



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.3351559638977 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5874973604172905
 first_prior_anomaly_auc= 0.7368972690168145
 first_prior_star_anomaly_auc= 0.7337472619253982


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4255041996942811; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7321483839450336; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5042069432844287 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42591707770616316; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7195946861654349; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5035936145736484 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42571095387427704; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7252712860677308; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.504850843878532 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42566966607308887; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.72393400255291; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5043468805647919 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5874973604172905 at iter 0
0.7368972690168145 at iter 0
0.7337472619253982 at iter 0
last anomaly aucs:
0.4253932584269663
0.7249308980884692
0.5047600737507288




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.109920024871826 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.425338575728446,first_prior_anomaly_auc= 0.7195234568290338, first_prior_star_anomaly_auc= 0.5040030256709267


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.425338575728446 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7076915076350915 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4788584395732543 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.425338575728446 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7255785807712309 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4926060166727075 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.425338575728446 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7272200072490033 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.508290023165293 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.425338575728446 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7259861008241801 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5099793560994059 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.425338575728446 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7262114502734136 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.510404525899428 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.425338575728446 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7258281986226894 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5102006082859258 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.425338575728446 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7257374284948863 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5096723765699607 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.425338575728446 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7258196889232078 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5091854326551838 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.425338575728446 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.725516806656476 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5086846210819925 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.425338575728446 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7253169863056874 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5081756149833746 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.425338575728446 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7250330144822479 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5076628267960982 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.425338575728446 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7244247285563452 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.507094095214082 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.425338575728446 at iter 0
max_prior_anomaly= 0.7273687694029027 at iter 28
max_prior_star_anomaly= 0.510415714578376 at iter 52
last values
accuracies_anomaly['vanilla_star'][-1]= 0.425338575728446
accuracies_anomaly['prior'][-1]= 0.7236345872007817
accuracies_anomaly['prior_star'][-1]= 0.5065231574136817



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.52692723274231 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.425338575728446
 first_prior_anomaly_auc= 0.7242069432844288
 first_prior_star_anomaly_auc= 0.5065471106418519


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42623824006807753; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7333460453535465; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 60 
last prior star auc 0.50808862694423 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42644152733346996; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7256904675607104; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 160 
last prior star auc 0.5071859684510771 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4265631845186505; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7385735222276502; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 300 
last prior star auc 0.5097741777896843 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4266151882377043; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.7316516696345557; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 350 
last prior star auc 0.5083436027546212 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4266955576216966 at iter 440
0.7388954725247019 at iter 350
0.5097741777896843 at iter 300
last anomaly aucs:
0.42664796633941093
0.7267503979072443
0.5081188836534977




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.347705602645874 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4266706588713617,first_prior_anomaly_auc= 0.7319589643380557, first_prior_star_anomaly_auc= 0.5089443245032069


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4266706588713617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.724174480356777 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49209669540003464 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4266706588713617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7360193516869691 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5089603983800054 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4266706588713617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7404740217785272 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5180739713506785 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4266706588713617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7395641142821122 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5181587531714389 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4266706588713617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7409374852262162 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5174760861685865 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4266706588713617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7411103581953133 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5176138172305655 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4266706588713617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7393381344847694 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5159099862899286 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4266706588713617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.740051688544999 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.515272389176923 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4266706588713617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7387443465653908 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5148204295822368 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4266706588713617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7384569078273477 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5139209228296326 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4266706588713617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.738018500717021 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5133277652583639 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4266706588713617 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.738148667601683 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5126595962620357 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4266706588713617 at iter 0
max_prior_anomaly= 0.7411106733693682 at iter 24
max_prior_star_anomaly= 0.5183867816001387 at iter 43
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4266706588713617
accuracies_anomaly['prior'][-1]= 0.737288242431883
accuracies_anomaly['prior_star'][-1]= 0.5119356414579952



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.76557326316833 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4266706588713617
 first_prior_anomaly_auc= 0.7371303402303923
 first_prior_star_anomaly_auc= 0.5118678790361978


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42571536631104523; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7336158343445167; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 40 
last prior star auc 0.5057161542461825 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4256680902028145; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7235767527617126; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 40 
last prior star auc 0.5058671226184661 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4255757442047371; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7252632491293316; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 40 
last prior star auc 0.5068307672912367 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42561135887293755; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7260915265455349; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 40 
last prior star auc 0.5064367997226469 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4266706588713617 at iter 0
0.7460453535464961 at iter 40
0.5118678790361978 at iter 0
last anomaly aucs:
0.4255782655971761
0.724909781426793
0.5083618828498039




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.71047854423523 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.42557889594528586,first_prior_anomaly_auc= 0.7200794238618277, first_prior_star_anomaly_auc= 0.5065527837748396


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42557889594528586 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.723031344059757 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48420820398064834 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42557889594528586 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7344411176071985 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5076678695809761 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42557889594528586 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7368019288652159 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5172828844729502 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42557889594528586 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7356638353530737 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5157501930441086 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.42557889594528586 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7346143057503507 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5147476243755614 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.42557889594528586 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.733556266448146 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5134758970641538 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.42557889594528586 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7320766818475504 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5121045747514065 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.42557889594528586 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7300669744866602 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.510886427029327 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.42557889594528586 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7281596986936035 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5099374379501079 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.42557889594528586 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7256321603605591 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.508825819058575 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.42557889594528586 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7230318168208393 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5077558031422853 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.42557889594528586 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.71996312463558 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5067488220369699 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.42557889594528586 at iter 0
max_prior_anomaly= 0.7376374552846809 at iter 26
max_prior_star_anomaly= 0.5172828844729502 at iter 30
last values
accuracies_anomaly['vanilla_star'][-1]= 0.42557889594528586
accuracies_anomaly['prior'][-1]= 0.7178394818538538
accuracies_anomaly['prior_star'][-1]= 0.505920229446712



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.87006092071533 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.42557889594528586
 first_prior_anomaly_auc= 0.7170751847707896
 first_prior_star_anomaly_auc= 0.5058442724994878


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42634067163591094; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7099396441684921; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5057724128149771 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4266079392344422; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7065137021920356; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5057664245079345 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4267481916888602; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7037061317112376; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5058581401579022 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42677844839812784; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.703931165986416; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5057569692862883 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.42682572450635864 at iter 490
0.7170751847707896 at iter 0
0.5073627810958602 at iter 380
last anomaly aucs:
0.42682572450635864
0.7052311013757346
0.5060677309043919




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.61592960357666 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4268005105819689,first_prior_anomaly_auc= 0.7079242636746144, first_prior_star_anomaly_auc= 0.5067006004065745


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4268005105819689 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7074623760971998 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49031816820839313 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4268005105819689 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7298775548796823 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5155787383582583 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4268005105819689 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7319816568700065 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5171426320185322 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4268005105819689 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7325502308649953 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5163654127992183 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4268005105819689 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7329898986715414 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5156294813810927 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4268005105819689 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7333091699891265 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5147715776037317 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4268005105819689 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7323275603952282 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5156039522826481 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4268005105819689 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7309349638337772 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5148182233638527 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4268005105819689 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7286231621412925 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5121543722520763 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4268005105819689 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7264366421356194 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5130778322328506 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4268005105819689 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7234439068975842 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5123794065272548 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4268005105819689 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7197406117528404 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5096074507146572 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4268005105819689 at iter 0
max_prior_anomaly= 0.737539120979561 at iter 1
max_prior_star_anomaly= 0.517275950643743 at iter 28
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4268005105819689
accuracies_anomaly['prior'][-1]= 0.7169391871661126
accuracies_anomaly['prior_star'][-1]= 0.5087775974281797



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.11658525466919 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4268005105819689
 first_prior_anomaly_auc= 0.7169453330601825
 first_prior_star_anomaly_auc= 0.5089411727626582


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.426682320311392; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7157360102116394; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5040266637250422 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42658871361709505; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7063236522369478; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.5027688040720488 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42662164930582913; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7004948232661488; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.5040465196904991 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4265969081425217; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7073701876861497; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.5060026474620609 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4268005105819689 at iter 0
0.7219547094883149 at iter 10
0.5089411727626582 at iter 0
last anomaly aucs:
0.42656160864837606
0.7062956017460643
0.5040777219219315




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.34741830825806 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4265351340277668,first_prior_anomaly_auc= 0.7087049498085318, first_prior_star_anomaly_auc= 0.5045842066281103


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4265351340277668 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7336766629371071 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5082988480388294 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4265351340277668 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7401484469798446 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5203804150842303 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4265351340277668 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7380144034543077 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5183062546291191 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4265351340277668 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7378421608333201 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5172904486502671 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4265351340277668 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7378675323447375 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5161722111035819 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4265351340277668 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7377556455552579 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5150911640953717 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4265351340277668 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7375384906314512 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5161813511511733 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4265351340277668 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7360896355012055 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5152859416612824 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4265351340277668 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7330111729202452 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5118814315205573 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4265351340277668 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7313021416077029 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5114434971713129 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4265351340277668 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7303619774020202 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.512541090817404 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4265351340277668 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7273791701467136 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5098977260191941 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4265351340277668 at iter 0
max_prior_anomaly= 0.7405049088359046 at iter 21
max_prior_star_anomaly= 0.5206363364167862 at iter 21
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4265351340277668
accuracies_anomaly['prior'][-1]= 0.7259337819310714
accuracies_anomaly['prior_star'][-1]= 0.5101788612761398



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.86589360237122 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4265351340277668
 first_prior_anomaly_auc= 0.7252693950234017
 first_prior_star_anomaly_auc= 0.5103938099815624


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42646957782435346; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7003082402256646; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.508237231511102 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42641394960366863; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7044436389996376; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5097521156058433 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4264547646437745; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7023530894936729; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.509886852514301 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4265196904990781; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7051953291205068; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5119378476763793 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4267415730337079 at iter 10
0.7252693950234017 at iter 0
0.5125889972737444 at iter 490
last anomaly aucs:
0.42648817309359094
0.7134407551570354
0.5125889972737444




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.52119469642639 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.42648281513465813,first_prior_anomaly_auc= 0.7075893912413129, first_prior_star_anomaly_auc= 0.5119841782624455


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42648281513465813 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7319826023921711 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5117222686228469 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42648281513465813 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7360445656113589 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5240279244212617 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42648281513465813 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7340895409489893 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5232579542052098 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42648281513465813 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7330456844792537 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5206987408796508 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.42648281513465813 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7330248829916322 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5192208897363569 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.42648281513465813 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7297250106371242 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5178169469089304 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.42648281513465813 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7273345730179491 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5166465480561641 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.42648281513465813 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7250676836282838 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5177944119640071 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.42648281513465813 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7207590967111588 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5146535449201822 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.42648281513465813 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.718802338591487 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5144958003057188 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.42648281513465813 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7162002615944655 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5139735568967962 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.42648281513465813 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.715589139102069 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5155242132467655 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.42648281513465813 at iter 0
max_prior_anomaly= 0.7446894747624376 at iter 1
max_prior_star_anomaly= 0.5241628189167468 at iter 19
last values
accuracies_anomaly['vanilla_star'][-1]= 0.42648281513465813
accuracies_anomaly['prior'][-1]= 0.7149975574010747
accuracies_anomaly['prior_star'][-1]= 0.5152096695400034



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.77797722816467 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.42648281513465813
 first_prior_anomaly_auc= 0.713439809634871
 first_prior_star_anomaly_auc= 0.5151188994122003


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4276042044218919; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7129731944466331; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 80 
last prior star auc 0.5082969569945002 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4272472698047497; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7086830452117182; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 160 
last prior star auc 0.5106547740989962 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42715697243802897; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6924610366074666; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 160 
last prior star auc 0.5058004633058607 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4272814661897033; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7047109065981688; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 160 
last prior star auc 0.5101593204847377 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.42778605985155305 at iter 70
0.7222752415021196 at iter 160
0.5154208361567676 at iter 490
last anomaly aucs:
0.42725877365775244
0.7093534204264305
0.5154208361567676




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.68596267700195 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4272017271538207,first_prior_anomaly_auc= 0.7002533999401168, first_prior_star_anomaly_auc= 0.5099456324755346


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4272017271538207 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7294991884268087 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.514626755125518 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4272017271538207 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7316981578076494 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5314524796318767 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4272017271538207 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7336921064657957 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5318716611248562 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4272017271538207 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7336207195423673 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5301938320437461 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4272017271538207 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7337122776053076 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5285765163811715 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4272017271538207 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7338656097830026 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5267907401862678 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4272017271538207 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7330464724143909 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5250122129946263 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4272017271538207 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7318480230707409 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5234164867548102 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4272017271538207 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7293461714231685 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5216808232346313 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4272017271538207 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7256835337315033 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5200242684022252 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4272017271538207 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7216855508454543 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5185316040783523 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4272017271538207 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7192054462076682 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5178423184203477 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4272017271538207 at iter 0
max_prior_anomaly= 0.7338977575365996 at iter 57
max_prior_star_anomaly= 0.5325264352238523 at iter 24
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4272017271538207
accuracies_anomaly['prior'][-1]= 0.7168558236285989
accuracies_anomaly['prior_star'][-1]= 0.5193535780134579



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.06600069999695 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4272017271538207
 first_prior_anomaly_auc= 0.716495106922798
 first_prior_star_anomaly_auc= 0.5169349323163717


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4263885780922514; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7112762973352034; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5186557826559717 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4266496997967128; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7049485478355422; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.518025749720283 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42663126211450275; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7048675481034401; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.519923727878721 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4268654364372725; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7053009124288888; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5223842917251053 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4272017271538207 at iter 0
0.716495106922798 at iter 0
0.5240055470633658 at iter 460
last anomaly aucs:
0.4269303622925761
0.7054808768142206
0.5217706478402697




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.66737914085388 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4269423389066612,first_prior_anomaly_auc= 0.7186696503143861, first_prior_star_anomaly_auc= 0.5271267157287611


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4269423389066612 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7295470948831491 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5217394456088376 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4269423389066612 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.734170540681091 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5389514159194415 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4269423389066612 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7353007548418614 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5398606930677466 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4269423389066612 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7353458247317081 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.539176135020565 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4269423389066612 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7351704303701718 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5378760420442189 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4269423389066612 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7344655435964511 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5363647824511086 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4269423389066612 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7331544195281844 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5347848149140363 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4269423389066612 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.730721275824574 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.533148116047087 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4269423389066612 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.727358683833147 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5313713223127473 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4269423389066612 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7242192350725688 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.53025198165687 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4269423389066612 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7204270608443513 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5263939360511842 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4269423389066612 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7186423877586396 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5267844367051704 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4269423389066612 at iter 0
max_prior_anomaly= 0.7355068786737475 at iter 35
max_prior_star_anomaly= 0.5398606930677466 at iter 30
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4269423389066612
accuracies_anomaly['prior'][-1]= 0.7156510708038515
accuracies_anomaly['prior_star'][-1]= 0.5259854704760704



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 120.25252723693848 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4269423389066612
 first_prior_anomaly_auc= 0.7157763524906628
 first_prior_star_anomaly_auc= 0.525848684936256


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4266359897253258; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6959651417495312; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5186362418645697 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4272237893376617; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7021371952660856; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5220905495059647 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4269094032179271; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7075881305450935; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5262111350993586 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4267006004065745; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7084570654143751; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5220918102021841 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.42727547788266074 at iter 190
0.7157763524906628 at iter 0
0.5279688608033787 at iter 450
last anomaly aucs:
0.42663315315883193
0.6976303638684462
0.5230781474069055




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.58433127403259 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.42650645318877356,first_prior_anomaly_auc= 0.7087731849914116, first_prior_star_anomaly_auc= 0.5245700237956412


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42650645318877356 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7361731566257466 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5311656712419434 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42650645318877356 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7345408701955656 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5476785854988417 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42650645318877356 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.732196290401374 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.545939770238114 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42650645318877356 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7321156058433269 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5443875380178703 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.42650645318877356 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7322196132814347 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5427612398947318 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.42650645318877356 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.731680350473549 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5414510613486297 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.42650645318877356 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7314625652016327 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.539694911514884 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.42650645318877356 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7282562995414218 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5371908536489276 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.42650645318877356 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7248697543218242 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5350662653450368 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.42650645318877356 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7200223773578959 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5331487463951967 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.42650645318877356 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7160527601367855 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5317774240824495 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.42650645318877356 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7138684463494965 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5307367193532628 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.42650645318877356 at iter 0
max_prior_anomaly= 0.7386261562948139 at iter 13
max_prior_star_anomaly= 0.5484416218856865 at iter 17
last values
accuracies_anomaly['vanilla_star'][-1]= 0.42650645318877356
accuracies_anomaly['prior'][-1]= 0.7117591439872669
accuracies_anomaly['prior_star'][-1]= 0.5297708684621082



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.68257880210876 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.42650645318877356
 first_prior_anomaly_auc= 0.7116122728776968
 first_prior_star_anomaly_auc= 0.5297095671084356


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4259955560458263; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7071453109979986; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 30 
last prior star auc 0.5256069464361695 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42602612792914885; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7127812534472162; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 30 
last prior star auc 0.5316916967395244 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42625588981515045; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7127396504719732; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 30 
last prior star auc 0.5310162787399342 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4265338733315474; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.7090729155175945; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 30 
last prior star auc 0.5307947113793593 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.42681658445876736 at iter 370
0.7164689474762438 at iter 30
0.5346209244055029 at iter 430
last anomaly aucs:
0.42644121215941505
0.7044928061521976
0.5297442362544715




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 57.67701554298401 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.42641127062420225,first_prior_anomaly_auc= 0.7012411554280851, first_prior_star_anomaly_auc= 0.5282304552689222


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42641127062420225 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7269440723639629 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.534795215657847 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42641127062420225 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7289077643128419 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5472978552405566 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42641127062420225 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7274721464929006 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5452151850859637 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42641127062420225 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7253105252375625 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5428753329025955 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.42641127062420225 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7244389113888144 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5406643869076697 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.42641127062420225 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7227480025844273 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5382750523976867 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.42641127062420225 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7196911294262256 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5357807649274312 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.42641127062420225 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7154309217265234 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5337869738563121 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.42641127062420225 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7118940384827521 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.532290212269726 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.42641127062420225 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7081630080211798 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5310249460264431 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.42641127062420225 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7048448555714893 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5298290180752321 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.42641127062420225 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7021633547126401 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5286846210819925 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.42641127062420225 at iter 0
max_prior_anomaly= 0.7306667507130813 at iter 13
max_prior_star_anomaly= 0.547466473359913 at iter 18
last values
accuracies_anomaly['vanilla_star'][-1]= 0.42641127062420225
accuracies_anomaly['prior'][-1]= 0.6992684810186426
accuracies_anomaly['prior_star'][-1]= 0.5277507603574074



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 118.9642961025238 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.48924405502938995
accuracies_anomaly["prior"][-1]= 0.7183019997793781
accuracies_anomaly["prior_star"][-1]= 0.49272988007627216


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 2656.0062177181244 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0033881664276123047 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5034448524197488
 first_prior_anomaly_auc= 0.716593756401973
 first_prior_star_anomaly_auc= 0.5069016814535827


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5201134626597539; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7316275588193579; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5280980821658761 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.537599161637014; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.736755755866177; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5545903525221804 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5517140740974203; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7378385363316892; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5840641694375719 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5654005074302284; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.738178293962841; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 400 
last prior star auc 0.6138567849094663 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5785379075594497 at iter 490
0.7393411286382905 at iter 490
0.6352716012417858 at iter 490
last anomaly aucs:
0.5785379075594497
0.7393411286382905
0.6352716012417858




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.758148193359375 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5796006744724774,first_prior_anomaly_auc= 0.739508013300345, first_prior_star_anomaly_auc= 0.6368690609389036


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5796006744724775 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7329041713286162 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371733614888823 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5796006744724775 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7062840978930616 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6377154608632618 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5796006744724775 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6579543627968547 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6428192319208283 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5796006744724774 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6697253258111793 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.685966560032778 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5796006744724774 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7269205918968751 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7178265597176039 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5796006744724775 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7344948547835543 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7368031895614353 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5796006744724775 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7353871125328963 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7449602092755725 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5796006744724775 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7364435759648266 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7445230628614653 iter_best_prior_star_anomaly= 720
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5796006744724775 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7363682493657121 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7430083363537513 iter_best_prior_star_anomaly= 720
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5796006744724775 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7355484816489907 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.741799643853318 iter_best_prior_star_anomaly= 720
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5796006744724775 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7351031407094568 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7411859999684826 iter_best_prior_star_anomaly= 720
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5796006744724774 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7347844997399814 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7401862678664293 iter_best_prior_star_anomaly= 720
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5796006744724775 at iter 1
max_prior_anomaly= 0.739768977417779 at iter 2
max_prior_star_anomaly= 0.7452747529823345 at iter 72
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5796006744724775
accuracies_anomaly['prior'][-1]= 0.7347224104511717
accuracies_anomaly['prior_star'][-1]= 0.7394862662905589



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.34369802474976 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5796006744724775
 first_prior_anomaly_auc= 0.7346587452920876
 first_prior_star_anomaly_auc= 0.7394746048505286


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5911659864159983; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7353303812030195; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.7467702538727011 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.595451723214145; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7356639929401012; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.7506446885292403 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.595660683612525; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.735626329640544; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 250 
last prior star auc 0.7530056573742849 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5945069889846668; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7354967931039917; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 250 
last prior star auc 0.7544292985801409 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5958378114313629 at iter 260
0.7356893644515183 at iter 250
0.7553272294624707 at iter 490
last anomaly aucs:
0.5935370408307987
0.7353467702538727
0.7553272294624707




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.603543281555176 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5934342940889106,first_prior_anomaly_auc= 0.7353209259813733, first_prior_star_anomaly_auc= 0.7554003498432009


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5934342940889106 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.740017334573018 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7522416754652758 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5934342940889106 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7409691602187308 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7513260948358731 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5934342940889106 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.741435617819941 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7506683265833557 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5934342940889106 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7417422821753313 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7500364026033377 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5934342940889106 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7420130166884662 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7494952487511228 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5934342940889106 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7422055880359928 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.748887908347385 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5934342940889106 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7423420584017524 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7482793072474274 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5934342940889106 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7424495327544636 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7476864648502136 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5934342940889106 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.742512567565438 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7471114297871 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5934342940889106 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7426115322186677 iter_best_prior_anomaly= 990
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7465080290590478 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5934342940889106 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7427205824416534 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7459183384023828 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5934342940889106 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7427480025844273 iter_best_prior_anomaly= 1170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7455394991884268 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5934342940889106 at iter 0
max_prior_anomaly= 0.7428085160029626 at iter 128
max_prior_star_anomaly= 0.7588294435602061 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5934342940889106
accuracies_anomaly['prior'][-1]= 0.7428078856548529
accuracies_anomaly['prior_star'][-1]= 0.7448626629055897



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.25719165802002 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5934342940889106
 first_prior_anomaly_auc= 0.7428018973478103
 first_prior_star_anomaly_auc= 0.7448149140362765


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5936763477630522; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7431876703909734; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.7453415698819673 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5929123658540429; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7434363427202673; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 200 
last prior star auc 0.7459738090360402 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5917263658855603; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7436421513780985; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 300 
last prior star auc 0.7465185873898861 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5904234363427203; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7438444931213262; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 400 
last prior star auc 0.7470617898734576 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5937475770994531 at iter 70
0.7439393605118426 at iter 490
0.7474762437556141 at iter 490
last anomaly aucs:
0.5893341948090833
0.7439393605118426
0.7474762437556141




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.56331014633179 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5892264052823172,first_prior_anomaly_auc= 0.7439664654805616, first_prior_star_anomaly_auc= 0.7475099673794854


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5892264052823172 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7481816032904172 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.745047197314717 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5892264052823172 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.750150022850119 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7441502119545519 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5892264052823172 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.751277242857368 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7438675008273319 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5892264052823172 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7518923050254502 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7435170272783145 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5892264052823172 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7523642781726209 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7433244559307879 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5892264052823172 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7525568495201475 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7428529555446995 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5892264052823172 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7528811636226106 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7426190963959847 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5892264052823172 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7531618261184739 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7424369257922688 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5892264052823172 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7532516507241124 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7419140520352365 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5892264052823172 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7534544652284223 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7418982933324929 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5892264052823172 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.753511826906409 iter_best_prior_anomaly= 1090
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7415040105898483 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5892264052823172 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7534264147375389 iter_best_prior_anomaly= 1180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7408686196952268 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5892264052823172 at iter 0
max_prior_anomaly= 0.7537324487448194 at iter 122
max_prior_star_anomaly= 0.7523021888838111 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5892264052823172
accuracies_anomaly['prior'][-1]= 0.7535423987897316
accuracies_anomaly['prior_star'][-1]= 0.7405922120491041



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.53220176696777 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5892264052823172
 first_prior_anomaly_auc= 0.7536010211639378
 first_prior_star_anomaly_auc= 0.7405903210047748


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5888418929353735; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7509154230423751; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7394276439163529 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5884324818380952; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7496922325354177; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.740481901129899 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5881195140016074; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7489213167972013; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7415276486439637 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5879048804702397; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7484706178987346; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7426896953842759 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5892264052823172 at iter 0
0.7536010211639378 at iter 0
0.7431646626849677 at iter 490
last anomaly aucs:
0.5877841688072238
0.7482386497943488
0.7431646626849677




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.616456031799316 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5877800715445105,first_prior_anomaly_auc= 0.7481834943347463, first_prior_star_anomaly_auc= 0.7430946940447861


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5877800715445105 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7502910632396742 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7440512473013221 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5877800715445105 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7521975510975938 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7432990844193705 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5877797563704557 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7529419922152008 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7421740706305057 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5877800715445105 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.753559890949777 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7418042138771137 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5877800715445105 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7539045337787793 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.741875600800542 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5877800715445105 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7541736924216398 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.741334762122382 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5877800715445105 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7542483886726445 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7414393999085995 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5877797563704557 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7548234237357581 iter_best_prior_anomaly= 750
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7408238649794349 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5877800715445105 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7549178183651923 iter_best_prior_anomaly= 750
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7414718628362513 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5877799139574831 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7545440219361141 iter_best_prior_anomaly= 750
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7401569566793262 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5877799139574831 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.754903320358668 iter_best_prior_anomaly= 1090
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7402871235639883 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5877797563704557 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.754579006256205 iter_best_prior_anomaly= 1090
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7398956773878373 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5877800715445105 at iter 0
max_prior_anomaly= 0.7556502828687142 at iter 109
max_prior_star_anomaly= 0.7481529224514238 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5877800715445105
accuracies_anomaly['prior'][-1]= 0.7549294798052224
accuracies_anomaly['prior_star'][-1]= 0.7415262303607166



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.42372941970825 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5877799139574831
 first_prior_anomaly_auc= 0.7546338465417526
 first_prior_star_anomaly_auc= 0.7401736609042343


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5833884362639268; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7380022692531951; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7364189923885466 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5851909166837386; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7374716737318185; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7382375466851568 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5865606631262115; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7394216556093103; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7417151772066124 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.587407535811652; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7394900483792174; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7422449847928518 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.58794112548655 at iter 490
0.7546338465417526 at iter 0
0.7438974423625446 at iter 470
last anomaly aucs:
0.58794112548655
0.7397358841420174
0.7433572340324944




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.59475898742676 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5879994326867013,first_prior_anomaly_auc= 0.7392801424586728, first_prior_star_anomaly_auc= 0.7425179255243708


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5879994326867013 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7426203570922043 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7474324345619868 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5879994326867013 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7387900468033473 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7417993286792632 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5879994326867013 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.739095135288463 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7415036954157933 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5879994326867013 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7393895078557133 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7422528641442236 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5879994326867013 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7395515073199175 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7420480010085568 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5879994326867013 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7397401389917582 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7423283483303654 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5879994326867013 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7394913090754369 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7424640307609878 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5879994326867013 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7394998187749184 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7416404809556076 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5879994326867013 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7375343933687378 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7419922152008447 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5879994326867013 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7385579211119341 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7411242258537277 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5879994326867013 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7396730069180706 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7422550703626077 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5879994326867013 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7381130529334825 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7407806861339175 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5879994326867013 at iter 0
max_prior_anomaly= 0.7483800053579589 at iter 2
max_prior_star_anomaly= 0.7476867800242684 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5879994326867013
accuracies_anomaly['prior'][-1]= 0.740626093260003
accuracies_anomaly['prior_star'][-1]= 0.7429270214475945



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.57633471488953 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5879994326867013
 first_prior_anomaly_auc= 0.739552452842082
 first_prior_star_anomaly_auc= 0.7414592558740565


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5816376443891139; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7188907449138787; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7315429345856249 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5833698409946894; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7302360653670991; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7397428179712247 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5839929401011709; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7243648454859196; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7360823864979436 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5842255385536662; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7306988984666782; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7371152118757585 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5879994326867013 at iter 0
0.739552452842082 at iter 0
0.7429720913374411 at iter 270
last anomaly aucs:
0.5845085648549411
0.7244185826622753
0.7361343902169972




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.57573223114014 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5844433238255826,first_prior_anomaly_auc= 0.7247832390437619, first_prior_star_anomaly_auc= 0.7363064752509574


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5844433238255826 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7410794711379359 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7465411223348094 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5844433238255827 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7277970909434736 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7399990544778354 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5844433238255826 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7266259041555699 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7401780733410026 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5844433238255826 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7258420662811037 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7404415588508754 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5844433238255826 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7260879020439037 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7409757788738831 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5844433238255826 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7260059567896372 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7401995051767338 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5844433238255826 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7258732685125361 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7406249901508107 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5844433238255826 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7255855146004382 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7402562365066108 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5844433238255826 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7250267110011503 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7395521376680272 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5844433238255826 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7248713301920986 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7391818081535528 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5844433238255826 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7243993570449281 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7393636635832139 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5844433238255826 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7251535685582362 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7401052681343272 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5844433238255827 at iter 20
max_prior_anomaly= 0.7480456056857399 at iter 3
max_prior_star_anomaly= 0.748848196416471 at iter 11
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5844433238255826
accuracies_anomaly['prior'][-1]= 0.723953228170257
accuracies_anomaly['prior_star'][-1]= 0.7385164757237184



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.44322419166565 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5844433238255826
 first_prior_anomaly_auc= 0.7238983878847094
 first_prior_star_anomaly_auc= 0.7386964401090502


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5795782971145815; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7176289455851994; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 40 
last prior star auc 0.7309119561277716 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5799057629575933; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7255023086499519; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 130 
last prior star auc 0.7374886931307815 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5803977496572481; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7215850103219503; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 130 
last prior star auc 0.736457443623241 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5804932473958744; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7225601588477236; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 390 
last prior star auc 0.736051499440566 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5844433238255826 at iter 0
0.7353470854279276 at iter 390
0.7444672770537529 at iter 420
last anomaly aucs:
0.5809726271333344
0.7261728414516917
0.7363874749830593




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.57691693305969 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5809953196652852,first_prior_anomaly_auc= 0.7214135556361001, first_prior_star_anomaly_auc= 0.7365195329120506


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5809953196652852 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7421677671494082 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7415323762547867 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5809953196652852 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7261178435791166 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7398190900925037 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5809951620782577 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7228174984635264 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7388351166931939 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5809951620782577 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7228419244527791 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7397434483193344 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5809953196652852 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7231265266243283 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7397989189529919 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5809951620782577 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7229536536552312 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7386201679877713 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5809953196652852 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7230132215516019 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7391562790551082 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5809953196652852 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7234190081472492 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7402244039270688 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5809953196652851 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7223382763130939 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7376859920891312 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5809953196652852 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.721750476700758 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7373251177963029 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5809953196652852 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7217794727138062 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7391153064279748 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5809951620782577 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.723397261137463 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7409549773862616 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5809953196652852 at iter 0
max_prior_anomaly= 0.7448376065682273 at iter 3
max_prior_star_anomaly= 0.7470115196117055 at iter 12
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5809953196652852
accuracies_anomaly['prior'][-1]= 0.72157334888192
accuracies_anomaly['prior_star'][-1]= 0.7368728430275621



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.84742784500122 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5809953196652852
 first_prior_anomaly_auc= 0.7213613943300188
 first_prior_star_anomaly_auc= 0.7362402886994343


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5722451423798793; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7123214145011583; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 20 
last prior star auc 0.721086404967143 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5743246607939234; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7115104716579731; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 190 
last prior star auc 0.7235047354901745 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5737519895362213; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.716688151031407; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 190 
last prior star auc 0.7263860566998124 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5741725893124477; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7201046377862175; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 190 
last prior star auc 0.730271837622327 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5809953196652852 at iter 0
0.724282585057598 at iter 190
0.7362402886994343 at iter 0
last anomaly aucs:
0.5753489764722568
0.7136470365759491
0.7267207715460864




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.60677695274353 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5749455536820209,first_prior_anomaly_auc= 0.7203009912224027, first_prior_star_anomaly_auc= 0.7317749026900104


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5749455536820209 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7386573585262461 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7380815355279953 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5749455536820209 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7263580062089288 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7375359692390122 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5749455536820209 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.723202325984525 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7353962525804876 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5749455536820209 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7219394235466536 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7348938651370219 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5749455536820209 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7220215263879477 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7344973761759932 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5749455536820209 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7218213908631042 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7351340277668342 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5749455536820209 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7212260270734512 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7346830136943128 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5749455536820209 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7213495753029611 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7349817986983311 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5749455536820209 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7210823077044299 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7342947192587106 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5749455536820209 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7206234142805366 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.733725830089667 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5749455536820209 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7210605606946436 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7346919961548766 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5749455536820209 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7205558094457665 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7346833288683676 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5749455536820209 at iter 0
max_prior_anomaly= 0.7412564413697463 at iter 3
max_prior_star_anomaly= 0.7456025339994012 at iter 14
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5749455536820209
accuracies_anomaly['prior'][-1]= 0.7202858628677686
accuracies_anomaly['prior_star'][-1]= 0.7341469026269758



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.55658078193665 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5749455536820209
 first_prior_anomaly_auc= 0.7207854137447406
 first_prior_star_anomaly_auc= 0.7345430764139496


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5731985438958664; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7205071150542888; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 60 
last prior star auc 0.7261802480419812 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5736807601998204; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7185539814362482; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 60 
last prior star auc 0.7272902910632397 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5742263264888035; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7221535843169391; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 60 
last prior star auc 0.7283436027546213 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5735625699292434; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7202680555336685; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 60 
last prior star auc 0.7274809713664371 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5750993586207983 at iter 470
0.7274667885339678 at iter 60
0.7345430764139496 at iter 0
last anomaly aucs:
0.5746555935515388
0.7122296988511907
0.7223987897316293




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.586950063705444 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5741295680539578,first_prior_anomaly_auc= 0.7136344296137542, first_prior_star_anomaly_auc= 0.7236093732763919


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5741295680539578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7430592369636131 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7380251193721734 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5741295680539578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7243273397733899 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7328468096506295 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5741295680539578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7246954630694801 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7379217422821753 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5741295680539578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7208711410876657 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.733802102210946 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5741295680539578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7222389964858094 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7368120144349717 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5741295680539578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7234275178467309 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7371011866303165 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5741295680539578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7235712372157523 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7366062057771403 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5741295680539578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7205332745008431 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7335247490426587 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5741295680539578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7226233512457254 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7366109333879636 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5741295680539578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7233550278141103 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.737272641316167 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5741295680539578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7225642561104371 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7369620372850907 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5741295680539578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7211209165261516 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7339313235734435 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5741295680539578 at iter 0
max_prior_anomaly= 0.7460124178577618 at iter 3
max_prior_star_anomaly= 0.7448688087996596 at iter 14
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5741295680539578
accuracies_anomaly['prior'][-1]= 0.720806215232362
accuracies_anomaly['prior_star'][-1]= 0.7346537025072096



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.3002610206604 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5741295680539578
 first_prior_anomaly_auc= 0.7205056967710418
 first_prior_star_anomaly_auc= 0.7336432544872906


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5639103644987944; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7030010873504893; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7114981798698331 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5661969522668895; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7066917755330382; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7156452400838363 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5667623745213294; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7002158942275872; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7139247049182911 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5652788502450479; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6971784042737601; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.712294939880549 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5741295680539578 at iter 0
0.7205056967710418 at iter 0
0.7336432544872906 at iter 0
last anomaly aucs:
0.5661752052571032
0.7042712387916227
0.7148604566872054




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.60281825065613 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5668194210252613,first_prior_anomaly_auc= 0.7029052744378084, first_prior_star_anomaly_auc= 0.7140501441921301


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5668194210252613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.73734497376176 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7343618513323984 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5668194210252613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.723899333406874 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7287422979340341 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5668194210252613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7134371306554044 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7210192728934555 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5668194210252613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7111833209890162 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7208525458184283 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5668194210252613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7112657390043651 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7222263895236144 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5668194210252613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7123485194698772 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7223089651259909 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5668194210252613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7117685992089131 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7230322895819217 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5668194210252613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.711502119545519 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.722859259025797 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5668194210252613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7104079928140314 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7214132404620452 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5668194210252613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7110994846904203 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7226449406684841 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5668194210252613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7109270844824054 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7229434104984478 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5668194210252613 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7104016893329341 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7210151756307421 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5668194210252613 at iter 0
max_prior_anomaly= 0.7389777329530232 at iter 4
max_prior_star_anomaly= 0.7409537166900421 at iter 17
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5668194210252613
accuracies_anomaly['prior'][-1]= 0.7097588918480231
accuracies_anomaly['prior_star'][-1]= 0.7210227398080591



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.39643096923828 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5668194210252613
 first_prior_anomaly_auc= 0.7098080590005832
 first_prior_star_anomaly_auc= 0.7218923050254502


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5707048867737208; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.7112400523188931; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 40 
last prior star auc 0.7232598452495391 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5721253762390279; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.7169024693887199; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 40 
last prior star auc 0.7243881683659801 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.570407047291867; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.710881384244449; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 40 
last prior star auc 0.721148179081898 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5696058748443829; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.7035230155853571; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 40 
last prior star auc 0.7191589580345746 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5733826055439116 at iter 480
0.7237426919016027 at iter 40
0.7303679657090628 at iter 40
last anomaly aucs:
0.5731802638006839
0.7043048048284665
0.7177480813779409




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.6019868850708 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5725874214034701,first_prior_anomaly_auc= 0.7067002852325197, first_prior_star_anomaly_auc= 0.7193479048804702


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5725874214034701 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7409852340955293 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7379633452574184 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5725874214034701 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7220820398064831 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7316939029579085 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5725874214034701 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7143413650188316 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7274995666356746 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5725874214034701 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7135401925713476 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7289739508643649 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5725874214034701 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7138865688576516 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7293011015333217 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5725874214034701 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7151901287486014 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7294359960288068 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5725874214034701 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7141024630852388 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7303150164678445 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5725874214034701 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7143155207463321 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.72909655357171 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5725874214034701 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7141900814724931 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7307304158721653 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5725874214034701 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7152868871834471 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7308725593709127 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5725874214034701 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7143939990859952 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7299328679263123 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5725874214034701 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7131471705249224 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7298126290243787 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5725874214034701 at iter 0
max_prior_anomaly= 0.7437924894022725 at iter 4
max_prior_star_anomaly= 0.7438262130261437 at iter 15
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5725874214034701
accuracies_anomaly['prior'][-1]= 0.7157131600926611
accuracies_anomaly['prior_star'][-1]= 0.7334172746899476



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.58217334747314 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5725874214034701
 first_prior_anomaly_auc= 0.7159947681106891
 first_prior_star_anomaly_auc= 0.7328070977197156


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.571476117685992; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7169116094363113; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 70 
last prior star auc 0.7276741730620736 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5695472524701767; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7091397324172275; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 150 
last prior star auc 0.722714278960556 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5683253226594387; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7136412058559339; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 220 
last prior star auc 0.7270507587815371 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5664812392643837; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7144819326473044; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 220 
last prior star auc 0.72624422837512 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5725874214034701 at iter 0
0.7252697101974566 at iter 480
0.734721464929007 at iter 480
last anomaly aucs:
0.5672606647020817
0.7067136801298517
0.720614589407




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.596912145614624 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5673282695368518,first_prior_anomaly_auc= 0.7117145468585026, first_prior_star_anomaly_auc= 0.7270069495879099


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5673282695368518 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7412510834108136 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7347274532360496 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5673282695368518 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7298041193248972 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7358037726334369 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5673282695368518 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7182211576343036 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7297436059063618 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5673282695368518 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7176409221992845 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7320383881998833 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5673282695368518 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7168370707723339 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.730578817151772 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5673282695368518 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.7173184991411506 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7324172274138393 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5673282695368518 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.7159443402619097 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7292500433364326 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5673282695368518 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.7150454638574153 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7290927714830515 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5673281119498244 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.7151293001560112 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7317692295570228 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5673282695368518 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.7161088611185528 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7324744315047986 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5673282695368518 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.7147501457680003 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7300590951352884 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5673282695368518 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.7137712151535686 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7278853396788376 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5673284271238792 at iter 51
max_prior_anomaly= 0.7431731723844494 at iter 4
max_prior_star_anomaly= 0.7410145452826324 at iter 16
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5673282695368518
accuracies_anomaly['prior'][-1]= 0.713681705721985
accuracies_anomaly['prior_star'][-1]= 0.728916904360433



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.31041193008423 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5673282695368518
 first_prior_anomaly_auc= 0.7129813889720599
 first_prior_star_anomaly_auc= 0.727943331704934


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5651411191830689; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7031756937768883; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 70 
last prior star auc 0.717502245615141 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5642868399073389; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6991658918637818; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 70 
last prior star auc 0.7151116504089383 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5631217990135051; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.705733331232173; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 70 
last prior star auc 0.7176954473107774 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5624318830073909; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7073780670375215; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 70 
last prior star auc 0.7163877901571143 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5673733394266984 at iter 10
0.7164369573096743 at iter 70
0.727943331704934 at iter 0
last anomaly aucs:
0.5641782624454355
0.7139169831539467
0.7274967300691807




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.60481071472168 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5639084734544653,first_prior_anomaly_auc= 0.709498558078699, first_prior_star_anomaly_auc= 0.7216061269836267


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5639084734544653 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7396314039428274 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.733958270955135 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5639084734544653 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7294845328332572 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7335527995335425 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5639084734544653 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7138172305655799 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7234399672218983 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5639084734544653 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7119937910711189 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7259385095418945 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5639084734544653 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.709456955103456 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.723840080684558 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5639084734544653 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7100442819547095 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7256661991584853 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5639084734544653 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7092166348866161 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7251319791354776 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5639084734544653 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.708594796476354 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7233707865168539 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5639084734544653 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.708545629323794 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7254244606583986 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5639084734544653 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.709167467734056 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7257188332256488 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5639084734544653 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.708366295286572 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7251200025213924 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5639084734544653 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7090276880407205 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.726787903619774 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5639084734544653 at iter 0
max_prior_anomaly= 0.7409597049970846 at iter 5
max_prior_star_anomaly= 0.7393850954189451 at iter 17
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5639084734544653
accuracies_anomaly['prior'][-1]= 0.7078065461651196
accuracies_anomaly['prior_star'][-1]= 0.7246893171754101



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.17536354064941 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5639084734544653
 first_prior_anomaly_auc= 0.7067560710402321
 first_prior_star_anomaly_auc= 0.7229916321288431


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5603202168397498; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7153514978646958; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 40 
last prior star auc 0.7184586412846494 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5622314323084924; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7055968608664135; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 40 
last prior star auc 0.7174294404084656 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5619310714341996; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7000762721212791; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 40 
last prior star auc 0.7087372551491562 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5619895362213783; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7072915517594591; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 40 
last prior star auc 0.7173534834612414 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5639084734544653 at iter 0
0.716007375072884 at iter 40
0.7240449438202248 at iter 40
last anomaly aucs:
0.5613019840206754
0.7108142521707612
0.7182731613533575




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.578253984451294 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5616575003545707,first_prior_anomaly_auc= 0.7097662984383124, first_prior_star_anomaly_auc= 0.7198997746505508


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5616575003545707 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.739744393841499 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.733718581086405 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5616575003545707 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7293534204264305 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7327815686212711 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5616575003545707 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7135852624611941 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7255146004380919 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5616575003545707 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.716038104543234 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7277457175725295 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5616575003545707 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.715093843074838 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7269656617867217 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5616575003545707 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7154094898907922 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7281469341443813 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5616575003545707 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7151658603463763 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7291223978442094 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5616575003545707 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7160231337756275 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7302794017996438 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5616575003545707 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7189570890524293 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7336129977780229 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5616575003545707 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.715505933151583 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7298000220621839 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5616575003545707 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7166017933403721 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7319099547725231 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5616575003545707 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.7156600532644153 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7328089887640449 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5616575003545708 at iter 8
max_prior_anomaly= 0.7411943520809366 at iter 5
max_prior_star_anomaly= 0.7389690656665144 at iter 17
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5616575003545707
accuracies_anomaly['prior'][-1]= 0.717998644751564
accuracies_anomaly['prior_star'][-1]= 0.7334021463353138



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.19851589202881 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5616575003545707
 first_prior_anomaly_auc= 0.7156159288967332
 first_prior_star_anomaly_auc= 0.7299213640733094


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5615372614526372; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7076881983075153; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7198881132105205 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5638473296878201; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7073318940384827; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7193841498967805 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5658887120412248; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7170345273177112; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 300 
last prior star auc 0.722532423530895 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5665007800557857; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.7028075704807981; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 300 
last prior star auc 0.7179885591818082 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5674174637943805 at iter 340
0.7170345273177112 at iter 300
0.7299213640733094 at iter 0
last anomaly aucs:
0.5657200939218683
0.7053792331815245
0.7203782088658461




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.57857584953308 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5654121688702587,first_prior_anomaly_auc= 0.7127683313109664, first_prior_star_anomaly_auc= 0.7249702948453283


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5654121688702586 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.740590321004775 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7332262792126953 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5654121688702587 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7320634445372456 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7339781269205918 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5654120112832312 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.720056416155822 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7259479647635406 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5654121688702587 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7173257481444127 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7266236979371858 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5654120112832312 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7197622011755993 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7302426840222512 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5654120112832312 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7181879067715145 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7288790834738484 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5654121688702587 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7180805900058307 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7274585940085412 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5654120112832312 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7188694706651748 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7274604850528704 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5654120112832312 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7164925855303591 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7248276785854988 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5654120112832312 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7182290369856753 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7266788533967884 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5654120112832312 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.71652142395638 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7266618339978252 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5654118536962037 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.718010936539704 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7277862174385804 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5654121688702587 at iter 0
max_prior_anomaly= 0.742441338229037 at iter 5
max_prior_star_anomaly= 0.7365148053012277 at iter 17
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5654116961091763
accuracies_anomaly['prior'][-1]= 0.7192026096411743
accuracies_anomaly['prior_star'][-1]= 0.7305551790976565



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.41028690338135 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5034448524197488
accuracies_anomaly["prior"][-1]= 0.716593756401973
accuracies_anomaly["prior_star"][-1]= 0.5069016814535827


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam Flickr 
took 2640.643723011017 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on Flickr on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.003332376480102539 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4968290338339348
 first_prior_anomaly_auc= 0.7185930630190523
 first_prior_star_anomaly_auc= 0.5004316308681469


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5130592369636131; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7335909355941819; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5215229210331405 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5232250185164757; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7400915580629404; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5411642529586964 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5373293726460437; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.744500527916542; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5719473028980255 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5559380367808122; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.7483199647005059; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6065751611327356 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5692736813905479 at iter 490
0.7507283672408087 at iter 490
0.6282796224214823 at iter 490
last anomaly aucs:
0.5692736813905479
0.7507283672408087
0.6282796224214823




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.600102186203 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5703065067683628,first_prior_anomaly_auc= 0.7509138471721007, first_prior_star_anomaly_auc= 0.6299705312258694


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5703065067683628 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7448667601683029 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6302598610082418 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5703065067683628 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7111699260916842 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6310017807334101 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5703065067683628 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6669177553303812 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6372850906913343 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5703065067683628 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.682985801408828 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6802984698299637 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5703065067683628 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7416611248562018 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7126580203917613 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5703065067683628 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7420662811037396 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7361633862300455 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5703065067683628 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7424303071371164 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7440462045164442 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5703065067683628 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7416092787241754 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7439270687237027 iter_best_prior_star_anomaly= 740
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5703065067683628 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7406334998502924 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7427451660179334 iter_best_prior_star_anomaly= 740
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5703065067683628 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7402581275509399 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7418598420977985 iter_best_prior_star_anomaly= 740
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5703065067683628 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7401276454922232 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7412525016940605 iter_best_prior_star_anomaly= 740
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5703065067683628 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7400006303481097 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.740812361126432 iter_best_prior_star_anomaly= 740
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5703065067683628 at iter 0
max_prior_anomaly= 0.751113509935862 at iter 1
max_prior_star_anomaly= 0.7442570559591534 at iter 74
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5703065067683628
accuracies_anomaly['prior'][-1]= 0.7399475235198638
accuracies_anomaly['prior_star'][-1]= 0.740137731061979



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.46446681022644 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5703065067683628
 first_prior_anomaly_auc= 0.7399492569771655
 first_prior_star_anomaly_auc= 0.740071544510456


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5839513371259277; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7398551775217863; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 20 
last prior star auc 0.7488324377137274 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5900206439005942; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7395234568290339; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 20 
last prior star auc 0.7528540586538917 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5922278078068614; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7390443922656289; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 20 
last prior star auc 0.7549285342830578 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5925549584758183; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.7385429503443276; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 20 
last prior star auc 0.7562339852183368 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5926194115700396 at iter 380
0.7399615487653057 at iter 20
0.7571171029200876 at iter 490
last anomaly aucs:
0.592310068235183
0.738156231779
0.7571171029200876




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.58688569068909 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5922467182501536,first_prior_anomaly_auc= 0.7381187260664701, first_prior_star_anomaly_auc= 0.7572012543927383


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5922467182501536 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7447074396835651 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7544138550514522 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5922465606631262 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7456053705658949 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7536454607056747 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5922465606631262 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7460283341475329 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7528423972138614 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5922467182501536 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7463479206391729 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7521471232488142 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5922467182501536 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7466082544084971 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7515259151866618 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5922467182501536 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.746775611831634 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.750913216823991 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5922465606631262 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7468837165324551 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7503430669587279 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5922467182501536 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7469691287013251 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7497095671084356 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5922467182501536 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7470866886237923 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7491888995697874 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5922467182501536 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7470725057913233 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.748521360921569 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5922467182501536 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7471768284034858 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7479639756055282 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5922465606631262 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.747309201506532 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7474179365554627 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5922467182501536 at iter 0
max_prior_anomaly= 0.747360890051531 at iter 126
max_prior_star_anomaly= 0.7572012543927383 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5922465606631262
accuracies_anomaly['prior'][-1]= 0.7473517500039397
accuracies_anomaly['prior_star'][-1]= 0.7468960083205951



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.20810103416443 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5922465606631262
 first_prior_anomaly_auc= 0.7473173960319586
 first_prior_star_anomaly_auc= 0.7468575570859006


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5932543297035788; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7474491387868949; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 90 
last prior star auc 0.7475005121578392 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5931550498762942; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7473098318546416; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 110 
last prior star auc 0.7480739713506784 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5924273129835952; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7470685661156373; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 110 
last prior star auc 0.7485585514600438 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5913636005484029; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.7467658414359329; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 110 
last prior star auc 0.7489427486329325 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5932978237231511 at iter 110
0.7474626912712544 at iter 110
0.7492100162314638 at iter 490
last anomaly aucs:
0.5904057865956474
0.7464993617725388
0.7492100162314638




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.617424726486206 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5903115495532408,first_prior_anomaly_auc= 0.746480608916274, first_prior_star_anomaly_auc= 0.7492456308996643


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5903115495532408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7529741399687978 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7474399987393038 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5903115495532408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7547148462738547 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7468364404242243 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5903115495532408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7553763966150306 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7465657059110893 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5903115495532408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7557401074743526 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7461156373607325 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5903115495532408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.756158501032195 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7460188789258868 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5903115495532408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7563153001244938 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7456028491734561 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5903115495532408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7565746883716533 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7453295932678822 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5903115495532408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7566430811415604 iter_best_prior_anomaly= 780
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7450995162078258 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5903115495532408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7567366878358572 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7447348598263391 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5903115495532408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7569037300849394 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7445495374820745 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5903115495532408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7567379485320768 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7437704272184313 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5903115495532408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7569005783443907 iter_best_prior_anomaly= 1120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7436267078494099 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5903115495532408 at iter 0
max_prior_anomaly= 0.756966134547804 at iter 112
max_prior_star_anomaly= 0.7512369005783444 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5903115495532408
accuracies_anomaly['prior'][-1]= 0.756901051105473
accuracies_anomaly['prior_star'][-1]= 0.7433537671178909



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.2324230670929 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5903115495532408
 first_prior_anomaly_auc= 0.7568763099421656
 first_prior_star_anomaly_auc= 0.7433559733362749


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5896654427407536; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7543180421387712; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7410120238901934 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5891472965945443; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7520925981373213; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.741605496635517 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5888024961785147; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7508662558898151; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7425481822336386 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.588607088264494; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7499784105772412; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7432166664040216 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5903115495532408 at iter 0
0.7568763099421656 at iter 0
0.7445381912160991 at iter 490
last anomaly aucs:
0.5885018201301668
0.7505485604425044
0.7445381912160991




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.62148571014404 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5884983532155633,first_prior_anomaly_auc= 0.7490691334289361, first_prior_star_anomaly_auc= 0.7436024394471847


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5884983532155633 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7514237987928833 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7420347636982524 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5884983532155633 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7508939912066438 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7405550215106292 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5884983532155633 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7508325322659439 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7401604235939298 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5884983532155633 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7526260302251919 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7408758686984888 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5884983532155633 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7530146398348487 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7407381376365098 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5884983532155633 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7527248372913942 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.740108104700821 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5884983532155633 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7531301511259593 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.739916478875459 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5884983532155633 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7540926926895378 iter_best_prior_anomaly= 740
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7398591171974723 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5884983532155633 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7540173660904235 iter_best_prior_anomaly= 740
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7402001355248435 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5884983532155633 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7539306932253337 iter_best_prior_anomaly= 930
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7393463290101959 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5884983532155633 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7556896796255732 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.740688655309895 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5884983532155633 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7548568321855744 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7401200813149061 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5884983532155633 at iter 0
max_prior_anomaly= 0.7564599650156798 at iter 108
max_prior_star_anomaly= 0.7537083379296217 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5884983532155633
accuracies_anomaly['prior'][-1]= 0.7552219613281435
accuracies_anomaly['prior_star'][-1]= 0.7401248089257293



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 118.8499641418457 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5884983532155633
 first_prior_anomaly_auc= 0.753975290354098
 first_prior_star_anomaly_auc= 0.7392505160975149


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5882512567565439; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7446833288683676; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7396990087775974 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5885509872827268; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.7447856028491735; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7414140283971824 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5887318971902233; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.7424605638463841; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7414646138329892 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.588872779992751; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.741519454118537; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7408411995524529 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5890577871629608 at iter 490
0.753975290354098 at iter 0
0.7449529602723104 at iter 470
last anomaly aucs:
0.5890577871629608
0.7456895220385458
0.7439447184707755




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.685302734375 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5891183005814962,first_prior_anomaly_auc= 0.7446872685440535, first_prior_star_anomaly_auc= 0.7445924011535371


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5891183005814962 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7368441621885686 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7382964842334179 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5891183005814962 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7405865389161164 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7407614605165703 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5891183005814962 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.740724112391068 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.741467450399483 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5891183005814962 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7402508785476779 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7413612367429914 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5891183005814962 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7396589816726288 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7415998235025293 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5891183005814962 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7422408875301385 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7427747923790913 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5891183005814962 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7425919914272656 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7426811856847944 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5891183005814962 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7409294482878169 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7424983847329687 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5891183005814962 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.74173314212774 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7432878957404225 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5891183005814962 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7438336196164332 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.746001229178814 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5891183005814962 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7413290889893944 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7426912712545504 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5891183005814962 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.74249523299242 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7433666892541406 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5891183005814962 at iter 0
max_prior_anomaly= 0.7477857446774983 at iter 5
max_prior_star_anomaly= 0.7523548229509747 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5891183005814962
accuracies_anomaly['prior'][-1]= 0.7421948721181273
accuracies_anomaly['prior_star'][-1]= 0.7435394046362103



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.4171416759491 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5891183005814962
 first_prior_anomaly_auc= 0.742487983989158
 first_prior_star_anomaly_auc= 0.7438864112706242


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5896219487211813; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.735614353026459; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7432544872906062 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5899965330853965; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7383270561167405; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7444196857714673 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5902545030493089; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.7354822950974677; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7422768173723939 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5905375293505839; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.7326116898056952; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7411513308224467 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.590800069338292 at iter 380
0.742487983989158 at iter 0
0.7476845738058844 at iter 440
last anomaly aucs:
0.5904722883212253
0.734463337378067
0.7432614211198134




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.613494634628296 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.590551712183053,first_prior_anomaly_auc= 0.7345569440723639, first_prior_star_anomaly_auc= 0.7435365680697165


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.590551712183053 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7436892698993017 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7449797500669745 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.590551712183053 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7335991301196085 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7429629512898499 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.590551712183053 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.731279449075752 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7423319728319964 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.590551712183053 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.7301233906424823 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7413769954457349 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.590551712183053 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.7307521628819516 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7423395370093134 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.590551712183053 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.730519879603511 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.741716122728777 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.590551712183053 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.7299391714074097 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7416426871739918 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.590551712183053 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.729211592101738 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7410964905368989 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.590551712183053 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.7307983358809902 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7418604724459082 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5905517121830531 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.7328683990733882 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7462826796098145 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.590551712183053 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.7317506342877854 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7450145768000378 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.590551712183053 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.729167782908111 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7419424177001749 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5905517121830531 at iter 33
max_prior_anomaly= 0.7436892698993017 at iter 10
max_prior_star_anomaly= 0.7480473391430418 at iter 13
last values
accuracies_anomaly['vanilla_star'][-1]= 0.590551712183053
accuracies_anomaly['prior'][-1]= 0.7288567061159525
accuracies_anomaly['prior_star'][-1]= 0.741245095103771



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.01459670066833 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.590551712183053
 first_prior_anomaly_auc= 0.727196054020833
 first_prior_star_anomaly_auc= 0.7407549994484454


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5897064153678868; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7303771057566542; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 40 
last prior star auc 0.7402250342751784 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5897079912381613; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7268137478922735; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 40 
last prior star auc 0.7352027357107963 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5900291536000757; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7207951841404414; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 40 
last prior star auc 0.7351044014056763 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5900520037190539; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7288951573506469; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 380 
last prior star auc 0.7387145626172054 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.590551712183053 at iter 0
0.7352994941456419 at iter 380
0.7454610208487638 at iter 380
last anomaly aucs:
0.5899809319696803
0.7247085427927573
0.7357646910506326




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.59241271018982 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5897098822824904,first_prior_anomaly_auc= 0.7259422916305529, first_prior_star_anomaly_auc= 0.7385760436200891


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5897100398695179 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7361613375986888 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7349297949792772 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5897098822824904 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7268449501237059 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7372879272578281 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5897098822824904 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7253937311880485 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7366717619805537 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5897098822824904 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7234142805364262 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7355390264273445 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5897098822824904 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7228494886300958 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7354120112832312 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5897098822824904 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.722810091873237 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7360644215768157 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5897098822824904 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7258965913925965 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7386630316592337 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5897098822824904 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.724992199442142 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7377903147012937 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5897098822824904 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7253945191231859 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7370053737176354 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5897098822824904 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7277624217974377 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.741209638022598 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5897098822824904 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7247228832122539 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7360165151204753 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5897098822824904 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7270217627684888 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7388773500165466 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5897100398695179 at iter 1
max_prior_anomaly= 0.7369640859164474 at iter 8
max_prior_star_anomaly= 0.7431132893140237 at iter 18
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5897098822824904
accuracies_anomaly['prior'][-1]= 0.7256340514048882
accuracies_anomaly['prior_star'][-1]= 0.7372040909592322



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.27143859863281 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5897098822824904
 first_prior_anomaly_auc= 0.7277529665757915
 first_prior_star_anomaly_auc= 0.7396314039428273


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5928386151252029; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.7298154655908726; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 20 
last prior star auc 0.7404488078541375 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5931061978977891; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.7188879083473848; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 170 
last prior star auc 0.736619443087445 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5929432529114202; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.7186299383834722; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 170 
last prior star auc 0.7321609909072285 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5932079991175127; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.7246333737806704; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 170 
last prior star auc 0.735143325401453 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5938194367839639 at iter 410
0.7362481680508062 at iter 170
0.7459823187355217 at iter 350
last anomaly aucs:
0.593034968561388
0.7325456608411995
0.7408008572734293




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.59260606765747 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5930233071213578,first_prior_anomaly_auc= 0.7265559355153883, first_prior_star_anomaly_auc= 0.738138897205982


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5930233071213578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7355759017917645 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7399990544778354 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5930233071213578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7266550577556455 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.738822509730999 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5930233071213578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7270236538128182 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7385022928912491 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5930233071213578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.726728966071513 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7388303890823706 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5930233071213578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7285910143876957 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7420886584616355 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5930233071213578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7274210882960115 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7392410608758686 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5930233071213578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7246680429267063 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7381935799045023 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5930233071213578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7267017035157667 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7388902721527963 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5930233071213578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7275852939785996 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7405042784877949 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5930233071213578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7291989851395433 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7402006082859258 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5930233071213578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.729946105236617 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7437026647966339 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5930233071213578 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7270252296830925 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.73775060277038 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5930233071213578 at iter 0
max_prior_anomaly= 0.7404607844682226 at iter 15
max_prior_star_anomaly= 0.7526469892998408 at iter 15
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5930233071213578
accuracies_anomaly['prior'][-1]= 0.7262393431772697
accuracies_anomaly['prior_star'][-1]= 0.7389000425484973



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.19293284416199 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5930233071213578
 first_prior_anomaly_auc= 0.7285016625431394
 first_prior_star_anomaly_auc= 0.7434086074034385


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5929215059016342; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.7236229257607513; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.7333280804324187 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5930064453094221; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.7203993255275225; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 180 
last prior star auc 0.7324279433317049 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5930781474069055; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 230 
last prior auc 0.7212956805395779; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 180 
last prior star auc 0.7330053422002301 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5930538790046803; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 230 
last prior auc 0.7262229541264162; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 180 
last prior star auc 0.7337636509762516 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5936104763855838 at iter 230
0.7319447815055865 at iter 180
0.7434086074034385 at iter 0
last anomaly aucs:
0.5927364987314244
0.7153711962431253
0.7314275808815418




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.56969237327576 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5925760751374947,first_prior_anomaly_auc= 0.7290801645208567, first_prior_star_anomaly_auc= 0.7365828828970798


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5925760751374947 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7361643317522102 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7386873000614589 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5925760751374947 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7344124367682053 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7400028365664939 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5925760751374947 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7282077627369715 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.738232188726224 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5925760751374947 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7274069054635423 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.739354365948595 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5925760751374947 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7294142490190207 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7397592070220779 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5925760751374947 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.7299141150700474 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7399930661707927 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5925760751374947 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.7309671115873742 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7396772617678112 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5925760751374947 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.7319595946861656 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.742754463652552 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5925760751374947 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.7324411806420096 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7418500717020975 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5925760751374947 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.7324555210615062 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7428513796744252 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5925760751374947 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.7328597317868795 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.742070063192398 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5925760751374947 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.7312066438690766 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.741755519485636 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5925762327245221 at iter 52
max_prior_anomaly= 0.739372015695668 at iter 18
max_prior_star_anomaly= 0.7463031659233812 at iter 18
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5925760751374947
accuracies_anomaly['prior'][-1]= 0.7305584884252329
accuracies_anomaly['prior_star'][-1]= 0.7400475912822857



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.31502485275269 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5925760751374947
 first_prior_anomaly_auc= 0.7315659422916305
 first_prior_star_anomaly_auc= 0.7416212553382604


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5934475313992152; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7254194178735206; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 60 
last prior star auc 0.7344778353845912 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5935042627290922; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.716287564807665; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 60 
last prior star auc 0.7335058385993665 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5936397875726871; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.7167760845927162; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 60 
last prior star auc 0.7325593709125864 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5934714846273854; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.71913342893613; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 360 
last prior star auc 0.7337844524638731 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5940863892084404 at iter 10
0.7366262193296247 at iter 360
0.7454452621460201 at iter 60
last anomaly aucs:
0.5937327639188742
0.719193469593583
0.7329328521676095




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.57925510406494 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5938805805506091,first_prior_anomaly_auc= 0.7228305781868036, first_prior_star_anomaly_auc= 0.7361394330018752


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5938805805506091 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7354707912444648 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7387156657263974 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5938805805506091 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7289799391714074 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7396949115148841 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5938804229635817 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.724339316387475 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7397588918480231 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5938802653765543 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7279272578281355 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7412124745890919 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5938805805506091 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7295693146540176 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.742272877696708 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5938804229635817 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7295931102951605 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7414598862221662 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5938805805506091 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.727574262886679 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7377342137195266 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5938805805506091 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7310972784720362 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7430649100966007 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5938805805506091 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7300792662748002 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7412736183557369 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5938804229635817 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7317772664954221 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.743043320673842 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5938804229635817 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7310930236222953 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7415128354633846 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5938805805506091 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7319145247963188 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7441872449059993 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5938805805506091 at iter 0
max_prior_anomaly= 0.7387150353782876 at iter 5
max_prior_star_anomaly= 0.7471519296531508 at iter 17
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5938805805506091
accuracies_anomaly['prior'][-1]= 0.7305966244858724
accuracies_anomaly['prior_star'][-1]= 0.743011803268355



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.5107774734497 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5938805805506091
 first_prior_anomaly_auc= 0.7314707597270593
 first_prior_star_anomaly_auc= 0.7428479127598216


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5945399246734009; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.7158097609404794; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7294000661865514 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5949332618938808; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7186207983358809; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7331695478828183 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5947183131884584; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.7098189325054761; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7315631057251366 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5940599145878311; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.7139719810265219; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7291551759459161 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5951781521345163 at iter 220
0.7314707597270593 at iter 0
0.7428479127598216 at iter 0
last anomaly aucs:
0.594406921222245
0.7196640244575065
0.7303700143404195




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.58880686759949 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5942342058401753,first_prior_anomaly_auc= 0.7200742234899223, first_prior_star_anomaly_auc= 0.7350419969428117


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5942342058401752 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.738079959657721 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7401134626597539 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5942342058401753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7313866082544085 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.740943946294341 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5942342058401753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7238536331689176 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.741804371464141 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5942342058401752 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7198441464298659 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7383538459114045 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5942342058401753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7188023385914871 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7380497029484533 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5942342058401753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7180493877743983 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7375435334163292 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5942342058401753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7181366909875978 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7384219235072569 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5942342058401753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7181990954504625 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.737679058259924 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5942342058401752 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7201307972327717 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.738098082165876 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5942342058401752 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.720435255369778 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7400986494791748 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5942342058401753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7189000425484975 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7380457632727674 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5942342058401753 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7198353215563296 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7404406133287108 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5942342058401753 at iter 0
max_prior_anomaly= 0.7384011220196354 at iter 9
max_prior_star_anomaly= 0.742320941740076 at iter 31
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5942342058401752
accuracies_anomaly['prior'][-1]= 0.7195615928896733
accuracies_anomaly['prior_star'][-1]= 0.7387144050301779



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.16238236427307 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5942342058401753
 first_prior_anomaly_auc= 0.7180298469829963
 first_prior_star_anomaly_auc= 0.7385943237152717


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.594537088106907; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.724565611358873; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 40 
last prior star auc 0.7365939139890004 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5940595994137763; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7177836960461415; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 40 
last prior star auc 0.7321836834391793 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5944983216981579; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.7122079518414044; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 40 
last prior star auc 0.7307244275651228 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5942279023590779; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.721418598420978; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 40 
last prior star auc 0.735257575996344 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5948043557054383 at iter 490
0.7291807050443608 at iter 40
0.7385943237152717 at iter 0
last anomaly aucs:
0.5948043557054383
0.7140747277684101
0.7314920339757631




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 56.88911700248718 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5951040862316215,first_prior_anomaly_auc= 0.7198074286524734, first_prior_star_anomaly_auc= 0.7340558173251178


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5951040862316214 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7348885071780891 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7401771278188379 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5951040862316214 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7223385914871487 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.734935468112265 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5951040862316215 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7224186456970861 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.738866634098681 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5951040862316215 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7234303544132247 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7388672644467907 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5951040862316215 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7231523708968277 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7381688387411948 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5951040862316214 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7265061380147186 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7399914903005185 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5951040862316215 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.725671872291473 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7387131443339584 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5951040862316215 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.728068770978773 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7396652851537262 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5951040862316215 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7262363490237483 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7371758828813213 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5951040862316215 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7257960508690924 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7358286713837716 iter_best_prior_star_anomaly= 980
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5951040862316215 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7292495705753502 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7415947807176513 iter_best_prior_star_anomaly= 980
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5951040862316215 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7292021368800921 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.7376752761712656 iter_best_prior_star_anomaly= 980
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5951040862316215 at iter 0
max_prior_anomaly= 0.7390016861811937 at iter 6
max_prior_star_anomaly= 0.7439292749420867 at iter 122
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5951040862316214
accuracies_anomaly['prior'][-1]= 0.7297461272988008
accuracies_anomaly['prior_star'][-1]= 0.7415311155585672



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 119.62321090698242 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5951040862316215
 first_prior_anomaly_auc= 0.7313503632380982
 first_prior_star_anomaly_auc= 0.7407529508170887


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5934465858770506; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7107524780560065; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.7282443229273365 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5932622090549506; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7215979324582; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.7330488362198024 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5931585167908977; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7158207920323998; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.7303014639834848 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5931648202719952; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.7186363994515971; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.7323500953401516 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       
