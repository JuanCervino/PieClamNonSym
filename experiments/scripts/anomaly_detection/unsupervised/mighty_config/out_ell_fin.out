

/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 0 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.011733531951904297 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5000867727761357
 first_prior_anomaly_auc= 0.2652307743502712
 first_prior_star_anomaly_auc= 0.4999624129318323


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46118642992902403; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2614523245265657; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4320909164565167 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4384720733207653; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26130534612897205; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.39765119707125907 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43667538132035444; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2611928742876241; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.3944086236972027 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4362489805977182; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2610877329795387; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.39296334516346365 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5000867727761357 at iter 0
0.2652307743502712 at iter 0
0.4999624129318323 at iter 0
last anomaly aucs:
0.4360288596342739
0.26099575769501027
0.39189503448003127




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 58.06435704231262 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4359626256137513,first_prior_anomaly_auc= 0.2609872576523292, first_prior_star_anomaly_auc= 0.3917653455309549


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4359626256137513 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5421008500524953 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5196859059405773 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4359626256137513 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.32101725376039475 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3505761762973959 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4359626256137513 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.272969201150315 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3311331726403279 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4359626256137513 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.2895372492366841 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3204028634413285 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4359626256137513 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.28718846439314033 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.32199269092783817 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4359626256137513 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.28957719943728516 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3263447248373417 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4359626256137513 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.2925566512773695 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.32663089896933667 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4359626256137513 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.2882195798543442 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.32053525311318587 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4359626256137513 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.286299926598213 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.31626716466065663 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4359626256137513 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.2855553409445489 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3157696830846498 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4359626256137513 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.19818626571543352 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3553587343544959 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4359626256137513 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.2783907273094676 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.305590785519689 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4359626316421504 at iter 26
max_prior_anomaly= 0.6618976182518703 at iter 5
max_prior_star_anomaly= 0.5607559359234229 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4359626256137513
accuracies_anomaly['prior'][-1]= 0.28261401872854797
accuracies_anomaly['prior_star'][-1]= 0.31501096686357827



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 129.4914698600769 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4359626316421504
 first_prior_anomaly_auc= 0.27999414883586793
 first_prior_star_anomaly_auc= 0.30941844516495864


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4370740815492889; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.258667180045131; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.2901714790170719 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4368588375606879; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.25419884023247435; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.2858226100170772 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4367228308493918; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.25336962791274165; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.2855275198828658 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43741704320047226; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.25267852621557846; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.2854470286985555 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.43797617721371257 at iter 470
0.27999414883586793 at iter 0
0.30941844516495864 at iter 0
last anomaly aucs:
0.4379146513728593
0.25037369442961455
0.28470514979607137




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 62.97830629348755 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43806390850529947,first_prior_anomaly_auc= 0.2506081690112316, first_prior_star_anomaly_auc= 0.28479165129424905


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4380639085052994 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.23648453426276778 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3036768291006738 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4380639085052994 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.2604122508643518 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.30773755871057845 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4380639145336985 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.2432860815357853 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.28495014393405604 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4380639085052994 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.24135697574992077 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2836756077470233 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4380639145336985 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.24742622927496688 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2877720073941932 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4380639085052994 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.2437961865794333 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.28347345744119057 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4380639085052994 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.24587070940753375 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2821036785773364 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4380639085052994 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.23568417988935716 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.28329276220762867 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4380639145336985 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.2393445936593781 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.27708361365388984 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4380639085052994 iter_best_vanilla_star_anomaly= 970 
last prior auc 0.23975241485609733 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.28234476028432826 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4380639085052994 iter_best_vanilla_star_anomaly= 970 
last prior auc 0.2386405309042261 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.27879447330841917 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4380639145336985 iter_best_vanilla_star_anomaly= 970 
last prior auc 0.2345890609152846 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.27152808221193053 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4380639205620976 at iter 97
max_prior_anomaly= 0.2604122508643518 at iter 20
max_prior_star_anomaly= 0.35376911786195353 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4380639085052994
accuracies_anomaly['prior'][-1]= 0.23827840497241642
accuracies_anomaly['prior_star'][-1]= 0.28009519083258944



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 129.27094268798828 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4380639145336985
 first_prior_anomaly_auc= 0.2380204256628466
 first_prior_star_anomaly_auc= 0.27401635215303066


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.47411692996302424; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.3198198027122009; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 50 
last prior star auc 0.3474291168781188 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4759305436796094; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.3210672653590346; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 130 
last prior star auc 0.3495479122689495 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4732440358636695; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.3090100572987275; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 130 
last prior star auc 0.33865350401901306 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4751429273134222; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.32522936852760936; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 130 
last prior star auc 0.35328864842810703 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4779852813019799 at iter 440
0.3349945732351621 at iter 130
0.3625046900944722 at iter 130
last anomaly aucs:
0.4767626496308931
0.3254668633371578
0.3540657150959311




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 63.40614080429077 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4748554992744219,first_prior_anomaly_auc= 0.32007961465508633, first_prior_star_anomaly_auc= 0.34840381255247715


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4748554932460228 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.28099805813209333 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.31756863573470995 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.47485549324602283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2698045267489712 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3067522530538664 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.47485549324602283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2730342114058275 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.30993106405101667 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.47485549927442183 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2722777015788136 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3102475308883111 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4748554992744219 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2685050510750082 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3067107113559123 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.47485549324602283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26596488867476015 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.30338212478400245 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.47485549324602283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.27049404900557944 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.30801799380666395 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4748554992744219 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2695909767405073 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.31049452042638626 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.47485549324602283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26973330121402306 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3066418790953929 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.47485549324602283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26771292546632075 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3044974750653358 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.47485549324602283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26481254210836747 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.30872592076561634 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.47485549324602283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26461807198294296 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2992985415132439 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4748554992744219 at iter 0
max_prior_anomaly= 0.32007961465508633 at iter 0
max_prior_star_anomaly= 0.34840381255247715 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.47485549324602283
accuracies_anomaly['prior'][-1]= 0.26506461358685407
accuracies_anomaly['prior_star'][-1]= 0.30266193003295366



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 131.0817198753357 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4748554992744219
 first_prior_anomaly_auc= 0.26845199513484086
 first_prior_star_anomaly_auc= 0.30712563400672965


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44954354167962773; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2820357505766766; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.307259789999513 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5625215756402522; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.2783168553073302; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.2968205319073517 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5634462295739755; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.273697534240101; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.4454581197471545 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5629292943541873; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 320 
last prior auc 0.2712397257994742; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.49809974613205865 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5650130587180537 at iter 320
0.29056910016257387 at iter 20
0.5380862196102374 at iter 480
last anomaly aucs:
0.5644996621685164
0.2759786563325438
0.5377063822419761




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 63.5205602645874 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.565544003937268,first_prior_anomaly_auc= 0.2792213623313796, first_prior_star_anomaly_auc= 0.5388511450823456


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.565544003937268 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.19069328518330433 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5419291431619387 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.565544003937268 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2608490144049801 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5442613077092614 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.565544003937268 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2941023207407311 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.544766620175653 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.565544003937268 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.27879476267157427 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5384392848582531 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.565544003937268 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2652914079880628 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.537096205773856 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.565544003937268 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26331095832736523 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5340338574182344 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.565544003937268 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2592319084127032 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5339132653233464 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.565544003937268 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2510901696584406 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5352884275475653 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.565544003937268 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2565010737784414 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5347074104457205 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.565544003937268 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2514660825389109 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.531299990499243 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.565544003937268 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24905864137246875 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5316549004373724 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.565544003937268 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.25176129926950275 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.533460158792854 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.565544003937268 at iter 0
max_prior_anomaly= 0.3096717102664601 at iter 24
max_prior_star_anomaly= 0.5479772068642728 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.565544003937268
accuracies_anomaly['prior'][-1]= 0.24945647351193795
accuracies_anomaly['prior_star'][-1]= 0.5333805115844128



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.56818675994873 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.565544003937268
 first_prior_anomaly_auc= 0.24709802514469364
 first_prior_star_anomaly_auc= 0.5319166052975641


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5698483592385698; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.24432732470741766; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5429227197821674 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5694435582697819; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.24361160905687385; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.5427132690850675 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5697217025742228; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.24253043376983768; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.542750090546554 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5699748169657476; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.24709434782126422; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.5431271970500391 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5701554278017226 at iter 360
0.25688489591848446 at iter 10
0.5433567705432166 at iter 360
last anomaly aucs:
0.5698226842869538
0.24177637750124306
0.5424473503739295




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 63.37905740737915 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5692424689621846,first_prior_anomaly_auc= 0.24703294857679142, first_prior_star_anomaly_auc= 0.5430736648663456


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5692424689621846 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.21830725327330014 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.54063266963071 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5692424689621846 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.27137311618557636 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5446006704062031 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5692424689621846 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2589273717771576 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5440500364356439 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5692424689621846 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2513926566383043 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5440236621897363 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5692424689621846 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.239224923909547 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5434752828404273 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5692424689621846 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23542404844132128 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5427402401424823 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5692424689621846 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23199047729970163 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5424721753212776 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5692424689621846 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23534895267417372 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5431067969476044 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5692424689621846 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23502689751094638 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.543243484867995 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5692424689621846 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23186559298467968 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5429298574066599 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5692424689621846 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23239703253261723 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5425050300961795 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5692424689621846 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23273452039744993 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5427813176537085 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5692424689621846 at iter 0
max_prior_anomaly= 0.27221270338009923 at iter 21
max_prior_star_anomaly= 0.546264249326869 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5692424689621846
accuracies_anomaly['prior'][-1]= 0.2309428379966617
accuracies_anomaly['prior_star'][-1]= 0.5426457932143376



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.23259162902832 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5692424689621846
 first_prior_anomaly_auc= 0.23304433791057616
 first_prior_star_anomaly_auc= 0.5429292907371478


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5645925537697025; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2700004738321665; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.5452456427937241 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5653498834589894; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2749460277431748; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.5460519351402133 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5643096530583998; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26449453200091244; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.5446010803373396 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5647549347269063; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.27356950310076733; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.5457183235359792 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5692424689621846 at iter 0
0.28263329152035743 at iter 20
0.5466063730305823 at iter 450
last anomaly aucs:
0.564780868899682
0.2758404793975845
0.5462858671659145




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 63.38964056968689 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.56499394266462,first_prior_anomaly_auc= 0.27379151698151794, first_prior_star_anomaly_auc= 0.5460146736055951


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.56499394266462 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2072537435152511 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5422534710316134 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.56499394266462 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26190342360016955 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5442955068171548 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.56499394266462 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2548525055714464 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.544476895316609 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.56499394266462 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.254140189937975 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5442788985777319 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.56499394266462 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.25036903447713765 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5440149511530881 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.56499394266462 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24776973951046505 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5440401317759809 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.56499394266462 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2393753023242131 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5431677139201522 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.56499394266462 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24016747616009307 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5431560791099576 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.56499394266462 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23469766252443308 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5427978836943379 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.56499394266462 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23503060497637107 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.54274663627389 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.56499394266462 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23425544931105044 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5426333867690627 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.56499394266462 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2352099498485425 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5427675668754421 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.56499394266462 at iter 0
max_prior_anomaly= 0.27379151698151794 at iter 0
max_prior_star_anomaly= 0.5460824508962783 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.56499394266462
accuracies_anomaly['prior'][-1]= 0.23209587180054775
accuracies_anomaly['prior_star'][-1]= 0.5425742421458399



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 129.69131445884705 seconds
back and forth 7/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.56499394266462
 first_prior_anomaly_auc= 0.2335524837245282
 first_prior_star_anomaly_auc= 0.5425498030160322


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5638398900612919; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2367837779639348; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 100 
last prior star auc 0.5442594931611429 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:408:::  
fit feats error in readout in clam_loss: loss is nan, at iter 175


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 176 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.56499394266462 at iter 0
0.2382081982369103 at iter 130
0.5442594931611429 at iter 100
last anomaly aucs:
0.5631277492513934
0.23394239454762655
0.5431797164626897




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 21.87204599380493 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1161:::  
fit func. error in fit_prior at iter 6:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 6 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5000867788045347
accuracies_anomaly["prior"][-1]= 0.2652307743502712
accuracies_anomaly["prior_star"][-1]= 0.4999624129318323


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam ellipticGGAD 
took 1177.4146535396576 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 1 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.01068115234375 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4909111575538975
 first_prior_anomaly_auc= 0.2641012091039436
 first_prior_star_anomaly_auc= 0.4907878345942333


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4520596688528053; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2613968692835706; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.42326933102614445 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4372078155541377; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2613064975531934; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.3957725670707623 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43523341237770186; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2611804256435557; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.392287881133474 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4343029892660737; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2610613768188283; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.39029182394759826 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4909111575538975 at iter 0
0.2641012091039436 at iter 0
0.4907878345942333 at iter 0
last anomaly aucs:
0.43426669830370496
0.2609677557813553
0.38937702644634553




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.5322904586792 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4342591025208835,first_prior_anomaly_auc= 0.2609576039573305, first_prior_star_anomaly_auc= 0.38930927929765774


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43425910252088357 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5055321050831942 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.485951955347407 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43425910252088357 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.35192001496007513 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37147154788550285 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43425910252088357 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.30294400485358464 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.331590179545015 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43425910252088357 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.29319265340708234 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.32437698907027135 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43425910252088357 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.28582480435433677 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.31895380510137594 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43425910252088357 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.29968979064093454 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.32854775504830197 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43425910252088357 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.2826326766236528 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3141105651792918 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43425910252088357 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.279378390070214 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.31221907660359033 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43425910252088357 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.278090856654798 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3101975735452629 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43425910252088357 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.2773835687061464 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3087776082591961 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43425910252088357 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.27244681625777245 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3055654119880261 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43425910252088357 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.2632067514211348 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29926201544331155 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4342591085492827 at iter 2
max_prior_anomaly= 0.6234070256891786 at iter 4
max_prior_star_anomaly= 0.5321282443035246 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4342591025208835
accuracies_anomaly['prior'][-1]= 0.26422650937850095
accuracies_anomaly['prior_star'][-1]= 0.29928112546834634



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 129.27807927131653 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4342591025208835
 first_prior_anomaly_auc= 0.26728436657681937
 first_prior_star_anomaly_auc= 0.30635079784655944


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43743854649993563; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.24032851881270437; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.2834238798872834 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4390569425696123; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.2334950330814427; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.28009895255360573 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4384493341994937; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.23080039295516463; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.27869618629007015 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43757071312102763; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.22963091367863042; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.27768958832786195 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4390569425696123 at iter 200
0.26728436657681937 at iter 0
0.30635079784655944 at iter 0
last anomaly aucs:
0.4377497384880486
0.22941646543870586
0.27749848204911554




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.90967011451721 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4375824323288091,first_prior_anomaly_auc= 0.22865868361948938, first_prior_star_anomaly_auc= 0.2767382105010853


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.437582414243612 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2431948176023465 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3692559966896855 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4375824263004101 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2862175907237889 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3207410686856499 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4375824263004101 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.262094252572559 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29632649254721083 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4375824263004101 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24596252192528736 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.28156666878866315 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4375824142436119 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2349192483888501 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2785762090918868 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.437582420272011 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2413486143604182 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.27861136671523146 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4375824142436119 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24209469505705036 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2804491965108591 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4375824263004101 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23236639620857105 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2979361414098448 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43758241424361194 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23761208602380784 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.27361211182535583 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.437582420272011 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23662899881795152 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.276620849628096 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4375824142436119 iter_best_vanilla_star_anomaly= 1010 
last prior auc 0.23703938811267222 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2768708473373044 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43758241424361194 iter_best_vanilla_star_anomaly= 1010 
last prior auc 0.2389471895362425 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2769543044939545 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43758243232880917 at iter 101
max_prior_anomaly= 0.3465026363394789 at iter 16
max_prior_star_anomaly= 0.4079265550496523 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43758242630041
accuracies_anomaly['prior'][-1]= 0.23172165290021457
accuracies_anomaly['prior_star'][-1]= 0.2747308681521607



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 129.18753838539124 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4375824323288091
 first_prior_anomaly_auc= 0.23809461717013447
 first_prior_star_anomaly_auc= 0.27772085763380994


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44577760681238027; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.2464252859510812; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.2845187878673887 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44632445494832695; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.24575486166270963; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.28366739103909827 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44600993528393035; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.24533599041050502; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.28270634968862113 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4463438543365168; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.2472452205646536; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.2843809967499695 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.44674916169082607 at iter 490
0.26220736342420786 at iter 10
0.29571705154377653 at iter 10
last anomaly aucs:
0.44674916169082607
0.24554973935613802
0.2827861596638372




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.771682024002075 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.447138662582788,first_prior_anomaly_auc= 0.24955810026336872, first_prior_star_anomaly_auc= 0.28549719703557097


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4471386686111871 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.3250005968115074 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40495685715925434 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.447138662582788 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.396510292406291 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4024953231680056 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.447138662582788 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.36082547350663297 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3784194405742122 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44713866861118706 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.3672202304391713 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.391894727031679 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4471386686111871 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.31295967748547276 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.33950347211672527 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.447138662582788 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.3733273603955401 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4112017420626481 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44713866861118706 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.2769145170601282 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3271161187816461 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.447138662582788 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.2896118747887046 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.317535973868578 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44713866258278806 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.26144706776258136 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29760535109637287 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.44713866861118706 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.2571223907280329 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.28592063781426647 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.44713866861118706 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.24969170767183713 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.27985513998183764 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.44713866861118706 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.24631611767242068 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.27342699174688057 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4471386806679852 at iter 32
max_prior_anomaly= 0.4022610475235578 at iter 22
max_prior_star_anomaly= 0.42059144382086683 at iter 59
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4471386746395862
accuracies_anomaly['prior'][-1]= 0.24561125314019308
accuracies_anomaly['prior_star'][-1]= 0.2720249850616271



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 129.4317820072174 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.44713866861118706
 first_prior_anomaly_auc= 0.2396829616704742
 first_prior_star_anomaly_auc= 0.2751768672001559


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6094058216973175; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.36761502426551196; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 50 
last prior star auc 0.38396371699511794 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5729141739236534; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.3622954805333348; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 50 
last prior star auc 0.4940268150424472 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5749151683683631; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.3613053220153758; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 50 
last prior star auc 0.4870374288829763 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5732106927884433; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.35096830557134995; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 50 
last prior star auc 0.4755063131806364 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6243781465228917 at iter 50
0.38864120005652225 at iter 50
0.5473487764037851 at iter 470
last anomaly aucs:
0.5703203587717305
0.3465991027813104
0.5468772470857514




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.72676873207092 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.570537688586408,first_prior_anomaly_auc= 0.3432335741799328, first_prior_star_anomaly_auc= 0.5462652741547099


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.570537688586408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4323542610412541 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5615401643293358 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.570537688586408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4451226935948019 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5620021567200494 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.570537688586408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4279830206523306 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5609500322881054 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.570537688586408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.38482806885299825 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5588126694281557 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.570537688586408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.34881831321535994 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5569711984794932 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.570537688586408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3351921479861048 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5550379391266731 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.570537688586408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3773615228507672 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5558574457239118 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.570537688586408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40865186188310787 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5556336534654372 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.570537688586408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3835169643972397 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5534701213251482 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.570537688586408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3612663182734279 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5505939058190448 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.570537688586408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3584533467019111 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5493436520234443 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.570537688586408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.35485165556717835 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5486944235861837 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.570537688586408 at iter 0
max_prior_anomaly= 0.4454880869189045 at iter 19
max_prior_star_anomaly= 0.5621049228389032 at iter 17
last values
accuracies_anomaly['vanilla_star'][-1]= 0.570537688586408
accuracies_anomaly['prior'][-1]= 0.3470271914556847
accuracies_anomaly['prior_star'][-1]= 0.5478359072185979



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 129.29764556884766 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.570537688586408
 first_prior_anomaly_auc= 0.34609539989746896
 first_prior_star_anomaly_auc= 0.5477334485480962


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5614348120272831; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3509689264964536; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5465557887340313 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5610523161350343; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3511245375615078; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 120 
last prior star auc 0.54602398748215 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5611380098277372; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.35007720570682016; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 120 
last prior star auc 0.5455134725073654 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5610369376890204; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3488403590707391; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 120 
last prior star auc 0.54463471880412 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.570537688586408 at iter 0
0.352329114177396 at iter 120
0.5477334485480962 at iter 0
last anomaly aucs:
0.5611584340437681
0.3481943256849829
0.5442432345688657




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.84075617790222 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5609448900637033,first_prior_anomaly_auc= 0.34905023175577365, first_prior_star_anomaly_auc= 0.5442960071742772


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5609448900637033 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.312551054511678 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5486487464064713 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5609448900637033 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2786633616571635 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5464613478342856 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5609448900637033 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.268539189898911 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5458679966279547 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5609448900637033 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2748449978032514 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.546980459306136 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5609448900637033 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.28619187960177844 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5481641113488711 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5609448900637033 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.29080429815207864 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5482299957222481 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5609448900637033 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2892384154666535 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5477322910954758 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5609448900637033 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2841560832092689 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5468006321620394 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5609448900637033 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2789360140900566 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5456928414931332 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5609448900637033 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2735296071557579 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5435470328460941 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5609448900637033 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.28982769750361587 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5424823753724948 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5609448900637033 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.29816926563007135 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5408587948796224 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5609448900637033 at iter 0
max_prior_anomaly= 0.36200259679318103 at iter 1
max_prior_star_anomaly= 0.552045628711384 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5609448900637033
accuracies_anomaly['prior'][-1]= 0.3059714849490166
accuracies_anomaly['prior_star'][-1]= 0.540013372194805



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 128.5591025352478 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5609448900637033
 first_prior_anomaly_auc= 0.3061151356703266
 first_prior_star_anomaly_auc= 0.5398788484696788


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5645773019200693; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.27230154389711403; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.537258345595097 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5647737011331944; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.2672248542212538; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5353304575458435 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5649270093498058; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.2611683025330368; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5335003139590233 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5648102694019201; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 350 
last prior auc 0.26047059973889797; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5320265632965022 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5651522845944503 at iter 480
0.3061151356703266 at iter 0
0.5398815552208589 at iter 20
last anomaly aucs:
0.5650037026427055
0.25886634629342675
0.5309719310505474




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.7654345035553 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5648161290058109,first_prior_anomaly_auc= 0.2613579559676087, first_prior_star_anomaly_auc= 0.5313333757732628


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5648161290058109 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.22693517638372254 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.538003106072334 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5648161290058109 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2414639557197209 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5295191592167712 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5648161290058109 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.245414486194725 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5268506702856351 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5648161290058109 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2418266724346389 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5243826256233968 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5648161290058109 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2392813858951859 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5222362683920427 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5648161290058109 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23738735333507915 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5204382742574338 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5648161290058109 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23590303488899791 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5188921526641425 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5648161290058109 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2349079571974021 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5176374740236285 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5648161290058109 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23411920146379173 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5165921315406321 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5648161290058109 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23345731941689465 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5156502966695747 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5648161290058109 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2328534305689989 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5148680696921514 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5648161290058109 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2322610680201146 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.51401435795862 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5648161290058109 at iter 0
max_prior_anomaly= 0.2925326401638953 at iter 2
max_prior_star_anomaly= 0.5485851950235325 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5648161290058109
accuracies_anomaly['prior'][-1]= 0.23171280321038779
accuracies_anomaly['prior_star'][-1]= 0.5133783558289073



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 129.06890606880188 seconds
back and forth 7/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5648161290058109
 first_prior_anomaly_auc= 0.23236374974138166
 first_prior_star_anomaly_auc= 0.5138901005971008


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5978193833767619; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5288644991919534; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5911812840875825 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5913074886219996; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5149642286856305; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.5838668044517556 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.577629298308817; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5205536879575253; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.5700602152668965 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5749047754083758; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5090649217586143; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.5661135972228853 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:408:::  
fit feats error in readout in clam_loss: loss is nan, at iter 437


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 438 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6265202356477082 at iter 10
0.5767786309168135 at iter 10
0.6236746805792471 at iter 10
last anomaly aucs:
0.5747418820372516
0.5094177458706672
0.5658133708926709




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 54.28599166870117 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1161:::  
fit func. error in fit_prior at iter 6:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 6 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4909111575538975
accuracies_anomaly["prior"][-1]= 0.2641012091039436
accuracies_anomaly["prior_star"][-1]= 0.4907878285658342


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam ellipticGGAD 
took 1199.867736339569 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 2 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.010849237442016602 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5004083275822406
 first_prior_anomaly_auc= 0.26474807440877074
 first_prior_star_anomaly_auc= 0.5002840641923223


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4529779085699238; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26139700190834997; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4246712292002147 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4371650862615679; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2613125018386617; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.3959462693614093 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.434916071422543; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2612050817957299; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.3915600363440123 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4346219880309754; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2611110568555195; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.39002975738346257 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5004083275822406 at iter 0
0.26474807440877074 at iter 0
0.5002840641923223 at iter 0
last anomaly aucs:
0.4347274850146056
0.26102056455716105
0.3895311786388261




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 54.24307036399841 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43474567872298253,first_prior_anomaly_auc= 0.2610121971392594, first_prior_star_anomaly_auc= 0.3894881780682984


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43474567872298253 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.260789731128579 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3902318112349103 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43474567872298253 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.26039554014214483 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39098379373422665 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4347456847513816 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.26010166774454446 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3917710845668643 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43474567872298253 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.25987805633804173 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3925858648992365 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43474567872298253 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.2596710652277602 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.393433536176905 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43474567872298253 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.25925464753397487 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3943167870658528 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4347456787229825 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.2589985551133122 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39525106835288215 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43474567872298253 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.2588300010754664 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3962194281798237 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4347456847513816 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.25871774625648475 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39723593080169506 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43474567872298253 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.2586622789566915 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39830806349013437 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43474567872298253 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.2584227766902546 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39942625917582625 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43474567872298253 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.25822634130673505 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4006062338951319 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43474568475138164 at iter 3
max_prior_anomaly= 0.2610121971392594 at iter 0
max_prior_star_anomaly= 0.4017051809026105 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43474567872298253
accuracies_anomaly['prior'][-1]= 0.2578674043980306
accuracies_anomaly['prior_star'][-1]= 0.4017051809026105



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 113.67427086830139 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43474567872298253
 first_prior_anomaly_auc= 0.2578067345898446
 first_prior_star_anomaly_auc= 0.40181821338507145


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43500768500312753; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.2577054514571605; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.40154056943775296 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43519216607130196; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.25762142160259927; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4012858213500816 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4356767529017096; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.25755082302115395; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4014726595222904 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4357166247331228; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.25749103335923135; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.40132713396887126 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.43578555947642633 at iter 370
0.2578067345898446 at iter 0
0.40182290347954364 at iter 20
last anomaly aucs:
0.4357361446892939
0.25744254694555485
0.4012229089774436




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.25769925117493 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4357450606915104,first_prior_anomaly_auc= 0.2574367837960492, first_prior_star_anomaly_auc= 0.401220793009372


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4357450606915105 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.2566417404422144 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40257580832391693 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4357450667199094 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.25567701573990886 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4039959604903548 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43574506671990954 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.2544384811520898 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4055004198177109 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4357450606915104 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.2540135694440225 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40711493359839 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4357450546631113 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.2542683356168909 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4088299106494805 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4357450667199095 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.25538921394016645 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41068655507858864 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4357450667199095 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.2562868907880757 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4127073528142255 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4357450667199095 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.25793135365530767 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4148822424583522 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4357450667199095 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.2668045421816728 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41724722561018246 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4357450606915104 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.28815300221507495 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41983907550401034 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43574506069151037 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.3418215844658284 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4226957348835482 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43574506671990954 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.39794561805317435 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4258267708181116 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43574506671990954 at iter 30
max_prior_anomaly= 0.448841082478627 at iter 129
max_prior_star_anomaly= 0.42895311062980374 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4357450546631113
accuracies_anomaly['prior'][-1]= 0.448841082478627
accuracies_anomaly['prior_star'][-1]= 0.42895311062980374



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.24986243247986 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4357450606915104
 first_prior_anomaly_auc= 0.4535324248294807
 first_prior_star_anomaly_auc= 0.4292850825094923


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4356898827548723; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4534214962582933; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4292180828822885 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43581528551221377; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4533201709268157; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.42930070811986776 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4360073804484068; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.45322856337463036; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4294584592665898 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43622082797408657; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.45312463980315587; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4296262597545525 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4362285563816874 at iter 420
0.4535324248294807 at iter 0
0.42963895556298254 at iter 420
last anomaly aucs:
0.4360395238722191
0.45302985528466344
0.42947359657664097




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.80252408981323 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4360032871654419,first_prior_anomaly_auc= 0.4530161105347962, first_prior_star_anomaly_auc= 0.42945771174510583


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43600329922224007 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5154336179219963 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43344440055769917 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4360032811370429 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5728326880534974 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43738792603299026 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4360032751086438 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6076267446789733 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4413570239771133 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4360032871654419 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.630442089028362 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4453827165316546 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4360032871654419 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.6467441219492082 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4496330212069434 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43600329922224007 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.6579508133274882 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4544207335452436 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.436003293193841 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.6659794532869002 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45937859141874277 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43600329922224 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.6693623798479783 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4643626487145765 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43600328716544196 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.67073855484324 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4693343357355298 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.436003293193841 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.6707542889647985 iter_best_prior_anomaly= 950
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4738933486985169 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43600327510864384 iter_best_vanilla_star_anomaly= 1010 
last prior auc 0.6685843004091112 iter_best_prior_anomaly= 950
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47770851147252574 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.436003293193841 iter_best_vanilla_star_anomaly= 1010 
last prior auc 0.6651010311456033 iter_best_prior_anomaly= 950
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48106265845646945 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43600331127903824 at iter 101
max_prior_anomaly= 0.6710211239925942 at iter 95
max_prior_star_anomaly= 0.48389798936011674 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43600329922224
accuracies_anomaly['prior'][-1]= 0.6611058000915352
accuracies_anomaly['prior_star'][-1]= 0.48389798936011674



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.75772094726562 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4360032871654419
 first_prior_anomaly_auc= 0.6607861683447318
 first_prior_star_anomaly_auc= 0.48419938519974975


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43587225388337414; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.660623504052772; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.48419434545813184 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43582862033094466; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6604868884731705; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.484331202173696 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43598716722634323; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6603595626565274; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.48453856704471965 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4362091027379059; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.660198893764658; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.48477500085603265 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4364410031931224 at iter 490
0.6607861683447318 at iter 0
0.48497162914832226 at iter 490
last anomaly aucs:
0.4364410031931224
0.6600526448033512
0.48497162914832226




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.430166482925415 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43645767774493505,first_prior_anomaly_auc= 0.6600405759484238, first_prior_star_anomaly_auc= 0.4849883639841256


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43645767774493505 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6564887517307534 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48860719988579804 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4364576837733341 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6540526274415619 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49258052976606437 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4364576777449351 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6523910378925873 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49699085829452255 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4364576777449351 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6510420087783136 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5016728505984271 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43645767774493505 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6500332405924422 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5065021649186721 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43645767774493505 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6496516127896586 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5112310280253038 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4364576837733341 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.649272420460097 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5151838553203515 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43645768980173316 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6481840593213759 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5186544106902324 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4364576837733341 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6466971366068988 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5220223205092405 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4364576898017332 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6449004868052812 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5249448642621553 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.436457671716536 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6434121293318267 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5274119262953463 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4364576837733341 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6415461469125676 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5298014269461722 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4364576898017332 at iter 4
max_prior_anomaly= 0.6600405759484238 at iter 0
max_prior_star_anomaly= 0.5317549959754408 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4364576898017332
accuracies_anomaly['prior'][-1]= 0.6392653684388714
accuracies_anomaly['prior_star'][-1]= 0.5317549959754408



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.86119031906128 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.436457677744935
 first_prior_anomaly_auc= 0.6390000766812362
 first_prior_star_anomaly_auc= 0.531936468872482


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4361194303018202; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.639112825828941; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5319954688141271 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4360281121127899; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6391719222249712; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5321034736117682 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43603874620873984; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6392353892103231; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.532227417496536 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4361205636408444; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6392586528023134; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.5324104818909303 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.436457677744935 at iter 0
0.6392808071688758 at iter 490
0.5325819717591205 at iter 490
last anomaly aucs:
0.4362053169032934
0.6392808071688758
0.5325819717591205




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.79487609863281 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43620363497995435,first_prior_anomaly_auc= 0.639280728799688, first_prior_star_anomaly_auc= 0.5325941732388273


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43620362895155534 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6332007145823115 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5327488378452283 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4362036289515553 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6295454490650917 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5339516300549935 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43620364100835346 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6258496365357636 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5349952303306602 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4362036289515553 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6221083035650987 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5357746179321241 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4362036289515553 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6183410605352543 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5368629609856481 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4362036168947572 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6139020187420515 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5370326302773208 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4362036470367525 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6093292791143945 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5366774249476374 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4362036289515553 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6051972335435556 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5365876379719694 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4362036470367525 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6012224508191147 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5362816424638501 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43620363497995435 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5963961145280077 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5353389636169237 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4362036410083534 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.591932531122213 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5344747564406209 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4362036229231563 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5866724937172025 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5326376199108858 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4362036470367525 at iter 6
max_prior_anomaly= 0.639280728799688 at iter 0
max_prior_star_anomaly= 0.5370566655043912 at iter 59
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43620364100835346
accuracies_anomaly['prior'][-1]= 0.5821799257687053
accuracies_anomaly['prior_star'][-1]= 0.5307826272631213



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.28438186645508 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43620362292315623
 first_prior_anomaly_auc= 0.5820914590124324
 first_prior_star_anomaly_auc= 0.5309633224966832


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4352724040628516; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5852548855351699; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.531859462102831 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.435050197273331; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5873874980166568; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.532286206444214 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4349773500990345; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5882468402749143; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5326665622547948 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43518516709998795; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5888686696384263; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.5330970864023913 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.43620362292315623 at iter 0
0.589197205330648 at iter 490
0.5333995010414663 at iter 490
last anomaly aucs:
0.43538383299116146
0.589197205330648
0.5333995010414663




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 54.03223371505737 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43540363628208856,first_prior_anomaly_auc= 0.589251997449746, first_prior_star_anomaly_auc= 0.5334305774386442


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43540363628208856 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.576782042990684 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5270787487358447 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43540363628208856 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5729553539176637 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5254855453458589 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4354036362820886 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5682455043816815 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5236246930942037 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4354036362820886 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5642501648164304 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5216921812628676 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43540363628208856 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5596058861770739 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5191411556875052 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4354036362820886 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.553928587102409 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5155434613813522 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4354036362820886 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5482969531506584 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5123335920722212 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43540363628208856 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5438099011873052 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5100133999254408 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43540363628208856 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.538977940399871 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5072000726783791 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4354036362820886 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5359027575826409 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5056264013013625 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43540363628208856 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5334969802543406 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5044794019249402 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43540364231048767 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5312654899713964 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5030655012083323 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43540364231048767 at iter 7
max_prior_anomaly= 0.589251997449746 at iter 0
max_prior_star_anomaly= 0.5334305774386442 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4354036362820886
accuracies_anomaly['prior'][-1]= 0.5272512996022702
accuracies_anomaly['prior_star'][-1]= 0.5001074863553215



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.28089928627014 seconds
back and forth 7/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43540363628208856
 first_prior_anomaly_auc= 0.5269115571161875
 first_prior_star_anomaly_auc= 0.49985704857298147


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4330192899124628; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5412248452992232; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 90 
last prior star auc 0.5070520332825501 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4337598063967584; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5427157347002849; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 160 
last prior star auc 0.5075497981933129 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43423357827924414; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5419867324582026; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 160 
last prior star auc 0.5071668923699276 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4344259264081978; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5416390927693453; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 160 
last prior star auc 0.5068592209668683 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.43540363628208856 at iter 0
0.5428489683480112 at iter 160
0.5075851788674229 at iter 240
last anomaly aucs:
0.4347045348993668
0.5412832906281544
0.5065274299391518




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.30971932411194 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4347357559781222,first_prior_anomaly_auc= 0.5407774597194431, first_prior_star_anomaly_auc= 0.5060500169036309


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43473575597812225 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5228843695186781 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49232094087394435 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4347357559781222 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5204900280634034 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49098596395788996 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43473575597812225 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5177034970501837 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4892594545793889 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43473575597812225 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5159741422673243 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48815959125525255 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4347357559781222 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5144126482564182 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48692513789360015 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43473575597812225 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5131116051986985 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4859102629394763 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4347357559781222 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5118482637487286 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4848840726803082 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4347357559781223 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.5105967560461225 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48379353528952473 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43473575597812225 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.5093545561916722 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4826852502918951 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4347357559781222 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.5078478844418595 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4812964156585977 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43473575597812225 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.5064852492308969 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47990724343495283 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43473575597812225 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.5045817219422634 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4781771531874075 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4347357559781223 at iter 73
max_prior_anomaly= 0.5437442398646938 at iter 1
max_prior_star_anomaly= 0.5076782030933886 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43473575597812225
accuracies_anomaly['prior'][-1]= 0.5022268484156645
accuracies_anomaly['prior_star'][-1]= 0.47613861387332357



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.39361214637756 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 6 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5004083275822406
accuracies_anomaly["prior"][-1]= 0.26474807440877074
accuracies_anomaly["prior_star"][-1]= 0.5002840641923223


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam ellipticGGAD 
took 1164.5800907611847 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 3 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.010514974594116211 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5046608446799861
 first_prior_anomaly_auc= 0.26520960864115545
 first_prior_star_anomaly_auc= 0.504542844796696


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4558085734926953; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26145346389398894; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.42723424526131665 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4397069667555494; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2613377126035498; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.39823085778331424 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43638258197778756; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2612188988863859; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.3931348109180577 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43531532626419145; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2610978787751643; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.39099170902219854 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5046608446799861 at iter 0
0.26520960864115545 at iter 0
0.504542844796696 at iter 0
last anomaly aucs:
0.4347920672537845
0.2609986513265613
0.3899509601792893




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.524012327194214 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43479193462900506,first_prior_anomaly_auc= 0.26098876475209537, first_prior_star_anomaly_auc= 0.3898809945797458


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43479193462900506 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.26058489215676345 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39065870628626986 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4347919346290051 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.2602225190605922 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39144640102164485 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43479193462900506 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.259944163762184 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39226717961108626 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43479193462900506 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.25956181857991173 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3931234956130134 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43479193462900506 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.25917837622900974 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3940124734810725 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4347919346290051 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.25894746443123984 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39493607244495954 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43479193462900506 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.2588768959917898 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3959002726765465 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.434791928600606 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.25869671317214843 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39690351282047565 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43479193462900506 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.2584714198423067 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3979689298723571 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43479193462900506 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.25842709905238387 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3990811694997731 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43479193462900506 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.25827325430825565 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4002573764696634 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43479193462900506 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.25802942967968945 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.401490172021573 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43479194065740423 at iter 13
max_prior_anomaly= 0.26098876475209537 at iter 0
max_prior_star_anomaly= 0.40264597888902875 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4347919346290051
accuracies_anomaly['prior'][-1]= 0.2578968109286677
accuracies_anomaly['prior_star'][-1]= 0.40264597888902875



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.68663597106934 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43479193462900506
 first_prior_anomaly_auc= 0.2578719799529206
 first_prior_star_anomaly_auc= 0.40276576317844204


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4348722208477473; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.25776128046089763; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.40239004320674177 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43515372297046706; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.2576820190699965; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.40235331217124126 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43535384773421415; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.25760281796308593; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.40228683701475604 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.435671652876101; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.25752444877524633; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4023451316337106 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4358199997202823 at iter 490
0.2578719799529206 at iter 0
0.40276576317844204 at iter 0
last anomaly aucs:
0.4358199997202823
0.25747006055888566
0.4023643079711351




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.64435696601868 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43582061461698685,first_prior_anomaly_auc= 0.25746446017615465, first_prior_star_anomaly_auc= 0.40235952142227777


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.435820626673785 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.2569947032074459 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40378183175558074 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43582061461698685 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.2564646743048894 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40527156973242107 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43582061461698685 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.25588461571849597 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40684615139769637 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43582061461698685 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.255734906456126 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4085010735373054 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43582062667378496 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.25661424491408086 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41027134306461627 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43582062667378496 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.25709833741576515 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41219507754691426 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43582062064538596 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.25651700080877005 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41423423175770274 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43582061461698685 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.2628694745502694 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4164503435946331 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4358206206453859 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.2930024091894022 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41895371467539 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4358206146169869 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.3628173228699617 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42174837799894765 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43582062064538585 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.4168747187751836 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4248625464729284 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43582062064538596 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.47666057074953255 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42838332443541627 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4358206327021841 at iter 66
max_prior_anomaly= 0.5275259956624463 at iter 129
max_prior_star_anomaly= 0.43178850181744177 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.435820626673785
accuracies_anomaly['prior'][-1]= 0.5275259956624463
accuracies_anomaly['prior_star'][-1]= 0.43178850181744177



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.32093620300293 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43582061461698685
 first_prior_anomaly_auc= 0.532796600851017
 first_prior_star_anomaly_auc= 0.43213414007780976


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43596588094924615; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5326662186360482; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4322942543569651 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4362441759636637; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5325365658573662; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4324580941867424 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.436210037139761; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5324579314199677; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4324686679987017 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4360490005155487; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5324139120499981; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4322930064783588 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.43627186440056737 at iter 220
0.532796600851017 at iter 0
0.43249613338483994 at iter 270
last anomaly aucs:
0.4360601831958135
0.5323288151688024
0.4323487872549034




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.8280725479126 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43606982863431687,first_prior_anomaly_auc= 0.5323183558964253, first_prior_star_anomaly_auc= 0.43235172911364694


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4360698226059178 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.580420995660035 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4364086608321409 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4360698286343168 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6040177169825788 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4406153078414039 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43606982260591776 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6288681162313922 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4451964148869627 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43606982863431687 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6451807470777938 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.449829751982017 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4360698286343168 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6519948213640675 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4546918005091827 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4360698346627159 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6553611155721264 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4599784954948568 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43606979246392247 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6561665277723522 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46512161812840874 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4360698045207206 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.655731162820307 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4698825221760688 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4360698286343168 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6542120846252192 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4745258483283732 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4360698045207206 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6521327631914634 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4792101856795139 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43606983466271587 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6486402765057856 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48366780097023465 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43606983466271587 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6447861341034251 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48770679820151147 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43606984671951404 at iter 25
max_prior_anomaly= 0.6561720015587028 at iter 69
max_prior_star_anomaly= 0.49153623622450526 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4360698165775187
accuracies_anomaly['prior'][-1]= 0.6423511310964597
accuracies_anomaly['prior_star'][-1]= 0.49153623622450526



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.96749448776245 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4360698165775187
 first_prior_anomaly_auc= 0.6421183082961863
 first_prior_star_anomaly_auc= 0.49193792653937585


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43605188811870066; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6419603582122951; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.49208706310383454 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43620947047024894; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6418018957144834; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4922966403973149 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43608266912432436; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.641650094597638; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.49238462488166246 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43602815431158337; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6414780682019311; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.49248666759262877 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.43620947047024894 at iter 200
0.6421183082961863 at iter 0
0.49267093766683595 at iter 490
last anomaly aucs:
0.43611767000929336
0.6413280514912089
0.49267093766683595




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.549320459365845 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4361304441869112,first_prior_anomaly_auc= 0.6413148070984639, first_prior_star_anomaly_auc= 0.49268805229178025


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43613044418691127 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6392325016071712 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4972122693353666 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43613043213011315 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6378755511765265 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5014762825901281 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43613043815851216 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6365768893364372 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5057506345492856 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4361304502153103 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.635194402607355 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.50974543758702 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4361304321301131 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6342694713672746 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5133677337897555 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4361304321301131 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6337718631948877 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.516471714269317 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43613044418691127 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6332495626999318 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5193350229730231 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43613042610171404 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6322486073192481 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5218296890455307 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4361304441869112 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6314396745339685 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.524162932676286 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4361304321301131 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6307231209359547 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5263626231541645 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4361304140449159 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6298425828265861 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.528294067958866 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4361304502153103 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6287871548319547 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.53009215854786 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43613045624370933 at iter 16
max_prior_anomaly= 0.6413148070984639 at iter 0
max_prior_star_anomaly= 0.5317275607312979 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43613043815851216
accuracies_anomaly['prior'][-1]= 0.6283672346383129
accuracies_anomaly['prior_star'][-1]= 0.5317275607312979



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.90669655799866 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43613044418691127
 first_prior_anomaly_auc= 0.6282960091033648
 first_prior_star_anomaly_auc= 0.5318859448599217


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43553885930150626; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6284642798064547; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5320185394973472 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4352877222248747; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6286226940770738; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5321158258014516 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43503272094444273; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.628693654362463; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5321536178351874 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43481987023027036; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6287261594902193; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.5321443943846186 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.43613044418691127 at iter 0
0.6287424241108956 at iter 490
0.5321739395684342 at iter 490
last anomaly aucs:
0.4347378237190014
0.6287424241108956
0.5321739395684342




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 54.0869197845459 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4347358222905119,first_prior_anomaly_auc= 0.6287438407846757, first_prior_star_anomaly_auc= 0.5321804743530201


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.434735828318911 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6225397078589587 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5312644591151564 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43473583434731006 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6208436961513255 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328188396151663 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.434735828318911 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6192375196465525 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5343926858157557 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4347358222905119 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6173108312487129 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5357116332186973 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4347358222905119 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.615131999031598 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5368508318467301 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.434735828318911 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6128807114861258 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.53790388465213 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4347358162621129 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6117165191155711 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.539596321519118 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.434735828318911 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6102783360075312 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.540787448776693 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4347358222905119 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6092197370749919 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5420898602810006 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.434735828318911 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6083371734235374 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5434113335831502 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4347358162621129 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6062629580437894 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5438861423502751 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43473582831891094 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6041890139419991 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5442281093156127 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4347358403757091 at iter 12
max_prior_anomaly= 0.6293885418942387 at iter 1
max_prior_star_anomaly= 0.5442943614213325 at iter 124
last values
accuracies_anomaly['vanilla_star'][-1]= 0.434735828318911
accuracies_anomaly['prior'][-1]= 0.6020032792079552
accuracies_anomaly['prior_star'][-1]= 0.544268933634078



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.69966769218445 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.434735828318911
 first_prior_anomaly_auc= 0.6017504541795855
 first_prior_star_anomaly_auc= 0.5442491604851463


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43319453547327036; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6047086438561692; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5457178714060493 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43276090670015566; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6058931579599705; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5462851497864258 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4325225438011419; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6065173986831083; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5465565362555154 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4322661137901317; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6067773673643695; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 390 
last prior star auc 0.5465864913704673 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.434735828318911 at iter 0
0.6069643863885502 at iter 490
0.5466643903431798 at iter 440
last anomaly aucs:
0.43206975074740095
0.6069643863885502
0.5465881310950129




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 54.41267132759094 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43205980991734344,first_prior_anomaly_auc= 0.606964922916067, first_prior_star_anomaly_auc= 0.5465782445205469


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4320598099173434 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5972412659348674 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5429665161013716 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43205980991734344 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5938506109661884 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5420600619044244 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43205980991734344 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5918478743141491 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5420847903973872 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4320598099173434 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5900229814629139 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5420866049455056 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4320598099173434 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5886176893001704 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5420158616824828 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4320598159457425 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5869042856612358 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5419584050109982 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4320598038889444 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5843847524425869 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5408730882138046 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43205982197414156 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5820211497941423 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5398320560361395 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43205980991734344 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5799727419907896 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5389293635602085 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4320598099173434 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5777824377302547 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5378047958567054 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4320598038889444 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5754775396319012 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5365090638185616 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4320598038889443 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5732867772130373 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5355421387505974 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4320598280025406 at iter 11
max_prior_anomaly= 0.6151743123646323 at iter 2
max_prior_star_anomaly= 0.5489310081074733 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4320598159457425
accuracies_anomaly['prior'][-1]= 0.5709203593022297
accuracies_anomaly['prior_star'][-1]= 0.5343585590486511



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 113.32589793205261 seconds
back and forth 7/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4320598038889444
 first_prior_anomaly_auc= 0.5706353908500477
 first_prior_star_anomaly_auc= 0.5342167349322577


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42847455822685976; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5753879817353977; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.5386946960698213 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.427744850662087; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5775171700862157; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 190 
last prior star auc 0.5394812152673787 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4277967551780331; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5780803190132331; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 290 
last prior star auc 0.5399617570420141 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4283066371709157; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5784901356100426; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 390 
last prior star auc 0.5406941532727697 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4320598038889444 at iter 0
0.5790067694098776 at iter 440
0.5414124973053056 at iter 470
last anomaly aucs:
0.4286355586806776
0.578637451597984
0.5411359444982178




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 54.42776083946228 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4287248151572279,first_prior_anomaly_auc= 0.5785436858789333, first_prior_star_anomaly_auc= 0.5411251536638921


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4287248031004297 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5856018078445387 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5448614167509438 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.42872480310042976 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.574603313256353 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5397332144050766 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42872480310042976 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5706083293666467 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5376468819432086 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42872480310042976 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5681707944320741 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5363095539515191 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4287248151572279 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.5666037904644231 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5356301835189358 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4287247970720307 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.5656320065068129 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.535294944246954 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4287248091288288 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.5650299623490308 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5352224587766015 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4287248091288288 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.5645827515928237 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5351810497034268 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4287248091288288 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.5639571725650934 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5350815992040584 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4287247970720307 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.5634576533902029 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5350065275505071 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4287248151572279 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.5623008518369015 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.534313086834507 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.42872479707203065 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.5614526621169134 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5339641329546534 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.42872482118562694 at iter 44
max_prior_anomaly= 0.5890120912805719 at iter 7
max_prior_star_anomaly= 0.5455498840377155 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.42872480310042976
accuracies_anomaly['prior'][-1]= 0.5606099039844824
accuracies_anomaly['prior_star'][-1]= 0.5335896307195642



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 113.26564836502075 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 6 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5046608446799861
accuracies_anomaly["prior"][-1]= 0.26520960864115545
accuracies_anomaly["prior_star"][-1]= 0.504542844796696


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam ellipticGGAD 
took 1166.8275210857391 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 4 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.010596275329589844 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5041822561066477
 first_prior_anomaly_auc= 0.26596259185471655
 first_prior_star_anomaly_auc= 0.5040625562148212


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45542570383970443; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26142896448019043; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4268600565029787 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4390028075460124; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26133691082647426; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.39770992573494623 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43446291666485815; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.261208083938464; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.3917665331255706 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4348097304630438; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2610918865464942; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.3904316406071032 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5041822561066477 at iter 0
0.26596259185471655 at iter 0
0.5040625562148212 at iter 0
last anomaly aucs:
0.43460432482171607
0.260999929347163
0.3895037192810869




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 54.12449288368225 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43453407588741655,first_prior_anomaly_auc= 0.2609922732803509, first_prior_star_anomaly_auc= 0.38941759757205024


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4345340819158156 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.25901254099914206 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39797827991930623 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4345340819158156 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.24637789067763546 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4113692170170613 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43453407588741655 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6338187279692157 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4449780301024491 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4345340819158156 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6362770729373591 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5045746566585596 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4345340819158156 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6181700529389892 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5434963942939515 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4345340819158156 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5424651160659729 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5109592617670733 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43453408191581555 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.44114652433857615 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336867361716965 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43453407588741655 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.35007871883498537 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36541755826688826 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4345340819158156 iter_best_vanilla_star_anomaly= 810 
last prior auc 0.3158666378268056 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.33900454372494293 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43453407588741655 iter_best_vanilla_star_anomaly= 810 
last prior auc 0.30291563520758674 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.32796931810125685 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43453408794421466 iter_best_vanilla_star_anomaly= 810 
last prior auc 0.29456275177608693 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3206013424521309 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43453408191581555 iter_best_vanilla_star_anomaly= 810 
last prior auc 0.29083832846479823 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3172062264681442 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4345340939726138 at iter 81
max_prior_anomaly= 0.6562756839942147 at iter 33
max_prior_star_anomaly= 0.5434963942939515 at iter 50
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4345340819158156
accuracies_anomaly['prior'][-1]= 0.28813984221991695
accuracies_anomaly['prior_star'][-1]= 0.3146189280156102



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 113.54297924041748 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4345340819158156
 first_prior_anomaly_auc= 0.28774411399172134
 first_prior_star_anomaly_auc= 0.31421882919809274


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4395127679080828; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.2571598270862239; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.2958278716037808 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44037654706805196; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.255238805383505; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.2949311050441303 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44046512836390694; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.2555231227685881; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.2949299295063127 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4405878665688619; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.2560420292748704; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.29502051825905623 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.44172162155253947 at iter 490
0.28774411399172134 at iter 0
0.31421882919809274 at iter 0
last anomaly aucs:
0.44172162155253947
0.25675086049368245
0.29520513798040915




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 54.27894568443298 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4420231560453509,first_prior_anomaly_auc= 0.25677950141763833, first_prior_star_anomaly_auc= 0.2951977170211606


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44202316207375003 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.2572291536754667 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2944421657095981 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44202316207375003 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.2623965647288498 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2950892058379981 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4420231620737499 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.26298297121945835 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29484603227653083 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44202316207375003 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.2635666709588868 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29548144965153444 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44202316207375003 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.2644595733147369 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29682319645973826 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44202316810214903 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.2624867797208514 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2944907425492605 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44202316207375 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.261784917331358 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29419281303908956 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44202316207375003 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.2613540254514186 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2938334782560469 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44202316207375003 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.26089196674831533 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29322810039358216 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.44202316207375003 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.26206930705722975 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29443139898886866 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4420231620737499 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.2606511020636898 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29299439744704536 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.44202316207375003 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.2600672455858856 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2924846902777356 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4420231681021491 at iter 74
max_prior_anomaly= 0.26467661376625923 at iter 41
max_prior_star_anomaly= 0.3162084359969694 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44202316810214903
accuracies_anomaly['prior'][-1]= 0.2590728491033842
accuracies_anomaly['prior_star'][-1]= 0.2921402396119833



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.04082179069519 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.44202316207375
 first_prior_anomaly_auc= 0.26065252476586903
 first_prior_star_anomaly_auc= 0.293164989083775


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5344704340784917; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.485986775380404; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5022687518175624 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5199201574714291; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.46495935171078734; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.48310235522317374 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5190501570036252; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.46837672454412044; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.48672732200669494 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.512228933036061; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4553082525407291; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.47547212612954115 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5804433610205646 at iter 10
0.5385197097301737 at iter 10
0.5581527646961518 at iter 10
last anomaly aucs:
0.5105736069937146
0.45776642268529966
0.47471281912536134




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.85661315917969 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5111401559378043,first_prior_anomaly_auc= 0.45294431833033605, first_prior_star_anomaly_auc= 0.4722798235752843


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5111401499094053 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3548976522520411 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3988760230796053 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5111401559378043 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.3351274451789446 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38041741479099056 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5111401499094053 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.328062390554415 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37346385540716054 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5111401559378043 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.3238120376519337 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36976543860943645 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5111401559378043 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.32114360297638944 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.367768012976973 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5111401559378043 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.3190279302962742 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3663240184922347 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5111401619662033 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.31728587367658556 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36495429991237116 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5111401559378043 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.315675706371632 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36369352053200377 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5111401499094052 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.31424297896474546 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3625074269876476 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5111401559378043 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.3127669013401855 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3612952787025342 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5111401619662033 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.31139433132756433 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36010378371261614 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5111401619662033 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.3100043874688392 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.35887254951606423 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5111401619662034 at iter 18
max_prior_anomaly= 0.45294431833033605 at iter 0
max_prior_star_anomaly= 0.4722798235752843 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5111401559378043
accuracies_anomaly['prior'][-1]= 0.30884846003340216
accuracies_anomaly['prior_star'][-1]= 0.3577703833434852



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.35212540626526 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5111401559378043
 first_prior_anomaly_auc= 0.30874934109598223
 first_prior_star_anomaly_auc= 0.35780469096256173


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5148627285305801; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4246439687796446; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 30 
last prior star auc 0.446106883997687 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5177228542395801; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4281235848333196; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 30 
last prior star auc 0.45104716908791287 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5080505652468099; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41446378716568305; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 30 
last prior star auc 0.43674940403246854 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5057681108781737; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41776753673344685; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 30 
last prior star auc 0.437455010057781 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5403456997500384 at iter 10
0.4494801349782664 at iter 30
0.47137163319940645 at iter 10
last anomaly aucs:
0.5077894511697264
0.41997516058449424
0.43866590443588893




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.6067008972168 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5081426369857233,first_prior_anomaly_auc= 0.41263960566553765, first_prior_star_anomaly_auc= 0.4342815522790001


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5081426369857234 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.3596016783545267 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42297582033248793 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5081426369857234 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.3839017932799266 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4125090064282025 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5081426309573243 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.3782817217975818 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4084461668786252 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5081426430141224 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.37485864007033454 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4060082340697143 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5081426430141224 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.3725852283002953 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40436965491996935 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5081426369857234 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.3708512075365598 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4031298242263514 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5081426369857234 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.36935541704705865 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4020633823466291 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5081426369857234 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.36809717562269745 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40115119514217135 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5081426430141224 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.36604509652431444 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3996898207829299 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5081426430141224 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.36470717774951666 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3986815167837864 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5081426369857234 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.36301436109338764 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3974569560249991 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5081426369857233 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.3615087684270074 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3963264382916192 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5081426430141225 at iter 26
max_prior_anomaly= 0.41263960566553765 at iter 0
max_prior_star_anomaly= 0.43874409880015575 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5081426369857233
accuracies_anomaly['prior'][-1]= 0.36119686508780485
accuracies_anomaly['prior_star'][-1]= 0.3959657169767916



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.32253003120422 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5081426369857234
 first_prior_anomaly_auc= 0.360699841670127
 first_prior_star_anomaly_auc= 0.39562387660783427


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4980473714009855; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3435734010636025; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.3741489467904562 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4892630836756258; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.336432659888817; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.36911653570572545 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4891656225479487; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.33197685311781566; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.3654765823221297 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4861820834532985; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.32310061422152386; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.3549912009487253 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5081426369857234 at iter 0
0.360699841670127 at iter 0
0.39562387660783427 at iter 0
last anomaly aucs:
0.48570524914408797
0.31933856164327407
0.353191199357228




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.5393750667572 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.48564979992949187,first_prior_anomaly_auc= 0.32625818114037053, first_prior_star_anomaly_auc= 0.3578113161731337


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.48564979992949187 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.24322309079395946 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3757308107618016 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.48564980595789087 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.30374210460574513 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3435632974667703 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.48564979992949187 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.2991826334844291 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.339258622660318 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.48564979992949187 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.29618479502719774 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3371121147189874 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.48564981198629 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.2944750867968898 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.335955596500442 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4856498059578909 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.2932535100956394 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.33518626426861775 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4856498059578909 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.29220766122712166 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.33409081976099564 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4856498059578909 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.29129614920335917 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3332017394101525 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.48564980595789087 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.2902586496675459 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3325127114822676 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.48564979992949187 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.28933855320351537 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.33205150278343243 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4856497999294918 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.28835685855784293 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.331092022788313 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.48564979992949187 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.28742859361308 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3296968342224016 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.48564981801468904 at iter 29
max_prior_anomaly= 0.32625818114037053 at iter 0
max_prior_star_anomaly= 0.40772973987699174 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4856498059578909
accuracies_anomaly['prior'][-1]= 0.28666901533094225
accuracies_anomaly['prior_star'][-1]= 0.3291889536580085



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.57800793647766 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4856498059578909
 first_prior_anomaly_auc= 0.28665897201810064
 first_prior_star_anomaly_auc= 0.3286325806515397


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5494349521272773; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.31837966037446486; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 80 
last prior star auc 0.3376627908883401 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.49591709190993666; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.3111613819309107; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 80 
last prior star auc 0.3434294790643346 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.48911726273065254; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.3108056641873067; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 80 
last prior star auc 0.3453306733625301 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4834907408613087; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.3116366488563645; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 80 
last prior star auc 0.34645293218919143 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6380159706759378 at iter 60
0.3208809757711408 at iter 80
0.35280234350396594 at iter 30
last anomaly aucs:
0.48589557775935494
0.310839573932045
0.3439991446907407




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.55530047416687 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.48933644929224185,first_prior_anomaly_auc= 0.3188416346799812, first_prior_star_anomaly_auc= 0.3518417120846252


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.48933645532064096 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.2457694745020422 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3882112606636351 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.48933644929224185 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.276048115546566 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3496888622674786 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.48933644929224185 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.30510248519545763 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3422100123027568 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.48933644326384274 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.3034832210363156 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.34113696932605875 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.48933645532064096 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.3022203980286653 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3404567488892072 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.48933645532064085 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.30119692657747527 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.339856374597966 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.48933645532064096 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.3002372295599896 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.33944019804014336 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.48933645532064096 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.29966318731586256 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.33928997636385294 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.48933644929224185 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.2988237568597153 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3385677440139203 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.48933645532064096 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.29815626237328907 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.33820624503561336 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.48933644929224185 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.29733260220909474 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3370615545360327 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.48933645532064096 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.2968089453243496 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.33693618192068653 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.48933645532064096 at iter 2
max_prior_anomaly= 0.3646570757248909 at iter 1
max_prior_star_anomaly= 0.43360499108038075 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.48933644929224185
accuracies_anomaly['prior'][-1]= 0.2964479828735594
accuracies_anomaly['prior_star'][-1]= 0.3367061623259782



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.45654916763306 seconds
back and forth 7/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.48933644929224185
 first_prior_anomaly_auc= 0.29602345698303223
 first_prior_star_anomaly_auc= 0.335907712926672


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.48597968598310415; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.30569308142341595; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.33119925595087385 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.48800371494063954; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.31088434685189764; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.3388276403543927 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.48482859332371686; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.30738997930571166; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.3352470184743906 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.48212272831838054; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.3014752879042826; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.32991451368422475 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.49479215044569164 at iter 10
0.3311331666119288 at iter 10
0.3636661937990441 at iter 10
last anomaly aucs:
0.48092604890526686
0.30437115599133646
0.3308786596602201




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.428903579711914 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4828428386718424,first_prior_anomaly_auc= 0.30356586435909194, first_prior_star_anomaly_auc= 0.33116931892111906


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.48284284470024147 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.22982002455728642 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3640599266271493 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4828428447002415 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.2639364710427056 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3263570951122223 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4828428447002414 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.2887352792523242 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.322012843865911 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4828428507286405 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.2866691901545151 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3209607857463568 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.48284284470024147 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.2847453652462312 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.31987831435352176 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4828428507286405 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.28349531641619874 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3191584391076233 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4828428386718424 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.2823162640419499 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.31875958816871225 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4828428447002415 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.2814437798737316 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3179921006270018 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4828428447002415 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.2796968462791998 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.31727506475706274 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4828428507286405 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.27925510328094416 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3167626267229767 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.48284284470024147 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.27901604108763894 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.31651483540782605 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4828428507286405 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.27768124502355657 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.31556334304146716 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4828428567570396 at iter 17
max_prior_anomaly= 0.3055489906289742 at iter 1
max_prior_star_anomaly= 0.39672063530645246 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4828428507286405
accuracies_anomaly['prior'][-1]= 0.27606486243916745
accuracies_anomaly['prior_star'][-1]= 0.3150467092416322



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.12478256225586 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 6 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5041822561066477
accuracies_anomaly["prior"][-1]= 0.26596259185471655
accuracies_anomaly["prior_star"][-1]= 0.5040625562148212


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam ellipticGGAD 
took 1160.0083525180817 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 5 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.010353565216064453 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5064722339173163
 first_prior_anomaly_auc= 0.26580484673639354
 first_prior_star_anomaly_auc= 0.5063511052949117


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4526297202967516; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26141944563806746; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.42450389289897994 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43793236280931114; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26132623453173087; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.3964987359652842 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4350911481881767; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2612175364681973; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.391489070030224 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4352274201490317; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26110149581460307; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.3901562753946311 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5064722339173163 at iter 0
0.26580484673639354 at iter 0
0.5063511052949117 at iter 0
last anomaly aucs:
0.43566637802691943
0.26100163538409826
0.3897255884802599




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.48990201950073 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43570839596839966,first_prior_anomaly_auc= 0.26099361761334233, first_prior_star_anomaly_auc= 0.3897106079085844


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43570840199679867 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.2605407100200191 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3990662492120882 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4357084019967987 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.26525762483970483 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41487328425734216 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4357083959683996 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6847714019017911 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45822680549346306 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43570840199679867 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6610915670413438 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5195809153424685 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43570840802519767 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.640274064283954 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5554355482153768 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43570840199679867 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.5547830945846168 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5197935430058754 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43570840199679867 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.4601404484357269 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4493330661546868 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43570839596839966 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.3757967915895635 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3865908028814783 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43570839596839955 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.33360081942822806 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3556407609479344 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4357084080251977 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.3158967918789266 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3412218853552825 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4357083959683996 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.3056475549536802 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.33260137717570953 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4357083959683996 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.29888808590613347 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3265520716231682 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4357084080251978 at iter 56
max_prior_anomaly= 0.6880553542070268 at iter 31
max_prior_star_anomaly= 0.5554355482153768 at iter 50
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4357084080251977
accuracies_anomaly['prior'][-1]= 0.29499969616868715
accuracies_anomaly['prior_star'][-1]= 0.32295273759246956



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.63663601875305 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4357083959683996
 first_prior_anomaly_auc= 0.29426605205932527
 first_prior_star_anomaly_auc= 0.32231907448159386


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44343131169765015; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.2696206786626985; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.30261696420433093 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4435506619423309; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.2675204326557895; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.30162333332851066 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44323294722643003; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.2677414397938963; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.30215821509231405 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44261111786291807; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.26734143743076383; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.3023257443023189 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4435584385771242 at iter 210
0.29426605205932527 at iter 0
0.32231907448159386 at iter 0
last anomaly aucs:
0.4420398788243561
0.26701824892851234
0.3024994948201584




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.56887602806091 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44196191353925385,first_prior_anomaly_auc= 0.2669347978002613, first_prior_star_anomaly_auc= 0.3024947504700946


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44196191353925385 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23447514828656021 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3486107735207635 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44196190751085473 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2633056473077893 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29735083811626517 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4419619014824557 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2628968012832291 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2957747493512237 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44196190148245573 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.25697576800598404 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29522981824617955 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44196190751085473 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2610338330635022 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29342241980903 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44196190751085473 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.25979166937944626 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2920461061605898 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44196190751085473 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.25131578249343267 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2922911786677624 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44196191353925385 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.25917926240367223 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29117585852842437 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4419619014824557 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.25694742850198143 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2899392711135032 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4419619014824557 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.2580799657490479 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2898922857711938 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.44196190751085473 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.25578690742645716 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2885234473375937 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.44196191353925385 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.25645285261432377 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.28981440488367843 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.44196191956765285 at iter 58
max_prior_anomaly= 0.2713116566571129 at iter 15
max_prior_star_anomaly= 0.36218318954395884 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44196190148245573
accuracies_anomaly['prior'][-1]= 0.2568209707748036
accuracies_anomaly['prior_star'][-1]= 0.28843226780174186



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.66186714172363 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.44196190751085473
 first_prior_anomaly_auc= 0.2568024093340837
 first_prior_star_anomaly_auc= 0.288386916155579


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6074553090663746; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4597649334295948; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.4950439205042249 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.558436997683648; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.43246952403136896; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.4729808178753125 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5416973632747035; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41115661949564963; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.44957181487124065 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5312405926832597; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4074435054610061; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.44656726077745124 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6572545874911201 at iter 10
0.507268386496579 at iter 10
0.546799179317865 at iter 10
last anomaly aucs:
0.5263323545624612
0.40878441432173995
0.44615147606556776




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.44070243835449 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.526308343448987,first_prior_anomaly_auc= 0.4203175615945646, first_prior_star_anomaly_auc= 0.45715277988771746


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.526308343448987 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26335190924221097 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43646245826539326 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.526308343448987 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.29965575429981595 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39554179995457 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5263083374205879 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.3478779070748809 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40271141716087483 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5263083494773861 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.341370624045403 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39736153249620576 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.526308343448987 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.33767399768220113 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39448051235604786 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5263083374205879 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.3353394338320507 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3926524787089002 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.526308343448987 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.3335878221998448 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3912185215086044 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5263083374205879 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.33207616496400566 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3899289987214971 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.526308349477386 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.33067283805935704 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3887028404369577 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5263083434489869 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.32923300919837245 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38739852998694485 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5263083374205879 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.32773778537838333 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3859853285646285 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.526308343448987 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.32624332113667637 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3845508951208067 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5263083494773861 at iter 26
max_prior_anomaly= 0.4203175615945646 at iter 0
max_prior_star_anomaly= 0.45715277988771746 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5263083434489869
accuracies_anomaly['prior'][-1]= 0.32493569506717807
accuracies_anomaly['prior_star'][-1]= 0.3832507744081438



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.72175550460815 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.526308343448987
 first_prior_anomaly_auc= 0.32480538519299806
 first_prior_star_anomaly_auc= 0.38311705848849226


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.47954531644031234; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3171606336860188; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.3569861549375723 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4764987383766437; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3119450496957105; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.35450950774986867 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.47235204982447715; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3118487580774519; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.35247133013972864 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4697610861053118; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.30387719500038346; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.34674242194067184 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.526308343448987 at iter 0
0.3390669798540549 at iter 20
0.38311705848849226 at iter 0
last anomaly aucs:
0.4694018116062597
0.29347984031012014
0.3384615597927967




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.35700011253357 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.47026180493161623,first_prior_anomaly_auc= 0.30866278534221286, first_prior_star_anomaly_auc= 0.35141370177943865


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4702617989032173 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.20617303241494292 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3643232832686848 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4702618109600153 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.29271480029842983 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3507736063667611 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4702618109600154 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.26855098144748135 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3178657333258099 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4702618109600153 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.26641264801528225 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.31513512174231345 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4702618109600153 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.2661518112445557 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.31433089713670337 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4702618109600154 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.26586469065390766 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3135242913134627 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4702618109600153 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.2651773868481553 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.31259929376099277 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.47026181096001535 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.2646973695442386 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3116904945168093 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4702618109600153 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.26427414578790936 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.31081389898042894 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.47026181698841435 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.26332271370554117 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3096339845451138 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4702617989032172 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.26268663923503954 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3085324694396338 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.47026181698841435 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.2620332632592226 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.30761010629755503 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.47026182301681346 at iter 1
max_prior_anomaly= 0.30866278534221286 at iter 0
max_prior_star_anomaly= 0.3712435719180775 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.47026181096001535
accuracies_anomaly['prior'][-1]= 0.2616248331941979
accuracies_anomaly['prior_star'][-1]= 0.306961390274215



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.70899987220764 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.47026181096001535
 first_prior_anomaly_auc= 0.26165268439787626
 first_prior_star_anomaly_auc= 0.30701532033224677


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4767324533799787; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.31794461492757; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.34902728164053476 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46975651657882084; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.3162823682830974; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.3465475479125101 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.47281491633305506; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.32018862016697214; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.35050343160588354 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46832626684394985; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.3152978523466629; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.3460056370353973 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.47815108638985215 at iter 70
0.3271038027623572 at iter 10
0.35838681728983435 at iter 90
last anomaly aucs:
0.47243049135310555
0.3225744374659697
0.35336648108842983




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.45543432235718 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.47448970807598095,first_prior_anomaly_auc= 0.31624253262207874, first_prior_star_anomaly_auc= 0.3470277279832015


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.47448973218957724 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.21406168089127708 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3777598674041569 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4744897201327792 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.2400225896169748 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3353966373107746 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.47448973821797624 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.28263753551329884 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.32552673136826815 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.47448971410438 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.27843548214412306 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3207060979426762 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4744897080759809 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.27507335958821694 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.31697010613358256 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.47448973821797624 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.2722974445857501 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.31385401460030027 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.47448971410438007 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.27000468768311264 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.311220683292509 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.474489720132779 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.2682440575659061 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.30939234219700906 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.47448971410438007 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.2667192282781108 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3074094691198875 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4744897201327791 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.26522287111909754 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.30571150421095733 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4744897321895773 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.26368761872931956 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.30362340542816346 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.47448971410438007 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.2626478645722562 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.30290724367608884 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.47448973821797635 at iter 57
max_prior_anomaly= 0.31624253262207874 at iter 0
max_prior_star_anomaly= 0.38514562683052334 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.47448970807598095
accuracies_anomaly['prior'][-1]= 0.26180716212390626
accuracies_anomaly['prior_star'][-1]= 0.3017359438230371



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.52064204216003 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4744897201327791
 first_prior_anomaly_auc= 0.261679076728981
 first_prior_star_anomaly_auc= 0.3011719087213573


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45783499572465935; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.263647704699113; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.2984252796815462 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.45828541358916897; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26370335285087815; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.2990079907635281 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4689461972617565; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2678054734487603; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.28894527250533997 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46017670925610044; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26140800373664286; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.28964069053623337 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.576600310872483 at iter 460
0.27750484201012865 at iter 10
0.32291878564893783 at iter 410
last anomaly aucs:
0.572877635796923
0.26464455474003373
0.30832611733965304




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.47366738319397 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5713218084811377,first_prior_anomaly_auc= 0.260032461723283, first_prior_star_anomaly_auc= 0.30052339766358543


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5713218084811376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2029216816918485 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38126292187339494 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5713217964243394 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23835073973279242 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29131972627210073 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5713217964243396 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24707558744337527 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.28113092404747675 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5713218084811376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2459431888494873 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.28010740436909426 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5713218084811376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24387073979066504 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.28042575809529596 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5713217964243394 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2454766209038837 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.28028329496860166 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5713218084811376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2433605322642329 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2826448720749605 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5713217964243396 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24506405535710063 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.27943392971079595 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5713217964243394 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24519100741300176 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2800871730618335 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5713218084811376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24457262629375473 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.27930448189768214 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5713218084811376 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24480981365495083 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.27880646982255775 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5713217964243396 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2449216585427961 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2792896460075842 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5713218084811377 at iter 0
max_prior_anomaly= 0.260032461723283 at iter 0
max_prior_star_anomaly= 0.40154568754855874 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5713217964243394
accuracies_anomaly['prior'][-1]= 0.2443178601208863
accuracies_anomaly['prior_star'][-1]= 0.2784868380757543



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.53145599365234 seconds
back and forth 7/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5713218084811376
 first_prior_anomaly_auc= 0.24418714031556982
 first_prior_star_anomaly_auc= 0.2784774277448145


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5866012983242498; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.3892596957153516; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 80 
last prior star auc 0.5006678863323654 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5886451305727123; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.3914296722142406; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 120 
last prior star auc 0.5036810670652162 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5881811849807019; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4041902075650139; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 210 
last prior star auc 0.5040784109043611 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5886129690637029; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 320 
last prior auc 0.40088011009303504; count_not_improved_prior_anomaly= 31; iter_best_prior_anomaly= 210 
last prior star auc 0.4984143260804459 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5973064630707507 at iter 480
0.41345196258148587 at iter 440
0.5125330838540665 at iter 210
last anomaly aucs:
0.5935045989450785
0.39714285232013785
0.4951121800668333




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.52627515792847 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5933743192128937,first_prior_anomaly_auc= 0.39973717385758223, first_prior_star_anomaly_auc= 0.49463423050379574


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5933743192128937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2943889228890596 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5414542138268326 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5933743192128937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.30413671155171473 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5081026023875355 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5933743192128937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3678054855055584 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4812015286573212 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5933743192128937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3673772822916019 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4791341555105113 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5933743192128937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3655563561269513 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47781221802163376 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5933743192128937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3637687368671326 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47663580608617523 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5933743192128937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.36217913243138833 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47555305135858406 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5933743192128937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.36072818720252864 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47446757782301485 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5933743192128937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3592089040418728 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47338125428317757 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5933743192128937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.35784780607267164 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4723701289932718 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5933743192128937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.35653040796828966 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47136242783403476 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5933743192128937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3552793825376088 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.470402260601422 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5933743192128937 at iter 0
max_prior_anomaly= 0.39973717385758223 at iter 0
max_prior_star_anomaly= 0.5451397539641547 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5933743192128937
accuracies_anomaly['prior'][-1]= 0.35422698079930776
accuracies_anomaly['prior_star'][-1]= 0.46964052415241914



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.67532920837402 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 6 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5064722339173163
accuracies_anomaly["prior"][-1]= 0.26580484673639354
accuracies_anomaly["prior_star"][-1]= 0.5063511052949117


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam ellipticGGAD 
took 1155.952451467514 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 6 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 2e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.010560035705566406 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49989404485804084
 first_prior_anomaly_auc= 0.2658672044963176
 first_prior_star_anomaly_auc= 0.499771873322598


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46621009983511125; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2614480021644364; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4493777667337507 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44634431249484574; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26139762283345364; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.41017645606333963 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43910980560100965; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26132520970388984; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.397736878707164 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4368864114580093; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26123644152766384; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.394203495362232 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.49989404485804084 at iter 0
0.2658672044963176 at iter 0
0.499771873322598 at iter 0
last anomaly aucs:
0.4365559346212887
0.2611748855448154
0.39300312656889086




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.1999249458313 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4365135429190666,first_prior_anomaly_auc= 0.2611683628170275, first_prior_star_anomaly_auc= 0.3929178428073241


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43651354291906663 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5167195598400594 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49209106596081353 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4365135489474656 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.34279878192579866 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3616105157464195 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43651354894746563 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.33758252275479517 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3524419778646832 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4365135368906675 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.3110040527721232 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3359627461817326 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43651354894746563 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.2959647644897394 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.32445338094321774 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43651354894746563 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.29891970485922725 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.32583716377809896 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4365135549758647 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.2972767732053576 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.32788305171064264 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43651356100426375 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.29405150133661667 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.32730145588248766 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43651355497586475 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.2889509512572588 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3192724903895262 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43651355497586475 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.2855556905916946 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3158671803827213 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43651354894746563 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.28486385945824466 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3157909211345543 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4365135489474656 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.28331333110523704 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3138402638220339 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43651356100426375 at iter 80
max_prior_anomaly= 0.6472704253011426 at iter 4
max_prior_star_anomaly= 0.5426274307107868 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4365135429190666
accuracies_anomaly['prior'][-1]= 0.275805713620179
accuracies_anomaly['prior_star'][-1]= 0.30989081845886146



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.13026833534241 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43651353689066746
 first_prior_anomaly_auc= 0.28050074535126035
 first_prior_star_anomaly_auc= 0.3175802042325149


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44125747099496077; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.2505064156634205; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.2971684609593642 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4417615416111451; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.23877642307594002; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.29082512627084683 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44186457297955795; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.23537359676954975; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.28886285826172803 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44183543772687883; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 330 
last prior auc 0.23330243175972828; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.2873787990368065 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.44189139935539534 at iter 330
0.28050074535126035 at iter 0
0.3175802042325149 at iter 0
last anomaly aucs:
0.44168088766006
0.232357245098791
0.28682208241159113




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.5293447971344 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44166522587929025,first_prior_anomaly_auc= 0.23223764166134964, first_prior_star_anomaly_auc= 0.2867230659569553


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44166522587929025 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.2333130116000866 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29908141666413474 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44166522587929025 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.23257798095893986 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.298347977520341 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4416652258792902 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.23372751226296937 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29767889153656174 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4416652198508912 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.2389524523286259 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2894374310049727 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44166521985089113 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.2423662141509193 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2868104596581946 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4416652258792902 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.2363638939406873 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2812716148248461 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44166521382249213 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.23982410457777334 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29359265577021476 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4416652198508912 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.24286391877769148 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2862344340707753 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44166521985089113 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.22707761539682056 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.28788694485075855 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.44166522587929025 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.24321329464547947 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.28648850697775136 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.44166521382249213 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.23868617794194313 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2796208100817981 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.44166522587929025 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.23804548571775808 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2849143653856077 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4416652379360884 at iter 63
max_prior_anomaly= 0.2663393065122625 at iter 59
max_prior_star_anomaly= 0.35217078430436377 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4416652258792902
accuracies_anomaly['prior'][-1]= 0.24300879929241065
accuracies_anomaly['prior_star'][-1]= 0.28140622897595824



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.5734486579895 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.44166521382249213
 first_prior_anomaly_auc= 0.2428501921130214
 first_prior_star_anomaly_auc= 0.27928561300861


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45060422040984427; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.2862609771118567; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.3213469710188332 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4504017988260537; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.2823381712441506; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.31788384866499897 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4502811223335788; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.2781264784648706; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.31361414460152043 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4505436892548368; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.28272122174911346; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.3177939953769413 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.45289601879703056 at iter 10
0.29801800104074283 at iter 10
0.33120387370455734 at iter 10
last anomaly aucs:
0.4497519796056848
0.27873912054820815
0.314727656221139




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.4291045665741 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44941438925806804,first_prior_anomaly_auc= 0.28134010949501786, first_prior_star_anomaly_auc= 0.316159859157307


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.449414383229669 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.26073254573505233 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3013573061061895 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44941439528646715 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.26019799553319745 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29776500721719934 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.449414389258068 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.25812637236504704 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29465787388492704 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.449414383229669 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.25547546224558343 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2947897451144649 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4494143892580681 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.25664402520545987 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2941544121370482 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.449414383229669 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.2650484333637647 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.31031879862205264 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44941440131486615 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.25753704210089223 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2935548094808873 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.449414383229669 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.2578771704045152 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29238387133177945 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.449414389258068 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.2596363959047397 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29859505145600307 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4494143892580681 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.2581339199206759 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29255644631180133 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.449414383229669 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.25606833720838823 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2919903193556461 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4494143892580681 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.25295685740039037 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2918080326247312 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4494144013148662 at iter 126
max_prior_anomaly= 0.28134010949501786 at iter 0
max_prior_star_anomaly= 0.4009611679468575 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4494143892580681
accuracies_anomaly['prior'][-1]= 0.2590085381421632
accuracies_anomaly['prior_star'][-1]= 0.296242318011072



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.1747214794159 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.449414383229669
 first_prior_anomaly_auc= 0.2559307209145419
 first_prior_star_anomaly_auc= 0.29232857282716


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44003070384211573; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2748719507754691; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.2973590548241902 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5604184480585903; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.28932423575573696; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 200 
last prior star auc 0.3540669388609412 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5583737718342585; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.2772675642229466; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 200 
last prior star auc 0.33711901120751725 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5599409204834873; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.28264567988043515; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 200 
last prior star auc 0.3541439154885969 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5631103271780968 at iter 480
0.28932423575573696 at iter 200
0.4418115954085784 at iter 470
last anomaly aucs:
0.5622459512066202
0.280602366074292
0.43925483682570554




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.58798027038574 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5632939702988012,first_prior_anomaly_auc= 0.28723341816496495, first_prior_star_anomaly_auc= 0.4422752878078281


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5632939702988012 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2990402125565283 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5387102131690136 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5632939702988012 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2780190162231453 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48716615328820234 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5632939702988012 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2753619149378424 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4401528934627559 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5632939702988012 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2538413983667379 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4243977207346545 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5632939702988012 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2467208282152225 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41771267830195913 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5632939702988012 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2468726172752697 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42145963576895124 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5632939702988012 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2387319636328387 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41835273151584335 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5632939702988012 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24346474519886238 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4165622789084643 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5632939702988012 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23998827596949918 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4163464441367549 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5632939702988012 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24334614247566574 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42169619014824555 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5632939702988012 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23689943279998882 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4102527575103001 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5632939702988012 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2362254517561691 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4119637919884023 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5632939702988012 at iter 0
max_prior_anomaly= 0.45607881456596255 at iter 1
max_prior_star_anomaly= 0.5543989891098177 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5632939702988012
accuracies_anomaly['prior'][-1]= 0.23705504386504297
accuracies_anomaly['prior_star'][-1]= 0.4075402311239974



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.43568992614746 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5632939702988012
 first_prior_anomaly_auc= 0.2403734243573365
 first_prior_star_anomaly_auc= 0.4208963421603564


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5678041050021726; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.2651561186562554; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.43251736540634544 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5689057165620377; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.2653644842415237; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.4761220779746894 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5688847739036873; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.2630246455421918; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.4728732772643993 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5688837490758464; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 330 
last prior auc 0.2635279083529015; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.4730995230812932 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5694387777493237 at iter 330
0.2703248137586393 at iter 10
0.47658057992234454 at iter 180
last anomaly aucs:
0.5687093535193071
0.26782293169245136
0.47369936084501757




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.529529094696045 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5685234497489533,first_prior_anomaly_auc= 0.2629311571294982, first_prior_star_anomaly_auc= 0.4716617077055961


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5685234497489533 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.28841502055201806 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5473305043262203 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5685234497489533 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.27994343794293663 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5235343213638265 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5685234497489533 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26623947622375294 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48631708342195085 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5685234497489533 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.25787997361008025 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.465896363862593 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5685234497489533 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2514416916362956 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46307241457637954 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5685234497489533 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24524249596941242 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4632331075818451 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5685234497489533 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24582904111319936 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4682374926393247 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5685234497489533 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24530059767959683 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45952958473011346 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5685234497489533 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24725915822329092 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46018019969915874 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5685234497489533 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2415368812632052 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45715834410005407 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5685234497489533 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2423625127138936 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4613704829808649 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5685234497489533 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24039965995006557 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45727379999893897 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5685234497489533 at iter 0
max_prior_anomaly= 0.4783056243998729 at iter 1
max_prior_star_anomaly= 0.5604320119564856 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5685234497489533
accuracies_anomaly['prior'][-1]= 0.23956270716593384
accuracies_anomaly['prior_star'][-1]= 0.46260106611031776



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.9502637386322 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5685234497489533
 first_prior_anomaly_auc= 0.24160865538246815
 first_prior_star_anomaly_auc= 0.45989874580363144


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5693901526824687; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.29938973913429295; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 90 
last prior star auc 0.503611324516438 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.569527666493531; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.29626986779479714; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 160 
last prior star auc 0.531306428829444 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5698587039713646; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.29256166690539126; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 160 
last prior star auc 0.5304621394836507 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.569953850193801; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.2936772522942881; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 160 
last prior star auc 0.5416170891127595 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5708185215568317 at iter 180
0.3065048354994577 at iter 160
0.5427425429909252 at iter 420
last anomaly aucs:
0.5696863038149156
0.29687630665549725
0.5409931196675796




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.387521266937256 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5709010021128333,first_prior_anomaly_auc= 0.30157892211260184, first_prior_star_anomaly_auc= 0.5483630123476081


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5709010021128333 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2738199288263093 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5513855069570136 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5709010021128333 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.28676546368757655 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5457892416225749 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5709010021128333 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2740088106258009 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5467601816043162 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5709010021128333 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26212504563498096 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5453239999247657 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5709010021128333 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2561262038110092 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5452755979086761 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5709010021128333 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.25493140525840374 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5447763379549452 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5709010021128333 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.25896353011474693 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5451688168760451 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5709010021128333 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2566538997231277 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5449310628453369 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5709010021128333 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.254011471561148 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5447664634372774 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5709010021128333 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2585742281599542 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5465371187821283 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5709010021128333 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.25585712621876144 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5448829381356043 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5709010021128333 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.25153685594392916 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5445044631855315 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5709010021128333 at iter 0
max_prior_anomaly= 0.4157319272213083 at iter 1
max_prior_star_anomaly= 0.5639084209018581 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5709010021128333
accuracies_anomaly['prior'][-1]= 0.25005298359937866
accuracies_anomaly['prior_star'][-1]= 0.5443325453010076



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.67609810829163 seconds
back and forth 7/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5709010021128333
 first_prior_anomaly_auc= 0.2503176604603093
 first_prior_star_anomaly_auc= 0.5444748456609272


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5704900461486005; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.2370141291205916; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5424606249086698 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5714711560395637; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.23569735796971233; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5427865623608947 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5717713100289894; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.2358786922135751; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5427061194037769 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5708025462993105; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.2355448635869746; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5426572592293584 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5719174203371177 at iter 390
0.2503176604603093 at iter 0
0.5444748456609272 at iter 0
last anomaly aucs:
0.5716498799866314
0.23176251338907433
0.5423761730661739




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.431718826293945 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5715794080015664,first_prior_anomaly_auc= 0.23361000670840248, first_prior_star_anomaly_auc= 0.5433581209046071


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5715794080015664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24891130127093122 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.543961461168188 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5715794080015664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2609477173828646 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5460445744649555 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5715794080015664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2535507571910361 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5457888678618329 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5715794080015664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2511615519317643 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.544655625292076 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5715794080015664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2483842383407145 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5441306723015318 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5715794080015664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24793925809216122 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5445117696051976 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5715794080015664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2429212428243966 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5439991929179333 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5715794080015664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.23826218857893272 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5434359716501271 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5715794080015664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24157463109814764 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5437654779145983 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5715794080015664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24370032297750827 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5444819832854196 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5715794080015664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24717348261578506 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5443948307201429 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5715794080015664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24225234974938736 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5441003735678331 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5715794080015664 at iter 0
max_prior_anomaly= 0.26806303679879473 at iter 1
max_prior_star_anomaly= 0.5488556772327622 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5715794080015664
accuracies_anomaly['prior'][-1]= 0.2417542291630798
accuracies_anomaly['prior_star'][-1]= 0.5438144707137962



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.57482671737671 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 6 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.49989404485804084
accuracies_anomaly["prior"][-1]= 0.2658672044963176
accuracies_anomaly["prior_star"][-1]= 0.499771873322598


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam ellipticGGAD 
took 1153.793296098709 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 7 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 2e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.010384798049926758 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5035831176372149
 first_prior_anomaly_auc= 0.2655825314356898
 first_prior_star_anomaly_auc= 0.5034634900861772


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4686727973073793; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26150052760548614; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4523074842815523 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4473457441190556; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26142714390367294; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4112201648501895 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4395799725008548; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2613357413170557; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.39795652945548127 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43715717097359613; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2612532848746503; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.39436188551925494 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5035831176372149 at iter 0
0.2655825314356898 at iter 0
0.5034634900861772 at iter 0
last anomaly aucs:
0.4362527061483401
0.2611911019382991
0.3928625623879019




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.20880603790283 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43619936084501754,first_prior_anomaly_auc= 0.26118454304011685, first_prior_star_anomaly_auc= 0.39273300003520584


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43619935481661853 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.515349955799778 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48969005709617325 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4361993548166185 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.32254749655055004 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.35003179980506566 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43619935481661853 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.2998615939858762 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.33343107176736747 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4361993487882194 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.3016169371971031 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.32992575664848023 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43619935481661853 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.2704812024871728 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.35342649982951685 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43619935481661853 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.2870206217063842 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3194873907593805 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43619935481661853 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.2897195058256037 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.32035034402867785 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4361993487882195 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.28641934315528333 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.32052054381946826 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43619935481661853 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.28409188075923103 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.33181778175169846 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43619936084501765 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.2869568352158818 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3185861149572297 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4361993487882194 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.2869285921662642 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3168318628862335 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4361993548166185 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.28146260053561123 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.319671690975583 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43619936084501765 at iter 3
max_prior_anomaly= 0.6580642195706912 at iter 4
max_prior_star_anomaly= 0.5518812523540898 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43619935481661853
accuracies_anomaly['prior'][-1]= 0.28355897028192173
accuracies_anomaly['prior_star'][-1]= 0.3161840752363494



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.55030155181885 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43619936084501754
 first_prior_anomaly_auc= 0.28221926710100076
 first_prior_star_anomaly_auc= 0.3135759546934463


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.440804985389572; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.25494224431992185; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.2877298266859382 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4414567216408434; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.24745367054750883; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.2836403476408945 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44238055571229395; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.2444427685495045; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.28255469325335336 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44327072720336774; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.24192566477567845; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.28129088761665555 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.44364834612077336 at iter 490
0.28221926710100076 at iter 0
0.3135759546934463 at iter 0
last anomaly aucs:
0.44364834612077336
0.24106502038322292
0.28016874935797553




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.28054332733154 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4430633080767526,first_prior_anomaly_auc= 0.2411528179871995, first_prior_star_anomaly_auc= 0.2802201052896067


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4430633020483536 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26030701310188137 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.35182898010580077 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44306330204835354 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.31154240086538876 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39650668139525125 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4430633020483536 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.27719721883426196 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.33879969872472837 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44306330204835354 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.26908160716154517 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.31652142444800363 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44306330204835354 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.254107335163073 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3059742580125864 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44306330204835354 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2531430505338991 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.29377772762149756 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44306330204835354 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.24244103864010894 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2897736167356074 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4430632960199545 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.24952939302702315 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.2910552784903345 iter_best_prior_star_anomaly= 180
                                       
