

/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 0 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003687620162963867 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.47440554994671247
 first_prior_anomaly_auc= 0.41219956892234366
 first_prior_star_anomaly_auc= 0.4710228518096167


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5458181360228958; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41199557606869414; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5229785848365103 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.545548764874086; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4119901278774308; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5193113234788127 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5420567885929961; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4119985097101436; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5151119205167568 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.542768091871592; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 230 
last prior auc 0.41200668199703866; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5145561002349847 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5500041280526111 at iter 490
0.41219956892234366 at iter 0
0.525394019478541 at iter 70
last anomaly aucs:
0.5500041280526111
0.41200353880977136
0.5205201933018261




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 66.24473571777344 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.55074110069389,first_prior_anomaly_auc= 0.4120041674472248, first_prior_star_anomaly_auc= 0.5211201229782496


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5507415197855257 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4187322645658441 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5099490258843568 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5507413102397078 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.40825644049548365 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5061283769880136 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5507413102397078 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4078976980553729 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5055062354549009 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5507413102397078 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.40578715257827275 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5052355022582753 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5507413102397078 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4051719260571482 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5053117769359624 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.55074110069389 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4049130321992295 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.505367516123503 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5507415197855257 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.40605547599799335 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5059844190111701 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5507413102397078 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.405983077917936 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5063381323516531 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5507413102397078 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.40762874599819876 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5062978995546313 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5507413102397078 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.40731830386909584 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5066398783293163 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5507413102397078 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4066678736505773 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5071144996066825 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5507413102397078 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4128540852843098 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5118159743482392 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5507415197855257 at iter 3
max_prior_anomaly= 0.42910562073128977 at iter 5
max_prior_star_anomaly= 0.5211201229782496 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5507413102397078
accuracies_anomaly['prior'][-1]= 0.40659578988924666
accuracies_anomaly['prior_star'][-1]= 0.5076553373624804



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.78321623802185 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5507415197855257
 first_prior_anomaly_auc= 0.406628269491009
 first_prior_star_anomaly_auc= 0.5078219262876486


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5631434890133032; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4301703230316418; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 80 
last prior star auc 0.5212907980468653 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46165060078881426; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4301481111749528; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 80 
last prior star auc 0.4589147705913341 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46158082203147965; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4284302545604504; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 80 
last prior star auc 0.4582984963411205 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46128588629289563; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4229099795357554; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 80 
last prior star auc 0.4608189134378799 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.56749093609565 at iter 160
0.4328977713964091 at iter 80
0.5235177462257655 at iter 160
last anomaly aucs:
0.4612446057667847
0.42161194796725887
0.460788319748478




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.141277551651 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46124764418114317,first_prior_anomaly_auc= 0.42095282159730074, first_prior_star_anomaly_auc= 0.46077176562887


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46124764418114317 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43224524571971235 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46077448972450175 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46124764418114317 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4340825434503731 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46077679472849775 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46124764418114317 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4348298886096342 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4607858051986642 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46124764418114317 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43486582571739063 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46078769111102447 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46124764418114317 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43730263403283914 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4607946061230126 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46124764418114317 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43696023616651847 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46079994954136705 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46124764418114317 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4337694819985474 iter_best_prior_anomaly= 650
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46079722544573537 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46124764418114317 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4190436496511271 iter_best_prior_anomaly= 750
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4607948156688304 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46124764418114317 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43846833741738134 iter_best_prior_anomaly= 870
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608073884178997 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46124764418114317 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4390976035082999 iter_best_prior_anomaly= 960
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46081702752551956 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.46124764418114317 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4372425991560333 iter_best_prior_anomaly= 960
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46081723707133737 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.46124764418114317 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4368971628753542 iter_best_prior_anomaly= 960
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608216375335116 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.46124764418114317 at iter 0
max_prior_anomaly= 0.4411620489054794 at iter 96
max_prior_star_anomaly= 0.46083305778058287 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46124764418114317
accuracies_anomaly['prior'][-1]= 0.43975295805353726
accuracies_anomaly['prior_star'][-1]= 0.4608272952705928



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.47168183326721 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46124764418114317
 first_prior_anomaly_auc= 0.4369170697280472
 first_prior_star_anomaly_auc= 0.4608204850315135


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4610466897418521; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41196540147092786; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.46061586354041073 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46101504832336104; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41088854551314213; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4605330929423711 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46107099705671944; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4138430367715192; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4611179353199115 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4610765500208917; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41242975500322077; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4611118584911947 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.46124764418114317 at iter 0
0.4369170697280472 at iter 0
0.4611233835111749 at iter 470
last anomaly aucs:
0.4610937327779532
0.41015429696749484
0.4611086105310184




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.20056557655334 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4610977141484917,first_prior_anomaly_auc= 0.41437119700533886, first_prior_star_anomaly_auc= 0.4611156303159155


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4610977141484917 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4107521311857401 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4610900657261412 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4610977141484917 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4155528258720354 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611022193835749 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4610977141484917 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4159184833241343 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46110180029193926 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4610977141484917 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41486624899994257 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611011716544858 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4610977141484917 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41446297807354476 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611007525628501 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4610977141484917 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4130883575086344 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461099704833761 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4610977141484917 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4132373445851056 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611013812003036 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4610977141484917 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4125341088204959 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46110263847521055 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4610977141484917 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41400564432614884 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46110190506484816 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4610977141484917 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41284297935596515 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611003334712145 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4610977141484917 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4132500221070838 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46110263847521055 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4610977141484917 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41295906773903834 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611047339333887 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4610977141484917 at iter 0
max_prior_anomaly= 0.4163275167605222 at iter 49
max_prior_star_anomaly= 0.4611156303159155 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4610977141484917
accuracies_anomaly['prior'][-1]= 0.41303481855218094
accuracies_anomaly['prior_star'][-1]= 0.46110452438757094



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.16562342643738 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4610977141484917
 first_prior_anomaly_auc= 0.40949527537044556
 first_prior_star_anomaly_auc= 0.4610988666504897


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4611634067623789; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4223523781145319; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 50 
last prior star auc 0.46114014717660057 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46120741138412136; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.42323247054938307; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 50 
last prior star auc 0.4611508340133095 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4612336046113491; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4210211335339106; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 50 
last prior star auc 0.46115649175039064 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4612505778225926; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.42310160918615336; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 50 
last prior star auc 0.46116193994165405 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4612646173923867 at iter 490
0.42745691423666865 at iter 50
0.46117409359908773 at iter 390
last anomaly aucs:
0.4612646173923867
0.4246410375367805
0.46116717858709966




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.25305032730103 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4612579119262164,first_prior_anomaly_auc= 0.4203105636656772, first_prior_star_anomaly_auc= 0.46116131130420057


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4612579119262164 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40977501903723756 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611411949056898 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4612579119262164 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4266987774677897 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46116256857910753 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4612579119262164 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.432081171344358 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611688549536421 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4612579119262164 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4343202731806918 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46116927404527785 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4612579119262164 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43528219325740236 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46117136950345605 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4612579119262164 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43554967849385173 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46117095041182044 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4612579119262164 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43726554442308474 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46117304586999863 iter_best_prior_star_anomaly= 670
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4612579119262164 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43595504487842784 iter_best_prior_anomaly= 770
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611722076867273 iter_best_prior_star_anomaly= 750
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4612579119262164 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43754822173132624 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46117388405326987 iter_best_prior_star_anomaly= 840
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4612579119262164 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4405288014440221 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611798561090778 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4612579119262164 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4396834936149294 iter_best_prior_anomaly= 1060
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46117891315289766 iter_best_prior_star_anomaly= 1070
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4612579119262164 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44002149101907584 iter_best_prior_anomaly= 1060
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611763986030838 iter_best_prior_star_anomaly= 1070
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4612579119262164 at iter 0
max_prior_anomaly= 0.4419903835233286 at iter 128
max_prior_star_anomaly= 0.4611827897505273 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4612579119262164
accuracies_anomaly['prior'][-1]= 0.4402331322950757
accuracies_anomaly['prior_star'][-1]= 0.46117828451544407



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.34947776794434 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4612579119262164
 first_prior_anomaly_auc= 0.44139569249235056
 first_prior_star_anomaly_auc= 0.4611833136150718


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46128620061162234; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4245506185163904; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4611851995274323 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46129416335269957; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4237641930621056; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.46117367450745206 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4613000306355986; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4250586623516992; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.46117283632418077 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46132758591064216; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.4249381735064517; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4611931622685095 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4613395300222579 at iter 490
0.44139569249235056 at iter 0
0.4612001820534065 at iter 490
last anomaly aucs:
0.4613395300222579
0.42603996541655825
0.4612001820534065




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.20241808891296 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4613384822931688,first_prior_anomaly_auc= 0.4264792782236214, first_prior_star_anomaly_auc= 0.4611933718143273


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4613384822931688 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4086366613819211 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46118362793379863 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613384822931688 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41266476063790775 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611812181568936 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4613384822931688 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42171514928253606 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611868758939749 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4613384822931688 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.427054586266451 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611885522605174 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4613384822931688 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4314181683767701 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611918002206936 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4613384822931688 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43399924898778885 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119159067487586 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4613384822931688 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43474387005141835 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611932670414184 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4613384822931688 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43509423065881625 iter_best_prior_anomaly= 790
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119400045178083 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4613384822931688 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43521891042042016 iter_best_prior_anomaly= 870
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119410522468973 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4613384822931688 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43549111043777056 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119420999759864 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4613384822931688 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43567750144272294 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611951529537788 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4613384822931688 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43584545241570705 iter_best_prior_anomaly= 1190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119431477050754 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4613384822931688 at iter 0
max_prior_anomaly= 0.43599045812163967 at iter 129
max_prior_star_anomaly= 0.46119651500159464 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4613384822931688
accuracies_anomaly['prior'][-1]= 0.43599045812163967
accuracies_anomaly['prior_star'][-1]= 0.46119452431632535



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.25407838821411 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4613384822931688
 first_prior_anomaly_auc= 0.4358678738182139
 first_prior_star_anomaly_auc= 0.46119462908923425


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46136781870766386; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4198791088267823; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4611974579577748 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46136383733712527; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41721703875717536; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.46118813316888174 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46135985596658663; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41835550118540066; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.46119253363105595 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4613606941498579; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41892693263060043; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.46119473386214316 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4613729525802005 at iter 140
0.4358678738182139 at iter 0
0.4612022775115847 at iter 450
last anomaly aucs:
0.4613617418789471
0.4198941961256655
0.4611977722765016




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.23715043067932 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4613641516558521,first_prior_anomaly_auc= 0.4215290725963104, first_prior_star_anomaly_auc= 0.4611954672725056


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4613641516558521 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.39855006866816445 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611741983719967 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613641516558521 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4111722705504727 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611824754318006 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4613641516558521 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41881723539497084 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46118897135215303 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4613641516558521 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4260586149943444 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119441954341645 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4613641516558521 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42903144151178085 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119651500159464 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4613641516558521 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4306683086676951 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461199658188862 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4613641516558521 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43022166175700816 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612015441012223 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4613641516558521 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43165830788399373 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612023822844936 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4613641516558521 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43370892325719695 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461207830475757 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4613641516558521 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4330806001224586 iter_best_prior_anomaly= 990
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612064684279411 iter_best_prior_star_anomaly= 930
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4613641516558521 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4347043706647589 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46120866865902826 iter_best_prior_star_anomaly= 1040
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4613641516558521 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43419129772982257 iter_best_prior_anomaly= 1160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46120531592594316 iter_best_prior_star_anomaly= 1040
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4613641516558521 at iter 0
max_prior_anomaly= 0.43747456637636195 at iter 116
max_prior_star_anomaly= 0.46121107843593323 at iter 104
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4613641516558521
accuracies_anomaly['prior'][-1]= 0.4360060692850674
accuracies_anomaly['prior_star'][-1]= 0.46121034502557084



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.21275496482849 seconds
back and forth 7/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4613641516558521
 first_prior_anomaly_auc= 0.43431995886196506
 first_prior_star_anomaly_auc= 0.46120783047575703


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4613689712096619; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.44194679799322156; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 20 
last prior star auc 0.46123213779062433 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613830107794559; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.44611288317024383; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 110 
last prior star auc 0.4612461773604184 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46138688737708566; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.44836057638510834; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 220 
last prior star auc 0.46124072916915504 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46139935535324605; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4448108702312087; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 220 
last prior star auc 0.46125057782259266 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.46139935535324605 at iter 400
0.45210578878703567 at iter 430
0.4612568641971273 at iter 430
last anomaly aucs:
0.4613882494249015
0.44933119261325843
0.46123968144006594




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.29613542556763 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46138803987908367,first_prior_anomaly_auc= 0.44454223249276126, first_prior_star_anomaly_auc= 0.4612377955277055


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46138803987908367 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4395537847536978 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46123674779861645 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46138803987908367 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45506824278648994 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612446057667847 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46138803987908367 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45793535343883546 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612440819022402 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46138803987908367 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4593753522989062 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46124554872296486 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46138803987908367 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4604696005595711 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461246596452054 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46138803987908367 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45974415293827237 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46124670122496303 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46138803987908367 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45940112643449826 iter_best_prior_anomaly= 650
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612434532647867 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46138803987908367 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45971754061940906 iter_best_prior_anomaly= 650
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461246596452054 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46138803987908367 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46075688787580465 iter_best_prior_anomaly= 650
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46124701554368974 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46138803987908367 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4596111961168645 iter_best_prior_anomaly= 650
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46124512963132935 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.46138803987908367 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46273101902550295 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46124942532059465 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.46138803987908367 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46191881943562607 iter_best_prior_anomaly= 1180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612484823644144 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.46138803987908367 at iter 0
max_prior_anomaly= 0.46431979541622714 at iter 129
max_prior_star_anomaly= 0.46126147420511937 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46138803987908367
accuracies_anomaly['prior'][-1]= 0.46431979541622714
accuracies_anomaly['prior_star'][-1]= 0.46125152077877285



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.45734238624573 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 6 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.47440554994671247
accuracies_anomaly["prior"][-1]= 0.41219956892234366
accuracies_anomaly["prior_star"][-1]= 0.4710228518096167


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam photoGGAD 
took 1349.6634776592255 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 1 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003591299057006836 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.47052664731301497
 first_prior_anomaly_auc= 0.4126003252989276
 first_prior_star_anomaly_auc= 0.4674104914561883


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5480936988315306; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41230015091489797; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5241311916074386 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5416277435310063; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.412250802874801; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5154463556420003 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5355067006466165; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41225625106606434; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5094998644238559 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5328769006329541; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41227930110602473; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5050246991655466 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5480936988315306 at iter 100
0.4126003252989276 at iter 0
0.5274005254570928 at iter 60
last anomaly aucs:
0.5371390625674477
0.4122866352096485
0.5082439515647416




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.28649353981018 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5377423449769563,first_prior_anomaly_auc= 0.41228642566383067, first_prior_star_anomaly_auc= 0.5087735786192858


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5377422402040473 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40964593881345934 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49860044348276883 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5377423449769563 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4012712306583971 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4940660815309249 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5377422402040473 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3992155861855662 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4934242426909371 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5377421354311385 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40044687741108653 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49356442884305984 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5377422402040473 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.400603827228635 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4936327407796697 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5377421354311385 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40071132423317757 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.494064824256018 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5377422402040473 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.39937337418638597 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49427992303801205 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5377421354311385 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3965631552235791 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4946836130560456 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5377421354311385 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4017268880392504 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4947305513192376 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5377421354311384 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40899519427621406 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4986809090768124 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5377422402040473 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.39947144162912657 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49513769884326514 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5377423449769563 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40116635297657743 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4956305506067818 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5377423449769563 at iter 0
max_prior_anomaly= 0.44201479561110474 at iter 5
max_prior_star_anomaly= 0.5087735786192858 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5377421354311385
accuracies_anomaly['prior'][-1]= 0.40580286851460934
accuracies_anomaly['prior_star'][-1]= 0.4966273600621597



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.32757425308228 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5377421354311385
 first_prior_anomaly_auc= 0.40191055494857114
 first_prior_star_anomaly_auc= 0.4960899798123559


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5473146074808695; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.406789305452005; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.5042229768665607 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5549225874885222; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.40392722389928726; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.5078667690926624 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46138908760817277; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4009217082342706; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.45878024217629254 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4612122309379313; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4011675054785754; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.45825512035683136 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5556513878429059 at iter 210
0.41062745142413626 at iter 20
0.5085144752155493 at iter 220
last anomaly aucs:
0.4611659213121927
0.40377865591445167
0.46078894838593143




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.25701975822449 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4611493671925848,first_prior_anomaly_auc= 0.4074174190409256, first_prior_star_anomaly_auc= 0.46078528133411956


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4611493671925848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41784661916682064 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46087800535850565 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4611493671925848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4137155281413747 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608245711749611 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4611493671925848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4109048900869322 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46081074115098486 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4611493671925848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4103510604904294 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608046643222681 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4611493671925848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.413225086154763 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.460808226601171 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4611493671925848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4137965175999628 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608088552386245 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4611493671925848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4130006625838759 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46081032205934924 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4611493671925848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41595724930043126 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608182848004264 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4611493671925848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4177019277796148 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608241520833255 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4611493671925848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41620891382763514 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608195420753334 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4611493671925848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4177554667360682 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46082771436222847 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4611493671925848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4174574925831258 iter_best_prior_anomaly= 1110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608296002745888 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4611493671925848 at iter 0
max_prior_anomaly= 0.43033167331136457 at iter 111
max_prior_star_anomaly= 0.46094464092857296 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4611493671925848
accuracies_anomaly['prior'][-1]= 0.41676169569504884
accuracies_anomaly['prior_star'][-1]= 0.46082886686422647



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.27101922035217 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4611493671925848
 first_prior_anomaly_auc= 0.4216633914655341
 first_prior_star_anomaly_auc= 0.4608488784898284


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46115523447548373; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.42054148315691664; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 80 
last prior star auc 0.46087171898397095 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46106973978181254; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4244266721651489; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 200 
last prior star auc 0.46078475746957503 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46102531606843433; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4243598270492638; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 270 
last prior star auc 0.4607265037322205 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4610764452479828; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.43454123924558474; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 400 
last prior star auc 0.46114412854713926 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4612168409459233 at iter 60
0.43708449683648676 at iter 420
0.4611488433280402 at iter 480
last anomaly aucs:
0.461080950483066
0.42875945104024826
0.46113784217260456




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.29000091552734 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4610892275428699,first_prior_anomaly_auc= 0.4312330346467246, first_prior_star_anomaly_auc= 0.46114276649932334


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4610892275428699 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41491360635477026 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46110976303301643 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4610892275428699 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4251613398024318 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611124871286481 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4610892275428699 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.444942150686074 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46111751622827585 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4610892275428699 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46120741138412136 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611261076068065 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4610892275428699 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46490840961848834 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46113553716860856 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4610892275428699 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46348831761111065 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46114140445150753 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4610892275428699 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.458564619529754 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46114182354314315 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4610892275428699 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45327735945447684 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611416139973254 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4610892275428699 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4473757110413463 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611378421726046 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4610892275428699 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4412169499097486 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461133860802066 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4610892275428699 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4359462439540793 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46113008897734514 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4610892275428699 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43162142782005714 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46112631715262437 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4610892275428699 at iter 0
max_prior_anomaly= 0.46763921071634074 at iter 53
max_prior_star_anomaly= 0.4611428712722323 at iter 64
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4610892275428699
accuracies_anomaly['prior'][-1]= 0.42821075531628217
accuracies_anomaly['prior_star'][-1]= 0.46112317396535707



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.28234577178955 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4610892275428699
 first_prior_anomaly_auc= 0.42788480679666047
 first_prior_star_anomaly_auc= 0.4611238026028105


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4610840936703333; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43389845744941674; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 90 
last prior star auc 0.46112778397334914 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46114119490568967; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.43366753795817714; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 90 
last prior star auc 0.4611357467144263 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4611977722765016; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4336911118626821; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 90 
last prior star auc 0.4611481099176778 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4612359096153451; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4341728576978542; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 90 
last prior star auc 0.46116089221256495 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.46125979783857685 at iter 490
0.43503283373419444 at iter 90
0.4611706360930937 at iter 490
last anomaly aucs:
0.46125979783857685
0.4344329040577709
0.4611706360930937




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.29199242591858 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46126220761548176,first_prior_anomaly_auc= 0.43542531305097454, first_prior_star_anomaly_auc= 0.46117220768672734


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46126220761548176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41206629778220893 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46114790037186004 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46126220761548176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44783398774492233 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611814277027115 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46126220761548176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.468796637041079 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611992390972264 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46126220761548176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46325278811187903 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119944864304413 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46126220761548176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4560208380743075 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119420999759864 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46126220761548176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4496947546071791 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119379090596296 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46126220761548176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44513304692610955 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611914859019669 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46126220761548176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4424547370556214 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46118708543979264 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46126220761548176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44162797403140586 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611888665792442 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46126220761548176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44158019758494255 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611897047625154 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.46126220761548176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44151618133759807 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46118813316888174 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.46126220761548176 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4410968801561368 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611893904437887 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.46126220761548176 at iter 0
max_prior_anomaly= 0.4692338543899639 at iter 31
max_prior_star_anomaly= 0.4612000772804976 at iter 31
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46126220761548176
accuracies_anomaly['prior'][-1]= 0.439915460835258
accuracies_anomaly['prior_star'][-1]= 0.46118603771070354



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.40577125549316 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46126220761548176
 first_prior_anomaly_auc= 0.4398389766117531
 first_prior_star_anomaly_auc= 0.46118603771070354


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4612806476474501; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.40767683676338884; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4611640353998323 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46129154402997674; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.40996088617764537; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.46117199814090953 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4613075742850401; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.40725795467356324; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.46117545564690354 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46131993748829164; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.40859339017054097; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.46118163724852934 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4613369106995352 at iter 490
0.4398389766117531 at iter 0
0.4611908572645135 at iter 480
last anomaly aucs:
0.4613369106995352
0.40746750049138497
0.46118939044378865




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.51669216156006 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4613347104684481,first_prior_anomaly_auc= 0.40561197227457374, first_prior_star_anomaly_auc= 0.46119274317687386


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4613347104684481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.435870283595119 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612036395594006 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613347104684481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41953063413174485 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612041634239451 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4613347104684481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41656556080956764 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46120531592594316 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4613347104684481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4165257471041816 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612014393283135 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4613347104684481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4171889596175873 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612007059179511 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4613347104684481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4174341282244387 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119913432431736 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4613347104684481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4175759907431039 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119892477849955 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4613347104684481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4176635808949534 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119766750359265 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4613347104684481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41775085672807616 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119714363904807 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4613347104684481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41796595551007015 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119504818086987 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4613347104684481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4181578994791948 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4611940004517808 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4613347104684481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41830039063531355 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46119420999759864 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4613347104684481 at iter 0
max_prior_anomaly= 0.435870283595119 at iter 10
max_prior_star_anomaly= 0.46120950684229955 at iter 14
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4613347104684481
accuracies_anomaly['prior'][-1]= 0.4184778759430086
accuracies_anomaly['prior_star'][-1]= 0.46119253363105606



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.78797602653503 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4613347104684481
 first_prior_anomaly_auc= 0.41852921466837495
 first_prior_star_anomaly_auc= 0.46119274317687386


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4613575509625907; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.42421366884133316; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.46120468728848973 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613713809865668; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.425171712320414; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.461206677973759 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4613708571220223; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4221258590854666; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.46120091546376885 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46137777213401043; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.41808099616405425; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.4612013345554045 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4613852110105431 at iter 470
0.4370052885173502 at iter 20
0.4612126500295669 at iter 10
last anomaly aucs:
0.4613838489627272
0.41815664220428794
0.46120343001358277




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.30874228477478 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4613809153212778,first_prior_anomaly_auc= 0.4172212296735318, first_prior_star_anomaly_auc= 0.4612017536470402


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4613809153212778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4191456984644063 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461206677973759 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613809153212778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4243648561488915 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612155836710164 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4613809153212778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4267716994123915 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612168409459233 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4613809153212778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42780077892371393 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46121715526465007 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4613809153212778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42835670397839504 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46121788867501246 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4613809153212778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.428728019167575 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46121998413319065 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4613809153212778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42977700553159054 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46122061277064413 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4613809153212778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43012809954935083 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46121904117701046 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4613809153212778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4304965858699903 iter_best_prior_anomaly= 880
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46121956504155504 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4613809153212778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4312203571247464 iter_best_prior_anomaly= 950
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46121883163119265 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4613809153212778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4315562590707146 iter_best_prior_anomaly= 950
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46121935549573717 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4613809153212778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43173447778877194 iter_best_prior_anomaly= 1180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46122228913718677 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4613809153212778 at iter 0
max_prior_anomaly= 0.43310878403495556 at iter 129
max_prior_star_anomaly= 0.46122228913718677 at iter 120
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4613809153212778
accuracies_anomaly['prior'][-1]= 0.43310878403495556
accuracies_anomaly['prior_star'][-1]= 0.46121925072282827



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.43107676506042 seconds
back and forth 7/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4613809153212778
 first_prior_anomaly_auc= 0.4324011478081717
 first_prior_star_anomaly_auc= 0.4612214509539154


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.461373581217654; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4116836671188665; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.46120563024466993 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46138762078744805; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4116942491826665; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.46121013547975304 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4613892971539906; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4034580508131844; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4612017536470402 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46139055442889754; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4013456194237238; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.46120447774267187 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.461394745345254 at iter 370
0.4324011478081717 at iter 0
0.4612214509539154 at iter 0
last anomaly aucs:
0.46139202124962225
0.40215237082233746
0.46120824956739265




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.86190390586853 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4613955835285253,first_prior_anomaly_auc= 0.4073442875505058, first_prior_star_anomaly_auc= 0.46120416342394516


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4613955835285253 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42376115464774716 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612187268582837 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613955835285253 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4285699168480286 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46121956504155504 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4613955835285253 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4296179602558638 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612204032248263 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4613955835285253 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4301581693742082 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46122103186227975 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4613955835285253 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42977407189014105 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46122166049973323 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4613955835285253 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4299878086243192 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612210318622798 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4613955835285253 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4294107194420381 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612212414080976 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4613955835285253 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4285356561068147 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612222891371867 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4613955835285253 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4263318627407839 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46121600276265207 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4613955835285253 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4293895553144382 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46122207959136885 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4613955835285253 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42874729738281464 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.461220822316462 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4613955835285253 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4297015690371747 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4612224986830045 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4613955835285253 at iter 0
max_prior_anomaly= 0.43097623624698406 at iter 126
max_prior_star_anomaly= 0.461225432324454 at iter 126
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4613955835285253
accuracies_anomaly['prior'][-1]= 0.42946729681285
accuracies_anomaly['prior_star'][-1]= 0.46122124140809756



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.8084032535553 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 6 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4705268568588328
accuracies_anomaly["prior"][-1]= 0.4126003252989276
accuracies_anomaly["prior_star"][-1]= 0.4674104914561883


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam photoGGAD 
took 1320.3430979251862 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 2 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0030050277709960938 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.45701796184841204
 first_prior_anomaly_auc= 0.4123998947241811
 first_prior_star_anomaly_auc= 0.4534399670091065


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5367018452185626; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41240167586363263; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 80 
last prior star auc 0.5147400814630321 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5365942434411112; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4123773685487653; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 80 
last prior star auc 0.5117700838141362 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5303010586673808; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.412371815584593; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 80 
last prior star auc 0.5045723945177786 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5343940123539832; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4123839692420267; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 80 
last prior star auc 0.5065478877152926 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5425395821572574 at iter 490
0.41241341042943064 at iter 80
0.5164011511609048 at iter 120
last anomaly aucs:
0.5425395821572574
0.41238009264439696
0.5137334233542167




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.52339291572571 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5435773578200194,first_prior_anomaly_auc= 0.4123813499193039, first_prior_star_anomaly_auc= 0.5146644354227985


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5435773578200194 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4123985326763653 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5145590338764342 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5435773578200194 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.41244945231009594 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5144519559635273 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5435773578200194 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.412502257856187 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5143657278594936 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5435774625929284 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.41255380612737114 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5142732133809254 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5435773578200194 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.41262777580106225 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5141843659541689 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5435773578200194 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.41270530775365627 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.514083155324161 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5435773578200194 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.41280924247929585 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5139688480805394 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5435771482742016 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.41288761261516116 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5138742381437928 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5435773578200194 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4129966812133373 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5137495583821889 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5435773578200194 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.41310700708642045 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5136311649951196 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5435773578200194 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4132233050153115 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5135327832336524 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5435773578200194 iter_best_vanilla_star_anomaly= 1160 
last prior auc 0.41335249001199853 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5134200475836643 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5435775673658373 at iter 116
max_prior_anomaly= 0.41348094159832327 at iter 129
max_prior_star_anomaly= 0.5146644354227985 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5435773578200194
accuracies_anomaly['prior'][-1]= 0.41348094159832327
accuracies_anomaly['prior_star'][-1]= 0.513326380603098



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.21680188179016 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5435774625929284
 first_prior_anomaly_auc= 0.4134959241242975
 first_prior_star_anomaly_auc= 0.5133203037743812


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5566991169320146; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41345076700055694; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5241783394164484 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5705073481431935; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.413374282777052; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5346592973593455 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5763920233450806; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4132751676052224; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5383039277687184 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5745253891999247; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 330 
last prior auc 0.41320067406698674; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5357156178269846 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5765795668520309 at iter 330
0.4134959241242975 at iter 0
0.5383039277687184 at iter 300
last anomaly aucs:
0.5678069311889253
0.4131438871503571
0.5294093364396405




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.40264678001404 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5669392019573256,first_prior_anomaly_auc= 0.4131391723694561, first_prior_star_anomaly_auc= 0.5286399889695081


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5669396210489612 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41332388700786593 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5285246339967973 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5669394115031434 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4134846086501352 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5284276142831459 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5669394115031434 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41369184946396087 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5283226318284172 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5669392019573256 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4138988807319687 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.52819826638554 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5669394115031434 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4141466686615428 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5281103619149637 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5669396210489612 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4144401375794021 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.527982119874457 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5669396210489612 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41468991619424556 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5278548207901302 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5669394115031434 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4149666214466792 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5277629349490154 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5669393067302345 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4152582044521781 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5276380456415937 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5669394115031434 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4155536640553067 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5275111656489027 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5669396210489612 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.415842418192265 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5273943438554671 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5669395162760523 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41616365193098565 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5272799318389364 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.566939830594779 at iter 9
max_prior_anomaly= 0.4164756656537222 at iter 129
max_prior_star_anomaly= 0.5286399889695081 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5669394115031434
accuracies_anomaly['prior'][-1]= 0.4164756656537222
accuracies_anomaly['prior_star'][-1]= 0.527192341687087



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.8328742980957 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5669394115031434
 first_prior_anomaly_auc= 0.4165007063789519
 first_prior_star_anomaly_auc= 0.5271854266750988


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5542625181623837; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41640955394819945; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5170740027819303 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5391823438370269; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4164333373985222; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5059549778237661 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5271678248264018; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4164762942911756; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4965227966990666 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5186489491486781; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4165520451043182; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 400 
last prior star auc 0.489416678925097 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5669394115031434 at iter 0
0.4166653046188508 at iter 490
0.5271854266750988 at iter 0
last anomaly aucs:
0.513566205791595
0.4166653046188508
0.4845518632185483




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.58227324485779 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.513134855725609,first_prior_anomaly_auc= 0.41667316258701914, first_prior_star_anomaly_auc= 0.4841130742760297


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5131347509527001 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41701074089952994 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48407734671409103 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5131347509527001 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.41729876162612584 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.484052725080497 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.513134855725609 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.41755933185058713 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48401249228347526 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5131345414068823 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4177763165449415 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48396523970155647 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5131345414068823 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.4178588775971632 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4839251116774437 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5131347509527001 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.41800996013181274 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48387062976480993 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5131347509527001 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.41814239308867596 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4838065087445565 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5131345414068822 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.4182640344359215 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48376711413080603 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5131349604985178 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.4184307281339986 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48370906993926943 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5131347509527 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.41860821344169363 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4836319570783111 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5131347509527 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.4187592959763431 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.483573284249321 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5131347509527 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.4189378290131272 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48351440187451306 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5131350652714268 at iter 43
max_prior_anomaly= 0.4191957799148658 at iter 129
max_prior_star_anomaly= 0.4841130742760297 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5131347509527001
accuracies_anomaly['prior'][-1]= 0.4191957799148658
accuracies_anomaly['prior_star'][-1]= 0.48345342404152697



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.74828934669495 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5131347509527001
 first_prior_anomaly_auc= 0.4192324504329845
 first_prior_star_anomaly_auc= 0.48344734721281013


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5089824957996542; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4196471416064537; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.47883639626455243 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5054609735582515; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42000745564019815; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.47401799495665126 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5019041428465458; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42038411424773264; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.4679724933395862 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.49684947862905066; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42072274028933254; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.45911624889516967 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5131347509527001 at iter 0
0.4210876643310689 at iter 490
0.48344734721281013 at iter 0
last anomaly aucs:
0.48889134755981795
0.4210876643310689
0.44644490851858226




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.63675856590271 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.48785514349068965,first_prior_anomaly_auc= 0.421115848243566, first_prior_star_anomaly_auc= 0.4447789144939909


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.48785514349068965 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4212412614155323 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4446358994733276 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4878555625823253 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.42164851371246875 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4445619297996365 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4878548291719629 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.42206540511702506 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4444894269466702 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.48785535303650746 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4225683150797972 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44438172039630985 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4878555625823252 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.42305058477951385 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44430481708116926 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.48785535303650746 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.42339989765782254 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4442524306267138 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.48785535303650746 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.42384120115015506 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4441809755028366 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4878553530365075 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4242642741563371 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4441528963632485 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.48785556258232526 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.42482763808755075 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44412293131130004 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4878555625823253 iter_best_vanilla_star_anomaly= 930 
last prior auc 0.42542924413051686 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44409212807608023 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4878553530365075 iter_best_vanilla_star_anomaly= 930 
last prior auc 0.4261524915207284 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4440420466256208 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.48785577212814313 iter_best_vanilla_star_anomaly= 930 
last prior auc 0.42688286346874604 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44402182545420105 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.48785640076559667 at iter 93
max_prior_anomaly= 0.4275710119344725 at iter 129
max_prior_star_anomaly= 0.4447789144939909 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4878555625823253
accuracies_anomaly['prior'][-1]= 0.4275710119344725
accuracies_anomaly['prior_star'][-1]= 0.443993641541704



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.53565287590027 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.48785493394487184
 first_prior_anomaly_auc= 0.4276478104767042
 first_prior_star_anomaly_auc= 0.4439873551671694


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46492370646318926; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42863005649774344; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.41685180039671216 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3928303060249032; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42951716871749157; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.3799652405397397 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4319116487777402; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.430329996944822; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.39192276308791746 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44334404950645667; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43107398937099795; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.3943597809491839 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.48785493394487184 at iter 0
0.43170597955754825 at iter 490
0.4439873551671694 at iter 0
last anomaly aucs:
0.4464032089008358
0.43170597955754825
0.3999791711457085




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.219080209732056 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44661233562702185,first_prior_anomaly_auc= 0.43177292944634227, first_prior_star_anomaly_auc= 0.4004711847259539


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44661212608120404 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4316912065773918 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.400416912359138 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44661212608120404 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.43216299898621735 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4004114641678747 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44661212608120404 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4326259904706944 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40041858872568065 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44661254517283966 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4330907630946229 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4004160741758668 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44661212608120404 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4336338010815079 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4004348285265618 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44661212608120404 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.43416562836713934 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4004551544708906 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44661191653538623 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.43468582585988175 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40045986925179156 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44661233562702185 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4352511804763647 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4004783092837598 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44661233562702185 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4358506910611526 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4004692988135935 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.44661191653538623 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.43643930526341373 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40050764569825487 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.44661212608120404 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4370541126929026 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40053184824021326 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.44661212608120404 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4376326686959084 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40057784354722514 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.44661275471865747 at iter 15
max_prior_anomaly= 0.4381484657264765 at iter 129
max_prior_star_anomaly= 0.4006040367744529 at iter 127
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44661191653538623
accuracies_anomaly['prior'][-1]= 0.4381484657264765
accuracies_anomaly['prior_star'][-1]= 0.4006021508620924



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.8769428730011 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.44661191653538623
 first_prior_anomaly_auc= 0.4381987567227537
 first_prior_star_anomaly_auc= 0.4006069704159024


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4480916243279342; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4387608633790604; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4048062686050493 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.448775896196031; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4391336453889652; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.40935697513068325 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44926476658900893; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4394185229282938; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.41363569118478466 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4497969081933672; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4395967416463512; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.4176313108390089 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4502119136855631 at iter 490
0.43976500693806203 at iter 490
0.4209050451508373 at iter 490
last anomaly aucs:
0.4502119136855631
0.43976500693806203
0.4209050451508373




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.53000521659851 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.45024586010805023,first_prior_anomaly_auc= 0.43977883696203823, first_prior_star_anomaly_auc= 0.4211921229212531


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45024586010805023 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.43976270193406597 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4211058948172195 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.45024565056223237 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.44000273666838075 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42103538264952245 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4502460696538681 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.44021972136273513 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42096811844200166 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4502456505622324 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4404342962801845 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4208891196686829 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.45024586010805023 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4405474510218082 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4208236366006136 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4502456505622324 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.440531315993836 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4207579439867265 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.45024586010805023 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.44053487827273896 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42070409071154635 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4502456505622324 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4405438887429053 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4206409126474731 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.45024586010805023 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4405891506395548 iter_best_prior_anomaly= 870
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4205970127986395 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.45024565056223237 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4406161820500538 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42055070317290083 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.45024606965386804 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.440668778050327 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4205154994755068 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.45024586010805023 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4406941330942835 iter_best_prior_anomaly= 1160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42046374165850486 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4502460696538681 at iter 28
max_prior_anomaly= 0.4407110015326181 at iter 116
max_prior_star_anomaly= 0.4211921229212531 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4502460696538681
accuracies_anomaly['prior'][-1]= 0.4406597675801606
accuracies_anomaly['prior_star'][-1]= 0.42041282202477415



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.7954785823822 seconds
back and forth 7/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.45024565056223237
 first_prior_anomaly_auc= 0.4407341563454874
 first_prior_star_anomaly_auc= 0.4204291665985642


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.450760923728256; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.43946074641058497; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.42358806980222646 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.45127996871900034; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.438498092923512; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.426416309705366 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45180226166992093; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.43783351836229045; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.42881812386923834 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4523911901909088; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4374483731491342; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.43106026411993065 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.452893995380772 at iter 490
0.44123392312099213 at iter 10
0.43288184591425466 at iter 490
last anomaly aucs:
0.452893995380772
0.43725506713219364
0.43288184591425466




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.35968089103699 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.45293475204233824,first_prior_anomaly_auc= 0.43724050369785505, first_prior_star_anomaly_auc= 0.43306708441720904


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45293475204233824 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4353182351380676 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4327841975631498 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.45293475204233824 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4342921940411037 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4326905305825835 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45293475204233835 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4337949418154128 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4326300766141419 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.45293475204233824 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4337779686041692 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43259497768965677 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.45293475204233824 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4337365833051494 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4325497157930073 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4529347520423383 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.43411334668559287 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4325444771475617 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.45293475204233824 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4345334860503254 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43251702664542707 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.45293475204233835 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.43486834026720445 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4324803561273083 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.45293475204233835 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.43530492897863593 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43245227698772015 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4529347520423383 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4356604234585705 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43242524557722123 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.45293475204233835 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4360009354125307 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43240051917071826 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.45293475204233824 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4362874893184019 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4323787264056648 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.45293496158815616 at iter 4
max_prior_anomaly= 0.43739336737195594 at iter 1
max_prior_star_anomaly= 0.43306708441720904 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.45293475204233835
accuracies_anomaly['prior'][-1]= 0.436339142362495
accuracies_anomaly['prior_star'][-1]= 0.4323343026922866



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.54540824890137 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 6 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.45701796184841204
accuracies_anomaly["prior"][-1]= 0.4123998947241811
accuracies_anomaly["prior_star"][-1]= 0.4534399670091065


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam photoGGAD 
took 1200.986944437027 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 3 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0033600330352783203 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4674284076236122
 first_prior_anomaly_auc= 0.4127892308536938
 first_prior_star_anomaly_auc= 0.4642087361327817


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5421242623463348; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4126359480879572; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5179333501808171 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5483361433427503; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4126142600958127; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5217875264080116 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5444872057610013; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4126042018965572; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5167455397124947 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5435144940746729; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 230 
last prior auc 0.41262127988070973; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.515035331520343 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5527097836523249 at iter 230
0.4127892308536938 at iter 0
0.5258393043414121 at iter 230
last anomaly aucs:
0.5501280744038526
0.41261520305199295
0.5203858744326023




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.48572754859924 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5508306815310089,first_prior_anomaly_auc= 0.412613945777086, first_prior_star_anomaly_auc= 0.5209413803956476


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5508306815310088 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41269462091694736 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5208330452078338 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5508305767580999 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.41280651838366417 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5207404259563566 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5508306815310088 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.41293507474289776 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5206610080914023 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5508305767580999 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.41307557521374727 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.520575513397731 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5508305767580999 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4132266577483966 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5204826846004359 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5508305767580999 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.41338863666557285 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5203990758191251 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5508305767580999 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4135654933358144 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.52028990244804 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5508307863039177 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4137655048189252 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5201972831965628 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5508305767580999 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4139957956727113 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5201015207578182 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5508306815310088 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4142455742875547 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5200103683270658 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5508306815310088 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4145177743049051 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5199227781752164 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5508305767580999 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4147976227446059 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5198377025731807 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5508312053955533 at iter 26
max_prior_anomaly= 0.4150683559412316 at iter 129
max_prior_star_anomaly= 0.5209413803956476 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5508305767580999
accuracies_anomaly['prior'][-1]= 0.4150683559412316
accuracies_anomaly['prior_star'][-1]= 0.5197570274333194



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.47866654396057 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5508305767580999
 first_prior_anomaly_auc= 0.41509287280191676
 first_prior_star_anomaly_auc= 0.5197475978715174


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5574608159797965; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41505588796507126; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5247230537698759 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5627608583499608; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41501031174969505; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5281161244249539 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5662720080733813; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4149488100521644; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5303091261813669 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5639269808261386; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4148909754064456; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5275066604138194 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5662720080733813 at iter 300
0.41509287280191676 at iter 0
0.530372409018349 at iter 290
last anomaly aucs:
0.5587040513169326
0.41485472397996237
0.5224318797978134




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.34933614730835 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5580894534332616,first_prior_anomaly_auc= 0.41485420011541785, first_prior_star_anomaly_auc= 0.5218021946152592


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5580896629790794 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4152250962129622 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5217038128537919 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5580898725248972 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.415632034191172 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5216035451799642 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5580898725248972 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4160603458427996 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5215205650361069 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5580896629790794 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.41653391939107665 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.521425221688998 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5580897677519883 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.41708345329831403 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5213292497044357 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5580897677519883 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.41767049590694155 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5212435454649466 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5580898725248972 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4183182020298284 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5211406584683961 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5580894534332614 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.41902604780243013 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5210535921810912 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5580898725248972 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4198022055116417 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5209371894792912 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5580898725248972 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4206749638428692 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5208422652238179 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5580896629790794 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.42163028322631824 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5207479696057982 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5580898725248972 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.42266051523963866 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5206370150952615 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5580900820707151 at iter 28
max_prior_anomaly= 0.42373726642451554 at iter 129
max_prior_star_anomaly= 0.5218021946152592 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5580898725248973
accuracies_anomaly['prior'][-1]= 0.42373726642451554
accuracies_anomaly['prior_star'][-1]= 0.5205417765210616



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.27758002281189 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5580896629790794
 first_prior_anomaly_auc= 0.4238393152377947
 first_prior_star_anomaly_auc= 0.5205363283297982


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5494450598106628; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42373747597033334; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5129037266885517 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5391534265141676; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42367052608153927; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5042254914163746 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5293410245030307; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4236400371650462; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.49625531146261725 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5222663386017343; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4236427612606779; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.49049814489087484 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5580896629790794 at iter 0
0.4238393152377947 at iter 0
0.5205363283297982 at iter 0
last anomaly aucs:
0.5187352820256208
0.42364894286230365
0.4868608485851256




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.729610443115234 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5184643392831773,first_prior_anomaly_auc= 0.4236490476352126, first_prior_star_anomaly_auc= 0.4865249466391575


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5184645488289952 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.42499014086927145 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48650063932429016 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5184649679206307 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4263626659760037 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48645328196946247 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5184647583748129 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.42775279293143287 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4863957616424704 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5184645488289951 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4292469593854105 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4863426417776526 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5184645488289951 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4306691468509664 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4862959130602784 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5184643392831773 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.43219474517761736 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4862326302232962 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5184647583748129 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.43369834119339695 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48615845100378735 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5184647583748129 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4353106914886261 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4860945395293517 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5184647583748129 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.43696652254105317 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48605713560087055 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5184645488289951 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.43857017668484266 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.486000243911332 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.518464653601904 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4400759729317094 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48594848609432995 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5184645488289951 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.44156154800715636 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4859057387474943 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5184649679206307 at iter 20
max_prior_anomaly= 0.44293606379915784 at iter 129
max_prior_star_anomaly= 0.4865249466391575 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5184647583748129
accuracies_anomaly['prior'][-1]= 0.44293606379915784
accuracies_anomaly['prior_star'][-1]= 0.4858593243488468



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.60052967071533 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.518464653601904
 first_prior_anomaly_auc= 0.44305655264440535
 first_prior_star_anomaly_auc= 0.48585796230103095


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5156078106946319; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4431097772821321; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.4823157997965729 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.513820070549886; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4431949576570766; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 200 
last prior star auc 0.4788077932604198 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5125134476028587; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44328579576910226; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 300 
last prior star auc 0.47498882073061927 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.513253563431405; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44339832187327255; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 400 
last prior star auc 0.47043937147989223 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.518464653601904 at iter 0
0.44345364196917747 at iter 490
0.48585796230103095 at iter 0
last anomaly aucs:
0.5133618986192188
0.44345364196917747
0.4641898770091777




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.709630727767944 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5128032494689061,first_prior_anomaly_auc= 0.4434626524393438, first_prior_star_anomaly_auc= 0.46332047141103544


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5128031446959972 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.44520041590653914 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4633211000484889 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5128031446959972 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4466900771254337 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46333094870192654 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5128032494689061 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.448144848965661 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46334666463826313 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5128035637876328 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4496797720812048 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4633575610207899 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5128034590147239 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4512321922725369 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46340408019234625 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5128032494689061 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.45284548552394627 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46342503477412844 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5128030399230883 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.45445794059208433 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.463439702981376 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5128031446959972 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4560737483933074 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4634636959775166 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5128034590147239 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4576711161625623 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4634964898980057 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5128032494689061 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.45926230233019144 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4635411231572017 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5128035637876328 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.46079911135809576 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4635522290855462 iter_best_prior_star_anomaly= 1080
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5128030399230883 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.46224246295125165 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4635539054520888 iter_best_prior_star_anomaly= 1170
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5128037733334506 at iter 129
max_prior_anomaly= 0.4634728112205918 at iter 129
max_prior_star_anomaly= 0.46358051777095216 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5128037733334506
accuracies_anomaly['prior'][-1]= 0.4634728112205918
accuracies_anomaly['prior_star'][-1]= 0.46358051777095216



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.16432404518127 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5128032494689061
 first_prior_anomaly_auc= 0.4636144641934393
 first_prior_star_anomaly_auc= 0.4635828227749482


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5027516509067257; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4637007970703818; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 90 
last prior star auc 0.4488965945870963 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4796780370418333; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4638269436527105; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 200 
last prior star auc 0.4242470913992757 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42835712307003065; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.463906256744756; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 290 
last prior star auc 0.4005962835791934 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.447071660059687; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4639283638285362; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 320 
last prior star auc 0.3985039685882437 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5128032494689061 at iter 0
0.463987350976253 at iter 470
0.4635828227749482 at iter 0
last anomaly aucs:
0.4494342891556267
0.4639786548248134
0.3996334205463027




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.86515974998474 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4494126011634822,first_prior_anomaly_auc= 0.4639878748407975, first_prior_star_anomaly_auc= 0.40016105691557774


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4494129154822089 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4659046952093216 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40028259348991435 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4494129154822089 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4670459865060875 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40037437455812025 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44941270593639104 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4681687329979762 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4004751660964925 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44941270593639104 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4691922595451263 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4005383441605657 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44941270593639104 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4701200236535319 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.400609694511534 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44941260116348214 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.471024842494886 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4006960273884766 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4494129154822089 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.471888695128856 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4007416036038528 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4494130202551178 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4727134674678022 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40080666758028644 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4494127059363911 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4734371339496495 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40085276766020717 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4494124963905733 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.47415399019241755 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4009233846008131 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.44941270593639104 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4747876567455104 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4009843624337992 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.44941291548220896 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.475281765783934 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40104764527078135 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4494133345738445 at iter 33
max_prior_anomaly= 0.47568524625614966 at iter 129
max_prior_star_anomaly= 0.40109814581287645 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44941270593639104
accuracies_anomaly['prior'][-1]= 0.47568524625614966
accuracies_anomaly['prior_star'][-1]= 0.40109814581287645



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.14395570755005 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4494129154822089
 first_prior_anomaly_auc= 0.4757316606547971
 first_prior_star_anomaly_auc= 0.4010968885379695


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4489760124520507; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4762058628405277; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4040361877245545 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44846367292747663; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4765369452326859; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.407321656602181 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4479806698173976; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4768156411703888; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.4113158094356806 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.44784844640635213; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47704278883690754; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.41527119629288306 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4494129154822089 at iter 0
0.47712912171385014 at iter 490
0.4188136731160679 at iter 490
last anomaly aucs:
0.4480221598893263
0.47712912171385014
0.4188136731160679




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 62.235032081604004 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4480550585827243,first_prior_anomaly_auc= 0.47713142671784614, first_prior_star_anomaly_auc= 0.41914674619349546


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4480545347181797 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4776923808721548 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41909100700595486 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4480548490369065 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4784343826130615 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41905622240019647 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4480550585827243 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4791032528635484 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4190044645831945 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4480546394910887 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47961129669885705 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41895123994546785 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44805442994527084 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47987941057275996 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41888649028776087 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4480544299452709 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.48004767586447084 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41882991291694904 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4480548490369064 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4800652777131678 iter_best_prior_anomaly= 630
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4187656871237867 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44805463949108865 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4799536945651778 iter_best_prior_anomaly= 630
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41871780590441443 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44805463949108865 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.47975514990279167 iter_best_prior_anomaly= 630
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4186530562467075 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.44805484903690646 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4794439743633264 iter_best_prior_anomaly= 630
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41858348703519077 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4480548490369065 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.47904594208237417 iter_best_prior_anomaly= 630
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41852167101893334 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4480548490369065 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4785954185740575 iter_best_prior_anomaly= 630
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4184822764051829 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.44805526812854213 at iter 54
max_prior_anomaly= 0.48008581320331434 at iter 63
max_prior_star_anomaly= 0.41917293942072315 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4480545347181798
accuracies_anomaly['prior'][-1]= 0.4781287600377685
accuracies_anomaly['prior_star'][-1]= 0.41843952905834725



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.03790307044983 seconds
back and forth 7/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4480549538098154
 first_prior_anomaly_auc= 0.47807438289804377
 first_prior_star_anomaly_auc= 0.41843408086708384


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44848399887180534; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48496246824857; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.42212596385837553 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4490698889784348; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.48662804318152575; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.42511922109304967 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4496473972523514; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.48714876453881273; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.42774629701108036 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4503445561882442; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.48730959095399085; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.430216004019927 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4509631354424539 at iter 490
0.48732436393414735 at iter 440
0.4322083656557757 at iter 490
last anomaly aucs:
0.4509631354424539
0.4872237819415929
0.4322083656557757




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.72354602813721 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.45102537055034697,first_prior_anomaly_auc= 0.48723111604521663, first_prior_star_anomaly_auc= 0.432391403927643


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45102537055034697 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4877263775856382 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43233367405483314 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.45102537055034697 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.48651572662317333 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4322318347873717 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45102537055034697 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4867762968476347 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.432201031552152 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.45102537055034697 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.48697882288055927 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43215136919332825 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.45102537055034697 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4869327228006385 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4321138604919382 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.45102537055034697 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4867688579711019 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43208284771090055 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4510254753232559 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.486427926925506 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43204932038004906 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.45102537055034697 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4860002439113319 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4320168407782867 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.45102537055034697 iter_best_vanilla_star_anomaly= 810 
last prior auc 0.48546653071334006 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4319674927381897 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.45102537055034697 iter_best_vanilla_star_anomaly= 810 
last prior auc 0.4848816883357997 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43193847064242136 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.45102537055034697 iter_best_vanilla_star_anomaly= 810 
last prior auc 0.4843812929228415 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4319070387697481 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.45102537055034697 iter_best_vanilla_star_anomaly= 810 
last prior auc 0.48385281837029515 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4318829410006986 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4510257896419826 at iter 81
max_prior_anomaly= 0.4901396119965819 at iter 3
max_prior_star_anomaly= 0.43247323156950235 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.45102537055034697
accuracies_anomaly['prior'][-1]= 0.48332790609665177
accuracies_anomaly['prior_star'][-1]= 0.43185716686510656



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.57142686843872 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 6 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4674283028507032
accuracies_anomaly["prior"][-1]= 0.4127892308536938
accuracies_anomaly["prior_star"][-1]= 0.4642087361327816


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam photoGGAD 
took 1201.5549004077911 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 4 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0037870407104492188 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4676002351942259
 first_prior_anomaly_auc= 0.41291275811329975
 first_prior_star_anomaly_auc= 0.46438643098629445


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5439566357502768; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41269776410421466; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5204715786720914 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5436314206410173; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.412663293817183; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5178484841245994 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5506134872908366; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4126369958170464; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5234580256676864 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5442960999751478; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.412641081960494; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5153297433943824 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5508961645990781 at iter 280
0.41291275811329975 at iter 0
0.5243408421981691 at iter 280
last anomaly aucs:
0.5414043676892083
0.4126494637932068
0.5117125634871442




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.59709858894348 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5411554272576362,first_prior_anomaly_auc= 0.4126518735701117, first_prior_star_anomaly_auc= 0.5114673948802928


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.541155636803454 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41357995199724407 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5104842059030733 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.541155636803454 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4159171212763184 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5095098178502024 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.541155532030545 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42130381084215207 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5081709248472306 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5411556368034539 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.430528646380117 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5063293314273045 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5411554272576362 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4264886030125145 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5041942690895191 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.541155636803454 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42599281760754837 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5031139556257395 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5411556368034539 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.4282033164397495 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5029424423738524 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5411555320305451 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.42701906825033015 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5024889852240861 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.541155636803454 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.42126200645149664 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5013547137122173 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5411554272576361 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.4162745016686133 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5001037251798217 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5411554272576361 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.41333499293621045 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49920121134246365 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5411555320305451 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.4119890801483417 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4986045296262164 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5411559511221807 at iter 75
max_prior_anomaly= 0.430893989513489 at iter 42
max_prior_star_anomaly= 0.5114673948802928 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5411554272576362
accuracies_anomaly['prior'][-1]= 0.41143546009765675
accuracies_anomaly['prior_star'][-1]= 0.4981765322933156



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.0613431930542 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5411554272576361
 first_prior_anomaly_auc= 0.411436298280928
 first_prior_star_anomaly_auc= 0.49814845315372747


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5378197721566413; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4098329584558652; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4958440777951421 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5335394845089063; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4095474522790832; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4938383052269528 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5317901960217307; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40918043277916843; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.49276501154807006 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5315821170246338; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40867301758131325; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.49194631603784056 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5411554272576361 at iter 0
0.411436298280928 at iter 0
0.49814845315372747 at iter 0
last anomaly aucs:
0.531552571064321
0.40850716206650733
0.4913939532620626




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.10399293899536 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5313745618920814,first_prior_anomaly_auc= 0.40824575365877475, first_prior_star_anomaly_auc= 0.4911580046711954


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5313746666649903 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4135222221244342 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49172377837931397 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5313746666649903 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.41412791431084783 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49173656067420113 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5313748762108081 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4143307546624992 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4917283883873061 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5313745618920814 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.41420188398453883 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4916007749842526 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5313745618920814 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.41453212819342583 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49154335943016947 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5313744571191725 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4150459345387247 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4915504839879754 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5313744571191725 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4155859341112513 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4915488076214328 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5313746666649903 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.41564586421514826 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4914502163141477 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5313744571191725 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.4159782038822135 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49143921515871214 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5313744571191725 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.4165785526502726 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49157332448211805 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5313744571191725 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.4164796470242608 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49146498929430416 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5313746666649903 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.41627251098334406 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.491330041787627 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.531375085756626 at iter 75
max_prior_anomaly= 0.4207101675402632 at iter 2
max_prior_star_anomaly= 0.4944661044971467 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5313745618920814
accuracies_anomaly['prior'][-1]= 0.41652448982927465
accuracies_anomaly['prior_star'][-1]= 0.49136252138938935



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 108.73569250106812 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5313744571191725
 first_prior_anomaly_auc= 0.4168822893132052
 first_prior_star_anomaly_auc= 0.4915867354144585


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5316785081008317; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4240111428084085; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 50 
last prior star auc 0.48979365185135826 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5268581161076613; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42066385791452454; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 110 
last prior star auc 0.48614902144198535 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5197323010268164; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4187349886614758; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 110 
last prior star auc 0.48175736019207804 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5124692334352984; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4127956220011374; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 110 
last prior star auc 0.4762768988727692 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.536260646499139 at iter 10
0.42711755478470637 at iter 110
0.49197376653997527 at iter 40
last anomaly aucs:
0.5093710985188044
0.41790916859344046
0.47544929766528243




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.216604471206665 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5086140094790146,first_prior_anomaly_auc= 0.4171066081111834, first_prior_star_anomaly_auc= 0.47479949608421723


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5086142190248324 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4154226979191681 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4747214402670787 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5086142190248324 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41950108817143195 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47552473415969826 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5086142190248324 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4209121697086433 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4757505197784011 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5086142190248324 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.42184758223939944 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4758789713647258 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5086142190248324 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4227442287938584 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4759741051660169 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5086142190248325 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4235857647982304 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4760671435091297 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5086142190248324 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4242401763872876 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.476149075923898 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5086142190248324 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.42489008274126167 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47622157877686433 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5086142190248324 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4254707342024455 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47629764390873364 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5086142190248325 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4260380795041978 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4763221607694188 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5086142190248325 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4264896507416036 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47637601404459895 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5086142190248325 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4270588819557163 iter_best_prior_anomaly= 1190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4764527078139216 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5086144285706502 at iter 22
max_prior_anomaly= 0.42775719339360707 at iter 129
max_prior_star_anomaly= 0.4774302390540599 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5086142190248324
accuracies_anomaly['prior'][-1]= 0.42775719339360707
accuracies_anomaly['prior_star'][-1]= 0.47654532706539887



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 108.41422843933105 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5086142190248325
 first_prior_anomaly_auc= 0.42763838091490225
 first_prior_star_anomaly_auc= 0.4765222770254385


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.522641635161453; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4292529314412184; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 100 
last prior star auc 0.48243628864182037 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5247192819451552; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4364180363629048; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 200 
last prior star auc 0.4850799186794591 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5243737408915672; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.43314838819452384; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 200 
last prior star auc 0.4799120997203402 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5264930872930159; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.43383234574389395; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 200 
last prior star auc 0.4802591075946529 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5306925950279806 at iter 490
0.43945550776513936 at iter 460
0.4850799186794591 at iter 200
last anomaly aucs:
0.5306925950279806
0.4293723725573768
0.4771008330284442




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.1770806312561 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5291461468924564,first_prior_anomaly_auc= 0.4255265781628951, first_prior_star_anomaly_auc= 0.47460807597963717


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5291461468924564 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4443381348662029 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4806767324095716 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5291461468924565 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4500826239159671 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4826240416945886 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5291457278008209 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4519272557502515 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48316026944239443 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5291459373466386 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4527136812045364 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48332769655083396 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5291457278008209 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.45363631144040545 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48356678832896843 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5291457278008208 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.45417599669420516 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48367512351678227 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5291457278008209 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.4549455537101554 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4839049952789327 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5291459373466387 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.4552439469547335 iter_best_prior_anomaly= 790
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48397959359007725 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5291459373466387 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.45569897569813334 iter_best_prior_anomaly= 860
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48410574017240593 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5291457278008209 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.4558219790931947 iter_best_prior_anomaly= 960
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4841908157744415 iter_best_prior_star_anomaly= 960
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5291459373466386 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.45661458614910533 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48438443611010873 iter_best_prior_star_anomaly= 1080
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5291457278008209 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.45687568023811104 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48456192141780374 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5291463564382743 at iter 41
max_prior_anomaly= 0.4573649697227248 at iter 128
max_prior_star_anomaly= 0.4846809434423265 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5291457278008209
accuracies_anomaly['prior'][-1]= 0.45675665821358835
accuracies_anomaly['prior_star'][-1]= 0.4845139354255226



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.66737651824951 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5291459373466386
 first_prior_anomaly_auc= 0.45732138419261786
 first_prior_star_anomaly_auc= 0.48470168847829087


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5107893046138217; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41795317321518305; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4557176252759194 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5151518389950518; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42433677700930345; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.45052665150393123 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.519656445440765; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4312339776029048; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.439754529647171 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5231169898491814; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43162802851331855; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.431890694195958 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5291459373466386 at iter 0
0.45732138419261786 at iter 0
0.48470168847829087 at iter 0
last anomaly aucs:
0.46784226061381007
0.42707952221877177
0.4073989790089572




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.16361856460571 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46570258826803257,first_prior_anomaly_auc= 0.4234128894985275, first_prior_star_anomaly_auc= 0.4020140705825751


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4657030073596682 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.42862115080048596 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4074494795510523 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4657023787222147 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4293318254416283 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4095120390358713 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4657025882680325 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.430400509112519 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41127641482193006 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4657031121325771 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.43121302302112263 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4117142608082685 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4657019596305791 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4311384247099781 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41160372538936757 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4657030073596682 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4320631504040253 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4123156573054168 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46570342645130386 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4317714626256175 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41229019748855145 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46570237872221476 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.43184354638694816 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4114184868864132 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4657034264513038 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.43242252148158944 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4119333409608011 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46570258826803257 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.43240156689980735 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4120094060926704 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.465703216905486 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.43154536268818783 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4111609550763103 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4657034264513038 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.43160864552517 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4112041215147816 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4657040550887573 at iter 4
max_prior_anomaly= 0.4326916830845815 at iter 71
max_prior_star_anomaly= 0.4132245622902184 at iter 71
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4657027978138504
accuracies_anomaly['prior'][-1]= 0.4316742333661482
accuracies_anomaly['prior_star'][-1]= 0.4112703379932132



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.2860255241394 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4657034264513038
 first_prior_anomaly_auc= 0.43123230123636225
 first_prior_star_anomaly_auc= 0.41095224744175984


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4809612956301735; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42216546324503496; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4118549708249358 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4718012097499154; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41405562100369936; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4070743925371514 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46745072425321016; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41930579146922214; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.41151571614588245 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46268449985394655; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4223662081385081; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4126464253788483 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4970868940406427 at iter 20
0.43123230123636225 at iter 0
0.4217534961671975 at iter 20
last anomaly aucs:
0.46001551477235153
0.4184258038072799
0.4128186720410978




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.13614749908447 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4602539779130326,first_prior_anomaly_auc= 0.4195075840917844, first_prior_star_anomaly_auc= 0.4142016744387211


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46025387314012367 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4286532113106127 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41375450366348954 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46025334927557915 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4316117887124373 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4138672393134777 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4602539779130326 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.43271358062254384 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4138954232259746 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4602539779130326 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.43455779336519273 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4141484498009943 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4602539779130326 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.43560992291647543 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4143257255628715 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46025376836721477 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.43648310033933846 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4144851899302338 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46025376836721477 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4373164640568154 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4146000210384001 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46025355882139696 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4385999321909733 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4149252361476594 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46025355882139696 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.43882770849494557 iter_best_prior_anomaly= 870
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41493236070546535 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46025355882139696 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.43956551931949583 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41509161552700985 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.46025334927557915 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4396635867622364 iter_best_prior_anomaly= 1040
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41515762245962373 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4602539779130326 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4404868922804578 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41532588775133444 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.46025418745885044 at iter 33
max_prior_anomaly= 0.44092232848989127 at iter 122
max_prior_star_anomaly= 0.415986900033653 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4602539779130326
accuracies_anomaly['prior'][-1]= 0.4407085917557132
accuracies_anomaly['prior_star'][-1]= 0.4153287166198751



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.36173701286316 seconds
back and forth 7/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46025376836721477
 first_prior_anomaly_auc= 0.44159161783201384
 first_prior_star_anomaly_auc= 0.41564020647806704


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4537905371623222; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4335597266349078; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.415550939959675 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.454655751844108; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4315755372859542; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4188942434830203 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45541598407116507; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4292844680868006; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4227492578934862 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4552852274808444; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4319088199091996; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4257009202833227 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.46025376836721477 at iter 0
0.44159161783201384 at iter 0
0.4278445739996387 at iter 480
last anomaly aucs:
0.45534306212656317
0.42490024571342594
0.4263842491952393




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.169480323791504 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4562051336210816,first_prior_anomaly_auc= 0.43268675875786267, first_prior_star_anomaly_auc= 0.4296171220725925


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4562051336210816 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4305849094322021 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4273238526423518 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4562051336210816 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.433389156339201 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4274602669697537 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4562051336210816 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43459446388331147 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4275382180139834 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4562051336210816 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.434061379322773 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42734857904885476 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4562051336210816 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.43378205474761666 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4272743998293459 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4562051336210816 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.4334088536460763 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42714888188447064 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4562049240752638 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.43350534949518316 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4271324325377717 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4562051336210816 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.43342195025969016 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.427015610744336 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4562051336210816 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.43328668843428625 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4270374035093895 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4562051336210816 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.43448822415367583 iter_best_prior_anomaly= 930
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42725009251447854 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4562051336210816 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.43388473219834944 iter_best_prior_anomaly= 930
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42723605294468453 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4562051336210816 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.433110669947316 iter_best_prior_anomaly= 930
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42699444661673613 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4562053431668994 at iter 42
max_prior_anomaly= 0.4350889920133707 at iter 93
max_prior_star_anomaly= 0.4296171220725925 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4562051336210816
accuracies_anomaly['prior'][-1]= 0.43154724860054827
accuracies_anomaly['prior_star'][-1]= 0.4267287425197382



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.20182967185974 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 6 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4676002351942259
accuracies_anomaly["prior"][-1]= 0.41291275811329975
accuracies_anomaly["prior_star"][-1]= 0.4643864309862945


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam photoGGAD 
took 1192.5037052631378 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 5 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.002933025360107422 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4654521810157356
 first_prior_anomaly_auc= 0.41208515690581293
 first_prior_star_anomaly_auc= 0.4622610077561289


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5435851110152788; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41210474943977926; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 80 
last prior star auc 0.5202331155314104 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5411690477357946; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.41208840486598913; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 80 
last prior star auc 0.5159822690710791 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5505652917527376; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41206996483402086; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 80 
last prior star auc 0.5232110759213835 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5436552040913402; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4120647261885753; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 80 
last prior star auc 0.5151930147482537 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5505933708923257 at iter 310
0.4121110358143139 at iter 80
0.5232110759213835 at iter 300
last anomaly aucs:
0.5409674646590501
0.4120705934714743
0.5120572663574608




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 60.99427938461304 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5409898860615571,first_prior_anomaly_auc= 0.412069755288203, first_prior_star_anomaly_auc= 0.5120350545007717


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5409900956073748 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41299039483880273 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5111028899301919 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5409900956073749 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41493403707200793 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5099565695337982 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5409900956073749 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4207111104964434 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5085826823792503 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5409900956073749 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4304188443715784 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.506701275253938 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5409900956073749 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.42843172138117513 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5048436515789487 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5409900956073749 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4293367497683471 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5036850727522125 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.540989990834466 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.42996255835327163 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5030884958088742 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5409900956073749 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.42449666046830137 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5020701031342606 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5409900956073749 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41465450295103373 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5006550402265106 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5409900956073749 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.40759909526497695 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.499198487246832 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5409900956073749 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.40434673462656623 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4982058687078106 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5409900956073748 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.40352594365815864 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49759671901540287 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5409903051531927 at iter 6
max_prior_anomaly= 0.4308034657201901 at iter 42
max_prior_star_anomaly= 0.5120350545007717 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5409900956073749
accuracies_anomaly['prior'][-1]= 0.4031824980627489
accuracies_anomaly['prior_star'][-1]= 0.49716924554704656



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 108.95180296897888 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5409900956073749
 first_prior_anomaly_auc= 0.40319192762455086
 first_prior_star_anomaly_auc= 0.49712042137149415


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5436310015493817; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4161368300663045; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 70 
last prior star auc 0.5018148763281538 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5489414164375283; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41269147772968; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 70 
last prior star auc 0.5050649319625684 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5574691978125093; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4133064947049867; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 70 
last prior star auc 0.5124907118816251 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5684068608653488; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4116332713496804; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 70 
last prior star auc 0.5197140705406659 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5771853638113534 at iter 490
0.4170410202702052 at iter 70
0.5252492233184263 at iter 490
last anomaly aucs:
0.5771853638113534
0.4093022836722318
0.5252492233184263




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.01788568496704 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5779008580063058,first_prior_anomaly_auc= 0.409439536182905, first_prior_star_anomaly_auc= 0.5259043683178457


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5779011723250325 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41234509849282075 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5279249138661917 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5779010675521236 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4132878451272006 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5258057770105606 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5779009627792147 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41376917187073703 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5255390251844737 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5779010675521234 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.414088938788733 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5253724362593055 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5779009627792147 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4143667965431646 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5252217728162916 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5779010675521236 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.41466623751683174 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5250845203056184 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5779009627792145 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.41503608588528706 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5249745087512621 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5779011723250325 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.41529414155993455 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5248598871889135 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5779009627792147 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.4155817431948948 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5247537522321868 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5779010675521234 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.4158034426701502 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5246650095783394 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5779011723250325 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.41589166145945305 iter_best_prior_anomaly= 1090
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.52457259987268 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5779010675521236 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.4160689372213302 iter_best_prior_anomaly= 1190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5244967442866286 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5779013818708503 at iter 55
max_prior_anomaly= 0.4161911024331203 at iter 127
max_prior_star_anomaly= 0.5311186016756122 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5779011723250325
accuracies_anomaly['prior'][-1]= 0.41603834353192826
accuracies_anomaly['prior_star'][-1]= 0.5243972100231632



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 108.92043328285217 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5779009627792145
 first_prior_anomaly_auc= 0.41615663214608867
 first_prior_star_anomaly_auc= 0.5244458246528978


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5894538523531786; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4195333582273765; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5336302178480232 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5938498092923512; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4130898243293591; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.5338732909966963 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5979570120945655; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4128964135395097; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.5357760717954263 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6012669978328771; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4153835128512354; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.5374106339473446 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6018598029514948 at iter 480
0.4304347698537328 at iter 10
0.5377626709212849 at iter 290
last anomaly aucs:
0.6010253915049287
0.4129645159303017
0.5338357822953061




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.07414245605469 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6010668815768574,first_prior_anomaly_auc= 0.4133079615257115, first_prior_star_anomaly_auc= 0.5348308106112326


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6010668815768574 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4228701658303693 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5404456955726741 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6010664624852218 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41172693833024676 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5349396696635909 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6010667768039486 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4074413072641573 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.532938088011758 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6010667768039485 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.406276861154522 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5324547705829523 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6010670911226752 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4060564189541736 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5322996019048553 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6010664624852218 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4061259881656904 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5322478440878533 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6010664624852218 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4062726702381656 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5322187172191761 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6010664624852218 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4064417737131477 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5322023726453861 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6010668815768574 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4066358131404506 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.532189590350499 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6010666720310396 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4068979549585456 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5321885426214098 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6010668815768574 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4071447999319395 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5322034203744751 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6010667768039486 iter_best_vanilla_star_anomaly= 1170 
last prior auc 0.4073868253515236 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5322335949722414 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6010671958955842 at iter 117
max_prior_anomaly= 0.4228701658303693 at iter 10
max_prior_star_anomaly= 0.5436387547446411 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6010664624852218
accuracies_anomaly['prior'][-1]= 0.4075536238225097
accuracies_anomaly['prior_star'][-1]= 0.5322403004384118



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.47593641281128 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6010666720310396
 first_prior_anomaly_auc= 0.40774022437327995
 first_prior_star_anomaly_auc= 0.5322882864306929


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.604770603906856; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4280008951797338; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 50 
last prior star auc 0.5396889208516109 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6036407328571614; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4178691453422365; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 50 
last prior star auc 0.5321690548603524 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6013801525745008; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41895071608092327; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 50 
last prior star auc 0.5242628911539395 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5971047892534846; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.413009987372769; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 50 
last prior star auc 0.5105026459350417 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6080336513819756 at iter 50
0.4416676829638831 at iter 50
0.5487085062610195 at iter 50
last anomaly aucs:
0.5945124979412123
0.41152577434513793
0.5005932242102532




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.115516901016235 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5951027885100161,first_prior_anomaly_auc= 0.4171623472987239, first_prior_star_anomaly_auc= 0.5023043753585853


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5951019503267448 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42294633573514756 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5080817631017475 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5951025789641983 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4094190006927585 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5016983688534449 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5951021598725627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40727639470553156 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5000602444226238 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5951021598725627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40699707013037517 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4997728523334813 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5951023694183805 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40706475342953163 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4996395811933466 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5951025789641983 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4072451723786762 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49956592583838233 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5951023694183805 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40748489279426414 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49956540197383775 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5951021598725627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4077769996643076 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49954968603750116 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5951023694183805 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4080999097695709 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4995985102130536 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5951021598725627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4085133436681331 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4996324566355407 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5951023694183805 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4089284539332379 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.499755564803511 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5951021598725627 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40965453019199005 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4999435274020971 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5951027885100161 at iter 0
max_prior_anomaly= 0.4309652350915485 at iter 5
max_prior_star_anomaly= 0.5132489534234128 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5951025789641983
accuracies_anomaly['prior'][-1]= 0.40993678840859593
accuracies_anomaly['prior_star'][-1]= 0.5000165541196079



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 108.53565549850464 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5951023694183805
 first_prior_anomaly_auc= 0.4102024925055938
 first_prior_star_anomaly_auc= 0.5000831896896752


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5985885831894802; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4260716068350493; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 100 
last prior star auc 0.4931971997973273 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5937556184472403; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41909404542031325; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 100 
last prior star auc 0.46751348322564773 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5803365138197563; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4142119421837943; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 100 
last prior star auc 0.43762030549265685 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.48106963081798726; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.413716366324646; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 100 
last prior star auc 0.3999360047072372 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6031776365997754 at iter 20
0.4260716068350493 at iter 100
0.5075698426688091 at iter 10
last anomaly aucs:
0.44336647090896364
0.41068842925712234
0.38194942988869346




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.13098692893982 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.44092253803570913,first_prior_anomaly_auc= 0.41168523871250023, first_prior_star_anomaly_auc= 0.3810754142825591


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4409223284898913 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4214358247073798 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38154165372721244 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4409223284898913 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41233032551266435 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37193293025099816 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4409230619002537 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.41131193283805084 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37023099911865026 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4409223284898913 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4106957633607461 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3698261565986188 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.44092253803570913 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.41039925602852845 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36951917197551 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.44092253803570913 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.41048579845128874 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36964070854984654 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.44092316667316256 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.41078104850859953 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37006734383493156 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.44092264280861804 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.4113523751808904 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37063290799723236 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.44092274758152694 iter_best_vanilla_star_anomaly= 850 
last prior auc 0.4115972294690151 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37087723842081244 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.44092253803570913 iter_best_vanilla_star_anomaly= 850 
last prior auc 0.41181306166137144 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.371179822581747 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.44092253803570913 iter_best_vanilla_star_anomaly= 850 
last prior auc 0.412115645822306 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3721748508976733 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.44092211894407346 iter_best_vanilla_star_anomaly= 850 
last prior auc 0.41240984815052767 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37263490874070093 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4409235857647983 at iter 85
max_prior_anomaly= 0.43564680298041203 at iter 5
max_prior_star_anomaly= 0.3896160827253362 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.44092274758152694
accuracies_anomaly['prior'][-1]= 0.412973526400468
accuracies_anomaly['prior_star'][-1]= 0.37356990217982133



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.20817589759827 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.44092274758152694
 first_prior_anomaly_auc= 0.41302654149237694
 first_prior_star_anomaly_auc= 0.3736486914073223


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44060507612170924; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4279542712352684; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 70 
last prior star auc 0.3860847118304959 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4359093638901427; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4332196337725833; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 200 
last prior star auc 0.38715391936593113 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43033974082535065; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4216883274178549; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 210 
last prior star auc 0.38187399339427763 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4359722276354892; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4293220815610996; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 210 
last prior star auc 0.39218092353547385 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4569760526848477 at iter 10
0.4338172584450108 at iter 210
0.39230780352816486 at iter 10
last anomaly aucs:
0.43294617648032596
0.4183691216635591
0.3883778764878277




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.08996105194092 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43280075168275767,first_prior_anomaly_auc= 0.4237375807432422, first_prior_star_anomaly_auc= 0.3906313322126823


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43280054213693986 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42366717334845416 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39026305543786066 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43280054213693986 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42183050425524693 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3891519387388611 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43280075168275767 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4223668367759616 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3891791796951779 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43280075168275767 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4230474415922465 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38926069301831057 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43280085645566657 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.422981015567997 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3892525207314155 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43280075168275767 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.42294486891442273 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38927976168773226 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4328009612285755 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.423080968923098 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3893081551460472 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43280054213693986 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4233452061993711 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.389357712731962 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43280075168275767 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.42362453077452744 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3894054891784253 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4328007516827577 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4237544491815769 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3894400642383659 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43280096122857553 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4242248795425866 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38950125161716986 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43280054213693986 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.42454862783112113 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3895696683266886 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4328010660014844 at iter 126
max_prior_anomaly= 0.4334874333277594 at iter 6
max_prior_star_anomaly= 0.3935197117655367 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43280075168275767
accuracies_anomaly['prior'][-1]= 0.4247248558639092
accuracies_anomaly['prior_star'][-1]= 0.3896051863428094



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 108.8483669757843 seconds
back and forth 7/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43280096122857553
 first_prior_anomaly_auc= 0.42486462292439625
 first_prior_star_anomaly_auc= 0.38963117002421926


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.433112974951312; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41949605907180426; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.39134127344346226 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4351664191930558; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.42017896889208517; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 160 
last prior star auc 0.39695479635708786 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43672093484256613; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.42146715180714406; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 160 
last prior star auc 0.40044509627163505 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43817287781425274; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.4206016228066316; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 160 
last prior star auc 0.404015652234408 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4398471488986482 at iter 480
0.4271683696455281 at iter 160
0.40772335593494524 at iter 490
last anomaly aucs:
0.4396195821404938
0.41763843539681483
0.40772335593494524




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.087647438049316 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.440598370655539,first_prior_anomaly_auc= 0.42574890627560386, first_prior_star_anomaly_auc= 0.4103581850482353


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4405985802013568 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.42187272773753803 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4105142966825125 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4405983706555389 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.42527030362769913 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40928908228570904 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4405985802013568 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.42501340045504965 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40913716156778834 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4405983706555389 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4241437853110896 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4089146239092616 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4405981611097211 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.42357382068661453 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40879413506401413 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4405985802013568 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.42333598618338697 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40871262174088147 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.440598370655539 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.42374606734886405 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.408714402880333 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4405983706555389 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4235409219932166 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4086405379795508 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4405983706555389 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4237506773568561 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4086552061867984 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.440598370655539 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.42385922209048776 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40863928070464395 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4405983706555389 iter_best_vanilla_star_anomaly= 1020 
last prior auc 0.42414106121545797 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4086392807046439 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4405987897471746 iter_best_vanilla_star_anomaly= 1020 
last prior auc 0.4243430633838381 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4086451479875429 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4405989992929924 at iter 102
max_prior_anomaly= 0.4311851534273523 at iter 7
max_prior_star_anomaly= 0.4150131406182356 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4405987897471746
accuracies_anomaly['prior'][-1]= 0.42450231820538253
accuracies_anomaly['prior_star'][-1]= 0.4086778371351231



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 108.8324089050293 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 6 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.46545218101573566
accuracies_anomaly["prior"][-1]= 0.41208515690581293
accuracies_anomaly["prior_star"][-1]= 0.4622610077561289


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam photoGGAD 
took 1190.466145992279 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 6 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 2e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0030813217163085938 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46991215420225274
 first_prior_anomaly_auc= 0.4122635851696881
 first_prior_star_anomaly_auc= 0.46660007300576295


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5402080706152643; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4120630498220328; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5215722180801999 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5447971240255596; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4120260649851872; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.518491789785312 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5440381490734093; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4120123397341199; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.518096900691627 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5481800317084731; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4119867751443456; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5223820078931718 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5525138583126616 at iter 490
0.4122635851696881 at iter 0
0.5244586069477849 at iter 490
last anomaly aucs:
0.5525138583126616
0.4119731546661872
0.5244586069477849




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 60.99780607223511 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5529404935977467,first_prior_anomaly_auc= 0.4119706401163734, first_prior_star_anomaly_auc= 0.5246784205106798


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5529404935977467 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4419612566546513 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5157255754442476 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5529404935977467 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4237376855161511 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.512378081004546 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.552941227008109 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4209710520834512 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5117299557900234 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5529404935977467 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.420571657754683 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5114921212867958 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5529407031435645 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41984495285847734 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5114777673982749 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5529405983706556 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.42027556951410094 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.511626859247655 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5529405983706556 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41892714217641835 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5117641117583283 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5529404935977467 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4158675636904037 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5116285356141976 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5529403888248378 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4184380622376224 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5119495598071006 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5529408079164734 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41923915589915484 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.512394425578336 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5529403888248378 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41830625791821263 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5124476502160626 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5529404935977467 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4084580235722281 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5124352870128112 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.552941227008109 at iter 30
max_prior_anomaly= 0.45831023090691847 at iter 6
max_prior_star_anomaly= 0.5246784205106798 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5529407031435645
accuracies_anomaly['prior'][-1]= 0.420088654644604
accuracies_anomaly['prior_star'][-1]= 0.5132066251682129



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.31459712982178 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5529404935977467
 first_prior_anomaly_auc= 0.4187444182232778
 first_prior_star_anomaly_auc= 0.5137489297447355


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5585829338342316; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41522373416514635; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.516342059240279 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5641868176402375; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41535857689891464; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5201637558657113 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5708214573241083; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41539860015011865; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5251403642660679 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5787073998591014; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.41360740249937866; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.530699195721242 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5866461479401855 at iter 490
0.4187444182232778 at iter 0
0.5363631144040537 at iter 490
last anomaly aucs:
0.5866461479401855
0.4114987429346389
0.5363631144040537




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.17298722267151 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5873858446770961,first_prior_anomaly_auc= 0.4110102916332965, first_prior_star_anomaly_auc= 0.5367639755535467


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5873858446770961 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4026414507611333 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5395136357750031 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5873858446770962 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4148485423783366 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5376298188727859 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5873858446770961 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.40388657201062983 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5350180397994563 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5873856351312783 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.40862607931812117 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.537022345546921 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5873858446770961 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4119788124032684 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5372829157713821 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5873858446770961 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41485818148595643 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5381434156722671 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5873858446770961 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41270887003255924 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5385233222399777 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5873858446770962 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4115289175324052 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5391940784028251 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5873858446770961 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4110997676975064 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5385734036904372 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5873858446770962 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4138917561741628 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5400527971642584 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5873858446770961 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4114215253007716 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5388531473572291 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5873858446770961 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41167476142160914 iter_best_prior_anomaly= 1160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5385363140806827 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5873858446770962 at iter 1
max_prior_anomaly= 0.4418816292438791 at iter 116
max_prior_star_anomaly= 0.5462331415150917 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5873858446770962
accuracies_anomaly['prior'][-1]= 0.41628707441768265
accuracies_anomaly['prior_star'][-1]= 0.5406973600998779



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.09297776222229 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5873858446770962
 first_prior_anomaly_auc= 0.4233213179761394
 first_prior_star_anomaly_auc= 0.5428232024216791


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5967227872275956; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41863273030237885; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 40 
last prior star auc 0.5528124611030576 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6045868322246264; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41919242718178057; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 160 
last prior star auc 0.558315762916509 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6106835677941489; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.418329307958173; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 160 
last prior star auc 0.5622887516224084 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6139415861696408; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4094745303344813; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 160 
last prior star auc 0.5610874254488367 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6144340188415217 at iter 490
0.42730122169402707 at iter 160
0.5641834649071523 at iter 350
last anomaly aucs:
0.6144340188415217
0.4102356007448097
0.5604141547361756




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 60.99889779090881 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6140777909512248,first_prior_anomaly_auc= 0.4094483371072535, first_prior_star_anomaly_auc= 0.5598753076656471


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6140777909512248 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.43135279008160965 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5648438485520174 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6140782100428605 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.423720293213272 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5605091837645576 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6140778957241337 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.42242089959695955 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5598255405339143 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6140777909512248 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.42276099245928417 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5599627930445876 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6140778957241337 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.42292412387845835 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5606865642993437 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6140780004970428 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4236155203043611 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5608912905633555 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6140777909512248 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.42285444989403276 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5609269133523853 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6140777909512248 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4249425739686259 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5615970408777791 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6140777909512248 iter_best_vanilla_star_anomaly= 830 
last prior auc 0.42681633267158764 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5628970631315449 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6140777909512248 iter_best_vanilla_star_anomaly= 830 
last prior auc 0.42427265598904995 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5617122910775809 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6140777909512248 iter_best_vanilla_star_anomaly= 830 
last prior auc 0.4254385689194099 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5627225114652994 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6140777909512248 iter_best_vanilla_star_anomaly= 830 
last prior auc 0.4234700955067928 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5625332915918064 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6140782100428606 at iter 83
max_prior_anomaly= 0.43935702123076315 at iter 5
max_prior_star_anomaly= 0.5724793838347135 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6140777909512248
accuracies_anomaly['prior'][-1]= 0.4264795925423482
accuracies_anomaly['prior_star'][-1]= 0.56302740063023



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 108.7325553894043 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6140777909512248
 first_prior_anomaly_auc= 0.42625454033400767
 first_prior_star_anomaly_auc= 0.563017971068428


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.621249182247446; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.45857101067719763; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 100 
last prior star auc 0.5784599262482539 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6135778146299024; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.44963534836782665; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 100 
last prior star auc 0.5684950796546517 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6097973985305809; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4502921697337887; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 100 
last prior star auc 0.5659390397688626 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6013615029967148; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4538099201504707; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 100 
last prior star auc 0.5581789294974714 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6247168512136684 at iter 20
0.45857101067719763 at iter 100
0.5826365934890761 at iter 20
last anomaly aucs:
0.5968263028615995
0.4512458127506954
0.5536107258960493




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.32478332519531 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5960084455346415,first_prior_anomaly_auc= 0.45175762841072487, first_prior_star_anomaly_auc= 0.5530805749769604


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5960082359888237 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4640758840842827 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5576221662595192 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5960080264430059 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46275029724074257 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5554594438737813 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5960085503075504 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.46496163425621506 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5547465690015518 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5960082359888237 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4644418558551083 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5540157779618987 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5960082359888237 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4634969089896413 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5535186305091166 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5960080264430059 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4628707860859901 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5531452198617585 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5960078168971881 iter_best_vanilla_star_anomaly= 670 
last prior auc 0.4622000299231428 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5528334156848398 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5960082359888237 iter_best_vanilla_star_anomaly= 670 
last prior auc 0.46011609676490595 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5523638235071013 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5960082359888237 iter_best_vanilla_star_anomaly= 670 
last prior auc 0.45765162840150486 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5519426364132797 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5960084455346415 iter_best_vanilla_star_anomaly= 670 
last prior auc 0.4588804050772114 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.55213499947404 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5960081312159147 iter_best_vanilla_star_anomaly= 670 
last prior auc 0.45748042946834455 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5520486665970974 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5960086550804593 iter_best_vanilla_star_anomaly= 670 
last prior auc 0.45618564586002425 iter_best_prior_anomaly= 310
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5518481312494421 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5960086550804593 at iter 67
max_prior_anomaly= 0.46501014411304076 at iter 31
max_prior_star_anomaly= 0.5602963899865597 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5960082359888237
accuracies_anomaly['prior'][-1]= 0.45707495831085954
accuracies_anomaly['prior_star'][-1]= 0.5523608898656518



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.2279601097107 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5960080264430059
 first_prior_anomaly_auc= 0.4556198721519056
 first_prior_star_anomaly_auc= 0.5519184338713212


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5735082538002182; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.412472816668783; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.526985310419079 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5636736399323922; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41365538849165984; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5189999383935295 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.554383216553449; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41730567663811396; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5141852041374403 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5441286728667083; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41580616676578186; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5074348951621319 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5960080264430059 at iter 0
0.4556198721519056 at iter 0
0.5519184338713212 at iter 0
last anomaly aucs:
0.5378514135751324
0.4132576705294343
0.5026838628346604




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.28042197227478 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5381245565486631,first_prior_anomaly_auc= 0.42427056053087175, first_prior_star_anomaly_auc= 0.5067333357640649


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5381245565486631 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40738043420408 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5097055336440479 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5381244517757542 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42490433185687354 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5095959411813271 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.538124556548663 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43092573570488907 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5097378036999923 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.538124556548663 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43771659179594596 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5105407832738852 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5381245565486631 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44147647240512083 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5111706780022572 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5381245565486631 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4418587887497365 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5111664870859007 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.538124556548663 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4406771598830399 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5107054862866931 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.538124556548663 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43868343619937533 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5100644856299764 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5381245565486631 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4361188049350555 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5093530775784718 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5381245565486631 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43363118175878507 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5087070478221274 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5381245565486631 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43178089218741944 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5082408083774741 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.538124556548663 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43101060176110684 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5080727526315811 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5381245565486631 at iter 0
max_prior_anomaly= 0.44200557559512066 at iter 57
max_prior_star_anomaly= 0.5112268362814335 at iter 57
last values
accuracies_anomaly['vanilla_star'][-1]= 0.538124556548663
accuracies_anomaly['prior'][-1]= 0.43040239502487937
accuracies_anomaly['prior_star'][-1]= 0.5079227178260207



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.20651435852051 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.538124556548663
 first_prior_anomaly_auc= 0.43043246484973685
 first_prior_star_anomaly_auc= 0.5079503778739732


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.530298439344658; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4368990487877146; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 70 
last prior star auc 0.5061294247171026 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5243782461266504; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4384102932258448; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 70 
last prior star auc 0.5031442349964146 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5197355489869926; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4405206291571271; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 240 
last prior star auc 0.501209288914649 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5156419666629367; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4443104748182505; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 240 
last prior star auc 0.5004004420578573 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.538124556548663 at iter 0
0.44564014780523803 at iter 480
0.5113001773176711 at iter 10
last anomaly aucs:
0.5124193615306568
0.4435378793879418
0.4987247041527371




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.263444900512695 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5114793389919086,first_prior_anomaly_auc= 0.44548602685623023, first_prior_star_anomaly_auc= 0.4991152975571568


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5114793389919086 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4367075239102256 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.491446339716518 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5114793389919086 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43881848847896143 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4947047771836456 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5114793389919086 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4379612365382528 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49468067941459604 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5114792342189997 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43644705845867315 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49416352033621214 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5114792342189997 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43628832750167323 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49497446265118206 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5114793389919086 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43516348555160633 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4948338574074237 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5114793389919086 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43565204162585763 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4951921807558988 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5114792342189997 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.436049969133901 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4953880013226532 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5114793389919086 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43576833955474864 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49528836228627904 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5114793389919086 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43693152838947696 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4957288275953402 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5114793389919087 iter_best_vanilla_star_anomaly= 1100 
last prior auc 0.4351105752326064 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4948872915909682 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5114793389919086 iter_best_vanilla_star_anomaly= 1100 
last prior auc 0.43320999466496346 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49379052878048946 iter_best_prior_star_anomaly= 0
                                       
