

/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.005209922790527344 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40033575318538367
 first_prior_anomaly_auc= 0.47570794310517145
 first_prior_star_anomaly_auc= 0.40033163604025335


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 49


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 50 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5715600995113979 at iter 20
0.5887026052265099 at iter 20
0.5716254591903429 at iter 20
last anomaly aucs:
0.4049917296847193
0.5722699210640351
0.40499121504157803




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 10.435800313949585 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40539984169576976,first_prior_anomaly_auc= 0.5492410557595258, first_prior_star_anomaly_auc= 0.4053995843741991


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40539984169576976 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5565722759681211 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4054020289291203 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40539984169576976 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5483252482895835 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40539804044477523 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40539984169576976 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.548454166396479 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40540112830362296 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40539984169576976 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5492940640030796 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40539816910556054 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40539984169576976 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5478145936326292 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053989410702725 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40539984169576976 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5467279246397756 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053975258016339 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40539984169576976 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5472869557520119 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40539778312320457 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.40539984169576976 at iter 0
max_prior_anomaly= 0.5565722759681211 at iter 10
max_prior_star_anomaly= 0.40540498812718273 at iter 21
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40539984169576976
accuracies_anomaly['prior'][-1]= 0.5491657892001107
accuracies_anomaly['prior_star'][-1]= 0.40539739714084855



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.01131653785706 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40539984169576976
 first_prior_anomaly_auc= 0.55111615804485
 first_prior_star_anomaly_auc= 0.4053957245506393


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4003357531853837
accuracies_anomaly["prior"][-1]= 0.47570794310517145
accuracies_anomaly["prior_star"][-1]= 0.40033163604025335


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 92.51791977882385 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.005300760269165039 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4025404844027103
 first_prior_anomaly_auc= 0.47335435135922405
 first_prior_star_anomaly_auc= 0.40254061306349564


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 56


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 57 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5720899246253655 at iter 20
0.5947733357212776 at iter 20
0.572163775916142 at iter 20
last anomaly aucs:
0.40536304471116685
0.5573174792367225
0.4053627873895962




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 12.096720695495605 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4052758126987166,first_prior_anomaly_auc= 0.5413222417443521, first_prior_star_anomaly_auc= 0.4052752980555753


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4052758126987166 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5309225904665447 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052752980555753 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4052758126987166 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5604960439381729 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40527362546536605 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 280, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 281 iterations

max values 
max_vanilla_star_anomaly= 0.4052758126987166 at iter 0
max_prior_anomaly= 0.5630561362445667 at iter 22
max_prior_star_anomaly= 0.40536831980336513 at iter 14
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4052758126987166
accuracies_anomaly['prior'][-1]= 0.5624771627106048
accuracies_anomaly['prior_star'][-1]= 0.40527709930656985



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 28.788575887680054 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.402540741724281
accuracies_anomaly["prior"][-1]= 0.47335435135922405
accuracies_anomaly["prior_star"][-1]= 0.4025406130634956


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 41.333492040634155 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004664421081542969 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4045089944181805
 first_prior_anomaly_auc= 0.49439386360104043
 first_prior_star_anomaly_auc= 0.40451053834760436


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 58


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 59 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5732168644440259 at iter 20
0.5938566276258379 at iter 10
0.5732827387661122 at iter 20
last anomaly aucs:
0.4053174987931618
0.5669078541748367
0.4053177561147325




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 12.469395875930786 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40530231682049356,first_prior_anomaly_auc= 0.5230633463949762, first_prior_star_anomaly_auc= 0.40530720593033587


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40530231682049356 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5170771460361672 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40530720593033587 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40530231682049356 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5164809319569716 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40530720593033587 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40530231682049356 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5203173392537881 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40530720593033587 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40530231682049356 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.523138484293606 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40530720593033587 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40530231682049356 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.523321439930338 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40530720593033587 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40530231682049356 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5255969345795932 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40530720593033587 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40530231682049356 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5265769437814125 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40530720593033587 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.40530231682049356 at iter 0
max_prior_anomaly= 0.5265995880796297 at iter 69
max_prior_star_anomaly= 0.40530720593033587 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40530231682049356
accuracies_anomaly['prior'][-1]= 0.5236872225430165
accuracies_anomaly['prior_star'][-1]= 0.40530720593033587



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.845947265625 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40530231682049356
 first_prior_anomaly_auc= 0.523576960249993
 first_prior_star_anomaly_auc= 0.40530720593033587


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40450886575739514
accuracies_anomaly["prior"][-1]= 0.49439386360104043
accuracies_anomaly["prior_star"][-1]= 0.40451053834760436


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 94.90290880203247 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.00465083122253418 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40368054762147376
 first_prior_anomaly_auc= 0.49913282630691047
 first_prior_star_anomaly_auc= 0.4036784890489086


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 57


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 58 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5724476016085686 at iter 20
0.5926388532927382 at iter 10
0.5725093587855246 at iter 20
last anomaly aucs:
0.4051996455138043
0.5525639778621106
0.40519887354909234




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 12.2799391746521 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4053732089132075,first_prior_anomaly_auc= 0.5069692974194764, first_prior_star_anomaly_auc= 0.40537269427006617


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4053732089132075 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.499500924813725 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40537269427006617 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4053732089132075 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4942940228316283 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40537269427006617 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4053732089132075 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.495960951966297 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40537269427006617 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4053732089132075 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5003367052751951 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40537269427006617 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4053732089132075 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5050536669867747 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40537269427006617 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4053732089132075 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5088811966894036 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40537269427006617 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4053732089132075 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5107231044921141 iter_best_prior_anomaly= 670
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40537269427006617 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4053732089132075 at iter 0
max_prior_anomaly= 0.5108795560070691 at iter 67
max_prior_star_anomaly= 0.40537269427006617 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4053732089132075
accuracies_anomaly['prior'][-1]= 0.5065696770202573
accuracies_anomaly['prior_star'][-1]= 0.40537269427006617



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.72768473625183 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4053732089132075
 first_prior_anomaly_auc= 0.5060994218498951
 first_prior_star_anomaly_auc= 0.40537269427006617


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40368080494304437
accuracies_anomaly["prior"][-1]= 0.49913282630691047
accuracies_anomaly["prior_star"][-1]= 0.40367848904890863


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 94.5954487323761 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004563808441162109 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.41175105270254553
 first_prior_anomaly_auc= 0.5309197599292674
 first_prior_star_anomaly_auc= 0.41174950877312166


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 47


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 48 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5743679924903273 at iter 20
0.6028552916122432 at iter 10
0.5744366973496907 at iter 20
last anomaly aucs:
0.4053854316878133
0.5725990353528959
0.40538607499173995




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 10.182104587554932 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40547214905712226,first_prior_anomaly_auc= 0.5692994008524549, first_prior_star_anomaly_auc= 0.4054711197708397


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40547214905712226 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5688892302688393 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4054711197708397 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40547214905712226 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5686247036942114 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4054711197708397 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40547214905712226 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5683684114098443 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4054711197708397 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40547214905712226 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5681271724373602 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4054711197708397 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40547214905712226 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5678047485093362 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4054711197708397 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40547214905712226 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5674565924242471 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4054711197708397 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40547214905712226 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5669437505339422 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4054711197708397 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.40547214905712226 at iter 0
max_prior_anomaly= 0.5692994008524549 at iter 0
max_prior_star_anomaly= 0.4054712484316251 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40547214905712226
accuracies_anomaly['prior'][-1]= 0.5664458332947351
accuracies_anomaly['prior_star'][-1]= 0.4054711197708397



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.6911108493805 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40547214905712226
 first_prior_anomaly_auc= 0.5664013166630127
 first_prior_star_anomaly_auc= 0.4054711197708397


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4117509240417602
accuracies_anomaly["prior"][-1]= 0.5309197599292674
accuracies_anomaly["prior_star"][-1]= 0.41174950877312166


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 92.45993518829346 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004629373550415039 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4051319699407234
 first_prior_anomaly_auc= 0.5032948740513841
 first_prior_star_anomaly_auc= 0.40513004002894354


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 58


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 59 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5722373698853478 at iter 20
0.592668445273363 at iter 10
0.5723009283132983 at iter 20
last anomaly aucs:
0.4054881029945026
0.5674955766422005
0.4054989105004699




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 12.467114925384521 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4052639759064667,first_prior_anomaly_auc= 0.5243584458600562, first_prior_star_anomaly_auc= 0.40526346126332535


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4052639759064667 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5237039484451087 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40526346126332535 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4052639759064667 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5231741233311409 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40526346126332535 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4052639759064667 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5226957625313032 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40526346126332535 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4052639759064667 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5222161151236121 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40526346126332535 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4052639759064667 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5217404562002662 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40526346126332535 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4052639759064667 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5213021089046644 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40526346126332535 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4052639759064667 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5208807448327256 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40526346126332535 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4052639759064667 at iter 0
max_prior_anomaly= 0.5243584458600562 at iter 0
max_prior_star_anomaly= 0.40526346126332535 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4052639759064667
accuracies_anomaly['prior'][-1]= 0.5205915153873153
accuracies_anomaly['prior_star'][-1]= 0.40526346126332535



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.91937947273254 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4052639759064667
 first_prior_anomaly_auc= 0.5205628240321878
 first_prior_star_anomaly_auc= 0.40526346126332535


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4051319699407234
accuracies_anomaly["prior"][-1]= 0.5032948740513841
accuracies_anomaly["prior_star"][-1]= 0.40513016868972884


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 94.9749104976654 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004631757736206055 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4055367367713554
 first_prior_anomaly_auc= 0.5098807623305923
 first_prior_star_anomaly_auc= 0.4055384093615646


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 56


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 57 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5721081944568817 at iter 20
0.5958951291085248 at iter 10
0.5721787005672396 at iter 20
last anomaly aucs:
0.40534593282671866
0.56542002085334
0.40534541818357733




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 12.078108310699463 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4052215178473094,first_prior_anomaly_auc= 0.5005863071987253, first_prior_star_anomaly_auc= 0.4052212605257388


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 70, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 71 iterations

max values 
max_vanilla_star_anomaly= 0.4052215178473094 at iter 0
max_prior_anomaly= 0.519448364309704 at iter 6
max_prior_star_anomaly= 0.4052212605257388 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4052215178473094
accuracies_anomaly['prior'][-1]= 0.519448364309704
accuracies_anomaly['prior_star'][-1]= 0.4052212605257388



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 7.336566686630249 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4055367367713554
accuracies_anomaly["prior"][-1]= 0.5098807623305923
accuracies_anomaly["prior_star"][-1]= 0.40553828070077924


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 19.859827041625977 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004453182220458984 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40663073942897254
 first_prior_anomaly_auc= 0.499079946724142
 first_prior_star_anomaly_auc= 0.4066306107681872


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 58


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 59 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5765845604999038 at iter 20
0.5999431833972005 at iter 20
0.5766578971475389 at iter 20
last anomaly aucs:
0.40524261821610275
0.5727935704603071
0.4052523964357875




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 12.454654216766357 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4052023473902961,first_prior_anomaly_auc= 0.5198667691835804, first_prior_star_anomaly_auc= 0.4052013181040135


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4052023473902961 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5062274393312933 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052013181040135 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 159, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 160 iterations

max values 
max_vanilla_star_anomaly= 0.4052023473902961 at iter 0
max_prior_anomaly= 0.5209396714724044 at iter 15
max_prior_star_anomaly= 0.4052013181040135 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4052023473902961
accuracies_anomaly['prior'][-1]= 0.5209396714724044
accuracies_anomaly['prior_star'][-1]= 0.4051880660431251



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 16.33534049987793 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40663073942897254
accuracies_anomaly["prior"][-1]= 0.499079946724142
accuracies_anomaly["prior_star"][-1]= 0.40663061076818724


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 29.234862327575684 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004970073699951172 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40972580328074715
 first_prior_anomaly_auc= 0.5387162175375972
 first_prior_star_anomaly_auc= 0.4097254172983911


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 56


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 57 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5768640117256294 at iter 20
0.6018243327394351 at iter 10
0.5769309153339983 at iter 20
last anomaly aucs:
0.4050690548166995
0.5597640927304597
0.4050682828519876




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 12.090014457702637 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40535854158368045,first_prior_anomaly_auc= 0.5310341393674213, first_prior_star_anomaly_auc= 0.4053582842621098


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40535854158368045 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5230041624337268 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053582842621098 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40535854158368045 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5150452062535318 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053582842621098 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40535854158368045 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.513777511535726 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053582842621098 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40535854158368045 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5176153341011809 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053582842621098 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40535854158368045 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5238176845793359 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053582842621098 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40535854158368045 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5275020148278982 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053582842621098 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40535854158368045 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5317802432615201 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053582842621098 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40535854158368045 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5327614104104073 iter_best_prior_anomaly= 770
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40535802694053913 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40535854158368045 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.536111994581837 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40535802694053913 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40535854158368045 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5389983706398146 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053581556013245 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40535854158368045 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5431301830997368 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053581556013245 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40535854158368045 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5478086752365043 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40528674886546917 iter_best_prior_star_anomaly= 1160
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40535854158368045 at iter 0
max_prior_anomaly= 0.551154498958877 at iter 129
max_prior_star_anomaly= 0.40537758337990853 at iter 116
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40535854158368045
accuracies_anomaly['prior'][-1]= 0.551154498958877
accuracies_anomaly['prior_star'][-1]= 0.4053232885285014



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 132.92386078834534 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40535854158368045
 first_prior_anomaly_auc= 0.5513487767447174
 first_prior_star_anomaly_auc= 0.40532547576185196


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40972606060231775
accuracies_anomaly["prior"][-1]= 0.5387162175375972
accuracies_anomaly["prior_star"][-1]= 0.40972541729839107


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 145.60179162025452 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0045871734619140625 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4078660116288764
 first_prior_anomaly_auc= 0.507175926640708
 first_prior_star_anomaly_auc= 0.40786601162887637


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 61


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 62 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5791750167516343 at iter 20
0.6001839077265434 at iter 20
0.5792384465187994 at iter 20
last anomaly aucs:
0.40522087454338285
0.5561291682234621
0.4052216465080949




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 13.265328645706177 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40521508480804325,first_prior_anomaly_auc= 0.5448732794193178, first_prior_star_anomaly_auc= 0.4052174007021791


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40521508480804325 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5405623711462234 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052174007021791 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40521508480804325 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5363920891114892 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052174007021791 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40521508480804325 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5346316235858893 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052174007021791 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40521508480804325 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5342946609891235 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052174007021791 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40521508480804325 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5365777466247129 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052174007021791 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40521508480804325 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5356822675588521 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052174007021791 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40521508480804325 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5360642614304815 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052174007021791 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40521508480804325 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5347712205379668 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40521752936296446 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40521508480804325 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5343615645974924 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40521752936296446 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40521508480804325 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5406530769998776 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052172720413938 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40521508480804325 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5430131017850912 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052167573982525 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40521508480804325 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5446867212805968 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40521714338060844 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40521508480804325 at iter 0
max_prior_anomaly= 0.5458238253012978 at iter 128
max_prior_star_anomaly= 0.4052194592747443 at iter 124
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40521508480804325
accuracies_anomaly['prior'][-1]= 0.5457867709951243
accuracies_anomaly['prior_star'][-1]= 0.40519887354909234



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 133.03223037719727 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40521508480804325
 first_prior_anomaly_auc= 0.545887255068463
 first_prior_star_anomaly_auc= 0.40519514238631793


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4078660116288765
accuracies_anomaly["prior"][-1]= 0.507175926640708
accuracies_anomaly["prior_star"][-1]= 0.4078660116288764


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 146.88587284088135 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004556417465209961 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4057907131615866
 first_prior_anomaly_auc= 0.4964378974974963
 first_prior_star_anomaly_auc= 0.4057934150380785


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 57


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 58 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.569874128580501 at iter 20
0.5942909864370947 at iter 10
0.5699364004005982 at iter 20
last anomaly aucs:
0.405072785979474
0.5518481092525632
0.40507047008533814




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 12.296766757965088 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4053968824977073,first_prior_anomaly_auc= 0.5360736536678102, first_prior_star_anomaly_auc= 0.40539997035655506


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4053968824977073 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5348762077387919 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40539997035655506 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4053968824977073 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5337325420180392 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40539997035655506 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4053968824977073 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.532735163610201 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40539997035655506 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4053968824977073 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5318081626519355 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40539997035655506 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4053968824977073 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5310500933048015 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40539997035655506 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4053968824977073 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5303252184402814 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40539997035655506 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4053968824977073 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5296709783469045 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40539997035655506 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4053968824977073 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5289883042199709 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40539997035655506 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4053968824977073 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5278810495014652 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40539997035655506 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4053968824977073 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5266812876783109 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40539997035655506 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4053968824977073 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5254439569058419 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40539997035655506 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4053968824977073 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5242897410006927 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40539997035655506 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4053968824977073 at iter 0
max_prior_anomaly= 0.5360736536678102 at iter 0
max_prior_star_anomaly= 0.40539997035655506 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4053968824977073
accuracies_anomaly['prior'][-1]= 0.5232820697300286
accuracies_anomaly['prior_star'][-1]= 0.40539997035655506



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 133.05505990982056 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4053968824977073
 first_prior_anomaly_auc= 0.5232015280784151
 first_prior_star_anomaly_auc= 0.40539997035655506


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4057907131615866
accuracies_anomaly["prior"][-1]= 0.4964378974974963
accuracies_anomaly["prior_star"][-1]= 0.40579328637729317


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 145.94012093544006 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0046885013580322266 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40910681624254924
 first_prior_anomaly_auc= 0.5180028603865793
 first_prior_star_anomaly_auc= 0.4091070735641199


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 58


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 59 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5725829527547304 at iter 20
0.599228858717077 at iter 10
0.5726519149356645 at iter 20
last anomaly aucs:
0.40541142116644896
0.5666123203509456
0.4054141230429408




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 12.489569664001465 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40523798642783104,first_prior_anomaly_auc= 0.5441316786527054, first_prior_star_anomaly_auc= 0.4052372144631191


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40523798642783104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5436646400019762 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052372144631191 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40523798642783104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5432395447672629 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052372144631191 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40523798642783104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5427800971028679 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052372144631191 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40523798642783104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5423791900957956 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052372144631191 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40523798642783104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5419984828320193 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052372144631191 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40523798642783104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5416464669233707 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052372144631191 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40523798642783104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5412171258827417 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052372144631191 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40523798642783104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5407759480498627 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052372144631191 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40523798642783104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5402848498322779 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052372144631191 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40523798642783104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5397699493694078 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052372144631191 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40523798642783104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5392953197323443 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052372144631191 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40523798642783104 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.538897114601764 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052372144631191 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40523798642783104 at iter 0
max_prior_anomaly= 0.5441316786527054 at iter 0
max_prior_star_anomaly= 0.4052372144631191 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40523798642783104
accuracies_anomaly['prior'][-1]= 0.5384664869532817
accuracies_anomaly['prior_star'][-1]= 0.4052372144631191



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 132.7417984008789 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40523798642783104
 first_prior_anomaly_auc= 0.538411934780304
 first_prior_star_anomaly_auc= 0.4052372144631191


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40910681624254924
accuracies_anomaly["prior"][-1]= 0.5180028603865793
accuracies_anomaly["prior_star"][-1]= 0.4091070735641199


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 145.81994032859802 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004697322845458984 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40295361418438835
 first_prior_anomaly_auc= 0.489501923221419
 first_prior_star_anomaly_auc= 0.4029528422196764


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.499170652577796; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5904800539757726; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.49924077270579803 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5810918051314038; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5896693623674408; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 120 
last prior star auc 0.5811593520436994 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.552820784789619; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5890085605740124; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 120 
last prior star auc 0.5529004258157351 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5640228933854976; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5923322546413091; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 400 
last prior star auc 0.5640950720860648 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5947428431151555 at iter 490
0.5927799941742395 at iter 430
0.5948708605965538 at iter 490
last anomaly aucs:
0.5947428431151555
0.5919121771772234
0.5948708605965538




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.24091696739197 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5974296662950943,first_prior_anomaly_auc= 0.5916895940186115, first_prior_star_anomaly_auc= 0.5975315656370717


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.597429151651953 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46294492186173186 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5985128614467443 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5974294089735237 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.592794790164552 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5999936184250478 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.597429151651953 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5913831240279678 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.600218260156225 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5974292803127383 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5939501640167691 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6002144003326653 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5974295376343091 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5931331680299564 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6002508113349123 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5974291516519531 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5906736884576866 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.599972260734684 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5974292803127383 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5927114179756615 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6003147557452186 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5974296662950943 at iter 0
max_prior_anomaly= 0.6026008005788706 at iter 17
max_prior_star_anomaly= 0.6003847472124354 at iter 27
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5974294089735237
accuracies_anomaly['prior'][-1]= 0.5928228382157529
accuracies_anomaly['prior_star'][-1]= 0.60025582910554



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.32460808753967 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.597429537634309
 first_prior_anomaly_auc= 0.5906878411440722
 first_prior_star_anomaly_auc= 0.600225722481774


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6068211316590962; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5942027251383618; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.6073903269733734 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6108420385220683; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5357065844472784; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 60 
last prior star auc 0.6108169496689301 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6161054225889226; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5291497735055535; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 60 
last prior star auc 0.6145352463648182 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6212607315961041; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5262312322512446; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 60 
last prior star auc 0.6181796917699298 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6247232506507663 at iter 490
0.5998155518981583 at iter 60
0.6212014189740692 at iter 490
last anomaly aucs:
0.6247232506507663
0.5230642470204736
0.6212014189740692




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.40609884262085 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6252808664943642,first_prior_anomaly_auc= 0.5219243124624955, first_prior_star_anomaly_auc= 0.6216141627733913


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6252807378335788 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5565381808600097 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.625237250488139 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6252811238159348 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5863643241140161 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6248879364559821 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6252831823885 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6063359518376362 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6253544604635699 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6252804805120082 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.5982084500286657 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6246699850856419 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.625282796406144 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.5973994310105429 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6249477637211581 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6252818957806467 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.6008377618375642 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6249993566960733 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6252812524767202 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.5946260191220806 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.625398848434507 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6252840830139972 at iter 34
max_prior_anomaly= 0.6159162912344951 at iter 49
max_prior_star_anomaly= 0.6255094967098864 at iter 49
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6252815097982908
accuracies_anomaly['prior'][-1]= 0.6033882045850587
accuracies_anomaly['prior_star'][-1]= 0.6251546502639604



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.90721464157104 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6252815097982908
 first_prior_anomaly_auc= 0.5941641269027643
 first_prior_star_anomaly_auc= 0.6252019974329601


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6298604184872167; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5829594450911794; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6294111350248625 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6340243961434702; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5205023534630852; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6304821074019065 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.635629568101183; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5163103277556309; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6335543982946785 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.637322358053702; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5133978335582323; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6359164816524573 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6392822477965553 at iter 490
0.5941641269027643 at iter 0
0.6379405731271878 at iter 490
last anomaly aucs:
0.6392822477965553
0.511064441555581
0.6379405731271878




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.38648986816406 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.639425833232978,first_prior_anomaly_auc= 0.5106437207875687, first_prior_star_anomaly_auc= 0.6381098907206754


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.639425833232978 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5896866029126743 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6391610493367794 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6394285351094697 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5949990067387373 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6384721994921501 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6394178562642878 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.6099689464328539 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6396701600643098 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6394169556387905 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5779276504379098 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393886502660191 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6394365120781599 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5954691332483143 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6390399795377887 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6394287924310404 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.6001354026104759 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6391948871233198 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.639425447250622 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.604493400730999 iter_best_prior_anomaly= 630
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6390982628735409 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6394399859193637 at iter 45
max_prior_anomaly= 0.6105602714022069 at iter 75
max_prior_star_anomaly= 0.6399821624687225 at iter 23
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6394286637702551
accuracies_anomaly['prior'][-1]= 0.5891704158419511
accuracies_anomaly['prior_star'][-1]= 0.6387631015277697



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.57435417175293 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6394336815408828
 first_prior_anomaly_auc= 0.6062744519822509
 first_prior_star_anomaly_auc= 0.6393068220065524


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6416052182755956; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5991035431121705; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6412130602019255 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6436148997423696; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5690880111821662; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.642639908311178 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6449226079644114; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5410340415852244; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6435817052597559 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6460332078633355; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5317622307515746; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6443997305328513 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6464576597941221 at iter 480
0.6062744519822509 at iter 0
0.6448612367698114 at iter 490
last anomaly aucs:
0.6464572738117662
0.5188744085463699
0.6448612367698114




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.6984977722168 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6464828773080459,first_prior_anomaly_auc= 0.5186123265266631, first_prior_star_anomaly_auc= 0.64502309203775


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6464849358806111 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6013807103516351 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6464837779335431 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6464854505237523 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6085370805529737 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6469313888056882 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6464823626649046 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6027277887739863 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6469578929274651 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.646485707845323 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6014896860368052 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6465093814298228 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6464842925766844 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5952134842678738 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.646880567795485 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6464814620394074 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5973671371534265 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6460258741985719 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6464824913256899 iter_best_vanilla_star_anomaly= 610 
last prior auc 0.6022284562661404 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6465568572596075 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6464878950786734 at iter 61
max_prior_anomaly= 0.6136537913245577 at iter 74
max_prior_star_anomaly= 0.6472280805766473 at iter 46
last values
accuracies_anomaly['vanilla_star'][-1]= 0.64648056141391
accuracies_anomaly['prior'][-1]= 0.6057502879428376
accuracies_anomaly['prior_star'][-1]= 0.6468498178677923



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.8840434551239 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6464808187354807
 first_prior_anomaly_auc= 0.6019829714877406
 first_prior_star_anomaly_auc= 0.6468670584130258


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6473254767911383; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6005221569311624; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.6474758812491829 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6477078566451238; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.592269596838856; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.647233870311987 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6477730876632835; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5838315078941111; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.6466456332014817 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6476078872149263; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5713412475155603; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.645752598690542 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6478487402050545 at iter 260
0.6050375071921379 at iter 20
0.6475267022593864 at iter 110
last anomaly aucs:
0.6473449045697223
0.5593106921229749
0.6447379797374702




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.68303656578064 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6473672915463689,first_prior_anomaly_auc= 0.5591613169512129, first_prior_star_anomaly_auc= 0.6447539336748505


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6473643323483065 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6136763069619895 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.647677878682143 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6473608585071026 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5918147809627327 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6476091738227796 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6473706367267873 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5971291147005755 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6468252436577953 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6473684494934369 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5978717447534705 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6475782952343015 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.647365747616945 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6007340612445924 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6473982987956322 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6473670342247982 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6017816173587072 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6475650431734131 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6473681921718661 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.601559291521666 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.647632718746494 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6473753971758442 at iter 7
max_prior_anomaly= 0.6364041060288386 at iter 42
max_prior_star_anomaly= 0.6499518294019744 at iter 42
last values
accuracies_anomaly['vanilla_star'][-1]= 0.647364975652233
accuracies_anomaly['prior'][-1]= 0.6000600073902755
accuracies_anomaly['prior_star'][-1]= 0.6479686520569772



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.47297549247742 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.647368964136578
 first_prior_anomaly_auc= 0.5945139555780626
 first_prior_star_anomaly_auc= 0.6476202386503175


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6476125190031979; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5982380420092903; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.6472576725572721 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6470891269284965; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5927794795310983; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.6462079292098066 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6463714570679546; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.591045003484134; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.6455451975045984 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6459718366687355; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5863495281237038; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.6443166156655314 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6477962466046419 at iter 70
0.6025176857115507 at iter 10
0.6479384167724258 at iter 10
last anomaly aucs:
0.6452666469043701
0.5837832600996143
0.6435418204163053




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.66290926933289 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6451688647075231,first_prior_anomaly_auc= 0.5825988089099137, first_prior_star_anomaly_auc= 0.6435341007691856


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6451657768486754 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6147564142547916 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.645796986661479 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6451698939938058 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.6019361389618825 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6449740722785414 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6451641042584662 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5964668976385084 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6445570826733035 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6451683500643819 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5914815495287413 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6450663220616193 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6451686073859525 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6036338180242438 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6453372816755134 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6451647475623927 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.596928532536254 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6445817855440859 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6451677067604552 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5950614072196199 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6444563412783942 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6451733678350096 at iter 25
max_prior_anomaly= 0.618000338635187 at iter 9
max_prior_star_anomaly= 0.645837772130427 at iter 9
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6451661628310315
accuracies_anomaly['prior'][-1]= 0.5964379489618103
accuracies_anomaly['prior_star'][-1]= 0.6447500738512908



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.04067945480347 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6451692506898792
 first_prior_anomaly_auc= 0.6069294640403398
 first_prior_star_anomaly_auc= 0.645140687995537


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6439855714648905; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6026387555105415; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 30 
last prior star auc 0.6437514088355993 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6427221225530005; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5957988908411019; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 30 
last prior star auc 0.6422837752573988 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6417368382589829; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5907084268697242; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 30 
last prior star auc 0.641315088204688 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6411295593522495; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5932492200583194; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 30 
last prior star auc 0.6410981661206303 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6451692506898792 at iter 0
0.6084543516680099 at iter 30
0.6452449032316502 at iter 30
last anomaly aucs:
0.6394596710195184
0.5829455497263643
0.6388700186403746




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.77374386787415 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6397720594062871,first_prior_anomaly_auc= 0.590455222444205, first_prior_star_anomaly_auc= 0.6397945750437188


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6397721880670724 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5881451180436972 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6417666875611783 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.639772059406287 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5951959864010696 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6421147149854819 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6397729600317844 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5915587459999362 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6421697818016009 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6397712874415751 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.594033664866445 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419529883783286 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6397721880670724 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6001795332598423 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6413125149889816 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.639772831370999 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5996642468146163 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6416835726938583 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6397721880670724 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6000710722178134 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.641643430528837 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6397730886925697 at iter 19
max_prior_anomaly= 0.6071113903907891 at iter 29
max_prior_star_anomaly= 0.642621767140447 at iter 29
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6397719307455018
accuracies_anomaly['prior'][-1]= 0.5942810795566247
accuracies_anomaly['prior_star'][-1]= 0.6416258040012475



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.89201402664185 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6397723167278577
 first_prior_anomaly_auc= 0.6034906185701773
 first_prior_star_anomaly_auc= 0.6415089800081726


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6382402240962094; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5868363805353729; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6392904820868162 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6371893228016761; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5866637177614671; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6389726899470638 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6347411653785149; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5781198696511851; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6350776133321394 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6327354723960859; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5809453891577041; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6339623816449437 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6397723167278577 at iter 0
0.6034906185701773 at iter 0
0.6415089800081726 at iter 0
last anomaly aucs:
0.6297998192573288
0.586430841740029
0.6334001340130739




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.6108922958374 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6290575751867897,first_prior_anomaly_auc= 0.5855334327623882, first_prior_star_anomaly_auc= 0.6330541651613355


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6290586044730724 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5912857278134769 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6344798553235201 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6290583471515017 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.5917058052775624 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6342652491335983 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.629058861794643 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5887821175918407 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6335421755200726 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6290578325083604 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5906657114889964 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6330073326354771 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6290580898299309 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5956423106653617 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6334822195941112 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.629057317865219 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5942357909601903 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6339892717490765 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6290578325083603 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.5923632618905724 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6344795980019494 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6290589904554283 at iter 66
max_prior_anomaly= 0.6204042367481964 at iter 7
max_prior_star_anomaly= 0.6355059250864858 at iter 9
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6290575751867896
accuracies_anomaly['prior'][-1]= 0.5937246216600947
accuracies_anomaly['prior_star'][-1]= 0.6343856756286622



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.22401714324951 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4029537428451737
accuracies_anomaly["prior"][-1]= 0.489501923221419
accuracies_anomaly["prior_star"][-1]= 0.4029528422196764


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 1489.1426401138306 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.00465703010559082 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40335271994046606
 first_prior_anomaly_auc= 0.4850206680685546
 first_prior_star_anomaly_auc= 0.4033531059228221


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4902475124723765; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5886211629493991; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4903218784062943 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5746484730023355; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5908010626351582; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5747299152794462 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5504633332201119; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5910143822172268; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 280 
last prior star auc 0.5505284355774862 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5525610186640482; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5937602606976295; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 400 
last prior star auc 0.5526433615666562 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5761983208223584 at iter 190
0.5949169211577 at iter 460
0.5762562181757548 at iter 190
last anomaly aucs:
0.574365933917762
0.5945582148882144
0.5744472475340874




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.66733193397522 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5773230734076684,first_prior_anomaly_auc= 0.5943555741513278, first_prior_star_anomaly_auc= 0.5774139079221077


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.577323330729239 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5751043181647414 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5789019985651749 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5773229447468831 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5881089643630211 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5801291651356033 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5773232020684538 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5820969031863615 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5799464668204422 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5773230734076684 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5824435153420267 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5799812052324798 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5773230734076684 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5798409649764757 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5799528998597083 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.577323330729239 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5815102100052802 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5801515521122499 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5773232020684537 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.580299769336944 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5801653188162795 iter_best_prior_star_anomaly= 670
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5773233307292391 at iter 9
max_prior_anomaly= 0.6087581197821619 at iter 1
max_prior_star_anomaly= 0.5802547380620804 at iter 76
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5773232020684538
accuracies_anomaly['prior'][-1]= 0.5805900280686369
accuracies_anomaly['prior_star'][-1]= 0.5801718805163312



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.90116262435913 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5773229447468831
 first_prior_anomaly_auc= 0.5785085538836515
 first_prior_star_anomaly_auc= 0.5801340542454456


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.603715903605281; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5716460449159948; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 40 
last prior star auc 0.604711995405266 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6097156133465493; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5619253366023466; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 40 
last prior star auc 0.6096997880699544 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6119307660874872; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5598710098430647; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 40 
last prior star auc 0.6116717719266285 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.614522122964715; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.557036870063929; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 40 
last prior star auc 0.6138869246675662 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6158495162869115 at iter 490
0.5818973503083227 at iter 40
0.6153971449657094 at iter 490
last anomaly aucs:
0.6158495162869115
0.5554527984750094
0.6153971449657094




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.72499918937683 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6159837094860053,first_prior_anomaly_auc= 0.5572406687478836, first_prior_star_anomaly_auc= 0.6156086632967834


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6159848674330732 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6009803179877041 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6159575913465843 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6159846101115026 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6006225123437158 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.616261230799951 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6159847387722879 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6102444091742345 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.616326976461252 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.615984352789932 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6083310946356687 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6163545098693115 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6159840954683613 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6019638010307273 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6162760267902634 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6159840954683613 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5935981481081204 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6160149740568392 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6159840954683613 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5966444495222568 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6161251076890772 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6159858967193559 at iter 79
max_prior_anomaly= 0.6111744979913478 at iter 23
max_prior_star_anomaly= 0.61643711009349 at iter 23
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6159858967193559
accuracies_anomaly['prior'][-1]= 0.5970719893118912
accuracies_anomaly['prior_star'][-1]= 0.6161598461011151



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.3776466846466 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6159844814507173
 first_prior_anomaly_auc= 0.5959606174482551
 first_prior_star_anomaly_auc= 0.616159846101115


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6179232708247774; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6015173481056502; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6183052646964069 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6202331179037144; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6032112960052369; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 180 
last prior star auc 0.6204039794266258 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6232988470964349; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6039709092817949; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 300 
last prior star auc 0.6233714117793582 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6253298862535729; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5945400737174835; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 300 
last prior star auc 0.6256794576073006 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6281846117583606 at iter 490
0.6039709092817949 at iter 300
0.6280640566025113 at iter 490
last anomaly aucs:
0.6281846117583606
0.5820029808130744
0.6280640566025113




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.67481732368469 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6285188724786346,first_prior_anomaly_auc= 0.5821001197059947, first_prior_star_anomaly_auc= 0.6283486542596499


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6285110241707298 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6007811510920213 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.628301564412221 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6285110241707298 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5732689720620824 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6272407562372175 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.628522217659053 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6015686837589946 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6285330251650204 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6285231182845503 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.6056715475422187 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6282262978528058 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6285081936334526 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.60702853284504 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6286762246190869 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6285202877472732 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.5966336420162895 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6283405486301744 iter_best_prior_star_anomaly= 530
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.628513082743295 iter_best_vanilla_star_anomaly= 680 
last prior auc 0.6001709129872256 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6284936549647109 iter_best_prior_star_anomaly= 530
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6285276214120368 at iter 68
max_prior_anomaly= 0.6158989220284763 at iter 23
max_prior_star_anomaly= 0.6289161769837177 at iter 53
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6285129540825097
accuracies_anomaly['prior'][-1]= 0.6079159062814254
accuracies_anomaly['prior_star'][-1]= 0.6285139833687923



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.00959968566895 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6285084509550232
 first_prior_anomaly_auc= 0.6124228935913548
 first_prior_star_anomaly_auc= 0.6286768679230135


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6315088204687987; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5977309898543252; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6315220725296872 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6341975735605174; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5915560441234444; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6338716757912894 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6365462761966223; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5903148535274155; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6356531130248975 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6377911979554256; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5859182571712949; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6377929992064204 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6386165568932846 at iter 490
0.6124228935913548 at iter 0
0.6386615881681483 at iter 470
last anomaly aucs:
0.6386165568932846
0.5823317091195794
0.6382524468708153




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.60876297950745 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6386389438699311,first_prior_anomaly_auc= 0.5854041286731367, first_prior_star_anomaly_auc= 0.6384738720823594


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.63863456940323 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5942647396368884 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.639025054886691 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6386352127071567 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5816557253534826 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6427783473161875 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.638632510830665 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.6229555801211881 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6395957941303921 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6386312242228116 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.6097843182059128 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6391943724801785 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6386289083286758 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.5963242128275833 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6385026920982722 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6386340547600888 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.6119986989821388 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6390273707808268 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6386332827953769 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.6190992304026465 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6398349745303111 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6386410024424963 at iter 23
max_prior_anomaly= 0.6266867428956088 at iter 59
max_prior_star_anomaly= 0.6427783473161875 at iter 20
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6386340547600888
accuracies_anomaly['prior'][-1]= 0.619141817122589
accuracies_anomaly['prior_star'][-1]= 0.6396916464154591



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.7476236820221 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6386286510071052
 first_prior_anomaly_auc= 0.6021266855849485
 first_prior_star_anomaly_auc= 0.63887014730116


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.639379515350261; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.607314545770817; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.6393903228562283 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6394579984293092; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6067631056449148; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.6399623487077826 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6384754160117834; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6055531796197199; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.6393447769382232 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.638095094730363; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6056837703168246; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.6383102155634262 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6395559092869414 at iter 160
0.6083730380516845 at iter 10
0.6399623487077826 at iter 200
last anomaly aucs:
0.6373500201225468
0.6055697768610268
0.6376244535776446




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.60281205177307 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6372571270355423,first_prior_anomaly_auc= 0.6043440255592369, first_prior_star_anomaly_auc= 0.6374205262329049


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.637260600876746 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6101489428715235 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6378794592541586 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6372627881100965 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.6136532766814162 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6390166919356449 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6372496647099934 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5988569003867028 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6373833432659459 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.637256226410045 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.6020671156413432 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6374631129528473 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6372476061374283 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.6060113406762617 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6397494151080698 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6372674198983683 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.6078586522319558 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6375104601218469 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6372510799786321 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.5986844949343675 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368828528110324 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6372699931140748 at iter 77
max_prior_anomaly= 0.6363712975285807 at iter 15
max_prior_star_anomaly= 0.6398453960539222 at iter 64
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6372527525688413
accuracies_anomaly['prior'][-1]= 0.6066067827907451
accuracies_anomaly['prior_star'][-1]= 0.637987791635402



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.13240242004395 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6372608581983167
 first_prior_anomaly_auc= 0.5995218193252617
 first_prior_star_anomaly_auc= 0.6392237071392326


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6366781535015804; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6053577438868114; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 100 
last prior star auc 0.6375488010358737 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6353120332830011; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6092795819450835; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 200 
last prior star auc 0.6373303350223922 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6344422863742052; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6049202972167069; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 260 
last prior star auc 0.6361223389089772 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6341897252526126; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6073275405101348; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 260 
last prior star auc 0.6358503500088004 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6372608581983167 at iter 0
0.6174611212838905 at iter 260
0.6392237071392326 at iter 0
last anomaly aucs:
0.6339601944115931
0.6053097534138853
0.6348910551934184




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.60987281799316 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6336157694892784,first_prior_anomaly_auc= 0.6057879855529378, first_prior_star_anomaly_auc= 0.6346823673996214


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6336161554716344 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5808379574019579 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.633712265078272 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6336161554716344 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6056287035007056 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.634288922718098 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6336162841324198 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.620289985970828 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6352837279102297 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6336162841324198 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.6177762115471511 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6355176332179504 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.633616026810849 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.6144750331172861 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.635209747958668 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6336160268108492 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.6169172721443223 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6351280483599867 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6336164127932051 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.6179115626933128 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6353532047343051 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6336167987755611 at iter 21
max_prior_anomaly= 0.6253240965182332 at iter 25
max_prior_star_anomaly= 0.6358040321260834 at iter 74
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6336157694892784
accuracies_anomaly['prior'][-1]= 0.6196823210817388
accuracies_anomaly['prior_star'][-1]= 0.6354387641565462



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.29395914077759 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.633616026810849
 first_prior_anomaly_auc= 0.618096962884966
 first_prior_star_anomaly_auc= 0.6353782935874437


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6324542199193657; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6041493617910405; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6345071314100089 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.631762024894318; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6033202716904071; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.633789847531823 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6316547217993571; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6010380866803149; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.632055500145644 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6307189719076896; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.601756142523213; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6319319857917322 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.633616026810849 at iter 0
0.618096962884966 at iter 0
0.6353782935874437 at iter 0
last anomaly aucs:
0.6296178929068795
0.5975708071765957
0.6297192776057154




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.6640830039978 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.629588815569396,first_prior_anomaly_auc= 0.601937168248165, first_prior_star_anomaly_auc= 0.6297176050155061


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6295879149438988 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6061854187188062 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6301087338028938 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.629588043604684 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6114059587441472 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6304669254292381 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6295879149438988 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6199823580331162 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6313829902207511 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6295879149438988 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.6175451367767076 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6311212941834002 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6295881722654695 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.6090930238063624 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6300374557278239 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6295879149438988 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.6095827067553088 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6302759928238161 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6295874003007574 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.6071741768540277 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6300365551023265 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6295890728909668 at iter 36
max_prior_anomaly= 0.632318868773204 at iter 26
max_prior_star_anomaly= 0.631564015945703 at iter 29
last values
accuracies_anomaly['vanilla_star'][-1]= 0.629587657622328
accuracies_anomaly['prior'][-1]= 0.6112766546548958
accuracies_anomaly['prior_star'][-1]= 0.6311259259716719



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.94192600250244 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6295881722654694
 first_prior_anomaly_auc= 0.6085345073372673
 first_prior_star_anomaly_auc= 0.6304826220450477


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6276280252010453; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6030888109376078; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6287576668961976 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6195253549236424; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6042634839076235; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6261158749911224 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5976245873848615; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5974816452523656; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6142960659648993 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5337559582809683; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5976871165265294; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.588057500048891 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6297932575572772 at iter 10
0.6085345073372673 at iter 0
0.6306671216112035 at iter 10
last anomaly aucs:
0.46226919541720574
0.598414564606756
0.5250008491611832




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.62935376167297 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4571859364498063,first_prior_anomaly_auc= 0.5961496201418974, first_prior_star_anomaly_auc= 0.5131092474167487


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45718760904001554 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5983894757536177 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47172524849544073 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.45718735171844493 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6176525685324539 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48837498340275876 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45718645109294764 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6141840024208813 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5097873546004466 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4571860651105917 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5928309438452284 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5161455132896298 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.45718786636158615 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6027496611074915 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5044748221135982 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.45718786636158615 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.5972692262957944 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5212673704926266 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.45718748037923024 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.6037696838135468 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5217430294159726 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4571894102910101 at iter 56
max_prior_anomaly= 0.6235381561571391 at iter 23
max_prior_star_anomaly= 0.5238658037130473 at iter 39
last values
accuracies_anomaly['vanilla_star'][-1]= 0.457186579753733
accuracies_anomaly['prior'][-1]= 0.5950145746937616
accuracies_anomaly['prior_star'][-1]= 0.49893777655635807



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.75998830795288 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4033525912796807
accuracies_anomaly["prior"][-1]= 0.4850206680685546
accuracies_anomaly["prior_star"][-1]= 0.40335310592282203


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 1483.705558538437 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004570722579956055 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4041320183171787
 first_prior_anomaly_auc= 0.4804689068053321
 first_prior_star_anomaly_auc= 0.4041302170661842


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4930512883061756; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5900970308178606; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.49312308102438684 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.572923003210344; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5887783864290662; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 110 
last prior star auc 0.5729886202108596 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5502206789789892; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.589922952775316; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 110 
last prior star auc 0.5502802489225946 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5515997939368862; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.594347339861067; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 400 
last prior star auc 0.5516773763904371 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5754132327103063 at iter 180
0.5965057531956767 at iter 490
0.5754933883795637 at iter 180
last anomaly aucs:
0.5743643899883382
0.5965057531956767
0.5744269191300061




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.43657422065735 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5767595391679456,first_prior_anomaly_auc= 0.5964649677267286, first_prior_star_anomaly_auc= 0.5768224542919694


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5767596678287309 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5925738795961492 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5768013539231761 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5767596678287309 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4791209277574837 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.576768030779777 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5767596678287308 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.3870311986965118 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5767134786067993 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5767597964895161 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.38276673696691976 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.57662071418058 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5767597964895161 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.39555047259679665 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5767893884701409 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5767594105071603 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4112015424884231 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5770150594876007 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5767595391679456 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5344203625763858 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5774330783791212 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5767601824718722 at iter 19
max_prior_anomaly= 0.5964649677267286 at iter 0
max_prior_star_anomaly= 0.5779765415363334 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5767596678287309
accuracies_anomaly['prior'][-1]= 0.5731575518219911
accuracies_anomaly['prior_star'][-1]= 0.5779765415363334



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.70279359817505 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5767599251503015
 first_prior_anomaly_auc= 0.5738258159409684
 first_prior_star_anomaly_auc= 0.5780133385209362


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6038206334845355; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5699205751240033; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6052265098857801 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6110459658668083; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5640572458151794; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6117593899214345 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6153400195770251; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5567612786617632; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6158577505771723 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.619616704081223; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5500671866620966; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6198071220435039 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6237323052821944 at iter 490
0.5738258159409684 at iter 0
0.6242308658253279 at iter 490
last anomaly aucs:
0.6237323052821944
0.5452995326010991
0.6242308658253279




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.58561515808105 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6238195372946445,first_prior_anomaly_auc= 0.5449625700043332, first_prior_star_anomaly_auc= 0.6243273614143217


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6238195372946445 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5673023281426426 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6242245614468471 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6238195372946446 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5808461916922186 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6241845479426111 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6238195372946446 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.5887237055953032 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6241356568441876 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6238195372946446 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.5913311450706965 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6240812333319953 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6238194086338592 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.594225755418935 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.624054986531789 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6238195372946445 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.5965183619526384 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6240126571334171 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6238195372946446 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.5984723332993669 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6240165169569768 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6238196659554299 at iter 23
max_prior_anomaly= 0.5998311198531826 at iter 79
max_prior_star_anomaly= 0.6243273614143217 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6238195372946445
accuracies_anomaly['prior'][-1]= 0.5998311198531826
accuracies_anomaly['prior_star'][-1]= 0.6241136558498971



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.90231800079346 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6238195372946445
 first_prior_anomaly_auc= 0.5999776644876677
 first_prior_star_anomaly_auc= 0.6241182876381688


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6290122865903554; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5999902732446294; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.6290526860769474 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6338271591595672; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5989679346444382; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.6337512492962255 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6367324483529876; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5974698084601157; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.6364304814898302 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6377460380197768; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5965222217761982; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.6376685842270112 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6384171326760311 at iter 490
0.6003958120399734 at iter 10
0.6383710721148848 at iter 490
last anomaly aucs:
0.6384171326760311
0.5954831572739147
0.6383710721148848




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.59607934951782 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6384876387863891,first_prior_anomaly_auc= 0.5953093365529409, first_prior_star_anomaly_auc= 0.6384167466936752


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6384824923549761 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5929141873733333 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6385226345199975 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.638483264319688 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5938607447709683 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6384134015132568 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6384886680726718 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5986884834187126 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.638343024063684 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6384855802138238 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5969884884622154 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6381879878173675 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6384961303982206 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5988903521908874 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6380938081225097 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6384980603100004 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.5995528265745249 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6381156804560151 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6384958730766499 iter_best_vanilla_star_anomaly= 620 
last prior auc 0.6011091074338143 iter_best_prior_anomaly= 630
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6381807828133894 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6384988322747124 at iter 62
max_prior_anomaly= 0.6086746189324861 at iter 63
max_prior_star_anomaly= 0.6386393298522871 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6384837789628295
accuracies_anomaly['prior'][-1]= 0.6011381847712978
accuracies_anomaly['prior_star'][-1]= 0.6380790121321975



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.87742495536804 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6384895686981691
 first_prior_anomaly_auc= 0.6006198104672239
 first_prior_star_anomaly_auc= 0.6380335948749777


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6394201721584236; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5838057757370462; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.639146253346467 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.640652871142621; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5859383282538055; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.6405509718006437 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6413948578915893; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5741699835417124; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.6405718148478663 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6414990731277025; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.574426919130006; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.6409186843251022 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6420515425398874 at iter 460
0.6087570904958792 at iter 10
0.6417740212259417 at iter 220
last anomaly aucs:
0.6419737027647658
0.5698254948036482
0.6412721155023895




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.61633610725403 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6417360662942708,first_prior_anomaly_auc= 0.5609669424124618, first_prior_star_anomaly_auc= 0.6403781803659524


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6417355516511296 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.59385546967877 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6417984667751535 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6417316918275697 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.594079596766806 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6417812262299198 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6417360662942708 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.594407167126243 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6417700327415966 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6417292472726486 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5962398113524101 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6416939942174696 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.641732592453067 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5959642199502443 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6413379898244758 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.641738124866836 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5957770185075967 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.641254102992444 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6417328497746377 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5961135951220065 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.641227598870667 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6417406980825425 at iter 7
max_prior_anomaly= 0.5965864235080752 at iter 79
max_prior_star_anomaly= 0.64199120063157 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6417386395099773
accuracies_anomaly['prior'][-1]= 0.5965864235080752
accuracies_anomaly['prior_star'][-1]= 0.6413049240026474



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.75363898277283 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6417378675452654
 first_prior_anomaly_auc= 0.5966120270043549
 first_prior_star_anomaly_auc= 0.641310713737987


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6419109163015273; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5949791929777972; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6402542800296847 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6418505743932101; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5919051008340307; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6396059583324327 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6418482584990742; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5913829953671824; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6394799994235997 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6416372548111414; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5885781902471008; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6391970743566703 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6419780772314669 at iter 110
0.5966120270043549 at iter 0
0.641310713737987 at iter 0
last anomaly aucs:
0.6412101010038629
0.5890937340138974
0.6390272421200416




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.6005539894104 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6411057571069645,first_prior_anomaly_auc= 0.5908342571177719, first_prior_star_anomaly_auc= 0.6388714339090131


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6411020259441901 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5892422085601623 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6407605602199379 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6411026692481168 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5903378838079888 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6407753562102503 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6411066577324616 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5902915659252717 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6406006348637792 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6411053711246086 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.6001258817123619 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6402060322351878 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.641102797908902 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.6021018540533809 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6404903725707558 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6410973941559184 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.5925915061237388 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6395924489499736 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6411048564814673 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.5926660007184418 iter_best_prior_anomaly= 610
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6396183097678239 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6411147633619373 at iter 36
max_prior_anomaly= 0.6042026273561649 at iter 61
max_prior_star_anomaly= 0.6409854592726858 at iter 61
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6411022832657607
accuracies_anomaly['prior'][-1]= 0.5965087123937391
accuracies_anomaly['prior_star'][-1]= 0.6396777510506441



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.92799043655396 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6411033125520432
 first_prior_anomaly_auc= 0.5957521869760289
 first_prior_star_anomaly_auc= 0.6396075022618566


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6410261160808484; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5518854208803073; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6380144244179643 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6402110500058155; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5602847829286695; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6388188116478153 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6393679358795817; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5650139674148549; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6381232714423491 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6385097684414649; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5636264895059117; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6368340903733942 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.641279835149509 at iter 40
0.5957521869760289 at iter 0
0.6396075022618566 at iter 0
last anomaly aucs:
0.6382884718907063
0.5663546127979397
0.6367168803979633




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.58150434494019 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6385297108631904,first_prior_anomaly_auc= 0.5824854587580425, first_prior_star_anomaly_auc= 0.6388601117599046


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6385263656827718 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5933645001219704 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6385410330122989 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6385267516651278 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5971231963044507 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6385488813202038 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6385239211278507 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5998100194843893 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6387515220570904 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6385257223788452 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.6005318064900618 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6388747790894316 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6385272663082691 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5963586939180503 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6385253363964893 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6385252077357039 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5940327642409478 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.638444022780164 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6385259797004159 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.5935360049488084 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6383567907677137 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6385321554181116 at iter 64
max_prior_anomaly= 0.6017049355306536 at iter 34
max_prior_star_anomaly= 0.6389829828098899 at iter 37
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6385275236298399
accuracies_anomaly['prior'][-1]= 0.5927861698919352
accuracies_anomaly['prior_star'][-1]= 0.6383210230693934



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.72178554534912 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6385272663082692
 first_prior_anomaly_auc= 0.592679124118545
 first_prior_star_anomaly_auc= 0.6383145900301271


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6387130524822783; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5895389003311213; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6381443718111424 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6392633346611126; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.587659809561452; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.638278822331807 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6389572506528248; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 230 
last prior auc 0.5886970728127409; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6382646696454212 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6381091187559634; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 230 
last prior auc 0.590050455613573; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6384234370545121 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6394636595038634 at iter 230
0.592679124118545 at iter 0
0.6389115760740345 at iter 370
last anomaly aucs:
0.6370628492497018
0.5876145209650177
0.6371697663623067




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.76481866836548 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6367233134372294,first_prior_anomaly_auc= 0.5845523942742863, first_prior_star_anomaly_auc= 0.6361618377700717


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6367203542391671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5816220162277275 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6365649320104946 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6367182956666019 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5845118661269089 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6362220510176039 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6367172663803192 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5862750335290006 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.635723876456826 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6367099327155556 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5935071849328957 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6356020346931235 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.636723956741156 iter_best_vanilla_star_anomaly= 500 
last prior auc 0.5931299515103232 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6351160829069514 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6367198395960257 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.5912040282147956 iter_best_prior_anomaly= 520
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6346588224759069 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6367202255783816 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.5904539358363518 iter_best_prior_anomaly= 640
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6345398112494814 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6367252433490094 at iter 58
max_prior_anomaly= 0.5974337834402248 at iter 64
max_prior_star_anomaly= 0.6372171135313063 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6367131492351888
accuracies_anomaly['prior'][-1]= 0.5701075192450803
accuracies_anomaly['prior_star'][-1]= 0.6354305298662855



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.17727565765381 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6367202255783817
 first_prior_anomaly_auc= 0.5708460321528449
 first_prior_star_anomaly_auc= 0.6353450991048297


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6332439398196896; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5695487454544145; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.632480852701928 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6281663419268445; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5691173458412202; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.6289002230463374 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6175659798239304; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5704807641833077; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.6204393611425901 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5943641944239444; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.571435427210418; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 330 
last prior star auc 0.6023075826491153 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6367202255783817 at iter 0
0.5725582498839479 at iter 430
0.6353450991048297 at iter 0
last anomaly aucs:
0.5236950708509213
0.5721666064534192
0.5441171399839637




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.77647542953491 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.514469063256847,first_prior_anomaly_auc= 0.5731148364412633, first_prior_star_anomaly_auc= 0.5370064443614153


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5144936374668441 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.570899941021896 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5358725568603474 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5144774262078933 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.58486079417671 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5462588274164811 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5144790987981024 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5902841035997228 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5508893290803225 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.514480514066741 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5918066753332571 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5519776706633854 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5144739523666895 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5932026448540318 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5511159007232795 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5144778121902492 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.594029290399744 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5510533715816116 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5144778121902491 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.593628126071101 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5517871240403192 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5144936374668441 at iter 10
max_prior_anomaly= 0.5954664313718225 at iter 57
max_prior_star_anomaly= 0.5526337120077567 at iter 48
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5144865611236512
accuracies_anomaly['prior'][-1]= 0.5926147937258827
accuracies_anomaly['prior_star'][-1]= 0.5508283438680784



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.78503942489624 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4041320183171787
accuracies_anomaly["prior"][-1]= 0.4804689068053321
accuracies_anomaly["prior_star"][-1]= 0.40413008840539877


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 1484.1642603874207 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004652738571166992 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.410839491038519
 first_prior_anomaly_auc= 0.5151667906956637
 first_prior_star_anomaly_auc= 0.41084052032480156


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5207756289711151; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.600628945382982; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.5208382867735684 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5819966764345934; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5979710708797413; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 60 
last prior star auc 0.5820671825449515 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5521804400610573; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5955521194548489; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 60 
last prior star auc 0.5522499168851327 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5662116706654439; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5948495029061899; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 60 
last prior star auc 0.5662621056932913 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6043750328085002 at iter 490
0.6018912363478041 at iter 60
0.6044288130167661 at iter 490
last anomaly aucs:
0.6043750328085002
0.5894138420477856
0.6044288130167661




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.72479295730591 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6056195685849476,first_prior_anomaly_auc= 0.5888494071825655, first_prior_star_anomaly_auc= 0.605668459683371


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6056198259065182 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5905056574720523 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6056582954813303 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6056196972457328 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5461124114427814 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6056353938615424 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6056196972457328 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4337202677791193 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6056065738456298 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6056196972457328 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.42105670132273576 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6055527936373639 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6056195685849475 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.44463572014529407 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.605711303724884 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6056195685849475 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.4709674364698775 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6059206348226077 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6056198259065182 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.6046050782926611 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6063561515809323 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6056202118888742 at iter 42
max_prior_anomaly= 0.6080044249017289 at iter 72
max_prior_star_anomaly= 0.6066497554930436 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6056198259065182
accuracies_anomaly['prior'][-1]= 0.607834978647456
accuracies_anomaly['prior_star'][-1]= 0.6066497554930436



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.45559072494507 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6056198259065182
 first_prior_anomaly_auc= 0.6078632840202275
 first_prior_star_anomaly_auc= 0.6066723997912608


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6113497339809603; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.617422523048293; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6122079014190771 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6158706166557046; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6119074784853435; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 100 
last prior star auc 0.6166641963795884 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6213897783637847; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.607688434012971; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 100 
last prior star auc 0.6221038457223378 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6252184660134816; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6025131825840644; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 100 
last prior star auc 0.6257221729880285 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6285686642025553 at iter 490
0.617422523048293 at iter 100
0.6287198406253119 at iter 490
last anomaly aucs:
0.6285686642025553
0.5959142995655382
0.6287198406253119




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.84731769561768 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6289035682267559,first_prior_anomaly_auc= 0.5952224905228466, first_prior_star_anomaly_auc= 0.629185206685832


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6289038255483266 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6195950890692885 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6295292456257906 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6289035682267559 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6187914738041495 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.62972107885671 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6289040828698971 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6160654090846865 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6300994702263504 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6289039542091119 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6132968863060666 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6301969951016266 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6289036968875412 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6118951270499522 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6303225680281036 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6289038255483266 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6099648292877237 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6304024663757903 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6289031822443999 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6092947639177518 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6303989925345865 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6289043401914678 at iter 8
max_prior_anomaly= 0.619700204930899 at iter 9
max_prior_star_anomaly= 0.6306061363989596 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6289030535836146
accuracies_anomaly['prior'][-1]= 0.6084108643225701
accuracies_anomaly['prior_star'][-1]= 0.6306061363989596



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.97741961479187 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6289039542091119
 first_prior_anomaly_auc= 0.6095179903802904
 first_prior_star_anomaly_auc= 0.6303687572500353


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6321257489344313; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5976783675931272; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6320502250534457 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6338920041953708; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5965552875980267; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6338617689108195 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6352973659534742; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5957372623249313; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6356044792480446 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6366045595323747; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5952145135541564; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6367755497160713 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6374961787746758 at iter 490
0.6095179903802904 at iter 0
0.6375538188065013 at iter 490
last anomaly aucs:
0.6374961787746758
0.5941066155317242
0.6375538188065013




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.87358069419861 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6374425272271954,first_prior_anomaly_auc= 0.5943796337181836, first_prior_star_anomaly_auc= 0.6377807764318144


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6374333923114374 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6053604457633032 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6377150307705134 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.637433263650652 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5989697358954328 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.637519981019961 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.637449474909603 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5996756976245101 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6374453577644725 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6374444571389752 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5987330000504351 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6374497322311736 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6374376381173531 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.596580376451165 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6373573537873103 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6374367374918558 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5962628416329833 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.637348476193123 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6374364801702852 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5889432008950674 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6370972016793834 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6374553933057279 at iter 15
max_prior_anomaly= 0.6167583760744462 at iter 9
max_prior_star_anomaly= 0.6378113976987216 at iter 9
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6374439424958339
accuracies_anomaly['prior'][-1]= 0.5979018513772365
accuracies_anomaly['prior_star'][-1]= 0.6373568391441691



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.3501615524292 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6374512761605974
 first_prior_anomaly_auc= 0.5972090130482622
 first_prior_star_anomaly_auc= 0.6373340661851665


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6371665498426736; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5572878872560978; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6361070282755235 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6376265121502099; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5598102819523914; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.636088243800866 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.637660607258321; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5604840784851376; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6362138167273431 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6374614403626382; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.5528660733860533; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6347446392197187 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6378373871773573 at iter 360
0.5972090130482622 at iter 0
0.6373340661851665 at iter 0
last anomaly aucs:
0.6370825343498565
0.55722535811443
0.6346604950661162




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.8601586818695 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6370804757772913,first_prior_anomaly_auc= 0.5618666672842384, first_prior_star_anomaly_auc= 0.6349546136213688


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6370737854164544 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5985268854723447 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.637146478760163 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6370806044380766 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5890963072296039 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.636792018296593 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6370824056890712 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5847309754443172 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363644785069584 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6370852362263483 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5839875734267103 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6361973481468215 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6370722414870305 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5840088024562888 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6361229822129038 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6370840782792804 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5841207373395214 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.636044627794641 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6370885814067667 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5849072407202122 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6360998232715451 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6370923125695411 at iter 46
max_prior_anomaly= 0.5987804758802199 at iter 11
max_prior_star_anomaly= 0.6371588301955541 at iter 12
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6370817623851446
accuracies_anomaly['prior'][-1]= 0.5838922357847844
accuracies_anomaly['prior_star'][-1]= 0.6360178663512934



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.05088305473328 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6370840782792804
 first_prior_anomaly_auc= 0.583737199538468
 first_prior_star_anomaly_auc= 0.6360141351885189


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.637874827465887; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5728765566668417; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.638176279685903 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6373474469068403; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5730460029211144; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.6375751764968653 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6364005035268494; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5686514651375589; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.6365757395164618 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6353200102516914; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5598384586643775; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.6348717560756196 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6389263720643469 at iter 20
0.5977387095014446 at iter 10
0.640157398458335 at iter 10
last anomaly aucs:
0.634524114633672
0.5732958621662153
0.6353290165066641




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.85422253608704 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6344067759974555,first_prior_anomaly_auc= 0.5759174543279945, first_prior_star_anomaly_auc= 0.6353138345339958


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6344063900150997 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6023291976610499 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.634814116043794 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6344036881386077 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5837011745185771 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6348316139105983 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6344062613543142 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5940368813860781 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6346682147132358 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6344056180503876 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5980563729804117 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6345957786910978 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6344003429581893 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6007470559839101 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6345616835829867 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6344027875131106 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6023178755119412 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6344883469353515 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6344025301915399 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6037267111112483 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6344534798625285 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6344085772484502 at iter 78
max_prior_anomaly= 0.6044900555505807 at iter 78
max_prior_star_anomaly= 0.6353138345339958 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6344035594778226
accuracies_anomaly['prior'][-1]= 0.6044823359034611
accuracies_anomaly['prior_star'][-1]= 0.6343985417071948



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.70311427116394 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6344036881386077
 first_prior_anomaly_auc= 0.6048452879788626
 first_prior_star_anomaly_auc= 0.6344004716189746


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6322378124784493; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5845098075543438; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6324632261743384 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6313392455537405; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5770343586053994; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6310267285061866 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6297470683353457; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5828096839370611; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6304998625902812 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6289455116427718; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5853207564842462; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6308994829895003 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6344036881386077 at iter 0
0.6048452879788626 at iter 0
0.6344004716189746 at iter 0
last anomaly aucs:
0.6272520783863261
0.5866234469356604
0.6291291105834304




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.83272981643677 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6273004548416083,first_prior_anomaly_auc= 0.5921283272965692, first_prior_star_anomaly_auc= 0.6298074102436629


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6272996828768964 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5982985125783931 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6283711698970816 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6273012268063203 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6021175506691905 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6286558962150055 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6272998115376817 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5915948996806125 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.627109007593045 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6273009694847496 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5868460300942723 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6264300646288857 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.627299940198467 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5834210799889248 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6261078980224322 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6272996828768964 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.5819356912223496 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6258774665559155 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6273013554671056 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.5827537164954449 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6259995656411887 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6273025134141734 at iter 56
max_prior_anomaly= 0.6129514320974693 at iter 3
max_prior_star_anomaly= 0.6298074102436629 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6273000688592523
accuracies_anomaly['prior'][-1]= 0.5819718449030258
accuracies_anomaly['prior_star'][-1]= 0.6258849288814643



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.79724025726318 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6273000688592524
 first_prior_anomaly_auc= 0.5818453713510514
 first_prior_star_anomaly_auc= 0.6258482605576468


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6307341538803578; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5936665956459131; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.6343667624932197 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6301392264090158; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.584924995908587; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.632494748066743 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6294607980879978; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5865835620922095; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.632636532252171 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6291862359721145; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.585264017077918; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.6334927697785079 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6322079631762538 at iter 20
0.5969121926165177 at iter 10
0.6352067887606055 at iter 480
last anomaly aucs:
0.6298431779419833
0.5870065987543578
0.6350682210948106




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.81956219673157 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6304128878994016,first_prior_anomaly_auc= 0.5921092855003411, first_prior_star_anomaly_auc= 0.6355912271871562


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6304141745072549 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5858185450626681 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6322194139861479 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6304135312033283 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5966147288808468 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.633185913805508 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.630413402542543 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6021088017357883 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329386277761138 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6304130165601871 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6030817345944148 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6326806629015375 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6304128878994016 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6061827168423144 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6334391182310274 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.630412630577831 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.608306263104101 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6338061874515593 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6304123732562603 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.6087819220274469 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6340166764963506 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6304158470974641 at iter 56
max_prior_anomaly= 0.6181122735184197 at iter 4
max_prior_star_anomaly= 0.6355912271871562 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6304139171856843
accuracies_anomaly['prior'][-1]= 0.608881376814503
accuracies_anomaly['prior_star'][-1]= 0.6339698439704924



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.53812289237976 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.630413016560187
 first_prior_anomaly_auc= 0.6096815182384383
 first_prior_star_anomaly_auc= 0.633875406954064


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40483772272468543; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5627903230620854; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4047263024845942 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40463559663094006; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5566910298729757; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4046566969997334 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40457332481084296; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5603209366093457; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4046657032547062 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4043786610426464; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5564640722476627; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4041963487098411 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.630413016560187 at iter 0
0.6096815182384383 at iter 0
0.633875406954064 at iter 0
last anomaly aucs:
0.4042041970177459
0.5496734846590026
0.40404568693022574




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.79477405548096 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40401416503782117,first_prior_anomaly_auc= 0.5500463436148739, first_prior_star_anomaly_auc= 0.4039596128648434


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40401416503782117 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6094725731230708 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40401274976918256 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40401416503782117 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.595373538284818 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40397453751594103 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40401416503782117 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5924888348170495 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40397814001793014 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40401416503782117 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5922861940801629 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40397119233552264 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40401416503782117 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5903885761574067 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40397080635316673 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40401416503782117 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5916210178200334 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4039791693042128 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40401416503782117 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5929396622088278 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40399628118866093 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.40401416503782117 at iter 0
max_prior_anomaly= 0.6168673517596164 at iter 5
max_prior_star_anomaly= 0.4040182821829515 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40401416503782117
accuracies_anomaly['prior'][-1]= 0.5939140103360929
accuracies_anomaly['prior_star'][-1]= 0.4039974391357289



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.05325269699097 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.41083936237773366
accuracies_anomaly["prior"][-1]= 0.5151667906956637
accuracies_anomaly["prior_star"][-1]= 0.41084052032480156


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 1486.891923904419 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004938840866088867 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4030876787226969
 first_prior_anomaly_auc= 0.4953144315200396
 first_prior_star_anomaly_auc= 0.4030897372952621


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4972705901001187; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5936350737535085; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.49736026666749006 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5776367484022904; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5951429781575158; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5777118863009201 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5518863215058047; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5960721663491318; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5519480786827606 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5605953700644436; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5963244701491539; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 380 
last prior star auc 0.560674367786633 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5865881938804813 at iter 490
0.5964366623539571 at iter 380
0.5866816016106272 at iter 490
last anomaly aucs:
0.5865881938804813
0.5945807305256462
0.5866816016106272




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.6676185131073 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5899565332402859,first_prior_anomaly_auc= 0.5944278815126803, first_prior_star_anomaly_auc= 0.5900490403449344


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5899565332402859 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5949656835953382 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5900459524860866 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5899564045795005 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5955501895430689 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5900442798958774 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5899567905618563 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.5964438673579353 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5900417066801709 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5899562759187152 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.5974187301283418 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5900402914115324 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5899565332402859 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.5985643257608741 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5900368175703286 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5899565332402859 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.6003873204281419 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5900334723899101 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5899565332402859 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.602917048789199 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5900316711389155 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5899567905618566 at iter 24
max_prior_anomaly= 0.6054391861639221 at iter 79
max_prior_star_anomaly= 0.5900490403449344 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5899567905618565
accuracies_anomaly['prior'][-1]= 0.6054391861639221
accuracies_anomaly['prior_star'][-1]= 0.5900270393506438



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.32867097854614 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5899565332402859
 first_prior_anomaly_auc= 0.6057505452644082
 first_prior_star_anomaly_auc= 0.5900272966722144


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6067789309215097; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5958441794375361; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6068328397905609 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6095816774690261; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5910425589292129; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6096092108770857 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6123907283950236; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5859070636829715; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6124252094854907 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6151335190165788; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5811026126373711; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6151624676932768 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6202956470453823 at iter 490
0.6057505452644082 at iter 0
0.6203185486651701 at iter 490
last anomaly aucs:
0.6202956470453823
0.5758385852665902
0.6203185486651701




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.79525351524353 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6206000584634609,first_prior_anomaly_auc= 0.5752295051088624, first_prior_star_anomaly_auc= 0.6206152404361291


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6205998011418902 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5729531098341099 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6206147257929878 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6205998011418902 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5703421965175128 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6206140824890612 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6205998011418903 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5674864417264425 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6206143398106319 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6205998011418902 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.5631388651295306 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6206163983831972 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6205998011418902 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.5588351618604144 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6206152404361291 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6205998011418902 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.5510797470426032 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6206151117753438 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6206000584634608 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.5380338007322343 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6206140824890612 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6206003157850315 at iter 31
max_prior_anomaly= 0.5752295051088624 at iter 0
max_prior_star_anomaly= 0.620617556330265 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6206000584634608
accuracies_anomaly['prior'][-1]= 0.5259522956686604
accuracies_anomaly['prior_star'][-1]= 0.620617556330265



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.85205912590027 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6206000584634609
 first_prior_anomaly_auc= 0.525070068663688
 first_prior_star_anomaly_auc= 0.6206169130263384


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6249222888856638; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5231687195781574; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6249498222937233 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6301384544443038; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5214804327531247; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6301635432974422 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6334025785679952; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5180155978043265; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6334196904524433 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6346684720348064; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5184408216998251; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6346800515054856 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6358215299928877 at iter 490
0.525070068663688 at iter 0
0.6358333667851376 at iter 490
last anomaly aucs:
0.6358215299928877
0.5183273428871686
0.6358333667851376




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.82148599624634 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6359550798880549,first_prior_anomaly_auc= 0.518327471547954, first_prior_star_anomaly_auc= 0.6359791394549106


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6359548225664842 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5085204318473527 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6359779815078427 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6359548225664842 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4903585467301119 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.635977338203916 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6359553372096254 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.47480011260391936 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6359770808823454 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6359548225664842 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.46286914065917556 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6359750223097802 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6359550798880549 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4548299001489377 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6359746363274241 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6359549512272695 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4446758623103154 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6359730923980004 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.635954307923343 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.43757777544472887 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6359732210587856 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6359553372096255 at iter 19
max_prior_anomaly= 0.518327471547954 at iter 0
max_prior_star_anomaly= 0.6359799114196225 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6359552085488401
accuracies_anomaly['prior'][-1]= 0.4311480813589049
accuracies_anomaly['prior_star'][-1]= 0.6359752796313508



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.99328780174255 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.63595520854884
 first_prior_anomaly_auc= 0.43028541079330174
 first_prior_star_anomaly_auc= 0.6359756656137068


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6373343235067372; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4314212282061496; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6373349668106638 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6386278790423932; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.431996470577337; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 200 
last prior star auc 0.6386390725307165 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6396445565680302; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.43207726955052106; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 230 
last prior star auc 0.6396677155093886 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6401566264936231; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.43096486840060233; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 230 
last prior star auc 0.6401869904389598 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6404299020016531 at iter 460
0.43216861870810164 at iter 230
0.6404475285292426 at iter 480
last anomaly aucs:
0.6403758644718166
0.42967105554337565
0.6403958068935419




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.76768183708191 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6403632557148548,first_prior_anomaly_auc= 0.4295238676049641, first_prior_star_anomaly_auc= 0.6403695600933357


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6403636416972107 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4276802872120443 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.640364156340352 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6403632557148549 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.42147098905148184 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403620977677869 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6403637703579961 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.42429818114821 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403654429482053 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6403641563403522 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.42247582978486886 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403646709834934 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6403629983932841 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4212747813538614 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403662149129172 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6403677588423412 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.4188401333131593 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403684021462678 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6403640276795668 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.41877387300871705 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.640374449203178 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6403677588423412 at iter 60
max_prior_anomaly= 0.43030599651895385 at iter 5
max_prior_star_anomaly= 0.6403821688502975 at iter 77
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6403642850011374
accuracies_anomaly['prior'][-1]= 0.41781522149726164
accuracies_anomaly['prior_star'][-1]= 0.6403783090267379



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.79354333877563 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6403642850011373
 first_prior_anomaly_auc= 0.41781419221097893
 first_prior_star_anomaly_auc= 0.6403779230443818


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6402014004469161; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.418819804909078; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6402765383455458 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6402550519943966; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4192652285478726; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 200 
last prior star auc 0.6402607130689508 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6394985265766865; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42046125920825245; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 300 
last prior star auc 0.6396424979954649 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6386619741505043; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42114895110581374; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 380 
last prior star auc 0.6386774134447433 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.640541965545671 at iter 20
0.4213728208722789 at iter 490
0.6405873828028906 at iter 20
last anomaly aucs:
0.6376405361758103
0.4213728208722789
0.6376663969936607




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.76002240180969 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6375587079163437,first_prior_anomaly_auc= 0.4216264112801542, first_prior_star_anomaly_auc= 0.6375799369459223


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6375587079163437 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4211875493414111 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6375783930164984 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6375585792555584 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4211260494860259 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6375740185497973 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6375588365771291 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.42104164801085286 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6375711880125202 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6375589652379144 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4213355092445347 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6375769777478598 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6375583219339878 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.42178569333238636 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6375807089106342 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6375589652379143 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.42305441733647475 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6375791649812104 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6375579359516318 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4231105134388763 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6375826388224142 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6375608951496943 at iter 25
max_prior_anomaly= 0.4231321284508109 at iter 71
max_prior_star_anomaly= 0.6375886858793244 at iter 77
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6375601231849823
accuracies_anomaly['prior'][-1]= 0.4226483638979895
accuracies_anomaly['prior_star'][-1]= 0.6375866273067592



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.04317235946655 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6375585792555585
 first_prior_anomaly_auc= 0.42255611411491156
 first_prior_star_anomaly_auc= 0.6375855980204765


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6366035302460921; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.422065916522824; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6366322216012195 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6357463920942579; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42258982324066674; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 140 
last prior star auc 0.6357595154943612 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6348103848810196; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42395684408474327; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 300 
last prior star auc 0.6348649370539974 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6339730604901256; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42570444353181064; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 400 
last prior star auc 0.6339767916529 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6375585792555585 at iter 0
0.42705988490520796 at iter 480
0.6375855980204765 at iter 0
last anomaly aucs:
0.6331223553775576
0.4269976130851107
0.6332285005254507




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.70108246803284 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6330495333730638,first_prior_anomaly_auc= 0.4269480786827606, first_prior_star_anomaly_auc= 0.6330802833007565


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6330492760514932 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.42682945343869105 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6330946933087127 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6330505626593463 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4269467920749073 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6331031849205442 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6330510773024877 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4272189096358694 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6331266011834733 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6330479894436399 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4277658466342853 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6331359934208021 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6330494047122784 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.42861269192329343 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6331582517366633 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6330496620338492 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.42860806013502173 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6331852705015815 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6330477321220692 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.42872900127322705 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6332113886410025 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6330524925711263 at iter 64
max_prior_anomaly= 0.4289509411279125 at iter 78
max_prior_star_anomaly= 0.6332407233000565 at iter 77
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6330483754259959
accuracies_anomaly['prior'][-1]= 0.42893704576309744
accuracies_anomaly['prior_star'][-1]= 0.6332359628509996



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.16338086128235 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6330499193554198
 first_prior_anomaly_auc= 0.428892529131375
 first_prior_star_anomaly_auc= 0.6332384074059206


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6318951888071292; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42916451803155176; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 50 
last prior star auc 0.6323053593907448 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6312140586096195; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4304461081141726; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 200 
last prior star auc 0.6313757852167728 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6301140088950921; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.430530638250131; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 240 
last prior star auc 0.6302774080924546 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6289214520759161; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4306598136785972; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 240 
last prior star auc 0.6291970434780819 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6330499193554198 at iter 0
0.4313521373644302 at iter 490
0.6332384074059206 at iter 0
last anomaly aucs:
0.627895639634521
0.4313521373644302
0.628168529160195




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.80821752548218 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6278207590574619,first_prior_anomaly_auc= 0.43145776786918183, first_prior_star_anomaly_auc= 0.6280457867709951


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6278190864672527 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.43185442907033833 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6280192826492181 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.627820373075106 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4329006985766 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6280070598746124 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.627819215128038 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.43359443753107163 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6280007554961314 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.627819601110394 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4337483158303201 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6279988255843516 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6278192151280381 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.43333441408393003 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.627997796298069 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6278210163790325 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4327012743593465 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6280008841569168 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6278189578064673 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4320426597992686 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6280565942769624 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6278211450398179 at iter 12
max_prior_anomaly= 0.4337483158303201 at iter 40
max_prior_star_anomaly= 0.6282521586706562 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6278187004848967
accuracies_anomaly['prior'][-1]= 0.43172306640852165
accuracies_anomaly['prior_star'][-1]= 0.6282521586706562



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.09784579277039 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.62781998709275
 first_prior_anomaly_auc= 0.4316947610357502
 first_prior_star_anomaly_auc= 0.6282531879569387


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6264856460881459; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43345651316920336; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6264437026721301 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6242679201315016; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43700652155788655; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6245446694807354 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6225631647259474; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43930298791514977; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6226208047577729 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6207343803233399; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4415431008484407; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.620719327011457 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.62781998709275 at iter 0
0.4436820864044663 at iter 490
0.6282531879569387 at iter 0
last anomaly aucs:
0.6190844344123341
0.4436820864044663
0.6193354516045029




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.76924562454224 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6188169486396438,first_prior_anomaly_auc= 0.44382284130361166, first_prior_star_anomaly_auc= 0.6191835032170342


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6188159193533611 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44090545799637076 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6190195893765305 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6188161766749318 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4407681769384292 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6189743007800961 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6188159193533611 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4420625044387971 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6189568029132919 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6188150187278639 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.44257521766831665 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6189579608603598 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6188145040847226 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.443458602620357 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6189530717505174 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6188155333710053 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4437559376952427 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6189463813896805 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6188160480141465 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4444410563770975 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6189601480937104 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6188170773004291 at iter 33
max_prior_anomaly= 0.44693463105747844 at iter 79
max_prior_star_anomaly= 0.6191835032170342 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6188169486396438
accuracies_anomaly['prior'][-1]= 0.44693463105747844
accuracies_anomaly['prior_star'][-1]= 0.6189638792564848



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.3690733909607 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40308767872269685
accuracies_anomaly["prior"][-1]= 0.4953144315200396
accuracies_anomaly["prior_star"][-1]= 0.4030897372952621


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 1486.0942599773407 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.005063533782958984 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40843687953336283
 first_prior_anomaly_auc= 0.5007210150409604
 first_prior_star_anomaly_auc= 0.40843713685493344


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5098205490830603; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5977129773443797; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5098898972463504 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5816168697963146; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5971929304500967; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 150 
last prior star auc 0.5816741238457841 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5525626912542574; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5934940615327925; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 150 
last prior star auc 0.5526461921039332 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5612535986421655; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5923637765337137; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 150 
last prior star auc 0.5613385147604799 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.596761402176117 at iter 490
0.5982177136052089 at iter 150
0.5968796414378306 at iter 490
last anomaly aucs:
0.596761402176117
0.5918349807060286
0.5968796414378306




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.74027514457703 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5993854388928174,first_prior_anomaly_auc= 0.5914905557837139, first_prior_star_anomaly_auc= 0.5994444941932814


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5993850529104614 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5912660427133222 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5994401197265804 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5993851815712467 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5911362239809294 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.599441149012863 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.599384924249676 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5909117109105375 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5994385757971565 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.599385310232032 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5904871303189656 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5994401197265804 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.599385310232032 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.5901115694866023 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5994383184755858 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5993850529104614 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.5898406098727081 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.599436388563806 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5993851815712468 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.5900343730154073 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5994362599030206 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.5993855675536027 at iter 41
max_prior_anomaly= 0.5914905557837139 at iter 0
max_prior_star_anomaly= 0.5994450088364227 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5993850529104614
accuracies_anomaly['prior'][-1]= 0.5901688235360719
accuracies_anomaly['prior_star'][-1]= 0.5994329147226022



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.45294570922852 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5993850529104614
 first_prior_anomaly_auc= 0.5901618758536643
 first_prior_star_anomaly_auc= 0.5994321427578904


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6068338690768433; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5868551650100304; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6068625604319708 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6118215330807464; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5841343753827658; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6118616752457678 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6183438629320044; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5792022928381231; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6183596882085993 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6233620195420293; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5724993232442692; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6233840205363199 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6276546579836076 at iter 490
0.5901618758536643 at iter 0
0.6276868231799388 at iter 490
last anomaly aucs:
0.6276546579836076
0.5656779857279164
0.6276868231799388




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.7775182723999 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6280550503475385,first_prior_anomaly_auc= 0.5648503108959216, first_prior_star_anomaly_auc= 0.628092490636068


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6280550503475385 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5632626368050129 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6280900460811469 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6280549216867531 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5627276652596322 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.628086958222299 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6280549216867533 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5603614647567231 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6280854142928751 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6280553076691091 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.55738579811373 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6280838703634513 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6280553076691091 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5537121467103495 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.628082197773242 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6280550503475384 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5514217274099967 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6280823264340274 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6280549216867531 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5466937008708791 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6280809111653889 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6280555649906798 at iter 12
max_prior_anomaly= 0.5648503108959216 at iter 0
max_prior_star_anomaly= 0.628092490636068 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6280553076691091
accuracies_anomaly['prior'][-1]= 0.5409806473593146
accuracies_anomaly['prior_star'][-1]= 0.628078981253609



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.14428305625916 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6280550503475385
 first_prior_anomaly_auc= 0.5403444197758832
 first_prior_star_anomaly_auc= 0.6280787239320383


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6328170433339817; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5381986151982354; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6328252776242426 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6350175287453926; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5371367777369495; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6350300088415692 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6367592097963352; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5347228440826847; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6367541920257075 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6384844222667561; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5326273458720988; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6385024347767015 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6398477119480581 at iter 490
0.5403444197758832 at iter 0
0.6398478406088435 at iter 490
last anomaly aucs:
0.6398477119480581
0.5317211879610559
0.6398478406088435




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.73527574539185 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6399730275529645,first_prior_anomaly_auc= 0.5317138542962925, first_prior_star_anomaly_auc= 0.6399605474567881


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6399719982666819 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5259974556043094 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399633779940652 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6399723842490379 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5172217607588722 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399642786195625 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6399721269274672 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.5060712451379089 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399649219234891 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6399719982666819 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4914133078482049 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399658225489863 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6399721269274673 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4749206677597687 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399665945136983 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.639970840319614 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4546659863084339 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399686530862634 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6399719982666819 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4379261888513885 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399660798705571 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6399734135353206 at iter 28
max_prior_anomaly= 0.5317138542962925 at iter 0
max_prior_star_anomaly= 0.6399714836235406 at iter 64
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6399722555882525
accuracies_anomaly['prior'][-1]= 0.420780337955858
accuracies_anomaly['prior_star'][-1]= 0.6399665945136983



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 80.56336379051208 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6399723842490379
 first_prior_anomaly_auc= 0.41914403008809664
 first_prior_star_anomaly_auc= 0.6399665945136983


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6415596723575906; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42166681076674617; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6415601870007318 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6429699232255361; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.425198034680772; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6429540979489413 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6445078055925242; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4287800796050011; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6445031738042524 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6459889485531837; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4318441362075124; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6459495783528744 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6470774187970318 at iter 490
0.43441259146495237 at iter 490
0.6470910568402763 at iter 490
last anomaly aucs:
0.6470774187970318
0.43441259146495237
0.6470910568402763




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.23993945121765 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6471358307935694,first_prior_anomaly_auc= 0.43472793904978346, first_prior_star_anomaly_auc= 0.6471493401760285


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6471371174014227 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4144324721295007 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6471435504406888 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6471368600798519 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.39516410425846615 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6471432931191183 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6471390473132026 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.38605582128296423 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6471440650838303 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6471362167759254 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.37780647771029097 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.647141234546553 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6471364740974961 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.37778807921798946 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6471378893661346 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6471344155249308 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.38966990274273916 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6471381466877053 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.647137632044564 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.3991807653155226 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6471351874896428 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6471390473132026 at iter 30
max_prior_anomaly= 0.43472793904978346 at iter 0
max_prior_star_anomaly= 0.6471493401760285 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6471360881151401
accuracies_anomaly['prior'][-1]= 0.4029319991724538
accuracies_anomaly['prior_star'][-1]= 0.6471359594543546



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 82.57096982002258 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6471364740974961
 first_prior_anomaly_auc= 0.4032313928199048
 first_prior_star_anomaly_auc= 0.6471360881151401


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6481860887841762; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4022471378121697; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6481662750232361 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6485553452380585; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.40090288992709566; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6485426078203114 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6486271379562698; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.3996409849446296; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6486113126796749 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6485462103223004; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.39815919868004324; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6485334729045533 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.648663677619302 at iter 270
0.4032313928199048 at iter 0
0.648649782254487 at iter 270
last anomaly aucs:
0.6484618088471273
0.396929716215479
0.6484497147333068




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.58839464187622 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6484535745568665,first_prior_anomaly_auc= 0.39682267044208874, first_prior_star_anomaly_auc= 0.6484414804430461


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.648454217860793 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.402667472597826 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6484340181174972 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6484540892000078 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4070815668207508 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.64843118758022 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6484551184862904 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41200863159476586 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6484338894567119 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6484542178607932 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4157193373043198 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6484290003468695 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6484548611647197 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4185087031301625 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6484264271311629 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6484546038431491 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.42146159681415307 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6484273277566603 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6484544751823638 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4243218547327098 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6484291290076548 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6484555044686464 at iter 31
max_prior_anomaly= 0.425500644847856 at iter 79
max_prior_star_anomaly= 0.6484414804430461 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6484542178607933
accuracies_anomaly['prior'][-1]= 0.425500644847856
accuracies_anomaly['prior_star'][-1]= 0.6484305442762933



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 82.02419233322144 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6484543465215784
 first_prior_anomaly_auc= 0.42557243756606733
 first_prior_star_anomaly_auc= 0.6484278423998016


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6482352372041702; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4239091109333877; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6482213418393552 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6482006274529178; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4224241081491683; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.648179269762554 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6479678800922652; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42160042180151863; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6479520548156702 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6478213354577802; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42076451267926307; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6478215927793509 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6484543465215784 at iter 0
0.42557243756606733 at iter 0
0.6484283570429428 at iter 10
last anomaly aucs:
0.6474914492042073
0.42005288987563133
0.6476624393879041




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.61975169181824 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.647496080992479,first_prior_anomaly_auc= 0.42005880827175635, first_prior_star_anomaly_auc= 0.647734489427686


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6474959523316937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4224009492078098 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6477371913041778 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6474931217944165 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.42449065768305605 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6477429810395174 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6474932504552018 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.42689159659800296 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6477554611356939 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6474967242964056 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.429555132175798 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6477760468613458 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6474927358120606 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.43173811972040466 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6477918721379408 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6474955663493377 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.43317989248075495 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6478254526029106 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6474954376885524 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.43432317221915157 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6478549159227499 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6474969816179763 at iter 23
max_prior_anomaly= 0.4364881472538127 at iter 79
max_prior_star_anomaly= 0.6478910696034262 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6474928644728459
accuracies_anomaly['prior'][-1]= 0.4364881472538127
accuracies_anomaly['prior_star'][-1]= 0.6478910696034262



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 82.48137998580933 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6474928644728458
 first_prior_anomaly_auc= 0.4367103444300688
 first_prior_star_anomaly_auc= 0.6478962160348393


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6474460319469877; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.43808752947618596; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 80 
last prior star auc 0.6476464854505237 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6470816646029476; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.43887004437253163; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 190 
last prior star auc 0.6472841766790489 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6464667947098802; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4392651616442642; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 290 
last prior star auc 0.6466651896408512 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6461416689053643; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.43993406906716814; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 400 
last prior star auc 0.6464220207565872 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6475789385382282 at iter 40
0.44169504923590935 at iter 490
0.6478962160348393 at iter 0
last anomaly aucs:
0.6460270321456398
0.44169504923590935
0.6462169354647794




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.4534125328064 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6460038732042814,first_prior_anomaly_auc= 0.4418758176392907, first_prior_star_anomaly_auc= 0.6461798811586058


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6460046451689934 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.44277785840520334 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6461919752724263 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6460010426670043 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.44455466385053943 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6462341760100129 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6460034872219255 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4462971168661938 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6462897574692733 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6460012999885749 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4485022340658764 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6463693984953893 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6460054171337053 iter_best_vanilla_star_anomaly= 500 
last prior auc 0.4508038468545526 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6464269098664295 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6460043878474226 iter_best_vanilla_star_anomaly= 500 
last prior auc 0.45266286654171134 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6464634495294618 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6460040018650667 iter_best_vanilla_star_anomaly= 500 
last prior auc 0.4541047679628469 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.646479789449198 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6460054171337053 at iter 50
max_prior_anomaly= 0.45542714351441566 at iter 79
max_prior_star_anomaly= 0.6464871231139615 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.646004516508208
accuracies_anomaly['prior'][-1]= 0.45542714351441566
accuracies_anomaly['prior_star'][-1]= 0.6464871231139615



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.5539858341217 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6460032299003547
 first_prior_anomaly_auc= 0.4555825657430881
 first_prior_star_anomaly_auc= 0.646491626241448


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.645529629549574; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4568807530670158; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.6460894326265225 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6452100361588271; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4574787683972057; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 150 
last prior star auc 0.6456379619308176 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6451230614679475; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45709188541573387; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 150 
last prior star auc 0.6453493757893339 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6448759040993385; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4566007871981489; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 150 
last prior star auc 0.6451939535606614 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6460032299003547 at iter 0
0.45760163944719096 at iter 150
0.646491626241448 at iter 0
last anomaly aucs:
0.6446534496015119
0.45666035714175435
0.6451523961270016




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.50435829162598 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6446368523602048,first_prior_anomaly_auc= 0.4568214404449811, first_prior_star_anomaly_auc= 0.6451457057661647


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6446351797699956 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4647003696167041 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6450966860069559 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6446360803954929 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4707761178820994 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6450921828794696 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.644635308430781 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4767057074953656 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6450901243069044 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6446385249504141 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.480825683163038 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6450950134167466 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6446372383425609 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4842475454095376 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6450786734970104 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6446369810209903 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.48940864415205854 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6450727551008856 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6446371096817756 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.4939683823839711 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6450696672420377 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6446385249504142 at iter 53
max_prior_anomaly= 0.4971885045190814 at iter 79
max_prior_star_anomaly= 0.6451457057661647 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6446360803954929
accuracies_anomaly['prior'][-1]= 0.4971885045190814
accuracies_anomaly['prior_star'][-1]= 0.6450583450929291



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 82.19643235206604 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40843675087257747
accuracies_anomaly["prior"][-1]= 0.5007210150409604
accuracies_anomaly["prior_star"][-1]= 0.40843713685493344


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 1496.009191274643 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 8,
        "scheduler_step_size": 6,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004714250564575195 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40932785547173733
 first_prior_anomaly_auc= 0.5124173097132717
 first_prior_star_anomaly_auc= 0.4093270835070254


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5158638748305537; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5983407133159796; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 80 
last prior star auc 0.5159329656722732 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.583101100615822; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5962850999488444; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 80 
last prior star auc 0.5831879466459162 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.55230035191298; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5935591638901669; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 80 
last prior star auc 0.5523549040859578 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.556236857300779; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5952632759917945; count_not_improved_prior_anomaly= 32; iter_best_prior_anomaly= 80 
last prior star auc 0.5563265338681505 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5867923785467919 at iter 180
0.5985764198746947 at iter 80
0.5868646859081443 at iter 180
last anomaly aucs:
0.5810627277939204
0.5951034792964212
0.5811297600630747




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.34420371055603 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5843476949648345,first_prior_anomaly_auc= 0.594797652609704, first_prior_star_anomaly_auc= 0.584439044122415


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5843476949648344 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5862162355501072 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5856186062022734 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5843476949648345 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.594887972481002 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5879625483893214 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5843476949648345 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5918290623099037 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5878160037548363 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5843476949648345 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5904047874163576 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5879115987183328 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5843476949648345 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5841801786223414 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5877831952545784 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5843478236256197 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5910649459058595 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5880145273465927 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5843476949648344 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5933835419181985 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.587996514836647 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5843476949648344 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5906882271264282 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5881278774984637 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5843476949648344 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5900923990295889 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5882413563111203 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5843476949648344 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5932312075483739 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5883415830628884 iter_best_prior_star_anomaly= 930
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5843476949648345 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5937659217721839 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5885492415704027 iter_best_prior_star_anomaly= 1060
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.584347952286405 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5966076525376538 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5888726947847094 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5843479522864051 at iter 5
max_prior_anomaly= 0.6304149464719668 at iter 11
max_prior_star_anomaly= 0.589038924519349 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5843476949648344
accuracies_anomaly['prior'][-1]= 0.5954269325107278
accuracies_anomaly['prior_star'][-1]= 0.589038924519349



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 133.35437059402466 seconds
back and forth 2/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5843476949648345
 first_prior_anomaly_auc= 0.5978524456356717
 first_prior_star_anomaly_auc= 0.5885999339198207


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6065851677788106; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5917871188938878; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 40 
last prior star auc 0.6079229826246182 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6112601860743742; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.544982641086844; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 40 
last prior star auc 0.6107145356838115 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6134541097857334; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5236859359351632; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 40 
last prior star auc 0.61282894702984 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6169863629860419; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.522106753456086; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 40 
last prior star auc 0.6145976468457007 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6199872471429586 at iter 490
0.6014613806640339 at iter 40
0.6159885985958476 at iter 490
last anomaly aucs:
0.6199872471429586
0.5208066362203784
0.6159885985958476




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.46050524711609 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6202322172782171,first_prior_anomaly_auc= 0.5159695053353055, first_prior_star_anomaly_auc= 0.6160500984512329


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6202323459390024 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6162533824920462 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6205282657452496 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6202324745997877 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6078765360811159 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6205723963946159 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6202324745997878 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.608118547018312 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.620507808680383 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6202332465644997 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.5991798389578683 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6203467253771563 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6202328605821438 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.6109052109676629 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6205078086803829 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.620232989242929 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.6086661273206546 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6206875477974817 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.620232989242929 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.609185530911011 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6205987718556076 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6202323459390024 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.5971996208109336 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6202902432923987 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6202320886174317 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.6106339940321982 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6207405560410356 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6202332465644997 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.6125451213374133 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6207954941963694 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6202327319213584 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.6105553822923646 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6207164964741798 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6202349191547089 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.6073537873103412 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.620648048936387 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.620234919154709 at iter 35
max_prior_anomaly= 0.6279469752878657 at iter 2
max_prior_star_anomaly= 0.6211839211072651 at iter 85
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6202331179037144
accuracies_anomaly['prior'][-1]= 0.6249415880034624
accuracies_anomaly['prior_star'][-1]= 0.6208227702828581



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 133.29319262504578 seconds
back and forth 3/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.620233375225285
 first_prior_anomaly_auc= 0.6207983247336464
 first_prior_star_anomaly_auc= 0.6206564118874331


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6247721417491897; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6201439559794842; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6252441981705466 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6298656935794151; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6199415725641683; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6301510632012657 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6333098141417761; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6186069742379937; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6336618300504248 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6349385310232033; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6163475621869039; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.635523808935646 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6363022066868612 at iter 490
0.6207983247336464 at iter 0
0.6368030831241309 at iter 490
last anomaly aucs:
0.6363022066868612
0.6111407888655926
0.6368030831241309




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.47122359275818 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6368246981360655,first_prior_anomaly_auc= 0.6090833742474631, first_prior_star_anomaly_auc= 0.6366503627719502


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6368167211673753 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6043691144123753 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6362637371120492 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6368250841184215 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6164941068213889 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6366194841834723 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6368182650967992 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6098999842519198 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6366383973189151 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6368237975105682 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.59205730654307 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6366992538703737 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6368171071497313 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.6082771857666176 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363916259326621 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.636815434559522 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.5961581117537289 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6361390648110693 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6368203236693645 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.607346196324007 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363505831421434 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6368237975105682 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.6238088584494625 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371311681267093 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6368217389380031 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.6284088675071818 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371776146702116 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6368187797399405 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.6152469978292353 iter_best_prior_anomaly= 910
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6370133148473517 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6368276573341279 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.6198883069990437 iter_best_prior_anomaly= 910
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6369500137409718 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6368146625948101 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.6087034389483988 iter_best_prior_anomaly= 910
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6365850030930051 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6368338330518235 at iter 32
max_prior_anomaly= 0.6319198916779116 at iter 91
max_prior_star_anomaly= 0.6374541066978747 at iter 36
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6368235401889975
accuracies_anomaly['prior'][-1]= 0.6148935666519478
accuracies_anomaly['prior_star'][-1]= 0.6366072614088665



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 132.97063970565796 seconds
back and forth 4/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.636817364471302
 first_prior_anomaly_auc= 0.6154416615974316
 first_prior_star_anomaly_auc= 0.6369901559059932


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6381985380017642; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6019532508463307; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6379902361903232 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6394316229683175; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6074302118168241; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6395794542106558 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6398604493658052; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5996472635909534; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6404733893470929 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6403193823870591; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.5929925417915962; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6404758339020139 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6405568901967686 at iter 430
0.6154416615974316 at iter 0
0.6409324510291319 at iter 390
last anomaly aucs:
0.6405310293789184
0.5929285973812899
0.6401233033502238




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.4964427947998 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6404950043590275,first_prior_anomaly_auc= 0.5890041861073112, first_prior_star_anomaly_auc= 0.6401527666700634


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6405006654335816 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6350566416241313 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6411949190311945 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6405015660590789 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6167245382879057 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6409104500348413 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6405027240061468 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6197934840002595 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6411799943800969 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6404989928433725 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.6205012469803314 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6407874503240707 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6404975775747339 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.6156455889421716 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6405741307420021 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6404924311433209 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.6100994084691733 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6408010883673153 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6405023380237909 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.6008344166571458 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403220842635509 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6404977062355192 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.6247507840588258 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6410011558884954 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6404993788257285 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.6025881918219088 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6400641193889746 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6404995074865137 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.6166907005013654 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6406281682718387 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6404970629315926 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.619748195403825 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6407332841334491 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6405018233806496 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.6200854153221615 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6407518112865358 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6405049112394974 at iter 43
max_prior_anomaly= 0.6367221554901616 at iter 14
max_prior_star_anomaly= 0.6422653767650973 at iter 26
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6404965482884513
accuracies_anomaly['prior'][-1]= 0.606981057015255
accuracies_anomaly['prior_star'][-1]= 0.6405440241182361



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 133.5740475654602 seconds
back and forth 5/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6405024666845763
 first_prior_anomaly_auc= 0.6197615761254989
 first_prior_star_anomaly_auc= 0.6407759995141769


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6406299695228331; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6056683310225857; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6410020565139927 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6405240816965108; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.6088167891002699; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6414855637452435 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.640394262964118; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.6124822062133896; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6424146232760741 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6396867573056166; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.6136137778203216; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6419408942645081 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6407829471965845 at iter 150
0.6197615761254989 at iter 0
0.6425071303807226 at iter 310
last anomaly aucs:
0.6388525207735705
0.6079215673559797
0.6405013087375084




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.38160943984985 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.638829361832212,first_prior_anomaly_auc= 0.6221882471975108, first_prior_star_anomaly_auc= 0.6417529208571484


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6388302624577091 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6352929914867731 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6407150143019329 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6388323210302744 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.6166554474461863 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399640212979918 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6388309057616358 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.6154626333054397 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399393184272093 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6388310344224212 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.6256739251935316 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403348216812981 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6388305197792798 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.6205096099313774 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403761217933872 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6388318063871332 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.6195301153726993 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6410111914297507 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6388312917439919 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.6187149206368812 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.640601020846135 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6388288471890706 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.6236890752583251 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6404356917369927 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6388316777263479 iter_best_vanilla_star_anomaly= 830 
last prior auc 0.6210034100254542 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6404708161313863 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6388312917439919 iter_best_vanilla_star_anomaly= 830 
last prior auc 0.6393571283736145 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.64140695200541 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6388312917439918 iter_best_vanilla_star_anomaly= 830 
last prior auc 0.6173759478440055 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6404794364040032 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6388292331714266 iter_best_vanilla_star_anomaly= 830 
last prior auc 0.6184430603974898 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399873089001356 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6388332216557717 at iter 83
max_prior_anomaly= 0.6393571283736145 at iter 100
max_prior_star_anomaly= 0.6421390318739083 at iter 123
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6388310344224212
accuracies_anomaly['prior'][-1]= 0.617665691932557
accuracies_anomaly['prior_star'][-1]= 0.640982371413838



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 134.2417345046997 seconds
back and forth 6/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6388314204047771
 first_prior_anomaly_auc= 0.6176013615398946
 first_prior_star_anomaly_auc= 0.6400359426769884


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.637458609825361; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.620905499167822; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 100 
last prior star auc 0.6396481590700193 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6366058461402279; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6159936163664753; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 190 
last prior star auc 0.6385195466611497 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6352579957531648; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6193627276909918; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 190 
last prior star auc 0.6385016628119895 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6341857367682675; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6236100775361355; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 400 
last prior star auc 0.6382915597495541 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6388314204047771 at iter 0
0.6288877429501609 at iter 480
0.6400359426769884 at iter 0
last anomaly aucs:
0.6330577676633246
0.6207532934587827
0.6378026487653197




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.17417049407959 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6331092319774545,first_prior_anomaly_auc= 0.6163464042398361, first_prior_star_anomaly_auc= 0.6369560607978821


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6331094892990252 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6369452532919149 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6365814005910162 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6331093606382399 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6129245419933365 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6351290776462692 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6331100039421664 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6174606066407492 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354226815583806 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6331092319774545 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.615082955327946 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6352357374373035 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6331098752813812 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6167742013510412 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354727306038719 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6331097466205959 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6153802904028318 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6350444188495256 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6331093606382399 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6167285267722509 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6351496633719212 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6331098752813813 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6187428400272967 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6352851431788684 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6331096179598105 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6157819693746159 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6353279872203815 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6331097466205958 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6137573632567441 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6350747827948622 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6331101326029518 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6140131408979699 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.635719887972481 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6331103899245224 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6160067397665785 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6351720503485678 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6331105185853078 at iter 17
max_prior_anomaly= 0.6369452532919149 at iter 10
max_prior_star_anomaly= 0.6369560607978821 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6331101326029518
accuracies_anomaly['prior'][-1]= 0.6159584919720816
accuracies_anomaly['prior_star'][-1]= 0.6352172102842168



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.4276828765869 seconds
back and forth 7/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6331096179598106
 first_prior_anomaly_auc= 0.6214820281468627
 first_prior_star_anomaly_auc= 0.6354746605156518


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6336952818546091; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6102764457097802; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 70 
last prior star auc 0.6356022920146941 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6334739853038505; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6290791901987243; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 200 
last prior star auc 0.63798097261378 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6327817902788029; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6205633901396432; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 200 
last prior star auc 0.6377236510431302 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6315788119360155; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6285586286612999; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 390 
last prior star auc 0.6397840248593223 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6348187478320657 at iter 70
0.6358154829359773 at iter 390
0.6416714785800378 at iter 390
last anomaly aucs:
0.6290542300063713
0.623459287095735
0.6378014908182517




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.81639409065247 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6301419282855075,first_prior_anomaly_auc= 0.6255118126040222, first_prior_star_anomaly_auc= 0.6390830809008725


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6301415423031516 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6300061911569899 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6344990257805336 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6301425715894342 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.615810918051314 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.634288536735742 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6301423142678636 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6101609083245586 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6333118727143412 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6301415423031516 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6121801106894469 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6332439398196896 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6301420569462928 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6100083166331633 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6332187223057659 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6301423142678635 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6159346897267965 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6338198254948036 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.630141284981581 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6133635325928648 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6331670006700654 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6301420569462929 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6156531799285058 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6331155363559354 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6301420569462929 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6131955016072305 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.633593382512632 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6301421856070781 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6137073142112528 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6333267973654388 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6301415423031516 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6160188338803989 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6349062371660866 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6301417996247223 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6138106288218685 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6339833533529515 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6301425715894342 at iter 20
max_prior_anomaly= 0.6372005162899993 at iter 24
max_prior_star_anomaly= 0.6390830809008725 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6301420569462929
accuracies_anomaly['prior'][-1]= 0.622327329506447
accuracies_anomaly['prior_star'][-1]= 0.6340956742185402



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.03100037574768 seconds
back and forth 8/8


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6301417996247222
 first_prior_anomaly_auc= 0.6194885579390395
 first_prior_star_anomaly_auc= 0.6347343463568926


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6258145514318916; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6041781818069533; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6316228139245965 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6167524576783213; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6000597500687048; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6259138775581624 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6022830084391182; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6104799870721642; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6234973706881911 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5444613075847077; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6104473072326917; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5962187109836169 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6301738361602681 at iter 70
0.6194885579390395 at iter 0
0.6347343463568926 at iter 0
last anomaly aucs:
0.47500712780750703
0.6000185786174008
0.5270192795613594




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.81076955795288 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46885855753761785,first_prior_anomaly_auc= 0.6125359864216553, first_prior_star_anomaly_auc= 0.5305933475168982


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46885945816311514 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6146096122987359 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5204905166708353 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4688598441454711 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5999179658832768 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5214621629216085 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4688592008415444 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6028604380436562 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.521818038653817 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46885920084154453 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6073995905499168 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5256953600803667 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4688589435199738 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6086429683792961 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5263875551054144 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4688589435199738 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6041632571558555 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5247599961710551 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4688581715552619 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.609675085199172 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5261304908563353 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4688586861984032 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6046431618851171 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5214743856962144 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46885894351997376 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6053561999573875 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5246758520174526 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46885842887683254 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6063757080203017 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5247268016884412 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4688590721807591 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.608675390897198 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5267732801398182 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.46885739959054995 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.6067730125253847 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5244393734940256 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4688604874493977 at iter 2
max_prior_anomaly= 0.6192906776512099 at iter 8
max_prior_star_anomaly= 0.5305933475168982 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4688563703042674
accuracies_anomaly['prior'][-1]= 0.6115666560650179
accuracies_anomaly['prior_star'][-1]= 0.5280637478166263



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.8443284034729 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 7 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4093279841325227
accuracies_anomaly["prior"][-1]= 0.5124173097132717
accuracies_anomaly["prior_star"][-1]= 0.4093270835070254


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 1904.0663528442383 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004628658294677734 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40473350748857234
 first_prior_anomaly_auc= 0.5074479155408849
 first_prior_star_anomaly_auc= 0.4047327355238604


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5122853037475283; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5977713893409172; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5123484761931228 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5805550323350286; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.596898039930132; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 100 
last prior star auc 0.5806223219257534 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5527625014538669; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5959000182183672; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 100 
last prior star auc 0.5528396979250617 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5540098677675913; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5976644722283121; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 100 
last prior star auc 0.5540844910230797 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5835238799563994 at iter 180
0.5989470915972155 at iter 470
0.5835776601646652 at iter 180
last anomaly aucs:
0.5754628957734417
0.5986733014460445
0.5755334018837996




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.17217946052551 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5779226326672822,first_prior_anomaly_auc= 0.5984417120324597, first_prior_star_anomaly_auc= 0.5780067768208846


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5779226326672822 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5898783074828083 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5803440286470958 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5779226326672822 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5982394572779288 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5809151538731527 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5779226326672822 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5982263338778258 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.580720747426527 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5779226326672822 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5970888438747688 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5806638793594134 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5779226326672822 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5965650658177113 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5806793186536523 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5779226326672822 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5979273262127309 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5807090392950625 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5779226326672822 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6004256613421688 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5809218442339896 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5779226326672822 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5971862400892596 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5809127093182317 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5779226326672822 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5996168996456168 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5810066316915188 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5779226326672822 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5992687435605277 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5811087883550667 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5779226326672822 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6001327007339841 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5810544935036597 iter_best_prior_star_anomaly= 1080
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5779226326672822 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.599521947986047 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5812729595171412 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5779226326672822 at iter 0
max_prior_anomaly= 0.6066583757656604 at iter 1
max_prior_star_anomaly= 0.5813622501021566 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5779226326672822
accuracies_anomaly['prior'][-1]= 0.5979317006794319
accuracies_anomaly['prior_star'][-1]= 0.5812678130857283



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 132.79377913475037 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5779226326672822
 first_prior_anomaly_auc= 0.5998998247125461
 first_prior_star_anomaly_auc= 0.5813285409764015


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6043258843885062; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5968828579574637; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.6064042707146438 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.611469259850527; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5570973406330316; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.6110376029157623 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6133078224728191; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5323716968916583; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.6131875246385404 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.615427508911046; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5218384957186837; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.6146067817614588 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6166701147757134 at iter 490
0.6003793434594518 at iter 10
0.616763007862718 at iter 480
last anomaly aucs:
0.6166701147757134
0.5164423337213743
0.6165518755139998




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.27676725387573 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6168256656651712,first_prior_anomaly_auc= 0.5195047177336762, first_prior_star_anomaly_auc= 0.6168332566515053


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6168219345023966 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5886780310165128 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6168256656651712 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6168215485200408 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6125741986748968 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6171706052306271 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6168202619121874 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6018357835493291 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6168951424892465 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.616827209594595 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5963009252254394 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6167942724335519 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6168259229867417 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5991456151889718 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6170061767469819 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6168188466435489 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.6077094057209791 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6172090748054392 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6168264376298831 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.6040546674530414 iter_best_prior_anomaly= 630
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6171801261287411 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6168252796828151 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5920731318196649 iter_best_prior_anomaly= 630
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.617145259055918 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.616827595576951 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.6101027536495919 iter_best_prior_anomaly= 630
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6172647849254849 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6168207765553287 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.6087013803758335 iter_best_prior_anomaly= 630
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6172650422470555 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6168275955769509 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5857636069073344 iter_best_prior_anomaly= 630
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6168961717755291 iter_best_prior_star_anomaly= 1060
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6168232211102499 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.6045765155983189 iter_best_prior_anomaly= 630
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6171936355112002 iter_best_prior_star_anomaly= 1060
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6168308120965842 at iter 39
max_prior_anomaly= 0.6271110661656101 at iter 63
max_prior_star_anomaly= 0.6175918406417805 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6168229637886792
accuracies_anomaly['prior'][-1]= 0.6143547352830074
accuracies_anomaly['prior_star'][-1]= 0.6172173090956999



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 132.48806142807007 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6168211625376847
 first_prior_anomaly_auc= 0.6193421419653398
 first_prior_star_anomaly_auc= 0.6173665556066767


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6194247421895185; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6215090469117809; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.6202692715843907 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.624019347494254; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6103703680830674; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 120 
last prior star auc 0.6242335677018199 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6283929135698016; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.535101235452325; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 120 
last prior star auc 0.6257598705981285 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6331847558584401; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5284265712312426; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 120 
last prior star auc 0.6296739890092811 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6356031926401913 at iter 490
0.6216101742890463 at iter 120
0.6328068791319411 at iter 490
last anomaly aucs:
0.6356031926401913
0.5191165481443513
0.6328068791319411




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.2765007019043 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6357627320139941,first_prior_anomaly_auc= 0.5196778951507236, first_prior_star_anomaly_auc= 0.6330459308710746


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6357608021022142 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6108224820826991 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.635818956777181 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6357614454061409 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6053883651537187 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6357460061119019 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.635761831388497 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6105584701512125 iter_best_prior_anomaly= 230
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358327234812109 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6357604161198583 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.611025637462727 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6360154217963722 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6357627320139941 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.6083663476908477 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358831585090582 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6357600301375023 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.6168685097066843 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6359842858863236 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6357624746924235 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.6101865118208383 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6359836425823969 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6357651765689154 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.6160941004398139 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6361375208816454 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.635759901476717 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.6130296578549468 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6362537015707939 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6357597728159317 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.6162280363173372 iter_best_prior_anomaly= 930
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6360685587007113 iter_best_prior_star_anomaly= 930
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6357608021022142 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.6161975437112152 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6360497742260539 iter_best_prior_star_anomaly= 930
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6357606734414291 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.6098233024238663 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358338814282788 iter_best_prior_star_anomaly= 930
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6357680071061924 at iter 33
max_prior_anomaly= 0.6312231935253776 at iter 108
max_prior_star_anomaly= 0.6363633205598905 at iter 93
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6357623460316382
accuracies_anomaly['prior'][-1]= 0.6224447968034486
accuracies_anomaly['prior_star'][-1]= 0.6362197351234681



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 132.9793198108673 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6357637613002768
 first_prior_anomaly_auc= 0.6171307203871763
 first_prior_star_anomaly_auc= 0.6360502888691952


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6377098843391005; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5563517513820742; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6363595893971162 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6380252319239317; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5205464841124516; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.636532638153378 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6381756363819764; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5120821483675004; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6369618505332217 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6382348203432258; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 350 
last prior auc 0.5036793124779346; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6366021149774534 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6384954870942939 at iter 350
0.6171307203871763 at iter 0
0.6373212001066341 at iter 370
last anomaly aucs:
0.6381163237599417
0.5070081529766445
0.6368217389380031




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.20686864852905 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6381114346500992,first_prior_anomaly_auc= 0.5064775558979648, first_prior_star_anomaly_auc= 0.6367204828999524


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6381128499187377 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5891230686729515 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6382880859083503 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6381163237599417 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6166425813676539 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6385506825711983 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6381132359010938 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5990267326233317 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6377423068570023 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6381181250109362 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6157995959022055 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6384170040152458 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6381125925971671 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6047431313153147 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6382058716665278 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6381191542972188 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6104802443937349 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6382961915378257 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6381098907206753 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6145311292196878 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.638470140919585 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6381156804560151 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6035546916412691 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6380369400553962 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6381134932226644 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6019168398440837 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6383116308320647 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6381095047383194 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6049105189970223 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.638103843663765 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6381161950991563 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6019708773739202 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6379360699997015 iter_best_prior_star_anomaly= 1060
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6381048729500478 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6121527059421725 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6383130461007034 iter_best_prior_star_anomaly= 1060
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6381228854599931 at iter 16
max_prior_anomaly= 0.629589587534108 at iter 72
max_prior_star_anomaly= 0.6390241542611937 at iter 106
last values
accuracies_anomaly['vanilla_star'][-1]= 0.638120440905072
accuracies_anomaly['prior'][-1]= 0.6003985139164651
accuracies_anomaly['prior_star'][-1]= 0.6378171874340614



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.63448929786682 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6380997265186347
 first_prior_anomaly_auc= 0.6162771847373313
 first_prior_star_anomaly_auc= 0.6386108958187304


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6381834846898813; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5854822257698289; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6368171071497313 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.637282344549466; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5786619175397587; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6364654772234386 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.636698095923306; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.544987015553545; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6340339170415841 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6359498047958565; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5390907490836779; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6339307310917536 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6383758325639419 at iter 60
0.6162771847373313 at iter 0
0.6386108958187304 at iter 0
last anomaly aucs:
0.6341931990938163
0.5219738468648455
0.630967930527293




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.68047523498535 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6339317603780362,first_prior_anomaly_auc= 0.5245217163966335, first_prior_star_anomaly_auc= 0.6310844971987973


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6339321463603923 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6365521945927474 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6345091899825741 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6339281578760472 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6464727131060052 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6351832438368911 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.633930859752539 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6422884070456705 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6361381641855721 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6339303451093977 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6329830157470508 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363953570954364 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6339325323427483 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5937847062468413 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6331765215681794 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6339334329682456 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5973228778432746 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.633831404965483 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6339318890388216 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6023532572279056 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6340662108987007 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6339300877878271 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.602720969752364 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6342760566395655 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6339300877878271 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6079891142682753 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6345596250104215 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.633931245734895 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5955217555095121 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6331347068129488 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6339289298407591 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5965274968683965 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.633576399288969 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6339318890388216 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6337491907236603 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354045403876498 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.633935620201596 at iter 123
max_prior_anomaly= 0.6468247290146539 at iter 19
max_prior_star_anomaly= 0.6367395246961804 at iter 34
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6339309884133243
accuracies_anomaly['prior'][-1]= 0.5976724491970022
accuracies_anomaly['prior_star'][-1]= 0.6340834514439343



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.46401000022888 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6339302164486125
 first_prior_anomaly_auc= 0.609520177613641
 first_prior_star_anomaly_auc= 0.6349425195075482


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6327433207039905; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6144601084661885; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 30 
last prior star auc 0.6345412265181202 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6311019950656016; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6102697553489436; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 30 
last prior star auc 0.6329822437823389 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6295711890418065; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5988198460805293; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 30 
last prior star auc 0.630928303005413 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6281897581897736; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5953520519336687; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 30 
last prior star auc 0.6291915110643129 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6339897863922178 at iter 10
0.6161020774085042 at iter 30
0.635330946418444 at iter 30
last anomaly aucs:
0.627188648619161
0.5908505970375082
0.6281774067543825




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.61114048957825 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6271949529976418,first_prior_anomaly_auc= 0.5870862397804738, first_prior_star_anomaly_auc= 0.6279325652799093


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6271936663897887 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6380234306729371 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6282126598095614 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6271937950505739 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.63731167920852 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6282549892079333 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6271972688917777 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6312662948884614 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6282708144845284 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6271921224603647 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6325301297827074 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.629953182913436 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6271958536231392 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6342202178587346 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6308351525968379 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6271945670152859 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6105861322200572 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6284535127996895 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6271941810329299 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6178069614748437 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6292203310802256 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6271917364780086 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.609500363852701 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6286161400323401 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6271939237113592 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6025187149978334 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6279792691449821 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6271941810329299 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6011473196870558 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.627901558030646 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6271970115702071 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.610915503830489 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6291433919306013 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.62719418103293 iter_best_vanilla_star_anomaly= 1130 
last prior auc 0.6153510844045631 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6295081452569973 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.627198941481987 at iter 113
max_prior_anomaly= 0.6392962718221558 at iter 12
max_prior_star_anomaly= 0.6308351525968379 at iter 50
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6271958536231391
accuracies_anomaly['prior'][-1]= 0.5984458291775899
accuracies_anomaly['prior_star'][-1]= 0.6280097617511041



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 132.3290376663208 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6271921224603647
 first_prior_anomaly_auc= 0.5961789548009515
 first_prior_star_anomaly_auc= 0.6276280252010453


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6293857888501534; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.617197881317116; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.6333311718321399 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6275338455061875; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5882474033680306; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.630085060218394 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6257461038940988; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.566426791498507; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.62625354203142 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6269907683313314; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5595233684011169; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.6274166355307567 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6295930613753118 at iter 60
0.6227746830570214 at iter 20
0.6336858896172806 at iter 60
last anomaly aucs:
0.6258782385206274
0.5480962320917053
0.6253313015222115




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 106.2831678390503 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6265970663282373,first_prior_anomaly_auc= 0.5431314697075901, first_prior_star_anomaly_auc= 0.625162755893436


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6265989962400171 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.6159619658132854 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6273286315535944 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6265983529360906 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6296692285602241 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.627416764191542 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6265987389184465 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6376732160152828 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6274280863406505 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6265988675792318 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6385033354021987 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.627542723100375 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6265975809713786 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6365545104868833 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6277449778549056 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6265984815968759 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6397564914512628 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.627952250380064 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6265987389184465 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6382439552589838 iter_best_prior_anomaly= 610
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6283184189750985 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6265973236498079 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.636063283608513 iter_best_prior_anomaly= 610
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6289357334230872 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6265971949890226 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6338054154868473 iter_best_prior_anomaly= 610
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6293941518011995 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6265987389184466 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6251892600152129 iter_best_prior_anomaly= 610
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6293496351694772 iter_best_prior_star_anomaly= 940
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6265984815968759 iter_best_vanilla_star_anomaly= 1070 
last prior auc 0.6233683239205103 iter_best_prior_anomaly= 610
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6294313347681584 iter_best_prior_star_anomaly= 940
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6265984815968759 iter_best_vanilla_star_anomaly= 1070 
last prior auc 0.6233914828618687 iter_best_prior_anomaly= 610
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6296913582152999 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6266001541870851 at iter 107
max_prior_anomaly= 0.6397624098473877 at iter 61
max_prior_star_anomaly= 0.6299319538838574 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6265969376674521
accuracies_anomaly['prior'][-1]= 0.6246082279086859
accuracies_anomaly['prior_star'][-1]= 0.6298945135953279



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 133.43462252616882 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6265979669537346
 first_prior_anomaly_auc= 0.6244606539879183
 first_prior_star_anomaly_auc= 0.6299322112054281


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6225316428335428; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5990572252294536; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6235354542806473 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6224472413583697; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5972710275467887; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6233772015146977 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6215111054843461; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5851911950734241; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.622286158055143 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6207163678133945; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5711405366904535; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6208172378690893 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6265979669537346 at iter 0
0.6244606539879183 at iter 0
0.6299322112054281 at iter 0
last anomaly aucs:
0.6191648474031621
0.5579515195868033
0.6182333433174103




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.81910252571106 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6189582181819304,first_prior_anomaly_auc= 0.5567100716692038, first_prior_star_anomaly_auc= 0.6174352604660402


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6189586041642865 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.61486268806347 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6207597264980489 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6189578321995746 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6219468795642413 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6209753619742535 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6189607913976369 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.626450393032967 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6212783581236935 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6189593761289983 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6354574199704184 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6215315625492127 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6189551303230827 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.6377834783083063 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6221246887695602 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6189574462172185 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.6338926474992975 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6228629443557543 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6189561596093653 iter_best_vanilla_star_anomaly= 610 
last prior auc 0.6281988931055318 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6236367103186979 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6189622066662754 iter_best_vanilla_star_anomaly= 610 
last prior auc 0.6219628335016216 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6248296531202299 iter_best_prior_star_anomaly= 740
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6189560309485799 iter_best_vanilla_star_anomaly= 610 
last prior auc 0.625607150245948 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6257219156664577 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6189528144289468 iter_best_vanilla_star_anomaly= 610 
last prior auc 0.6224516158250708 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6257688768531013 iter_best_prior_star_anomaly= 990
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6189566742525066 iter_best_vanilla_star_anomaly= 610 
last prior auc 0.6243449879419113 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.626156145816929 iter_best_prior_star_anomaly= 1050
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6189565455917212 iter_best_vanilla_star_anomaly= 610 
last prior auc 0.6283327003222696 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6264489777643285 iter_best_prior_star_anomaly= 1160
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6189625926486315 at iter 61
max_prior_anomaly= 0.6381154231344444 at iter 47
max_prior_star_anomaly= 0.6267922447395752 at iter 116
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6189570602348625
accuracies_anomaly['prior'][-1]= 0.6152238388878768
accuracies_anomaly['prior_star'][-1]= 0.6248346708908576



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.57306027412415 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.618958861485857
 first_prior_anomaly_auc= 0.6169500806445802
 first_prior_star_anomaly_auc= 0.6249779990057095


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.612308900135557; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5643359250761929; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6118522830084391 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6061470778047795; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5681678292455229; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.606649498171473 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5962757077115157; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5599142398669339; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5961413858516367 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.583111007496292; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5623495312115626; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5882037873618053 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.618958861485857 at iter 0
0.6169500806445802 at iter 0
0.6249779990057095 at iter 0
last anomaly aucs:
0.5543461870604305
0.5582016361534748
0.5655271952875156




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.86004972457886 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5576042641272115,first_prior_anomaly_auc= 0.569347777307737, first_prior_star_anomaly_auc= 0.5750101384698836


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5576043927879968 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5957027812344642 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5759174543279943 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5576052934134942 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6010401452528802 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5825237996720694 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5576022055546463 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6083794710909509 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5866190724689593 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.557603234840929 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.6104404882110696 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5877219527207638 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5576037494840703 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.6129166936854316 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5882782819565086 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5576043927879969 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.613033260356936 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.587639609818156 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5576055507350648 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.6056710328990775 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5866195871121007 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5576046501095675 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.6057159355131558 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5881381703612898 iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5576040068056409 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.6089786443682087 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5904112204556238 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5576040068056408 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.6120234018529211 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5920039123171601 iter_best_prior_star_anomaly= 970
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5576058080566355 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.6074727985367666 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5885705992607666 iter_best_prior_star_anomaly= 1080
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5576051647527088 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.6167962023453317 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5933513767218673 iter_best_prior_star_anomaly= 1080
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5576058080566355 at iter 48
max_prior_anomaly= 0.6167962023453317 at iter 120
max_prior_star_anomaly= 0.593591715068854 at iter 108
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5576047787703529
accuracies_anomaly['prior'][-1]= 0.6106050453555001
accuracies_anomaly['prior_star'][-1]= 0.5919179669125632



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.04089784622192 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5576043927879968
 first_prior_anomaly_auc= 0.6099172247971534
 first_prior_star_anomaly_auc= 0.5916090523669982


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5120969443578128; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6127525225233571; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 70 
last prior star auc 0.5583156296092726 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4452975512250051; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5989892923348021; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 70 
last prior star auc 0.4927583276979909 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.404577699277544; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5874322086322123; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 70 
last prior star auc 0.43712077233525504 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.38557578789291713; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5771792306496752; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 70 
last prior star auc 0.4028914710250765 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5576043927879968 at iter 0
0.6134489633543205 at iter 70
0.5916090523669982 at iter 0
last anomaly aucs:
0.37969920652320477
0.5913696146455086
0.3922898223143091




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.84306693077087 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.37884914471456343,first_prior_anomaly_auc= 0.5974991431191697, first_prior_star_anomaly_auc= 0.39505976036156776


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3788486300714221 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5884517166951264 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38057216995163384 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.37884940203613415 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5964795063954704 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3816691318073135 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.37884914471456355 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5984836554484755 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3822599421335252 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.37884811542828084 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5949248981263902 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38316365548964687 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.37884888739299283 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5906047262767524 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38307256365363695 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.3788497880184901 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5880524822782635 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3832353195470729 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.3788491447145635 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5867316506561184 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38374726081188043 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.37884863007142217 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5864133438732249 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.384158203360208 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.37884965935770476 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5870202367976022 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3844875749706396 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.3788494020361341 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5889954371739092 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38508739155182403 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.3788491447145635 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5908028638861527 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38559521567150123 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.37884888739299283 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5919587523815111 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3860142638493042 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.3788501740008461 at iter 7
max_prior_anomaly= 0.5984951062583694 at iter 29
max_prior_star_anomaly= 0.39505976036156776 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.37884875873220747
accuracies_anomaly['prior'][-1]= 0.5927175936933571
accuracies_anomaly['prior_star'][-1]= 0.3865204153787722



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.54304599761963 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.37884901605377813
 first_prior_anomaly_auc= 0.592750402193615
 first_prior_star_anomaly_auc= 0.38647358285291394


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.37885609239697104; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6099423136502917; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 100 
last prior star auc 0.38730022839862616 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3765553802337921; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6085862289729679; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 100 
last prior star auc 0.3834909685275133 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.375363981361684; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6105243750431014; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 250 
last prior star auc 0.3811845952897801 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3736502197011571; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6104025332793988; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 250 
last prior star auc 0.37809583581648654 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.3841154879794802 at iter 30
0.612570338851337 at iter 410
0.3928509119991107 at iter 30
last anomaly aucs:
0.3733654933832331
0.6084746800720913
0.37694110526819596




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.81689357757568 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.37317700533273224,first_prior_anomaly_auc= 0.6090006453624992, first_prior_star_anomaly_auc= 0.37680523947889294


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.37317867792294146 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5403311677149948 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3723156213749824 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3731772626543029 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5451155476780845 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37242832822292693 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.37317919256608273 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.5462796704637038 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3722274887370348 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.37317790595822947 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.5485459015364156 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3725418070355835 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.37317957854843875 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.54811591719186 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3728257613887954 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.37317854926215616 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.5504828896594813 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37334477899679586 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.3731803505131507 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.552041743734477 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37336111891653206 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.3731779059582295 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.5629517923476681 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3735155118589219 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.37317803461901483 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.5772708371288265 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37336600802637443 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.3731776486366589 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.5901769291655473 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3737985655866366 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.3731791925660828 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.6022621653918956 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37448870203911905 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.3731772626543029 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.6128828558988912 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3749307804974952 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.37318047917393593 at iter 123
max_prior_anomaly= 0.6249998713392146 at iter 126
max_prior_star_anomaly= 0.37680523947889294 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.3731785492621561
accuracies_anomaly['prior'][-1]= 0.6224393930504648
accuracies_anomaly['prior_star'][-1]= 0.376596937667452



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.55771660804749 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.3731784206013708
 first_prior_anomaly_auc= 0.6216032266066387
 first_prior_star_anomaly_auc= 0.37619435807017054


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.37242253848758733; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.588543837817419; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.371695605050502 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3720610016808245; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5917517371779235; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.3720215028197298 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.37166704235615977; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5887414607836781; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.3713559405772443 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.37172159452913756; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5895566555194962; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.3718218212809056 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.37355385277294867 at iter 20
0.6216032266066387 at iter 0
0.37619435807017054 at iter 0
last anomaly aucs:
0.371543142019892
0.5890727623058895
0.3716844115621787




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.74785256385803 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.37164221082459215,first_prior_anomaly_auc= 0.5917984410429964, first_prior_star_anomaly_auc= 0.371723781762488


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.37164221082459215 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6144556053387021 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3729019285737077 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3716495444893556 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6100938760554044 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3728289779084285 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.37164619930893716 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6120640586610839 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3729474744917127 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.37164426939715733 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6119348832326177 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37291029152475386 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.37164684261286385 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6097733820391602 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37289369428344693 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.3716428541285187 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.6042548636350069 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37253511667474654 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.37164684261286385 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.5995977291886033 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37272000222325835 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.371643754754016 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.5995429196940549 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.372884173385333 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.37164709993443446 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.5965925992257709 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37262659449311253 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.3716474859167904 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.5946283350162164 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3723533189850826 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.37164800055993175 iter_best_vanilla_star_anomaly= 1010 
last prior auc 0.5934683293757277 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3721205716244299 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.3716419535030214 iter_best_vanilla_star_anomaly= 1010 
last prior auc 0.5848550044413704 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3709138621188681 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.37165057377563826 at iter 101
max_prior_anomaly= 0.6144556053387021 at iter 10
max_prior_star_anomaly= 0.3729492757427072 at iter 28
last values
accuracies_anomaly['vanilla_star'][-1]= 0.3716446553795133
accuracies_anomaly['prior'][-1]= 0.5929632071325422
accuracies_anomaly['prior_star'][-1]= 0.3720846752653243



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.14677095413208 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.37164221082459215
 first_prior_anomaly_auc= 0.5955214981879415
 first_prior_star_anomaly_auc= 0.3727951401218881


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40200152437298453; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5611300842882536; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4018506052717985 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4005284870418004; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5688808673177932; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.40035209310512 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.404967412796293; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5798551176628615; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4049192936625814 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4049294578646221; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5695056440913306; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4049082288350435 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.40513467181721524 at iter 250
0.5955214981879415 at iter 0
0.4050754878559658 at iter 250
last anomaly aucs:
0.4047780241202948
0.5656646050062426
0.40478265590856644




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.78625893592834 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40496960002964344,first_prior_anomaly_auc= 0.582413537379046, first_prior_star_anomaly_auc= 0.4049270133097009


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40496960002964344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.585369390261099 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049671554747223 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40496960002964344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5824359243556926 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40495609064718435 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40496960002964344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5900749011627847 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049474703745676 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40496960002964344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5945947545512467 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40494978626870337 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40496960002964344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5959463361010842 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049503009118447 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40496960002964344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5952129696247325 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049474703745676 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40496960002964344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5955342356056886 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40494695573142625 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40496960002964344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5955546926705553 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049479850177088 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40496960002964344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5948062728823207 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049398793882334 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40496960002964344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5948953061457655 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40493910742352146 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40496960002964344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5964015379595635 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40494052269215997 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40496960002964344 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5992069863835717 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40494090867451604 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40496960002964344 at iter 0
max_prior_anomaly= 0.5992069863835717 at iter 120
max_prior_star_anomaly= 0.40496857074336085 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40496960002964344
accuracies_anomaly['prior'][-1]= 0.5960822018903872
accuracies_anomaly['prior_star'][-1]= 0.40493769215488284



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.38756227493286 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40496960002964344
 first_prior_anomaly_auc= 0.5964963609583479
 first_prior_star_anomaly_auc= 0.4049398793882334


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4050219649692707; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5804819530089641; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4049034683859865 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40500549638874905; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5821918548459313; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 180 
last prior star auc 0.4049801502140401 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40510122001303084; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5922731993408451; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 280 
last prior star auc 0.4050377902458656 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40485624987777225; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.586486294538504; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 390 
last prior star auc 0.4048123765499765 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4051233496681066 at iter 20
0.6002873509979445 at iter 390
0.40512257770339466 at iter 50
last anomaly aucs:
0.40502981327717547
0.5793620895334965
0.4049932736141432




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.82493710517883 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40520787980406503,first_prior_anomaly_auc= 0.5856150037002842, first_prior_star_anomaly_auc= 0.4051561581683645


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40520787980406503 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5224371543528002 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052040199805053 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40520787980406503 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5351094697425858 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40520466328443194 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40520787980406503 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5426313652350324 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052029906942227 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40520787980406503 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5397337956887315 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40520286203343736 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40520787980406503 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5382042762727897 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052019614079402 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40520787980406503 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5342058850472494 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051996455138043 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40520787980406503 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5334662141924168 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40520041747851626 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40520787980406503 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.533848079403261 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052002888177309 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40520787980406503 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.539377919956523 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051993881922336 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40520787980406503 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.553044525895299 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052029906942227 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40520787980406503 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5721159141040011 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052060785530705 iter_best_prior_star_anomaly= 1080
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40520787980406503 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.586814636862653 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052105816805569 iter_best_prior_star_anomaly= 1180
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40520787980406503 at iter 0
max_prior_anomaly= 0.590540781866446 at iter 129
max_prior_star_anomaly= 0.4052105816805569 at iter 118
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40520787980406503
accuracies_anomaly['prior'][-1]= 0.590540781866446
accuracies_anomaly['prior_star'][-1]= 0.4052065931962118



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.8284773826599 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40520787980406503
 first_prior_anomaly_auc= 0.5908499537335816
 first_prior_star_anomaly_auc= 0.4052071078393531


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40503753292429495; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6010802874179016; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4050377902458656 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4050389481929335; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6028084590863848; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 200 
last prior star auc 0.4050433226596346 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4050335444399499; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.604040257445085; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 300 
last prior star auc 0.40503766158508026 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40502453818497713; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6043305161767778; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 380 
last prior star auc 0.40503019925953143 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.40520787980406503 at iter 0
0.6047092935287741 at iter 480
0.4052071078393531 at iter 0
last anomaly aucs:
0.4050219649692707
0.6044518432973393
0.40502698273989834




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.79543614387512 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4050164325555017,first_prior_anomaly_auc= 0.6044499133855593, first_prior_star_anomaly_auc= 0.4050218363084853


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4050164325555017 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5890584809587185 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40501977773592013 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4050164325555017 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.587992526352302 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40501385933979517 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4050164325555017 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.598613731502439 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050172045202136 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4050164325555017 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5979169046891196 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40501681853785765 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4050164325555017 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5976437578418748 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050134733574392 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4050164325555017 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5990897764081409 iter_best_prior_anomaly= 520
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40501540326921914 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4050164325555017 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6001741295068586 iter_best_prior_anomaly= 520
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050134733574392 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4050164325555017 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5940235006644042 iter_best_prior_anomaly= 520
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40501424532215113 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4050164325555017 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5841038827766439 iter_best_prior_anomaly= 520
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40501141478487407 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4050164325555017 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.58955022248023 iter_best_prior_anomaly= 930
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40500884156916755 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4050164325555017 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5984121200518348 iter_best_prior_anomaly= 930
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050201637182761 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4050164325555017 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5895203731780346 iter_best_prior_anomaly= 930
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050101281770208 iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4050164325555017 at iter 0
max_prior_anomaly= 0.608312953464938 at iter 121
max_prior_star_anomaly= 0.4050259534536157 at iter 23
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4050164325555017
accuracies_anomaly['prior'][-1]= 0.5921094141611266
accuracies_anomaly['prior_star'][-1]= 0.40501270139272727



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.6911337375641 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4047336361493577
accuracies_anomaly["prior"][-1]= 0.5074479155408849
accuracies_anomaly["prior_star"][-1]= 0.4047326068630751


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 3554.3303530216217 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004464864730834961 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4024419302411515
 first_prior_anomaly_auc= 0.5043042179122574
 first_prior_star_anomaly_auc= 0.40244463211764325


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.49906502207304426; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5915061237387382; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.49914247586580995 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5776933591478333; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5922681815702174; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 200 
last prior star auc 0.5777753160680852 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5513400278113153; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5933174102745415; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 300 
last prior star auc 0.5513998550764914 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5611185048175744; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5929526569481457; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 340 
last prior star auc 0.5612090820104432 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5926765509028384 at iter 490
0.5934090167536927 at iter 340
0.5927712452408376 at iter 490
last anomaly aucs:
0.5926765509028384
0.591360994372892
0.5927712452408376




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.71979975700378 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5965910552963469,first_prior_anomaly_auc= 0.5909995862269144, first_prior_star_anomaly_auc= 0.5967056920560714


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5965913126179176 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5897244291835598 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5966682517675419 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5965910552963469 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5156990603645526 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5966216765632542 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5965913126179176 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.41960746623683676 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5965390763390757 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5965910552963469 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.42214658683522255 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5964407794990876 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5965913126179175 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.44617270188678465 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5972597053976803 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5965913126179176 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.5050478772514351 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5982271058425377 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5965913126179176 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.601160443087159 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5991254154456758 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5965913126179176 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.5986258256162594 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5995883369512747 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5965913126179176 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.5971952463442325 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.599921568385266 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5965913126179176 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.5980431209195233 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6000749320413732 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5965913126179175 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.5989841459033891 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.600234857397532 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5965913126179175 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.5992978208980111 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6003094806530204 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.596591441278703 at iter 31
max_prior_anomaly= 0.6020363657136505 at iter 72
max_prior_star_anomaly= 0.6003253059296153 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5965910552963469
accuracies_anomaly['prior'][-1]= 0.5997157111287462
accuracies_anomaly['prior_star'][-1]= 0.6003101239569469



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 129.972229719162 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5965911839571323
 first_prior_anomaly_auc= 0.599820955651142
 first_prior_star_anomaly_auc= 0.6003152703883601


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6090315239509771; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5953102371784381; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.6099760227760469 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6137587785253826; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5921617791007538; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.6140544410100592 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6180864127005693; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5917307654699155; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.6177660473451104 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6212193028232293; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.591404224396761; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.6208683162008631 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6244557648780759 at iter 490
0.6020609399236476 at iter 20
0.623419273591499 at iter 490
last anomaly aucs:
0.6244557648780759
0.5894444633146929
0.623419273591499




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.07559180259705 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6246575049894653,first_prior_anomaly_auc= 0.5891946040695921, first_prior_star_anomaly_auc= 0.623403062332548


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.624657762311036 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5898682719415531 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6248059795357301 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6246577623110359 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5910441028586368 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6247967159591867 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6246573763286799 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.5919289030793158 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6234240340405559 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6246576336502505 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.5972222651091507 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6259016547835565 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6246569903463239 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.6007700862644834 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6267580209706787 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6246575049894653 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.6053248067257683 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6277964421690356 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6246577623110359 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.6077491619036444 iter_best_prior_anomaly= 640
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6291339996932727 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6246569903463239 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.6053922249772785 iter_best_prior_anomaly= 640
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6269673520684023 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6246580196326065 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.6114432703718915 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6295592235887713 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6246573763286799 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.6085702750355876 iter_best_prior_anomaly= 990
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6289182355562829 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6246577623110359 iter_best_vanilla_star_anomaly= 1050 
last prior auc 0.5975192142016805 iter_best_prior_anomaly= 990
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6248555139380803 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6246580196326066 iter_best_vanilla_star_anomaly= 1050 
last prior auc 0.5967466061858047 iter_best_prior_anomaly= 990
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6248407179477679 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6246589202581038 at iter 105
max_prior_anomaly= 0.6131689974854536 at iter 99
max_prior_star_anomaly= 0.6295592235887713 at iter 90
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6246580196326065
accuracies_anomaly['prior'][-1]= 0.5945209032604702
accuracies_anomaly['prior_star'][-1]= 0.62515246303061



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 129.84233713150024 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6246580196326066
 first_prior_anomaly_auc= 0.5938010461665777
 first_prior_star_anomaly_auc= 0.6253920294128847


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6284169731366573; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5911945073166816; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 40 
last prior star auc 0.6294206559229765 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6309165948739485; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5957344317876541; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 40 
last prior star auc 0.6316270597305121 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.631353269579341; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5811217830943846; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 40 
last prior star auc 0.6313445206459389 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6321217604500863; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5729751108284005; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 40 
last prior star auc 0.6316222992814553 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6328885787306223 at iter 490
0.6099405123992971 at iter 40
0.632880087118791 at iter 490
last anomaly aucs:
0.6328885787306223
0.5755934864705463
0.632880087118791




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 106.0831127166748 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6329710502940156,first_prior_anomaly_auc= 0.5749570015655444, first_prior_star_anomaly_auc= 0.6326722999504913


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.632977483333282 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5923331552668064 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.63292331714266 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.632974009492078 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.5984640990091061 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6331437130679216 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6329683484175237 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.6068405594376803 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6332045696193802 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6329729802057955 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.5974041914596 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6328659344324052 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6329669331488852 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.5772968266074621 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6325300011219221 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6329770973509259 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.5886579599340022 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6325020817315066 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6329734948489367 iter_best_vanilla_star_anomaly= 670 
last prior auc 0.5838436020079317 iter_best_prior_anomaly= 320
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6318637955755099 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.632979541905847 iter_best_vanilla_star_anomaly= 670 
last prior auc 0.5950715714216606 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6326733292367739 iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6329737521705073 iter_best_vanilla_star_anomaly= 870 
last prior auc 0.579092931170597 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6315276049434562 iter_best_prior_star_anomaly= 830
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6329741381528634 iter_best_vanilla_star_anomaly= 870 
last prior auc 0.5938373285080393 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6325436391651664 iter_best_prior_star_anomaly= 830
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6329705356508742 iter_best_vanilla_star_anomaly= 870 
last prior auc 0.579588403854883 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6315077911825162 iter_best_prior_star_anomaly= 1010
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6329797992274176 iter_best_vanilla_star_anomaly= 870 
last prior auc 0.5875292188643473 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6324854844901997 iter_best_prior_star_anomaly= 1010
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6329863609274692 at iter 121
max_prior_anomaly= 0.6118458499691729 at iter 124
max_prior_star_anomaly= 0.6348175898849978 at iter 101
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6329668044880999
accuracies_anomaly['prior'][-1]= 0.593709311026641
accuracies_anomaly['prior_star'][-1]= 0.6324300316917246



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 132.52608394622803 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6329743954744341
 first_prior_anomaly_auc= 0.5973847636810159
 first_prior_star_anomaly_auc= 0.6341998894546532


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6342577868080493; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5822417752306372; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.634636306838475 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.634956672193934; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.5705103561639324; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6352345794902358 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6358742809148707; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5857702972681713; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6376678122622992 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6357807445239396; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.561796418495451; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6345242432944572 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6370301694102292 at iter 490
0.5973847636810159 at iter 0
0.6377721561591976 at iter 330
last anomaly aucs:
0.6370301694102292
0.5698050377387816
0.6376521156464896




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.20542860031128 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6370179466356234,first_prior_anomaly_auc= 0.5672527937402925, first_prior_star_anomaly_auc= 0.6371947265546597


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6370205198513299 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.594512540309424 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6373116792085199 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6370203911905445 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5988790300417788 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6374148651583506 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6370207771729005 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.605092959990613 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6374924476119015 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6370206485121153 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6042046859287301 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6373393412773649 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6370188472611207 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5940520633587464 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6373506634264735 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6370207771729005 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6031079813946212 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376849241467474 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6370246369964603 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6046983573620216 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6377080830881059 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6370203911905445 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6041080616789511 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376193071462317 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6370211631552565 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6046429045635466 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376539168974842 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6370209058336859 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6049738201034021 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376391209071718 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6370210344944711 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6052904542960866 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376132600893214 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6370219351199684 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.6054339110717237 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6375962768656586 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6370248943180309 at iter 17
max_prior_anomaly= 0.6060938122396549 at iter 34
max_prior_star_anomaly= 0.6377712555337004 at iter 54
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6370210344944712
accuracies_anomaly['prior'][-1]= 0.6055925498200294
accuracies_anomaly['prior_star'][-1]= 0.6375844400734086



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 129.66116786003113 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6370218064591832
 first_prior_anomaly_auc= 0.6055576827472062
 first_prior_star_anomaly_auc= 0.6375800656067077


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.635264814774787; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5629506344006003; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6351133810304597 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6361035544343197; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5668019663485143; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6365703357634782 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6346804374878416; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5580212537324494; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6341771164956507 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6350621740379004; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5657854174836627; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6352793534435287 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6370218064591832 at iter 0
0.6055576827472062 at iter 0
0.6380402852358147 at iter 60
last anomaly aucs:
0.6334503117193507
0.5452344302437246
0.6320001760079543




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 103.98360276222229 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.633045673549504,first_prior_anomaly_auc= 0.5633842212471449, first_prior_star_anomaly_auc= 0.6334811903078287


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6330450302455773 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5833154494841731 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6333282126340775 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6330469601573573 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5891713164674484 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6334755292332743 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6330455448887188 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5937203758541789 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6336236177971832 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6330482467652105 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5971848248206212 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6340245248042555 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.633046445514216 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5925500773508642 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6338257438909286 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6330487614083519 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.595735975717078 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.633916578405368 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6330455448887187 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5953788133770163 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6339093734013898 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6330458022102894 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5953896208829835 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6339124612602376 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6330452875671481 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5954168969694724 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6339129759033788 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6330463168534306 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5947627855368809 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6338519906911348 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6330459308710747 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5945587295313557 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6337915201220321 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6330452875671481 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5938845470162535 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6337516352785815 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6330496620338492 at iter 39
max_prior_anomaly= 0.5975607716353404 at iter 39
max_prior_star_anomaly= 0.6340586199123666 at iter 39
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6330495333730637
accuracies_anomaly['prior'][-1]= 0.5949598938599985
accuracies_anomaly['prior_star'][-1]= 0.6338696172187244



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 129.51760745048523 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6330455448887187
 first_prior_anomaly_auc= 0.594987427268058
 first_prior_star_anomaly_auc= 0.6338818399933301


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6349543562997981; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5767740778366872; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.635427570668223 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6347963608554192; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.575591685219552; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6352783241572462 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6344709777293327; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.578264355713105; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6357793292553011 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6336254190481777; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.5723405558351784; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6344290343133168 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6363719408325073 at iter 130
0.594987427268058 at iter 0
0.6387995125300165 at iter 260
last anomaly aucs:
0.6335707382144147
0.5778420910156687
0.636509607872805




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 103.96455526351929 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6329758107430726,first_prior_anomaly_auc= 0.5714309240829316, first_prior_star_anomaly_auc= 0.6342943264710817


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6329750387783607 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5792393471442967 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6335809024164554 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6329718222587275 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.580771825758301 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6337539511727173 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.632971564937157 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5857624489602664 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6339080867935365 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6329710502940156 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5985415528018716 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6346665421230264 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6329767113685699 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5906367628122984 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6343357552439562 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.632976325386214 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5898729037298247 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.634229867417634 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6329742668136488 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5877252979011823 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6339675280763566 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6329714362763716 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5894462645656875 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6340002079158291 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6329715649371569 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5957291566954558 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6345431564299 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6329752960999313 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5860047172190331 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6342914959338045 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6329710502940156 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5926057874709099 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6341724847073791 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6329741381528633 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.592881121551505 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6342164866959602 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6329776119940672 at iter 45
max_prior_anomaly= 0.5985415528018716 at iter 40
max_prior_star_anomaly= 0.6346981926762164 at iter 44
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6329768400293553
accuracies_anomaly['prior'][-1]= 0.5844009605299589
accuracies_anomaly['prior_star'][-1]= 0.6341754439054414



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 129.51432704925537 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6329724655626541
 first_prior_anomaly_auc= 0.585688211687134
 first_prior_star_anomaly_auc= 0.6342761853003509


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6319862806431393; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.555939393565108; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6329414583133909 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6325981913381442; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5554257797100912; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6336764973799518 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6352016423291925; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5469880767477024; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6339635395920115 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6364506812331261; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 330 
last prior auc 0.5400863262405216; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6331516900366116 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6412830516691421 at iter 330
0.585688211687134 at iter 0
0.6418633118109571 at iter 330
last anomaly aucs:
0.6346579218504097
0.5485208126832772
0.6342580441296201




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 103.98095178604126 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6362643804159758,first_prior_anomaly_auc= 0.557903915096233, first_prior_star_anomaly_auc= 0.6380841585636103


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.636263737112049 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5754684281872107 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363898246816675 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6362633511296931 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5793698091806161 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6365443462848426 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6362638657728343 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.585372478119947 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6365714937105462 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.636264123094405 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5735569148996394 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363431208165945 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6362638657728344 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5791171193982381 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363752860129257 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6362646377375464 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5794695212892429 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6360551779790375 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6362638657728344 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5798808498199264 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6359329502329789 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6362643804159758 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.5805372771466537 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6360150358140162 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6362636084512638 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.5819973197385201 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.636098922646048 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.636264895059117 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.5815398019859049 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6360165797434401 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6362641230944052 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.5830399867427927 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6362087989567153 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.636264123094405 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.583677372273292 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6362192204803268 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6362650237199023 at iter 76
max_prior_anomaly= 0.5879472377558678 at iter 36
max_prior_star_anomaly= 0.6380841585636103 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6362637371120491
accuracies_anomaly['prior'][-1]= 0.5774072175612708
accuracies_anomaly['prior_star'][-1]= 0.6356217197932781



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 129.8435878753662 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6362646377375464
 first_prior_anomaly_auc= 0.5844333830478607
 first_prior_star_anomaly_auc= 0.6361168064952081


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6316306622325014; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5452206635396949; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6284210902817877 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6316777520799303; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5545355757364285; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6309090038876143 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6294411129878432; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5495827788053487; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6251312340010313 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6188856534990073; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5591304383627349; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6221625150404458 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6362646377375464 at iter 0
0.5844333830478607 at iter 0
0.6365081926041665 at iter 50
last anomaly aucs:
0.5931075645336767
0.5465547472227282
0.5985392369077358




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 103.93384599685669 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5905037275602725,first_prior_anomaly_auc= 0.5605150857344009, first_prior_star_anomaly_auc= 0.6061672775480754


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5905012830053513 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5730821566017907 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6000859968689111 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5905034702387018 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5724159510553787 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6014296014500585 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5905050141681256 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5806326147885794 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6078351073082413 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.590503984881843 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5713290247409544 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6113335227220094 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5905032129171311 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.5725884851684993 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6115314030098389 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.590506686758335 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.572183589677082 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6115079867469098 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5905014116661366 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.5691820622162387 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6106113497339809 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5905008970229952 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.5777189626441129 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6133567135712426 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.590505142828911 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.5647495695010123 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6085153368802538 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5905046281857697 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.5761507163317884 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6128312629239759 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5905072014014763 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.5686374411119586 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6099901754624326 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5905072014014761 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.5700205445542006 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6102776036568482 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5905086166701148 at iter 48
max_prior_anomaly= 0.5810671022606215 at iter 108
max_prior_star_anomaly= 0.6142316069114515 at iter 71
last values
accuracies_anomaly['vanilla_star'][-1]= 0.590505528811267
accuracies_anomaly['prior'][-1]= 0.57482255104488
accuracies_anomaly['prior_star'][-1]= 0.6120694624140675



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 129.59393668174744 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5905056574720524
 first_prior_anomaly_auc= 0.5682800214503261
 first_prior_star_anomaly_auc= 0.6105085497665064


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5372720002223258; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5537525461969416; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5504414608866066 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.48180980950998764; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5617257837243077; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 150 
last prior star auc 0.5028202444143206 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.44104827146808134; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.555413042292344; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 230 
last prior star auc 0.45871867238538133 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4197962116089083; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5543666441252971; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 230 
last prior star auc 0.4371701780768198 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5905056574720524 at iter 0
0.5768847261120666 at iter 230
0.6105085497665064 at iter 0
last anomaly aucs:
0.40859075783261123
0.5610132602951787
0.4251356341998895




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.00725293159485 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4071083282640984,first_prior_anomaly_auc= 0.5521871304218942, first_prior_star_anomaly_auc= 0.4187575330889807


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40711012951509296 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.582761307481779 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41085081318762756 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4071088429072397 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5759301917457416 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4123291256110101 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4071102581758783 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5801060061942449 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41743387092955875 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40710987219352224 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.570272591032652 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42053626844609676 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40711077281901953 iter_best_vanilla_star_anomaly= 500 
last prior auc 0.5743407164038384 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4215915442073312 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4071102581758783 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.5774581672322595 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42299729194779057 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40710897156802495 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.5758694638550683 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4221323054880516 iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40711154478373157 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.5763938852160523 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4225047784615669 iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40710961487195163 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.5727325852480631 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42162975646057266 iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40710922888959566 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.566371338700032 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4204732246612876 iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40710897156802506 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.5780156544150721 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4217751431479898 iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40711077281901953 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.5784646805558558 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42141167642944705 iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40711154478373157 at iter 80
max_prior_anomaly= 0.6010850478669585 at iter 1
max_prior_star_anomaly= 0.4230819507445342 at iter 62
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40710961487195163
accuracies_anomaly['prior'][-1]= 0.577193383336061
accuracies_anomaly['prior_star'][-1]= 0.4208786347958462



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 129.48000144958496 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4071100008543076
 first_prior_anomaly_auc= 0.5751286350531677
 first_prior_star_anomaly_auc= 0.4216109719859153


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3986693386938563; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5631195660117319; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.40880163285975873 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.39593220914685545; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5652826111346132; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4013247686421758 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3896742772094402; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.56319804909078; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 210 
last prior star auc 0.3946015993050259 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40062549727393526; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5580912451996661; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 210 
last prior star auc 0.40063450352890806 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4075199141163526 at iter 20
0.5780264619210392 at iter 210
0.4216109719859153 at iter 0
last anomaly aucs:
0.40163020934653704
0.5602084870829718
0.4016473212309852




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.04565834999084 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40154233403016015,first_prior_anomaly_auc= 0.5748762025923604, first_prior_star_anomaly_auc= 0.40161065290716763


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40154233403016015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5879257514047185 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4015382168850298 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40154233403016015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5681989651555714 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4015111981201116 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40154233403016015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5771653352848601 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4015187891064457 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40154233403016015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5832862434859044 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40149730275529644 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40154233403016015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5702467302148018 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40153023991633957 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40154233403016015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5855242978466302 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40154233403016015 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40154233403016015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5858525115099938 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4015280526829891 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40154233403016015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5844978421013085 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4015160872299539 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40154233403016015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.586542133319335 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.401533971079114 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40154233403016015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.584974530310937 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40150476508084526 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40154233403016015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5874951237562361 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40153216982811946 iter_best_prior_star_anomaly= 1060
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40154233403016015 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5868576095649516 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40152753803984775 iter_best_prior_star_anomaly= 1060
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40154233403016015 at iter 0
max_prior_anomaly= 0.6048271468081318 at iter 1
max_prior_star_anomaly= 0.40173390993950886 at iter 106
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40154233403016015
accuracies_anomaly['prior'][-1]= 0.5773416005607551
accuracies_anomaly['prior_star'][-1]= 0.4015546854655513



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 129.53786873817444 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40154233403016015
 first_prior_anomaly_auc= 0.587052273333148
 first_prior_star_anomaly_auc= 0.4015256081280679


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.39938070417591737; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5174193837251311; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.39920135104117455 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.39922193676682655; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5121695090407361; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.3992514000866658 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3984607795608447; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5103671000991202; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.3980185724416832 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.39666313106828593; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5208923243034047; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.3964464663057989 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.40154233403016015 at iter 0
0.587052273333148 at iter 0
0.4015256081280679 at iter 0
last anomaly aucs:
0.3948792492797569
0.5198881268739444
0.3946248869071697




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.01769518852234 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.3947835256554752,first_prior_anomaly_auc= 0.5174752225059622, first_prior_star_anomaly_auc= 0.3943575297952646


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3947842976201872 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5596669538375395 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39451835577692074 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.39478468360254315 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.530233997943486 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3944536394019023 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3947839116378312 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5231072197227721 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3944334396586063 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.39478378297704586 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5116892183291184 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39457419455775167 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.3947849409241138 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5126876260232393 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39459928341089 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.39478288235154857 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5135379451534512 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3945869319754989 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.3947853269064698 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5259983562298066 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3944538967234729 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.3947855842280404 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.514197331678241 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3945160398827849 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.3947848122633285 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5281222884739493 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3944773129864021 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.3947839116378312 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5200102259592176 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39449198031592914 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.3947832683339046 iter_best_vanilla_star_anomaly= 1020 
last prior auc 0.5292214375629795 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3944773129864021 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.39478275369076327 iter_best_vanilla_star_anomaly= 1020 
last prior auc 0.5212402230669232 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39461176350706656 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.3947857128888258 at iter 102
max_prior_anomaly= 0.5702621695090407 at iter 1
max_prior_star_anomaly= 0.3949433223508487 at iter 43
last values
accuracies_anomaly['vanilla_star'][-1]= 0.3947835256554752
accuracies_anomaly['prior'][-1]= 0.5335562767421442
accuracies_anomaly['prior_star'][-1]= 0.394549363026184



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 129.6299901008606 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.3947848122633285
 first_prior_anomaly_auc= 0.531108119318983
 first_prior_star_anomaly_auc= 0.394488763796296


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.405204277302076; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5417501675163425; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 80 
last prior star auc 0.40520106078244283 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40518073237836155; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5526907087356556; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 80 
last prior star auc 0.4052077511432797 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40517198344495947; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5479094166314136; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 80 
last prior star auc 0.4051408475349108 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4051553862036525; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 330 
last prior auc 0.543166722762769; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 80 
last prior star auc 0.4051319699407234 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.40522872285128775 at iter 330
0.5608454866311151 at iter 80
0.4052872635086105 at iter 140
last anomaly aucs:
0.40516323451155734
0.5347481902573936
0.4051418768211934




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.05726790428162 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4051728840704567,first_prior_anomaly_auc= 0.5396428325135069, first_prior_star_anomaly_auc= 0.40511498671706053


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4051728840704567 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5502048537023942 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051726267488861 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4051728840704567 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5478652859820472 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40518266229014144 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4051728840704567 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5384181104979995 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051417481604081 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4051728840704567 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5438437358151484 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40516902424689694 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4051728840704567 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5459869671770897 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052096810550596 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4051728840704567 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5407255130220154 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40519720095888306 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4051728840704567 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5435757353993167 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051597606703536 iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4051728840704567 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5424603750513357 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40511794591512296 iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4051728840704567 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5374359140628298 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051113842150714 iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4051728840704567 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5418832027683684 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40513698771135104 iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4051728840704567 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.546715830525955 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40516580772726385 iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4051728840704567 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5424966573927973 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40520041747851626 iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4051728840704567 at iter 0
max_prior_anomaly= 0.5652914887288005 at iter 2
max_prior_star_anomaly= 0.40522807954736106 at iter 62
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4051728840704567
accuracies_anomaly['prior'][-1]= 0.5374745122984271
accuracies_anomaly['prior_star'][-1]= 0.40505901927544424



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 129.57434940338135 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4051728840704567
 first_prior_anomaly_auc= 0.5424473803120178
 first_prior_star_anomaly_auc= 0.4051268235093104


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40518343425485337; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.519200048994027; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4051245076151746 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4051225777033947; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5239067178427806; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.405102120638528 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4051636204939133; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5241806366547372; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4051528129879461 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout in clam_loss: loss is nan, at iter 339


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 340 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.40519913087066295 at iter 50
0.5424473803120178 at iter 0
0.4052379864278311 at iter 240
last anomaly aucs:
0.4051062377836585
0.5210118501729715
0.40511099823271546




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 70.7226665019989 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1160:::  
fit func. error in fit_prior at iter 12:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 12 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4024419302411515
accuracies_anomaly["prior"][-1]= 0.5043042179122574
accuracies_anomaly["prior_star"][-1]= 0.4024447607784286


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 2880.9749801158905 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004779338836669922 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40365726001933
 first_prior_anomaly_auc= 0.5112422507608999
 first_prior_star_anomaly_auc= 0.40365674537618873


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5083533014872158; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5936359743790058; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 70 
last prior star auc 0.5084463232350056 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5806815058870028; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5926365373986024; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 70 
last prior star auc 0.5807608895915483 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5528800974116538; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5944060091791751; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 300 
last prior star auc 0.5529538200416448 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5539320279924698; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5970122907075005; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 400 
last prior star auc 0.5540524544875338 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5843561865766658 at iter 180
0.5978888566379187 at iter 450
0.5844286225988038 at iter 180
last anomaly aucs:
0.5765060774208556
0.597510722589849
0.5765903502352434




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 103.9872236251831 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5788825707865908,first_prior_anomaly_auc= 0.5972950871136445, first_prior_star_anomaly_auc= 0.5789622118127069


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5788825707865909 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5853351664922027 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5789407254615577 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5788824421258055 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4810534127530629 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5788942789180553 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5788824421258056 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4003387123834462 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5788284045959691 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5788824421258055 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.40545104868832904 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5786633328083973 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5788824421258054 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.4288113441758351 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5788286619175398 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5788824421258055 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.4448790176903433 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5792676525170681 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5788825707865908 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.5810319778662278 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5801458910376955 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5788826994473761 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.599603518923943 iter_best_prior_anomaly= 740
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.581138637657262 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5788826994473762 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.5957218230306923 iter_best_prior_anomaly= 740
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5817134940460935 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5788826994473761 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.5964814363072501 iter_best_prior_anomaly= 740
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.582005554028781 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5788826994473762 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.5946089072376324 iter_best_prior_anomaly= 740
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5821532566103338 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5788824421258056 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.5930438774449409 iter_best_prior_anomaly= 740
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5821962293126324 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5788829567689469 at iter 44
max_prior_anomaly= 0.6042872861529087 at iter 74
max_prior_star_anomaly= 0.5822129552147246 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5788825707865908
accuracies_anomaly['prior'][-1]= 0.5932032881579584
accuracies_anomaly['prior_star'][-1]= 0.5822121832500127



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 129.2471959590912 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5788824421258055
 first_prior_anomaly_auc= 0.593245102913189
 first_prior_star_anomaly_auc= 0.5822178443245669


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.601059444370679; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5958206345138218; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.6037811346234407 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6092641426508445; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5906967187382597; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 60 
last prior star auc 0.6099803972427479 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6118862494557649; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5531469398804175; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 60 
last prior star auc 0.6120730649160566 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6123583058771217; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.504012929894282; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 60 
last prior star auc 0.6121664726462024 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6129383086973661 at iter 440
0.5963036271019313 at iter 60
0.6122247559819545 at iter 350
last anomaly aucs:
0.6127464754664469
0.5004513420349195
0.6120053893429758




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.06136965751648 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6127714356587999,first_prior_anomaly_auc= 0.5003996203992189, first_prior_star_anomaly_auc= 0.6122567925175004


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6127723362842971 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5955064448760585 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6132732127215668 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6127715643195851 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5938840323731122 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6132855641569579 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6127711783372292 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5937732554369474 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6133661058085713 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6127723362842971 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5937421195268989 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6133765273321826 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6127718216411558 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5949789356562266 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6134610574681411 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6127714356587999 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5956630250517989 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6134726369388203 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6127711783372292 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5957509003681757 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6134763681015947 iter_best_prior_star_anomaly= 660
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6127718216411557 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.5960577563411755 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6134496066582471 iter_best_prior_star_anomaly= 750
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6127710496764438 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.596777227452712 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6134732802427469 iter_best_prior_star_anomaly= 820
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6127722076235118 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.5882517778347316 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6132240643015726 iter_best_prior_star_anomaly= 820
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6127724649450824 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.5973690670652063 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6134113944050056 iter_best_prior_star_anomaly= 820
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6127723362842972 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.597130529969214 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.61340521868731 iter_best_prior_star_anomaly= 820
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.612772722266653 at iter 74
max_prior_anomaly= 0.5986879687755713 at iter 71
max_prior_star_anomaly= 0.6136019410280718 at iter 82
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6127716929803705
accuracies_anomaly['prior'][-1]= 0.5924207732616127
accuracies_anomaly['prior_star'][-1]= 0.613316957388577



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 129.88827872276306 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6127718216411558
 first_prior_anomaly_auc= 0.5974258064715346
 first_prior_star_anomaly_auc= 0.6134056046696661


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.613524873217662; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5949364775970695; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 80 
last prior star auc 0.6139244936168811 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6142857731020733; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5900994753727817; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 80 
last prior star auc 0.6140567569041951 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6157829986608986; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.592031574386005; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 80 
last prior star auc 0.6151423966107661 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6175649505376477; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5843085820860957; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 80 
last prior star auc 0.6156167689262589 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6206600143894222 at iter 490
0.6054011025714658 at iter 80
0.6172476730410366 at iter 490
last anomaly aucs:
0.6206600143894222
0.5725572205976655
0.6172476730410366




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.23063898086548 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6213114239455219,first_prior_anomaly_auc= 0.569965220416511, first_prior_star_anomaly_auc= 0.616968607797667


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.621296370633639 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5840064865621529 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.619359253849788 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6213078214435328 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5882607840897044 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6194251281718743 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.62130074510034 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.589782326536956 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.619622622477348 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6213089793906008 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.5910486059861232 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6198984712010843 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6213080787651035 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.5918950652927752 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6201376516010033 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6213037042984024 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.5934898157268769 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6203966457618623 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6213040902807584 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.6026499489988647 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6211516272501485 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6213110379631659 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.5972746300487779 iter_best_prior_anomaly= 770
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6208647136988741 iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6213148977867257 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.5967399158249678 iter_best_prior_anomaly= 850
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6209893859998539 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.621309880016098 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.6060172590723867 iter_best_prior_anomaly= 960
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6217932585865635 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6213049909062557 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.5992479005133051 iter_best_prior_anomaly= 1040
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6211576743070588 iter_best_prior_star_anomaly= 1040
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6213107806415953 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.6076540815832894 iter_best_prior_anomaly= 1160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6220745110632836 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6213183716279296 at iter 34
max_prior_anomaly= 0.60949212956244 at iter 123
max_prior_star_anomaly= 0.6221547953933263 at iter 123
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6213083360866741
accuracies_anomaly['prior'][-1]= 0.6014103023322599
accuracies_anomaly['prior_star'][-1]= 0.6214722499271781



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.20012593269348 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6213070494788208
 first_prior_anomaly_auc= 0.6003411312062102
 first_prior_star_anomaly_auc= 0.6210713429201058


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6261746729700158; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6060207329135904; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.62610300891259 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6279216291131566; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5987808618625758; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.6280402543572262 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6286019873459544; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.602694465630587; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.6300087643726964 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6292033478565628; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.600912513753838; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.630939367832951 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6297392200274408 at iter 490
0.6117054810523835 at iter 10
0.631292670349453 at iter 470
last anomaly aucs:
0.6297392200274408
0.5941668287792562
0.631220234327315




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.03561282157898 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6297931288964919,first_prior_anomaly_auc= 0.5964563474541118, first_prior_star_anomaly_auc= 0.631340660822379


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6297957021121984 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5976082474651252 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6303621955499837 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6297920996102093 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6090923805024357 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6309872296450918 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6297968600592663 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6166639390580178 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.630989288217657 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6297944155043451 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6165677007905948 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6306946550192631 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6297877251435082 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6186954928582972 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.630704947882089 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6297810347826713 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6230479585650515 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6311207795402589 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6297893977337174 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6206510081344495 iter_best_prior_anomaly= 620
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.630741358884336 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.629791198984712 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.623584860022212 iter_best_prior_anomaly= 780
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6309424556917987 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6297924855925652 iter_best_vanilla_star_anomaly= 880 
last prior auc 0.6231201372656187 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6310293017218931 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6297950588082718 iter_best_vanilla_star_anomaly= 990 
last prior auc 0.6260268417276776 iter_best_prior_anomaly= 940
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.630998423133415 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6297895263945028 iter_best_vanilla_star_anomaly= 990 
last prior auc 0.6232190774095334 iter_best_prior_anomaly= 940
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6308343806321259 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6297933862180626 iter_best_vanilla_star_anomaly= 990 
last prior auc 0.6042390383584119 iter_best_prior_anomaly= 1160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6291450645208106 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6297990472926169 at iter 99
max_prior_anomaly= 0.6278863760579776 at iter 116
max_prior_star_anomaly= 0.631340660822379 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6297866958572256
accuracies_anomaly['prior'][-1]= 0.6269283678504488
accuracies_anomaly['prior_star'][-1]= 0.6310808946968083



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.96648049354553 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6297972460416223
 first_prior_anomaly_auc= 0.6279751519998518
 first_prior_star_anomaly_auc= 0.6312849507023336


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6275824792830405; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5793570717628689; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6247527139706056 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6295819965477738; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5887105821952; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6282880550297618 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6292702514649318; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5872887518565751; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6287931772729471 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6292963696043525; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5877928448134778; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6296194368363033 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6299232049504553 at iter 490
0.6279751519998518 at iter 0
0.6312849507023336 at iter 0
last anomaly aucs:
0.6299232049504553
0.5856112725375098
0.6296508300679226




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.05414175987244 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6299818742685634,first_prior_anomaly_auc= 0.5783858114944516, first_prior_star_anomaly_auc= 0.629090512347833


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6299816169469927 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6066467962949811 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6304181629915999 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6299814882862074 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6045417771862813 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.630320380794753 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6299812309646368 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6046272079477369 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6306466645463369 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6299839328411285 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6082228909152104 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6310275004708985 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6299807163214954 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.610050131388394 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6311387920502045 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6299854767705526 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6107075880014039 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6314025466601204 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6299812309646368 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.6102352742584765 iter_best_prior_anomaly= 670
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6315785546144448 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6299803303391396 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.6115073434429832 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6315979823930289 iter_best_prior_star_anomaly= 780
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6299845761450553 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.6120204426548587 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6316686171641721 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6299813596254221 iter_best_vanilla_star_anomaly= 950 
last prior auc 0.6125590167022285 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6317079873644816 iter_best_prior_star_anomaly= 980
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6299795583744277 iter_best_vanilla_star_anomaly= 950 
last prior auc 0.6133506665143323 iter_best_prior_anomaly= 1090
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6317278011254216 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6299812309646368 iter_best_vanilla_star_anomaly= 950 
last prior auc 0.6129344488738064 iter_best_prior_anomaly= 1090
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6318523447656161 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6299858627529085 at iter 95
max_prior_anomaly= 0.6139145867364111 at iter 109
max_prior_star_anomaly= 0.6319520568742428 at iter 127
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6299805876607102
accuracies_anomaly['prior'][-1]= 0.6119454334170144
accuracies_anomaly['prior_star'][-1]= 0.6318397360086543



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.54821181297302 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6299847048058406
 first_prior_anomaly_auc= 0.6112232604289859
 first_prior_star_anomaly_auc= 0.6316606401954821


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6307109949389993; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5833683290669416; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6308116076731234 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6320715827438097; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5907030231167407; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.631604801414651 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.632206805229186; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.586704503230415; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6319681394724084 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6287233144665159; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5842308709717594; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.627778815641446 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6337228152626688 at iter 180
0.6112232604289859 at iter 0
0.63502833625136 at iter 330
last anomaly aucs:
0.6320672082771086
0.5908074956744244
0.6317968919671411




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.96292543411255 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6311681267092586,first_prior_anomaly_auc= 0.5937293821091516, first_prior_star_anomaly_auc= 0.6321777278917026


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6311683840308292 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6038642494907606 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6321324392952683 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6311678693876879 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6090737246885638 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.63308761696552 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6311674834053319 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.6094523733797748 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6334078536601935 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6311683840308292 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.6077941931785081 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6331964639899048 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6311678693876879 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.6075590012629343 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.633127630469756 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6311664541190493 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.6086373073047419 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6330644580241614 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6311679980484732 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.6093742762830825 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329881621784639 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6311674834053319 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.6084367251404204 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329388850976845 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6311679980484732 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.614143088291148 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6331908029153506 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6311683840308291 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.6120151675626604 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6334222636681499 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6311676120661173 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.6136823540188998 iter_best_prior_anomaly= 1020
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6334901965628014 iter_best_prior_star_anomaly= 1080
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6311681267092586 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.613740251372296 iter_best_prior_anomaly= 1140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6335708668752 iter_best_prior_star_anomaly= 1140
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6311692846563265 at iter 32
max_prior_anomaly= 0.6206546106364386 at iter 125
max_prior_star_anomaly= 0.6341310559345045 at iter 125
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6311682553700438
accuracies_anomaly['prior'][-1]= 0.6155921947162617
accuracies_anomaly['prior_star'][-1]= 0.6338545639068414



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.536527633667 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6311681267092586
 first_prior_anomaly_auc= 0.6149086199638308
 first_prior_star_anomaly_auc= 0.633642530932626


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40343339025286473; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.566535767183677; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.40331836751078437 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40269269011174963; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5595563055621601; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4024501645314123 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40171538278642205; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5676422499374709; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4016816736606669 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4001924250705319; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5685471212406604; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.39981866548916317 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6311681267092586 at iter 0
0.6149086199638308 at iter 0
0.633642530932626 at iter 0
last anomaly aucs:
0.3975121635906446
0.566054833168133
0.3970491134242605




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.02889966964722 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.3971349301680722,first_prior_anomaly_auc= 0.575408343600464, first_prior_star_anomaly_auc= 0.3967508777238775


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.39713557347199885 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5914159325282256 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3968230564244447 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3971344155249309 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5961511640713213 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39725214014350313 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3971353161504281 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5907883252174111 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39728494864376096 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3971341582033602 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5895565268587108 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39725574264549224 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.39713081302294173 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5891152203650467 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3972659068475329 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.39713428686414554 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5899165197360499 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3972810888202012 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.3971342868641455 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5928435526021901 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3972993586517173 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.39713428686414554 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5922109275207479 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3972846913221903 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.39713390088178957 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5926012843434234 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3972772289966415 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.39713364356021896 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5926549358909039 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3972862352516142 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.39713338623864824 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5933412125198266 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.397303990439989 iter_best_prior_star_anomaly= 1010
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.3971351874896428 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5944986449446089 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39728276141041036 iter_best_prior_star_anomaly= 1110
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.39713583079356946 at iter 11
max_prior_anomaly= 0.6009138003616912 at iter 17
max_prior_star_anomaly= 0.39735494011097766 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.3971349301680721
accuracies_anomaly['prior'][-1]= 0.5968607283023879
accuracies_anomaly['prior_star'][-1]= 0.39735494011097766



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.3599569797516 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.39713402954257493
 first_prior_anomaly_auc= 0.5942134039835437
 first_prior_star_anomaly_auc= 0.3972729831907257


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3911735613408306; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5616928465632646; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.39090440297793105 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.38199567288046793; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.54466819412751; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.3805019211628464 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5927314890581722; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5488579039408283; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5945718529314588 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6171662307639261; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 330 
last prior auc 0.550607947942817; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6102132732641858 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6199890483939531 at iter 470
0.5942134039835437 at iter 0
0.6161940698700115 at iter 480
last anomaly aucs:
0.6152967895531559
0.5475517396482106
0.6084849729349172




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.03347253799438 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6163381699495752,first_prior_anomaly_auc= 0.5481027937917569, first_prior_star_anomaly_auc= 0.6097407021996877


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6163376553064339 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5726429086806917 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6180032978332495 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6163376553064339 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.589203224342209 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6189618206839196 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6163379126280046 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5931139975729429 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6179942915782767 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6163376553064339 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.591294090764523 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.617303254500297 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6163373979848633 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5904697611129467 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6177078926701436 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6163376553064339 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5904894462131014 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6178496768555715 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.616338427271146 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5922930131017851 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6183905667970773 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6163376553064339 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5905504314253454 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6174539162799124 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6163373979848634 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.592962306507045 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6179564653073912 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6163384272711459 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5918217286451402 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.617725905180089 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6163384272711459 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5939281630224786 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6180128187313635 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6163381699495754 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5913057988959876 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6171336795852388 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6163389419142872 at iter 5
max_prior_anomaly= 0.5966043073572355 at iter 26
max_prior_star_anomaly= 0.6197124277055048 at iter 21
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6163386845927166
accuracies_anomaly['prior'][-1]= 0.5900723279470783
accuracies_anomaly['prior_star'][-1]= 0.6171680320149205



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.5131962299347 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6163379126280046
 first_prior_anomaly_auc= 0.590556607143041
 first_prior_star_anomaly_auc= 0.6174132594717496


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5964400075343756; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5744563824498454; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6098652458398821 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.563899893674727; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5831923211126173; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5882414849719056 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.524259763037712; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5669024504218529; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5395455649598012 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4769616137973768; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5619593030496723; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4895825935338177 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6163379126280046 at iter 0
0.590556607143041 at iter 0
0.6174132594717496 at iter 0
last anomaly aucs:
0.4334816020223417
0.5533064792542204
0.4382345887538122




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.7418155670166 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4291652899962637,first_prior_anomaly_auc= 0.5577558265323243, first_prior_star_anomaly_auc= 0.43425343807350547


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42916477535312236 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.586744516734651 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4323788504313224 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4291652899962637 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5920816234314964 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44035929296266674 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42916426070998104 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5828570311060608 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.44828441135632136 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42916400338841043 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5795899477843068 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4486234325256524 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4291637460668398 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.583708636844126 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45197401669708204 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.42916451803155176 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.584758251530806 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45292649249084194 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.42916477535312236 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5855532465233282 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45247373518728373 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4291642607099811 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5923080664136682 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4554716601461381 iter_best_prior_star_anomaly= 720
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.42916400338841043 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5925439016331685 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45549044462079546 iter_best_prior_star_anomaly= 720
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.42916426070998115 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5912482875249474 iter_best_prior_anomaly= 970
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45566413668098404 iter_best_prior_star_anomaly= 720
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4291640033884105 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5943681829082895 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45643275621251467 iter_best_prior_star_anomaly= 1040
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.42916477535312236 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5920351768879941 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45659615540987725 iter_best_prior_star_anomaly= 1040
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.42916554731783435 at iter 3
max_prior_anomaly= 0.5957588773368659 at iter 108
max_prior_star_anomaly= 0.4579209755163672 at iter 104
last values
accuracies_anomaly['vanilla_star'][-1]= 0.42916374606683977
accuracies_anomaly['prior'][-1]= 0.5344132862331931
accuracies_anomaly['prior_star'][-1]= 0.42843475405718917



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.45566964149475 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.42916400338841043
 first_prior_anomaly_auc= 0.5555310242324869
 first_prior_star_anomaly_auc= 0.4388022401386654


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.41135735069945156; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5329788471376062; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.4055930901953276 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.39419425925868745; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.521748304508171; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.38833659102441775 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.38825836526694024; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.523599475887425; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.3811161477519873 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.389960547456788; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5588282141780068; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 400 
last prior star auc 0.3874156371230625 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.4293370521446723 at iter 10
0.5651549796355709 at iter 480
0.4388022401386654 at iter 0
last anomaly aucs:
0.38460787280491837
0.5645295595581068
0.3820543421985761




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.7164237499237 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.38415434353664824,first_prior_anomaly_auc= 0.5561925979906273, first_prior_star_anomaly_auc= 0.3794875595313454


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3841544721974336 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5764459928341089 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3838608682853223 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.38415421487586293 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5885349602232317 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38381133388297217 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.38415485817978956 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5831036738315285 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3832959187769609 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.38415485817978956 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5863593063433884 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3835971136754064 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.3841546008582189 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5868825697573047 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38390551357783 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.38415408621507763 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5893396047746532 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3847219949215015 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.3841547295190042 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.5885156611054329 iter_best_prior_anomaly= 610
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38437280955012987 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.38415498684057486 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.587503358046497 iter_best_prior_anomaly= 610
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3840309578435217 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.3841542148758629 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.5876219832905665 iter_best_prior_anomaly= 610
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38405231553388564 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.3841552441621455 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.5879070955908463 iter_best_prior_anomaly= 610
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3837979531612984 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.38415460085821884 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.5891112318807016 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3840647956300622 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.38415421487586293 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.5881684056458412 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38372706106858445 iter_best_prior_star_anomaly= 1170
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.38415550148371613 at iter 64
max_prior_anomaly= 0.5904477601186562 at iter 108
max_prior_star_anomaly= 0.38615411812295236 at iter 122
last values
accuracies_anomaly['vanilla_star'][-1]= 0.3841546008582189
accuracies_anomaly['prior'][-1]= 0.5885385627252206
accuracies_anomaly['prior_star'][-1]= 0.3841509983562298



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.84392523765564 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.3841551155013602
 first_prior_anomaly_auc= 0.5881022740021841
 first_prior_star_anomaly_auc= 0.384066725541842


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.37966704132687346; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5838330518235351; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 20 
last prior star auc 0.3798465231224017 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.37895271664674995; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.584582372237267; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 180 
last prior star auc 0.3778726093539479 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.37850214657654235; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5916376150613403; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 180 
last prior star auc 0.37719714023099243 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.37807126160648946; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5919961926700407; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 350 
last prior star auc 0.37712444688728397 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.3841551155013602 at iter 0
0.5995331414743703 at iter 350
0.384066725541842 at iter 0
last anomaly aucs:
0.37764256386978706
0.5897793673388936
0.3761859951191245




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.77916383743286 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.3784055223267634,first_prior_anomaly_auc= 0.5927626249682207, first_prior_star_anomaly_auc= 0.3769376314269922


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3784050076836221 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5759407419301382 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3779943224568652 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3784053936659781 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.58576978262503 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37805633695539176 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.37840590830911935 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5907565460034357 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37831288656132944 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3784060369699047 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5919295463832424 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37783555504777433 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.3784062942914754 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5928804782475784 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3779512210937813 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.3784052650051927 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5944967150328291 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3780571089201037 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.37840539366597803 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5938755407612808 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37798570218424843 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.3784052650051927 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5936135874023593 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3778988561541542 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.3784066802738313 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5926106765807522 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37774587848040286 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.3784051363444074 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5965453807175566 iter_best_prior_anomaly= 950
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3775010370059297 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.37840616563069 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5972207211797268 iter_best_prior_anomaly= 950
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37783529772620367 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.37840565098754875 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5967193300993159 iter_best_prior_anomaly= 950
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37737173291667825 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.37840680893461665 at iter 8
max_prior_anomaly= 0.5997370688191102 at iter 95
max_prior_star_anomaly= 0.37960232495185514 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.3784062942914753
accuracies_anomaly['prior'][-1]= 0.5980580455706209
accuracies_anomaly['prior_star'][-1]= 0.37794247216037924



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 132.02045035362244 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.37840590830911935
 first_prior_anomaly_auc= 0.5970440699214757
 first_prior_star_anomaly_auc= 0.3776291831481132


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.380837983134115; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5922931417625704; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 40 
last prior star auc 0.3816125210617705 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.38127388587479555; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6022287135877111; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 200 
last prior star auc 0.38245370527622446 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3790663241201918; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5952856629684411; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 200 
last prior star auc 0.37990853762092824 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3780716475888454; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5781079041981501; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 200 
last prior star auc 0.377769680725688 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.38127388587479555 at iter 200
0.6022287135877111 at iter 200
0.38245370527622446 at iter 200
last anomaly aucs:
0.3782292570508684
0.5825515904016996
0.3779229157210099




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.80027103424072 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.37846213307230636,first_prior_anomaly_auc= 0.5920248840251681, first_prior_star_anomaly_auc= 0.37873463661562434


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3784618757507357 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5752948647878076 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37817213166218416 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.37846213307230636 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5858423473079533 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3781493587031816 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.37846239039387697 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5985356344057466 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37865898407385334 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.37846213307230636 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6017863778077643 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.378543189367061 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.3784618757507357 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5995901382022691 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.378355859263628 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.37846213307230636 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.6002145289934506 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3785128254217243 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.37846213307230636 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.6010198168487989 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3784155578680187 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.37846161842916504 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.6019726786249147 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37849352630392563 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.378462390393877 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.5965895113669231 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3780226278296367 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.3784618757507357 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.5968737230417056 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3780241717590606 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.37846213307230636 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.598714730218919 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3781144916303586 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.37846226173309166 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.6020974795866798 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3782941020866721 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.3784629050370183 at iter 52
max_prior_anomaly= 0.6027288180602688 at iter 128
max_prior_star_anomaly= 0.37900353765695327 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.37846187575073564
accuracies_anomaly['prior'][-1]= 0.6018144258589652
accuracies_anomaly['prior_star'][-1]= 0.3782562758157866



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.9375457763672 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.378462004411521
 first_prior_anomaly_auc= 0.5953005876195387
 first_prior_star_anomaly_auc= 0.37784906443023347


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.37693544419364167; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5683994186591076; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.37559608541841005 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3771240609049279; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5747093295537942; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.3752012254682481 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.37611896284997026; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5718777629903649; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.37482463534960225 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3763150418868053; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5706172732765373; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.37478822434735526 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.378462004411521 at iter 0
0.5953005876195387 at iter 0
0.37784906443023347 at iter 0
last anomaly aucs:
0.3763533828008321
0.5730937360724699
0.3751599253561588




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.06977677345276 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.37607804872023687,first_prior_anomaly_auc= 0.5606805435043287, first_prior_star_anomaly_auc= 0.37400699605886284


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.37607766273788096 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5793330121960132 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37589573638743157 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.37607804872023687 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5862071006343492 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37591632211308357 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.37607727675552494 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5757209893088033 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3748404606261972 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.37607779139866626 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5817078329715392 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3753071132945704 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.3760777913986662 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5823853606670598 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3751383103442242 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.37607792005945156 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5834591635813811 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37511425077736843 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.3760775340770956 iter_best_vanilla_star_anomaly= 620 
last prior auc 0.5828644934316096 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37511952586956676 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.3760777913986662 iter_best_vanilla_star_anomaly= 620 
last prior auc 0.5825768079156233 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3749873912430382 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.3760775340770956 iter_best_vanilla_star_anomaly= 620 
last prior auc 0.582179889392896 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37491032343262853 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.37607727675552494 iter_best_vanilla_star_anomaly= 620 
last prior auc 0.5837665341975221 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3750397561826654 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.37607792005945156 iter_best_vanilla_star_anomaly= 620 
last prior auc 0.5855744755529069 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3751985235917563 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.37607753407709554 iter_best_vanilla_star_anomaly= 620 
last prior auc 0.5872618617524422 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37531380365540734 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.3760783060418076 at iter 62
max_prior_anomaly= 0.5881509077790369 at iter 122
max_prior_star_anomaly= 0.3767281716684834 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.3760777913986662
accuracies_anomaly['prior'][-1]= 0.5825814397038949
accuracies_anomaly['prior_star'][-1]= 0.37491701379346554



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.1932668685913 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.37607804872023687
 first_prior_anomaly_auc= 0.5826956904812634
 first_prior_star_anomaly_auc= 0.3749386288054001


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3776217208225644; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.584075448743087; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 90 
last prior star auc 0.37700929548441814 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.37748688431954397; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5732718025993596; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 90 
last prior star auc 0.37642980730731507 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.37765234208947174; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5734303126868798; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 90 
last prior star auc 0.37690945471500603 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3777699380472586; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5760308044798657; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 90 
last prior star auc 0.37703554228462444 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.37812825833438835 at iter 90
0.5932327514777977 at iter 90
0.3779927785274413 at iter 90
last anomaly aucs:
0.3780545357043972
0.5819877988404061
0.37756613936330413




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.54604148864746 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.37787646917750767,first_prior_anomaly_auc= 0.5793407318431326, first_prior_star_anomaly_auc= 0.37721618202722046


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3778764691775076 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5864294264713905 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37784018683604603 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3778764691775076 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5933105912529193 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37785459684400247 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.377876211855937 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5889686757305617 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37759753259492335 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3778764691775076 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5975325949233542 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3778046764592964 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.37787646917750767 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5976037443376389 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37777032402961463 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.3778767264990782 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5948451284394888 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3774951186098048 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.37787646917750767 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.592489864103332 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37729054796113826 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.37787646917750767 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.5917979263998551 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37725001981376094 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.3778764691775076 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.5908126421058374 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3771388568952403 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.3778764691775076 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.5966767433793734 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3773919326599743 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.3778764691775076 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.5915866653903517 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3770442912180265 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.3778764691775076 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.5960227606075671 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37730547261223596 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.37787685515986363 at iter 64
max_prior_anomaly= 0.5980979304140717 at iter 45
max_prior_star_anomaly= 0.37839085499723635 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.3778764691775076
accuracies_anomaly['prior'][-1]= 0.5958138154921996
accuracies_anomaly['prior_star'][-1]= 0.37726224258836677



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 133.29877543449402 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.3778767264990783
 first_prior_anomaly_auc= 0.59148901185429
 first_prior_star_anomaly_auc= 0.3769977160137389


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.37738318372657215; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5738170670075663; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.37611098588128006 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.37766791004449607; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.5674088592728916; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.37590178344434194 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3955282142809355; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5740599785702597; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.3955674558204596 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.39276393730823106; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5658164247329259; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.3925754492577302 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.3970811499598063 at iter 220
0.59148901185429 at iter 0
0.3972183023569626 at iter 220
last anomaly aucs:
0.3877941571534882
0.5740822368861207
0.3878245210988248




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.5528028011322 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.38693135792709976,first_prior_anomaly_auc= 0.5812763046975596, first_prior_star_anomaly_auc= 0.38731296581637326


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3869312292663144 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5635209876619454 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3868542901166902 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3869314865878851 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5725663555134234 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38685609136768473 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.38693148658788507 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.5864540006813875 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38688362477574423 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3869318725702411 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.6034898466054653 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38692556819176016 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.3869316152486704 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.6074676521053536 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3868997073739099 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.3869312292663144 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.5965703409099097 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38692672613882806 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.38693122926631446 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.594069689886336 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3869550315115996 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.3869317439094558 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.594777066884052 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3870315846788678 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.38693161524867037 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.5916428901535387 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38703338592986236 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.3869309719447438 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.5914448812049237 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3870811190812179 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.3869316152486704 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.5852074063323751 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.38697317268233034 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.3869317439094557 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.5908458365884512 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3870879381028401 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.3869321298918117 at iter 53
max_prior_anomaly= 0.6110545861394251 at iter 45
max_prior_star_anomaly= 0.38731296581637326 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.38693135792709976
accuracies_anomaly['prior'][-1]= 0.584540428821251
accuracies_anomaly['prior_star'][-1]= 0.3869855241177216



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 133.80197024345398 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40365726001933006
accuracies_anomaly["prior"][-1]= 0.5112422507608999
accuracies_anomaly["prior_star"][-1]= 0.40365674537618873


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 3545.8495643138885 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004742145538330078 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40468680362349946
 first_prior_anomaly_auc= 0.5158926948464665
 first_prior_star_anomaly_auc= 0.4046846163901489


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.513697484527254; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5950181771957507; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.5137777688572966 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5841245971630812; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5938850616593948; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 60 
last prior star auc 0.5842079693519717 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5517082549789151; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5940446010331976; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 60 
last prior star auc 0.5518044932463381 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5559130181041163; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5976445298065869; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 400 
last prior star auc 0.5559947177027977 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5897295756149729 at iter 490
0.5981640620577284 at iter 430
0.5898276151333903 at iter 490
last anomaly aucs:
0.5897295756149729
0.5960297082899746
0.5898276151333903




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.5115897655487 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.593952479910905,first_prior_anomaly_auc= 0.595447646897165, first_prior_star_anomaly_auc= 0.5940660873843469


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5939524799109049 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5949080435635126 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5940654440804203 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5939524799109049 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5944487245599029 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5940610696137192 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5939524799109049 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5938409310100282 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5940564378254475 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5939524799109049 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5936278687495306 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5940500047861812 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5939524799109049 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5932319795130858 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5940456303194801 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.593952479910905 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5929466098912353 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5940434430861297 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.593952479910905 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5929040231712929 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5940415131743497 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.593952479910905 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5925100638466281 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5940357234390101 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.593952479910905 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.591083730380517 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.594032506919377 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5939527372324758 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5895639891842597 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5940294190605292 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.593952479910905 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5876308608847539 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5940271031663934 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.593952479910905 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5833786219297676 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5940227286996923 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5939529945540463 at iter 7
max_prior_anomaly= 0.595447646897165 at iter 0
max_prior_star_anomaly= 0.5940664733667027 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.593952479910905
accuracies_anomaly['prior'][-1]= 0.5814734130206772
accuracies_anomaly['prior_star'][-1]= 0.5940180969114206



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 133.71771550178528 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.593952479910905
 first_prior_anomaly_auc= 0.5812591928131114
 first_prior_star_anomaly_auc= 0.594018225572206


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6069809283544697; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5706081383607793; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6070042159566136 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6112554256253171; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5632263544635514; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6112744674215452 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6174950877312162; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5563867471156825; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6175176033686481 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6209483432093353; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5498419016269928; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6209640398251448 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6248472796478194 at iter 490
0.5812591928131114 at iter 0
0.624867736712686 at iter 490
last anomaly aucs:
0.6248472796478194
0.5464846270947262
0.624867736712686




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.46316957473755 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6253574196616325,first_prior_anomaly_auc= 0.5462489205360112, first_prior_star_anomaly_auc= 0.6253762041362899


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6253563903753498 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5419131807313491 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6253772334225725 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6253572910008471 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5362421992965857 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6253745315460806 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6253565190361352 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5266661057056427 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6253718296695888 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6253569050184912 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5134875101256038 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6253736309205833 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6253565190361351 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4964436872328359 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.625370285740165 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6253565190361352 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.47513012751827755 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6253674552028877 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6253569050184911 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.45717268438891784 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6253697710970236 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6253566476969205 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.44358327492133676 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6253646246656106 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6253563903753498 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.43113495795880186 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6253632093969721 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6253566476969206 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4215085580007966 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6253617941283336 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6253570336792764 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.40450487727305007 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.625358448947915 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6253571623400618 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.39897915386491856 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6253575483224177 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6253575483224177 at iter 54
max_prior_anomaly= 0.5462489205360112 at iter 0
max_prior_star_anomaly= 0.6253785200304257 at iter 12
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6253566476969205
accuracies_anomaly['prior'][-1]= 0.3921358153542752
accuracies_anomaly['prior_star'][-1]= 0.6253578056439884



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 133.84222745895386 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6253570336792764
 first_prior_anomaly_auc= 0.39170544502736354
 first_prior_star_anomaly_auc= 0.6253569050184912


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6301006281734183; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.39047802113536456; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6300956104027906 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6325083861099874; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.3895194982846944; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6325051695903543 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6334510836840626; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.3888787675737767; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6334531422566279 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6341565307699988; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.38843810438403903; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6341576887170666 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6354535601468585 at iter 490
0.39170544502736354 at iter 0
0.6354583205959157 at iter 490
last anomaly aucs:
0.6354535601468585
0.38821114675872603
0.6354583205959157




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.55242276191711 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6355431080534447,first_prior_anomaly_auc= 0.388196093446843, first_prior_star_anomaly_auc= 0.6355459385907218


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6355437513573714 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.38275271294131935 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6355418214455915 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6355431080534446 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.38053447234153365 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.635537704300461 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6355423360887328 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.3784479803859206 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6355355170671104 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6355434940358007 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.3781362353030785 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6355323005474773 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6355429793926594 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.37833501621640536 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6355312712611947 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6355425934103034 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.378179593987733 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6355250955434992 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6355418214455915 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.37893560476230176 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6355259961689964 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6355433653750154 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.38282051717518556 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6355209783983687 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.635543622696586 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.38529710863190353 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6355137733943906 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6355418214455915 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.3864913380412888 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6355204637552274 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.635542850731874 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.38781615814777876 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6355211070591541 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6355437513573714 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.3892988450378623 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.635518276521877 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6355441373397274 at iter 27
max_prior_anomaly= 0.39004147509075726 at iter 129
max_prior_star_anomaly= 0.6355469678770044 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6355431080534446
accuracies_anomaly['prior'][-1]= 0.39004147509075726
accuracies_anomaly['prior_star'][-1]= 0.6355185338434476



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 133.9984540939331 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.63554323671423
 first_prior_anomaly_auc= 0.3900591016183468
 first_prior_star_anomaly_auc= 0.6355164752708824


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6366907622585423; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.3895758517086667; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6366421284816896 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6376232956305767; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.3890416521279979; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6376091429441911 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6383567907677138; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.3886183581442792; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6383515156755154 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6385239211278507; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 330 
last prior auc 0.3886399731562137; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6385073238865439 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6387669613513294 at iter 490
0.3900591016183468 at iter 0
0.6387504927708078 at iter 490
last anomaly aucs:
0.6387669613513294
0.3877372890863746
0.6387504927708078




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.50643706321716 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6387507500923784,first_prior_anomaly_auc= 0.3876860820938154, first_prior_star_anomaly_auc= 0.6388007991378698


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6387506214315932 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.3900472648260969 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.638824215400799 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6387507500923784 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.39147372695299354 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6388543220245649 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6387507500923785 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.39270179414891915 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6388894464189587 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6387515220570903 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.3937398293649201 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6389099034838253 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6387512647355198 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.39436036033254174 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.638940653411518 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6387512647355198 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.3967625858553421 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6389724326254931 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6387512647355198 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.39780782607532106 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6389984221041288 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6387512647355198 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.39837715005038354 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6390262128337589 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6387507500923785 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.400796487457632 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6390522023123946 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6387511360747344 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.40258680228542726 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6390767765223916 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6387513933963052 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4033863004054359 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6390923444774159 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6387515220570904 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.40354905629887183 iter_best_prior_anomaly= 1130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6391012220716034 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.638751779378661 at iter 123
max_prior_anomaly= 0.4036180184798059 at iter 113
max_prior_star_anomaly= 0.6391148601148477 at iter 127
last values
accuracies_anomaly['vanilla_star'][-1]= 0.638751393396305
accuracies_anomaly['prior'][-1]= 0.40237811449163036
accuracies_anomaly['prior_star'][-1]= 0.6391112576128586



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 133.4983775615692 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.638751393396305
 first_prior_anomaly_auc= 0.40223620164541707
 first_prior_star_anomaly_auc= 0.6391085557363668


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6385486239986331; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4041159357190131; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6388558659539889 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6372203300509394; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4061945793667213; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6375984640990091 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6359252305858595; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4079465532804898; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6363139148183258 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6346393946973229; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4109635200355721; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6350018321295829 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6390735600027585 at iter 10
0.41211503406422956 at iter 490
0.6393828605306795 at iter 10
last anomaly aucs:
0.6335025479981926
0.41211503406422956
0.6339040983091914




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.49765658378601 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6333857240051177,first_prior_anomaly_auc= 0.4122626079849971, first_prior_star_anomaly_auc= 0.6337647586786845


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.633387396595327 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4086647377841731 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6336806145250822 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6333864959698297 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4070120899966754 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6336703216622561 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6333868819521855 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.40589145455649595 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.633682930419218 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6333866246306149 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.40434816843652444 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6336945098898972 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6333877825776828 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.40320180083928003 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6337094345409949 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6333877825776828 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.40336764459156377 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6337113644527748 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6333863673090443 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.4032748801653445 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6337208853508889 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6333877825776828 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.403686594678384 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6337238445489514 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6333857240051176 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.40546520137471476 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6337264177646578 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6333858526659031 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.4078739885975665 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6337300202666469 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6333868819521855 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.40948495029061893 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6337395411647609 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6333863673090442 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.4116339713878999 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6337461028648125 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6333885545423948 at iter 63
max_prior_anomaly= 0.4144823925142067 at iter 129
max_prior_star_anomaly= 0.6337647586786845 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.633385852665903
accuracies_anomaly['prior'][-1]= 0.4144823925142067
accuracies_anomaly['prior_star'][-1]= 0.6337392838431902



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 134.55416584014893 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6333877825776828
 first_prior_anomaly_auc= 0.41466689208036256
 first_prior_star_anomaly_auc= 0.6337444302746033


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6321095376754804; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42012519723698394; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6324986078903028 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6311022523871722; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4266588492373503; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6315610567476406 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6302597815648652; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4348656060900811; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6306452492776984 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6296564911424769; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44406832608201147; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6300051618707072 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6333877825776828 at iter 0
0.4548975757220186 at iter 490
0.6337444302746033 at iter 0
last anomaly aucs:
0.6287822411061945
0.4548975757220186
0.6294741788096716




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.45864033699036 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6286706922053179,first_prior_anomaly_auc= 0.45602117036026046, first_prior_star_anomaly_auc= 0.6293527230283249


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6286718501523858 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.43523795040281116 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6291320697814928 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6286690196151087 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4375313289012266 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6291213909363109 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6286704348837473 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4421622165474239 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.629109940126417 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6286706922053179 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4477053091615743 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6291141859323326 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6286722361347419 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.45239049165917855 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6291042790518627 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6286710781876739 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4583088877841216 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6291082675362079 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6286721074739565 iter_best_vanilla_star_anomaly= 670 
last prior auc 0.46500722558970387 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6291167591480391 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6286721074739565 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4720983647728829 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6291179170951071 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6286713355092446 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.47836054251621385 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6291091681617049 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6286728794386685 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.48460728096530586 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6291212622755256 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6286724934563124 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4917756166196797 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.629128981922645 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6286712068484592 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4975730716064175 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6291248647775146 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.628673522742595 at iter 78
max_prior_anomaly= 0.5029132661621105 at iter 129
max_prior_star_anomaly= 0.6293527230283249 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6286715928308151
accuracies_anomaly['prior'][-1]= 0.5029132661621105
accuracies_anomaly['prior_star'][-1]= 0.6291486670227997



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 133.59360027313232 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6286737800641657
 first_prior_anomaly_auc= 0.5036153680676283
 first_prior_star_anomaly_auc= 0.6291494389875117


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.628304780931854; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5071741253897135; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6286929505211791 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6276267385931921; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5118072002692613; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6281289016383149 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6274107171346317; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5173101507183904; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6276910689858545 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6271542961894793; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5224464179293435; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6276415345835045 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6286737800641657 at iter 0
0.5267523084318103 at iter 490
0.6291494389875117 at iter 0
last anomaly aucs:
0.626936344819139
0.5267523084318103
0.6275566184651901




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.5426754951477 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6268407498556426,first_prior_anomaly_auc= 0.5271700700017601, first_prior_star_anomaly_auc= 0.6275270264845653


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6268376619967948 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5174240155134029 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6273306901261596 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6268390772654334 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.52376390437107 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6273707036303957 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6268385626222921 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5295061638809033 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6274180507993952 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6268394632477894 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5349579073374731 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6274626960919029 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6268390772654333 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5408724436388563 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6274778780645712 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6268368900320829 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.546843333364212 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6274753048488648 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6268394632477894 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5531484838098415 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6274812232449896 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6268379193183655 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.558704699824095 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6274898435176064 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6268395919085746 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5633614482881426 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6275074700451959 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6268380479791508 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5679839729832937 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6275160903178127 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.626841264498784 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5714731248205182 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.62752689782378 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6268381766399361 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5744873896991087 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6275494134612117 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6268437090537051 at iter 25
max_prior_anomaly= 0.5774078608651975 at iter 129
max_prior_star_anomaly= 0.6275649814162362 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6268375333360094
accuracies_anomaly['prior'][-1]= 0.5774078608651975
accuracies_anomaly['prior_star'][-1]= 0.6275649814162362



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 133.14399528503418 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6268375333360094
 first_prior_anomaly_auc= 0.5776900139674149
 first_prior_star_anomaly_auc= 0.6275719290986437


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6267146622860242; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5761402948081771; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.627148635114925 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6263266213574845; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5745057881914102; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6268783188049575 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6258532783282744; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5723850724669007; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6263268786790552 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6252357065587151; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5700134682110078; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6255389600297259 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6268375333360094 at iter 0
0.5776900139674149 at iter 0
0.6275719290986437 at iter 0
last anomaly aucs:
0.6240948713752397
0.5677952276112221
0.6247101272506632




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.51335000991821 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6237941911199356,first_prior_anomaly_auc= 0.5675361047895779, first_prior_star_anomaly_auc= 0.6245720742280096


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6237980509434953 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5674149063298018 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6243103781906588 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6237949630846475 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5742893807504937 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6245083871392737 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6237935478160089 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5778091538546257 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6245821097692649 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6237925185297263 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5803679595531662 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6246172341636586 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6237932904944382 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5833298594921296 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6246182634499412 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6237970216572126 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5863387206177364 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.624641551052085 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6237934191552235 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5885761316745356 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6246578909718212 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6237931618336529 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5901897952440798 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.624661750795381 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6237944484415061 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5915337858075832 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6246955885819214 iter_best_prior_star_anomaly= 860
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6237918752257996 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5922568594211088 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6247251805625461 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6237941911199355 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.592895402898676 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.624730712976315 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6237948344238622 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5934894297445209 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6247606909392958 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6237980509434953 at iter 10
max_prior_anomaly= 0.5939250751636308 at iter 129
max_prior_star_anomaly= 0.624771498445263 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6237974076395687
accuracies_anomaly['prior'][-1]= 0.5939250751636308
accuracies_anomaly['prior_star'][-1]= 0.624771498445263



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 134.04074001312256 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6237952204062182
 first_prior_anomaly_auc= 0.5939424443696496
 first_prior_star_anomaly_auc= 0.6247677672824887


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.62050073233719; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5915288966977408; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6218138443122154 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6146295547204612; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5876077019433954; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6160675963180371 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.603767367919411; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5824393981968963; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6054452332208324 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5842059107794064; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5769409508752535; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5870679699489577 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6237952204062182 at iter 0
0.5939424443696496 at iter 0
0.6247677672824887 at iter 0
last anomaly aucs:
0.5459909556614349
0.5734770165519527
0.5506309782233901




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.67815589904785 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5390850880091236,first_prior_anomaly_auc= 0.5732244554303599, first_prior_star_anomaly_auc= 0.5449722195632326


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5390854739914795 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5698638357176751 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5445032510007236 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.539084830687553 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5754738319401944 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5455457893442108 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5390859886346209 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5781322210865764 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5464830831653023 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5390852166699089 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.5803042724644304 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5471123630663262 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5390865032777622 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.5826488579554051 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5474789176437167 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5390867605993328 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.5838511929942658 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5481531001588188 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5390863746169768 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.5844605304735643 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5485470594834836 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5390866319385476 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.5852457472464019 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5487539460262859 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5390865032777621 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.5857421205561851 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5489694528417051 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5390871465816888 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.5862099311716262 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5491614147334096 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5390857313130503 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.5866787710733501 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5492796539951232 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5390877898856155 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.5873757265474547 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5495026231360912 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5390886905111127 at iter 56
max_prior_anomaly= 0.5878044242841571 at iter 129
max_prior_star_anomaly= 0.5496036218525712 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5390836727404851
accuracies_anomaly['prior'][-1]= 0.5878044242841571
accuracies_anomaly['prior_star'][-1]= 0.5496036218525712



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 134.32841515541077 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5390867605993328
 first_prior_anomaly_auc= 0.5878363321589177
 first_prior_star_anomaly_auc= 0.5496127567683292


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4503952202003608; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5780970966921827; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.46543257814598776 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3969778353491905; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5724582804537506; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.3952678048514379 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3801513205228363; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5690450384798676; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.3783953581247227 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.373477942909607; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5664373416829037; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.37174320954107215 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5390867605993328 at iter 0
0.5878363321589177 at iter 0
0.5496127567683292 at iter 0
last anomaly aucs:
0.3698432757241801
0.5650063764285207
0.3689833070350688




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.69483160972595 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.3696160607772964,first_prior_anomaly_auc= 0.5649107814650243, first_prior_star_anomaly_auc= 0.3688549035713147


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3696134875615899 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5620753550780353 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3689983603469519 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3696221078342067 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5635671768838769 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.368950112552455 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3696245523891279 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5663797016510782 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3689128009247108 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3696231371204893 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5672332373009231 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3688695709008416 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.3696228797989186 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5679820430715138 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3688431954398501 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.36961078568509803 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.568882797229573 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3688172059612144 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.36961490283022846 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5693275775644411 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3687843974609566 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.36961220095373665 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5698630637529631 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36876767155886436 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.36960422398504655 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5701820138397833 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36875789333917963 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.36961348756158996 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5706287240864313 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36871093215253614 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.36961323024001924 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.570987044373561 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36870771563290294 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.36961889131457354 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5714030046925161 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3686777376699223 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.3696248097106985 at iter 122
max_prior_anomaly= 0.5715342386935475 at iter 129
max_prior_star_anomaly= 0.3690855923594021 at iter 7
last values
accuracies_anomaly['vanilla_star'][-1]= 0.3696163180988671
accuracies_anomaly['prior'][-1]= 0.5715342386935475
accuracies_anomaly['prior_star'][-1]= 0.3686655148953164



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 134.303729057312 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.36961310157923394
 first_prior_anomaly_auc= 0.5715687197840146
 first_prior_star_anomaly_auc= 0.36867876695620494


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3683091245199666; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5675126885266487; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.36730788628856864 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.36757035429063134; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5664680916105963; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.36677175679612006 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.36743165796405114; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.565909961123857; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.36689128266568677 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.367369386143954; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5660002809951552; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.36677793251381563 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.36961310157923394 at iter 0
0.5715687197840146 at iter 0
0.36867876695620494 at iter 0
last anomaly aucs:
0.3675320133766045
0.5664939524284466
0.36684161960255135




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.60233855247498 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.36751207095487914,first_prior_anomaly_auc= 0.5665571248740411, first_prior_star_anomaly_auc= 0.36683351397307595


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.36752133453142255 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5641561859590941 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36688690819898573 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.36750538059404225 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5649534968457522 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36688587891270313 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3675084684528901 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5659088031767893 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3668604040772089 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3675217205137785 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5668897130041057 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36683184138286673 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.36751914729807206 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.5673634420156719 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36683145540051076 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.3675115563117379 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.5680313201522933 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.366863234614486 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.3675161881000096 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.5686533950493389 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3668411049594101 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.3675121996156645 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.5690066975658409 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3668017347591007 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.3675123282764498 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.5693149688074792 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36680649520815767 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.36752030524514 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.5692876927209902 iter_best_prior_anomaly= 920
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36678102037266336 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.36752030524514 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.5693759540197232 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36676493777449776 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.3675123282764498 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.5691176031627909 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36676892625884283 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.36752686694519154 at iter 73
max_prior_anomaly= 0.5694101777886196 at iter 108
max_prior_star_anomaly= 0.3671489902186924 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.36751322890194704
accuracies_anomaly['prior'][-1]= 0.5692752126248138
accuracies_anomaly['prior_star'][-1]= 0.3667169473015716



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 130.36684393882751 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.367514772831371
 first_prior_anomaly_auc= 0.5692215610773333
 first_prior_star_anomaly_auc= 0.366727368825183


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.36766659255805434; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5689718304930179; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.36678397957072584 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3675450081159224; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5701544804317239; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 200 
last prior star auc 0.3667330298997372 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3677569124293524; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5709453582791156; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 300 
last prior star auc 0.36698764959389507 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.36771085186820607; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.5715531518289902; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 400 
last prior star auc 0.3670550678454053 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.3681551175599328 at iter 490
0.5725076861953153 at iter 490
0.3677590996627029 at iter 490
last anomaly aucs:
0.3681551175599328
0.5725076861953153
0.3677590996627029




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.28454303741455 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.36816541042275874,first_prior_anomaly_auc= 0.5726426513591211, first_prior_star_anomaly_auc= 0.3677709364549528


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3681660537266854 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5689808367479905 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3678163537121725 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3681683696208212 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.570507010983514 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3677980838806563 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.368176603911082 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5710493161936582 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36781223656704204 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3681657964051147 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.5717343062147278 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.367788048339401 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.36817055685417177 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.572204947367446 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36778264458641735 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.36816425247569085 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.5727846928661198 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36777518226086847 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.36816631104825603 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.573150346818013 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.367768234578461 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.36817055685417177 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.5732654982208787 iter_best_prior_anomaly= 790
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3677530526057926 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.36816695435218266 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.573553183736865 iter_best_prior_anomaly= 870
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3677545965352165 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.368172229444381 iter_best_vanilla_star_anomaly= 980 
last prior auc 0.5737344667833877 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36773787063312424 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.3681730014090929 iter_best_vanilla_star_anomaly= 980 
last prior auc 0.5737174835597249 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36774610492338505 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.36816643970904134 iter_best_vanilla_star_anomaly= 980 
last prior auc 0.573825301297827 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.36775755573327895 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.36817750453657927 at iter 98
max_prior_anomaly= 0.5742363725069399 at iter 128
max_prior_star_anomaly= 0.36783346559662067 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.36816425247569085
accuracies_anomaly['prior'][-1]= 0.5741822063163181
accuracies_anomaly['prior_star'][-1]= 0.36776398877254524



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 130.5424942970276 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.36816360917176416
 first_prior_anomaly_auc= 0.574187610069302
 first_prior_star_anomaly_auc= 0.3677633454686186


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3681962890112367; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5747647823522691; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 80 
last prior star auc 0.3677253905369478 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3693799682362253; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5749343572673273; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 200 
last prior star auc 0.3690585735944839 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3696206925655681; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5754389648673714; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 280 
last prior star auc 0.36931756775534275 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.36984044518690296; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 320 
last prior auc 0.5755278694700308; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 390 
last prior star auc 0.3695608653003921 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.37031250160825985 at iter 490
0.5769409508752535 at iter 490
0.3701243995401149 at iter 490
last anomaly aucs:
0.37031250160825985
0.5769409508752535
0.3701243995401149




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.30074977874756 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.3703086417847,first_prior_anomaly_auc= 0.5770294694955571, first_prior_star_anomaly_auc= 0.3701278733813187


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3703036240140724 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5728400170038094 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37016518500906287 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3702971909748062 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5732736038503542 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37016145384628846 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3703086417847001 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5735978290293727 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3701476871422587 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.37030529660428163 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5746981360654708 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37015051767953583 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.3703092850886267 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5753508322294238 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37017007411890523 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.3702973196355915 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5759174543279945 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3701534768775983 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.3703028520493605 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.576045214487822 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3701600385776499 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.3703056825866376 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5775046137757617 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3701453712481228 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.3703056825866376 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5778121130526881 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3701413827637777 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.37029641901009425 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5787526233934128 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37014948839325323 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.37029847758265944 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5794145831339091 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37014961705403854 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.370314174198469 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5796150366374453 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3701394528519979 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.3703222798279445 at iter 12
max_prior_anomaly= 0.5846178826140166 at iter 4
max_prior_star_anomaly= 0.37030388133564307 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.3703085131239148
accuracies_anomaly['prior'][-1]= 0.5798464973902445
accuracies_anomaly['prior_star'][-1]= 0.37015437750309554



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 130.7622983455658 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.3703077411592028
 first_prior_anomaly_auc= 0.57988818348469
 first_prior_star_anomaly_auc= 0.37014369865791363


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.37050793734116827; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5789761071775219; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.37039021272259604 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.37066335956984064; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5798090571017152; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.3704073246070443 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3719238492836682; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5812028393891392; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 280 
last prior star auc 0.3721037170615523 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.37234276880068595; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5825510757585582; count_not_improved_prior_anomaly= 32; iter_best_prior_anomaly= 400 
last prior star auc 0.37205135212192514 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.37246949967423093 at iter 390
0.5828629495021858 at iter 480
0.372204973099603 at iter 460
last anomaly aucs:
0.3723226977181752
0.5817966089134133
0.37212970654018795




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.49014925956726 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.37234637130267506,first_prior_anomaly_auc= 0.5825551929036887, first_prior_star_anomaly_auc= 0.37214591779913886


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3723512604125173 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.578553070515374 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37203591282768617 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3723733900675932 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5782709174131566 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37214656110306554 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3723750626578024 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5784304567869594 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37203411157669164 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.37235898005963686 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5786643620946799 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3721191563557913 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.37226531500792037 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5794495788675174 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3720067068294174 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.3723754486401584 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5801355981748695 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3721508069089813 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.3723512604125173 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5804126048456739 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37211928501657665 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.37235730746942763 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5808479929432133 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37203719943553937 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.37236476979497646 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.581195248402805 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37220162791918454 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.3723808523931421 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5812819657721139 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3721376835088781 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.37236000934591945 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5810497330546026 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3722236289134751 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.3722521916078172 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5816711646477216 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37212224421463913 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.37244839930543766 at iter 128
max_prior_anomaly= 0.5877785634663069 at iter 3
max_prior_star_anomaly= 0.3723507457693761 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.37235550621843305
accuracies_anomaly['prior'][-1]= 0.5817716487210602
accuracies_anomaly['prior_star'][-1]= 0.3721102787616039



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.75944304466248 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.3723859988245551
 first_prior_anomaly_auc= 0.5820318008289872
 first_prior_star_anomaly_auc= 0.37213922743830197


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3725598195455289; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5826163067767179; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 100 
last prior star auc 0.3723811097147127 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.37308050974373863; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5838658603237928; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 170 
last prior star auc 0.37306133928672525 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3735503789317449; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5824662883010292; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 170 
last prior star auc 0.3736512489874396 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3739394491465673; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5840826537470653; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 400 
last prior star auc 0.3737779798609846 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.3740373600041995 at iter 460
0.5840826537470653 at iter 400
0.374212210011456 at iter 460
last anomaly aucs:
0.37395643237023013
0.5840416109565466
0.3740547292102184




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.39111924171448 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.37402590919430556,first_prior_anomaly_auc= 0.5833182800214503, first_prior_star_anomaly_auc= 0.3740093119529987


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3740609049279139 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5800689518880713 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37399232872933574 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3740329855374984 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5796487457632002 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37407351368487574 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3739524438858851 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5796784664046104 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3740484248317374 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3739963172136809 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5802507495777354 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3740359447355609 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.37399811846467546 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5807471228875186 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37403928991597934 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.3739865389939962 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5808443904412242 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37406347814362045 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.37400300757451777 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5811524043612919 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3740624488573378 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.3739521865643144 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5814793314168023 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.374070039843672 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.37400056301959655 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5814996598208837 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37400313623530307 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.37403002633943594 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5815922955863175 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37409088289089465 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.37403465812770764 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5817909478388591 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37411262656361455 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.37395990621143393 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5819573062342841 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37411288388518515 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.3740609049279139 at iter 10
max_prior_anomaly= 0.5903007008410298 at iter 3
max_prior_star_anomaly= 0.3741889224093121 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.37395990621143393
accuracies_anomaly['prior'][-1]= 0.581690721087091
accuracies_anomaly['prior_star'][-1]= 0.3741202175499487



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 130.8620285987854 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4046866749627141
accuracies_anomaly["prior"][-1]= 0.5158926948464665
accuracies_anomaly["prior_star"][-1]= 0.40468461639014897


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 3572.244879245758 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004919767379760742 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4031475059878729
 first_prior_anomaly_auc= 0.4938145040847226
 first_prior_star_anomaly_auc= 0.40314750598787297


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4990594896592754; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5926167236376625; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4991386160422501 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5771212046354937; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5939547958050408; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5771769147555393 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5509081135549798; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5959652492365269; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5509728299299982 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.556470119304573; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5980180320663849; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.5565613398013685 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5799141729633255 at iter 180
0.5981985431481956 at iter 420
0.5799755441579255 at iter 180
last anomaly aucs:
0.5777986036702291
0.5970345490233617
0.5778814612159782




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 106.34056353569031 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5806728856143861,first_prior_anomaly_auc= 0.5967550977976361, first_prior_star_anomaly_auc= 0.5807598603052657


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5806731429359567 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5968860744770969 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5807572870895592 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5806732715967421 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5972090130482622 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5807539419091408 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5806731429359567 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5975012016917349 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.580750082085581 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5806731429359567 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5981969992187716 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5807462222620212 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5806732715967421 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5990682900569916 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5807450643149533 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5806731429359568 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.6004359542049947 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5807403038658964 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5806731429359568 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.6022853243332542 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5807381166325458 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5806731429359567 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.6047906071450995 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5807343854697714 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5806730142751715 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.6076153546869065 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5807323268972062 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5806731429359567 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.6105728801591688 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5807278237697198 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5806734002575275 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.6139013346755227 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5807243499285161 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5806728856143861 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.6162581429411033 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5807212620696682 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5806734002575276 at iter 74
max_prior_anomaly= 0.6172589951901453 at iter 129
max_prior_star_anomaly= 0.5807598603052657 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5806732715967422
accuracies_anomaly['prior'][-1]= 0.6172589951901453
accuracies_anomaly['prior_star'][-1]= 0.5807188175147471



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 133.86889171600342 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5806734002575276
 first_prior_anomaly_auc= 0.6173235829043783
 first_prior_star_anomaly_auc= 0.5807192034971032


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6046187163359055; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5996755689637249; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.604647021708677 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6101890850365448; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5888545536139785; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6102173904093162 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6127054326759283; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5841238251983693; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6127387558193274 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6140559849394831; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5794392860046915; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6140693656611569 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6170674192807964 at iter 490
0.6173235829043783 at iter 0
0.6170760395534133 at iter 490
last anomaly aucs:
0.6170674192807964
0.5740908571587375
0.6170760395534133




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 106.59800386428833 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6175070531842515,first_prior_anomaly_auc= 0.5735633479389057, first_prior_star_anomaly_auc= 0.6175299548040394


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6175074391666076 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5684162732219852 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6175287968569714 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6175074391666076 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5619243073160639 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6175275102491181 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6175074391666076 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5555356560207587 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6175263523020502 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6175073105058222 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5513738655978558 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6175248083726264 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6175070531842515 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5344773593042849 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.617523135782417 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6175073105058221 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5198540317658332 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6175222351569198 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6175073105058222 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.501673748156291 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6175232644432025 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6175075678273927 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.48078103787053017 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6175218491745639 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6175074391666074 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4673210611529859 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6175212058706372 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6175075678273928 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4531018571412397 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6175215918529933 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6175074391666076 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4407223736988535 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6175163167607949 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6175074391666074 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4301351349960424 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6175160594392242 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6175078251489634 at iter 22
max_prior_anomaly= 0.5735633479389057 at iter 0
max_prior_star_anomaly= 0.6175308554295366 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6175074391666074
accuracies_anomaly['prior'][-1]= 0.4227412569849941
accuracies_anomaly['prior_star'][-1]= 0.6175131002411618



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 134.01457238197327 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6175075678273928
 first_prior_anomaly_auc= 0.42189865750190164
 first_prior_star_anomaly_auc= 0.6175121996156645


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6221580119129595; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41884888224656136; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6221672754895028 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.626896331314903; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4194166622921999; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6269063668561583 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6306215756931985; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4204855760966788; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6306295526618887 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6313626618166697; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4227049746435324; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 400 
last prior star auc 0.6313787444148353 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6317658847178778 at iter 490
0.4228252724778112 at iter 420
0.6317759202591331 at iter 490
last anomaly aucs:
0.6317658847178778
0.42258364752297106
0.6317759202591331




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.60622334480286 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6318318877007494,first_prior_anomaly_auc= 0.42253501374611835, first_prior_star_anomaly_auc= 0.6318362621674505


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6318309870752521 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41178694906165114 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6318379347576597 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6318309870752521 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.40547935406110047 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.631838835383157 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6318318877007494 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4090965233797233 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.631836905471377 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6318309870752522 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4173835645624967 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6318363908282358 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6318321450223201 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42155783508157607 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6318407652949368 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6318311157360375 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.4223377767622153 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6318408939557221 iter_best_prior_star_anomaly= 530
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6318313730576082 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.4228239858699579 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6318399933302248 iter_best_prior_star_anomaly= 530
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6318321450223201 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.42195359565723534 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6318385780615863 iter_best_prior_star_anomaly= 530
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6318321450223201 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.4216876538139689 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6318402506517955 iter_best_prior_star_anomaly= 530
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6318311157360375 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.42178916717359016 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6318441104753553 iter_best_prior_star_anomaly= 990
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6318311157360375 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.42250323453214306 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6318477129773443 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6318308584144667 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.42360624344473297 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6318484849420563 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6318322736831055 at iter 51
max_prior_anomaly= 0.4246500683960735 at iter 129
max_prior_star_anomaly= 0.6318508008361922 at iter 121
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6318320163615347
accuracies_anomaly['prior'][-1]= 0.4246500683960735
accuracies_anomaly['prior_star'][-1]= 0.6318480989597004



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 132.3183720111847 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6318311157360375
 first_prior_anomaly_auc= 0.42472430566920594
 first_prior_star_anomaly_auc= 0.6318460403871352


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6327770298297457; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42648515717716173; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6327865507278598 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6334693535155789; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.42756050402090695; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 190 
last prior star auc 0.6335217184552059 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6343798858933227; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.42737240195276194; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 190 
last prior star auc 0.6343856756286623 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6351124804049624; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4268708822115657; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 190 
last prior star auc 0.6351140243343862 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6355675536026564 at iter 490
0.42757221215237146 at iter 190
0.6355930284381507 at iter 490
last anomaly aucs:
0.6355675536026564
0.4264585243945995
0.6355930284381507




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.07757782936096 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6356137428245879,first_prior_anomaly_auc= 0.42642134142764065, first_prior_star_anomaly_auc= 0.6356501538268349


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6356142574677293 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4283785292940022 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6356605753504463 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6356138714853733 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.43016485563745244 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6356702249093455 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6356141288069439 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4325838070623449 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.635684248934946 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6356145147893 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.43480976730925014 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6356971150134786 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.635613742824588 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.43529700570327523 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.635708823144943 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6356137428245879 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4358369950192837 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6357196306509103 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6356145147893 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4375341594385037 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6357287655666684 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6356143861285146 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44018881742211136 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6357467780766138 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6356137428245879 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4424057714140438 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6357673638022658 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.635613742824588 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44370292945168893 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6357880781887032 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.635614128806944 iter_best_vanilla_star_anomaly= 1010 
last prior auc 0.4448604905372565 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358080206104285 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6356140001461587 iter_best_vanilla_star_anomaly= 1010 
last prior auc 0.4452292323479976 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358252611556621 iter_best_prior_star_anomaly= 1180
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6356159300579385 at iter 128
max_prior_anomaly= 0.445507010983514 at iter 129
max_prior_star_anomaly= 0.6358401858067597 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.635613742824588
accuracies_anomaly['prior'][-1]= 0.445507010983514
accuracies_anomaly['prior_star'][-1]= 0.6358401858067597



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 132.4542691707611 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6356145147892999
 first_prior_anomaly_auc= 0.44556387905062755
 first_prior_star_anomaly_auc= 0.635839928485189


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6354292432584322; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4459933487520418; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 70 
last prior star auc 0.6358588416206319 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6355638224398821; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.44590161361210523; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 70 
last prior star auc 0.6360303464474699 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6351240598756416; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.44704399272500456; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 300 
last prior star auc 0.6353525614303785 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6342688516355874; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4483298286135411; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 400 
last prior star auc 0.6345304190121528 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6358107224869203 at iter 150
0.45096518747934994 at iter 490
0.6361274853403901 at iter 140
last anomaly aucs:
0.6333144459300476
0.45096518747934994
0.6335995582303275




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.05894804000854 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6332189796273366,first_prior_anomaly_auc= 0.4514776433872988, first_prior_star_anomaly_auc= 0.633486465400027


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6332200089136192 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.45169083430858203 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.633495600315785 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6332196229312632 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.453027105224966 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.633512583539448 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6332197515920486 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.45436401944527643 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6335194025610702 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6332187223057659 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.45538198357876664 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6335348418553091 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6332184649841953 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.45609334906082766 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6335498951671921 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6332197515920486 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4574742652697193 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6335582581182383 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6332197515920486 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4591378492239696 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6335691942849908 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6332182076626247 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4611392964004829 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6335754986634718 iter_best_prior_star_anomaly= 780
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.63321833632341 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4629814615247641 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6335772999144663 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6332187223057659 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4655706311686414 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6335833469713765 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6332196229312632 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.46740584861051493 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6336005875166101 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6332188509665513 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.46927503249971436 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6336115236833627 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6332203948959753 at iter 17
max_prior_anomaly= 0.4716776440048706 at iter 129
max_prior_star_anomaly= 0.6336246470834658 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6332202662351899
accuracies_anomaly['prior'][-1]= 0.4716776440048706
accuracies_anomaly['prior_star'][-1]= 0.6336246470834658



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 132.43319654464722 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6332182076626247
 first_prior_anomaly_auc= 0.47193226369902846
 first_prior_star_anomaly_auc= 0.633623103154042


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6319156458719959; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4725647601196854; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.6323357233360816 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6308788972638484; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47090683723998944; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 110 
last prior star auc 0.6313333271576156 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6299031338679446; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47090503598899486; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 110 
last prior star auc 0.6303759622540135 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6289644247782145; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4725908782591064; count_not_improved_prior_anomaly= 31; iter_best_prior_anomaly= 110 
last prior star auc 0.6294852436372096 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6332182076626247 at iter 0
0.4742763345468619 at iter 490
0.633623103154042 at iter 0
last anomaly aucs:
0.6281672425523418
0.4742763345468619
0.6287475026941568




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.98949456214905 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6281364926246491,first_prior_anomaly_auc= 0.4743082424216224, first_prior_star_anomaly_auc= 0.6286880614113367


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6281370072677904 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.48212078262811786 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6288046280828411 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6281376505717171 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4877563823469168 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6289246685955492 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6281368786070052 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4919657772603898 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6289801213940243 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6281361066422931 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.49684446557912276 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.629013315876638 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6281377792325024 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5023721188990342 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6290488262533876 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6281363639638639 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5077146293488632 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6290681253711864 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6281364926246491 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5137863891299135 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6290917989556861 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6281363639638637 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.5193707818561532 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6291217769186668 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6281367499462198 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.5256665400644538 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6291539421149981 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6281364926246491 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.5318315789148647 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6291984587467204 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6281373932501464 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.5385169219811291 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6292272787626332 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6281366212854345 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.5463522351466269 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6292360276960354 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6281381652148583 at iter 71
max_prior_anomaly= 0.5537446978890368 at iter 129
max_prior_star_anomaly= 0.6292626604785976 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6281368786070052
accuracies_anomaly['prior'][-1]= 0.5537446978890368
accuracies_anomaly['prior_star'][-1]= 0.6292626604785976



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.8879632949829 seconds
back and forth 7/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6281371359285758
 first_prior_anomaly_auc= 0.5547730835461383
 first_prior_star_anomaly_auc= 0.6292638184256654


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6274731176155143; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5564140232021714; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6285295513238165 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6271007733027841; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5570058628146657; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 200 
last prior star auc 0.6278545968440024 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6265760946202295; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5575241084579542; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 290 
last prior star auc 0.6273936052501835 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6262958714297919; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5576633194276757; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 400 
last prior star auc 0.6271338391246126 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6281371359285758 at iter 0
0.5577168423143708 at iter 490
0.6292638184256654 at iter 0
last anomaly aucs:
0.6261713277895974
0.5577168423143708
0.6270010611941574




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.07961463928223 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6261808486877115,first_prior_anomaly_auc= 0.5576912388180911, first_prior_star_anomaly_auc= 0.627026664690437


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6261808486877114 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.567898928204194 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6270507242572927 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6261811060092821 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5736971551556436 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6271066916989091 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6261805913661408 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5782947196584416 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6271500503835635 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6261802053837848 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5817793683681798 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6271946956760712 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6261808486877115 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5861793099047189 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6272309780175329 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6261804627053555 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5908993594751464 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6272582541040217 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6261795620798583 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5951334572594018 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6272816703669508 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6261809773484968 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.5989638174993078 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6273086891318691 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6261811060092821 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.6025547400177242 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6273324913771542 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6261816206524233 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.6053927396204197 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6273680017539038 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6261795620798583 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.6079427963855584 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6273947631972514 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6261802053837848 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.6099728062564138 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6274316888426396 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6261821352955647 at iter 76
max_prior_anomaly= 0.6124261101109879 at iter 129
max_prior_star_anomaly= 0.6274513739427944 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6261813633308527
accuracies_anomaly['prior'][-1]= 0.6124261101109879
accuracies_anomaly['prior_star'][-1]= 0.6274513739427944



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 132.16996932029724 seconds
back and forth 8/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6261800767229996
 first_prior_anomaly_auc= 0.6126520384500184
 first_prior_star_anomaly_auc= 0.6274539471585008


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6262950994650799; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6121659580030611; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.6276837353210909 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6269533280428019; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6110260234450829; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.6286916639133259 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6283152024554653; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6089242208560162; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.6299412174604008 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6287853289650424; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6064132769696164; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.6305153018845202 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6289254405602611 at iter 470
0.6126741681050942 at iter 10
0.6305568593181802 at iter 430
last anomaly aucs:
0.6288910881305794
0.6042153647739121
0.6304278125504994




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.0531234741211 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6288636833833052,first_prior_anomaly_auc= 0.6039527681110641, first_prior_star_anomaly_auc= 0.6303767342187254


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.628862010793096 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6102122439779032 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6305768017399056 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.628862010793096 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6136588090951853 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6307642605041239 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6288622681146666 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6163348247691568 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6308202279457402 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6288623967754519 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6189911553429737 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6308751661010739 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6288625254362372 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6212697378510768 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6309123490680328 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6288635547225199 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6231584781796454 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.630949660695777 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6288621394538813 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6245610094004717 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6309744922273446 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6288622681146666 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6259650845507216 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6309931480412168 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6288634260617345 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6273496032616024 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6310179795727844 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6288638120440905 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.628289727619971 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6310354774395887 iter_best_prior_star_anomaly= 980
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.628862396775452 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6289371486917258 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6310713737986943 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6288618821323106 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.6290472823239638 iter_best_prior_anomaly= 1170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6310974919381152 iter_best_prior_star_anomaly= 1180
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6288640693656611 at iter 3
max_prior_anomaly= 0.6292827315611083 at iter 129
max_prior_star_anomaly= 0.6311128025715689 at iter 127
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6288629114185933
accuracies_anomaly['prior'][-1]= 0.6292827315611083
accuracies_anomaly['prior_star'][-1]= 0.6311128025715689



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 132.87264776229858 seconds
back and forth 9/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6288622681146666
 first_prior_anomaly_auc= 0.629300486749483
 first_prior_star_anomaly_auc= 0.6311157617696314


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6287898320925287; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6242306085037573; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.6308109643691968 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.628745186800021; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6180545048258087; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.6303917875306084 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.626733189439111; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6118638624791184; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.6283045236102833 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6244935911489614; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.6070003561330538; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.6264823009077275 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6289222240406279 at iter 70
0.6297106573330986 at iter 10
0.6311157617696314 at iter 0
last anomaly aucs:
0.6189571888956479
0.60426798703511
0.6221223728754246




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.07783031463623 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6182993463002819,first_prior_anomaly_auc= 0.6040514509334083, first_prior_star_anomaly_auc= 0.6215421127336094


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6182984456747846 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6161680803913758 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6221531228031172 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6182994749610673 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6194078876266408 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6222699467961921 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6182996036218525 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6203164900926049 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6222856434120017 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6182994749610673 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.620218321913402 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6222455012469804 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6182996036218525 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6196716422365567 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6222353370449397 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6182998609434232 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6188492424967603 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6222135933722197 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6182992176394966 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.617919539662003 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6221960955054155 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6182999896042085 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6169998723685008 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.622139227438302 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6183002469257791 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6159261981149651 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6221172264440114 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6182992176394966 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6149394985523089 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6221201856420739 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6182996036218525 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6139211484364626 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.622100371881134 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6182998609434232 iter_best_vanilla_star_anomaly= 1120 
last prior auc 0.6131807056169182 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6220979273262127 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6183011475512765 at iter 112
max_prior_anomaly= 0.6203836510225444 at iter 35
max_prior_star_anomaly= 0.6222887312708495 at iter 25
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6182993463002819
accuracies_anomaly['prior'][-1]= 0.6124722993329197
accuracies_anomaly['prior_star'][-1]= 0.6220998572379925



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 132.14520168304443 seconds
back and forth 10/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6182999896042085
 first_prior_anomaly_auc= 0.6123947168793686
 first_prior_star_anomaly_auc= 0.622099213934066


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5997050322835643; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6085725909297234; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6077738647744269 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5592870185384753; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6063341505866416; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5730128084385007 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.48924473031155463; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6043360485905468; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5104138039641932 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.41855939547958043; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6034655297170389; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43370045401817925 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6182999896042085 at iter 0
0.6123947168793686 at iter 0
0.622099213934066 at iter 0
last anomaly aucs:
0.3957616049455148
0.6030320715312795
0.40055396187729464




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.0638644695282 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.394220634719679,first_prior_anomaly_auc= 0.602899936904751, first_prior_star_anomaly_auc= 0.3992301710570873


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3942205060588937 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6035425975274484 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39964934789567563 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.39421999141575237 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.6109400780404859 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39994436707642556 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3942199914157524 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.6117552727763041 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40013478503870636 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.39421728953926055 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.6107236705995696 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4003749947249078 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.39422089204124966 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.6095446231628527 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40045836691379827 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.3942167748961193 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.6085366945706179 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40055177464394415 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.39422320793538557 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.6079667272916287 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4007117000001029 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.3942212780236056 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.6075189877586983 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4009833029179236 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.3942207633804644 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.607189358826696 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40107825457749346 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.39422166400596165 iter_best_vanilla_star_anomaly= 920 
last prior auc 0.6068625604319708 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4014598624667669 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.39422462320402407 iter_best_vanilla_star_anomaly= 920 
last prior auc 0.6067160157974858 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40175243709259556 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.39421934811182574 iter_best_vanilla_star_anomaly= 920 
last prior auc 0.6065415517725854 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40183014820693186 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.394225395168736 at iter 92
max_prior_anomaly= 0.6119876341546009 at iter 28
max_prior_star_anomaly= 0.40186360001111626 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.3942179328431872
accuracies_anomaly['prior'][-1]= 0.6063789245399348
accuracies_anomaly['prior_star'][-1]= 0.40186360001111626



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 132.14981818199158 seconds
back and forth 11/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.394221406684391
 first_prior_anomaly_auc= 0.6063867728478396
 first_prior_star_anomaly_auc= 0.40187595144650745


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.38589692521308794; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49446822953495817; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.36929042032963927 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3810467995886972; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49566001438942225; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.3650985232829704 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3782216660645342; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4970216314805151; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.36753793177272953 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.37706770748095564; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4969058367737228; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.3681525443442263 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.394221406684391 at iter 0
0.6063867728478396 at iter 0
0.40187595144650745 at iter 0
last anomaly aucs:
0.3767450262313609
0.4960184633373373
0.36692833697186034




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.09034752845764 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.376567603008398,first_prior_anomaly_auc= 0.49683828986142725, first_prior_star_anomaly_auc= 0.36658725722996416


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.37656966158096317 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5167010705606625 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37287195061072703 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3765618132730583 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5269881436513107 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37437522322646255 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3765539649651536 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5350843808894474 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3750614998553853 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.37655679550243065 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5421850409707405 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3753507293007955 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.3765656730966181 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5448882040704155 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37512570158726233 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.37656567309661804 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5485300762598206 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3753208799986002 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.37656232791619965 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5523254407661183 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.375541018602291 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.3765591113965665 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5565597958719445 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37552931047082644 iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.3765778958712239 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5585189136500859 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37564240330112697 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.37655653818086 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5597626774618212 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3757161259311181 iter_best_prior_star_anomaly= 990
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.37656605907897406 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5609307887317855 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3758489038615733 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.3765686322946805 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5620744544525381 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3759024267482685 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.37658278498106634 at iter 8
max_prior_anomaly= 0.5626801894298474 at iter 129
max_prior_star_anomaly= 0.3759558209741783 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.3765640005064088
accuracies_anomaly['prior'][-1]= 0.5626801894298474
accuracies_anomaly['prior_star'][-1]= 0.3759558209741783



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 132.68281412124634 seconds
back and forth 12/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.37655653818086
 first_prior_anomaly_auc= 0.5627299811537682
 first_prior_star_anomaly_auc= 0.37596547053307766


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3749215169209518; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5991802249402243; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 90 
last prior star auc 0.3756730245680343 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3738565916008181; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5993517297670623; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 150 
last prior star auc 0.3750041171451304 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.37309955153996666; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6015851523395161; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 290 
last prior star auc 0.3743386835634303 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.37258117723589285; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.60159853306119; count_not_improved_prior_anomaly= 32; iter_best_prior_anomaly= 390 
last prior star auc 0.3739202786895539 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.37655653818086 at iter 0
0.6026913777717393 at iter 490
0.3775364187218941 at iter 10
last anomaly aucs:
0.37237879382057687
0.6026913777717393
0.3736994967819365




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 106.43522644042969 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.37238188167942465,first_prior_anomaly_auc= 0.6019161965401572, first_prior_star_anomaly_auc= 0.37364057014225766


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.37237467667544644 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5961027876160392 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3736579393482765 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.37237519131858776 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5973612187573015 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3736713200699503 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3723757059617291 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.599664504136187 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37364648853838256 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3723699162263895 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.6017018476718059 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3736183118263965 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.3723776358735089 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.6030891969199637 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3735855033261386 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.3723796944460741 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.6039947115270801 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37356736215540787 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.37237699256958234 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.6044726863445619 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.373549220984677 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.37236965890481877 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.6037916848078374 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37353352436886733 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.3723713314950281 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.6030944720121619 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37351203801771815 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.372366957028327 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.6022070985757765 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37349878595682967 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.37237055953031606 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.6012061176659492 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3734841186273027 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.3723767352480117 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.6004598851110651 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3734758843370418 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.3723880573971203 at iter 78
max_prior_anomaly= 0.6045561871942376 at iter 68
max_prior_star_anomaly= 0.3736894612406811 at iter 17
last values
accuracies_anomaly['vanilla_star'][-1]= 0.3723805950715714
accuracies_anomaly['prior'][-1]= 0.5998424420022912
accuracies_anomaly['prior_star'][-1]= 0.37346391888400665



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 134.14587235450745 seconds
back and forth 13/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.3723775072127236
 first_prior_anomaly_auc= 0.5997406713210992
 first_prior_star_anomaly_auc= 0.3734748550507593


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.37279719869445327; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.49231959442003315; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.36662508350084966 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.37338659375202643; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4911737414659301; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.3688363764182278 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3740970586085902; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.493525531960883; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.36831298434352633 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3756389294599232; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4984504095015475; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.37150467244507984 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.3759576222251728 at iter 480
0.5997406713210992 at iter 0
0.3734748550507593 at iter 0
last anomaly aucs:
0.375733109154781
0.4986026152105868
0.37140817685608624




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 105.05091667175293 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.3760883415830629,first_prior_anomaly_auc= 0.5000048891098423, first_prior_star_anomaly_auc= 0.37231652200047965


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.37609297337133457 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5561891241494236 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37507410861234713 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.37609554658704114 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5565570939954527 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37506188583774125 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.376080493275158 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5522841406540291 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37506008458674667 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.37609323069290523 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.5527655893127147 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37539151476974353 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.37609027149484275 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.5552191504888595 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37550679483339455 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.3760973478380356 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.5565238995128389 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37553896002972575 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.3760982484635329 iter_best_vanilla_star_anomaly= 670 
last prior auc 0.5575786606309319 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37561345462442886 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.37609953507138616 iter_best_vanilla_star_anomaly= 670 
last prior auc 0.5584271785101493 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3755938981850595 iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.3760938739968318 iter_best_vanilla_star_anomaly= 670 
last prior auc 0.5597938133718698 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3757185704860393 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.3760925873889786 iter_best_vanilla_star_anomaly= 670 
last prior auc 0.5607953089248384 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3757524082725797 iter_best_prior_star_anomaly= 950
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.37609374533604656 iter_best_vanilla_star_anomaly= 1060 
last prior auc 0.5616247850078278 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3757849594512669 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.3761068687361497 iter_best_vanilla_star_anomaly= 1060 
last prior auc 0.5622010566652977 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3758148087534623 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.37611729025976104 at iter 106
max_prior_anomaly= 0.5631482573668593 at iter 129
max_prior_star_anomaly= 0.37583951162424467 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.37609683319489434
accuracies_anomaly['prior'][-1]= 0.5631482573668593
accuracies_anomaly['prior_star'][-1]= 0.37583951162424467



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.2501358985901 seconds
back and forth 14/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.3761086699871442
 first_prior_anomaly_auc= 0.5632498993872659
 first_prior_star_anomaly_auc= 0.37584388609094566


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3763545407479; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5899573052049978; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.37717346664649265 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.37626975329037093; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5889094917693123; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.3766185526793866 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.37615254331493997; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5905486301743508; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.37628133276105014 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.375829347422204; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5898355921020805; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.3761766028817957 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.37686390879700105 at iter 10
0.5907577039505038 at iter 10
0.3777008472055392 at iter 10
last anomaly aucs:
0.37551335653344614
0.5899122739301341
0.37610635409300835




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 104.42866611480713 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.37551605840993796,first_prior_anomaly_auc= 0.5891997505010051, first_prior_star_anomaly_auc= 0.3761033948949459


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.37552069019820966 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5869380225557795 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37616039162284487 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3755168303746499 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5873640184159902 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37613478812656514 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3755290531492558 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5879583025834056 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37610519614594046 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3755083387628184 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5883768361180673 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3760961898909677 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.3755074381373212 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5893239081588435 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37606248076521265 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.37551142662166626 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5898201528078415 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3760251691374684 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.37551322787266084 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5905994511845541 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37601487627464236 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.37552094751978027 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5911209133474757 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3759834830430231 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.3755174736785766 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5917468480680812 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37596186803108855 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.37551657305307923 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5923089670391654 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37593523524852634 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.37551001135302775 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5924345399656424 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37593291935439044 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.3755168303746499 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5924317094283653 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37589753763842615 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.37553085440025036 at iter 27
max_prior_anomaly= 0.5952379298170856 at iter 4
max_prior_star_anomaly= 0.3762252366586485 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.37551258456873415
accuracies_anomaly['prior'][-1]= 0.5922264954757722
accuracies_anomaly['prior_star'][-1]= 0.37589496442271964



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 131.0160744190216 seconds
back and forth 15/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.3755107833177396
 first_prior_anomaly_auc= 0.5922360163738862
 first_prior_star_anomaly_auc= 0.37588737343638545


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3753118737436274; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5235778608754903; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.3722484604450428 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.37584568734194024; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5169441107841412; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.37096223857415034 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.37717745513083767; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5156859369644495; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.37365781068749115 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.37776710750998155; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5172568851532658; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.37580129937100315 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.37802044059628614 at iter 480
0.5922360163738862 at iter 0
0.37619577333880916 at iter 430
last anomaly aucs:
0.3779939364745092
0.5161715027682655
0.37488677850891416




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 106.11610245704651 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.378048102665131,first_prior_anomaly_auc= 0.5189891739668796, first_prior_star_anomaly_auc= 0.375490326252873


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3780483599867016 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.537364378666189 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3763852906755927 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.378031505423824 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5455716501620611 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3766046573145715 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3780483599867016 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5527067913338213 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37693158437008195 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3780452721278539 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.555687861729798 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3770324544257766 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.3780450148062832 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5576580443354774 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37715635476204445 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.37804038301801146 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5595640252092797 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37727690991789375 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.3780340786395306 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5611562024276746 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3775400212238832 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.37804977525534017 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5628393428212942 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37758736839288276 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.37803369265717457 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5639257544925773 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.377638575385442 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.3780311194414681 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5651428855217504 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37767524370925953 iter_best_prior_star_anomaly= 980
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.37803999703565555 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5657383276362338 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37769222693292237 iter_best_prior_star_anomaly= 1080
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.3780509332024081 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5665220004796474 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3777093388173706 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.3780585241887423 at iter 127
max_prior_anomaly= 0.5669479963398579 at iter 129
max_prior_star_anomaly= 0.37773635758228885 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.3780568515985331
accuracies_anomaly['prior'][-1]= 0.5669479963398579
accuracies_anomaly['prior_star'][-1]= 0.37773635758228885



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 133.68181896209717 seconds


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 14 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40314750598787297
accuracies_anomaly["prior"][-1]= 0.4938145040847226
accuracies_anomaly["prior_star"][-1]= 0.4031475059878729


/home/daniel.z/pieclam/clamiter.py:1286:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 3570.5932443141937 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004500150680541992 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4066842623156677
 first_prior_anomaly_auc= 0.5000218723335053
 first_prior_star_anomaly_auc= 0.4066872215137301


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 55


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 56 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5716565951003916 at iter 20
0.5935141326153033 at iter 10
0.5717308323735238 at iter 20
last anomaly aucs:
0.4050842367893679
0.5652117190418992
0.40508526607565043




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 11.87897801399231 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40526410456725204,first_prior_anomaly_auc= 0.5460308405048855, first_prior_star_anomaly_auc= 0.40526410456725204


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40526410456725204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5440811149640727 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40526410456725204 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 176, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 177 iterations

max values 
max_vanilla_star_anomaly= 0.40526410456725204 at iter 0
max_prior_anomaly= 0.559756244422555 at iter 17
max_prior_star_anomaly= 0.40526526251431993 at iter 17
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40526410456725204
accuracies_anomaly['prior'][-1]= 0.559756244422555
accuracies_anomaly['prior_star'][-1]= 0.40526526251431993



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 17.96892738342285 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40668413365488243
accuracies_anomaly["prior"][-1]= 0.5000218723335053
accuracies_anomaly["prior_star"][-1]= 0.40668722151373016


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 30.29582715034485 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004553318023681641 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40428383804386203
 first_prior_anomaly_auc= 0.47439097130658625
 first_prior_star_anomaly_auc= 0.4042817794712968


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 57


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 58 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5678924951649277 at iter 20
0.5893141299391589 at iter 10
0.5679627439537152 at iter 20
last anomaly aucs:
0.4052729821614394
0.5541520379353752
0.4052719528751568




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 12.252482414245605 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4052926672615942,first_prior_anomaly_auc= 0.5544460278298424, first_prior_star_anomaly_auc= 0.40529138065374093


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4052926672615942 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5584390153023991 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40529138065374093 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 113, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 114 iterations

max values 
max_vanilla_star_anomaly= 0.4052926672615942 at iter 0
max_prior_anomaly= 0.5602836249816014 at iter 11
max_prior_star_anomaly= 0.40529138065374093 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4052926672615942
accuracies_anomaly['prior'][-1]= 0.5602836249816014
accuracies_anomaly['prior_star'][-1]= 0.40529138065374093



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 11.539656162261963 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40428383804386203
accuracies_anomaly["prior"][-1]= 0.47439097130658625
accuracies_anomaly["prior_star"][-1]= 0.40428177947129684


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 24.240045309066772 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004304409027099609 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40395987018641405
 first_prior_anomaly_auc= 0.48876945737056465
 first_prior_star_anomaly_auc= 0.40395909822170206


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 60


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 61 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5674704877890622 at iter 20
0.5955094040741209 at iter 10
0.5675343035385833 at iter 20
last anomaly aucs:
0.40507214267554736
0.5549098499609386
0.4050703414245528




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 12.823235750198364 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40524004500039623,first_prior_anomaly_auc= 0.5372264543043208, first_prior_star_anomaly_auc= 0.4052397876788256


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40524004500039623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5271967027843224 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052397876788256 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40524004500039623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5154677282725385 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052397876788256 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40524004500039623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5131048729500477 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052397876788256 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40524004500039623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5189530202862034 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052397876788256 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40524004500039623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5233117903714386 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052397876788256 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40524004500039623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5270272565300496 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052397876788256 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40524004500039623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5276003116678863 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052397876788256 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.40524004500039623 at iter 0
max_prior_anomaly= 0.5372264543043208 at iter 0
max_prior_star_anomaly= 0.40524004500039634 at iter 21
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40524004500039623
accuracies_anomaly['prior'][-1]= 0.5264709272943049
accuracies_anomaly['prior_star'][-1]= 0.4052397876788256



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.36779379844666 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40524004500039623
 first_prior_anomaly_auc= 0.5264759450649326
 first_prior_star_anomaly_auc= 0.4052397876788256


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40395987018641405
accuracies_anomaly["prior"][-1]= 0.48876945737056465
accuracies_anomaly["prior_star"][-1]= 0.4039590982217021


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 94.78662991523743 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004751682281494141 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40338462781522666
 first_prior_anomaly_auc= 0.48588411059886966
 first_prior_star_anomaly_auc= 0.4033819259387349


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 57


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 58 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5850249653387845 at iter 20
0.6040425733392208 at iter 20
0.585086979837311 at iter 20
last anomaly aucs:
0.4052287228512877
0.5616273582235343
0.40522640695715184




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 12.26367712020874 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4051709541586769,first_prior_anomaly_auc= 0.5316267509446275, first_prior_star_anomaly_auc= 0.405168638264541


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4051709541586769 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5315576601029081 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.405168638264541 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4051709541586769 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5246830570214308 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.405168638264541 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4051709541586769 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5208214322106908 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.405168638264541 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4051709541586769 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5187822874240773 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40516863826454097 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4051709541586769 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.519379788111126 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40516863826454097 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4051709541586769 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5226215252581707 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40516863826454097 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4051709541586769 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5221118998874991 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40516863826454097 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4051709541586769 at iter 0
max_prior_anomaly= 0.5332069627099872 at iter 5
max_prior_star_anomaly= 0.405168638264541 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4051709541586769
accuracies_anomaly['prior'][-1]= 0.5245098796043834
accuracies_anomaly['prior_star'][-1]= 0.40516863826454097



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.05573296546936 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4051709541586769
 first_prior_anomaly_auc= 0.5248652406934508
 first_prior_star_anomaly_auc= 0.40516863826454097


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4033846278152266
accuracies_anomaly["prior"][-1]= 0.48588411059886966
accuracies_anomaly["prior_star"][-1]= 0.40338192593873484


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 93.90916180610657 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004553318023681641 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4054608269080137
 first_prior_anomaly_auc= 0.5020154712021138
 first_prior_star_anomaly_auc= 0.4054597976217311


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 58


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 59 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5753254860547148 at iter 20
0.5925509779763614 at iter 20
0.5754019105611977 at iter 20
last anomaly aucs:
0.4052204885610269
0.5761342477512668
0.40522434838458665




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 12.439434289932251 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4057351317023263,first_prior_anomaly_auc= 0.4719995532897534, first_prior_star_anomaly_auc= 0.4057395061690274


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4057351317023263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47192145619306114 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4057395061690274 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4057351317023263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47185223669055637 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4057395061690274 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4057351317023263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4717352840366961 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4057395061690274 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4057351317023263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4716346713025721 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4057395061690274 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4057351317023263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47147628987583723 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4057395061690274 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4057351317023263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.471292047631252 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4057395061690274 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4057351317023263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47106959313342545 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4057395061690274 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.4057351317023263 at iter 0
max_prior_anomaly= 0.4720000679328947 at iter 1
max_prior_star_anomaly= 0.4057395061690274 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4057351317023263
accuracies_anomaly['prior'][-1]= 0.47085421497879154
accuracies_anomaly['prior_star'][-1]= 0.4057395061690274



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.81692862510681 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4057351317023263
 first_prior_anomaly_auc= 0.47083440121785153
 first_prior_star_anomaly_auc= 0.4057395061690274


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4054608269080137
accuracies_anomaly["prior"][-1]= 0.5020154712021138
accuracies_anomaly["prior_star"][-1]= 0.4054599262825165


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 94.84703207015991 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004698276519775391 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4049454118020024
 first_prior_anomaly_auc= 0.5019935988686085
 first_prior_star_anomaly_auc= 0.4049443825157198


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 54


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 55 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5799797899638411 at iter 20
0.5984840414308314 at iter 20
0.5800420617839384 at iter 20
last anomaly aucs:
0.4053586702444658
0.5650852454899249
0.4053584129228951




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 11.688213586807251 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40547073378848375,first_prior_anomaly_auc= 0.5644620126458112, first_prior_star_anomaly_auc= 0.405472020396337


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40547073378848375 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5639530305790661 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.405472020396337 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40547073378848375 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5634948695225244 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.405472020396337 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40547073378848375 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5630633412485448 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.405472020396337 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40547073378848375 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5625535872170879 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.405472020396337 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40547073378848375 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5619752569870526 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.405472020396337 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40547073378848375 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5614326944553378 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.405472020396337 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40547073378848375 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5608423987722673 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.405472020396337 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.40547073378848375 at iter 0
max_prior_anomaly= 0.5644620126458112 at iter 0
max_prior_star_anomaly= 0.405472020396337 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40547073378848375
accuracies_anomaly['prior'][-1]= 0.5600890898741904
accuracies_anomaly['prior_star'][-1]= 0.405472020396337



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.39982581138611 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40547073378848375
 first_prior_anomaly_auc= 0.5599739384713246
 first_prior_star_anomaly_auc= 0.405472020396337


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40494566912357305
accuracies_anomaly["prior"][-1]= 0.5019935988686085
accuracies_anomaly["prior_star"][-1]= 0.40494438251571974


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 93.67993927001953 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004698276519775391 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40597649933559565
 first_prior_anomaly_auc= 0.49802042515699185
 first_prior_star_anomaly_auc= 0.40597804326501963


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 60


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 61 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5747658116385517 at iter 20
0.5948915749829911 at iter 10
0.5748288554233609 at iter 20
last anomaly aucs:
0.4051404615525548
0.5502147605828642
0.40513968958784286




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 12.834023714065552 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4053226452245748,first_prior_anomaly_auc= 0.5288003308126112, first_prior_star_anomaly_auc= 0.4053226452245748


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4053226452245748 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5213203787361805 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053226452245748 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 174, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 175 iterations

max values 
max_vanilla_star_anomaly= 0.4053226452245748 at iter 0
max_prior_anomaly= 0.5288003308126112 at iter 0
max_prior_star_anomaly= 0.4053226452245748 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4053226452245748
accuracies_anomaly['prior'][-1]= 0.5252383569708927
accuracies_anomaly['prior_star'][-1]= 0.4053226452245748



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 17.764747858047485 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40597649933559565
accuracies_anomaly["prior"][-1]= 0.49802042515699185
accuracies_anomaly["prior_star"][-1]= 0.40597804326501963


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 31.047573566436768 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0046880245208740234 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4062900456694324
 first_prior_anomaly_auc= 0.5009459140937083
 first_prior_star_anomaly_auc= 0.40628991700864703


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 57


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 58 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.570066219132991 at iter 20
0.5951720554949992 at iter 10
0.5701273330060204 at iter 20
last anomaly aucs:
0.40507613115989244
0.5557582391793707
0.40507613115989244




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 12.262687921524048 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4053387278227405,first_prior_anomaly_auc= 0.5288780419269474, first_prior_star_anomaly_auc= 0.4053392424658817


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4053387278227405 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5222392740649706 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053392424658817 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 136, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 137 iterations

max values 
max_vanilla_star_anomaly= 0.4053387278227405 at iter 0
max_prior_anomaly= 0.5345570003304009 at iter 13
max_prior_star_anomaly= 0.4053392424658817 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4053387278227405
accuracies_anomaly['prior'][-1]= 0.5345570003304009
accuracies_anomaly['prior_star'][-1]= 0.4053392424658817



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 14.122186660766602 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4062900456694324
accuracies_anomaly["prior"][-1]= 0.5009459140937083
accuracies_anomaly["prior_star"][-1]= 0.40628991700864703


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 26.83441710472107 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004418373107910156 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40400708869462826
 first_prior_anomaly_auc= 0.4915942049123717
 first_prior_star_anomaly_auc= 0.4040086326240522


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 61


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 62 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5802202569716133 at iter 20
0.6001145595632532 at iter 20
0.5802937222800337 at iter 20
last anomaly aucs:
0.4051938557784646
0.5274644458785833
0.4051925691706114




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 13.404700517654419 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4052608880476189,first_prior_anomaly_auc= 0.5037108343703393, first_prior_star_anomaly_auc= 0.40525908679662437


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4052608880476189 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49476813782555035 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40525908679662437 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4052608880476189 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4893076454355785 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40525908679662437 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4052608880476189 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49108766740054777 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40525908679662437 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4052608880476189 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4940534271630708 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40525908679662437 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4052608880476189 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4948576857321364 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40525908679662437 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4052608880476189 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.497084160622183 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40525908679662437 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4052608880476189 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49832483657507043 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40525908679662437 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4052608880476189 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4980622399122224 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40525908679662437 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 859, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 860 iterations

max values 
max_vanilla_star_anomaly= 0.4052608880476189 at iter 0
max_prior_anomaly= 0.5037108343703393 at iter 0
max_prior_star_anomaly= 0.40525908679662437 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4052608880476189
accuracies_anomaly['prior'][-1]= 0.4986129080734128
accuracies_anomaly['prior_star'][-1]= 0.40525908679662437



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 88.06090068817139 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40400708869462826
accuracies_anomaly["prior"][-1]= 0.4915942049123717
accuracies_anomaly["prior_star"][-1]= 0.4040086326240522


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 101.92016673088074 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004659891128540039 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4056702866665226
 first_prior_anomaly_auc= 0.4993600412537942
 first_prior_star_anomaly_auc= 0.405673631846941


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 60


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 61 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5722486920344564 at iter 20
0.5943086129646842 at iter 10
0.5723287190429285 at iter 20
last anomaly aucs:
0.4051842062195653
0.5642256627831695
0.4051839488979947




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 13.009736061096191 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4053895488329437,first_prior_anomaly_auc= 0.43579080579735197, first_prior_star_anomaly_auc= 0.4053967538369219


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4053895488329437 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43162374028225087 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053967538369219 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4053895488329437 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43497265186347134 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053967538369219 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4053895488329437 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4356338396392557 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053967538369219 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4053895488329437 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4356606010826033 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053967538369219 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4053895488329437 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43563023713726656 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053967538369219 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4053895488329437 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.2173934971751238 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053967538369219 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4053895488329437 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.653868778350404 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4053967538369219 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:804:::  
loss: nan


/home/daniel.z/pieclam/clamiter.py:904:::  
fit_prior error at iteration 772, exiting loop


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 773 iterations

max values 
max_vanilla_star_anomaly= 0.4053895488329437 at iter 0
max_prior_anomaly= 0.6539656599217536 at iter 33
max_prior_star_anomaly= 0.4053967538369219 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4053895488329437
accuracies_anomaly['prior'][-1]= 0.6538719948700372
accuracies_anomaly['prior_star'][-1]= 0.4053967538369219



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 79.11894536018372 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4056702866665226
accuracies_anomaly["prior"][-1]= 0.4993600412537942
accuracies_anomaly["prior_star"][-1]= 0.40567363184694105


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 92.58400988578796 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0047910213470458984 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4104899196847914
 first_prior_anomaly_auc= 0.5139005112464966
 first_prior_star_anomaly_auc= 0.41049043432793264


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 58


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 59 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5706668076788874 at iter 20
0.5963652556181018 at iter 10
0.5707460627226475 at iter 20
last anomaly aucs:
0.4051423914643347
0.5632150323144427
0.4051423914643347




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 12.627138376235962 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4052908660105996,first_prior_anomaly_auc= 0.5431129425545033, first_prior_star_anomaly_auc= 0.4052903513674583


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4052908660105996 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5425073362379792 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052903513674583 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4052908660105996 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5418092228168067 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052903513674583 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4052908660105996 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.541076242322811 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052903513674583 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4052908660105996 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.540144352254703 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052903513674583 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4052908660105996 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5389653048179861 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052903513674583 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4052908660105996 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.537602787101396 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052903513674583 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4052908660105996 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5362542934104063 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052903513674583 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4052908660105996 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5348345216443466 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052903513674583 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4052908660105996 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5333204415226438 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052903513674583 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4052908660105996 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5317752254908924 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052903513674583 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4052908660105996 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5302686076947384 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052903513674583 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4052908660105996 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.528758644718166 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4052903513674583 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4052908660105996 at iter 0
max_prior_anomaly= 0.5431129425545033 at iter 0
max_prior_star_anomaly= 0.4052903513674583 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4052908660105996
accuracies_anomaly['prior'][-1]= 0.5272371022709144
accuracies_anomaly['prior_star'][-1]= 0.4052903513674583



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 133.50859260559082 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4052908660105996
 first_prior_anomaly_auc= 0.5271020084463233
 first_prior_star_anomaly_auc= 0.4052903513674583


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.41048991968479137
accuracies_anomaly["prior"][-1]= 0.5139005112464966
accuracies_anomaly["prior_star"][-1]= 0.41049043432793264


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 146.73273944854736 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-05,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.0047185420989990234 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4065374603596121
 first_prior_anomaly_auc= 0.4986958942799473
 first_prior_star_anomaly_auc= 0.4065387469674653


/home/daniel.z/pieclam/clamiter.py:407:::  
fit feats error in readout fufv has negative vals - crossed the potential wall at 0, at iter 55


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 56 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.5781006991941717 at iter 20
0.5964925011347881 at iter 20
0.5781549940455789 at iter 20
last anomaly aucs:
0.4052125115923368
0.5646045687959512
0.4052107103413422




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 12.070203065872192 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40514149083883744,first_prior_anomaly_auc= 0.552098740462376, first_prior_star_anomaly_auc= 0.4051407188741255


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40514149083883744 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.551625397433166 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051407188741255 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40514149083883744 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.55116955227076 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051407188741255 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40514149083883744 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5506838578061586 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051407188741255 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40514149083883744 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.550152488762767 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051407188741255 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40514149083883744 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5495907557740387 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051407188741255 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40514149083883744 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5490104956322237 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051407188741255 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40514149083883744 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5483164993561814 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051407188741255 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40514149083883744 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5475694948365853 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051407188741255 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40514149083883744 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5467096548082594 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051407188741255 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40514149083883744 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5458536746034931 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051407188741255 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40514149083883744 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5451012663309135 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051407188741255 iter_best_prior_star_anomaly= 1080
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40514149083883744 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5442980370481304 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051407188741255 iter_best_prior_star_anomaly= 1080
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40514149083883744 at iter 0
max_prior_anomaly= 0.552098740462376 at iter 0
max_prior_star_anomaly= 0.4051408475349108 at iter 108
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40514149083883744
accuracies_anomaly['prior'][-1]= 0.543552061814817
accuracies_anomaly['prior_star'][-1]= 0.4051407188741255



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 134.0556240081787 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40514149083883744
 first_prior_anomaly_auc= 0.543481941686815
 first_prior_star_anomaly_auc= 0.4051407188741255


/home/daniel.z/pieclam/clamiter.py:382:::  error in readout in fit_feats fufv has negative vals - crossed the potential wall at 0, at iter 0


/home/daniel.z/pieclam/clamiter.py:1138:::  
fit func. nerror in fit_feats at iter 1:
 fufv has negative vals - crossed the potential wall at 0


/home/daniel.z/pieclam/clamiter.py:1275:::  fit end after i= 1 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4065374603596121
accuracies_anomaly["prior"][-1]= 0.4986958942799473
accuracies_anomaly["prior_star"][-1]= 0.4065387469674653


/home/daniel.z/pieclam/trainer.py:477:::  
train_model_on_params on piegam redditGGAD 
took 146.72365736961365 seconds


/home/daniel.z/pieclam/trainer.py:479:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:493:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:379:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:380:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 1e-06,
        "n_iter": 1000,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 800,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 15,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:384:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:392:::  
 init_node_feats took 0.004827260971069336 seconds


/home/daniel.z/pieclam/clamiter.py:986:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1024:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4074845324003883
 first_prior_anomaly_auc= 0.5127257096156954
 first_prior_star_anomaly_auc= 0.40748903552787463


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5125314318298548; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.596733611446487; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 90 
last prior star auc 0.5125994933852918 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5806178187982671; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5936219503534055; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 90 
last prior star auc 0.5806919274106143 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5521091619859873; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5925208713525953; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 90 
last prior star auc 0.552180697382628 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5599920796420553; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5937253936248067; count_not_improved_prior_anomaly= 31; iter_best_prior_anomaly= 90 
last prior star auc 0.5600665742367585 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5894153859772095; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 500 
last prior auc 0.593142560267285; count_not_improved_prior_anomaly= 41; iter_best_prior_anomaly= 90 
last prior star auc 0.5895170279976162 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6069522369993423; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 600 
last prior auc 0.5895345258644202; count_not_improved_prior_anomaly= 51; iter_best_prior_anomaly= 90 
last prior star auc 0.6070028006879749 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.612459047272031; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 700 
last prior auc 0.5843157870900738; count_not_improved_prior_anomaly= 61; iter_best_prior_anomaly= 90 
last prior star auc 0.6124879959487293 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.617715998299619; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 800 
last prior auc 0.5807349001129127; count_not_improved_prior_anomaly= 71; iter_best_prior_anomaly= 90 
last prior star auc 0.6177513800155834 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6223576934517836; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 900 
last prior auc 0.5774549507126263; count_not_improved_prior_anomaly= 81; iter_best_prior_anomaly= 90 
last prior star auc 0.6223746766754464 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6267806652688959 at iter 990
0.5968438737395103 at iter 90
0.6267952039376375 at iter 990
last anomaly aucs:
0.6267806652688959
0.5746588945259468
0.6267952039376375




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 212.6984634399414 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6271245755480692,first_prior_anomaly_auc= 0.5741625212161635, first_prior_star_anomaly_auc= 0.6271349970716805


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6271245755480692 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6079798506917318 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6274558770702807 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6271244468872839 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6173671989106034 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6280360085513104 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6271244468872839 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6154286668581139 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6276240367167003 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6271243182264985 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.614830651527924 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6277107540860092 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6271245755480692 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6064751628073577 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6273768793480912 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6271244468872839 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6010315249802634 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6270414606807494 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6271244468872839 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.6066448663832011 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6275241959472881 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6271250901912105 at iter 25
max_prior_anomaly= 0.6192627582607944 at iter 17
max_prior_star_anomaly= 0.6280360085513104 at iter 20
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6271245755480691
accuracies_anomaly['prior'][-1]= 0.6057142629229466
accuracies_anomaly['prior_star'][-1]= 0.6272621139275816



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.96449613571167 seconds
back and forth 2/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6271245755480692
 first_prior_anomaly_auc= 0.6074392180717969
 first_prior_star_anomaly_auc= 0.6272164393487911


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6323241438654023; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6002679232193605; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 40 
last prior star auc 0.6325310304082046 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6356205618462102; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5878009504429533; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 40 
last prior star auc 0.6357882068494884 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6370552582633676; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5838023018958424; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 40 
last prior star auc 0.6370885814067668 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.639025440869047; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5774652435754524; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 40 
last prior star auc 0.6385801458910376 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6412211658314008; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 500 
last prior auc 0.570066991097703; count_not_improved_prior_anomaly= 48; iter_best_prior_anomaly= 40 
last prior star auc 0.6404414814723323 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6429362140997811; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 600 
last prior auc 0.5634934542538859; count_not_improved_prior_anomaly= 58; iter_best_prior_anomaly= 40 
last prior star auc 0.6418661423482344 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.644346593628512; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 700 
last prior auc 0.5598445057212879; count_not_improved_prior_anomaly= 68; iter_best_prior_anomaly= 40 
last prior star auc 0.6430517514850027 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6450510114281657; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 800 
last prior auc 0.5584983279244339; count_not_improved_prior_anomaly= 78; iter_best_prior_anomaly= 40 
last prior star auc 0.6437593858042894 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6456422077367332; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 900 
last prior auc 0.5567722148285157; count_not_improved_prior_anomaly= 88; iter_best_prior_anomaly= 40 
last prior star auc 0.6441043253697454 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6461149074620168 at iter 990
0.6099864442996581 at iter 40
0.6443540559540609 at iter 980
last anomaly aucs:
0.6461149074620168
0.5563559971879899
0.6442998897634391




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 211.37174272537231 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6461362651523808,first_prior_anomaly_auc= 0.5560111862833194, first_prior_star_anomaly_auc= 0.6442889535966866


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6461239137169895 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5942113454109785 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6462237544864016 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6461294461307585 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6185232160667471 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6456954733018578 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6461248143424868 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6039396447109608 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6456232946012904 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6461358791700248 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6030872670081839 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6454671004079061 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6461329199719621 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6140145561666085 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6460553375184114 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6461270015758372 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5909091376948311 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6451877778429659 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6461394816720138 iter_best_vanilla_star_anomaly= 680 
last prior auc 0.6130120313273573 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6456698698055781 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6461408969406525 at iter 68
max_prior_anomaly= 0.621869554432261 at iter 19
max_prior_star_anomaly= 0.6462723882632544 at iter 13
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6461231417522775
accuracies_anomaly['prior'][-1]= 0.5996924235266025
accuracies_anomaly['prior_star'][-1]= 0.6451127686051216



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 82.33986115455627 seconds
back and forth 3/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6461365224739513
 first_prior_anomaly_auc= 0.6084800838250748
 first_prior_star_anomaly_auc= 0.6454028986760291


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6464308983507745; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5988161149177549; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6461993089371899 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6468800531523436; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5835040661954594; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6461533770368288 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6470466688693393; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5810530782350211; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6459928083767434 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6468154654381106; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 310 
last prior auc 0.5765624308448278; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6453615985639398 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.64664100141321; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 310 
last prior auc 0.5760309331406509; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.6444809154883911 ; count_not_improved_prior_star_anomaly= 43 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6461370371170926; count_not_improved_vanilla_star_anomaly= 44 ;iter_best_vanilla_star_anomaly= 310 
last prior auc 0.5742529697482469; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.6438329797734952 ; count_not_improved_prior_star_anomaly= 53 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6454409822684852; count_not_improved_vanilla_star_anomaly= 54 ;iter_best_vanilla_star_anomaly= 310 
last prior auc 0.5776843528928606; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.6434691270725967 ; count_not_improved_prior_star_anomaly= 63 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6441283849366012; count_not_improved_vanilla_star_anomaly= 64 ;iter_best_vanilla_star_anomaly= 310 
last prior auc 0.5779580143832466; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.6424702047353344 ; count_not_improved_prior_star_anomaly= 73 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6429188448937622; count_not_improved_vanilla_star_anomaly= 74 ;iter_best_vanilla_star_anomaly= 310 
last prior auc 0.5778034927800715; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.641280607114221 ; count_not_improved_prior_star_anomaly= 83 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6471342868641455 at iter 310
0.6084800838250748 at iter 0
0.6462905294339852 at iter 150
last anomaly aucs:
0.641764243006257
0.5773561392294969
0.6403008552339721




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 211.36951756477356 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6417780097102868,first_prior_anomaly_auc= 0.5765722090645126, first_prior_star_anomaly_auc= 0.6399882095256328


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6417769804240041 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.6159173205207777 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6422939394594395 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6417762084592923 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.6073460676632216 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6424207989937697 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6417764657808629 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.6053317544081759 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6418983075445656 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6417821268554172 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.6101364627753469 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6420956731892539 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6417769804240042 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.6102426079232399 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6422088946803398 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.641778910335784 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.6042304180857951 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6422464636296545 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.641780840247564 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5990906770336382 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419645678490078 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6417870159652594 at iter 45
max_prior_anomaly= 0.6246566043639679 at iter 79
max_prior_star_anomaly= 0.6435500547065659 at iter 59
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6417783956926427
accuracies_anomaly['prior'][-1]= 0.6246566043639679
accuracies_anomaly['prior_star'][-1]= 0.6430107086944841



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 82.17844080924988 seconds
back and forth 4/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6417798109612813
 first_prior_anomaly_auc= 0.6097535682782202
 first_prior_star_anomaly_auc= 0.64205257182617


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6414667792705859; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6011809001520255; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6414267657663499 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6403721333090422; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5965852655610073; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6399916833668367 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6395568099124386; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5943649663886565; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6389169798270181 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6382493590119676; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5927392087052916; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6379071213230034 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6376296000090577; count_not_improved_vanilla_star_anomaly= 49 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5904029861653631; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.6368874845993041 ; count_not_improved_prior_star_anomaly= 49 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6375608951496943; count_not_improved_vanilla_star_anomaly= 59 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5866798003596325; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.6355151886630291 ; count_not_improved_prior_star_anomaly= 59 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6359186688858078; count_not_improved_vanilla_star_anomaly= 69 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5883846844259722; count_not_improved_prior_anomaly= 70; iter_best_prior_anomaly= 0 
last prior star auc 0.6355316572435508 ; count_not_improved_prior_star_anomaly= 69 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.634563742155552; count_not_improved_vanilla_star_anomaly= 79 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5795010431816474; count_not_improved_prior_anomaly= 80; iter_best_prior_anomaly= 0 
last prior star auc 0.6332036689938829 ; count_not_improved_prior_star_anomaly= 79 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6323789533599506; count_not_improved_vanilla_star_anomaly= 89 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5713506397528889; count_not_improved_prior_anomaly= 90; iter_best_prior_anomaly= 0 
last prior star auc 0.6310188801982818 ; count_not_improved_prior_star_anomaly= 89 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6422459489865133 at iter 10
0.6097535682782202 at iter 0
0.6425820109577817 at iter 10
last anomaly aucs:
0.6309310048819048
0.5690800342134761
0.6300656324398098




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 211.44016766548157 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6306505243698965,first_prior_anomaly_auc= 0.5696577211395845, first_prior_star_anomaly_auc= 0.6297775609414676


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.630655413479739 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5939285490048345 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6331084600127426 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6306557994620949 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5962533207348694 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6330860730360961 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6306626184837171 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5971726020460152 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6326382048423802 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6306631331268585 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5905033415779164 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6322104077311751 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6306732973288992 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5921700133910145 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.631867398077499 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6306633904484291 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.6001285835888537 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6328586007676418 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6306591446425134 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.6019309925304696 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6326652236072985 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.6306749699191084 at iter 78
max_prior_anomaly= 0.6099506766013378 at iter 36
max_prior_star_anomaly= 0.637969521803886 at iter 36
last values
accuracies_anomaly['vanilla_star'][-1]= 0.630660173928796
accuracies_anomaly['prior'][-1]= 0.5983591118082809
accuracies_anomaly['prior_star'][-1]= 0.6324497167918792



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 82.38455414772034 seconds
back and forth 5/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6306622325013612
 first_prior_anomaly_auc= 0.5950553601627095
 first_prior_star_anomaly_auc= 0.6318565905715318


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6244387816544129; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.597852188314101; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 70 
last prior star auc 0.6302748348767481 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6129893870291401; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5945211605820409; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 150 
last prior star auc 0.6216468426128638 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5744848164834022; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5929623065070448; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 150 
last prior star auc 0.6039827460740449 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4936405547029634; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5881637738575695; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 150 
last prior star auc 0.5435500032422519 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.42021127130236624; count_not_improved_vanilla_star_anomaly= 50 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5827673545386893; count_not_improved_prior_anomaly= 45; iter_best_prior_anomaly= 150 
last prior star auc 0.45218604967129744 ; count_not_improved_prior_star_anomaly= 48 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.3931759091428413; count_not_improved_vanilla_star_anomaly= 60 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5829280518595601; count_not_improved_prior_anomaly= 55; iter_best_prior_anomaly= 150 
last prior star auc 0.400104163771799 ; count_not_improved_prior_star_anomaly= 58 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.38584044312833043; count_not_improved_vanilla_star_anomaly= 70 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5863077133684732; count_not_improved_prior_anomaly= 65; iter_best_prior_anomaly= 150 
last prior star auc 0.3874469016938964 ; count_not_improved_prior_star_anomaly= 68 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.38012944818933103; count_not_improved_vanilla_star_anomaly= 80 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5808589291099658; count_not_improved_prior_anomaly= 75; iter_best_prior_anomaly= 150 
last prior star auc 0.37995755738013703 ; count_not_improved_prior_star_anomaly= 78 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.37872215651944785; count_not_improved_vanilla_star_anomaly= 90 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5800020482797024; count_not_improved_prior_anomaly= 85; iter_best_prior_anomaly= 150 
last prior star auc 0.3776726704935531 ; count_not_improved_prior_star_anomaly= 88 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:583:::  
fit_feats optmization loop ended after 1000 iterations


/home/daniel.z/pieclam/clamiter.py:635:::  fit_feats end


max anomaly aucs:
0.6306622325013612 at iter 0
0.6011838593500881 at iter 150
0.6321352698325454 at iter 20
last anomaly aucs:
0.3778812296265647
0.580089022970582
0.37762094885785247




/home/daniel.z/pieclam/clamiter.py:1144:::  
in fit, fit_feats took 211.5206868648529 seconds


/home/daniel.z/pieclam/clamiter.py:1154:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:716:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:723:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:762:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.37781779985939945,first_prior_anomaly_auc= 0.5813412783941488, first_prior_star_anomaly_auc= 0.3774230685700229


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.37783169522421456 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.596691668030471 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37846740816450464 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.37782230298688585 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5904244725165122 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3782376200019144 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3778400581752607 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5924420022911913 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3785099948844472 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.37783169522421456 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5955835126864681 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.37835045551064433 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.37783323915363853 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5943688262122162 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3780728055359133 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.37782886468693744 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6044919854623606 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3813377016243167 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:881:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.37782539084573363 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5890171808466291 iter_best_prior_anomaly= 630
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3779110789287601 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:909:::  
fit_prior optmization loop ended after 800 iterations

max values 
max_vanilla_star_anomaly= 0.37784095880075796 at iter 1
max_prior_anomaly= 0.6163186135102058 at iter 63
max_prior_star_anomaly= 0.3813377016243167 at iter 60
last values
accuracies_anomaly['vanilla_star'][-1]= 0.3778274494182989
accuracies_anomaly['prior'][-1]= 0.6105059765507999
accuracies_anomaly['prior_star'][-1]= 0.3786574401444294



/home/daniel.z/pieclam/clamiter.py:1166:::  
in fit, fit_prior took 81.99690079689026 seconds
back and forth 6/15


/home/daniel.z/pieclam/clamiter.py:1133:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:270:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:327:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.3778260341496603
 first_prior_anomaly_auc= 0.6058619655044994
 first_prior_star_anomaly_auc= 0.37996849354688966


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.37656966158096317; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5946045327709313; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.37693261365636455 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.37636071646559555; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5881357258063686; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.3764307079328123 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.37604588352390567; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5839793391364493; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.37636045914402494 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3759689443742814; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5867862028290962; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.3767338327430377 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.37630153250434617; count_not_improved_vanilla_star_anomaly= 50 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5780913069568431; count_not_improved_prior_anomaly= 50; iter_best_prior_anomaly= 0 
last prior star auc 0.37698909574112216 ; count_not_improved_prior_star_anomaly= 50 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:518:::  
                                       
fit feats, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.3761100852557828; count_not_improved_vanilla_star_anomaly= 60 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5876358786553816; count_not_improved_prior_anomaly= 60; iter_best_prior_anomaly= 0 
last prior star auc 0.37757463097513555 ; count_not_improved_prior_star_anomaly= 60 ; iter_best_prior_star_anomaly= 0
                                       
