

/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 0 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 100,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003970623016357422 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46521319401051
 first_prior_anomaly_auc= 0.41321492318259867
 first_prior_star_anomaly_auc= 0.4619905888782301


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5433808038429027; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4131115123215036; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.520500286449133 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.542400129415497; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.41306645997067193; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.516644224309578 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5349778070024345; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.41305671609014327; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.508791075695074 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.535027783679985; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4130780897635611; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5071277009932053 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5455206857344979 at iter 120
0.41321492318259867 at iter 0
0.520500286449133 at iter 100
last anomaly aucs:
0.5396346484847951
0.4130912911500838
0.5110844498982235




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.45023965835571 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5402819355160464,first_prior_anomaly_auc= 0.41309317706244425, first_prior_star_anomaly_auc= 0.511594065327166


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5402820402889553 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41316861355686 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5114688617010175 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5402816211973197 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41327967284030553 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5113502587681305 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5402818307431375 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4133882175739372 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5112148921698176 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5402820402889553 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41352526053879257 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5110782682965979 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5402818307431375 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41367016147181634 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5109658469653364 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5402818307431375 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41380668057212716 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.510841900614095 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5402820402889553 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.413964363800038 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.510710201067594 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5402818307431375 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4141396488766458 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5105604805807604 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5402820402889553 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4143460515072002 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5104083503170218 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5402818307431375 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4145298231894298 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5102784319099725 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5402820402889553 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4147261676207288 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5101369884829428 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5402818307431375 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.414956248928697 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5099832866255706 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5402820402889553 at iter 2
max_prior_anomaly= 0.4151486119894573 at iter 129
max_prior_star_anomaly= 0.511594065327166 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5402818307431375
accuracies_anomaly['prior'][-1]= 0.4151486119894573
accuracies_anomaly['prior_star'][-1]= 0.5098273845371113



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.82744646072388 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5402820402889553
 first_prior_anomaly_auc= 0.4151635945154316
 first_prior_star_anomaly_auc= 0.50981114473623


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5479591704164891; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4151627563321603; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5157965067035802 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.552870714840412; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4151459926667346; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 110 
last prior star auc 0.5189737451663019 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5531355807541387; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4151361440132969; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 110 
last prior star auc 0.5187206138183732 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.547457308182806; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.41513205786984947; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 110 
last prior star auc 0.5139614092040067 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5537516454585345 at iter 260
0.41516453747161186 at iter 110
0.5193215912238859 at iter 250
last anomaly aucs:
0.5397625762065753
0.41514588789382567
0.5070074216937757




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.19423580169678 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5388776642179143,first_prior_anomaly_auc= 0.4151490310810929, first_prior_star_anomaly_auc= 0.5062119857693244


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5388776642179142 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41543443248496614 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5060585982306789 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5388776642179142 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.415735445052267 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5058970384051384 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5388776642179142 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41610141682309265 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5057421840457681 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5388776642179142 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41647252246645483 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5055787383078671 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5388776642179143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4168771554406686 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.505422731446499 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5388776642179143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41734129942714365 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5052634766249545 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5388776642179142 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4178561535015316 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5051208806959268 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5388776642179143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41845671181540856 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.504956177683119 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5388776642179143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41911887659972513 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5047900078495863 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5388776642179142 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4197785268342279 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.50463284848622 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5388776642179142 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.420552903403988 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5044991582544498 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5388776642179143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42139402031672435 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5043627439270478 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5388776642179143 at iter 0
max_prior_anomaly= 0.4222073724085993 at iter 129
max_prior_star_anomaly= 0.5062119857693244 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5388774546720965
accuracies_anomaly['prior'][-1]= 0.4222073724085993
accuracies_anomaly['prior_star'][-1]= 0.5042311491534559



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.4789047241211 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5388776642179142
 first_prior_anomaly_auc= 0.4222883618671873
 first_prior_star_anomaly_auc= 0.5042162714003905


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5281327833174707; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42236159813051605; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4954195379682354 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5176892293030548; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4224502360114546; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.48740734407800473 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5092154059761629; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42255134186855364; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.4813914931941614 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5037513940035531; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42267277366998124; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.477415989938448 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5388776642179142 at iter 0
0.42279514842758914 at iter 490
0.5042162714003905 at iter 0
last anomaly aucs:
0.5010615591130847
0.42279514842758914
0.4749552933997677




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.18118000030518 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5008585092156155,first_prior_anomaly_auc= 0.4228089784515654, first_prior_star_anomaly_auc= 0.4747522435022985


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5008585092156155 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4238006540344066 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4746344787526827 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5008585092156155 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4247065206048498 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4745326394852214 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5008585092156155 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.42555392389212077 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4744316384010313 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5008585092156155 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4262511876009225 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4743760039863997 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5008585092156155 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4268012453727045 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47430109135652837 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5008585092156155 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.42721195517563504 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47425708673478584 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5008586139885245 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4275719548906527 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4741931752603502 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5008587187614333 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4278430024060051 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47415671428804923 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5008586139885245 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.42800990564990005 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4740936409968849 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5008587187614334 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4282049928062921 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4740433500006077 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5008587187614334 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.428344969412597 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47401003221557403 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5008586139885245 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.42848306010654147 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4739270520717166 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5008589283072512 at iter 29
max_prior_anomaly= 0.42858626142181866 at iter 129
max_prior_star_anomaly= 0.4747522435022985 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5008585092156155
accuracies_anomaly['prior'][-1]= 0.42858626142181866
accuracies_anomaly['prior_star'][-1]= 0.47388660972887703



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.66128587722778 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5008585092156155
 first_prior_anomaly_auc= 0.42859851985216124
 first_prior_star_anomaly_auc= 0.4738876574579662


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.49940342305666163; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.428802198387084; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4718496148338323 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4987242850611015; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42897014936006805; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.4700735044819755 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4986559731244916; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42912007939271946; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.4679963815628178 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.49905788200307355; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42928373467643816; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.46554144753412774 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5008585092156155 at iter 0
0.4294224540078362 at iter 490
0.4738876574579662 at iter 0
last anomaly aucs:
0.49941767217227345
0.4294224540078362
0.46232764332619625




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.1985867023468 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4994627245231052,first_prior_anomaly_auc= 0.42944089403980445, first_prior_star_anomaly_auc= 0.46187334799315877


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.49946293406892295 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.42963388573801825 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4617659557615251 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.49946251497728733 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.42987151069542806 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46171975090869544 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.49946272452310514 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4301018015492141 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46168978585674697 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.49946251497728733 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.43037379202074666 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4616582492111648 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.49946251497728733 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.43064567771937035 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46162880802376083 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.49946251497728733 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.43098336080479005 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46161434936233114 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.49946251497728733 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4313071090933246 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46160806298779644 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4994624102043784 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4316659563063442 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46161434936233114 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4994623054314695 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4319992389295897 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46159601410327167 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4994627245231052 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4323140815208667 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4615752690673074 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.49946272452310514 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4326150940881677 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4615696113302262 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4994627245231052 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4328793313644409 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4615577719915193 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4994631436147408 at iter 124
max_prior_anomaly= 0.4331250238358368 at iter 129
max_prior_star_anomaly= 0.46187334799315877 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4994630388418319
accuracies_anomaly['prior'][-1]= 0.4331250238358368
accuracies_anomaly['prior_star'][-1]= 0.46155944835806184



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.40632915496826 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49946251497728733
 first_prior_anomaly_auc= 0.433155303206512
 first_prior_star_anomaly_auc= 0.4615535810751628


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5028375646920327; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4334198548015119; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.45488059450663065 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5074462106362942; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4336119035435455; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.4422510585206987 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4883218020269786; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.43374349831713754; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.4246967767243211 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4438545031186705; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.43385895806275726; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.4080414464863986 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.50783910904471 at iter 180
0.43397106507529193 at iter 490
0.4615535810751628 at iter 0
last anomaly aucs:
0.4531053223380452
0.43397106507529193
0.4056666637330253




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.21536493301392 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4534825048101242,first_prior_anomaly_auc= 0.4339757798561929, first_prior_star_anomaly_auc= 0.4057626357175875


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45348292390175987 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4340434631553493 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4056251736610965 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4534829239017599 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4340821243587374 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4056327173105381 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4534831334475777 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.43410653644651365 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4056287359399995 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4534833429933955 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.43406661796821866 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40547828204280345 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4534831334475777 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4340006110356048 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40531881767544115 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4534829239017598 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.43389992427014146 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40516501104516006 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.45348250481012425 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.433764033807284 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.404988783012372 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.45348334299339554 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4335353145471317 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048102499755879 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.453482714355942 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4332814497888407 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40458729322542564 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.45348355253921335 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.43298158972353784 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40434778235565544 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4534829239017599 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4325717181038785 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40409192691209506 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4534829239017599 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.43210568820504314 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4038438246637942 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.45348376208503116 at iter 28
max_prior_anomaly= 0.4341199473788542 at iter 28
max_prior_star_anomaly= 0.4057626357175875 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4534825048101242
accuracies_anomaly['prior'][-1]= 0.4316149318997047
accuracies_anomaly['prior_star'][-1]= 0.4036330215710656



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.7659056186676 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.45348271435594206
 first_prior_anomaly_auc= 0.4315566781623502
 first_prior_star_anomaly_auc= 0.4036240111008993


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45508490167900684; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.43193595609260754; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.40355046051884386 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.45393931469297555; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.43210757411740347; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.40495944659787697 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45243498526683357; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.43214361599806883; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 280 
last prior star auc 0.4066921809654447 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.45155248305507745; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4321385868984411; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 340 
last prior star auc 0.40947243487630297 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.45511193308950587 at iter 90
0.4321578651136807 at iter 340
0.41257287479679294 at iter 490
last anomaly aucs:
0.451201598583135
0.4321384821255322
0.41257287479679294




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.24415588378906 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4511842062802558,first_prior_anomaly_auc= 0.4321368057589896, first_prior_star_anomaly_auc= 0.4128951562646027


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4511842062802558 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.43151497854460374 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4127704765029988 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4511846253718914 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.43089011291585944 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41261520305199295 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4511843110531647 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4302376920120715 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41241403906688406 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4511848349177092 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.42948123160973517 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4122223046435772 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4511843110531647 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.42875882240279484 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41201674019629414 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4511844158260736 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.4280819894112307 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41181515711954964 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.45118452059898256 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.42734952200503495 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4116303377082309 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4511843110531647 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.4266373805431679 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41144939489454185 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4511846253718914 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.42599554170318005 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41128940666263497 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4511843110531647 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.42540085067220207 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4111196745501994 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.45118452059898256 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.4248006066770518 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4109871368204272 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4511844158260736 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.42429109602101833 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4108439122539461 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4511848349177093 at iter 57
max_prior_anomaly= 0.4321368057589896 at iter 0
max_prior_star_anomaly= 0.4128951562646027 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4511844158260736
accuracies_anomaly['prior'][-1]= 0.4238984071584204
accuracies_anomaly['prior_star'][-1]= 0.4107209088588848



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.59589886665344 seconds
back and forth 7/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4511846253718914
 first_prior_anomaly_auc= 0.4238634130068442
 first_prior_star_anomaly_auc= 0.4107081265639976


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4510662319848222; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.424738057250432; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.41416479437478443 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4513619011337686; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4250845412602001; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 200 
last prior star auc 0.41765666588296535 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.45180550963009714; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4251277076986714; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 270 
last prior star auc 0.4209494688642156 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4523164871068554; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4250967996905427; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 270 
last prior star auc 0.4239790822982818 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.45281510138036213 at iter 490
0.42513797544374465 at iter 270
0.42642060539463134 at iter 490
last anomaly aucs:
0.45281510138036213
0.4250168579610438
0.42642060539463134




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.27410626411438 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4528662305599106,first_prior_anomaly_auc= 0.42500491384942796, first_prior_star_anomaly_auc= 0.42664639101333424


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4528662305599106 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4260928757355582 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.426464505243465 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4528662305599106 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.424869652024024 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.426217660270071 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4528662305599106 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4235310733397789 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4259731203006731 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4528662305599106 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4226052999166427 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4258464498537998 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4528662305599106 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4217362086372272 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4257118166658495 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4528662305599106 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4210274199084453 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.42556345822683167 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4528662305599106 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.42056725729250877 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4254729344335326 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4528662305599106 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4200946267004119 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4253564269588238 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4528662305599106 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4198011577825526 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4252864386556714 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4528662305599106 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4195406923310002 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4252003153245467 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4528662305599106 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4193923338919825 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4251265551966734 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4528662305599106 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4192209254130043 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.425050699610622 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.45286644010572846 at iter 46
max_prior_anomaly= 0.42669416745979755 at iter 5
max_prior_star_anomaly= 0.42664639101333424 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4528662305599106
accuracies_anomaly['prior'][-1]= 0.4191544993887549
accuracies_anomaly['prior_star'][-1]= 0.42499663678962396



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.40323615074158 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 6 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.46521319401051
accuracies_anomaly["prior"][-1]= 0.41321492318259867
accuracies_anomaly["prior_star"][-1]= 0.461990693651139


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 1356.3798213005066 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 1 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 100,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0036966800689697266 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4681106888064396
 first_prior_anomaly_auc= 0.4133207438205986
 first_prior_star_anomaly_auc= 0.4650064770612289


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5478635127506535; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41325086029035507; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5236802490074863 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5435939119396274; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4132117799953313; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5175853993503241 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5511264554528641; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41317479515848576; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5238599345462683 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.565725826899229; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.41314577306271744; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5355500766309056 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5769169356187238 at iter 490
0.4133207438205986 at iter 0
0.5454986834236266 at iter 490
last anomaly aucs:
0.5769169356187238
0.41311318868804625
0.5454986834236266




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.2587218284607 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5780945831148818,first_prior_anomaly_auc= 0.4131118266402304, first_prior_star_anomaly_auc= 0.5465367734051153


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5780945831148818 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41319124450518474 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5463934440657252 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5780947926606996 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41328742603556495 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5462440378976184 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5780945831148818 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41338758893648375 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5460918028609709 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5780947926606996 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4135181359809867 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5459492069319433 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5780947926606996 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41363883437205196 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5458018962220147 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5780945831148818 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4137559704842143 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.545664015073888 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5780947926606996 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41389636618215486 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5455123039017851 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5780945831148818 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41403550460518845 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5453647836460385 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5780947926606996 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41418700623147353 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5451921178921535 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5780947926606996 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41434772787374274 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5450228048713535 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5780945831148818 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4145282515957961 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5448531775318268 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5780945831148818 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4147231292063704 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5446646910686963 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5780947926606996 at iter 2
max_prior_anomaly= 0.41490459588460393 at iter 129
max_prior_star_anomaly= 0.5465367734051153 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5780945831148818
accuracies_anomaly['prior'][-1]= 0.41490459588460393
accuracies_anomaly['prior_star'][-1]= 0.5444884630359081



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.08000564575195 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5780945831148818
 first_prior_anomaly_auc= 0.4149295318369247
 first_prior_star_anomaly_auc= 0.5444742139202963


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5917871450346233; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4148907658606277; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5564811892814799 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.605183199622147; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4148294737089149; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5682731706335786 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6161088137904617; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4147542467603168; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5770784954442644 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.623288272600669; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4146794389033545; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5817863613332646 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6255569203973157 at iter 490
0.4149295318369247 at iter 0
0.582751948461787 at iter 480
last anomaly aucs:
0.6255569203973157
0.41460463104639217
0.5827431475374385




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.24024105072021 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6256554069316919,first_prior_anomaly_auc= 0.4145983446718575, first_prior_star_anomaly_auc= 0.5827005049635118


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6256554069316919 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41484141782053074 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5824667566037316 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6256554069316919 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.41509999735972275 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5822238930008763 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6256554069316919 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.41535711007818993 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5819771528003913 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6256554069316919 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.415656760597675 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5817088293806707 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6256554069316919 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.4159380758581006 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5814588412200092 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6256554069316919 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.4162755493977025 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5812002616808173 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6256554069316919 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.4166289484194588 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5809229277909302 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6256554069316919 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.4170305429793141 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5806443366261363 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6256554069316919 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.41749206764306634 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5803612402262591 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6256555117046008 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.4180290288012345 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.580069971539487 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6256556164775097 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.41859490728226195 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5797593198645663 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6256554069316919 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.4192192490464618 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5794435343171089 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6256556164775097 at iter 49
max_prior_anomaly= 0.4198081775674497 at iter 129
max_prior_star_anomaly= 0.5827005049635118 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6256554069316919
accuracies_anomaly['prior'][-1]= 0.4198081775674497
accuracies_anomaly['prior_star'][-1]= 0.5791877836464576



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.07316040992737 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6256554069316919
 first_prior_anomaly_auc= 0.4198669551693487
 first_prior_star_anomaly_auc= 0.5791617999650478


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6257096792985076; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41975652452335666; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.57775710957528 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6248358732381911; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4196779448416734; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5753899752442571 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6226920099760573; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41959035468982403; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5719521665570741 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6195896841432069; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41952246184484976; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5675723446458738 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6258407502075551 at iter 50
0.4198669551693487 at iter 0
0.5791617999650478 at iter 0
last anomaly aucs:
0.6161705250338102
0.4194767808565646
0.5629771096339528




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.18873882293701 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6158174403307807,first_prior_anomaly_auc= 0.4194729042589349, first_prior_star_anomaly_auc= 0.562503221766949


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6158175451036896 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.42030815388877224 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5621876457653096 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6158176498765984 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.42112108688901156 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.561876784544571 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6158175451036896 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.42190038778549044 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5615561794433038 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6158175451036896 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.422621434944615 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5612575766529079 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6158175451036896 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4232517487646226 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.560948391798712 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6158173355578718 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4237005959063967 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5606563897015774 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6158174403307806 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.42398673072063225 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5603667973813479 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6158175451036896 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4241573010163391 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5600853773480132 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6158175451036896 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4243259853996856 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5597924322946985 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6158174403307807 iter_best_vanilla_star_anomaly= 950 
last prior auc 0.42432986199731526 iter_best_prior_anomaly= 920
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5595277759267897 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6158174403307806 iter_best_vanilla_star_anomaly= 950 
last prior auc 0.42432975722440636 iter_best_prior_anomaly= 920
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5592566236385285 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6158176498765984 iter_best_vanilla_star_anomaly= 950 
last prior auc 0.42430471649917667 iter_best_prior_anomaly= 920
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5589911290873484 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6158176498765986 at iter 95
max_prior_anomaly= 0.42433866292166383 at iter 92
max_prior_star_anomaly= 0.562503221766949 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6158176498765985
accuracies_anomaly['prior'][-1]= 0.4242234127218618
accuracies_anomaly['prior_star'][-1]= 0.558742398201594



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.31476593017578 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6158175451036896
 first_prior_anomaly_auc= 0.4242270797736738
 first_prior_star_anomaly_auc= 0.5587197672532692


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6113928803874753; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4241730169526758; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5526900863454497 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6064960041708; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4241379180281906; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.545723945177785 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6015771256432533; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4241063813826085; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5378252203479047 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.596943438973762; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4240897224900916; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5288913391779853 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6158175451036896 at iter 0
0.4242270797736738 at iter 0
0.5587197672532692 at iter 0
last anomaly aucs:
0.593364605951185
0.42405315674488175
0.5198893556172738




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 70.16039490699768 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5930253512721317,first_prior_anomaly_auc= 0.4240578715257827, first_prior_star_anomaly_auc= 0.518899565946793


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5930258751366764 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4239820159397313 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5186047349811178 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5930255608179495 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42385681231358285 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5183370401988505 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5930255608179495 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42372322685472147 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5180743745162111 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5930255608179495 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4235963468620304 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5178191477101042 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5930255608179495 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4234525984310047 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5175624540832727 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5930253512721317 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4233048686294404 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.517282500870663 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5930255608179495 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42321088733014733 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.517005062207867 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5930256655908586 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42314907131389 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5167406153857759 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5930255608179495 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4231130294332246 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5164905224522057 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5930253512721317 iter_best_vanilla_star_anomaly= 990 
last prior auc 0.4231398512979059 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5162588695506038 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5930255608179495 iter_best_vanilla_star_anomaly= 990 
last prior auc 0.423234775553379 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5160201968641049 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5930259799095852 iter_best_vanilla_star_anomaly= 990 
last prior auc 0.42338627717966415 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5158140037793684 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5930259799095852 at iter 99
max_prior_anomaly= 0.42406719631467577 at iter 4
max_prior_star_anomaly= 0.518899565946793 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5930252464992227
accuracies_anomaly['prior'][-1]= 0.4236079766549195
accuracies_anomaly['prior_star'][-1]= 0.5156355755154932



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 121.73462462425232 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5930257703637674
 first_prior_anomaly_auc= 0.42363982761922836
 first_prior_star_anomaly_auc= 0.5156197548062477


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5899171581563825; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42376974602627787; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5035643743611472 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5865417941229104; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42387661439336694; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 200 
last prior star auc 0.48850578325502614 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5856860090029266; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4239968936927966; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 300 
last prior star auc 0.46982163040895386 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5255784197982241; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42409087499208964; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 400 
last prior star auc 0.449523346128201 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5930257703637674 at iter 0
0.4241513289605312 at iter 490
0.5156197548062477 at iter 0
last anomaly aucs:
0.42953770420763815
0.4241513289605312
0.40160367509837125




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.85848569869995 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4306013587789011,first_prior_anomaly_auc= 0.4241507003230778, first_prior_star_anomaly_auc= 0.400374584103938


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4306021969621724 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4245951470026776 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40063484000967264 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43060135877890116 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.42521393580270506 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40111239492848827 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4306024065079902 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.42596285255559985 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40166014769627423 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4306030351454436 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4268504886398926 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40228145104611557 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4306017778705367 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.42788396861338923 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4030081559423212 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43060261605380795 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.42898031233223244 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40375853951594076 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4306019874163545 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4300994965452181 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40449708375085336 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4306015683247189 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4312182616665682 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40520000519673627 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43060240650799014 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.43230203263634204 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40584959723198355 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4306021969621724 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.43332168258586246 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40646817648619327 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4306017778705368 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.43426778195332744 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40699937513437123 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4306015683247189 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.435161494866337 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40756368202176513 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4306030351454436 at iter 40
max_prior_anomaly= 0.43589972478252287 at iter 129
max_prior_star_anomaly= 0.4080897467974065 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43060240650799014
accuracies_anomaly['prior'][-1]= 0.43589972478252287
accuracies_anomaly['prior_star'][-1]= 0.4080897467974065



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.9778003692627 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4306020921892635
 first_prior_anomaly_auc= 0.4359674080816792
 first_prior_star_anomaly_auc= 0.40812861754661245


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4335119501884446; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4359539971493387; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.39425542713190864 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43025319840259035; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.43586860722857634; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.3866467137138937 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4288158188652424; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4358439855949823; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.38682430379449756 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42861779806740086; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4358298412522793; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.3880934180401347 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4347403077725154 at iter 50
0.4359908772132753 at iter 20
0.40812861754661245 at iter 0
last anomaly aucs:
0.4288524893833612
0.43580962008085955
0.3898176658020806




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.892239570617676 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.42890068492146016,first_prior_anomaly_auc= 0.4358109821286754, first_prior_star_anomaly_auc= 0.3900026947592172


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.42890089446727797 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4374743568305441 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3901945339554329 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4289006849214601 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.43919692822594736 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3903082125616012 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.42890089446727797 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4406702448710518 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39041047092069825 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.42890068492146016 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.44194396912468104 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39050183289726853 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4289006849214601 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4429268437831737 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39059298532802095 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4289011040130958 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.44366214005791005 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39066108771881297 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4289011040130958 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4441384377018188 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39069733914529614 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.42890089446727797 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4443799392568583 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3907476301415733 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.42890089446727797 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.44454589954457313 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3907702610898981 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4289005801485512 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4445638157119968 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39075391651610797 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4289011040130958 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4444462605081989 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3907501446913872 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.42890068492146016 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4442578788179772 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39074563945630403 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4289013135589136 at iter 23
max_prior_anomaly= 0.4445734548196167 at iter 98
max_prior_star_anomaly= 0.3907719374564407 at iter 89
last values
accuracies_anomaly['vanilla_star'][-1]= 0.42890068492146016
accuracies_anomaly['prior'][-1]= 0.4440942235342584
accuracies_anomaly['prior_star'][-1]= 0.39073023783869415



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.11249828338623 seconds
back and forth 7/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.42890089446727797
 first_prior_anomaly_auc= 0.44408165078518913
 first_prior_star_anomaly_auc= 0.3907281423805159


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4293285774814521; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4457397868416123; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.3927672327337389 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43003223233769733; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4451998920419946; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 100 
last prior star auc 0.39571554239049034 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.430867062875899; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4445097528909989; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 100 
last prior star auc 0.3986640615930595 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4317207525377046; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4438450735568684; count_not_improved_prior_anomaly= 31; iter_best_prior_anomaly= 100 
last prior star auc 0.4015354679346703 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.43250152025490834 at iter 490
0.4457397868416123 at iter 100
0.4040858500833783 at iter 490
last anomaly aucs:
0.43250152025490834
0.44327364211166864
0.4040858500833783




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.980422019958496 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4325710894664251,first_prior_anomaly_auc= 0.44321727428667457, first_prior_star_anomaly_auc= 0.4043484109931089


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43257108946642514 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.44508160342783426 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40445674618092264 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4325710894664251 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.44755864454030464 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40451856219718013 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4325710894664251 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4490024152250962 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4045231722051722 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.432571194239334 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.44970816553951976 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4044571652725583 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4325708799206073 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4499431711742068 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40439105356703564 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43257129901224295 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4499175018115236 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40432274163042575 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43257129901224295 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.44985694307017315 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4042714029050594 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43257108946642514 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4498151386795177 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4042409139885663 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43257098469351624 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.44972178601767815 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4042182830402416 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4325710894664251 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4496417395152702 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40419523300028126 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4325708799206072 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4495924962480821 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4041809838846693 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4325710894664251 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.44958600032772966 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40416757295232875 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43257150855806076 at iter 25
max_prior_anomaly= 0.4499672689432563 at iter 53
max_prior_star_anomaly= 0.40453260176697414 at iter 26
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43257087992060733
accuracies_anomaly['prior'][-1]= 0.4495470248056148
accuracies_anomaly['prior_star'][-1]= 0.40415688611561984



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.03132128715515 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 6 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4681107935793485
accuracies_anomaly["prior"][-1]= 0.4133207438205986
accuracies_anomaly["prior_star"][-1]= 0.4650065818341378


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 1291.1248178482056 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 2 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 100,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0029795169830322266 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46644134204876303
 first_prior_anomaly_auc= 0.41350744914427773
 first_prior_star_anomaly_auc= 0.46334614077371855


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5436791970874808; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41328910240210753; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5200827664071233 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5403789552296978; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.413247402784361; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5148177181885352 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5367698428364457; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.41323744935801443; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.510676149872198 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5370891906628059; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4132445739158205; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5086919605232443 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5445530031477973 at iter 110
0.41350744914427773 at iter 0
0.5200827664071233 at iter 100
last anomaly aucs:
0.5428862757128434
0.4132421641389155
0.5136649018717889




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.70232677459717 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5436500702188035,first_prior_anomaly_auc= 0.41324216413891546, first_prior_star_anomaly_auc= 0.514344144640258


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5436499654458946 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42687909164402527 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5032300440088127 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5436499654458946 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4122772056478465 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49855539113193725 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5436500702188035 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41025362168514234 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4979323066426444 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5436499654458946 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4101909674856136 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49825113060446014 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5436499654458946 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4086235647683073 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49788861633962855 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5436498606729857 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4095019808366158 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4983644948919016 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5436499654458946 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4058128219409559 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4976386281789672 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5436499654458946 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4081076629648302 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4989388599785509 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5436499654458946 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.40701634834561484 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49836721898753333 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5436500702188035 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4027305077337075 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4981597686278898 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5436500702188035 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.40468483680362155 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4981345183568423 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5436499654458946 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.40832894334844994 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5005871473815364 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5436500702188036 at iter 46
max_prior_anomaly= 0.43720865273354614 at iter 6
max_prior_star_anomaly= 0.514344144640258 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5436499654458946
accuracies_anomaly['prior'][-1]= 0.4043270373196911
accuracies_anomaly['prior_star'][-1]= 0.498920000854947



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.30547571182251 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5436500702188035
 first_prior_anomaly_auc= 0.40598684974265675
 first_prior_star_anomaly_auc= 0.49982303855684956


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5556044495797139; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.40990556608174045; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 50 
last prior star auc 0.5095967793645984 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5645744774032077; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41247627417477706; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 170 
last prior star auc 0.5161369138846317 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5692961733161841; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41245133822245633; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 220 
last prior star auc 0.5192277146975017 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5689133331070239; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4096266605982198; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 220 
last prior star auc 0.5172597651494292 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5701949153288214 at iter 350
0.4178563630473494 at iter 490
0.5198184243579411 at iter 270
last anomaly aucs:
0.5658763855693338
0.4178563630473494
0.5167860868282432




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 62.10160946846008 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5644917068051681,first_prior_anomaly_auc= 0.41449755313348524, first_prior_star_anomaly_auc= 0.5145860652869332


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5644914972593503 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41758290575509205 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5140083474671987 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5644914972593503 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4176417881299 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5141923286952462 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5644914972593503 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4215684672100609 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5157749234843446 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.564491706805168 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.42342692906832163 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5160076241150356 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5644914972593503 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4187871655701134 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.515517077355515 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5644916020322591 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4215250912257718 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5157869723688694 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5644914972593502 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.42533023373159606 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5184945138809436 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5644914972593503 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4211391078293442 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.516265784562592 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.564491706805168 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.42358031660696704 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5168091368682036 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5644916020322592 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.427789044357916 iter_best_prior_anomaly= 930
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5187101365274821 iter_best_prior_star_anomaly= 930
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5644917068051681 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.42349377418420675 iter_best_prior_anomaly= 930
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.517356260998536 iter_best_prior_star_anomaly= 930
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5644914972593502 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.42456727740890726 iter_best_prior_anomaly= 930
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.517791278116334 iter_best_prior_star_anomaly= 930
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.564491811578077 at iter 32
max_prior_anomaly= 0.4342346737141116 at iter 93
max_prior_star_anomaly= 0.522146687939758 at iter 93
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5644916020322592
accuracies_anomaly['prior'][-1]= 0.42818487640778125
accuracies_anomaly['prior_star'][-1]= 0.5190665739635968



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.54753160476685 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5644913924864414
 first_prior_anomaly_auc= 0.4247150072104716
 first_prior_star_anomaly_auc= 0.5181479250982666


/home/daniel.z/pieclam/clamiter.py:408:::  
fit feats error in readout in clam_loss: loss is nan, at iter 9


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 10 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5644913924864414 at iter 0
0.4247150072104716 at iter 0
0.5181479250982666 at iter 0
last anomaly aucs:
0.5644913924864414
0.4247150072104716
0.5181479250982666




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 1.2393147945404053 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:1161:::  
fit func. error in fit_prior at iter 2:
 Input contains NaN.


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.466441342048763
accuracies_anomaly["prior"][-1]= 0.41350744914427773
accuracies_anomaly["prior_star"][-1]= 0.46334614077371855


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 346.077166557312 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 3 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 100,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 0.0001,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0028908252716064453 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4687246580526572
 first_prior_anomaly_auc= 0.413440184936757
 first_prior_star_anomaly_auc= 0.46545846739027025


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5430762289966988; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4131690326484957; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5193938845310344 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5437375555977442; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4131231421143927; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5179788216232843 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5378945800136037; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 230 
last prior auc 0.41311696051276703; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5113796999555343 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5354483421363532; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4131371816841868; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5073021478865418 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5453309419964604 at iter 230
0.413440184936757 at iter 0
0.5198027084216046 at iter 230
last anomaly aucs:
0.5411585704449036
0.4131478685208957
0.5119652757434372




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.42808270454407 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5417792451572914,first_prior_anomaly_auc= 0.4131459826085353, first_prior_star_anomaly_auc= 0.5124804441365518


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5417792451572914 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.42052807222457617 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5003826306633425 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5417792451572914 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4098688955636216 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4964662193282548 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5417792451572914 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.40795029405564615 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49589457833723716 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5417792451572914 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.40651469565774967 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4955285017935026 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5417792451572914 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4065031706377695 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49567706977833825 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5417792451572914 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4077325759509294 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49624912986099146 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5417792451572914 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41036593824349477 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4977276851515415 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5417792451572914 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.40775981690724616 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4971610732601515 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5417792451572914 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4083666615956578 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4972475109100031 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5417792451572914 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4076504339903433 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49738444910194946 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5417792451572914 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.40828032871871534 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49769887260159096 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5417792451572914 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41128374892555375 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4991844476770379 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5417794547031093 at iter 128
max_prior_anomaly= 0.4349682936223054 at iter 6
max_prior_star_anomaly= 0.5124804441365518 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5417792451572914
accuracies_anomaly['prior'][-1]= 0.40728666245060485
accuracies_anomaly['prior_star'][-1]= 0.49793681187772754



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.68737697601318 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5417792451572914
 first_prior_anomaly_auc= 0.4100163110464592
 first_prior_star_anomaly_auc= 0.4993080797095527


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5498802864742784; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.40599606975864094; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5040779711606282 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5585074973398159; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.40356282372209534; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5092933570203926 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5652986677495995; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.39950769305560974; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5123512591398647 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5679760346639073; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.39860664603897633; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5132378474950683 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5680453943296063 at iter 420
0.4100163110464592 at iter 0
0.5132378474950683 at iter 400
last anomaly aucs:
0.5675766403351392
0.3973962046223293
0.5121366842224153




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.884194135665894 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5673129269234105,first_prior_anomaly_auc= 0.39521011787790433, first_prior_star_anomaly_auc= 0.5110024127105464


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5673127173775927 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.431305432726782 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5238961859727514 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5673126126046839 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42190342619984883 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5198944894898104 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5673127173775928 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41599161481455404 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5178854689614448 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5673126126046839 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4132115704495135 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5170496954670629 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5673126126046839 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4124668446129751 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5171414765352689 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5673126126046839 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41002008287117997 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5164015702525404 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5673127173775927 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.413498857765747 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5178885073758032 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5673127173775927 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4125443765655692 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5176946774943182 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5673126126046839 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41539839060430084 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5188312540101832 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5673126126046839 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4164280987530766 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5195091347308363 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5673129269234105 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41304330515780263 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5193025225544641 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5673128221505017 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41580627153869076 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5201063403116282 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5673130316963195 at iter 1
max_prior_anomaly= 0.437292261514857 at iter 14
max_prior_star_anomaly= 0.528873946875106 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5673127173775928
accuracies_anomaly['prior'][-1]= 0.43595546397006346
accuracies_anomaly['prior_star'][-1]= 0.5256641240377131



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.76744985580444 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5673126126046839
 first_prior_anomaly_auc= 0.4188209024467827
 first_prior_star_anomaly_auc= 0.5214436617209662


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5636089950475942; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4253346341937704; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 30 
last prior star auc 0.5187480643205079 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5547132512165183; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42381500792292737; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 30 
last prior star auc 0.511039292774483 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5425952165718891; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42259702285683864; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 30 
last prior star auc 0.5027276579105852 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5295761349106266; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4225399216214823; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 30 
last prior star auc 0.4963505500368173 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5688265811384456 at iter 10
0.42911064983091746 at iter 30
0.5239292942119673 at iter 30
last anomaly aucs:
0.5193984945390264
0.4215024602774471
0.4917147679091477




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.820754528045654 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5183025699118189,first_prior_anomaly_auc= 0.42182641811179944, first_prior_star_anomaly_auc= 0.49131631653655966


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5183025699118189 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.418409144914763 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49145996019467647 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5183023603660011 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4099401411416811 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4886375875744359 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5183023603660011 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.41527601584669294 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.489879775182483 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5183023603660011 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4197081194394398 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49091828425560735 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5183023603660011 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4222165924245834 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49149935480842694 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5183025699118189 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.4242522252718124 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4921749305250841 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5183025699118189 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.42527093226515256 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49217933098725836 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5183023603660011 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.42655356221603924 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4927283410299512 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5183023603660011 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.42794243189656145 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4932134395982084 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5183023603660011 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.42580213091333063 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49243990121171966 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5183023603660011 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.426546856749869 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49264284633627997 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5183025699118189 iter_best_vanilla_star_anomaly= 1170 
last prior auc 0.4266524678420511 iter_best_prior_anomaly= 1190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49286412671989965 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5183028842305457 at iter 129
max_prior_anomaly= 0.4306679943489684 at iter 128
max_prior_star_anomaly= 0.4968287335930863 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5183028842305457
accuracies_anomaly['prior'][-1]= 0.4269223628554054
accuracies_anomaly['prior_star'][-1]= 0.4932792369850045



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.3548903465271 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5183023603660011
 first_prior_anomaly_auc= 0.4267130265834016
 first_prior_star_anomaly_auc= 0.4933569784834163


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.461201963192858; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44630618918718434; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.46076705084796904 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4608254093582324; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.43993243404650156; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 120 
last prior star auc 0.46064352358836325 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46097607280124625; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44559331431495497; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 120 
last prior star auc 0.46084426848183635 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4610749784272581; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44581689970257066; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 120 
last prior star auc 0.46091362814753534 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5342034304326744 at iter 10
0.45090131942619655 at iter 120
0.5152616410035903 at iter 10
last anomaly aucs:
0.46111667804500456
0.43710545141826895
0.460925781804969




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.88051986694336 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46114852900931347,first_prior_anomaly_auc= 0.44204507498178003, first_prior_star_anomaly_auc= 0.4609787968968779


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46114852900931347 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.450081576186878 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.460958680498367 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46114852900931347 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44448345489086216 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46092452453006216 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46114852900931347 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4370576749718056 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46090105539846604 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46114852900931347 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43442452222505806 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608897399243037 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46114852900931347 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43577755957073283 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608859680995828 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46114852900931347 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4377338793259162 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46088869219521456 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46114852900931347 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4390601995798187 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46088764446612546 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46114852900931347 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4399135749228976 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46089099719921056 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46114852900931347 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44043345809691326 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608934069761156 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46114852900931347 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44084081516675866 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608933022032067 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.46114852900931347 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44114004659460804 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608936165219334 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.46114852900931347 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4412022817025011 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608939308406601 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.46114852900931347 at iter 0
max_prior_anomaly= 0.450161413143468 at iter 9
max_prior_star_anomaly= 0.4609855023630482 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46114852900931347
accuracies_anomaly['prior'][-1]= 0.44112768339135655
accuracies_anomaly['prior_star'][-1]= 0.4608943499322958



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.70104098320007 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46114852900931347
 first_prior_anomaly_auc= 0.4411123865466555
 first_prior_star_anomaly_auc= 0.46089372129484235


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4611101821246521; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4082373718260619; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4608052929597215 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46113029852316295; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40952314496421577; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.46083609619494126 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46113532762279075; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41076260847663126; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4608392393822086 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4611426617264145; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4129073099220364; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4608532789520027 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4611642449456501 at iter 490
0.4411123865466555 at iter 0
0.46089372129484235 at iter 0
last anomaly aucs:
0.4611642449456501
0.4160796240580391
0.4608743383066938




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.89728617668152 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4611548153838481,first_prior_anomaly_auc= 0.41260105870929, first_prior_star_anomaly_auc= 0.46087486217123835


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4611548153838481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4173513576263991 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609423359245769 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4611548153838481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41660306951095777 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46092138134279476 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4611548153838481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4157485416658809 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609090181395433 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4611548153838481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4156460737609661 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46090105539846604 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4611548153838481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4165894490327994 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46089707402792746 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4611548153838481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4176789825125633 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608912067450285 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4611548153838481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4176197858190287 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608840821872225 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4611548153838481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41717994914742096 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46087989127086604 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4611548153838481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4183689121177413 iter_best_prior_anomaly= 810
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4608767480835988 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4611548153838481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41825481441993734 iter_best_prior_anomaly= 810
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46087339535051364 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4611548153838481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4192556052458538 iter_best_prior_anomaly= 810
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46087423353378487 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4611548153838481 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4169848619910289 iter_best_prior_anomaly= 810
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46086627079270764 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4611548153838481 at iter 0
max_prior_anomaly= 0.4206636483687068 at iter 81
max_prior_star_anomaly= 0.46098152099250955 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4611548153838481
accuracies_anomaly['prior'][-1]= 0.41636691137427273
accuracies_anomaly['prior_star'][-1]= 0.4608616607847156



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.47987937927246 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4611548153838481
 first_prior_anomaly_auc= 0.41687631725739727
 first_prior_star_anomaly_auc= 0.4608624989679868


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4611747222365412; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47039452867487835; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.4611642449456501 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4611403567224185; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4615415321906381; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.461120868961361 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46114370945550354; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4530238090149125; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.46110138120030364 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4611458049136818; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4598665276958803; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.4610960377819492 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.46124261508151543 at iter 10
0.5186608932602941 at iter 10
0.46137400030928966 at iter 10
last anomaly aucs:
0.46115984448347586
0.46212438388290916
0.46111898304900056




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.57717442512512 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4611595301647491,first_prior_anomaly_auc= 0.45725244361855455, first_prior_star_anomaly_auc= 0.46111437304100855


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4611595301647491 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44262792667405104 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46100258034720065 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4611595301647491 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4424197429040452 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609871787295908 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4611595301647491 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4440557718766881 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46098309258614323 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4611595301647491 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44644909943493877 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609844546339591 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4611595301647491 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44841222942920145 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609873882754085 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4611595301647491 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4493496326452268 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609869691837729 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4611595301647491 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4503090381721234 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609869691837729 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4611595301647491 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45069491679564216 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609861310005016 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4611595301647491 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4511647185191984 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609859214546838 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4611595301647491 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.451798594618109 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609873882754086 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4611595301647491 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4513725879704776 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609867596379551 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4611595301647491 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4520766619183585 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609859214546838 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4611595301647491 at iter 0
max_prior_anomaly= 0.45725244361855455 at iter 0
max_prior_star_anomaly= 0.46111437304100855 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4611595301647491
accuracies_anomaly['prior'][-1]= 0.45126970097392705
accuracies_anomaly['prior_star'][-1]= 0.46098120667378284



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.14636254310608 seconds
back and forth 7/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4611595301647491
 first_prior_anomaly_auc= 0.45154410122236455
 first_prior_star_anomaly_auc= 0.46098319735905213


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46114098535987186; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4006608236910825; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.46090912291245223 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4611688549536421; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4008363183135082; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.46092431498424424 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46118394225252535; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4003007192031559; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.46091844770134527 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46119211453942044; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4034988074747508; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.46093667818749573 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.46120447774267187 at iter 480
0.45154410122236455 at iter 0
0.46098319735905213 at iter 0
last anomaly aucs:
0.46120070591795104
0.400799019157936
0.46093510659386205




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.82259750366211 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46120709706539464,first_prior_anomaly_auc= 0.40582864265020135, first_prior_star_anomaly_auc= 0.46095532776528186


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46120709706539464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4349979443555272 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46101923923971755 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46120709706539464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42675933620914014 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609808923550561 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46120709706539464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42736010406883496 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46097418688888586 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46120709706539464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42801556338698127 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609703102912561 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.46120709706539464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4286806618127474 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46096873869762245 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.46120709706539464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42967747126812517 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46096643369362644 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46120709706539464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.429028926961967 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.460964547781266 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46120709706539464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43027027638674276 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46096224277727005 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46120709706539464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42894489908902056 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4609593091358205 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46120709706539464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4288575184829888 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46095909959000264 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.46120709706539464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4295125587094995 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46095784231509573 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.46120709706539464 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4295689265344935 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46095501344655515 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.46120709706539464 at iter 0
max_prior_anomaly= 0.44156793915459996 at iter 3
max_prior_star_anomaly= 0.4610853509452402 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46120709706539464
accuracies_anomaly['prior'][-1]= 0.4296378671085569
accuracies_anomaly['prior_star'][-1]= 0.46095469912782844



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.90099620819092 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 6 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4687246580526572
accuracies_anomaly["prior"][-1]= 0.413440184936757
accuracies_anomaly["prior_star"][-1]= 0.4654584673902703


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 1202.5548448562622 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 4 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 100,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003259420394897461 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46492517328391403
 first_prior_anomaly_auc= 0.41313990577981846
 first_prior_star_anomaly_auc= 0.46183688702085773


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5466301260669549; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41301407351621655; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5224131254471184 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5436391738362769; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4129668209342978; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5179880416392686 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5422693728251763; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4129682877550225; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5149657623088262 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5390846954859221; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.41299091870334725; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5109357771404791 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5479681808866554 at iter 110
0.41313990577981846 at iter 0
0.5224131254471184 at iter 100
last anomaly aucs:
0.5425878824682653
0.4129884041535334
0.5137879052668504




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 62.757349729537964 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5431527132202038,first_prior_anomaly_auc= 0.41298829938062454, first_prior_star_anomaly_auc= 0.5142105591813968


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5431530275389305 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41434154627211706 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5129364158361318 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5431528179931127 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4170908921748467 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5112771272777106 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5431528179931127 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42604279428509884 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5090743816407689 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5431528179931127 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42931883360092327 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5068471191431421 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5431528179931127 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.43153237084748297 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5050956304248793 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5431527132202038 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.430512092260509 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5039729887058995 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5431529227660215 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42783451580038334 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5030945726375909 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5431526084472948 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42341393722761667 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.502023793508522 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5431528179931127 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4192328695246202 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5010033053757303 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5431527132202038 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41597307000967687 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5001038299527307 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5431527132202038 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4140616978324162 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49945832406093094 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5431526084472948 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4134181826258857 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4990530624492638 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5431530275389305 at iter 10
max_prior_anomaly= 0.43157595637758983 at iter 51
max_prior_star_anomaly= 0.5142105591813968 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.543152503674386
accuracies_anomaly['prior'][-1]= 0.4130380665123571
accuracies_anomaly['prior_star'][-1]= 0.4987278473400044



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.19824814796448 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5431527132202038
 first_prior_anomaly_auc= 0.41303094195455115
 first_prior_star_anomaly_auc= 0.49870647366658666


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5495041517312884; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4122939693132723; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 40 
last prior star auc 0.5019416515479359 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5530888520367644; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41091138600728466; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 40 
last prior star auc 0.5035324186239294 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5536637409879582; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4095589772990633; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 40 
last prior star auc 0.5029556437603752 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5526562446958714; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4095602345739703; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 40 
last prior star auc 0.5018301731728548 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5537231472273106 at iter 290
0.4137300915757133 at iter 40
0.5039541295822956 at iter 210
last anomaly aucs:
0.5514260011994403
0.4090620393920992
0.5004706399068275




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 63.16128063201904 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5513132655494521,first_prior_anomaly_auc= 0.41008703275997405, first_prior_star_anomaly_auc= 0.5005274268234572


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5513129512307255 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41408349059746963 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5015544108766015 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5513130560036343 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4128605812046621 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5010850282446808 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5513131607765432 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4120758321169199 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.500759184497968 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5513132655494521 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.41125504114851225 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5004002325120395 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5513131607765434 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.41063562371103135 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5001047729089109 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5513132655494521 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.4103489650322512 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49995264264517236 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5513132655494521 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.4096469865425485 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4996852621816318 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.551313370322361 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.4091134828903744 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4995033764117626 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.551313370322361 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.4087314808644855 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4993189760920795 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5513132655494521 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.4085935997163588 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4992612462192696 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5513132655494521 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.4082625173242005 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49910649663280826 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5513131607765434 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.4078725525572343 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4988991510460737 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5513136846410878 at iter 42
max_prior_anomaly= 0.42097744323089475 at iter 1
max_prior_star_anomaly= 0.5054760608571346 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.55131347509527
accuracies_anomaly['prior'][-1]= 0.40790712761717485
accuracies_anomaly['prior_star'][-1]= 0.4989225154047608



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.22327947616577 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5513131607765434
 first_prior_anomaly_auc= 0.4076508530819789
 first_prior_star_anomaly_auc= 0.4987934351809827


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5555313180892942; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4191184575080895; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5025313134792861 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5555424240176388; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42263736042676936; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.5027683097992425 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5554713879853972; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.422351016066716; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.5016885202000073 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5556451014683714; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42147521932113025; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.5004670776279245 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5599747371562034 at iter 10
0.4269350403773836 at iter 10
0.5085637184827374 at iter 10
last anomaly aucs:
0.5550460099752191
0.4207189684646117
0.49854491384104604




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 62.92496466636658 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5550627736406448,first_prior_anomaly_auc= 0.41604662059173225, first_prior_star_anomaly_auc= 0.49755271439366033


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5550629831864626 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41275580829575126 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4970099907255021 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5550627736406448 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4124645396089791 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49662673142470626 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5550627736406448 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4121946445956247 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4964720866111538 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5550627736406448 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41241278179197716 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4964519702126429 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.555062564094827 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4125850284542266 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49649869893001713 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.555062564094827 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41277487696517307 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49653348353577553 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5550627736406448 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41283543570652353 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4965274067070587 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.555062564094827 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41285471392176315 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.49652080601379733 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5550627736406448 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4129373797468938 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4965322262608686 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5550627736406448 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41288300260716904 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4965137862289003 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.555062564094827 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4128356452523414 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4965010039340132 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5550627736406448 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4126122694105434 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4964236815272369 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5550629831864626 at iter 10
max_prior_anomaly= 0.4257285803312752 at iter 1
max_prior_star_anomaly= 0.5015463433626153 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5550627736406448
accuracies_anomaly['prior'][-1]= 0.4125089633223573
accuracies_anomaly['prior_star'][-1]= 0.4963983264832805



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.41727542877197 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5550627736406448
 first_prior_anomaly_auc= 0.4123161811699614
 first_prior_star_anomaly_auc= 0.4962969063074548


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5562944839578008; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.42467121213454684; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 60 
last prior star auc 0.49614142331063116 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5563956945878087; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.43047646947147933; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 60 
last prior star auc 0.4949442880534158 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5555898861453754; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4251062292523447; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 60 
last prior star auc 0.4908990060403678 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5572686624648538; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4257606408414019; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 60 
last prior star auc 0.48711345606850975 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5586009547745643 at iter 440
0.4347126477245629 at iter 60
0.5006024442262375 at iter 60
last anomaly aucs:
0.5577499892083904
0.4239979414218857
0.48470965121936804




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 62.470038414001465 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5586156229818118,first_prior_anomaly_auc= 0.42917477085117095, first_prior_star_anomaly_auc= 0.4849522005034967


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5586156229818118 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4202305171632693 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4830631449558341 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5586158325276296 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4222798752615656 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4835925624645605 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5586157277547208 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.42193307693307064 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48337693981802204 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5586159373005386 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.422260597046326 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4836635984968021 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5586156229818119 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.42224802429725666 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48378471597950307 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5586156229818118 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4218614122633756 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4837419686326674 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5586156229818118 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4217566393544647 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48374511181993485 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5586156229818118 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4221944853408032 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48379194531021785 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5586156229818118 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4219962549971439 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48380294646565347 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5586156229818118 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.42210553314113797 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4837738195969763 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5586156229818118 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.42178492803987067 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48361037385907546 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5586156229818119 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.42156972448496777 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48364264391501993 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5586159373005386 at iter 31
max_prior_anomaly= 0.431464058910873 at iter 1
max_prior_star_anomaly= 0.48861516617192896 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5586158325276297
accuracies_anomaly['prior'][-1]= 0.4216735544376985
accuracies_anomaly['prior_star'][-1]= 0.48366548440916246



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.43810248374939 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5586156229818118
 first_prior_anomaly_auc= 0.4213354522606432
 first_prior_star_anomaly_auc= 0.4835573587671665


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5593985909301027; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41921432471974296; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 70 
last prior star auc 0.4772651169496164 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5628909863028281; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4195503314386201; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 70 
last prior star auc 0.47600480362832776 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5653011822994133; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.42220318149224284; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 70 
last prior star auc 0.4731443984421526 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5675117859045233; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4181868168020542; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 340 
last prior star auc 0.46665769810566393 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5724953093168681 at iter 490
0.42372322685472147 at iter 340
0.4835573587671665 at iter 0
last anomaly aucs:
0.5724953093168681
0.4149600207534178
0.45991346595907234




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.83069849014282 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.571124984441223,first_prior_anomaly_auc= 0.4164174119163677, first_prior_star_anomaly_auc= 0.4595031752477775


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.571124984441223 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41633181244978756 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4570975892591842 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5711252987599498 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.41478651681626144 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45544636821474926 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5711251939870409 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.41361557478627375 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45469703237021886 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5711255083057676 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4126996500165751 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45416290008059135 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5711254035328587 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.41187864950234965 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4536619808030886 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.571124879668314 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.41096943019882126 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4531739485933818 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5711255083057676 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4114318978187538 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4532257064103838 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5711256130786765 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4119309311838962 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45326489147831645 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5711258226244943 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.41170608852137347 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4530544027043145 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5711257178515854 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.41194853303259316 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45312061918274615 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5711252987599498 iter_best_vanilla_star_anomaly= 1010 
last prior auc 0.4113308967345637 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4528607823686473 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5711258226244943 iter_best_vanilla_star_anomaly= 1010 
last prior auc 0.41217117546402876 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4533027144984332 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5711263464890388 at iter 101
max_prior_anomaly= 0.42542306252889117 at iter 1
max_prior_star_anomaly= 0.46647633620033924 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.571125089214132
accuracies_anomaly['prior'][-1]= 0.4111701750922945
accuracies_anomaly['prior_star'][-1]= 0.45265018882173647



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.02296113967896 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.571124984441223
 first_prior_anomaly_auc= 0.41242221135377916
 first_prior_star_anomaly_auc= 0.45336767370195796


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.46115230083403425; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42449645092248356; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.4607080637002523 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46125078736841046; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4261379280863899; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.460763593341975 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46123224256353323; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42827330474290193; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.4607107877958839 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4613079933766758; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41989838704202187; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.4608618703305334 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.571124984441223 at iter 0
0.4315614977161601 at iter 20
0.46087674808359874 at iter 440
last anomaly aucs:
0.46130673610176887
0.416884908635928
0.4608516025854601




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.937031507492065 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4613174229384778,first_prior_anomaly_auc= 0.4203564541997802, first_prior_star_anomaly_auc= 0.46086648033852545


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4613174229384778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42186916545863506 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46080717887208195 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4613174229384778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4192615773016617 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4607933488481057 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4613174229384778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41804285882521075 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46077889018667595 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4613174229384778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4177163864410445 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46078475746957503 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4613174229384778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41832134521709574 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46078664338193537 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4613174229384778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.418584325218462 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4607858051986641 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4613174229384778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41896276496544793 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46078454792375717 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4613174229384778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4191071420339272 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4607940822584681 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4613174229384778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42028457998426727 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.460794187031377 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4613174229384778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4209362674776928 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4607927202106522 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4613174229384778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42045598846324544 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46078643383611756 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4613174229384778 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4201037419434872 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4607845479237571 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4613174229384778 at iter 0
max_prior_anomaly= 0.4224221568718665 at iter 9
max_prior_star_anomaly= 0.46086648033852545 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4613174229384778
accuracies_anomaly['prior'][-1]= 0.4208027867917404
accuracies_anomaly['prior_star'][-1]= 0.4607860147444819



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.76779532432556 seconds
back and forth 7/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4613174229384778
 first_prior_anomaly_auc= 0.4207489335165602
 first_prior_star_anomaly_auc= 0.46078748156520666


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4613048501894085; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4288881121723908; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 30 
last prior star auc 0.46083756301566603 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4612954206276065; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42352531082978884; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 130 
last prior star auc 0.4607837097404859 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4612828478785372; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41832427885854523; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 130 
last prior star auc 0.4607560496925334 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4612841051534441; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41527957812559596; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 130 
last prior star auc 0.4607275514613097 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4613730573531094 at iter 20
0.43562291475718046 at iter 130
0.46092138134279476 at iter 20
last anomaly aucs:
0.4612916488028857
0.4145431293488615
0.4607256655489492




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.90721917152405 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4612950015359708,first_prior_anomaly_auc= 0.4172367360640506, first_prior_star_anomaly_auc= 0.46072859919039877


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4612950015359708 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4149105679404119 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4607093209751592 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4612950015359708 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42018735072479807 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46070513005880276 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4612950015359708 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4217570584461004 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4607011486882641 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4612950015359708 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4231080003335969 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46070303460062456 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4612950015359708 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42322807008720875 iter_best_prior_anomaly= 480
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4607034536922601 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4612950015359708 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.423786090600068 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4607045014213493 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4612950015359708 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4234724005107889 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46070052005081064 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4612950015359708 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42432954767858855 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4607047109671671 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4612950015359708 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4224695142266942 iter_best_prior_anomaly= 840
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46069727209063444 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4612950015359708 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4240073709836877 iter_best_prior_anomaly= 940
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46070041527790173 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4612950015359708 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4229523077909554 iter_best_prior_anomaly= 940
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46069821504681463 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4612950015359708 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42324776739408404 iter_best_prior_anomaly= 1180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4606992627759037 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4612950015359708 at iter 0
max_prior_anomaly= 0.42532174712597437 at iter 127
max_prior_star_anomaly= 0.46080948387607795 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4612950015359708
accuracies_anomaly['prior'][-1]= 0.42357004886189387
accuracies_anomaly['prior_star'][-1]= 0.46069852936554134



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.38871049880981 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 6 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.46492517328391403
accuracies_anomaly["prior"][-1]= 0.41313990577981846
accuracies_anomaly["prior_star"][-1]= 0.4618368870208578


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 1209.62721991539 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 5 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 100,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-05,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0034551620483398438 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46962622893383504
 first_prior_anomaly_auc= 0.41294859044814725
 first_prior_star_anomaly_auc= 0.4662690953865135


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5432166246946393; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41268623908423446; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5200367711001114 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5328428494375581; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4126559597135593; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5082106337797079 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5280566134126926; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4126688467813553; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.501686424741829 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5364552097909865; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.41268079089297116; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5083747081550622 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5448264604400546 at iter 110
0.41294859044814725 at iter 0
0.5200367711001114 at iter 100
last anomaly aucs:
0.5433290460259007
0.412684353171874
0.5141243310773631




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.697797775268555 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5440056694716471,first_prior_anomaly_auc= 0.41268393408023846, first_prior_star_anomaly_auc= 0.5146254599006836


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5440054599258292 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41475152266468523 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5133030162444109 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5440056694716471 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4190412398742222 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5115511084345125 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.544005669471647 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4298082278584459 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5093744512518896 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5440055646987381 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.43105691138684543 iter_best_prior_anomaly= 340
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5069022296932291 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.544005669471647 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4332238246889397 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.505377993414394 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.544005669471647 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.432975512894821 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.50486565388982 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.544005669471647 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4305811376074813 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.504206213201135 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5440056694716471 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4273548654233894 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5032578088296741 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5440056694716471 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.42369493816931547 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5023259585778208 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5440054599258292 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.41980754892999617 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5014159010910213 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5440056694716471 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4161552700982728 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5005201974927423 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.544005669471647 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.41398353724236864 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4998363447162813 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5440058790174649 at iter 27
max_prior_anomaly= 0.4335548023081891 at iter 54
max_prior_star_anomaly= 0.5146254599006836 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5440054599258292
accuracies_anomaly['prior'][-1]= 0.41335909070526
accuracies_anomaly['prior_star'][-1]= 0.4994681727143685



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.63331770896912 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5440054599258292
 first_prior_anomaly_auc= 0.4132580896210699
 first_prior_star_anomaly_auc= 0.4994191389929983


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5519038704369827; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4098403973323979; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5036400204013808 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5597621529240233; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4103918171519958; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5081639050623336 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5631565856269171; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41019997795577995; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5094104931325549 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5629173890758736; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 350 
last prior auc 0.41050256211671454; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5088751035680205 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5636014513981525 at iter 350
0.4132580896210699 at iter 0
0.5096358596596222 at iter 320
last anomaly aucs:
0.5589423049117959
0.41084915089939156
0.5061369683665442




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 62.02234745025635 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5584125730843426,first_prior_anomaly_auc= 0.41024314439425125, first_prior_star_anomaly_auc= 0.5055525450806395


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5584126778572515 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.42061377646406517 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5087300978620879 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5584126778572516 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4157969467497977 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5066176664726272 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5584126778572515 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.41588223189765106 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5065558504563699 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5584128874030694 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.41573617846262934 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5064772707746866 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5584126778572516 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.41512891468258206 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5062713920086769 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5584125730843426 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.41476430495957234 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.506129005625467 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5584128874030694 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.414235830407026 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5059543491863127 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5584125730843426 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4136476352964005 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5057782259264334 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5584126778572516 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.41298819460771563 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5055600887300811 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5584125730843426 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.41251430674071177 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5053903566176455 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5584125730843426 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4124789982704088 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5053733834064019 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5584126778572516 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4122028168825198 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5052893555334554 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5584129921759782 at iter 11
max_prior_anomaly= 0.42272369330371196 at iter 3
max_prior_star_anomaly= 0.512873866409512 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5584126778572516
accuracies_anomaly['prior'][-1]= 0.4119211873033674
accuracies_anomaly['prior_star'][-1]= 0.5051745244252892



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.3721821308136 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5584126778572516
 first_prior_anomaly_auc= 0.41190086135903875
 first_prior_star_anomaly_auc= 0.5051503218833308


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5533015410418534; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41026472761348687; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 30 
last prior star auc 0.4977100833028444 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5400773140249435; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.40324976227026965; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 30 
last prior star auc 0.4866169372531812 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5301031426424482; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.40525888757154416; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 30 
last prior star auc 0.4828706771221648 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5185946767818624; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.40616203004635576; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 30 
last prior star auc 0.4771965954671887 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5649351057556788 at iter 10
0.41453275683087937 at iter 30
0.5075000639114744 at iter 10
last anomaly aucs:
0.5135606528274227
0.4052370948064907
0.47482055543890833




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.96137070655823 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5138643894903552,first_prior_anomaly_auc= 0.4018054677209336, first_prior_star_anomaly_auc= 0.4732986241640693


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5138643894903552 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4195849064985606 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47774455778079244 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5138643894903553 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.413233363214567 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47635757401263057 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5138643894903552 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41277550560262655 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4760952226487178 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5138643894903552 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41306645997067193 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47615641002752174 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5138643894903552 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4131137125525908 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4761815555256604 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5138643894903552 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41298903279098687 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47614478023463264 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5138643894903553 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4127245859688959 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4760289013973772 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5138643894903552 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41271012730746615 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4760463984731653 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5138643894903552 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41288970807333936 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47606085713459506 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5138643894903552 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4128331307025275 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4760109852299535 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5138643894903553 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4127664951324602 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4759929642896208 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5138643894903552 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41279017380987404 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4759887733732644 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5138643894903553 at iter 2
max_prior_anomaly= 0.43141471087077604 at iter 2
max_prior_star_anomaly= 0.4813416212895198 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5138643894903552
accuracies_anomaly['prior'][-1]= 0.41259634392838895
accuracies_anomaly['prior_star'][-1]= 0.47587855227309017



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.46485233306885 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5138643894903552
 first_prior_anomaly_auc= 0.41257182706770384
 first_prior_star_anomaly_auc= 0.47587792363563675


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5286488946667656; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4338088766122979; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.487053211645886 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5262290595625605; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44495755230368383; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.48720094144745035 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5233228686151914; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44381804214636944; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.48380420374056043 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5230068735219162; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4402341800241648; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.48035633685412216 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5439744471447916 at iter 10
0.44818330062323114 at iter 20
0.5032339206064423 at iter 20
last anomaly aucs:
0.5198460844058936
0.4387899902477377
0.4740435595464255




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.861273527145386 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.51957996121726,first_prior_anomaly_auc= 0.435443543537125, first_prior_star_anomaly_auc= 0.47280514376309923


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.51957996121726 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4219623085746568 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47029227031578136 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.51957996121726 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4256497911037742 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47155824137415114 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.51957996121726 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.42578578633954056 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47157636708739276 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.51957996121726 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4253570555962773 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4713419900901592 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5195798564443511 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4250626437222378 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4711922696033255 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5195800659901689 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4249103039126814 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47107492394534545 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5195798564443511 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.42488264386472896 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4710522929970207 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.51957996121726 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.42498175903655866 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4710552266384702 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5195798564443511 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.42509030377019025 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47107534303698106 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5195798564443511 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.42535621741300594 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47121888192218897 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5195798564443511 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.42609591414991654 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.47150763605914725 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5195798564443511 iter_best_vanilla_star_anomaly= 1170 
last prior auc 0.4264806402714373 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4715038642344265 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5195802755359868 at iter 117
max_prior_anomaly= 0.435443543537125 at iter 0
max_prior_star_anomaly= 0.4746754449600669 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.51957996121726
accuracies_anomaly['prior'][-1]= 0.4275585439583121
accuracies_anomaly['prior_star'][-1]= 0.47199902100193913



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.92323279380798 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5195798564443511
 first_prior_anomaly_auc= 0.427173189199338
 first_prior_star_anomaly_auc= 0.4717697778772422


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.519697516421058; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4372269879926055; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 50 
last prior star auc 0.4713802322019116 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5127548443849893; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42777940525029623; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 50 
last prior star auc 0.45859248912352435 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5155767979135942; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4368269650263839; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 50 
last prior star auc 0.4553422239432919 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5087332410493552; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4306189606275981; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 50 
last prior star auc 0.43915145678348005 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5258374184290517 at iter 20
0.4393786044499988 at iter 50
0.48135880404658116 at iter 20
last anomaly aucs:
0.5103144737906378
0.43135467599397015
0.43200301075431047




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.83709192276001 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5187044787904009,first_prior_anomaly_auc= 0.43621865351724753, first_prior_star_anomaly_auc= 0.43710775642226496


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5187040596987653 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.430750660174099 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43021265128684183 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5187040596987653 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.43392286953719295 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43302748025764076 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5187042692445831 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.43380531433339486 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4331198899633001 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5187038501529475 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4346942076925946 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43359618760720886 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5187032215154941 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4349879909291807 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4339863619199929 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5187038501529475 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.43514724575072516 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4341120894106859 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5187044787904009 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4349337185623648 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43414163537099876 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5187037453800386 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.43516065668306575 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43422021505268193 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5187036406071297 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4350583983239687 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4343310647903096 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5187036406071297 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.43540561574409925 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43470803771657085 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5187046883362187 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4354355807960477 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4346022170785709 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5187040596987653 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4355009590912082 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347474323303213 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5187051074278545 at iter 58
max_prior_anomaly= 0.4445596247956404 at iter 1
max_prior_star_anomaly= 0.43894505415292573 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.518704478790401
accuracies_anomaly['prior'][-1]= 0.4356620998251131
accuracies_anomaly['prior_star'][-1]= 0.4344960821218442



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.98194098472595 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5187044787904009
 first_prior_anomaly_auc= 0.43559336879686755
 first_prior_star_anomaly_auc= 0.43467482470444607


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.53055701888385; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42773822949709417; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4347128572703808 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5175628731749083; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.43842118960837145; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 200 
last prior star auc 0.4372515048532907 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5008545278450769; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4428321290735183; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 290 
last prior star auc 0.43702750037403937 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.48133763991898115; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44042025671039053; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 290 
last prior star auc 0.42582727641146917 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5458016866761968 at iter 10
0.44493921704462447 at iter 290
0.4481137314117144 at iter 20
last anomaly aucs:
0.4648248008371775
0.4371484083109224
0.41606956585878374




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.86351251602173 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46917078109879956,first_prior_anomaly_auc= 0.4367249162131047, first_prior_star_anomaly_auc= 0.4177612292460584


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4691705715529818 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4297711382486915 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40987015283852857 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4691701524613461 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.43214916896224115 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.408977697200426 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.46917078109879956 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.435088572921735 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4111986733235182 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46916952382389265 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.43575220452677643 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41149811429718547 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4691701524613462 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.4363412378206732 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4118732013110863 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4691701524613461 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.4365025881003959 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41217620456365645 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4691705715529818 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.4375559749265856 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4133127810795214 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.46917036200716394 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.43766263374785686 iter_best_prior_anomaly= 790
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41482884507146145 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46917057155298175 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.43793169057793996 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4151639088341583 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46917057155298175 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.4380437975904745 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41522488666714447 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.46917015246134613 iter_best_vanilla_star_anomaly= 1020 
last prior auc 0.4380035647934528 iter_best_prior_anomaly= 1070
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4147672386010218 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4691705715529818 iter_best_vanilla_star_anomaly= 1020 
last prior auc 0.43809492677002304 iter_best_prior_anomaly= 1180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41491161566950097 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.46917120019043523 at iter 102
max_prior_anomaly= 0.438834204415298 at iter 128
max_prior_star_anomaly= 0.4177612292460584 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46917036200716394
accuracies_anomaly['prior'][-1]= 0.4384511546603199
accuracies_anomaly['prior_star'][-1]= 0.41523138258749687



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.80803847312927 seconds
back and forth 7/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.469170362007164
 first_prior_anomaly_auc= 0.43881010664624853
 first_prior_star_anomaly_auc= 0.4157313589088195


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.470661699592601; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4463005314501032; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 100 
last prior star auc 0.415851847754067 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.46956179359485495; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.44332560947448846; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 170 
last prior star auc 0.4154208120068077 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4671109457096123; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.44277450397361734; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 170 
last prior star auc 0.4138942707239766 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46531471895924453; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4416708261511504; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 170 
last prior star auc 0.41471631896729116 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4752057006520647 at iter 70
0.44836183366001525 at iter 470
0.419461064920228 at iter 470
last anomaly aucs:
0.46409453366206876
0.4409244239480695
0.41534809960802355




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.8859977722168 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.46630503249427,first_prior_anomaly_auc= 0.44318751878054385, first_prior_star_anomaly_auc= 0.41773702670409996


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4663054515859056 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4348295742909074 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41101175845402127 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4663051372671788 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.43263101957032213 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41048747481783127 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4663054515859056 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4375303055639025 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4128967278582364 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.46630566113172345 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.43937713762927405 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41345087177346596 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4663050324942699 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.44085108291183195 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4138375885802558 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4663052420400878 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.44029620558624 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4137834209863489 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.46630524204008783 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.43931720752537706 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.41326793827450753 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4663046134026343 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.44056190968323794 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4140901960636399 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.46630597545045016 iter_best_vanilla_star_anomaly= 900 
last prior auc 0.4396053330248819 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.413021721938567 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.46630503249427 iter_best_vanilla_star_anomaly= 900 
last prior auc 0.4407888478039389 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4137320822609826 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4663055563588145 iter_best_vanilla_star_anomaly= 900 
last prior auc 0.4403155885743885 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4131405344172719 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4663047181755432 iter_best_vanilla_star_anomaly= 900 
last prior auc 0.44071833563624185 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4134921522995768 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.46630597545045016 at iter 90
max_prior_anomaly= 0.44318751878054385 at iter 0
max_prior_star_anomaly= 0.41773702670409996 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.46630503249426997
accuracies_anomaly['prior'][-1]= 0.441275308420012
accuracies_anomaly['prior_star'][-1]= 0.4141098933705152



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.47841596603394 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 6 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4696262289338351
accuracies_anomaly["prior"][-1]= 0.41294859044814725
accuracies_anomaly["prior_star"][-1]= 0.46626909538651357


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 1202.975221157074 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/scripts/unsupervised/mighty_config/mighty_config.py:106:::  

 round_num= 6 




/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 100,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 2e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 1e-06,
        "noise_amp": 0.01,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 7,
        "scheduler_step_size": 10,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0030660629272460938 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4679823419930238
 first_prior_anomaly_auc= 0.4136667039658223
 first_prior_star_anomaly_auc= 0.46488033047890015


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5374825081628574; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.413427297868961; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5187518361452287 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5438323750803085; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.41340414305609163; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5179608006829517 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5409496532645353; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.41338737939066583; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5154114662633329 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5382963841192769; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.41338151210776697; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5129175567125278 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5453800804907395 at iter 170
0.4136667039658223 at iter 0
0.5207565609843289 at iter 130
last anomaly aucs:
0.5369443945026913
0.41339073212375105
0.509802867676426




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.65529751777649 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.537010401435305,first_prior_anomaly_auc= 0.4133927228090204, first_prior_star_anomaly_auc= 0.5097409468872598


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.537010506208214 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41352086007661826 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5096280016914538 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.537010401435305 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4136826294479767 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5095273149259905 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5370106109811228 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.413850370875143 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5094183511007232 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.537010401435305 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41403854301954685 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5092931474745748 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.537010401435305 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.414247564972824 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5091837645576718 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5370106109811228 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41446224466318227 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5090553129713471 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.537010401435305 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41470489872021987 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5089325191221036 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.537010506208214 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4149656784904989 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5087879325078066 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.537010401435305 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41523871669112067 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5086596904672998 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.537010401435305 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4155427676727799 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5085165706737275 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.537010506208214 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4158489141126175 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.508401949111379 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.537010401435305 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4161753864967837 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5082542193098147 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5370106109811228 at iter 5
max_prior_anomaly= 0.4165032209287657 at iter 129
max_prior_star_anomaly= 0.5097409468872598 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.537010401435305
accuracies_anomaly['prior'][-1]= 0.4165032209287657
accuracies_anomaly['prior_star'][-1]= 0.5081274440900326



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.64940738677979 seconds
back and forth 2/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5370106109811228
 first_prior_anomaly_auc= 0.41654659691305485
 first_prior_star_anomaly_auc= 0.5081168620262326


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5393977569377477; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4165613698932113; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 100 
last prior star auc 0.5094617270850124 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5425336101014495; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41656744672192814; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 150 
last prior star auc 0.5118353573363876 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5472588682933289; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41656786581356375; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 250 
last prior star auc 0.5154372403989249 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5530526006102813; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.41656157943902905; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 250 
last prior star auc 0.5197284244291868 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5574316891111193 at iter 490
0.4165714280924667 at iter 250
0.5226238237669381 at iter 490
last anomaly aucs:
0.5574316891111193
0.4165458635026924
0.5226238237669381




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.8897500038147 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5577910601886834,first_prior_anomaly_auc= 0.4165477494150528, first_prior_star_anomaly_auc= 0.522850866660548


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5577910601886834 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4169551064848982 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5226925547951836 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5577910601886834 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.41736644492528224 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5225396911210827 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5577911649615923 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.41785688691189393 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5223809601640828 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5577911649615923 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.41838483759989575 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5222103898683759 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5577911649615923 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.418946315618749 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5220364668395838 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5577911649615923 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.41956332327932494 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.521870716097687 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5577910601886834 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.42030029592060386 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5216797150847424 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5577910601886834 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.42108232091271447 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5214926954423366 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5577911649615923 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.4219519360566746 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5213279924295287 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5577912697345013 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.42288315767107426 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5211422300620298 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5577910601886834 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.4239480695172442 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5209376085709269 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5577911649615923 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.4251036099296219 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5207542559803329 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5577914792803191 at iter 51
max_prior_anomaly= 0.42619922023810275 at iter 129
max_prior_star_anomaly= 0.522850866660548 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5577910601886834
accuracies_anomaly['prior'][-1]= 0.42619922023810275
accuracies_anomaly['prior_star'][-1]= 0.5205771897642735



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.8201653957367 seconds
back and forth 3/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5577910601886834
 first_prior_anomaly_auc= 0.42629623995175414
 first_prior_star_anomaly_auc= 0.520556654274127


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5607829553755418; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42630210723465317; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 80 
last prior star auc 0.5222787018049857 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.562051860075361; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.42631080338609273; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 200 
last prior star auc 0.5226571415519718 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5615144798255574; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 240 
last prior auc 0.4263147847566314; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 240 
last prior star auc 0.5215814380961841 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5583650061836971; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 240 
last prior auc 0.4263208615853482; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 400 
last prior star auc 0.5185286698492485 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5622374128970422 at iter 240
0.4263273575057007 at iter 440
0.5226708668030391 at iter 210
last anomaly aucs:
0.5540490957469324
0.4263244238642512
0.5147073923154519




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.92696762084961 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5535284791625543,first_prior_anomaly_auc= 0.42631981385625917, first_prior_star_anomaly_auc= 0.5142868338590838


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5535284791625543 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4276603832257735 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5141221308462759 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5535284791625543 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4289216395032423 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5139460075863967 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5535284791625543 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4301532450474894 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5137487201989177 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5535286887083721 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.43125660855122955 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5135699776163157 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5535286887083721 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.43224304548862524 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5133740522766524 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5535286887083721 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4331368631745437 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5131827369449813 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5535286887083721 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4337990279588603 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5129912120674922 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5535283743896454 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.43439172830456896 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5128165556283377 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5535285839354632 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4348300981554519 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5126379178186449 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5535286887083721 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.43521492904988157 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.512454355682233 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5535284791625543 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4356130661037428 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5122713174103657 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5535284791625543 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.43596981785858424 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5120905841424945 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5535286887083721 at iter 7
max_prior_anomaly= 0.4362674776928 at iter 129
max_prior_star_anomaly= 0.5142868338590838 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5535286887083721
accuracies_anomaly['prior'][-1]= 0.4362674776928
accuracies_anomaly['prior_star'][-1]= 0.5119433782054748



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.26903820037842 seconds
back and forth 4/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5535286887083721
 first_prior_anomaly_auc= 0.43629513774075246
 first_prior_star_anomaly_auc= 0.5119269288587758


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.547614991410717; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43632489324688306; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 100 
last prior star auc 0.5068327652546212 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.541294356134852; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4363718315100752; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 200 
last prior star auc 0.5013182527399164 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5343793441467357; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4364392004905049; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 300 
last prior star auc 0.4956636588459976 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5270534128098712; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4365468022679563; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 400 
last prior star auc 0.48991225478424527 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5535286887083721 at iter 0
0.4366442410732434 at iter 490
0.5119269288587758 at iter 0
last anomaly aucs:
0.5203003797389311
0.4366442410732434
0.48495586755530856




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.874191999435425 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5196107644524799,first_prior_anomaly_auc= 0.43665461359122554, first_prior_star_anomaly_auc= 0.4844894185648374


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.519610554906662 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4372439612038491 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4844049716002553 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5196105549066621 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4375330296595341 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.484323039185487 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.519610554906662 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4378370806411935 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4842144944518554 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.519610554906662 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43813054955905273 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4841286854394574 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.519610554906662 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43840547367203486 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4840497914390476 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5196107644524799 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43871581102822876 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48398137472952873 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5196104501337531 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43902541497406034 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4839195587132713 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5196103453608442 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4393247511748187 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4838727252229882 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.519610554906662 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4395988371045294 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4837967648640278 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5196103453608442 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4398984876240145 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.48374280681593873 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5196107644524798 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44017173537045395 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.483714308584715 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5196103453608442 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44051392369095677 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4836870676283982 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5196107644524799 at iter 0
max_prior_anomaly= 0.4408056114693646 at iter 129
max_prior_star_anomaly= 0.4844894185648374 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5196105549066621
accuracies_anomaly['prior'][-1]= 0.4408056114693646
accuracies_anomaly['prior_star'][-1]= 0.48365877894299225



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.33925938606262 seconds
back and forth 5/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5196107644524799
 first_prior_anomaly_auc= 0.4408353669754953
 first_prior_star_anomaly_auc= 0.48365773121390315


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.51205831408655; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44133136192627925; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4787086780885901 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5059165261661958; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.441869894678081; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.4748195077098193 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5015269603744666; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44239417831427097; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.47174547056237487 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.498771851961747; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44286733277091234; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.4694062058251223 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5196107644524799 at iter 0
0.4432495443426192 at iter 490
0.48365773121390315 at iter 0
last anomaly aucs:
0.49730827919717135
0.4432495443426192
0.46775006045396844




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.893646478652954 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4972166029018743,first_prior_anomaly_auc= 0.4432855862232845, first_prior_star_anomaly_auc= 0.46761322703493086


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4972161838102387 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44409935740679507 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4676058929313071 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4972166029018743 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4444592523489038 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4676285238796319 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.49721607903732973 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4447510449002206 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4676176274971051 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4972161838102387 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4449599620805888 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46762925728999427 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4972161838102387 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44511942644795116 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4676071502062141 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4972161838102387 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4451937104403689 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46758577653279626 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4972161838102387 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44524599212191546 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46755685920993684 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4972161838102387 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44524064870356095 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4675264750663527 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4972161838102387 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4451616499302422 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4675126450423764 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4972161838102387 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44506861158712935 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4674795368031606 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4972163933560565 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4449526279769651 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46747450770353294 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4972163933560565 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4448066793148522 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.46746423995845965 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4972166029018743 at iter 0
max_prior_anomaly= 0.44524903053627385 at iter 71
max_prior_star_anomaly= 0.46763355297925957 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4972161838102387
accuracies_anomaly['prior'][-1]= 0.4446384140231414
accuracies_anomaly['prior_star'][-1]= 0.46746926905808733



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.33680200576782 seconds
back and forth 6/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4972161838102387
 first_prior_anomaly_auc= 0.44462521263661864
 first_prior_star_anomaly_auc= 0.46747031678717643


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4965965568269398; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4453596707280837; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4659863133053632 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4958854630941619; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4459570858546934; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.4642648944119579 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.49539397337846114; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44647403538725955; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.4623962695815328 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4950846837513563; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44686913402676237; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.45986747065206046 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4972161838102387 at iter 0
0.44715044928718806 at iter 490
0.46747031678717643 at iter 0
last anomaly aucs:
0.4946718784902475
0.44715044928718806
0.45673318908199234




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.69366788864136 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4946530193666436,first_prior_anomaly_auc= 0.4471788427455028, first_prior_star_anomaly_auc= 0.45635527319955094


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4946523907291901 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4463774347652437 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45621047703943607 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4946523907291901 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4461180170427805 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45603089627356297 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4946526002750079 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.445936445591638 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4559110360657689 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4946526002750079 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4456863526580677 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4558476484558779 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.49465280982082577 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4453307534052243 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4558067870214026 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.49465270504791686 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4449422554589829 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45580154837595704 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.49465260027500796 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4445071335682761 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45582250295773924 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.494652495502099 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4439858883464446 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45583633298171544 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.49465270504791686 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4435173438977953 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4558769848703728 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.49465249550209905 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.44304460853278954 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4559211990379332 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.49465280982082577 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4425308021874907 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.45596813730112534 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4946527050479168 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4420611052368434 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.456024924217755 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4946532289124614 at iter 36
max_prior_anomaly= 0.4471788427455028 at iter 0
max_prior_star_anomaly= 0.45635527319955094 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4946523907291901
accuracies_anomaly['prior'][-1]= 0.4416334222226693
accuracies_anomaly['prior_star'][-1]= 0.4560569847278817



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.70334815979004 seconds
back and forth 7/7


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49465239072919004
 first_prior_anomaly_auc= 0.4415858553220237
 first_prior_star_anomaly_auc= 0.4560569847278817
